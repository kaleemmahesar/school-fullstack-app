function nS(n,a){for(var t=0;t<a.length;t++){const r=a[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const e=Object.getOwnPropertyDescriptor(r,s);e&&Object.defineProperty(n,s,e.get?e:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const e of s)if(e.type==="childList")for(const u of e.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function t(s){const e={};return s.integrity&&(e.integrity=s.integrity),s.referrerPolicy&&(e.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?e.credentials="include":s.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function r(s){if(s.ep)return;s.ep=!0;const e=t(s);fetch(s.href,e)}})();var kG=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function PN(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function iS(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var a=n.default;if(typeof a=="function"){var t=function r(){var s=!1;try{s=this instanceof r}catch{}return s?Reflect.construct(a,arguments,this.constructor):a.apply(this,arguments)};t.prototype=a.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var hy={exports:{}},h1={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H5;function oS(){if(H5)return h1;H5=1;var n=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function t(r,s,e){var u=null;if(e!==void 0&&(u=""+e),s.key!==void 0&&(u=""+s.key),"key"in s){e={};for(var f in s)f!=="key"&&(e[f]=s[f])}else e=s;return s=e.ref,{$$typeof:n,type:r,key:u,ref:s!==void 0?s:null,props:e}}return h1.Fragment=a,h1.jsx=t,h1.jsxs=t,h1}var z5;function lS(){return z5||(z5=1,hy.exports=oS()),hy.exports}var i=lS(),my={exports:{}},Ha={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var K5;function cS(){if(K5)return Ha;K5=1;var n=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),e=Symbol.for("react.consumer"),u=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),j=Symbol.for("react.activity"),F=Symbol.iterator;function C(te){return te===null||typeof te!="object"?null:(te=F&&te[F]||te["@@iterator"],typeof te=="function"?te:null)}var M={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,L={};function T(te,V,le){this.props=te,this.context=V,this.refs=L,this.updater=le||M}T.prototype.isReactComponent={},T.prototype.setState=function(te,V){if(typeof te!="object"&&typeof te!="function"&&te!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,te,V,"setState")},T.prototype.forceUpdate=function(te){this.updater.enqueueForceUpdate(this,te,"forceUpdate")};function H(){}H.prototype=T.prototype;function O(te,V,le){this.props=te,this.context=V,this.refs=L,this.updater=le||M}var Q=O.prototype=new H;Q.constructor=O,_(Q,T.prototype),Q.isPureReactComponent=!0;var Z=Array.isArray;function ee(){}var se={H:null,A:null,T:null,S:null},ue=Object.prototype.hasOwnProperty;function ae(te,V,le){var de=le.ref;return{$$typeof:n,type:te,key:V,ref:de!==void 0?de:null,props:le}}function pe(te,V){return ae(te.type,V,te.props)}function z(te){return typeof te=="object"&&te!==null&&te.$$typeof===n}function J(te){var V={"=":"=0",":":"=2"};return"$"+te.replace(/[=:]/g,function(le){return V[le]})}var ge=/\/+/g;function fe(te,V){return typeof te=="object"&&te!==null&&te.key!=null?J(""+te.key):V.toString(36)}function ke(te){switch(te.status){case"fulfilled":return te.value;case"rejected":throw te.reason;default:switch(typeof te.status=="string"?te.then(ee,ee):(te.status="pending",te.then(function(V){te.status==="pending"&&(te.status="fulfilled",te.value=V)},function(V){te.status==="pending"&&(te.status="rejected",te.reason=V)})),te.status){case"fulfilled":return te.value;case"rejected":throw te.reason}}throw te}function he(te,V,le,de,X){var ie=typeof te;(ie==="undefined"||ie==="boolean")&&(te=null);var G=!1;if(te===null)G=!0;else switch(ie){case"bigint":case"string":case"number":G=!0;break;case"object":switch(te.$$typeof){case n:case a:G=!0;break;case b:return G=te._init,he(G(te._payload),V,le,de,X)}}if(G)return X=X(te),G=de===""?"."+fe(te,0):de,Z(X)?(le="",G!=null&&(le=G.replace(ge,"$&/")+"/"),he(X,V,le,"",function(Fe){return Fe})):X!=null&&(z(X)&&(X=pe(X,le+(X.key==null||te&&te.key===X.key?"":(""+X.key).replace(ge,"$&/")+"/")+G)),V.push(X)),1;G=0;var q=de===""?".":de+":";if(Z(te))for(var ve=0;ve<te.length;ve++)de=te[ve],ie=q+fe(de,ve),G+=he(de,V,le,ie,X);else if(ve=C(te),typeof ve=="function")for(te=ve.call(te),ve=0;!(de=te.next()).done;)de=de.value,ie=q+fe(de,ve++),G+=he(de,V,le,ie,X);else if(ie==="object"){if(typeof te.then=="function")return he(ke(te),V,le,de,X);throw V=String(te),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(te).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.")}return G}function Ne(te,V,le){if(te==null)return te;var de=[],X=0;return he(te,de,"","",function(ie){return V.call(le,ie,X++)}),de}function xe(te){if(te._status===-1){var V=te._result;V=V(),V.then(function(le){(te._status===0||te._status===-1)&&(te._status=1,te._result=le)},function(le){(te._status===0||te._status===-1)&&(te._status=2,te._result=le)}),te._status===-1&&(te._status=0,te._result=V)}if(te._status===1)return te._result.default;throw te._result}var we=typeof reportError=="function"?reportError:function(te){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var V=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof te=="object"&&te!==null&&typeof te.message=="string"?String(te.message):String(te),error:te});if(!window.dispatchEvent(V))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",te);return}console.error(te)},ye={map:Ne,forEach:function(te,V,le){Ne(te,function(){V.apply(this,arguments)},le)},count:function(te){var V=0;return Ne(te,function(){V++}),V},toArray:function(te){return Ne(te,function(V){return V})||[]},only:function(te){if(!z(te))throw Error("React.Children.only expected to receive a single React element child.");return te}};return Ha.Activity=j,Ha.Children=ye,Ha.Component=T,Ha.Fragment=t,Ha.Profiler=s,Ha.PureComponent=O,Ha.StrictMode=r,Ha.Suspense=m,Ha.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=se,Ha.__COMPILER_RUNTIME={__proto__:null,c:function(te){return se.H.useMemoCache(te)}},Ha.cache=function(te){return function(){return te.apply(null,arguments)}},Ha.cacheSignal=function(){return null},Ha.cloneElement=function(te,V,le){if(te==null)throw Error("The argument must be a React element, but you passed "+te+".");var de=_({},te.props),X=te.key;if(V!=null)for(ie in V.key!==void 0&&(X=""+V.key),V)!ue.call(V,ie)||ie==="key"||ie==="__self"||ie==="__source"||ie==="ref"&&V.ref===void 0||(de[ie]=V[ie]);var ie=arguments.length-2;if(ie===1)de.children=le;else if(1<ie){for(var G=Array(ie),q=0;q<ie;q++)G[q]=arguments[q+2];de.children=G}return ae(te.type,X,de)},Ha.createContext=function(te){return te={$$typeof:u,_currentValue:te,_currentValue2:te,_threadCount:0,Provider:null,Consumer:null},te.Provider=te,te.Consumer={$$typeof:e,_context:te},te},Ha.createElement=function(te,V,le){var de,X={},ie=null;if(V!=null)for(de in V.key!==void 0&&(ie=""+V.key),V)ue.call(V,de)&&de!=="key"&&de!=="__self"&&de!=="__source"&&(X[de]=V[de]);var G=arguments.length-2;if(G===1)X.children=le;else if(1<G){for(var q=Array(G),ve=0;ve<G;ve++)q[ve]=arguments[ve+2];X.children=q}if(te&&te.defaultProps)for(de in G=te.defaultProps,G)X[de]===void 0&&(X[de]=G[de]);return ae(te,ie,X)},Ha.createRef=function(){return{current:null}},Ha.forwardRef=function(te){return{$$typeof:f,render:te}},Ha.isValidElement=z,Ha.lazy=function(te){return{$$typeof:b,_payload:{_status:-1,_result:te},_init:xe}},Ha.memo=function(te,V){return{$$typeof:g,type:te,compare:V===void 0?null:V}},Ha.startTransition=function(te){var V=se.T,le={};se.T=le;try{var de=te(),X=se.S;X!==null&&X(le,de),typeof de=="object"&&de!==null&&typeof de.then=="function"&&de.then(ee,we)}catch(ie){we(ie)}finally{V!==null&&le.types!==null&&(V.types=le.types),se.T=V}},Ha.unstable_useCacheRefresh=function(){return se.H.useCacheRefresh()},Ha.use=function(te){return se.H.use(te)},Ha.useActionState=function(te,V,le){return se.H.useActionState(te,V,le)},Ha.useCallback=function(te,V){return se.H.useCallback(te,V)},Ha.useContext=function(te){return se.H.useContext(te)},Ha.useDebugValue=function(){},Ha.useDeferredValue=function(te,V){return se.H.useDeferredValue(te,V)},Ha.useEffect=function(te,V){return se.H.useEffect(te,V)},Ha.useEffectEvent=function(te){return se.H.useEffectEvent(te)},Ha.useId=function(){return se.H.useId()},Ha.useImperativeHandle=function(te,V,le){return se.H.useImperativeHandle(te,V,le)},Ha.useInsertionEffect=function(te,V){return se.H.useInsertionEffect(te,V)},Ha.useLayoutEffect=function(te,V){return se.H.useLayoutEffect(te,V)},Ha.useMemo=function(te,V){return se.H.useMemo(te,V)},Ha.useOptimistic=function(te,V){return se.H.useOptimistic(te,V)},Ha.useReducer=function(te,V,le){return se.H.useReducer(te,V,le)},Ha.useRef=function(te){return se.H.useRef(te)},Ha.useState=function(te){return se.H.useState(te)},Ha.useSyncExternalStore=function(te,V,le){return se.H.useSyncExternalStore(te,V,le)},Ha.useTransition=function(){return se.H.useTransition()},Ha.version="19.2.0",Ha}var G5;function jb(){return G5||(G5=1,my.exports=cS()),my.exports}var ne=jb();const At=PN(ne),HN=nS({__proto__:null,default:At},[ne]);var py={exports:{}},m1={},gy={exports:{}},xy={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V5;function AS(){return V5||(V5=1,(function(n){function a(he,Ne){var xe=he.length;he.push(Ne);e:for(;0<xe;){var we=xe-1>>>1,ye=he[we];if(0<s(ye,Ne))he[we]=Ne,he[xe]=ye,xe=we;else break e}}function t(he){return he.length===0?null:he[0]}function r(he){if(he.length===0)return null;var Ne=he[0],xe=he.pop();if(xe!==Ne){he[0]=xe;e:for(var we=0,ye=he.length,te=ye>>>1;we<te;){var V=2*(we+1)-1,le=he[V],de=V+1,X=he[de];if(0>s(le,xe))de<ye&&0>s(X,le)?(he[we]=X,he[de]=xe,we=de):(he[we]=le,he[V]=xe,we=V);else if(de<ye&&0>s(X,xe))he[we]=X,he[de]=xe,we=de;else break e}}return Ne}function s(he,Ne){var xe=he.sortIndex-Ne.sortIndex;return xe!==0?xe:he.id-Ne.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var e=performance;n.unstable_now=function(){return e.now()}}else{var u=Date,f=u.now();n.unstable_now=function(){return u.now()-f}}var m=[],g=[],b=1,j=null,F=3,C=!1,M=!1,_=!1,L=!1,T=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;function Q(he){for(var Ne=t(g);Ne!==null;){if(Ne.callback===null)r(g);else if(Ne.startTime<=he)r(g),Ne.sortIndex=Ne.expirationTime,a(m,Ne);else break;Ne=t(g)}}function Z(he){if(_=!1,Q(he),!M)if(t(m)!==null)M=!0,ee||(ee=!0,J());else{var Ne=t(g);Ne!==null&&ke(Z,Ne.startTime-he)}}var ee=!1,se=-1,ue=5,ae=-1;function pe(){return L?!0:!(n.unstable_now()-ae<ue)}function z(){if(L=!1,ee){var he=n.unstable_now();ae=he;var Ne=!0;try{e:{M=!1,_&&(_=!1,H(se),se=-1),C=!0;var xe=F;try{t:{for(Q(he),j=t(m);j!==null&&!(j.expirationTime>he&&pe());){var we=j.callback;if(typeof we=="function"){j.callback=null,F=j.priorityLevel;var ye=we(j.expirationTime<=he);if(he=n.unstable_now(),typeof ye=="function"){j.callback=ye,Q(he),Ne=!0;break t}j===t(m)&&r(m),Q(he)}else r(m);j=t(m)}if(j!==null)Ne=!0;else{var te=t(g);te!==null&&ke(Z,te.startTime-he),Ne=!1}}break e}finally{j=null,F=xe,C=!1}Ne=void 0}}finally{Ne?J():ee=!1}}}var J;if(typeof O=="function")J=function(){O(z)};else if(typeof MessageChannel<"u"){var ge=new MessageChannel,fe=ge.port2;ge.port1.onmessage=z,J=function(){fe.postMessage(null)}}else J=function(){T(z,0)};function ke(he,Ne){se=T(function(){he(n.unstable_now())},Ne)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(he){he.callback=null},n.unstable_forceFrameRate=function(he){0>he||125<he?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ue=0<he?Math.floor(1e3/he):5},n.unstable_getCurrentPriorityLevel=function(){return F},n.unstable_next=function(he){switch(F){case 1:case 2:case 3:var Ne=3;break;default:Ne=F}var xe=F;F=Ne;try{return he()}finally{F=xe}},n.unstable_requestPaint=function(){L=!0},n.unstable_runWithPriority=function(he,Ne){switch(he){case 1:case 2:case 3:case 4:case 5:break;default:he=3}var xe=F;F=he;try{return Ne()}finally{F=xe}},n.unstable_scheduleCallback=function(he,Ne,xe){var we=n.unstable_now();switch(typeof xe=="object"&&xe!==null?(xe=xe.delay,xe=typeof xe=="number"&&0<xe?we+xe:we):xe=we,he){case 1:var ye=-1;break;case 2:ye=250;break;case 5:ye=1073741823;break;case 4:ye=1e4;break;default:ye=5e3}return ye=xe+ye,he={id:b++,callback:Ne,priorityLevel:he,startTime:xe,expirationTime:ye,sortIndex:-1},xe>we?(he.sortIndex=xe,a(g,he),t(m)===null&&he===t(g)&&(_?(H(se),se=-1):_=!0,ke(Z,xe-we))):(he.sortIndex=ye,a(m,he),M||C||(M=!0,ee||(ee=!0,J()))),he},n.unstable_shouldYield=pe,n.unstable_wrapCallback=function(he){var Ne=F;return function(){var xe=F;F=Ne;try{return he.apply(this,arguments)}finally{F=xe}}}})(xy)),xy}var Y5;function dS(){return Y5||(Y5=1,gy.exports=AS()),gy.exports}var by={exports:{}},Tl={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W5;function uS(){if(W5)return Tl;W5=1;var n=jb();function a(m){var g="https://react.dev/errors/"+m;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)g+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+m+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(a(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function e(m,g,b){var j=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:j==null?null:""+j,children:m,containerInfo:g,implementation:b}}var u=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(m,g){if(m==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return Tl.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Tl.createPortal=function(m,g){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(a(299));return e(m,g,null,b)},Tl.flushSync=function(m){var g=u.T,b=r.p;try{if(u.T=null,r.p=2,m)return m()}finally{u.T=g,r.p=b,r.d.f()}},Tl.preconnect=function(m,g){typeof m=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,r.d.C(m,g))},Tl.prefetchDNS=function(m){typeof m=="string"&&r.d.D(m)},Tl.preinit=function(m,g){if(typeof m=="string"&&g&&typeof g.as=="string"){var b=g.as,j=f(b,g.crossOrigin),F=typeof g.integrity=="string"?g.integrity:void 0,C=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;b==="style"?r.d.S(m,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:j,integrity:F,fetchPriority:C}):b==="script"&&r.d.X(m,{crossOrigin:j,integrity:F,fetchPriority:C,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},Tl.preinitModule=function(m,g){if(typeof m=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var b=f(g.as,g.crossOrigin);r.d.M(m,{crossOrigin:b,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&r.d.M(m)},Tl.preload=function(m,g){if(typeof m=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var b=g.as,j=f(b,g.crossOrigin);r.d.L(m,b,{crossOrigin:j,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},Tl.preloadModule=function(m,g){if(typeof m=="string")if(g){var b=f(g.as,g.crossOrigin);r.d.m(m,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:b,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else r.d.m(m)},Tl.requestFormReset=function(m){r.d.r(m)},Tl.unstable_batchedUpdates=function(m,g){return m(g)},Tl.useFormState=function(m,g,b){return u.H.useFormState(m,g,b)},Tl.useFormStatus=function(){return u.H.useHostTransitionStatus()},Tl.version="19.2.0",Tl}var $5;function zN(){if($5)return by.exports;$5=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(a){console.error(a)}}return n(),by.exports=uS(),by.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var q5;function fS(){if(q5)return m1;q5=1;var n=dS(),a=jb(),t=zN();function r(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)c+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function e(l){var c=l,p=l;if(l.alternate)for(;c.return;)c=c.return;else{l=c;do c=l,(c.flags&4098)!==0&&(p=c.return),l=c.return;while(l)}return c.tag===3?p:null}function u(l){if(l.tag===13){var c=l.memoizedState;if(c===null&&(l=l.alternate,l!==null&&(c=l.memoizedState)),c!==null)return c.dehydrated}return null}function f(l){if(l.tag===31){var c=l.memoizedState;if(c===null&&(l=l.alternate,l!==null&&(c=l.memoizedState)),c!==null)return c.dehydrated}return null}function m(l){if(e(l)!==l)throw Error(r(188))}function g(l){var c=l.alternate;if(!c){if(c=e(l),c===null)throw Error(r(188));return c!==l?null:l}for(var p=l,y=c;;){var k=p.return;if(k===null)break;var U=k.alternate;if(U===null){if(y=k.return,y!==null){p=y;continue}break}if(k.child===U.child){for(U=k.child;U;){if(U===p)return m(k),l;if(U===y)return m(k),c;U=U.sibling}throw Error(r(188))}if(p.return!==y.return)p=k,y=U;else{for(var Ae=!1,_e=k.child;_e;){if(_e===p){Ae=!0,p=k,y=U;break}if(_e===y){Ae=!0,y=k,p=U;break}_e=_e.sibling}if(!Ae){for(_e=U.child;_e;){if(_e===p){Ae=!0,p=U,y=k;break}if(_e===y){Ae=!0,y=U,p=k;break}_e=_e.sibling}if(!Ae)throw Error(r(189))}}if(p.alternate!==y)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?l:c}function b(l){var c=l.tag;if(c===5||c===26||c===27||c===6)return l;for(l=l.child;l!==null;){if(c=b(l),c!==null)return c;l=l.sibling}return null}var j=Object.assign,F=Symbol.for("react.element"),C=Symbol.for("react.transitional.element"),M=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),L=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),H=Symbol.for("react.consumer"),O=Symbol.for("react.context"),Q=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),ee=Symbol.for("react.suspense_list"),se=Symbol.for("react.memo"),ue=Symbol.for("react.lazy"),ae=Symbol.for("react.activity"),pe=Symbol.for("react.memo_cache_sentinel"),z=Symbol.iterator;function J(l){return l===null||typeof l!="object"?null:(l=z&&l[z]||l["@@iterator"],typeof l=="function"?l:null)}var ge=Symbol.for("react.client.reference");function fe(l){if(l==null)return null;if(typeof l=="function")return l.$$typeof===ge?null:l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case _:return"Fragment";case T:return"Profiler";case L:return"StrictMode";case Z:return"Suspense";case ee:return"SuspenseList";case ae:return"Activity"}if(typeof l=="object")switch(l.$$typeof){case M:return"Portal";case O:return l.displayName||"Context";case H:return(l._context.displayName||"Context")+".Consumer";case Q:var c=l.render;return l=l.displayName,l||(l=c.displayName||c.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case se:return c=l.displayName||null,c!==null?c:fe(l.type)||"Memo";case ue:c=l._payload,l=l._init;try{return fe(l(c))}catch{}}return null}var ke=Array.isArray,he=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ne=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,xe={pending:!1,data:null,method:null,action:null},we=[],ye=-1;function te(l){return{current:l}}function V(l){0>ye||(l.current=we[ye],we[ye]=null,ye--)}function le(l,c){ye++,we[ye]=l.current,l.current=c}var de=te(null),X=te(null),ie=te(null),G=te(null);function q(l,c){switch(le(ie,c),le(X,l),le(de,null),c.nodeType){case 9:case 11:l=(l=c.documentElement)&&(l=l.namespaceURI)?c1(l):0;break;default:if(l=c.tagName,c=c.namespaceURI)c=c1(c),l=iA(c,l);else switch(l){case"svg":l=1;break;case"math":l=2;break;default:l=0}}V(de),le(de,l)}function ve(){V(de),V(X),V(ie)}function Fe(l){l.memoizedState!==null&&le(G,l);var c=de.current,p=iA(c,l.type);c!==p&&(le(X,l),le(de,p))}function Qe(l){X.current===l&&(V(de),V(X)),G.current===l&&(V(G),Sr._currentValue=xe)}var Ge,je;function Me(l){if(Ge===void 0)try{throw Error()}catch(p){var c=p.stack.trim().match(/\n( *(at )?)/);Ge=c&&c[1]||"",je=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ge+l+je}var Se=!1;function ft(l,c){if(!l||Se)return"";Se=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var y={DetermineComponentFrameRoot:function(){try{if(c){var _t=function(){throw Error()};if(Object.defineProperty(_t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_t,[])}catch(Nt){var gt=Nt}Reflect.construct(l,[],_t)}else{try{_t.call()}catch(Nt){gt=Nt}l.call(_t.prototype)}}else{try{throw Error()}catch(Nt){gt=Nt}(_t=l())&&typeof _t.catch=="function"&&_t.catch(function(){})}}catch(Nt){if(Nt&&gt&&typeof Nt.stack=="string")return[Nt.stack,gt.stack]}return[null,null]}};y.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var k=Object.getOwnPropertyDescriptor(y.DetermineComponentFrameRoot,"name");k&&k.configurable&&Object.defineProperty(y.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var U=y.DetermineComponentFrameRoot(),Ae=U[0],_e=U[1];if(Ae&&_e){var Ve=Ae.split(`
`),lt=_e.split(`
`);for(k=y=0;y<Ve.length&&!Ve[y].includes("DetermineComponentFrameRoot");)y++;for(;k<lt.length&&!lt[k].includes("DetermineComponentFrameRoot");)k++;if(y===Ve.length||k===lt.length)for(y=Ve.length-1,k=lt.length-1;1<=y&&0<=k&&Ve[y]!==lt[k];)k--;for(;1<=y&&0<=k;y--,k--)if(Ve[y]!==lt[k]){if(y!==1||k!==1)do if(y--,k--,0>k||Ve[y]!==lt[k]){var kt=`
`+Ve[y].replace(" at new "," at ");return l.displayName&&kt.includes("<anonymous>")&&(kt=kt.replace("<anonymous>",l.displayName)),kt}while(1<=y&&0<=k);break}}}finally{Se=!1,Error.prepareStackTrace=p}return(p=l?l.displayName||l.name:"")?Me(p):""}function jt(l,c){switch(l.tag){case 26:case 27:case 5:return Me(l.type);case 16:return Me("Lazy");case 13:return l.child!==c&&c!==null?Me("Suspense Fallback"):Me("Suspense");case 19:return Me("SuspenseList");case 0:case 15:return ft(l.type,!1);case 11:return ft(l.type.render,!1);case 1:return ft(l.type,!0);case 31:return Me("Activity");default:return""}}function It(l){try{var c="",p=null;do c+=jt(l,p),p=l,l=l.return;while(l);return c}catch(y){return`
Error generating stack: `+y.message+`
`+y.stack}}var ut=Object.prototype.hasOwnProperty,Rt=n.unstable_scheduleCallback,Ye=n.unstable_cancelCallback,St=n.unstable_shouldYield,Jt=n.unstable_requestPaint,mr=n.unstable_now,ar=n.unstable_getCurrentPriorityLevel,bt=n.unstable_ImmediatePriority,Yt=n.unstable_UserBlockingPriority,vr=n.unstable_NormalPriority,gr=n.unstable_LowPriority,Mr=n.unstable_IdlePriority,Ot=n.log,ja=n.unstable_setDisableYieldValue,oa=null,hr=null;function pr(l){if(typeof Ot=="function"&&ja(l),hr&&typeof hr.setStrictMode=="function")try{hr.setStrictMode(oa,l)}catch{}}var Gr=Math.clz32?Math.clz32:jr,Pr=Math.log,wa=Math.LN2;function jr(l){return l>>>=0,l===0?32:31-(Pr(l)/wa|0)|0}var Ms=256,Rs=262144,or=4194304;function Nr(l){var c=l&42;if(c!==0)return c;switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return l&261888;case 262144:case 524288:case 1048576:case 2097152:return l&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return l&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return l}}function $t(l,c,p){var y=l.pendingLanes;if(y===0)return 0;var k=0,U=l.suspendedLanes,Ae=l.pingedLanes;l=l.warmLanes;var _e=y&134217727;return _e!==0?(y=_e&~U,y!==0?k=Nr(y):(Ae&=_e,Ae!==0?k=Nr(Ae):p||(p=_e&~l,p!==0&&(k=Nr(p))))):(_e=y&~U,_e!==0?k=Nr(_e):Ae!==0?k=Nr(Ae):p||(p=y&~l,p!==0&&(k=Nr(p)))),k===0?0:c!==0&&c!==k&&(c&U)===0&&(U=k&-k,p=c&-c,U>=p||U===32&&(p&4194048)!==0)?c:k}function Vo(l,c){return(l.pendingLanes&~(l.suspendedLanes&~l.pingedLanes)&c)===0}function Hn(l,c){switch(l){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function hs(){var l=or;return or<<=1,(or&62914560)===0&&(or=4194304),l}function co(l){for(var c=[],p=0;31>p;p++)c.push(l);return c}function ra(l,c){l.pendingLanes|=c,c!==268435456&&(l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0)}function ko(l,c,p,y,k,U){var Ae=l.pendingLanes;l.pendingLanes=p,l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0,l.expiredLanes&=p,l.entangledLanes&=p,l.errorRecoveryDisabledLanes&=p,l.shellSuspendCounter=0;var _e=l.entanglements,Ve=l.expirationTimes,lt=l.hiddenUpdates;for(p=Ae&~p;0<p;){var kt=31-Gr(p),_t=1<<kt;_e[kt]=0,Ve[kt]=-1;var gt=lt[kt];if(gt!==null)for(lt[kt]=null,kt=0;kt<gt.length;kt++){var Nt=gt[kt];Nt!==null&&(Nt.lane&=-536870913)}p&=~_t}y!==0&&zi(l,y,0),U!==0&&k===0&&l.tag!==0&&(l.suspendedLanes|=U&~(Ae&~c))}function zi(l,c,p){l.pendingLanes|=c,l.suspendedLanes&=~c;var y=31-Gr(c);l.entangledLanes|=c,l.entanglements[y]=l.entanglements[y]|1073741824|p&261930}function ms(l,c){var p=l.entangledLanes|=c;for(l=l.entanglements;p;){var y=31-Gr(p),k=1<<y;k&c|l[y]&c&&(l[y]|=c),p&=~k}}function pi(l,c){var p=c&-c;return p=(p&42)!==0?1:en(p),(p&(l.suspendedLanes|c))!==0?0:p}function en(l){switch(l){case 2:l=1;break;case 8:l=4;break;case 32:l=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:l=128;break;case 268435456:l=134217728;break;default:l=0}return l}function Tn(l){return l&=-l,2<l?8<l?(l&134217727)!==0?32:268435456:8:2}function _n(){var l=Ne.p;return l!==0?l:(l=window.event,l===void 0?32:We(l.type))}function Yo(l,c){var p=Ne.p;try{return Ne.p=l,c()}finally{Ne.p=p}}var Si=Math.random().toString(36).slice(2),Is="__reactFiber$"+Si,ba="__reactProps$"+Si,Cn="__reactContainer$"+Si,Oa="__reactEvents$"+Si,ss="__reactListeners$"+Si,gi="__reactHandles$"+Si,Wo="__reactResources$"+Si,Fi="__reactMarker$"+Si;function Hl(l){delete l[Is],delete l[ba],delete l[Oa],delete l[ss],delete l[gi]}function $o(l){var c=l[Is];if(c)return c;for(var p=l.parentNode;p;){if(c=p[Cn]||p[Is]){if(p=c.alternate,c.child!==null||p!==null&&p.child!==null)for(l=xx(l);l!==null;){if(p=l[Is])return p;l=xx(l)}return c}l=p,p=l.parentNode}return null}function Do(l){if(l=l[Is]||l[Cn]){var c=l.tag;if(c===5||c===6||c===13||c===31||c===26||c===27||c===3)return l}return null}function zl(l){var c=l.tag;if(c===5||c===26||c===27||c===6)return l.stateNode;throw Error(r(33))}function Ln(l){var c=l[Wo];return c||(c=l[Wo]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function hn(l){l[Fi]=!0}var tt=new Set,zt={};function qt(l,c){Ct(l,c),Ct(l+"Capture",c)}function Ct(l,c){for(zt[l]=c,l=0;l<c.length;l++)tt.add(c[l])}var Ar=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),$r={},Ra={};function Ba(l){return ut.call(Ra,l)?!0:ut.call($r,l)?!1:Ar.test(l)?Ra[l]=!0:($r[l]=!0,!1)}function tn(l,c,p){if(Ba(c))if(p===null)l.removeAttribute(c);else{switch(typeof p){case"undefined":case"function":case"symbol":l.removeAttribute(c);return;case"boolean":var y=c.toLowerCase().slice(0,5);if(y!=="data-"&&y!=="aria-"){l.removeAttribute(c);return}}l.setAttribute(c,""+p)}}function ns(l,c,p){if(p===null)l.removeAttribute(c);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(c);return}l.setAttribute(c,""+p)}}function Pa(l,c,p,y){if(y===null)l.removeAttribute(p);else{switch(typeof y){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(p);return}l.setAttributeNS(c,p,""+y)}}function ya(l){switch(typeof l){case"bigint":case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function Cr(l){var c=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function rn(l,c,p){var y=Object.getOwnPropertyDescriptor(l.constructor.prototype,c);if(!l.hasOwnProperty(c)&&typeof y<"u"&&typeof y.get=="function"&&typeof y.set=="function"){var k=y.get,U=y.set;return Object.defineProperty(l,c,{configurable:!0,get:function(){return k.call(this)},set:function(Ae){p=""+Ae,U.call(this,Ae)}}),Object.defineProperty(l,c,{enumerable:y.enumerable}),{getValue:function(){return p},setValue:function(Ae){p=""+Ae},stopTracking:function(){l._valueTracker=null,delete l[c]}}}}function jo(l){if(!l._valueTracker){var c=Cr(l)?"checked":"value";l._valueTracker=rn(l,c,""+l[c])}}function xi(l){if(!l)return!1;var c=l._valueTracker;if(!c)return!0;var p=c.getValue(),y="";return l&&(y=Cr(l)?l.checked?"true":"false":l.value),l=y,l!==p?(c.setValue(l),!0):!1}function Ki(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}var Gs=/[\n"\\]/g;function ma(l){return l.replace(Gs,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function qo(l,c,p,y,k,U,Ae,_e){l.name="",Ae!=null&&typeof Ae!="function"&&typeof Ae!="symbol"&&typeof Ae!="boolean"?l.type=Ae:l.removeAttribute("type"),c!=null?Ae==="number"?(c===0&&l.value===""||l.value!=c)&&(l.value=""+ya(c)):l.value!==""+ya(c)&&(l.value=""+ya(c)):Ae!=="submit"&&Ae!=="reset"||l.removeAttribute("value"),c!=null?Va(l,Ae,ya(c)):p!=null?Va(l,Ae,ya(p)):y!=null&&l.removeAttribute("value"),k==null&&U!=null&&(l.defaultChecked=!!U),k!=null&&(l.checked=k&&typeof k!="function"&&typeof k!="symbol"),_e!=null&&typeof _e!="function"&&typeof _e!="symbol"&&typeof _e!="boolean"?l.name=""+ya(_e):l.removeAttribute("name")}function oc(l,c,p,y,k,U,Ae,_e){if(U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"&&(l.type=U),c!=null||p!=null){if(!(U!=="submit"&&U!=="reset"||c!=null)){jo(l);return}p=p!=null?""+ya(p):"",c=c!=null?""+ya(c):p,_e||c===l.value||(l.value=c),l.defaultValue=c}y=y??k,y=typeof y!="function"&&typeof y!="symbol"&&!!y,l.checked=_e?l.checked:!!y,l.defaultChecked=!!y,Ae!=null&&typeof Ae!="function"&&typeof Ae!="symbol"&&typeof Ae!="boolean"&&(l.name=Ae),jo(l)}function Va(l,c,p){c==="number"&&Ki(l.ownerDocument)===l||l.defaultValue===""+p||(l.defaultValue=""+p)}function li(l,c,p,y){if(l=l.options,c){c={};for(var k=0;k<p.length;k++)c["$"+p[k]]=!0;for(p=0;p<l.length;p++)k=c.hasOwnProperty("$"+l[p].value),l[p].selected!==k&&(l[p].selected=k),k&&y&&(l[p].defaultSelected=!0)}else{for(p=""+ya(p),c=null,k=0;k<l.length;k++){if(l[k].value===p){l[k].selected=!0,y&&(l[k].defaultSelected=!0);return}c!==null||l[k].disabled||(c=l[k])}c!==null&&(c.selected=!0)}}function Fs(l,c,p){if(c!=null&&(c=""+ya(c),c!==l.value&&(l.value=c),p==null)){l.defaultValue!==c&&(l.defaultValue=c);return}l.defaultValue=p!=null?""+ya(p):""}function Gi(l,c,p,y){if(c==null){if(y!=null){if(p!=null)throw Error(r(92));if(ke(y)){if(1<y.length)throw Error(r(93));y=y[0]}p=y}p==null&&(p=""),c=p}p=ya(c),l.defaultValue=p,y=l.textContent,y===p&&y!==""&&y!==null&&(l.value=y),jo(l)}function Vi(l,c){if(c){var p=l.firstChild;if(p&&p===l.lastChild&&p.nodeType===3){p.nodeValue=c;return}}l.textContent=c}var ls=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function jn(l,c,p){var y=c.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?y?l.setProperty(c,""):c==="float"?l.cssFloat="":l[c]="":y?l.setProperty(c,p):typeof p!="number"||p===0||ls.has(c)?c==="float"?l.cssFloat=p:l[c]=(""+p).trim():l[c]=p+"px"}function Ps(l,c,p){if(c!=null&&typeof c!="object")throw Error(r(62));if(l=l.style,p!=null){for(var y in p)!p.hasOwnProperty(y)||c!=null&&c.hasOwnProperty(y)||(y.indexOf("--")===0?l.setProperty(y,""):y==="float"?l.cssFloat="":l[y]="");for(var k in c)y=c[k],c.hasOwnProperty(k)&&p[k]!==y&&jn(l,k,y)}else for(var U in c)c.hasOwnProperty(U)&&jn(l,U,c[U])}function HA(l){if(l.indexOf("-")===-1)return!1;switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),hA=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Xo(l){return hA.test(""+l)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":l}function To(){}var yl=null;function cs(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var aa=null,vl=null;function mu(l){var c=Do(l);if(c&&(l=c.stateNode)){var p=l[ba]||null;e:switch(l=c.stateNode,c.type){case"input":if(qo(l,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),c=p.name,p.type==="radio"&&c!=null){for(p=l;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+ma(""+c)+'"][type="radio"]'),c=0;c<p.length;c++){var y=p[c];if(y!==l&&y.form===l.form){var k=y[ba]||null;if(!k)throw Error(r(90));qo(y,k.value,k.defaultValue,k.defaultValue,k.checked,k.defaultChecked,k.type,k.name)}}for(c=0;c<p.length;c++)y=p[c],y.form===l.form&&xi(y)}break e;case"textarea":Fs(l,p.value,p.defaultValue);break e;case"select":c=p.value,c!=null&&li(l,!!p.multiple,c,!1)}}}var pu=!1;function df(l,c,p){if(pu)return l(c,p);pu=!0;try{var y=l(c);return y}finally{if(pu=!1,(aa!==null||vl!==null)&&(nm(),aa&&(c=aa,l=vl,vl=aa=null,mu(c),l)))for(c=0;c<l.length;c++)mu(l[c])}}function Jo(l,c){var p=l.stateNode;if(p===null)return null;var y=p[ba]||null;if(y===null)return null;p=y[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(l=l.type,y=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!y;break e;default:l=!1}if(l)return null;if(p&&typeof p!="function")throw Error(r(231,c,typeof p));return p}var Ei=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Dd=!1;if(Ei)try{var Un={};Object.defineProperty(Un,"passive",{get:function(){Dd=!0}}),window.addEventListener("test",Un,Un),window.removeEventListener("test",Un,Un)}catch{Dd=!1}var Yi=null,lr=null,wl=null;function Mc(){if(wl)return wl;var l,c=lr,p=c.length,y,k="value"in Yi?Yi.value:Yi.textContent,U=k.length;for(l=0;l<p&&c[l]===k[l];l++);var Ae=p-l;for(y=1;y<=Ae&&c[p-y]===k[U-y];y++);return wl=k.slice(l,1<y?1-y:void 0)}function Zo(l){var c=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&c===13&&(l=13)):l=c,l===10&&(l=13),32<=l||l===13?l:0}function Bn(){return!0}function Nl(){return!1}function Ts(l){function c(p,y,k,U,Ae){this._reactName=p,this._targetInst=k,this.type=y,this.nativeEvent=U,this.target=Ae,this.currentTarget=null;for(var _e in l)l.hasOwnProperty(_e)&&(p=l[_e],this[_e]=p?p(U):U[_e]);return this.isDefaultPrevented=(U.defaultPrevented!=null?U.defaultPrevented:U.returnValue===!1)?Bn:Nl,this.isPropagationStopped=Nl,this}return j(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Bn)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Bn)},persist:function(){},isPersistent:Bn}),c}var _o={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Kl=Ts(_o),lc=j({},_o,{view:0,detail:0}),zA=Ts(lc),mA,cc,Ic,pA=j({},lc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:va,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==Ic&&(Ic&&l.type==="mousemove"?(mA=l.screenX-Ic.screenX,cc=l.screenY-Ic.screenY):cc=mA=0,Ic=l),mA)},movementY:function(l){return"movementY"in l?l.movementY:cc}}),Gl=Ts(pA),Ac=j({},pA,{dataTransfer:0}),gu=Ts(Ac),KA=j({},lc,{relatedTarget:0}),dc=Ts(KA),Oc=j({},_o,{animationName:0,elapsedTime:0,pseudoElement:0}),R=Ts(Oc),Ce=j({},_o,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),Ke=Ts(Ce),Xe=j({},_o,{data:0}),nt=Ts(Xe),Lt={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Gt={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ir={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Qr(l){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(l):(l=Ir[l])?!!c[l]:!1}function va(){return Qr}var Xr=j({},lc,{key:function(l){if(l.key){var c=Lt[l.key]||l.key;if(c!=="Unidentified")return c}return l.type==="keypress"?(l=Zo(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?Gt[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:va,charCode:function(l){return l.type==="keypress"?Zo(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?Zo(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),$a=Ts(Xr),Mn=j({},pA,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),mn=Ts(Mn),an=j({},lc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:va}),bi=Ts(an),ci=j({},_o,{propertyName:0,elapsedTime:0,pseudoElement:0}),Wi=Ts(ci),el=j({},pA,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),_s=Ts(el),yi=j({},_o,{newState:0,oldState:0}),Ft=Ts(yi),Bo=[9,13,27,32],In=Ei&&"CompositionEvent"in window,Pt=null;Ei&&"documentMode"in document&&(Pt=document.documentMode);var Vl=Ei&&"TextEvent"in window&&!Pt,Qc=Ei&&(!In||Pt&&8<Pt&&11>=Pt),ti=" ",uc=!1;function fc(l,c){switch(l){case"keyup":return Bo.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vs(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var Cl=!1;function Sa(l,c){switch(l){case"compositionend":return Vs(c);case"keypress":return c.which!==32?null:(uc=!0,ti);case"textInput":return l=c.data,l===ti&&uc?null:l;default:return null}}function Es(l,c){if(Cl)return l==="compositionend"||!In&&fc(l,c)?(l=Mc(),wl=lr=Yi=null,Cl=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Qc&&c.locale!=="ko"?null:c.data;default:return null}}var ha={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vi(l){var c=l&&l.nodeName&&l.nodeName.toLowerCase();return c==="input"?!!ha[l.type]:c==="textarea"}function fa(l,c,p,y){aa?vl?vl.push(y):vl=[y]:aa=y,c=X0(c,"onChange"),0<c.length&&(p=new Kl("onChange","change",null,p,y),l.push({event:p,listeners:c}))}var Fa=null,Rc=null;function Lo(l){hx(l,0)}function ki(l){var c=zl(l);if(xi(c))return l}function Pc(l,c){if(l==="change")return c}var wi=!1;if(Ei){var pn;if(Ei){var gn="oninput"in document;if(!gn){var Ys=document.createElement("div");Ys.setAttribute("oninput","return;"),gn=typeof Ys.oninput=="function"}pn=gn}else pn=!1;wi=pn&&(!document.documentMode||9<document.documentMode)}function Yl(){Fa&&(Fa.detachEvent("onpropertychange",Td),Rc=Fa=null)}function Td(l){if(l.propertyName==="value"&&ki(Rc)){var c=[];fa(c,Rc,l,cs(l)),df(Lo,c)}}function _d(l,c,p){l==="focusin"?(Yl(),Fa=c,Rc=p,Fa.attachEvent("onpropertychange",Td)):l==="focusout"&&Yl()}function ys(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return ki(Rc)}function hc(l,c){if(l==="click")return ki(c)}function Ao(l,c){if(l==="input"||l==="change")return ki(c)}function uo(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var $i=typeof Object.is=="function"?Object.is:uo;function mc(l,c){if($i(l,c))return!0;if(typeof l!="object"||l===null||typeof c!="object"||c===null)return!1;var p=Object.keys(l),y=Object.keys(c);if(p.length!==y.length)return!1;for(y=0;y<p.length;y++){var k=p[y];if(!ut.call(c,k)||!$i(l[k],c[k]))return!1}return!0}function gA(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function Hc(l,c){var p=gA(l);l=0;for(var y;p;){if(p.nodeType===3){if(y=l+p.textContent.length,l<=c&&y>=c)return{node:p,offset:c-l};l=y}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=gA(p)}}function zc(l,c){return l&&c?l===c?!0:l&&l.nodeType===3?!1:c&&c.nodeType===3?zc(l,c.parentNode):"contains"in l?l.contains(c):l.compareDocumentPosition?!!(l.compareDocumentPosition(c)&16):!1:!1}function Wl(l){l=l!=null&&l.ownerDocument!=null&&l.ownerDocument.defaultView!=null?l.ownerDocument.defaultView:window;for(var c=Ki(l.document);c instanceof l.HTMLIFrameElement;){try{var p=typeof c.contentWindow.location.href=="string"}catch{p=!1}if(p)l=c.contentWindow;else break;c=Ki(l.document)}return c}function jl(l){var c=l&&l.nodeName&&l.nodeName.toLowerCase();return c&&(c==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||c==="textarea"||l.contentEditable==="true")}var Kc=Ei&&"documentMode"in document&&11>=document.documentMode,Uo=null,pc=null,zn=null,qi=!1;function Ea(l,c,p){var y=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;qi||Uo==null||Uo!==Ki(y)||(y=Uo,"selectionStart"in y&&jl(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),zn&&mc(zn,y)||(zn=y,y=X0(pc,"onSelect"),0<y.length&&(c=new Kl("onSelect","select",null,c,p),l.push({event:c,listeners:y}),c.target=Uo)))}function Ya(l,c){var p={};return p[l.toLowerCase()]=c.toLowerCase(),p["Webkit"+l]="webkit"+c,p["Moz"+l]="moz"+c,p}var Os={animationend:Ya("Animation","AnimationEnd"),animationiteration:Ya("Animation","AnimationIteration"),animationstart:Ya("Animation","AnimationStart"),transitionrun:Ya("Transition","TransitionRun"),transitionstart:Ya("Transition","TransitionStart"),transitioncancel:Ya("Transition","TransitionCancel"),transitionend:Ya("Transition","TransitionEnd")},Kn={},Bl={};Ei&&(Bl=document.createElement("div").style,"AnimationEvent"in window||(delete Os.animationend.animation,delete Os.animationiteration.animation,delete Os.animationstart.animation),"TransitionEvent"in window||delete Os.transitionend.transition);function Sn(l){if(Kn[l])return Kn[l];if(!Os[l])return l;var c=Os[l],p;for(p in c)if(c.hasOwnProperty(p)&&p in Bl)return Kn[l]=c[p];return l}var xA=Sn("animationend"),Ld=Sn("animationiteration"),p0=Sn("animationstart"),uf=Sn("transitionrun"),ff=Sn("transitionstart"),g0=Sn("transitioncancel"),x0=Sn("transitionend"),GA=new Map,So="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");So.push("scrollEnd");function tl(l,c){GA.set(l,c),qt(c,[l])}var VA=typeof reportError=="function"?reportError:function(l){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof l=="object"&&l!==null&&typeof l.message=="string"?String(l.message):String(l),error:l});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",l);return}console.error(l)},fo=[],Gc=0,xu=0;function Ta(){for(var l=Gc,c=xu=Gc=0;c<l;){var p=fo[c];fo[c++]=null;var y=fo[c];fo[c++]=null;var k=fo[c];fo[c++]=null;var U=fo[c];if(fo[c++]=null,y!==null&&k!==null){var Ae=y.pending;Ae===null?k.next=k:(k.next=Ae.next,Ae.next=k),y.pending=k}U!==0&&ps(p,k,U)}}function Vc(l,c,p,y){fo[Gc++]=l,fo[Gc++]=c,fo[Gc++]=p,fo[Gc++]=y,xu|=y,l.lanes|=y,l=l.alternate,l!==null&&(l.lanes|=y)}function bA(l,c,p,y){return Vc(l,c,p,y),ho(l)}function Mo(l,c){return Vc(l,null,null,c),ho(l)}function ps(l,c,p){l.lanes|=p;var y=l.alternate;y!==null&&(y.lanes|=p);for(var k=!1,U=l.return;U!==null;)U.childLanes|=p,y=U.alternate,y!==null&&(y.childLanes|=p),U.tag===22&&(l=U.stateNode,l===null||l._visibility&1||(k=!0)),l=U,U=U.return;return l.tag===3?(U=l.stateNode,k&&c!==null&&(k=31-Gr(p),l=U.hiddenUpdates,y=l[k],y===null?l[k]=[c]:y.push(c),c.lane=p|536870912),U):null}function ho(l){if(50<z0)throw z0=0,K0=null,Error(r(185));for(var c=l.return;c!==null;)l=c,c=l.return;return l.tag===3?l.stateNode:null}var Di={};function bu(l,c,p,y){this.tag=l,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ws(l,c,p,y){return new bu(l,c,p,y)}function hf(l){return l=l.prototype,!(!l||!l.isReactComponent)}function rl(l,c){var p=l.alternate;return p===null?(p=Ws(l.tag,c,l.key,l.mode),p.elementType=l.elementType,p.type=l.type,p.stateNode=l.stateNode,p.alternate=l,l.alternate=p):(p.pendingProps=c,p.type=l.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=l.flags&65011712,p.childLanes=l.childLanes,p.lanes=l.lanes,p.child=l.child,p.memoizedProps=l.memoizedProps,p.memoizedState=l.memoizedState,p.updateQueue=l.updateQueue,c=l.dependencies,p.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},p.sibling=l.sibling,p.index=l.index,p.ref=l.ref,p.refCleanup=l.refCleanup,p}function YA(l,c){l.flags&=65011714;var p=l.alternate;return p===null?(l.childLanes=0,l.lanes=c,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=p.childLanes,l.lanes=p.lanes,l.child=p.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=p.memoizedProps,l.memoizedState=p.memoizedState,l.updateQueue=p.updateQueue,l.type=p.type,c=p.dependencies,l.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),l}function WA(l,c,p,y,k,U){var Ae=0;if(y=l,typeof l=="function")hf(l)&&(Ae=1);else if(typeof l=="string")Ae=wr(l,p,de.current)?26:l==="html"||l==="head"||l==="body"?27:5;else e:switch(l){case ae:return l=Ws(31,p,c,k),l.elementType=ae,l.lanes=U,l;case _:return Io(p.children,k,U,c);case L:Ae=8,k|=24;break;case T:return l=Ws(12,p,c,k|2),l.elementType=T,l.lanes=U,l;case Z:return l=Ws(13,p,c,k),l.elementType=Z,l.lanes=U,l;case ee:return l=Ws(19,p,c,k),l.elementType=ee,l.lanes=U,l;default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case O:Ae=10;break e;case H:Ae=9;break e;case Q:Ae=11;break e;case se:Ae=14;break e;case ue:Ae=16,y=null;break e}Ae=29,p=Error(r(130,l===null?"null":typeof l,"")),y=null}return c=Ws(Ae,p,c,k),c.elementType=l,c.type=y,c.lanes=U,c}function Io(l,c,p,y){return l=Ws(7,l,y,c),l.lanes=p,l}function Ud(l,c,p){return l=Ws(6,l,null,c),l.lanes=p,l}function yu(l){var c=Ws(18,null,null,0);return c.stateNode=l,c}function $A(l,c,p){return c=Ws(4,l.children!==null?l.children:[],l.key,c),c.lanes=p,c.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},c}var mf=new WeakMap;function al(l,c){if(typeof l=="object"&&l!==null){var p=mf.get(l);return p!==void 0?p:(c={value:l,source:c,stack:It(c)},mf.set(l,c),c)}return{value:l,source:c,stack:It(c)}}var qA=[],Yc=0,Md=null,Id=0,sl=[],nl=0,Wc=null,Sl=1,il="";function Oo(l,c){qA[Yc++]=Id,qA[Yc++]=Md,Md=l,Id=c}function vu(l,c,p){sl[nl++]=Sl,sl[nl++]=il,sl[nl++]=Wc,Wc=l;var y=Sl;l=il;var k=32-Gr(y)-1;y&=~(1<<k),p+=1;var U=32-Gr(c)+k;if(30<U){var Ae=k-k%5;U=(y&(1<<Ae)-1).toString(32),y>>=Ae,k-=Ae,Sl=1<<32-Gr(c)+k|p<<k|y,il=U+l}else Sl=1<<U|p<<k|y,il=l}function pf(l){l.return!==null&&(Oo(l,1),vu(l,1,0))}function wu(l){for(;l===Md;)Md=qA[--Yc],qA[Yc]=null,Id=qA[--Yc],qA[Yc]=null;for(;l===Wc;)Wc=sl[--nl],sl[nl]=null,il=sl[--nl],sl[nl]=null,Sl=sl[--nl],sl[nl]=null}function b0(l,c){sl[nl++]=Sl,sl[nl++]=il,sl[nl++]=Wc,Sl=c.id,il=c.overflow,Wc=l}var Ti=null,sn=null,es=!1,Gn=null,Ma=!1,xn=Error(r(519));function $s(l){var c=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw xc(al(c,l)),xn}function Qo(l){var c=l.stateNode,p=l.type,y=l.memoizedProps;switch(c[Is]=l,c[ba]=y,p){case"dialog":ga("cancel",c),ga("close",c);break;case"iframe":case"object":case"embed":ga("load",c);break;case"video":case"audio":for(p=0;p<Pu.length;p++)ga(Pu[p],c);break;case"source":ga("error",c);break;case"img":case"image":case"link":ga("error",c),ga("load",c);break;case"details":ga("toggle",c);break;case"input":ga("invalid",c),oc(c,y.value,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name,!0);break;case"select":ga("invalid",c);break;case"textarea":ga("invalid",c),Gi(c,y.value,y.defaultValue,y.children)}p=y.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||c.textContent===""+p||y.suppressHydrationWarning===!0||s1(c.textContent,p)?(y.popover!=null&&(ga("beforetoggle",c),ga("toggle",c)),y.onScroll!=null&&ga("scroll",c),y.onScrollEnd!=null&&ga("scrollend",c),y.onClick!=null&&(c.onclick=To),c=!0):c=!1,c||$s(l,!0)}function gc(l){for(Ti=l.return;Ti;)switch(Ti.tag){case 5:case 31:case 13:Ma=!1;return;case 27:case 3:Ma=!0;return;default:Ti=Ti.return}}function _i(l){if(l!==Ti)return!1;if(!es)return gc(l),es=!0,!1;var c=l.tag,p;if((p=c!==3&&c!==27)&&((p=c===5)&&(p=l.type,p=!(p!=="form"&&p!=="button")||zf(l.type,l.memoizedProps)),p=!p),p&&sn&&$s(l),gc(l),c===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(r(317));sn=us(l)}else if(c===31){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(r(317));sn=us(l)}else c===27?(c=sn,ud(l.type)?(l=$d,$d=null,sn=l):sn=c):sn=Ti?tc(l.stateNode.nextSibling):null;return!0}function $l(){sn=Ti=null,es=!1}function $c(){var l=Gn;return l!==null&&(kl===null?kl=l:kl.push.apply(kl,l),Gn=null),l}function xc(l){Gn===null?Gn=[l]:Gn.push(l)}var bc=te(null),qc=null,yc=null;function ql(l,c,p){le(bc,c._currentValue),c._currentValue=p}function ol(l){l._currentValue=bc.current,V(bc)}function XA(l,c,p){for(;l!==null;){var y=l.alternate;if((l.childLanes&c)!==c?(l.childLanes|=c,y!==null&&(y.childLanes|=c)):y!==null&&(y.childLanes&c)!==c&&(y.childLanes|=c),l===p)break;l=l.return}}function yA(l,c,p,y){var k=l.child;for(k!==null&&(k.return=l);k!==null;){var U=k.dependencies;if(U!==null){var Ae=k.child;U=U.firstContext;e:for(;U!==null;){var _e=U;U=k;for(var Ve=0;Ve<c.length;Ve++)if(_e.context===c[Ve]){U.lanes|=p,_e=U.alternate,_e!==null&&(_e.lanes|=p),XA(U.return,p,l),y||(Ae=null);break e}U=_e.next}}else if(k.tag===18){if(Ae=k.return,Ae===null)throw Error(r(341));Ae.lanes|=p,U=Ae.alternate,U!==null&&(U.lanes|=p),XA(Ae,p,l),Ae=null}else Ae=k.child;if(Ae!==null)Ae.return=k;else for(Ae=k;Ae!==null;){if(Ae===l){Ae=null;break}if(k=Ae.sibling,k!==null){k.return=Ae.return,Ae=k;break}Ae=Ae.return}k=Ae}}function Xi(l,c,p,y){l=null;for(var k=c,U=!1;k!==null;){if(!U){if((k.flags&524288)!==0)U=!0;else if((k.flags&262144)!==0)break}if(k.tag===10){var Ae=k.alternate;if(Ae===null)throw Error(r(387));if(Ae=Ae.memoizedProps,Ae!==null){var _e=k.type;$i(k.pendingProps.value,Ae.value)||(l!==null?l.push(_e):l=[_e])}}else if(k===G.current){if(Ae=k.alternate,Ae===null)throw Error(r(387));Ae.memoizedState.memoizedState!==k.memoizedState.memoizedState&&(l!==null?l.push(Sr):l=[Sr])}k=k.return}l!==null&&yA(c,l,p,y),c.flags|=262144}function vc(l){for(l=l.firstContext;l!==null;){if(!$i(l.context._currentValue,l.memoizedValue))return!0;l=l.next}return!1}function Xc(l){qc=l,yc=null,l=l.dependencies,l!==null&&(l.firstContext=null)}function Ai(l){return y0(qc,l)}function Nu(l,c){return qc===null&&Xc(l),y0(l,c)}function y0(l,c){var p=c._currentValue;if(c={context:c,memoizedValue:p,next:null},yc===null){if(l===null)throw Error(r(308));yc=c,l.dependencies={lanes:0,firstContext:c},l.flags|=524288}else yc=yc.next=c;return p}var pp=typeof AbortController<"u"?AbortController:function(){var l=[],c=this.signal={aborted:!1,addEventListener:function(p,y){l.push(y)}};this.abort=function(){c.aborted=!0,l.forEach(function(p){return p()})}},_h=n.unstable_scheduleCallback,mo=n.unstable_NormalPriority,ri={$$typeof:O,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Jc(){return{controller:new pp,data:new Map,refCount:0}}function JA(l){l.refCount--,l.refCount===0&&_h(mo,function(){l.controller.abort()})}var Cu=null,ju=0,B=0,D=null;function Y(l,c){if(Cu===null){var p=Cu=[];ju=0,B=rs(),D={status:"pending",value:void 0,then:function(y){p.push(y)}}}return ju++,c.then(oe,oe),c}function oe(){if(--ju===0&&Cu!==null){D!==null&&(D.status="fulfilled");var l=Cu;Cu=null,B=0,D=null;for(var c=0;c<l.length;c++)(0,l[c])()}}function Be(l,c){var p=[],y={status:"pending",value:null,reason:null,then:function(k){p.push(k)}};return l.then(function(){y.status="fulfilled",y.value=c;for(var k=0;k<p.length;k++)(0,p[k])(c)},function(k){for(y.status="rejected",y.reason=k,k=0;k<p.length;k++)(0,p[k])(void 0)}),y}var Te=he.S;he.S=function(l,c){Xg=mr(),typeof c=="object"&&c!==null&&typeof c.then=="function"&&Y(l,c),Te!==null&&Te(l,c)};var Le=te(null);function Oe(){var l=Le.current;return l!==null?l:yn.pooledCache}function Re(l,c){c===null?le(Le,Le.current):le(Le,c.pool)}function ze(){var l=Oe();return l===null?null:{parent:ri._currentValue,pool:l}}var Ze=Error(r(460)),ht=Error(r(474)),He=Error(r(542)),at={then:function(){}};function ot(l){return l=l.status,l==="fulfilled"||l==="rejected"}function Dt(l,c,p){switch(p=l[p],p===void 0?l.push(c):p!==c&&(c.then(To,To),c=p),c.status){case"fulfilled":return c.value;case"rejected":throw l=c.reason,Xt(l),l;default:if(typeof c.status=="string")c.then(To,To);else{if(l=yn,l!==null&&100<l.shellSuspendCounter)throw Error(r(482));l=c,l.status="pending",l.then(function(y){if(c.status==="pending"){var k=c;k.status="fulfilled",k.value=y}},function(y){if(c.status==="pending"){var k=c;k.status="rejected",k.reason=y}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw l=c.reason,Xt(l),l}throw Et=c,Ze}}function ct(l){try{var c=l._init;return c(l._payload)}catch(p){throw p!==null&&typeof p=="object"&&typeof p.then=="function"?(Et=p,Ze):p}}var Et=null;function Ut(){if(Et===null)throw Error(r(459));var l=Et;return Et=null,l}function Xt(l){if(l===Ze||l===He)throw Error(r(483))}var Kt=null,Vr=0;function Tr(l){var c=Vr;return Vr+=1,Kt===null&&(Kt=[]),Dt(Kt,l,c)}function ka(l,c){c=c.props.ref,l.ref=c!==void 0?c:null}function zr(l,c){throw c.$$typeof===F?Error(r(525)):(l=Object.prototype.toString.call(c),Error(r(31,l==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":l)))}function Ka(l){function c(it,et){if(l){var xt=it.deletions;xt===null?(it.deletions=[et],it.flags|=16):xt.push(et)}}function p(it,et){if(!l)return null;for(;et!==null;)c(it,et),et=et.sibling;return null}function y(it){for(var et=new Map;it!==null;)it.key!==null?et.set(it.key,it):et.set(it.index,it),it=it.sibling;return et}function k(it,et){return it=rl(it,et),it.index=0,it.sibling=null,it}function U(it,et,xt){return it.index=xt,l?(xt=it.alternate,xt!==null?(xt=xt.index,xt<et?(it.flags|=67108866,et):xt):(it.flags|=67108866,et)):(it.flags|=1048576,et)}function Ae(it){return l&&it.alternate===null&&(it.flags|=67108866),it}function _e(it,et,xt,Ht){return et===null||et.tag!==6?(et=Ud(xt,it.mode,Ht),et.return=it,et):(et=k(et,xt),et.return=it,et)}function Ve(it,et,xt,Ht){var xa=xt.type;return xa===_?kt(it,et,xt.props.children,Ht,xt.key):et!==null&&(et.elementType===xa||typeof xa=="object"&&xa!==null&&xa.$$typeof===ue&&ct(xa)===et.type)?(et=k(et,xt.props),ka(et,xt),et.return=it,et):(et=WA(xt.type,xt.key,xt.props,null,it.mode,Ht),ka(et,xt),et.return=it,et)}function lt(it,et,xt,Ht){return et===null||et.tag!==4||et.stateNode.containerInfo!==xt.containerInfo||et.stateNode.implementation!==xt.implementation?(et=$A(xt,it.mode,Ht),et.return=it,et):(et=k(et,xt.children||[]),et.return=it,et)}function kt(it,et,xt,Ht,xa){return et===null||et.tag!==7?(et=Io(xt,it.mode,Ht,xa),et.return=it,et):(et=k(et,xt),et.return=it,et)}function _t(it,et,xt){if(typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint")return et=Ud(""+et,it.mode,xt),et.return=it,et;if(typeof et=="object"&&et!==null){switch(et.$$typeof){case C:return xt=WA(et.type,et.key,et.props,null,it.mode,xt),ka(xt,et),xt.return=it,xt;case M:return et=$A(et,it.mode,xt),et.return=it,et;case ue:return et=ct(et),_t(it,et,xt)}if(ke(et)||J(et))return et=Io(et,it.mode,xt,null),et.return=it,et;if(typeof et.then=="function")return _t(it,Tr(et),xt);if(et.$$typeof===O)return _t(it,Nu(it,et),xt);zr(it,et)}return null}function gt(it,et,xt,Ht){var xa=et!==null?et.key:null;if(typeof xt=="string"&&xt!==""||typeof xt=="number"||typeof xt=="bigint")return xa!==null?null:_e(it,et,""+xt,Ht);if(typeof xt=="object"&&xt!==null){switch(xt.$$typeof){case C:return xt.key===xa?Ve(it,et,xt,Ht):null;case M:return xt.key===xa?lt(it,et,xt,Ht):null;case ue:return xt=ct(xt),gt(it,et,xt,Ht)}if(ke(xt)||J(xt))return xa!==null?null:kt(it,et,xt,Ht,null);if(typeof xt.then=="function")return gt(it,et,Tr(xt),Ht);if(xt.$$typeof===O)return gt(it,et,Nu(it,xt),Ht);zr(it,xt)}return null}function Nt(it,et,xt,Ht,xa){if(typeof Ht=="string"&&Ht!==""||typeof Ht=="number"||typeof Ht=="bigint")return it=it.get(xt)||null,_e(et,it,""+Ht,xa);if(typeof Ht=="object"&&Ht!==null){switch(Ht.$$typeof){case C:return it=it.get(Ht.key===null?xt:Ht.key)||null,Ve(et,it,Ht,xa);case M:return it=it.get(Ht.key===null?xt:Ht.key)||null,lt(et,it,Ht,xa);case ue:return Ht=ct(Ht),Nt(it,et,xt,Ht,xa)}if(ke(Ht)||J(Ht))return it=it.get(xt)||null,kt(et,it,Ht,xa,null);if(typeof Ht.then=="function")return Nt(it,et,xt,Tr(Ht),xa);if(Ht.$$typeof===O)return Nt(it,et,xt,Nu(et,Ht),xa);zr(et,Ht)}return null}function Wr(it,et,xt,Ht){for(var xa=null,zs=null,la=et,Za=et=0,Ns=null;la!==null&&Za<xt.length;Za++){la.index>Za?(Ns=la,la=null):Ns=la.sibling;var Ks=gt(it,la,xt[Za],Ht);if(Ks===null){la===null&&(la=Ns);break}l&&la&&Ks.alternate===null&&c(it,la),et=U(Ks,et,Za),zs===null?xa=Ks:zs.sibling=Ks,zs=Ks,la=Ns}if(Za===xt.length)return p(it,la),es&&Oo(it,Za),xa;if(la===null){for(;Za<xt.length;Za++)la=_t(it,xt[Za],Ht),la!==null&&(et=U(la,et,Za),zs===null?xa=la:zs.sibling=la,zs=la);return es&&Oo(it,Za),xa}for(la=y(la);Za<xt.length;Za++)Ns=Nt(la,it,Za,xt[Za],Ht),Ns!==null&&(l&&Ns.alternate!==null&&la.delete(Ns.key===null?Za:Ns.key),et=U(Ns,et,Za),zs===null?xa=Ns:zs.sibling=Ns,zs=Ns);return l&&la.forEach(function(Gf){return c(it,Gf)}),es&&Oo(it,Za),xa}function Ca(it,et,xt,Ht){if(xt==null)throw Error(r(151));for(var xa=null,zs=null,la=et,Za=et=0,Ns=null,Ks=xt.next();la!==null&&!Ks.done;Za++,Ks=xt.next()){la.index>Za?(Ns=la,la=null):Ns=la.sibling;var Gf=gt(it,la,Ks.value,Ht);if(Gf===null){la===null&&(la=Ns);break}l&&la&&Gf.alternate===null&&c(it,la),et=U(Gf,et,Za),zs===null?xa=Gf:zs.sibling=Gf,zs=Gf,la=Ns}if(Ks.done)return p(it,la),es&&Oo(it,Za),xa;if(la===null){for(;!Ks.done;Za++,Ks=xt.next())Ks=_t(it,Ks.value,Ht),Ks!==null&&(et=U(Ks,et,Za),zs===null?xa=Ks:zs.sibling=Ks,zs=Ks);return es&&Oo(it,Za),xa}for(la=y(la);!Ks.done;Za++,Ks=xt.next())Ks=Nt(la,it,Za,Ks.value,Ht),Ks!==null&&(l&&Ks.alternate!==null&&la.delete(Ks.key===null?Za:Ks.key),et=U(Ks,et,Za),zs===null?xa=Ks:zs.sibling=Ks,zs=Ks);return l&&la.forEach(function(sS){return c(it,sS)}),es&&Oo(it,Za),xa}function kn(it,et,xt,Ht){if(typeof xt=="object"&&xt!==null&&xt.type===_&&xt.key===null&&(xt=xt.props.children),typeof xt=="object"&&xt!==null){switch(xt.$$typeof){case C:e:{for(var xa=xt.key;et!==null;){if(et.key===xa){if(xa=xt.type,xa===_){if(et.tag===7){p(it,et.sibling),Ht=k(et,xt.props.children),Ht.return=it,it=Ht;break e}}else if(et.elementType===xa||typeof xa=="object"&&xa!==null&&xa.$$typeof===ue&&ct(xa)===et.type){p(it,et.sibling),Ht=k(et,xt.props),ka(Ht,xt),Ht.return=it,it=Ht;break e}p(it,et);break}else c(it,et);et=et.sibling}xt.type===_?(Ht=Io(xt.props.children,it.mode,Ht,xt.key),Ht.return=it,it=Ht):(Ht=WA(xt.type,xt.key,xt.props,null,it.mode,Ht),ka(Ht,xt),Ht.return=it,it=Ht)}return Ae(it);case M:e:{for(xa=xt.key;et!==null;){if(et.key===xa)if(et.tag===4&&et.stateNode.containerInfo===xt.containerInfo&&et.stateNode.implementation===xt.implementation){p(it,et.sibling),Ht=k(et,xt.children||[]),Ht.return=it,it=Ht;break e}else{p(it,et);break}else c(it,et);et=et.sibling}Ht=$A(xt,it.mode,Ht),Ht.return=it,it=Ht}return Ae(it);case ue:return xt=ct(xt),kn(it,et,xt,Ht)}if(ke(xt))return Wr(it,et,xt,Ht);if(J(xt)){if(xa=J(xt),typeof xa!="function")throw Error(r(150));return xt=xa.call(xt),Ca(it,et,xt,Ht)}if(typeof xt.then=="function")return kn(it,et,Tr(xt),Ht);if(xt.$$typeof===O)return kn(it,et,Nu(it,xt),Ht);zr(it,xt)}return typeof xt=="string"&&xt!==""||typeof xt=="number"||typeof xt=="bigint"?(xt=""+xt,et!==null&&et.tag===6?(p(it,et.sibling),Ht=k(et,xt),Ht.return=it,it=Ht):(p(it,et),Ht=Ud(xt,it.mode,Ht),Ht.return=it,it=Ht),Ae(it)):p(it,et)}return function(it,et,xt,Ht){try{Vr=0;var xa=kn(it,et,xt,Ht);return Kt=null,xa}catch(la){if(la===Ze||la===He)throw la;var zs=Ws(29,la,null,it.mode);return zs.lanes=Ht,zs.return=it,zs}finally{}}}var nn=Ka(!0),La=Ka(!1),Er=!1;function xr(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function on(l,c){l=l.updateQueue,c.updateQueue===l&&(c.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,callbacks:null})}function sa(l){return{lane:l,tag:0,payload:null,callback:null,next:null}}function Ia(l,c,p){var y=l.updateQueue;if(y===null)return null;if(y=y.shared,(Qs&2)!==0){var k=y.pending;return k===null?c.next=c:(c.next=k.next,k.next=c),y.pending=c,c=ho(l),ps(l,null,p),c}return Vc(l,y,c,p),ho(l)}function ks(l,c,p){if(c=c.updateQueue,c!==null&&(c=c.shared,(p&4194048)!==0)){var y=c.lanes;y&=l.pendingLanes,p|=y,c.lanes=p,ms(l,p)}}function di(l,c){var p=l.updateQueue,y=l.alternate;if(y!==null&&(y=y.updateQueue,p===y)){var k=null,U=null;if(p=p.firstBaseUpdate,p!==null){do{var Ae={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};U===null?k=U=Ae:U=U.next=Ae,p=p.next}while(p!==null);U===null?k=U=c:U=U.next=c}else k=U=c;p={baseState:y.baseState,firstBaseUpdate:k,lastBaseUpdate:U,shared:y.shared,callbacks:y.callbacks},l.updateQueue=p;return}l=p.lastBaseUpdate,l===null?p.firstBaseUpdate=c:l.next=c,p.lastBaseUpdate=c}var Li=!1;function qs(){if(Li){var l=D;if(l!==null)throw l}}function Vn(l,c,p,y){Li=!1;var k=l.updateQueue;Er=!1;var U=k.firstBaseUpdate,Ae=k.lastBaseUpdate,_e=k.shared.pending;if(_e!==null){k.shared.pending=null;var Ve=_e,lt=Ve.next;Ve.next=null,Ae===null?U=lt:Ae.next=lt,Ae=Ve;var kt=l.alternate;kt!==null&&(kt=kt.updateQueue,_e=kt.lastBaseUpdate,_e!==Ae&&(_e===null?kt.firstBaseUpdate=lt:_e.next=lt,kt.lastBaseUpdate=Ve))}if(U!==null){var _t=k.baseState;Ae=0,kt=lt=Ve=null,_e=U;do{var gt=_e.lane&-536870913,Nt=gt!==_e.lane;if(Nt?(ds&gt)===gt:(y&gt)===gt){gt!==0&&gt===B&&(Li=!0),kt!==null&&(kt=kt.next={lane:0,tag:_e.tag,payload:_e.payload,callback:null,next:null});e:{var Wr=l,Ca=_e;gt=c;var kn=p;switch(Ca.tag){case 1:if(Wr=Ca.payload,typeof Wr=="function"){_t=Wr.call(kn,_t,gt);break e}_t=Wr;break e;case 3:Wr.flags=Wr.flags&-65537|128;case 0:if(Wr=Ca.payload,gt=typeof Wr=="function"?Wr.call(kn,_t,gt):Wr,gt==null)break e;_t=j({},_t,gt);break e;case 2:Er=!0}}gt=_e.callback,gt!==null&&(l.flags|=64,Nt&&(l.flags|=8192),Nt=k.callbacks,Nt===null?k.callbacks=[gt]:Nt.push(gt))}else Nt={lane:gt,tag:_e.tag,payload:_e.payload,callback:_e.callback,next:null},kt===null?(lt=kt=Nt,Ve=_t):kt=kt.next=Nt,Ae|=gt;if(_e=_e.next,_e===null){if(_e=k.shared.pending,_e===null)break;Nt=_e,_e=Nt.next,Nt.next=null,k.lastBaseUpdate=Nt,k.shared.pending=null}}while(!0);kt===null&&(Ve=_t),k.baseState=Ve,k.firstBaseUpdate=lt,k.lastBaseUpdate=kt,U===null&&(k.shared.lanes=0),ld|=Ae,l.lanes=Ae,l.memoizedState=_t}}function Ji(l,c){if(typeof l!="function")throw Error(r(191,l));l.call(c)}function Yn(l,c){var p=l.callbacks;if(p!==null)for(l.callbacks=null,l=0;l<p.length;l++)Ji(p[l],c)}var Qa=te(null),qa=te(0);function Fn(l,c){l=od,le(qa,l),le(Qa,c),od=l|c.baseLanes}function vs(){le(qa,od),le(Qa,Qa.current)}function Ni(){od=qa.current,V(Qa),V(qa)}var On=te(null),gs=null;function En(l){var c=l.alternate;le(As,As.current&1),le(On,l),gs===null&&(c===null||Qa.current!==null||c.memoizedState!==null)&&(gs=l)}function Ds(l){le(As,As.current),le(On,l),gs===null&&(gs=l)}function Wn(l){l.tag===22?(le(As,As.current),le(On,l),gs===null&&(gs=l)):ai()}function ai(){le(As,As.current),le(On,On.current)}function xs(l){V(On),gs===l&&(gs=null),V(As)}var As=te(0);function Ui(l){for(var c=l;c!==null;){if(c.tag===13){var p=c.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||jm(p)||Kf(p)))return c}else if(c.tag===19&&(c.memoizedProps.revealOrder==="forwards"||c.memoizedProps.revealOrder==="backwards"||c.memoizedProps.revealOrder==="unstable_legacy-backwards"||c.memoizedProps.revealOrder==="together")){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var bn=0,da=null,ia=null,ts=null,Fo=!1,ll=!1,po=!1,si=0,Zc=0,eA=null,Bu=0;function ln(){throw Error(r(321))}function v0(l,c){if(c===null)return!1;for(var p=0;p<c.length&&p<l.length;p++)if(!$i(l[p],c[p]))return!1;return!0}function gf(l,c,p,y,k,U){return bn=U,da=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,he.H=l===null||l.memoizedState===null?kg:Bp,po=!1,U=p(y,k),po=!1,ll&&(U=tA(c,p,y,k)),xf(l),U}function xf(l){he.H=T0;var c=ia!==null&&ia.next!==null;if(bn=0,ts=ia=da=null,Fo=!1,Zc=0,eA=null,c)throw Error(r(300));l===null||Ii||(l=l.dependencies,l!==null&&vc(l)&&(Ii=!0))}function tA(l,c,p,y){da=l;var k=0;do{if(ll&&(eA=null),Zc=0,ll=!1,25<=k)throw Error(r(301));if(k+=1,ts=ia=null,l.updateQueue!=null){var U=l.updateQueue;U.lastEffect=null,U.events=null,U.stores=null,U.memoCache!=null&&(U.memoCache.index=0)}he.H=Dg,U=c(p,y)}while(ll);return U}function gp(){var l=he.H,c=l.useState()[0];return c=typeof c.then=="function"?vA(c):c,l=l.useState()[0],(ia!==null?ia.memoizedState:null)!==l&&(da.flags|=1024),c}function w0(){var l=si!==0;return si=0,l}function N0(l,c,p){c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~p}function Od(l){if(Fo){for(l=l.memoizedState;l!==null;){var c=l.queue;c!==null&&(c.pending=null),l=l.next}Fo=!1}bn=0,ts=ia=da=null,ll=!1,Zc=si=0,eA=null}function Mi(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ts===null?da.memoizedState=ts=l:ts=ts.next=l,ts}function $n(){if(ia===null){var l=da.alternate;l=l!==null?l.memoizedState:null}else l=ia.next;var c=ts===null?da.memoizedState:ts.next;if(c!==null)ts=c,ia=l;else{if(l===null)throw da.alternate===null?Error(r(467)):Error(r(310));ia=l,l={memoizedState:ia.memoizedState,baseState:ia.baseState,baseQueue:ia.baseQueue,queue:ia.queue,next:null},ts===null?da.memoizedState=ts=l:ts=ts.next=l}return ts}function Su(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function vA(l){var c=Zc;return Zc+=1,eA===null&&(eA=[]),l=Dt(eA,l,c),c=da,(ts===null?c.memoizedState:ts.next)===null&&(c=c.alternate,he.H=c===null||c.memoizedState===null?kg:Bp),l}function ZA(l){if(l!==null&&typeof l=="object"){if(typeof l.then=="function")return vA(l);if(l.$$typeof===O)return Ai(l)}throw Error(r(438,String(l)))}function ed(l){var c=null,p=da.updateQueue;if(p!==null&&(c=p.memoCache),c==null){var y=da.alternate;y!==null&&(y=y.updateQueue,y!==null&&(y=y.memoCache,y!=null&&(c={data:y.data.map(function(k){return k.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),p===null&&(p=Su(),da.updateQueue=p),p.memoCache=c,p=c.data[c.index],p===void 0)for(p=c.data[c.index]=Array(l),y=0;y<l;y++)p[y]=pe;return c.index++,p}function wc(l,c){return typeof c=="function"?c(l):c}function Fu(l){var c=$n();return Ro(c,ia,l)}function Ro(l,c,p){var y=l.queue;if(y===null)throw Error(r(311));y.lastRenderedReducer=p;var k=l.baseQueue,U=y.pending;if(U!==null){if(k!==null){var Ae=k.next;k.next=U.next,U.next=Ae}c.baseQueue=k=U,y.pending=null}if(U=l.baseState,k===null)l.memoizedState=U;else{c=k.next;var _e=Ae=null,Ve=null,lt=c,kt=!1;do{var _t=lt.lane&-536870913;if(_t!==lt.lane?(ds&_t)===_t:(bn&_t)===_t){var gt=lt.revertLane;if(gt===0)Ve!==null&&(Ve=Ve.next={lane:0,revertLane:0,gesture:null,action:lt.action,hasEagerState:lt.hasEagerState,eagerState:lt.eagerState,next:null}),_t===B&&(kt=!0);else if((bn&gt)===gt){lt=lt.next,gt===B&&(kt=!0);continue}else _t={lane:0,revertLane:lt.revertLane,gesture:null,action:lt.action,hasEagerState:lt.hasEagerState,eagerState:lt.eagerState,next:null},Ve===null?(_e=Ve=_t,Ae=U):Ve=Ve.next=_t,da.lanes|=gt,ld|=gt;_t=lt.action,po&&p(U,_t),U=lt.hasEagerState?lt.eagerState:p(U,_t)}else gt={lane:_t,revertLane:lt.revertLane,gesture:lt.gesture,action:lt.action,hasEagerState:lt.hasEagerState,eagerState:lt.eagerState,next:null},Ve===null?(_e=Ve=gt,Ae=U):Ve=Ve.next=gt,da.lanes|=_t,ld|=_t;lt=lt.next}while(lt!==null&&lt!==c);if(Ve===null?Ae=U:Ve.next=_e,!$i(U,l.memoizedState)&&(Ii=!0,kt&&(p=D,p!==null)))throw p;l.memoizedState=U,l.baseState=Ae,l.baseQueue=Ve,y.lastRenderedState=U}return k===null&&(y.lanes=0),[l.memoizedState,y.dispatch]}function bf(l){var c=$n(),p=c.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=l;var y=p.dispatch,k=p.pending,U=c.memoizedState;if(k!==null){p.pending=null;var Ae=k=k.next;do U=l(U,Ae.action),Ae=Ae.next;while(Ae!==k);$i(U,c.memoizedState)||(Ii=!0),c.memoizedState=U,c.baseQueue===null&&(c.baseState=U),p.lastRenderedState=U}return[U,y]}function yf(l,c,p){var y=da,k=$n(),U=es;if(U){if(p===void 0)throw Error(r(407));p=p()}else p=c();var Ae=!$i((ia||k).memoizedState,p);if(Ae&&(k.memoizedState=p,Ii=!0),k=k.queue,F0(C0.bind(null,y,k,l),[l]),k.getSnapshot!==c||Ae||ts!==null&&ts.memoizedState.tag&1){if(y.flags|=2048,qn(9,{destroy:void 0},vf.bind(null,y,k,p,c),null),yn===null)throw Error(r(349));U||(bn&127)!==0||Nc(y,c,p)}return p}function Nc(l,c,p){l.flags|=16384,l={getSnapshot:c,value:p},c=da.updateQueue,c===null?(c=Su(),da.updateQueue=c,c.stores=[l]):(p=c.stores,p===null?c.stores=[l]:p.push(l))}function vf(l,c,p,y){c.value=p,c.getSnapshot=y,wf(c)&&Eu(l)}function C0(l,c,p){return p(function(){wf(c)&&Eu(l)})}function wf(l){var c=l.getSnapshot;l=l.value;try{var p=c();return!$i(l,p)}catch{return!0}}function Eu(l){var c=Mo(l,2);c!==null&&ul(c,l,2)}function rA(l){var c=Mi();if(typeof l=="function"){var p=l;if(l=p(),po){pr(!0);try{p()}finally{pr(!1)}}}return c.memoizedState=c.baseState=l,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:wc,lastRenderedState:l},c}function j0(l,c,p,y){return l.baseState=p,Ro(l,ia,typeof y=="function"?y:wc)}function B0(l,c,p,y,k){if(Oh(l))throw Error(r(485));if(l=c.action,l!==null){var U={payload:k,action:l,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Ae){U.listeners.push(Ae)}};he.T!==null?p(!0):U.isTransition=!1,y(U),p=c.pending,p===null?(U.next=c.pending=U,td(c,U)):(U.next=p.next,c.pending=p.next=U)}}function td(l,c){var p=c.action,y=c.payload,k=l.state;if(c.isTransition){var U=he.T,Ae={};he.T=Ae;try{var _e=p(k,y),Ve=he.S;Ve!==null&&Ve(Ae,_e),S0(l,c,_e)}catch(lt){wA(l,c,lt)}finally{U!==null&&Ae.types!==null&&(U.types=Ae.types),he.T=U}}else try{U=p(k,y),S0(l,c,U)}catch(lt){wA(l,c,lt)}}function S0(l,c,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(y){Lh(l,c,y)},function(y){return wA(l,c,y)}):Lh(l,c,p)}function Lh(l,c,p){c.status="fulfilled",c.value=p,ku(c),l.state=p,c=l.pending,c!==null&&(p=c.next,p===c?l.pending=null:(p=p.next,c.next=p,td(l,p)))}function wA(l,c,p){var y=l.pending;if(l.pending=null,y!==null){y=y.next;do c.status="rejected",c.reason=p,ku(c),c=c.next;while(c!==y)}l.action=null}function ku(l){l=l.listeners;for(var c=0;c<l.length;c++)(0,l[c])()}function NA(l,c){return c}function Po(l,c){if(es){var p=yn.formState;if(p!==null){e:{var y=da;if(es){if(sn){t:{for(var k=sn,U=Ma;k.nodeType!==8;){if(!U){k=null;break t}if(k=tc(k.nextSibling),k===null){k=null;break t}}U=k.data,k=U==="F!"||U==="F"?k:null}if(k){sn=tc(k.nextSibling),y=k.data==="F!";break e}}$s(y)}y=!1}y&&(c=p[0])}}return p=Mi(),p.memoizedState=p.baseState=c,y={pending:null,lanes:0,dispatch:null,lastRenderedReducer:NA,lastRenderedState:c},p.queue=y,p=Sf.bind(null,da,y),y.dispatch=p,y=rA(!1),U=jp.bind(null,da,!1,y.queue),y=Mi(),k={state:c,dispatch:null,action:l,pending:null},y.queue=k,p=B0.bind(null,da,k,U,p),k.dispatch=p,y.memoizedState=l,[c,p,!1]}function Fl(l){var c=$n();return Cc(c,ia,l)}function Cc(l,c,p){if(c=Ro(l,c,NA)[0],l=Fu(wc)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var y=vA(c)}catch(Ae){throw Ae===Ze?He:Ae}else y=c;c=$n();var k=c.queue,U=k.dispatch;return p!==c.memoizedState&&(da.flags|=2048,qn(9,{destroy:void 0},Nf.bind(null,k,p),null)),[y,U,l]}function Nf(l,c){l.action=c}function Cf(l){var c=$n(),p=ia;if(p!==null)return Cc(c,p,l);$n(),c=c.memoizedState,p=$n();var y=p.queue.dispatch;return p.memoizedState=l,[c,y,!1]}function qn(l,c,p,y){return l={tag:l,create:p,deps:y,inst:c,next:null},c=da.updateQueue,c===null&&(c=Su(),da.updateQueue=c),p=c.lastEffect,p===null?c.lastEffect=l.next=l:(y=p.next,p.next=l,l.next=y,c.lastEffect=l),l}function Qd(){return $n().memoizedState}function jc(l,c,p,y){var k=Mi();da.flags|=l,k.memoizedState=qn(1|c,{destroy:void 0},p,y===void 0?null:y)}function aA(l,c,p,y){var k=$n();y=y===void 0?null:y;var U=k.memoizedState.inst;ia!==null&&y!==null&&v0(y,ia.memoizedState.deps)?k.memoizedState=qn(c,U,p,y):(da.flags|=l,k.memoizedState=qn(1|c,U,p,y))}function Uh(l,c){jc(8390656,8,l,c)}function F0(l,c){aA(2048,8,l,c)}function Rd(l){da.flags|=4;var c=da.updateQueue;if(c===null)c=Su(),da.updateQueue=c,c.events=[l];else{var p=c.events;p===null?c.events=[l]:p.push(l)}}function xp(l){var c=$n().memoizedState;return Rd({ref:c,nextImpl:l}),function(){if((Qs&2)!==0)throw Error(r(440));return c.impl.apply(void 0,arguments)}}function jf(l,c){return aA(4,2,l,c)}function Du(l,c){return aA(4,4,l,c)}function wg(l,c){if(typeof c=="function"){l=l();var p=c(l);return function(){typeof p=="function"?p():c(null)}}if(c!=null)return l=l(),c.current=l,function(){c.current=null}}function E0(l,c,p){p=p!=null?p.concat([l]):null,aA(4,4,wg.bind(null,c,l),p)}function Bf(){}function bp(l,c){var p=$n();c=c===void 0?null:c;var y=p.memoizedState;return c!==null&&v0(c,y[1])?y[0]:(p.memoizedState=[l,c],l)}function yp(l,c){var p=$n();c=c===void 0?null:c;var y=p.memoizedState;if(c!==null&&v0(c,y[1]))return y[0];if(y=l(),po){pr(!0);try{l()}finally{pr(!1)}}return p.memoizedState=[y,c],y}function Mh(l,c,p){return p===void 0||(bn&1073741824)!==0&&(ds&261930)===0?l.memoizedState=c:(l.memoizedState=p,l=Jg(),da.lanes|=l,ld|=l,p)}function vp(l,c,p,y){return $i(p,c)?p:Qa.current!==null?(l=Mh(l,p,y),$i(l,c)||(Ii=!0),l):(bn&42)===0||(bn&1073741824)!==0&&(ds&261930)===0?(Ii=!0,l.memoizedState=p):(l=Jg(),da.lanes|=l,ld|=l,c)}function wp(l,c,p,y,k){var U=Ne.p;Ne.p=U!==0&&8>U?U:8;var Ae=he.T,_e={};he.T=_e,jp(l,!1,c,p);try{var Ve=k(),lt=he.S;if(lt!==null&&lt(_e,Ve),Ve!==null&&typeof Ve=="object"&&typeof Ve.then=="function"){var kt=Be(Ve,y);D0(l,c,kt,dl(l))}else D0(l,c,y,dl(l))}catch(_t){D0(l,c,{then:function(){},status:"rejected",reason:_t},dl())}finally{Ne.p=U,Ae!==null&&_e.types!==null&&(Ae.types=_e.types),he.T=Ae}}function k0(){}function Np(l,c,p,y){if(l.tag!==5)throw Error(r(476));var k=Cp(l).queue;wp(l,k,c,xe,p===null?k0:function(){return Ng(l),p(y)})}function Cp(l){var c=l.memoizedState;if(c!==null)return c;c={memoizedState:xe,baseState:xe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:wc,lastRenderedState:xe},next:null};var p={};return c.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:wc,lastRenderedState:p},next:null},l.memoizedState=c,l=l.alternate,l!==null&&(l.memoizedState=c),c}function Ng(l){var c=Cp(l);c.next===null&&(c=l.alternate.memoizedState),D0(l,c.next.queue,{},dl())}function Ih(){return Ai(Sr)}function Cg(){return $n().memoizedState}function jg(){return $n().memoizedState}function Bg(l){for(var c=l.return;c!==null;){switch(c.tag){case 24:case 3:var p=dl();l=sa(p);var y=Ia(c,l,p);y!==null&&(ul(y,c,p),ks(y,c,p)),c={cache:Jc()},l.payload=c;return}c=c.return}}function Sg(l,c,p){var y=dl();p={lane:y,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},Oh(l)?Fg(c,p):(p=bA(l,c,p,y),p!==null&&(ul(p,l,y),Eg(p,c,y)))}function Sf(l,c,p){var y=dl();D0(l,c,p,y)}function D0(l,c,p,y){var k={lane:y,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null};if(Oh(l))Fg(c,k);else{var U=l.alternate;if(l.lanes===0&&(U===null||U.lanes===0)&&(U=c.lastRenderedReducer,U!==null))try{var Ae=c.lastRenderedState,_e=U(Ae,p);if(k.hasEagerState=!0,k.eagerState=_e,$i(_e,Ae))return Vc(l,c,k,0),yn===null&&Ta(),!1}catch{}finally{}if(p=bA(l,c,k,y),p!==null)return ul(p,l,y),Eg(p,c,y),!0}return!1}function jp(l,c,p,y){if(y={lane:2,revertLane:rs(),gesture:null,action:y,hasEagerState:!1,eagerState:null,next:null},Oh(l)){if(c)throw Error(r(479))}else c=bA(l,p,y,2),c!==null&&ul(c,l,2)}function Oh(l){var c=l.alternate;return l===da||c!==null&&c===da}function Fg(l,c){ll=Fo=!0;var p=l.pending;p===null?c.next=c:(c.next=p.next,p.next=c),l.pending=c}function Eg(l,c,p){if((p&4194048)!==0){var y=c.lanes;y&=l.pendingLanes,p|=y,c.lanes=p,ms(l,p)}}var T0={readContext:Ai,use:ZA,useCallback:ln,useContext:ln,useEffect:ln,useImperativeHandle:ln,useLayoutEffect:ln,useInsertionEffect:ln,useMemo:ln,useReducer:ln,useRef:ln,useState:ln,useDebugValue:ln,useDeferredValue:ln,useTransition:ln,useSyncExternalStore:ln,useId:ln,useHostTransitionStatus:ln,useFormState:ln,useActionState:ln,useOptimistic:ln,useMemoCache:ln,useCacheRefresh:ln};T0.useEffectEvent=ln;var kg={readContext:Ai,use:ZA,useCallback:function(l,c){return Mi().memoizedState=[l,c===void 0?null:c],l},useContext:Ai,useEffect:Uh,useImperativeHandle:function(l,c,p){p=p!=null?p.concat([l]):null,jc(4194308,4,wg.bind(null,c,l),p)},useLayoutEffect:function(l,c){return jc(4194308,4,l,c)},useInsertionEffect:function(l,c){jc(4,2,l,c)},useMemo:function(l,c){var p=Mi();c=c===void 0?null:c;var y=l();if(po){pr(!0);try{l()}finally{pr(!1)}}return p.memoizedState=[y,c],y},useReducer:function(l,c,p){var y=Mi();if(p!==void 0){var k=p(c);if(po){pr(!0);try{p(c)}finally{pr(!1)}}}else k=c;return y.memoizedState=y.baseState=k,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:k},y.queue=l,l=l.dispatch=Sg.bind(null,da,l),[y.memoizedState,l]},useRef:function(l){var c=Mi();return l={current:l},c.memoizedState=l},useState:function(l){l=rA(l);var c=l.queue,p=Sf.bind(null,da,c);return c.dispatch=p,[l.memoizedState,p]},useDebugValue:Bf,useDeferredValue:function(l,c){var p=Mi();return Mh(p,l,c)},useTransition:function(){var l=rA(!1);return l=wp.bind(null,da,l.queue,!0,!1),Mi().memoizedState=l,[!1,l]},useSyncExternalStore:function(l,c,p){var y=da,k=Mi();if(es){if(p===void 0)throw Error(r(407));p=p()}else{if(p=c(),yn===null)throw Error(r(349));(ds&127)!==0||Nc(y,c,p)}k.memoizedState=p;var U={value:p,getSnapshot:c};return k.queue=U,Uh(C0.bind(null,y,U,l),[l]),y.flags|=2048,qn(9,{destroy:void 0},vf.bind(null,y,U,p,c),null),p},useId:function(){var l=Mi(),c=yn.identifierPrefix;if(es){var p=il,y=Sl;p=(y&~(1<<32-Gr(y)-1)).toString(32)+p,c="_"+c+"R_"+p,p=si++,0<p&&(c+="H"+p.toString(32)),c+="_"}else p=Bu++,c="_"+c+"r_"+p.toString(32)+"_";return l.memoizedState=c},useHostTransitionStatus:Ih,useFormState:Po,useActionState:Po,useOptimistic:function(l){var c=Mi();c.memoizedState=c.baseState=l;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=p,c=jp.bind(null,da,!0,p),p.dispatch=c,[l,c]},useMemoCache:ed,useCacheRefresh:function(){return Mi().memoizedState=Bg.bind(null,da)},useEffectEvent:function(l){var c=Mi(),p={impl:l};return c.memoizedState=p,function(){if((Qs&2)!==0)throw Error(r(440));return p.impl.apply(void 0,arguments)}}},Bp={readContext:Ai,use:ZA,useCallback:bp,useContext:Ai,useEffect:F0,useImperativeHandle:E0,useInsertionEffect:jf,useLayoutEffect:Du,useMemo:yp,useReducer:Fu,useRef:Qd,useState:function(){return Fu(wc)},useDebugValue:Bf,useDeferredValue:function(l,c){var p=$n();return vp(p,ia.memoizedState,l,c)},useTransition:function(){var l=Fu(wc)[0],c=$n().memoizedState;return[typeof l=="boolean"?l:vA(l),c]},useSyncExternalStore:yf,useId:Cg,useHostTransitionStatus:Ih,useFormState:Fl,useActionState:Fl,useOptimistic:function(l,c){var p=$n();return j0(p,ia,l,c)},useMemoCache:ed,useCacheRefresh:jg};Bp.useEffectEvent=xp;var Dg={readContext:Ai,use:ZA,useCallback:bp,useContext:Ai,useEffect:F0,useImperativeHandle:E0,useInsertionEffect:jf,useLayoutEffect:Du,useMemo:yp,useReducer:bf,useRef:Qd,useState:function(){return bf(wc)},useDebugValue:Bf,useDeferredValue:function(l,c){var p=$n();return ia===null?Mh(p,l,c):vp(p,ia.memoizedState,l,c)},useTransition:function(){var l=bf(wc)[0],c=$n().memoizedState;return[typeof l=="boolean"?l:vA(l),c]},useSyncExternalStore:yf,useId:Cg,useHostTransitionStatus:Ih,useFormState:Cf,useActionState:Cf,useOptimistic:function(l,c){var p=$n();return ia!==null?j0(p,ia,l,c):(p.baseState=l,[l,p.queue.dispatch])},useMemoCache:ed,useCacheRefresh:jg};Dg.useEffectEvent=xp;function Sp(l,c,p,y){c=l.memoizedState,p=p(y,c),p=p==null?c:j({},c,p),l.memoizedState=p,l.lanes===0&&(l.updateQueue.baseState=p)}var Fp={enqueueSetState:function(l,c,p){l=l._reactInternals;var y=dl(),k=sa(y);k.payload=c,p!=null&&(k.callback=p),c=Ia(l,k,y),c!==null&&(ul(c,l,y),ks(c,l,y))},enqueueReplaceState:function(l,c,p){l=l._reactInternals;var y=dl(),k=sa(y);k.tag=1,k.payload=c,p!=null&&(k.callback=p),c=Ia(l,k,y),c!==null&&(ul(c,l,y),ks(c,l,y))},enqueueForceUpdate:function(l,c){l=l._reactInternals;var p=dl(),y=sa(p);y.tag=2,c!=null&&(y.callback=c),c=Ia(l,y,p),c!==null&&(ul(c,l,p),ks(c,l,p))}};function Tg(l,c,p,y,k,U,Ae){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(y,U,Ae):c.prototype&&c.prototype.isPureReactComponent?!mc(p,y)||!mc(k,U):!0}function _g(l,c,p,y){l=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(p,y),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(p,y),c.state!==l&&Fp.enqueueReplaceState(c,c.state,null)}function Pd(l,c){var p=c;if("ref"in c){p={};for(var y in c)y!=="ref"&&(p[y]=c[y])}if(l=l.defaultProps){p===c&&(p=j({},p));for(var k in l)p[k]===void 0&&(p[k]=l[k])}return p}function Qh(l){VA(l)}function Lg(l){console.error(l)}function Ug(l){VA(l)}function Rh(l,c){try{var p=l.onUncaughtError;p(c.value,{componentStack:c.stack})}catch(y){setTimeout(function(){throw y})}}function Ep(l,c,p){try{var y=l.onCaughtError;y(p.value,{componentStack:p.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(k){setTimeout(function(){throw k})}}function Hd(l,c,p){return p=sa(p),p.tag=3,p.payload={element:null},p.callback=function(){Rh(l,c)},p}function kp(l){return l=sa(l),l.tag=3,l}function Dp(l,c,p,y){var k=p.type.getDerivedStateFromError;if(typeof k=="function"){var U=y.value;l.payload=function(){return k(U)},l.callback=function(){Ep(c,p,y)}}var Ae=p.stateNode;Ae!==null&&typeof Ae.componentDidCatch=="function"&&(l.callback=function(){Ep(c,p,y),typeof k!="function"&&(Vd===null?Vd=new Set([this]):Vd.add(this));var _e=y.stack;this.componentDidCatch(y.value,{componentStack:_e!==null?_e:""})})}function Mg(l,c,p,y,k){if(p.flags|=32768,y!==null&&typeof y=="object"&&typeof y.then=="function"){if(c=p.alternate,c!==null&&Xi(c,p,k,!0),p=On.current,p!==null){switch(p.tag){case 31:case 13:return gs===null?im():p.alternate===null&&ni===0&&(ni=3),p.flags&=-257,p.flags|=65536,p.lanes=k,y===at?p.flags|=16384:(c=p.updateQueue,c===null?p.updateQueue=new Set([y]):c.add(y),lm(l,y,k)),!1;case 22:return p.flags|=65536,y===at?p.flags|=16384:(c=p.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([y])},p.updateQueue=c):(p=c.retryQueue,p===null?c.retryQueue=new Set([y]):p.add(y)),lm(l,y,k)),!1}throw Error(r(435,p.tag))}return lm(l,y,k),im(),!1}if(es)return c=On.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=k,y!==xn&&(l=Error(r(422),{cause:y}),xc(al(l,p)))):(y!==xn&&(c=Error(r(423),{cause:y}),xc(al(c,p))),l=l.current.alternate,l.flags|=65536,k&=-k,l.lanes|=k,y=al(y,p),k=Hd(l.stateNode,y,k),di(l,k),ni!==4&&(ni=2)),!1;var U=Error(r(520),{cause:y});if(U=al(U,p),H0===null?H0=[U]:H0.push(U),ni!==4&&(ni=2),c===null)return!0;y=al(y,p),p=c;do{switch(p.tag){case 3:return p.flags|=65536,l=k&-k,p.lanes|=l,l=Hd(p.stateNode,y,l),di(p,l),!1;case 1:if(c=p.type,U=p.stateNode,(p.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||U!==null&&typeof U.componentDidCatch=="function"&&(Vd===null||!Vd.has(U))))return p.flags|=65536,k&=-k,p.lanes|=k,k=kp(k),Dp(k,l,p,y),di(p,k),!1}p=p.return}while(p!==null);return!1}var Tp=Error(r(461)),Ii=!1;function go(l,c,p,y){c.child=l===null?La(c,null,p,y):nn(c,l.child,p,y)}function Ph(l,c,p,y,k){p=p.render;var U=c.ref;if("ref"in y){var Ae={};for(var _e in y)_e!=="ref"&&(Ae[_e]=y[_e])}else Ae=y;return Xc(c),y=gf(l,c,p,Ae,U,k),_e=w0(),l!==null&&!Ii?(N0(l,c,k),rd(l,c,k)):(es&&_e&&pf(c),c.flags|=1,go(l,c,y,k),c.child)}function _p(l,c,p,y,k){if(l===null){var U=p.type;return typeof U=="function"&&!hf(U)&&U.defaultProps===void 0&&p.compare===null?(c.tag=15,c.type=U,Tu(l,c,U,y,k)):(l=WA(p.type,null,y,c,c.mode,k),l.ref=c.ref,l.return=c,c.child=l)}if(U=l.child,!Lu(l,k)){var Ae=U.memoizedProps;if(p=p.compare,p=p!==null?p:mc,p(Ae,y)&&l.ref===c.ref)return rd(l,c,k)}return c.flags|=1,l=rl(U,y),l.ref=c.ref,l.return=c,c.child=l}function Tu(l,c,p,y,k){if(l!==null){var U=l.memoizedProps;if(mc(U,y)&&l.ref===c.ref)if(Ii=!1,c.pendingProps=y=U,Lu(l,k))(l.flags&131072)!==0&&(Ii=!0);else return c.lanes=l.lanes,rd(l,c,k)}return zh(l,c,p,y,k)}function Ig(l,c,p,y){var k=y.children,U=l!==null?l.memoizedState:null;if(l===null&&c.stateNode===null&&(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),y.mode==="hidden"){if((c.flags&128)!==0){if(U=U!==null?U.baseLanes|p:p,l!==null){for(y=c.child=l.child,k=0;y!==null;)k=k|y.lanes|y.childLanes,y=y.sibling;y=k&~U}else y=0,c.child=null;return Hh(l,c,U,p,y)}if((p&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},l!==null&&Re(c,U!==null?U.cachePool:null),U!==null?Fn(c,U):vs(),Wn(c);else return y=c.lanes=536870912,Hh(l,c,U!==null?U.baseLanes|p:p,p,y)}else U!==null?(Re(c,U.cachePool),Fn(c,U),ai(),c.memoizedState=null):(l!==null&&Re(c,null),vs(),ai());return go(l,c,k,p),c.child}function _u(l,c){return l!==null&&l.tag===22||c.stateNode!==null||(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.sibling}function Hh(l,c,p,y,k){var U=Oe();return U=U===null?null:{parent:ri._currentValue,pool:U},c.memoizedState={baseLanes:p,cachePool:U},l!==null&&Re(c,null),vs(),Wn(c),l!==null&&Xi(l,c,y,!0),c.childLanes=k,null}function _0(l,c){return c=U0({mode:c.mode,children:c.children},l.mode),c.ref=l.ref,l.child=c,c.return=l,c}function Lp(l,c,p){return nn(c,l.child,null,p),l=_0(c,c.pendingProps),l.flags|=2,xs(c),c.memoizedState=null,l}function Oi(l,c,p){var y=c.pendingProps,k=(c.flags&128)!==0;if(c.flags&=-129,l===null){if(es){if(y.mode==="hidden")return l=_0(c,y),c.lanes=536870912,_u(null,l);if(Ds(c),(l=sn)?(l=Cm(l,Ma),l=l!==null&&l.data==="&"?l:null,l!==null&&(c.memoizedState={dehydrated:l,treeContext:Wc!==null?{id:Sl,overflow:il}:null,retryLane:536870912,hydrationErrors:null},p=yu(l),p.return=c,c.child=p,Ti=c,sn=null)):l=null,l===null)throw $s(c);return c.lanes=536870912,null}return _0(c,y)}var U=l.memoizedState;if(U!==null){var Ae=U.dehydrated;if(Ds(c),k)if(c.flags&256)c.flags&=-257,c=Lp(l,c,p);else if(c.memoizedState!==null)c.child=l.child,c.flags|=128,c=null;else throw Error(r(558));else if(Ii||Xi(l,c,p,!1),k=(p&l.childLanes)!==0,Ii||k){if(y=yn,y!==null&&(Ae=pi(y,p),Ae!==0&&Ae!==U.retryLane))throw U.retryLane=Ae,Mo(l,Ae),ul(y,l,Ae),Tp;im(),c=Lp(l,c,p)}else l=U.treeContext,sn=tc(Ae.nextSibling),Ti=c,es=!0,Gn=null,Ma=!1,l!==null&&b0(c,l),c=_0(c,y),c.flags|=4096;return c}return l=rl(l.child,{mode:y.mode,children:y.children}),l.ref=c.ref,c.child=l,l.return=c,l}function sA(l,c){var p=c.ref;if(p===null)l!==null&&l.ref!==null&&(c.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(r(284));(l===null||l.ref!==p)&&(c.flags|=4194816)}}function zh(l,c,p,y,k){return Xc(c),p=gf(l,c,p,y,void 0,k),y=w0(),l!==null&&!Ii?(N0(l,c,k),rd(l,c,k)):(es&&y&&pf(c),c.flags|=1,go(l,c,p,k),c.child)}function Up(l,c,p,y,k,U){return Xc(c),c.updateQueue=null,p=tA(c,y,p,k),xf(l),y=w0(),l!==null&&!Ii?(N0(l,c,U),rd(l,c,U)):(es&&y&&pf(c),c.flags|=1,go(l,c,p,U),c.child)}function Mp(l,c,p,y,k){if(Xc(c),c.stateNode===null){var U=Di,Ae=p.contextType;typeof Ae=="object"&&Ae!==null&&(U=Ai(Ae)),U=new p(y,U),c.memoizedState=U.state!==null&&U.state!==void 0?U.state:null,U.updater=Fp,c.stateNode=U,U._reactInternals=c,U=c.stateNode,U.props=y,U.state=c.memoizedState,U.refs={},xr(c),Ae=p.contextType,U.context=typeof Ae=="object"&&Ae!==null?Ai(Ae):Di,U.state=c.memoizedState,Ae=p.getDerivedStateFromProps,typeof Ae=="function"&&(Sp(c,p,Ae,y),U.state=c.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof U.getSnapshotBeforeUpdate=="function"||typeof U.UNSAFE_componentWillMount!="function"&&typeof U.componentWillMount!="function"||(Ae=U.state,typeof U.componentWillMount=="function"&&U.componentWillMount(),typeof U.UNSAFE_componentWillMount=="function"&&U.UNSAFE_componentWillMount(),Ae!==U.state&&Fp.enqueueReplaceState(U,U.state,null),Vn(c,y,U,k),qs(),U.state=c.memoizedState),typeof U.componentDidMount=="function"&&(c.flags|=4194308),y=!0}else if(l===null){U=c.stateNode;var _e=c.memoizedProps,Ve=Pd(p,_e);U.props=Ve;var lt=U.context,kt=p.contextType;Ae=Di,typeof kt=="object"&&kt!==null&&(Ae=Ai(kt));var _t=p.getDerivedStateFromProps;kt=typeof _t=="function"||typeof U.getSnapshotBeforeUpdate=="function",_e=c.pendingProps!==_e,kt||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(_e||lt!==Ae)&&_g(c,U,y,Ae),Er=!1;var gt=c.memoizedState;U.state=gt,Vn(c,y,U,k),qs(),lt=c.memoizedState,_e||gt!==lt||Er?(typeof _t=="function"&&(Sp(c,p,_t,y),lt=c.memoizedState),(Ve=Er||Tg(c,p,Ve,y,gt,lt,Ae))?(kt||typeof U.UNSAFE_componentWillMount!="function"&&typeof U.componentWillMount!="function"||(typeof U.componentWillMount=="function"&&U.componentWillMount(),typeof U.UNSAFE_componentWillMount=="function"&&U.UNSAFE_componentWillMount()),typeof U.componentDidMount=="function"&&(c.flags|=4194308)):(typeof U.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=y,c.memoizedState=lt),U.props=y,U.state=lt,U.context=Ae,y=Ve):(typeof U.componentDidMount=="function"&&(c.flags|=4194308),y=!1)}else{U=c.stateNode,on(l,c),Ae=c.memoizedProps,kt=Pd(p,Ae),U.props=kt,_t=c.pendingProps,gt=U.context,lt=p.contextType,Ve=Di,typeof lt=="object"&&lt!==null&&(Ve=Ai(lt)),_e=p.getDerivedStateFromProps,(lt=typeof _e=="function"||typeof U.getSnapshotBeforeUpdate=="function")||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(Ae!==_t||gt!==Ve)&&_g(c,U,y,Ve),Er=!1,gt=c.memoizedState,U.state=gt,Vn(c,y,U,k),qs();var Nt=c.memoizedState;Ae!==_t||gt!==Nt||Er||l!==null&&l.dependencies!==null&&vc(l.dependencies)?(typeof _e=="function"&&(Sp(c,p,_e,y),Nt=c.memoizedState),(kt=Er||Tg(c,p,kt,y,gt,Nt,Ve)||l!==null&&l.dependencies!==null&&vc(l.dependencies))?(lt||typeof U.UNSAFE_componentWillUpdate!="function"&&typeof U.componentWillUpdate!="function"||(typeof U.componentWillUpdate=="function"&&U.componentWillUpdate(y,Nt,Ve),typeof U.UNSAFE_componentWillUpdate=="function"&&U.UNSAFE_componentWillUpdate(y,Nt,Ve)),typeof U.componentDidUpdate=="function"&&(c.flags|=4),typeof U.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof U.componentDidUpdate!="function"||Ae===l.memoizedProps&&gt===l.memoizedState||(c.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||Ae===l.memoizedProps&&gt===l.memoizedState||(c.flags|=1024),c.memoizedProps=y,c.memoizedState=Nt),U.props=y,U.state=Nt,U.context=Ve,y=kt):(typeof U.componentDidUpdate!="function"||Ae===l.memoizedProps&&gt===l.memoizedState||(c.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||Ae===l.memoizedProps&&gt===l.memoizedState||(c.flags|=1024),y=!1)}return U=y,sA(l,c),y=(c.flags&128)!==0,U||y?(U=c.stateNode,p=y&&typeof p.getDerivedStateFromError!="function"?null:U.render(),c.flags|=1,l!==null&&y?(c.child=nn(c,l.child,null,k),c.child=nn(c,null,p,k)):go(l,c,p,k),c.memoizedState=U.state,l=c.child):l=rd(l,c,k),l}function Og(l,c,p,y){return $l(),c.flags|=256,go(l,c,p,y),c.child}var Kh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Gh(l){return{baseLanes:l,cachePool:ze()}}function Ip(l,c,p){return l=l!==null?l.childLanes&~p:0,c&&(l|=Jl),l}function Ff(l,c,p){var y=c.pendingProps,k=!1,U=(c.flags&128)!==0,Ae;if((Ae=U)||(Ae=l!==null&&l.memoizedState===null?!1:(As.current&2)!==0),Ae&&(k=!0,c.flags&=-129),Ae=(c.flags&32)!==0,c.flags&=-33,l===null){if(es){if(k?En(c):ai(),(l=sn)?(l=Cm(l,Ma),l=l!==null&&l.data!=="&"?l:null,l!==null&&(c.memoizedState={dehydrated:l,treeContext:Wc!==null?{id:Sl,overflow:il}:null,retryLane:536870912,hydrationErrors:null},p=yu(l),p.return=c,c.child=p,Ti=c,sn=null)):l=null,l===null)throw $s(c);return Kf(l)?c.lanes=32:c.lanes=536870912,null}var _e=y.children;return y=y.fallback,k?(ai(),k=c.mode,_e=U0({mode:"hidden",children:_e},k),y=Io(y,k,p,null),_e.return=c,y.return=c,_e.sibling=y,c.child=_e,y=c.child,y.memoizedState=Gh(p),y.childLanes=Ip(l,Ae,p),c.memoizedState=Kh,_u(null,y)):(En(c),L0(c,_e))}var Ve=l.memoizedState;if(Ve!==null&&(_e=Ve.dehydrated,_e!==null)){if(U)c.flags&256?(En(c),c.flags&=-257,c=Op(l,c,p)):c.memoizedState!==null?(ai(),c.child=l.child,c.flags|=128,c=null):(ai(),_e=y.fallback,k=c.mode,y=U0({mode:"visible",children:y.children},k),_e=Io(_e,k,p,null),_e.flags|=2,y.return=c,_e.return=c,y.sibling=_e,c.child=y,nn(c,l.child,null,p),y=c.child,y.memoizedState=Gh(p),y.childLanes=Ip(l,Ae,p),c.memoizedState=Kh,c=_u(null,y));else if(En(c),Kf(_e)){if(Ae=_e.nextSibling&&_e.nextSibling.dataset,Ae)var lt=Ae.dgst;Ae=lt,y=Error(r(419)),y.stack="",y.digest=Ae,xc({value:y,source:null,stack:null}),c=Op(l,c,p)}else if(Ii||Xi(l,c,p,!1),Ae=(p&l.childLanes)!==0,Ii||Ae){if(Ae=yn,Ae!==null&&(y=pi(Ae,p),y!==0&&y!==Ve.retryLane))throw Ve.retryLane=y,Mo(l,y),ul(Ae,l,y),Tp;jm(_e)||im(),c=Op(l,c,p)}else jm(_e)?(c.flags|=192,c.child=l.child,c=null):(l=Ve.treeContext,sn=tc(_e.nextSibling),Ti=c,es=!0,Gn=null,Ma=!1,l!==null&&b0(c,l),c=L0(c,y.children),c.flags|=4096);return c}return k?(ai(),_e=y.fallback,k=c.mode,Ve=l.child,lt=Ve.sibling,y=rl(Ve,{mode:"hidden",children:y.children}),y.subtreeFlags=Ve.subtreeFlags&65011712,lt!==null?_e=rl(lt,_e):(_e=Io(_e,k,p,null),_e.flags|=2),_e.return=c,y.return=c,y.sibling=_e,c.child=y,_u(null,y),y=c.child,_e=l.child.memoizedState,_e===null?_e=Gh(p):(k=_e.cachePool,k!==null?(Ve=ri._currentValue,k=k.parent!==Ve?{parent:Ve,pool:Ve}:k):k=ze(),_e={baseLanes:_e.baseLanes|p,cachePool:k}),y.memoizedState=_e,y.childLanes=Ip(l,Ae,p),c.memoizedState=Kh,_u(l.child,y)):(En(c),p=l.child,l=p.sibling,p=rl(p,{mode:"visible",children:y.children}),p.return=c,p.sibling=null,l!==null&&(Ae=c.deletions,Ae===null?(c.deletions=[l],c.flags|=16):Ae.push(l)),c.child=p,c.memoizedState=null,p)}function L0(l,c){return c=U0({mode:"visible",children:c},l.mode),c.return=l,l.child=c}function U0(l,c){return l=Ws(22,l,null,c),l.lanes=0,l}function Op(l,c,p){return nn(c,l.child,null,p),l=L0(c,c.pendingProps.children),l.flags|=2,c.memoizedState=null,l}function Qp(l,c,p){l.lanes|=c;var y=l.alternate;y!==null&&(y.lanes|=c),XA(l.return,c,p)}function Rp(l,c,p,y,k,U){var Ae=l.memoizedState;Ae===null?l.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:y,tail:p,tailMode:k,treeForkCount:U}:(Ae.isBackwards=c,Ae.rendering=null,Ae.renderingStartTime=0,Ae.last=y,Ae.tail=p,Ae.tailMode=k,Ae.treeForkCount=U)}function Qg(l,c,p){var y=c.pendingProps,k=y.revealOrder,U=y.tail;y=y.children;var Ae=As.current,_e=(Ae&2)!==0;if(_e?(Ae=Ae&1|2,c.flags|=128):Ae&=1,le(As,Ae),go(l,c,y,p),y=es?Id:0,!_e&&l!==null&&(l.flags&128)!==0)e:for(l=c.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&Qp(l,p,c);else if(l.tag===19)Qp(l,p,c);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===c)break e;for(;l.sibling===null;){if(l.return===null||l.return===c)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}switch(k){case"forwards":for(p=c.child,k=null;p!==null;)l=p.alternate,l!==null&&Ui(l)===null&&(k=p),p=p.sibling;p=k,p===null?(k=c.child,c.child=null):(k=p.sibling,p.sibling=null),Rp(c,!1,k,p,U,y);break;case"backwards":case"unstable_legacy-backwards":for(p=null,k=c.child,c.child=null;k!==null;){if(l=k.alternate,l!==null&&Ui(l)===null){c.child=k;break}l=k.sibling,k.sibling=p,p=k,k=l}Rp(c,!0,p,null,U,y);break;case"together":Rp(c,!1,null,null,void 0,y);break;default:c.memoizedState=null}return c.child}function rd(l,c,p){if(l!==null&&(c.dependencies=l.dependencies),ld|=c.lanes,(p&c.childLanes)===0)if(l!==null){if(Xi(l,c,p,!1),(p&c.childLanes)===0)return null}else return null;if(l!==null&&c.child!==l.child)throw Error(r(153));if(c.child!==null){for(l=c.child,p=rl(l,l.pendingProps),c.child=p,p.return=c;l.sibling!==null;)l=l.sibling,p=p.sibling=rl(l,l.pendingProps),p.return=c;p.sibling=null}return c.child}function Lu(l,c){return(l.lanes&c)!==0?!0:(l=l.dependencies,!!(l!==null&&vc(l)))}function M0(l,c,p){switch(c.tag){case 3:q(c,c.stateNode.containerInfo),ql(c,ri,l.memoizedState.cache),$l();break;case 27:case 5:Fe(c);break;case 4:q(c,c.stateNode.containerInfo);break;case 10:ql(c,c.type,c.memoizedProps.value);break;case 31:if(c.memoizedState!==null)return c.flags|=128,Ds(c),null;break;case 13:var y=c.memoizedState;if(y!==null)return y.dehydrated!==null?(En(c),c.flags|=128,null):(p&c.child.childLanes)!==0?Ff(l,c,p):(En(c),l=rd(l,c,p),l!==null?l.sibling:null);En(c);break;case 19:var k=(l.flags&128)!==0;if(y=(p&c.childLanes)!==0,y||(Xi(l,c,p,!1),y=(p&c.childLanes)!==0),k){if(y)return Qg(l,c,p);c.flags|=128}if(k=c.memoizedState,k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),le(As,As.current),y)break;return null;case 22:return c.lanes=0,Ig(l,c,p,c.pendingProps);case 24:ql(c,ri,l.memoizedState.cache)}return rd(l,c,p)}function Rg(l,c,p){if(l!==null)if(l.memoizedProps!==c.pendingProps)Ii=!0;else{if(!Lu(l,p)&&(c.flags&128)===0)return Ii=!1,M0(l,c,p);Ii=(l.flags&131072)!==0}else Ii=!1,es&&(c.flags&1048576)!==0&&vu(c,Id,c.index);switch(c.lanes=0,c.tag){case 16:e:{var y=c.pendingProps;if(l=ct(c.elementType),c.type=l,typeof l=="function")hf(l)?(y=Pd(l,y),c.tag=1,c=Mp(null,c,l,y,p)):(c.tag=0,c=zh(null,c,l,y,p));else{if(l!=null){var k=l.$$typeof;if(k===Q){c.tag=11,c=Ph(null,c,l,y,p);break e}else if(k===se){c.tag=14,c=_p(null,c,l,y,p);break e}}throw c=fe(l)||l,Error(r(306,c,""))}}return c;case 0:return zh(l,c,c.type,c.pendingProps,p);case 1:return y=c.type,k=Pd(y,c.pendingProps),Mp(l,c,y,k,p);case 3:e:{if(q(c,c.stateNode.containerInfo),l===null)throw Error(r(387));y=c.pendingProps;var U=c.memoizedState;k=U.element,on(l,c),Vn(c,y,null,p);var Ae=c.memoizedState;if(y=Ae.cache,ql(c,ri,y),y!==U.cache&&yA(c,[ri],p,!0),qs(),y=Ae.element,U.isDehydrated)if(U={element:y,isDehydrated:!1,cache:Ae.cache},c.updateQueue.baseState=U,c.memoizedState=U,c.flags&256){c=Og(l,c,y,p);break e}else if(y!==k){k=al(Error(r(424)),c),xc(k),c=Og(l,c,y,p);break e}else{switch(l=c.stateNode.containerInfo,l.nodeType){case 9:l=l.body;break;default:l=l.nodeName==="HTML"?l.ownerDocument.body:l}for(sn=tc(l.firstChild),Ti=c,es=!0,Gn=null,Ma=!0,p=La(c,null,y,p),c.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling}else{if($l(),y===k){c=rd(l,c,p);break e}go(l,c,y,p)}c=c.child}return c;case 26:return sA(l,c),l===null?(p=be(c.type,null,c.pendingProps,null))?c.memoizedState=p:es||(p=c.type,l=c.pendingProps,y=J0(ie.current).createElement(p),y[Is]=c,y[ba]=l,yo(y,p,l),hn(y),c.stateNode=y):c.memoizedState=be(c.type,l.memoizedProps,c.pendingProps,l.memoizedState),null;case 27:return Fe(c),l===null&&es&&(y=c.stateNode=o(c.type,c.pendingProps,ie.current),Ti=c,Ma=!0,k=sn,ud(c.type)?($d=k,sn=tc(y.firstChild)):sn=k),go(l,c,c.pendingProps.children,p),sA(l,c),l===null&&(c.flags|=4194304),c.child;case 5:return l===null&&es&&((k=y=sn)&&(y=Nm(y,c.type,c.pendingProps,Ma),y!==null?(c.stateNode=y,Ti=c,sn=tc(y.firstChild),Ma=!1,k=!0):k=!1),k||$s(c)),Fe(c),k=c.type,U=c.pendingProps,Ae=l!==null?l.memoizedProps:null,y=U.children,zf(k,U)?y=null:Ae!==null&&zf(k,Ae)&&(c.flags|=32),c.memoizedState!==null&&(k=gf(l,c,gp,null,null,p),Sr._currentValue=k),sA(l,c),go(l,c,y,p),c.child;case 6:return l===null&&es&&((l=p=sn)&&(p=u1(p,c.pendingProps,Ma),p!==null?(c.stateNode=p,Ti=c,sn=null,l=!0):l=!1),l||$s(c)),null;case 13:return Ff(l,c,p);case 4:return q(c,c.stateNode.containerInfo),y=c.pendingProps,l===null?c.child=nn(c,null,y,p):go(l,c,y,p),c.child;case 11:return Ph(l,c,c.type,c.pendingProps,p);case 7:return go(l,c,c.pendingProps,p),c.child;case 8:return go(l,c,c.pendingProps.children,p),c.child;case 12:return go(l,c,c.pendingProps.children,p),c.child;case 10:return y=c.pendingProps,ql(c,c.type,y.value),go(l,c,y.children,p),c.child;case 9:return k=c.type._context,y=c.pendingProps.children,Xc(c),k=Ai(k),y=y(k),c.flags|=1,go(l,c,y,p),c.child;case 14:return _p(l,c,c.type,c.pendingProps,p);case 15:return Tu(l,c,c.type,c.pendingProps,p);case 19:return Qg(l,c,p);case 31:return Oi(l,c,p);case 22:return Ig(l,c,p,c.pendingProps);case 24:return Xc(c),y=Ai(ri),l===null?(k=Oe(),k===null&&(k=yn,U=Jc(),k.pooledCache=U,U.refCount++,U!==null&&(k.pooledCacheLanes|=p),k=U),c.memoizedState={parent:y,cache:k},xr(c),ql(c,ri,k)):((l.lanes&p)!==0&&(on(l,c),Vn(c,null,null,p),qs()),k=l.memoizedState,U=c.memoizedState,k.parent!==y?(k={parent:y,cache:y},c.memoizedState=k,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=k),ql(c,ri,y)):(y=U.cache,ql(c,ri,y),y!==k.cache&&yA(c,[ri],p,!0))),go(l,c,c.pendingProps.children,p),c.child;case 29:throw c.pendingProps}throw Error(r(156,c.tag))}function CA(l){l.flags|=4}function Vh(l,c,p,y,k){if((c=(l.mode&32)!==0)&&(c=!1),c){if(l.flags|=16777216,(k&335544128)===k)if(l.stateNode.complete)l.flags|=8192;else if(tx())l.flags|=8192;else throw Et=at,ht}else l.flags&=-16777217}function Ho(l,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)l.flags&=-16777217;else if(l.flags|=16777216,!cr(c))if(tx())l.flags|=8192;else throw Et=at,ht}function Ef(l,c){c!==null&&(l.flags|=4),l.flags&16384&&(c=l.tag!==22?hs():536870912,l.lanes|=c,If|=c)}function I0(l,c){if(!es)switch(l.tailMode){case"hidden":c=l.tail;for(var p=null;c!==null;)c.alternate!==null&&(p=c),c=c.sibling;p===null?l.tail=null:p.sibling=null;break;case"collapsed":p=l.tail;for(var y=null;p!==null;)p.alternate!==null&&(y=p),p=p.sibling;y===null?c||l.tail===null?l.tail=null:l.tail.sibling=null:y.sibling=null}}function cn(l){var c=l.alternate!==null&&l.alternate.child===l.child,p=0,y=0;if(c)for(var k=l.child;k!==null;)p|=k.lanes|k.childLanes,y|=k.subtreeFlags&65011712,y|=k.flags&65011712,k.return=l,k=k.sibling;else for(k=l.child;k!==null;)p|=k.lanes|k.childLanes,y|=k.subtreeFlags,y|=k.flags,k.return=l,k=k.sibling;return l.subtreeFlags|=y,l.childLanes=p,c}function ny(l,c,p){var y=c.pendingProps;switch(wu(c),c.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return cn(c),null;case 1:return cn(c),null;case 3:return p=c.stateNode,y=null,l!==null&&(y=l.memoizedState.cache),c.memoizedState.cache!==y&&(c.flags|=2048),ol(ri),ve(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(l===null||l.child===null)&&(_i(c)?CA(c):l===null||l.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,$c())),cn(c),null;case 26:var k=c.type,U=c.memoizedState;return l===null?(CA(c),U!==null?(cn(c),Ho(c,U)):(cn(c),Vh(c,k,null,y,p))):U?U!==l.memoizedState?(CA(c),cn(c),Ho(c,U)):(cn(c),c.flags&=-16777217):(l=l.memoizedProps,l!==y&&CA(c),cn(c),Vh(c,k,l,y,p)),null;case 27:if(Qe(c),p=ie.current,k=c.type,l!==null&&c.stateNode!=null)l.memoizedProps!==y&&CA(c);else{if(!y){if(c.stateNode===null)throw Error(r(166));return cn(c),null}l=de.current,_i(c)?Qo(c):(l=o(k,y,p),c.stateNode=l,CA(c))}return cn(c),null;case 5:if(Qe(c),k=c.type,l!==null&&c.stateNode!=null)l.memoizedProps!==y&&CA(c);else{if(!y){if(c.stateNode===null)throw Error(r(166));return cn(c),null}if(U=de.current,_i(c))Qo(c);else{var Ae=J0(ie.current);switch(U){case 1:U=Ae.createElementNS("http://www.w3.org/2000/svg",k);break;case 2:U=Ae.createElementNS("http://www.w3.org/1998/Math/MathML",k);break;default:switch(k){case"svg":U=Ae.createElementNS("http://www.w3.org/2000/svg",k);break;case"math":U=Ae.createElementNS("http://www.w3.org/1998/Math/MathML",k);break;case"script":U=Ae.createElement("div"),U.innerHTML="<script><\/script>",U=U.removeChild(U.firstChild);break;case"select":U=typeof y.is=="string"?Ae.createElement("select",{is:y.is}):Ae.createElement("select"),y.multiple?U.multiple=!0:y.size&&(U.size=y.size);break;default:U=typeof y.is=="string"?Ae.createElement(k,{is:y.is}):Ae.createElement(k)}}U[Is]=c,U[ba]=y;e:for(Ae=c.child;Ae!==null;){if(Ae.tag===5||Ae.tag===6)U.appendChild(Ae.stateNode);else if(Ae.tag!==4&&Ae.tag!==27&&Ae.child!==null){Ae.child.return=Ae,Ae=Ae.child;continue}if(Ae===c)break e;for(;Ae.sibling===null;){if(Ae.return===null||Ae.return===c)break e;Ae=Ae.return}Ae.sibling.return=Ae.return,Ae=Ae.sibling}c.stateNode=U;e:switch(yo(U,k,y),k){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}y&&CA(c)}}return cn(c),Vh(c,c.type,l===null?null:l.memoizedProps,c.pendingProps,p),null;case 6:if(l&&c.stateNode!=null)l.memoizedProps!==y&&CA(c);else{if(typeof y!="string"&&c.stateNode===null)throw Error(r(166));if(l=ie.current,_i(c)){if(l=c.stateNode,p=c.memoizedProps,y=null,k=Ti,k!==null)switch(k.tag){case 27:case 5:y=k.memoizedProps}l[Is]=c,l=!!(l.nodeValue===p||y!==null&&y.suppressHydrationWarning===!0||s1(l.nodeValue,p)),l||$s(c,!0)}else l=J0(l).createTextNode(y),l[Is]=c,c.stateNode=l}return cn(c),null;case 31:if(p=c.memoizedState,l===null||l.memoizedState!==null){if(y=_i(c),p!==null){if(l===null){if(!y)throw Error(r(318));if(l=c.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(r(557));l[Is]=c}else $l(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;cn(c),l=!1}else p=$c(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=p),l=!0;if(!l)return c.flags&256?(xs(c),c):(xs(c),null);if((c.flags&128)!==0)throw Error(r(558))}return cn(c),null;case 13:if(y=c.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(k=_i(c),y!==null&&y.dehydrated!==null){if(l===null){if(!k)throw Error(r(318));if(k=c.memoizedState,k=k!==null?k.dehydrated:null,!k)throw Error(r(317));k[Is]=c}else $l(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;cn(c),k=!1}else k=$c(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=k),k=!0;if(!k)return c.flags&256?(xs(c),c):(xs(c),null)}return xs(c),(c.flags&128)!==0?(c.lanes=p,c):(p=y!==null,l=l!==null&&l.memoizedState!==null,p&&(y=c.child,k=null,y.alternate!==null&&y.alternate.memoizedState!==null&&y.alternate.memoizedState.cachePool!==null&&(k=y.alternate.memoizedState.cachePool.pool),U=null,y.memoizedState!==null&&y.memoizedState.cachePool!==null&&(U=y.memoizedState.cachePool.pool),U!==k&&(y.flags|=2048)),p!==l&&p&&(c.child.flags|=8192),Ef(c,c.updateQueue),cn(c),null);case 4:return ve(),l===null&&r1(c.stateNode.containerInfo),cn(c),null;case 10:return ol(c.type),cn(c),null;case 19:if(V(As),y=c.memoizedState,y===null)return cn(c),null;if(k=(c.flags&128)!==0,U=y.rendering,U===null)if(k)I0(y,!1);else{if(ni!==0||l!==null&&(l.flags&128)!==0)for(l=c.child;l!==null;){if(U=Ui(l),U!==null){for(c.flags|=128,I0(y,!1),l=U.updateQueue,c.updateQueue=l,Ef(c,l),c.subtreeFlags=0,l=p,p=c.child;p!==null;)YA(p,l),p=p.sibling;return le(As,As.current&1|2),es&&Oo(c,y.treeForkCount),c.child}l=l.sibling}y.tail!==null&&mr()>tm&&(c.flags|=128,k=!0,I0(y,!1),c.lanes=4194304)}else{if(!k)if(l=Ui(U),l!==null){if(c.flags|=128,k=!0,l=l.updateQueue,c.updateQueue=l,Ef(c,l),I0(y,!0),y.tail===null&&y.tailMode==="hidden"&&!U.alternate&&!es)return cn(c),null}else 2*mr()-y.renderingStartTime>tm&&p!==536870912&&(c.flags|=128,k=!0,I0(y,!1),c.lanes=4194304);y.isBackwards?(U.sibling=c.child,c.child=U):(l=y.last,l!==null?l.sibling=U:c.child=U,y.last=U)}return y.tail!==null?(l=y.tail,y.rendering=l,y.tail=l.sibling,y.renderingStartTime=mr(),l.sibling=null,p=As.current,le(As,k?p&1|2:p&1),es&&Oo(c,y.treeForkCount),l):(cn(c),null);case 22:case 23:return xs(c),Ni(),y=c.memoizedState!==null,l!==null?l.memoizedState!==null!==y&&(c.flags|=8192):y&&(c.flags|=8192),y?(p&536870912)!==0&&(c.flags&128)===0&&(cn(c),c.subtreeFlags&6&&(c.flags|=8192)):cn(c),p=c.updateQueue,p!==null&&Ef(c,p.retryQueue),p=null,l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(p=l.memoizedState.cachePool.pool),y=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(y=c.memoizedState.cachePool.pool),y!==p&&(c.flags|=2048),l!==null&&V(Le),null;case 24:return p=null,l!==null&&(p=l.memoizedState.cache),c.memoizedState.cache!==p&&(c.flags|=2048),ol(ri),cn(c),null;case 25:return null;case 30:return null}throw Error(r(156,c.tag))}function Yh(l,c){switch(wu(c),c.tag){case 1:return l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 3:return ol(ri),ve(),l=c.flags,(l&65536)!==0&&(l&128)===0?(c.flags=l&-65537|128,c):null;case 26:case 27:case 5:return Qe(c),null;case 31:if(c.memoizedState!==null){if(xs(c),c.alternate===null)throw Error(r(340));$l()}return l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 13:if(xs(c),l=c.memoizedState,l!==null&&l.dehydrated!==null){if(c.alternate===null)throw Error(r(340));$l()}return l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 19:return V(As),null;case 4:return ve(),null;case 10:return ol(c.type),null;case 22:case 23:return xs(c),Ni(),l!==null&&V(Le),l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 24:return ol(ri),null;case 25:return null;default:return null}}function Pg(l,c){switch(wu(c),c.tag){case 3:ol(ri),ve();break;case 26:case 27:case 5:Qe(c);break;case 4:ve();break;case 31:c.memoizedState!==null&&xs(c);break;case 13:xs(c);break;case 19:V(As);break;case 10:ol(c.type);break;case 22:case 23:xs(c),Ni(),l!==null&&V(Le);break;case 24:ol(ri)}}function O0(l,c){try{var p=c.updateQueue,y=p!==null?p.lastEffect:null;if(y!==null){var k=y.next;p=k;do{if((p.tag&l)===l){y=void 0;var U=p.create,Ae=p.inst;y=U(),Ae.destroy=y}p=p.next}while(p!==k)}}catch(_e){Hs(c,c.return,_e)}}function zd(l,c,p){try{var y=c.updateQueue,k=y!==null?y.lastEffect:null;if(k!==null){var U=k.next;y=U;do{if((y.tag&l)===l){var Ae=y.inst,_e=Ae.destroy;if(_e!==void 0){Ae.destroy=void 0,k=c;var Ve=p,lt=_e;try{lt()}catch(kt){Hs(k,Ve,kt)}}}y=y.next}while(y!==U)}}catch(kt){Hs(c,c.return,kt)}}function Pp(l){var c=l.updateQueue;if(c!==null){var p=l.stateNode;try{Yn(c,p)}catch(y){Hs(l,l.return,y)}}}function Hg(l,c,p){p.props=Pd(l.type,l.memoizedProps),p.state=l.memoizedState;try{p.componentWillUnmount()}catch(y){Hs(l,c,y)}}function kf(l,c){try{var p=l.ref;if(p!==null){switch(l.tag){case 26:case 27:case 5:var y=l.stateNode;break;case 30:y=l.stateNode;break;default:y=l.stateNode}typeof p=="function"?l.refCleanup=p(y):p.current=y}}catch(k){Hs(l,c,k)}}function Bc(l,c){var p=l.ref,y=l.refCleanup;if(p!==null)if(typeof y=="function")try{y()}catch(k){Hs(l,c,k)}finally{l.refCleanup=null,l=l.alternate,l!=null&&(l.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(k){Hs(l,c,k)}else p.current=null}function Df(l){var c=l.type,p=l.memoizedProps,y=l.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":p.autoFocus&&y.focus();break e;case"img":p.src?y.src=p.src:p.srcSet&&(y.srcset=p.srcSet)}}catch(k){Hs(l,l.return,k)}}function Kd(l,c,p){try{var y=l.stateNode;i1(y,l.type,p,c),y[ba]=c}catch(k){Hs(l,l.return,k)}}function Tf(l){return l.tag===5||l.tag===3||l.tag===26||l.tag===27&&ud(l.type)||l.tag===4}function Q0(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||Tf(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.tag===27&&ud(l.type)||l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function _f(l,c,p){var y=l.tag;if(y===5||y===6)l=l.stateNode,c?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(l,c):(c=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,c.appendChild(l),p=p._reactRootContainer,p!=null||c.onclick!==null||(c.onclick=To));else if(y!==4&&(y===27&&ud(l.type)&&(p=l.stateNode,c=null),l=l.child,l!==null))for(_f(l,c,p),l=l.sibling;l!==null;)_f(l,c,p),l=l.sibling}function jA(l,c,p){var y=l.tag;if(y===5||y===6)l=l.stateNode,c?p.insertBefore(l,c):p.appendChild(l);else if(y!==4&&(y===27&&ud(l.type)&&(p=l.stateNode),l=l.child,l!==null))for(jA(l,c,p),l=l.sibling;l!==null;)jA(l,c,p),l=l.sibling}function ad(l){var c=l.stateNode,p=l.memoizedProps;try{for(var y=l.type,k=c.attributes;k.length;)c.removeAttributeNode(k[0]);yo(c,y,p),c[Is]=l,c[ba]=p}catch(U){Hs(l,l.return,U)}}var BA=!1,Qi=!1,Hp=!1,zg=typeof WeakSet=="function"?WeakSet:Set,xo=null;function iy(l,c){if(l=l.containerInfo,Hf=bs,l=Wl(l),jl(l)){if("selectionStart"in l)var p={start:l.selectionStart,end:l.selectionEnd};else e:{p=(p=l.ownerDocument)&&p.defaultView||window;var y=p.getSelection&&p.getSelection();if(y&&y.rangeCount!==0){p=y.anchorNode;var k=y.anchorOffset,U=y.focusNode;y=y.focusOffset;try{p.nodeType,U.nodeType}catch{p=null;break e}var Ae=0,_e=-1,Ve=-1,lt=0,kt=0,_t=l,gt=null;t:for(;;){for(var Nt;_t!==p||k!==0&&_t.nodeType!==3||(_e=Ae+k),_t!==U||y!==0&&_t.nodeType!==3||(Ve=Ae+y),_t.nodeType===3&&(Ae+=_t.nodeValue.length),(Nt=_t.firstChild)!==null;)gt=_t,_t=Nt;for(;;){if(_t===l)break t;if(gt===p&&++lt===k&&(_e=Ae),gt===U&&++kt===y&&(Ve=Ae),(Nt=_t.nextSibling)!==null)break;_t=gt,gt=_t.parentNode}_t=Nt}p=_e===-1||Ve===-1?null:{start:_e,end:Ve}}else p=null}p=p||{start:0,end:0}}else p=null;for(gm={focusedElem:l,selectionRange:p},bs=!1,xo=c;xo!==null;)if(c=xo,l=c.child,(c.subtreeFlags&1028)!==0&&l!==null)l.return=c,xo=l;else for(;xo!==null;){switch(c=xo,U=c.alternate,l=c.flags,c.tag){case 0:if((l&4)!==0&&(l=c.updateQueue,l=l!==null?l.events:null,l!==null))for(p=0;p<l.length;p++)k=l[p],k.ref.impl=k.nextImpl;break;case 11:case 15:break;case 1:if((l&1024)!==0&&U!==null){l=void 0,p=c,k=U.memoizedProps,U=U.memoizedState,y=p.stateNode;try{var Wr=Pd(p.type,k);l=y.getSnapshotBeforeUpdate(Wr,U),y.__reactInternalSnapshotBeforeUpdate=l}catch(Ca){Hs(p,p.return,Ca)}}break;case 3:if((l&1024)!==0){if(l=c.stateNode.containerInfo,p=l.nodeType,p===9)wm(l);else if(p===1)switch(l.nodeName){case"HEAD":case"HTML":case"BODY":wm(l);break;default:l.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((l&1024)!==0)throw Error(r(163))}if(l=c.sibling,l!==null){l.return=c.return,xo=l;break}xo=c.return}}function Kg(l,c,p){var y=p.flags;switch(p.tag){case 0:case 11:case 15:SA(l,p),y&4&&O0(5,p);break;case 1:if(SA(l,p),y&4)if(l=p.stateNode,c===null)try{l.componentDidMount()}catch(Ae){Hs(p,p.return,Ae)}else{var k=Pd(p.type,c.memoizedProps);c=c.memoizedState;try{l.componentDidUpdate(k,c,l.__reactInternalSnapshotBeforeUpdate)}catch(Ae){Hs(p,p.return,Ae)}}y&64&&Pp(p),y&512&&kf(p,p.return);break;case 3:if(SA(l,p),y&64&&(l=p.updateQueue,l!==null)){if(c=null,p.child!==null)switch(p.child.tag){case 27:case 5:c=p.child.stateNode;break;case 1:c=p.child.stateNode}try{Yn(l,c)}catch(Ae){Hs(p,p.return,Ae)}}break;case 27:c===null&&y&4&&ad(p);case 26:case 5:SA(l,p),c===null&&y&4&&Df(p),y&512&&kf(p,p.return);break;case 12:SA(l,p);break;case 31:SA(l,p),y&4&&Wh(l,p);break;case 13:SA(l,p),y&4&&Yg(l,p),y&64&&(l=p.memoizedState,l!==null&&(l=l.dehydrated,l!==null&&(p=Ax.bind(null,p),f1(l,p))));break;case 22:if(y=p.memoizedState!==null||BA,!y){c=c!==null&&c.memoizedState!==null||Qi,k=BA;var U=Qi;BA=y,(Qi=c)&&!U?nd(l,p,(p.subtreeFlags&8772)!==0):SA(l,p),BA=k,Qi=U}break;case 30:break;default:SA(l,p)}}function Gg(l){var c=l.alternate;c!==null&&(l.alternate=null,Gg(c)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(c=l.stateNode,c!==null&&Hl(c)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}var Qn=null,El=!1;function sd(l,c,p){for(p=p.child;p!==null;)Vg(l,c,p),p=p.sibling}function Vg(l,c,p){if(hr&&typeof hr.onCommitFiberUnmount=="function")try{hr.onCommitFiberUnmount(oa,p)}catch{}switch(p.tag){case 26:Qi||Bc(p,c),sd(l,c,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:Qi||Bc(p,c);var y=Qn,k=El;ud(p.type)&&(Qn=p.stateNode,El=!1),sd(l,c,p),A(p.stateNode),Qn=y,El=k;break;case 5:Qi||Bc(p,c);case 6:if(y=Qn,k=El,Qn=null,sd(l,c,p),Qn=y,El=k,Qn!==null)if(El)try{(Qn.nodeType===9?Qn.body:Qn.nodeName==="HTML"?Qn.ownerDocument.body:Qn).removeChild(p.stateNode)}catch(U){Hs(p,c,U)}else try{Qn.removeChild(p.stateNode)}catch(U){Hs(p,c,U)}break;case 18:Qn!==null&&(El?(l=Qn,vm(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,p.stateNode),ea(l)):vm(Qn,p.stateNode));break;case 4:y=Qn,k=El,Qn=p.stateNode.containerInfo,El=!0,sd(l,c,p),Qn=y,El=k;break;case 0:case 11:case 14:case 15:zd(2,p,c),Qi||zd(4,p,c),sd(l,c,p);break;case 1:Qi||(Bc(p,c),y=p.stateNode,typeof y.componentWillUnmount=="function"&&Hg(p,c,y)),sd(l,c,p);break;case 21:sd(l,c,p);break;case 22:Qi=(y=Qi)||p.memoizedState!==null,sd(l,c,p),Qi=y;break;default:sd(l,c,p)}}function Wh(l,c){if(c.memoizedState===null&&(l=c.alternate,l!==null&&(l=l.memoizedState,l!==null))){l=l.dehydrated;try{ea(l)}catch(p){Hs(c,c.return,p)}}}function Yg(l,c){if(c.memoizedState===null&&(l=c.alternate,l!==null&&(l=l.memoizedState,l!==null&&(l=l.dehydrated,l!==null))))try{ea(l)}catch(p){Hs(c,c.return,p)}}function oy(l){switch(l.tag){case 31:case 13:case 19:var c=l.stateNode;return c===null&&(c=l.stateNode=new zg),c;case 22:return l=l.stateNode,c=l._retryCache,c===null&&(c=l._retryCache=new zg),c;default:throw Error(r(435,l.tag))}}function $h(l,c){var p=oy(l);c.forEach(function(y){if(!p.has(y)){p.add(y);var k=dx.bind(null,l,y);y.then(k,k)}})}function cl(l,c){var p=c.deletions;if(p!==null)for(var y=0;y<p.length;y++){var k=p[y],U=l,Ae=c,_e=Ae;e:for(;_e!==null;){switch(_e.tag){case 27:if(ud(_e.type)){Qn=_e.stateNode,El=!1;break e}break;case 5:Qn=_e.stateNode,El=!1;break e;case 3:case 4:Qn=_e.stateNode.containerInfo,El=!0;break e}_e=_e.return}if(Qn===null)throw Error(r(160));Vg(U,Ae,k),Qn=null,El=!1,U=k.alternate,U!==null&&(U.return=null),k.return=null}if(c.subtreeFlags&13886)for(c=c.child;c!==null;)zp(c,l),c=c.sibling}var Sc=null;function zp(l,c){var p=l.alternate,y=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:cl(c,l),Al(l),y&4&&(zd(3,l,l.return),O0(3,l),zd(5,l,l.return));break;case 1:cl(c,l),Al(l),y&512&&(Qi||p===null||Bc(p,p.return)),y&64&&BA&&(l=l.updateQueue,l!==null&&(y=l.callbacks,y!==null&&(p=l.shared.hiddenCallbacks,l.shared.hiddenCallbacks=p===null?y:p.concat(y))));break;case 26:var k=Sc;if(cl(c,l),Al(l),y&512&&(Qi||p===null||Bc(p,p.return)),y&4){var U=p!==null?p.memoizedState:null;if(y=l.memoizedState,p===null)if(y===null)if(l.stateNode===null){e:{y=l.type,p=l.memoizedProps,k=k.ownerDocument||k;t:switch(y){case"title":U=k.getElementsByTagName("title")[0],(!U||U[Fi]||U[Is]||U.namespaceURI==="http://www.w3.org/2000/svg"||U.hasAttribute("itemprop"))&&(U=k.createElement(y),k.head.insertBefore(U,k.querySelector("head > title"))),yo(U,y,p),U[Is]=l,hn(U),y=U;break e;case"link":var Ae=Zt("link","href",k).get(y+(p.href||""));if(Ae){for(var _e=0;_e<Ae.length;_e++)if(U=Ae[_e],U.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&U.getAttribute("rel")===(p.rel==null?null:p.rel)&&U.getAttribute("title")===(p.title==null?null:p.title)&&U.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){Ae.splice(_e,1);break t}}U=k.createElement(y),yo(U,y,p),k.head.appendChild(U);break;case"meta":if(Ae=Zt("meta","content",k).get(y+(p.content||""))){for(_e=0;_e<Ae.length;_e++)if(U=Ae[_e],U.getAttribute("content")===(p.content==null?null:""+p.content)&&U.getAttribute("name")===(p.name==null?null:p.name)&&U.getAttribute("property")===(p.property==null?null:p.property)&&U.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&U.getAttribute("charset")===(p.charSet==null?null:p.charSet)){Ae.splice(_e,1);break t}}U=k.createElement(y),yo(U,y,p),k.head.appendChild(U);break;default:throw Error(r(468,y))}U[Is]=l,hn(U),y=U}l.stateNode=y}else Br(k,l.type,l.stateNode);else l.stateNode=rt(k,y,l.memoizedProps);else U!==y?(U===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):U.count--,y===null?Br(k,l.type,l.stateNode):rt(k,y,l.memoizedProps)):y===null&&l.stateNode!==null&&Kd(l,l.memoizedProps,p.memoizedProps)}break;case 27:cl(c,l),Al(l),y&512&&(Qi||p===null||Bc(p,p.return)),p!==null&&y&4&&Kd(l,l.memoizedProps,p.memoizedProps);break;case 5:if(cl(c,l),Al(l),y&512&&(Qi||p===null||Bc(p,p.return)),l.flags&32){k=l.stateNode;try{Vi(k,"")}catch(Wr){Hs(l,l.return,Wr)}}y&4&&l.stateNode!=null&&(k=l.memoizedProps,Kd(l,k,p!==null?p.memoizedProps:k)),y&1024&&(Hp=!0);break;case 6:if(cl(c,l),Al(l),y&4){if(l.stateNode===null)throw Error(r(162));y=l.memoizedProps,p=l.stateNode;try{p.nodeValue=y}catch(Wr){Hs(l,l.return,Wr)}}break;case 3:if(vt=null,k=Sc,Sc=x(c.containerInfo),cl(c,l),Sc=k,Al(l),y&4&&p!==null&&p.memoizedState.isDehydrated)try{ea(c.containerInfo)}catch(Wr){Hs(l,l.return,Wr)}Hp&&(Hp=!1,Kp(l));break;case 4:y=Sc,Sc=x(l.stateNode.containerInfo),cl(c,l),Al(l),Sc=y;break;case 12:cl(c,l),Al(l);break;case 31:cl(c,l),Al(l),y&4&&(y=l.updateQueue,y!==null&&(l.updateQueue=null,$h(l,y)));break;case 13:cl(c,l),Al(l),l.child.flags&8192&&l.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(em=mr()),y&4&&(y=l.updateQueue,y!==null&&(l.updateQueue=null,$h(l,y)));break;case 22:k=l.memoizedState!==null;var Ve=p!==null&&p.memoizedState!==null,lt=BA,kt=Qi;if(BA=lt||k,Qi=kt||Ve,cl(c,l),Qi=kt,BA=lt,Al(l),y&8192)e:for(c=l.stateNode,c._visibility=k?c._visibility&-2:c._visibility|1,k&&(p===null||Ve||BA||Qi||Gd(l)),p=null,c=l;;){if(c.tag===5||c.tag===26){if(p===null){Ve=p=c;try{if(U=Ve.stateNode,k)Ae=U.style,typeof Ae.setProperty=="function"?Ae.setProperty("display","none","important"):Ae.display="none";else{_e=Ve.stateNode;var _t=Ve.memoizedProps.style,gt=_t!=null&&_t.hasOwnProperty("display")?_t.display:null;_e.style.display=gt==null||typeof gt=="boolean"?"":(""+gt).trim()}}catch(Wr){Hs(Ve,Ve.return,Wr)}}}else if(c.tag===6){if(p===null){Ve=c;try{Ve.stateNode.nodeValue=k?"":Ve.memoizedProps}catch(Wr){Hs(Ve,Ve.return,Wr)}}}else if(c.tag===18){if(p===null){Ve=c;try{var Nt=Ve.stateNode;k?d1(Nt,!0):d1(Ve.stateNode,!1)}catch(Wr){Hs(Ve,Ve.return,Wr)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===l)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===l)break e;for(;c.sibling===null;){if(c.return===null||c.return===l)break e;p===c&&(p=null),c=c.return}p===c&&(p=null),c.sibling.return=c.return,c=c.sibling}y&4&&(y=l.updateQueue,y!==null&&(p=y.retryQueue,p!==null&&(y.retryQueue=null,$h(l,p))));break;case 19:cl(c,l),Al(l),y&4&&(y=l.updateQueue,y!==null&&(l.updateQueue=null,$h(l,y)));break;case 30:break;case 21:break;default:cl(c,l),Al(l)}}function Al(l){var c=l.flags;if(c&2){try{for(var p,y=l.return;y!==null;){if(Tf(y)){p=y;break}y=y.return}if(p==null)throw Error(r(160));switch(p.tag){case 27:var k=p.stateNode,U=Q0(l);jA(l,U,k);break;case 5:var Ae=p.stateNode;p.flags&32&&(Vi(Ae,""),p.flags&=-33);var _e=Q0(l);jA(l,_e,Ae);break;case 3:case 4:var Ve=p.stateNode.containerInfo,lt=Q0(l);_f(l,lt,Ve);break;default:throw Error(r(161))}}catch(kt){Hs(l,l.return,kt)}l.flags&=-3}c&4096&&(l.flags&=-4097)}function Kp(l){if(l.subtreeFlags&1024)for(l=l.child;l!==null;){var c=l;Kp(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),l=l.sibling}}function SA(l,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)Kg(l,c.alternate,c),c=c.sibling}function Gd(l){for(l=l.child;l!==null;){var c=l;switch(c.tag){case 0:case 11:case 14:case 15:zd(4,c,c.return),Gd(c);break;case 1:Bc(c,c.return);var p=c.stateNode;typeof p.componentWillUnmount=="function"&&Hg(c,c.return,p),Gd(c);break;case 27:A(c.stateNode);case 26:case 5:Bc(c,c.return),Gd(c);break;case 22:c.memoizedState===null&&Gd(c);break;case 30:Gd(c);break;default:Gd(c)}l=l.sibling}}function nd(l,c,p){for(p=p&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var y=c.alternate,k=l,U=c,Ae=U.flags;switch(U.tag){case 0:case 11:case 15:nd(k,U,p),O0(4,U);break;case 1:if(nd(k,U,p),y=U,k=y.stateNode,typeof k.componentDidMount=="function")try{k.componentDidMount()}catch(lt){Hs(y,y.return,lt)}if(y=U,k=y.updateQueue,k!==null){var _e=y.stateNode;try{var Ve=k.shared.hiddenCallbacks;if(Ve!==null)for(k.shared.hiddenCallbacks=null,k=0;k<Ve.length;k++)Ji(Ve[k],_e)}catch(lt){Hs(y,y.return,lt)}}p&&Ae&64&&Pp(U),kf(U,U.return);break;case 27:ad(U);case 26:case 5:nd(k,U,p),p&&y===null&&Ae&4&&Df(U),kf(U,U.return);break;case 12:nd(k,U,p);break;case 31:nd(k,U,p),p&&Ae&4&&Wh(k,U);break;case 13:nd(k,U,p),p&&Ae&4&&Yg(k,U);break;case 22:U.memoizedState===null&&nd(k,U,p),kf(U,U.return);break;case 30:break;default:nd(k,U,p)}c=c.sibling}}function Gp(l,c){var p=null;l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(p=l.memoizedState.cachePool.pool),l=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(l=c.memoizedState.cachePool.pool),l!==p&&(l!=null&&l.refCount++,p!=null&&JA(p))}function qh(l,c){l=null,c.alternate!==null&&(l=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==l&&(c.refCount++,l!=null&&JA(l))}function nA(l,c,p,y){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)R0(l,c,p,y),c=c.sibling}function R0(l,c,p,y){var k=c.flags;switch(c.tag){case 0:case 11:case 15:nA(l,c,p,y),k&2048&&O0(9,c);break;case 1:nA(l,c,p,y);break;case 3:nA(l,c,p,y),k&2048&&(l=null,c.alternate!==null&&(l=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==l&&(c.refCount++,l!=null&&JA(l)));break;case 12:if(k&2048){nA(l,c,p,y),l=c.stateNode;try{var U=c.memoizedProps,Ae=U.id,_e=U.onPostCommit;typeof _e=="function"&&_e(Ae,c.alternate===null?"mount":"update",l.passiveEffectDuration,-0)}catch(Ve){Hs(c,c.return,Ve)}}else nA(l,c,p,y);break;case 31:nA(l,c,p,y);break;case 13:nA(l,c,p,y);break;case 23:break;case 22:U=c.stateNode,Ae=c.alternate,c.memoizedState!==null?U._visibility&2?nA(l,c,p,y):Uf(l,c):U._visibility&2?nA(l,c,p,y):(U._visibility|=2,Lf(l,c,p,y,(c.subtreeFlags&10256)!==0||!1)),k&2048&&Gp(Ae,c);break;case 24:nA(l,c,p,y),k&2048&&qh(c.alternate,c);break;default:nA(l,c,p,y)}}function Lf(l,c,p,y,k){for(k=k&&((c.subtreeFlags&10256)!==0||!1),c=c.child;c!==null;){var U=l,Ae=c,_e=p,Ve=y,lt=Ae.flags;switch(Ae.tag){case 0:case 11:case 15:Lf(U,Ae,_e,Ve,k),O0(8,Ae);break;case 23:break;case 22:var kt=Ae.stateNode;Ae.memoizedState!==null?kt._visibility&2?Lf(U,Ae,_e,Ve,k):Uf(U,Ae):(kt._visibility|=2,Lf(U,Ae,_e,Ve,k)),k&&lt&2048&&Gp(Ae.alternate,Ae);break;case 24:Lf(U,Ae,_e,Ve,k),k&&lt&2048&&qh(Ae.alternate,Ae);break;default:Lf(U,Ae,_e,Ve,k)}c=c.sibling}}function Uf(l,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var p=l,y=c,k=y.flags;switch(y.tag){case 22:Uf(p,y),k&2048&&Gp(y.alternate,y);break;case 24:Uf(p,y),k&2048&&qh(y.alternate,y);break;default:Uf(p,y)}c=c.sibling}}var FA=8192;function Mf(l,c,p){if(l.subtreeFlags&FA)for(l=l.child;l!==null;)Vp(l,c,p),l=l.sibling}function Vp(l,c,p){switch(l.tag){case 26:Mf(l,c,p),l.flags&FA&&l.memoizedState!==null&&ur(p,Sc,l.memoizedState,l.memoizedProps);break;case 5:Mf(l,c,p);break;case 3:case 4:var y=Sc;Sc=x(l.stateNode.containerInfo),Mf(l,c,p),Sc=y;break;case 22:l.memoizedState===null&&(y=l.alternate,y!==null&&y.memoizedState!==null?(y=FA,FA=16777216,Mf(l,c,p),FA=y):Mf(l,c,p));break;default:Mf(l,c,p)}}function Wg(l){var c=l.alternate;if(c!==null&&(l=c.child,l!==null)){c.child=null;do c=l.sibling,l.sibling=null,l=c;while(l!==null)}}function P0(l){var c=l.deletions;if((l.flags&16)!==0){if(c!==null)for(var p=0;p<c.length;p++){var y=c[p];xo=y,qg(y,l)}Wg(l)}if(l.subtreeFlags&10256)for(l=l.child;l!==null;)$g(l),l=l.sibling}function $g(l){switch(l.tag){case 0:case 11:case 15:P0(l),l.flags&2048&&zd(9,l,l.return);break;case 3:P0(l);break;case 12:P0(l);break;case 22:var c=l.stateNode;l.memoizedState!==null&&c._visibility&2&&(l.return===null||l.return.tag!==13)?(c._visibility&=-3,Xh(l)):P0(l);break;default:P0(l)}}function Xh(l){var c=l.deletions;if((l.flags&16)!==0){if(c!==null)for(var p=0;p<c.length;p++){var y=c[p];xo=y,qg(y,l)}Wg(l)}for(l=l.child;l!==null;){switch(c=l,c.tag){case 0:case 11:case 15:zd(8,c,c.return),Xh(c);break;case 22:p=c.stateNode,p._visibility&2&&(p._visibility&=-3,Xh(c));break;default:Xh(c)}l=l.sibling}}function qg(l,c){for(;xo!==null;){var p=xo;switch(p.tag){case 0:case 11:case 15:zd(8,p,c);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var y=p.memoizedState.cachePool.pool;y!=null&&y.refCount++}break;case 24:JA(p.memoizedState.cache)}if(y=p.child,y!==null)y.return=p,xo=y;else e:for(p=l;xo!==null;){y=xo;var k=y.sibling,U=y.return;if(Gg(y),y===p){xo=null;break e}if(k!==null){k.return=U,xo=k;break e}xo=U}}}var ly={getCacheForType:function(l){var c=Ai(ri),p=c.data.get(l);return p===void 0&&(p=l(),c.data.set(l,p)),p},cacheSignal:function(){return Ai(ri).controller.signal}},cy=typeof WeakMap=="function"?WeakMap:Map,Qs=0,yn=null,Xa=null,ds=0,Xs=0,Xl=null,id=!1,Uu=!1,Jh=!1,od=0,ni=0,ld=0,Mu=0,Zh=0,Jl=0,If=0,H0=null,kl=null,Yp=!1,em=0,Xg=0,tm=1/0,rm=null,Vd=null,Zi=0,Yd=null,Of=null,Zl=0,am=0,sm=null,Fc=null,z0=0,K0=null;function dl(){return(Qs&2)!==0&&ds!==0?ds&-ds:he.T!==null?rs():_n()}function Jg(){if(Jl===0)if((ds&536870912)===0||es){var l=Rs;Rs<<=1,(Rs&3932160)===0&&(Rs=262144),Jl=l}else Jl=536870912;return l=On.current,l!==null&&(l.flags|=32),Jl}function ul(l,c,p){(l===yn&&(Xs===2||Xs===9)||l.cancelPendingCommit!==null)&&(fl(l,0),Wd(l,ds,Jl,!1)),ra(l,p),((Qs&2)===0||l!==yn)&&(l===yn&&((Qs&2)===0&&(Mu|=p),ni===4&&Wd(l,ds,Jl,!1)),bo(l))}function Zg(l,c,p){if((Qs&6)!==0)throw Error(r(327));var y=!p&&(c&127)===0&&(c&l.expiredLanes)===0||Vo(l,c),k=y?br(l,c):Iu(l,c,!0),U=y;do{if(k===0){Uu&&!y&&Wd(l,c,0,!1);break}else{if(p=l.current.alternate,U&&!Ay(p)){k=Iu(l,c,!1),U=!1;continue}if(k===2){if(U=c,l.errorRecoveryDisabledLanes&U)var Ae=0;else Ae=l.pendingLanes&-536870913,Ae=Ae!==0?Ae:Ae&536870912?536870912:0;if(Ae!==0){c=Ae;e:{var _e=l;k=H0;var Ve=_e.current.memoizedState.isDehydrated;if(Ve&&(fl(_e,Ae).flags|=256),Ae=Iu(_e,Ae,!1),Ae!==2){if(Jh&&!Ve){_e.errorRecoveryDisabledLanes|=U,Mu|=U,k=4;break e}U=kl,kl=k,U!==null&&(kl===null?kl=U:kl.push.apply(kl,U))}k=Ae}if(U=!1,k!==2)continue}}if(k===1){fl(l,0),Wd(l,c,0,!0);break}e:{switch(y=l,U=k,U){case 0:case 1:throw Error(r(345));case 4:if((c&4194048)!==c)break;case 6:Wd(y,c,Jl,!id);break e;case 2:kl=null;break;case 3:case 5:break;default:throw Error(r(329))}if((c&62914560)===c&&(k=em+300-mr(),10<k)){if(Wd(y,c,Jl,!id),$t(y,0,!0)!==0)break e;Zl=c,y.timeoutHandle=bm(ex.bind(null,y,p,kl,rm,Yp,c,Jl,Mu,If,id,U,"Throttled",-0,0),k);break e}ex(y,p,kl,rm,Yp,c,Jl,Mu,If,id,U,null,-0,0)}}break}while(!0);bo(l)}function ex(l,c,p,y,k,U,Ae,_e,Ve,lt,kt,_t,gt,Nt){if(l.timeoutHandle=-1,_t=c.subtreeFlags,_t&8192||(_t&16785408)===16785408){_t={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:To},Vp(c,U,_t);var Wr=(U&62914560)===U?em-mr():(U&4194048)===U?Xg-mr():0;if(Wr=Vt(_t,Wr),Wr!==null){Zl=U,l.cancelPendingCommit=Wr(nx.bind(null,l,c,U,p,y,k,Ae,_e,Ve,kt,_t,null,gt,Nt)),Wd(l,U,Ae,!lt);return}}nx(l,c,U,p,y,k,Ae,_e,Ve)}function Ay(l){for(var c=l;;){var p=c.tag;if((p===0||p===11||p===15)&&c.flags&16384&&(p=c.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var y=0;y<p.length;y++){var k=p[y],U=k.getSnapshot;k=k.value;try{if(!$i(U(),k))return!1}catch{return!1}}if(p=c.child,c.subtreeFlags&16384&&p!==null)p.return=c,c=p;else{if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Wd(l,c,p,y){c&=~Zh,c&=~Mu,l.suspendedLanes|=c,l.pingedLanes&=~c,y&&(l.warmLanes|=c),y=l.expirationTimes;for(var k=c;0<k;){var U=31-Gr(k),Ae=1<<U;y[U]=-1,k&=~Ae}p!==0&&zi(l,p,c)}function nm(){return(Qs&6)===0?(Qu(0),!1):!0}function Wp(){if(Xa!==null){if(Xs===0)var l=Xa.return;else l=Xa,yc=qc=null,Od(l),Kt=null,Vr=0,l=Xa;for(;l!==null;)Pg(l.alternate,l),l=l.return;Xa=null}}function fl(l,c){var p=l.timeoutHandle;p!==-1&&(l.timeoutHandle=-1,px(p)),p=l.cancelPendingCommit,p!==null&&(l.cancelPendingCommit=null,p()),Zl=0,Wp(),yn=l,Xa=p=rl(l.current,null),ds=c,Xs=0,Xl=null,id=!1,Uu=Vo(l,c),Jh=!1,If=Jl=Zh=Mu=ld=ni=0,kl=H0=null,Yp=!1,(c&8)!==0&&(c|=c&32);var y=l.entangledLanes;if(y!==0)for(l=l.entanglements,y&=c;0<y;){var k=31-Gr(y),U=1<<k;c|=l[k],y&=~U}return od=c,Ta(),p}function G0(l,c){da=null,he.H=T0,c===Ze||c===He?(c=Ut(),Xs=3):c===ht?(c=Ut(),Xs=4):Xs=c===Tp?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,Xl=c,Xa===null&&(ni=1,Rh(l,al(c,l.current)))}function tx(){var l=On.current;return l===null?!0:(ds&4194048)===ds?gs===null:(ds&62914560)===ds||(ds&536870912)!==0?l===gs:!1}function Qf(){var l=he.H;return he.H=T0,l===null?T0:l}function V0(){var l=he.A;return he.A=ly,l}function im(){ni=4,id||(ds&4194048)!==ds&&On.current!==null||(Uu=!0),(ld&134217727)===0&&(Mu&134217727)===0||yn===null||Wd(yn,ds,Jl,!1)}function Iu(l,c,p){var y=Qs;Qs|=2;var k=Qf(),U=V0();(yn!==l||ds!==c)&&(rm=null,fl(l,c)),c=!1;var Ae=ni;e:do try{if(Xs!==0&&Xa!==null){var _e=Xa,Ve=Xl;switch(Xs){case 8:Wp(),Ae=6;break e;case 3:case 2:case 9:case 6:On.current===null&&(c=!0);var lt=Xs;if(Xs=0,Xl=null,Rf(l,_e,Ve,lt),p&&Uu){Ae=0;break e}break;default:lt=Xs,Xs=0,Xl=null,Rf(l,_e,Ve,lt)}}$p(),Ae=ni;break}catch(kt){G0(l,kt)}while(!0);return c&&l.shellSuspendCounter++,yc=qc=null,Qs=y,he.H=k,he.A=U,Xa===null&&(yn=null,ds=0,Ta()),Ae}function $p(){for(;Xa!==null;)rx(Xa)}function br(l,c){var p=Qs;Qs|=2;var y=Qf(),k=V0();yn!==l||ds!==c?(rm=null,tm=mr()+500,fl(l,c)):Uu=Vo(l,c);e:do try{if(Xs!==0&&Xa!==null){c=Xa;var U=Xl;t:switch(Xs){case 1:Xs=0,Xl=null,Rf(l,c,U,1);break;case 2:case 9:if(ot(U)){Xs=0,Xl=null,ax(c);break}c=function(){Xs!==2&&Xs!==9||yn!==l||(Xs=7),bo(l)},U.then(c,c);break e;case 3:Xs=7;break e;case 4:Xs=5;break e;case 7:ot(U)?(Xs=0,Xl=null,ax(c)):(Xs=0,Xl=null,Rf(l,c,U,7));break;case 5:var Ae=null;switch(Xa.tag){case 26:Ae=Xa.memoizedState;case 5:case 27:var _e=Xa;if(Ae?cr(Ae):_e.stateNode.complete){Xs=0,Xl=null;var Ve=_e.sibling;if(Ve!==null)Xa=Ve;else{var lt=_e.return;lt!==null?(Xa=lt,om(lt)):Xa=null}break t}}Xs=0,Xl=null,Rf(l,c,U,5);break;case 6:Xs=0,Xl=null,Rf(l,c,U,6);break;case 8:Wp(),ni=6;break e;default:throw Error(r(462))}}Y0();break}catch(kt){G0(l,kt)}while(!0);return yc=qc=null,he.H=y,he.A=k,Qs=p,Xa!==null?0:(yn=null,ds=0,Ta(),ni)}function Y0(){for(;Xa!==null&&!St();)rx(Xa)}function rx(l){var c=Rg(l.alternate,l,od);l.memoizedProps=l.pendingProps,c===null?om(l):Xa=c}function ax(l){var c=l,p=c.alternate;switch(c.tag){case 15:case 0:c=Up(p,c,c.pendingProps,c.type,void 0,ds);break;case 11:c=Up(p,c,c.pendingProps,c.type.render,c.ref,ds);break;case 5:Od(c);default:Pg(p,c),c=Xa=YA(c,od),c=Rg(p,c,od)}l.memoizedProps=l.pendingProps,c===null?om(l):Xa=c}function Rf(l,c,p,y){yc=qc=null,Od(c),Kt=null,Vr=0;var k=c.return;try{if(Mg(l,k,c,p,ds)){ni=1,Rh(l,al(p,l.current)),Xa=null;return}}catch(U){if(k!==null)throw Xa=k,U;ni=1,Rh(l,al(p,l.current)),Xa=null;return}c.flags&32768?(es||y===1?l=!0:Uu||(ds&536870912)!==0?l=!1:(id=l=!0,(y===2||y===9||y===3||y===6)&&(y=On.current,y!==null&&y.tag===13&&(y.flags|=16384))),sx(c,l)):om(c)}function om(l){var c=l;do{if((c.flags&32768)!==0){sx(c,id);return}l=c.return;var p=ny(c.alternate,c,od);if(p!==null){Xa=p;return}if(c=c.sibling,c!==null){Xa=c;return}Xa=c=l}while(c!==null);ni===0&&(ni=5)}function sx(l,c){do{var p=Yh(l.alternate,l);if(p!==null){p.flags&=32767,Xa=p;return}if(p=l.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!c&&(l=l.sibling,l!==null)){Xa=l;return}Xa=l=p}while(l!==null);ni=6,Xa=null}function nx(l,c,p,y,k,U,Ae,_e,Ve){l.cancelPendingCommit=null;do W0();while(Zi!==0);if((Qs&6)!==0)throw Error(r(327));if(c!==null){if(c===l.current)throw Error(r(177));if(U=c.lanes|c.childLanes,U|=xu,ko(l,p,U,Ae,_e,Ve),l===yn&&(Xa=yn=null,ds=0),Of=c,Yd=l,Zl=p,am=U,sm=k,Fc=y,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(l.callbackNode=null,l.callbackPriority=0,ux(vr,function(){return Xp(),null})):(l.callbackNode=null,l.callbackPriority=0),y=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||y){y=he.T,he.T=null,k=Ne.p,Ne.p=2,Ae=Qs,Qs|=4;try{iy(l,c,p)}finally{Qs=Ae,Ne.p=k,he.T=y}}Zi=1,ix(),ox(),lx()}}function ix(){if(Zi===1){Zi=0;var l=Yd,c=Of,p=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||p){p=he.T,he.T=null;var y=Ne.p;Ne.p=2;var k=Qs;Qs|=4;try{zp(c,l);var U=gm,Ae=Wl(l.containerInfo),_e=U.focusedElem,Ve=U.selectionRange;if(Ae!==_e&&_e&&_e.ownerDocument&&zc(_e.ownerDocument.documentElement,_e)){if(Ve!==null&&jl(_e)){var lt=Ve.start,kt=Ve.end;if(kt===void 0&&(kt=lt),"selectionStart"in _e)_e.selectionStart=lt,_e.selectionEnd=Math.min(kt,_e.value.length);else{var _t=_e.ownerDocument||document,gt=_t&&_t.defaultView||window;if(gt.getSelection){var Nt=gt.getSelection(),Wr=_e.textContent.length,Ca=Math.min(Ve.start,Wr),kn=Ve.end===void 0?Ca:Math.min(Ve.end,Wr);!Nt.extend&&Ca>kn&&(Ae=kn,kn=Ca,Ca=Ae);var it=Hc(_e,Ca),et=Hc(_e,kn);if(it&&et&&(Nt.rangeCount!==1||Nt.anchorNode!==it.node||Nt.anchorOffset!==it.offset||Nt.focusNode!==et.node||Nt.focusOffset!==et.offset)){var xt=_t.createRange();xt.setStart(it.node,it.offset),Nt.removeAllRanges(),Ca>kn?(Nt.addRange(xt),Nt.extend(et.node,et.offset)):(xt.setEnd(et.node,et.offset),Nt.addRange(xt))}}}}for(_t=[],Nt=_e;Nt=Nt.parentNode;)Nt.nodeType===1&&_t.push({element:Nt,left:Nt.scrollLeft,top:Nt.scrollTop});for(typeof _e.focus=="function"&&_e.focus(),_e=0;_e<_t.length;_e++){var Ht=_t[_e];Ht.element.scrollLeft=Ht.left,Ht.element.scrollTop=Ht.top}}bs=!!Hf,gm=Hf=null}finally{Qs=k,Ne.p=y,he.T=p}}l.current=c,Zi=2}}function ox(){if(Zi===2){Zi=0;var l=Yd,c=Of,p=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||p){p=he.T,he.T=null;var y=Ne.p;Ne.p=2;var k=Qs;Qs|=4;try{Kg(l,c.alternate,c)}finally{Qs=k,Ne.p=y,he.T=p}}Zi=3}}function lx(){if(Zi===4||Zi===3){Zi=0,Jt();var l=Yd,c=Of,p=Zl,y=Fc;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?Zi=5:(Zi=0,Of=Yd=null,qp(l,l.pendingLanes));var k=l.pendingLanes;if(k===0&&(Vd=null),Tn(p),c=c.stateNode,hr&&typeof hr.onCommitFiberRoot=="function")try{hr.onCommitFiberRoot(oa,c,void 0,(c.current.flags&128)===128)}catch{}if(y!==null){c=he.T,k=Ne.p,Ne.p=2,he.T=null;try{for(var U=l.onRecoverableError,Ae=0;Ae<y.length;Ae++){var _e=y[Ae];U(_e.value,{componentStack:_e.stack})}}finally{he.T=c,Ne.p=k}}(Zl&3)!==0&&W0(),bo(l),k=l.pendingLanes,(p&261930)!==0&&(k&42)!==0?l===K0?z0++:(z0=0,K0=l):z0=0,Qu(0)}}function qp(l,c){(l.pooledCacheLanes&=c)===0&&(c=l.pooledCache,c!=null&&(l.pooledCache=null,JA(c)))}function W0(){return ix(),ox(),lx(),Xp()}function Xp(){if(Zi!==5)return!1;var l=Yd,c=am;am=0;var p=Tn(Zl),y=he.T,k=Ne.p;try{Ne.p=32>p?32:p,he.T=null,p=sm,sm=null;var U=Yd,Ae=Zl;if(Zi=0,Of=Yd=null,Zl=0,(Qs&6)!==0)throw Error(r(331));var _e=Qs;if(Qs|=4,$g(U.current),R0(U,U.current,Ae,p),Qs=_e,Qu(0,!1),hr&&typeof hr.onPostCommitFiberRoot=="function")try{hr.onPostCommitFiberRoot(oa,U)}catch{}return!0}finally{Ne.p=k,he.T=y,qp(l,c)}}function Jp(l,c,p){c=al(p,c),c=Hd(l.stateNode,c,2),l=Ia(l,c,2),l!==null&&(ra(l,2),bo(l))}function Hs(l,c,p){if(l.tag===3)Jp(l,l,p);else for(;c!==null;){if(c.tag===3){Jp(c,l,p);break}else if(c.tag===1){var y=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(Vd===null||!Vd.has(y))){l=al(p,l),p=kp(2),y=Ia(c,p,2),y!==null&&(Dp(p,y,c,l),ra(y,2),bo(y));break}}c=c.return}}function lm(l,c,p){var y=l.pingCache;if(y===null){y=l.pingCache=new cy;var k=new Set;y.set(c,k)}else k=y.get(c),k===void 0&&(k=new Set,y.set(c,k));k.has(p)||(Jh=!0,k.add(p),l=cx.bind(null,l,c,p),c.then(l,l))}function cx(l,c,p){var y=l.pingCache;y!==null&&y.delete(c),l.pingedLanes|=l.suspendedLanes&p,l.warmLanes&=~p,yn===l&&(ds&p)===p&&(ni===4||ni===3&&(ds&62914560)===ds&&300>mr()-em?(Qs&2)===0&&fl(l,0):Zh|=p,If===ds&&(If=0)),bo(l)}function Zp(l,c){c===0&&(c=hs()),l=Mo(l,c),l!==null&&(ra(l,c),bo(l))}function Ax(l){var c=l.memoizedState,p=0;c!==null&&(p=c.retryLane),Zp(l,p)}function dx(l,c){var p=0;switch(l.tag){case 31:case 13:var y=l.stateNode,k=l.memoizedState;k!==null&&(p=k.retryLane);break;case 19:y=l.stateNode;break;case 22:y=l.stateNode._retryCache;break;default:throw Error(r(314))}y!==null&&y.delete(c),Zp(l,p)}function ux(l,c){return Rt(l,c)}var $0=null,Ou=null,cm=!1,Am=!1,dm=!1,cd=0;function bo(l){l!==Ou&&l.next===null&&(Ou===null?$0=Ou=l:Ou=Ou.next=l),Am=!0,cm||(cm=!0,Xn())}function Qu(l,c){if(!dm&&Am){dm=!0;do for(var p=!1,y=$0;y!==null;){if(l!==0){var k=y.pendingLanes;if(k===0)var U=0;else{var Ae=y.suspendedLanes,_e=y.pingedLanes;U=(1<<31-Gr(42|l)+1)-1,U&=k&~(Ae&~_e),U=U&201326741?U&201326741|1:U?U|2:0}U!==0&&(p=!0,ws(y,U))}else U=ds,U=$t(y,y===yn?U:0,y.cancelPendingCommit!==null||y.timeoutHandle!==-1),(U&3)===0||Vo(y,U)||(p=!0,ws(y,U));y=y.next}while(p);dm=!1}}function fx(){Ad()}function Ad(){Am=cm=!1;var l=0;cd!==0&&xm()&&(l=cd);for(var c=mr(),p=null,y=$0;y!==null;){var k=y.next,U=e1(y,c);U===0?(y.next=null,p===null?$0=k:p.next=k,k===null&&(Ou=p)):(p=y,(l!==0||(U&3)!==0)&&(Am=!0)),y=k}Zi!==0&&Zi!==5||Qu(l),cd!==0&&(cd=0)}function e1(l,c){for(var p=l.suspendedLanes,y=l.pingedLanes,k=l.expirationTimes,U=l.pendingLanes&-62914561;0<U;){var Ae=31-Gr(U),_e=1<<Ae,Ve=k[Ae];Ve===-1?((_e&p)===0||(_e&y)!==0)&&(k[Ae]=Hn(_e,c)):Ve<=c&&(l.expiredLanes|=_e),U&=~_e}if(c=yn,p=ds,p=$t(l,l===c?p:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),y=l.callbackNode,p===0||l===c&&(Xs===2||Xs===9)||l.cancelPendingCommit!==null)return y!==null&&y!==null&&Ye(y),l.callbackNode=null,l.callbackPriority=0;if((p&3)===0||Vo(l,p)){if(c=p&-p,c===l.callbackPriority)return c;switch(y!==null&&Ye(y),Tn(p)){case 2:case 8:p=Yt;break;case 32:p=vr;break;case 268435456:p=Mr;break;default:p=vr}return y=Pf.bind(null,l),p=Rt(p,y),l.callbackPriority=c,l.callbackNode=p,c}return y!==null&&y!==null&&Ye(y),l.callbackPriority=2,l.callbackNode=null,2}function Pf(l,c){if(Zi!==0&&Zi!==5)return l.callbackNode=null,l.callbackPriority=0,null;var p=l.callbackNode;if(W0()&&l.callbackNode!==p)return null;var y=ds;return y=$t(l,l===yn?y:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),y===0?null:(Zg(l,y,c),e1(l,mr()),l.callbackNode!=null&&l.callbackNode===p?Pf.bind(null,l):null)}function ws(l,c){if(W0())return null;Zg(l,c,!0)}function Xn(){ym(function(){(Qs&6)!==0?Rt(bt,fx):Ad()})}function rs(){if(cd===0){var l=B;l===0&&(l=Ms,Ms<<=1,(Ms&261888)===0&&(Ms=256)),cd=l}return cd}function Jn(l){return l==null||typeof l=="symbol"||typeof l=="boolean"?null:typeof l=="function"?l:Xo(""+l)}function um(l,c){var p=c.ownerDocument.createElement("input");return p.name=c.name,p.value=c.value,l.id&&p.setAttribute("form",l.id),c.parentNode.insertBefore(p,c),l=new FormData(l),p.parentNode.removeChild(p),l}function Ec(l,c,p,y,k){if(c==="submit"&&p&&p.stateNode===k){var U=Jn((k[ba]||null).action),Ae=y.submitter;Ae&&(c=(c=Ae[ba]||null)?Jn(c.formAction):Ae.getAttribute("formAction"),c!==null&&(U=c,Ae=null));var _e=new Kl("action","action",null,y,k);l.push({event:_e,listeners:[{instance:null,listener:function(){if(y.defaultPrevented){if(cd!==0){var Ve=Ae?um(k,Ae):new FormData(k);Np(p,{pending:!0,data:Ve,method:k.method,action:U},null,Ve)}}else typeof U=="function"&&(_e.preventDefault(),Ve=Ae?um(k,Ae):new FormData(k),Np(p,{pending:!0,data:Ve,method:k.method,action:U},U,Ve))},currentTarget:k}]})}}for(var dd=0;dd<So.length;dd++){var Dl=So[dd],Ru=Dl.toLowerCase(),dy=Dl[0].toUpperCase()+Dl.slice(1);tl(Ru,"on"+dy)}tl(xA,"onAnimationEnd"),tl(Ld,"onAnimationIteration"),tl(p0,"onAnimationStart"),tl("dblclick","onDoubleClick"),tl("focusin","onFocus"),tl("focusout","onBlur"),tl(uf,"onTransitionRun"),tl(ff,"onTransitionStart"),tl(g0,"onTransitionCancel"),tl(x0,"onTransitionEnd"),Ct("onMouseEnter",["mouseout","mouseover"]),Ct("onMouseLeave",["mouseout","mouseover"]),Ct("onPointerEnter",["pointerout","pointerover"]),Ct("onPointerLeave",["pointerout","pointerover"]),qt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),qt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),qt("onBeforeInput",["compositionend","keypress","textInput","paste"]),qt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),qt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),qt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),t1=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Pu));function hx(l,c){c=(c&4)!==0;for(var p=0;p<l.length;p++){var y=l[p],k=y.event;y=y.listeners;e:{var U=void 0;if(c)for(var Ae=y.length-1;0<=Ae;Ae--){var _e=y[Ae],Ve=_e.instance,lt=_e.currentTarget;if(_e=_e.listener,Ve!==U&&k.isPropagationStopped())break e;U=_e,k.currentTarget=lt;try{U(k)}catch(kt){VA(kt)}k.currentTarget=null,U=Ve}else for(Ae=0;Ae<y.length;Ae++){if(_e=y[Ae],Ve=_e.instance,lt=_e.currentTarget,_e=_e.listener,Ve!==U&&k.isPropagationStopped())break e;U=_e,k.currentTarget=lt;try{U(k)}catch(kt){VA(kt)}k.currentTarget=null,U=Ve}}}}function ga(l,c){var p=c[Oa];p===void 0&&(p=c[Oa]=new Set);var y=l+"__bubble";p.has(y)||(mx(c,l,2,!1),p.add(y))}function fm(l,c,p){var y=0;c&&(y|=4),mx(p,l,y,c)}var hm="_reactListening"+Math.random().toString(36).slice(2);function r1(l){if(!l[hm]){l[hm]=!0,tt.forEach(function(p){p!=="selectionchange"&&(t1.has(p)||fm(p,!1,l),fm(p,!0,l))});var c=l.nodeType===9?l:l.ownerDocument;c===null||c[hm]||(c[hm]=!0,fm("selectionchange",!1,c))}}function mx(l,c,p,y){switch(We(c)){case 2:var k=eo;break;case 8:k=kc;break;default:k=Pe}p=k.bind(null,c,p,l),k=void 0,!Dd||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(k=!0),y?k!==void 0?l.addEventListener(c,p,{capture:!0,passive:k}):l.addEventListener(c,p,!0):k!==void 0?l.addEventListener(c,p,{passive:k}):l.addEventListener(c,p,!1)}function mm(l,c,p,y,k){var U=y;if((c&1)===0&&(c&2)===0&&y!==null)e:for(;;){if(y===null)return;var Ae=y.tag;if(Ae===3||Ae===4){var _e=y.stateNode.containerInfo;if(_e===k)break;if(Ae===4)for(Ae=y.return;Ae!==null;){var Ve=Ae.tag;if((Ve===3||Ve===4)&&Ae.stateNode.containerInfo===k)return;Ae=Ae.return}for(;_e!==null;){if(Ae=$o(_e),Ae===null)return;if(Ve=Ae.tag,Ve===5||Ve===6||Ve===26||Ve===27){y=U=Ae;continue e}_e=_e.parentNode}}y=y.return}df(function(){var lt=U,kt=cs(p),_t=[];e:{var gt=GA.get(l);if(gt!==void 0){var Nt=Kl,Wr=l;switch(l){case"keypress":if(Zo(p)===0)break e;case"keydown":case"keyup":Nt=$a;break;case"focusin":Wr="focus",Nt=dc;break;case"focusout":Wr="blur",Nt=dc;break;case"beforeblur":case"afterblur":Nt=dc;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Nt=Gl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Nt=gu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Nt=bi;break;case xA:case Ld:case p0:Nt=R;break;case x0:Nt=Wi;break;case"scroll":case"scrollend":Nt=zA;break;case"wheel":Nt=_s;break;case"copy":case"cut":case"paste":Nt=Ke;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Nt=mn;break;case"toggle":case"beforetoggle":Nt=Ft}var Ca=(c&4)!==0,kn=!Ca&&(l==="scroll"||l==="scrollend"),it=Ca?gt!==null?gt+"Capture":null:gt;Ca=[];for(var et=lt,xt;et!==null;){var Ht=et;if(xt=Ht.stateNode,Ht=Ht.tag,Ht!==5&&Ht!==26&&Ht!==27||xt===null||it===null||(Ht=Jo(et,it),Ht!=null&&Ca.push(q0(et,Ht,xt))),kn)break;et=et.return}0<Ca.length&&(gt=new Nt(gt,Wr,null,p,kt),_t.push({event:gt,listeners:Ca}))}}if((c&7)===0){e:{if(gt=l==="mouseover"||l==="pointerover",Nt=l==="mouseout"||l==="pointerout",gt&&p!==yl&&(Wr=p.relatedTarget||p.fromElement)&&($o(Wr)||Wr[Cn]))break e;if((Nt||gt)&&(gt=kt.window===kt?kt:(gt=kt.ownerDocument)?gt.defaultView||gt.parentWindow:window,Nt?(Wr=p.relatedTarget||p.toElement,Nt=lt,Wr=Wr?$o(Wr):null,Wr!==null&&(kn=e(Wr),Ca=Wr.tag,Wr!==kn||Ca!==5&&Ca!==27&&Ca!==6)&&(Wr=null)):(Nt=null,Wr=lt),Nt!==Wr)){if(Ca=Gl,Ht="onMouseLeave",it="onMouseEnter",et="mouse",(l==="pointerout"||l==="pointerover")&&(Ca=mn,Ht="onPointerLeave",it="onPointerEnter",et="pointer"),kn=Nt==null?gt:zl(Nt),xt=Wr==null?gt:zl(Wr),gt=new Ca(Ht,et+"leave",Nt,p,kt),gt.target=kn,gt.relatedTarget=xt,Ht=null,$o(kt)===lt&&(Ca=new Ca(it,et+"enter",Wr,p,kt),Ca.target=xt,Ca.relatedTarget=kn,Ht=Ca),kn=Ht,Nt&&Wr)t:{for(Ca=a1,it=Nt,et=Wr,xt=0,Ht=it;Ht;Ht=Ca(Ht))xt++;Ht=0;for(var xa=et;xa;xa=Ca(xa))Ht++;for(;0<xt-Ht;)it=Ca(it),xt--;for(;0<Ht-xt;)et=Ca(et),Ht--;for(;xt--;){if(it===et||et!==null&&it===et.alternate){Ca=it;break t}it=Ca(it),et=Ca(et)}Ca=null}else Ca=null;Nt!==null&&pm(_t,gt,Nt,Ca,!1),Wr!==null&&kn!==null&&pm(_t,kn,Wr,Ca,!0)}}e:{if(gt=lt?zl(lt):window,Nt=gt.nodeName&&gt.nodeName.toLowerCase(),Nt==="select"||Nt==="input"&&gt.type==="file")var zs=Pc;else if(vi(gt))if(wi)zs=Ao;else{zs=ys;var la=_d}else Nt=gt.nodeName,!Nt||Nt.toLowerCase()!=="input"||gt.type!=="checkbox"&&gt.type!=="radio"?lt&&HA(lt.elementType)&&(zs=Pc):zs=hc;if(zs&&(zs=zs(l,lt))){fa(_t,zs,p,kt);break e}la&&la(l,gt,lt),l==="focusout"&&lt&&gt.type==="number"&&lt.memoizedProps.value!=null&&Va(gt,"number",gt.value)}switch(la=lt?zl(lt):window,l){case"focusin":(vi(la)||la.contentEditable==="true")&&(Uo=la,pc=lt,zn=null);break;case"focusout":zn=pc=Uo=null;break;case"mousedown":qi=!0;break;case"contextmenu":case"mouseup":case"dragend":qi=!1,Ea(_t,p,kt);break;case"selectionchange":if(Kc)break;case"keydown":case"keyup":Ea(_t,p,kt)}var Za;if(In)e:{switch(l){case"compositionstart":var Ns="onCompositionStart";break e;case"compositionend":Ns="onCompositionEnd";break e;case"compositionupdate":Ns="onCompositionUpdate";break e}Ns=void 0}else Cl?fc(l,p)&&(Ns="onCompositionEnd"):l==="keydown"&&p.keyCode===229&&(Ns="onCompositionStart");Ns&&(Qc&&p.locale!=="ko"&&(Cl||Ns!=="onCompositionStart"?Ns==="onCompositionEnd"&&Cl&&(Za=Mc()):(Yi=kt,lr="value"in Yi?Yi.value:Yi.textContent,Cl=!0)),la=X0(lt,Ns),0<la.length&&(Ns=new nt(Ns,l,null,p,kt),_t.push({event:Ns,listeners:la}),Za?Ns.data=Za:(Za=Vs(p),Za!==null&&(Ns.data=Za)))),(Za=Vl?Sa(l,p):Es(l,p))&&(Ns=X0(lt,"onBeforeInput"),0<Ns.length&&(la=new nt("onBeforeInput","beforeinput",null,p,kt),_t.push({event:la,listeners:Ns}),la.data=Za)),Ec(_t,l,lt,p,kt)}hx(_t,c)})}function q0(l,c,p){return{instance:l,listener:c,currentTarget:p}}function X0(l,c){for(var p=c+"Capture",y=[];l!==null;){var k=l,U=k.stateNode;if(k=k.tag,k!==5&&k!==26&&k!==27||U===null||(k=Jo(l,p),k!=null&&y.unshift(q0(l,k,U)),k=Jo(l,c),k!=null&&y.push(q0(l,k,U))),l.tag===3)return y;l=l.return}return[]}function a1(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5&&l.tag!==27);return l||null}function pm(l,c,p,y,k){for(var U=c._reactName,Ae=[];p!==null&&p!==y;){var _e=p,Ve=_e.alternate,lt=_e.stateNode;if(_e=_e.tag,Ve!==null&&Ve===y)break;_e!==5&&_e!==26&&_e!==27||lt===null||(Ve=lt,k?(lt=Jo(p,U),lt!=null&&Ae.unshift(q0(p,lt,Ve))):k||(lt=Jo(p,U),lt!=null&&Ae.push(q0(p,lt,Ve)))),p=p.return}Ae.length!==0&&l.push({event:c,listeners:Ae})}var uy=/\r\n?/g,fy=/\u0000|\uFFFD/g;function ec(l){return(typeof l=="string"?l:""+l).replace(uy,`
`).replace(fy,"")}function s1(l,c){return c=ec(c),ec(l)===c}function An(l,c,p,y,k,U){switch(p){case"children":typeof y=="string"?c==="body"||c==="textarea"&&y===""||Vi(l,y):(typeof y=="number"||typeof y=="bigint")&&c!=="body"&&Vi(l,""+y);break;case"className":ns(l,"class",y);break;case"tabIndex":ns(l,"tabindex",y);break;case"dir":case"role":case"viewBox":case"width":case"height":ns(l,p,y);break;case"style":Ps(l,y,U);break;case"data":if(c!=="object"){ns(l,"data",y);break}case"src":case"href":if(y===""&&(c!=="a"||p!=="href")){l.removeAttribute(p);break}if(y==null||typeof y=="function"||typeof y=="symbol"||typeof y=="boolean"){l.removeAttribute(p);break}y=Xo(""+y),l.setAttribute(p,y);break;case"action":case"formAction":if(typeof y=="function"){l.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof U=="function"&&(p==="formAction"?(c!=="input"&&An(l,c,"name",k.name,k,null),An(l,c,"formEncType",k.formEncType,k,null),An(l,c,"formMethod",k.formMethod,k,null),An(l,c,"formTarget",k.formTarget,k,null)):(An(l,c,"encType",k.encType,k,null),An(l,c,"method",k.method,k,null),An(l,c,"target",k.target,k,null)));if(y==null||typeof y=="symbol"||typeof y=="boolean"){l.removeAttribute(p);break}y=Xo(""+y),l.setAttribute(p,y);break;case"onClick":y!=null&&(l.onclick=To);break;case"onScroll":y!=null&&ga("scroll",l);break;case"onScrollEnd":y!=null&&ga("scrollend",l);break;case"dangerouslySetInnerHTML":if(y!=null){if(typeof y!="object"||!("__html"in y))throw Error(r(61));if(p=y.__html,p!=null){if(k.children!=null)throw Error(r(60));l.innerHTML=p}}break;case"multiple":l.multiple=y&&typeof y!="function"&&typeof y!="symbol";break;case"muted":l.muted=y&&typeof y!="function"&&typeof y!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(y==null||typeof y=="function"||typeof y=="boolean"||typeof y=="symbol"){l.removeAttribute("xlink:href");break}p=Xo(""+y),l.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":y!=null&&typeof y!="function"&&typeof y!="symbol"?l.setAttribute(p,""+y):l.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":y&&typeof y!="function"&&typeof y!="symbol"?l.setAttribute(p,""):l.removeAttribute(p);break;case"capture":case"download":y===!0?l.setAttribute(p,""):y!==!1&&y!=null&&typeof y!="function"&&typeof y!="symbol"?l.setAttribute(p,y):l.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":y!=null&&typeof y!="function"&&typeof y!="symbol"&&!isNaN(y)&&1<=y?l.setAttribute(p,y):l.removeAttribute(p);break;case"rowSpan":case"start":y==null||typeof y=="function"||typeof y=="symbol"||isNaN(y)?l.removeAttribute(p):l.setAttribute(p,y);break;case"popover":ga("beforetoggle",l),ga("toggle",l),tn(l,"popover",y);break;case"xlinkActuate":Pa(l,"http://www.w3.org/1999/xlink","xlink:actuate",y);break;case"xlinkArcrole":Pa(l,"http://www.w3.org/1999/xlink","xlink:arcrole",y);break;case"xlinkRole":Pa(l,"http://www.w3.org/1999/xlink","xlink:role",y);break;case"xlinkShow":Pa(l,"http://www.w3.org/1999/xlink","xlink:show",y);break;case"xlinkTitle":Pa(l,"http://www.w3.org/1999/xlink","xlink:title",y);break;case"xlinkType":Pa(l,"http://www.w3.org/1999/xlink","xlink:type",y);break;case"xmlBase":Pa(l,"http://www.w3.org/XML/1998/namespace","xml:base",y);break;case"xmlLang":Pa(l,"http://www.w3.org/XML/1998/namespace","xml:lang",y);break;case"xmlSpace":Pa(l,"http://www.w3.org/XML/1998/namespace","xml:space",y);break;case"is":tn(l,"is",y);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=kd.get(p)||p,tn(l,p,y))}}function n1(l,c,p,y,k,U){switch(p){case"style":Ps(l,y,U);break;case"dangerouslySetInnerHTML":if(y!=null){if(typeof y!="object"||!("__html"in y))throw Error(r(61));if(p=y.__html,p!=null){if(k.children!=null)throw Error(r(60));l.innerHTML=p}}break;case"children":typeof y=="string"?Vi(l,y):(typeof y=="number"||typeof y=="bigint")&&Vi(l,""+y);break;case"onScroll":y!=null&&ga("scroll",l);break;case"onScrollEnd":y!=null&&ga("scrollend",l);break;case"onClick":y!=null&&(l.onclick=To);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!zt.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(k=p.endsWith("Capture"),c=p.slice(2,k?p.length-7:void 0),U=l[ba]||null,U=U!=null?U[p]:null,typeof U=="function"&&l.removeEventListener(c,U,k),typeof y=="function")){typeof U!="function"&&U!==null&&(p in l?l[p]=null:l.hasAttribute(p)&&l.removeAttribute(p)),l.addEventListener(c,y,k);break e}p in l?l[p]=y:y===!0?l.setAttribute(p,""):tn(l,p,y)}}}function yo(l,c,p){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ga("error",l),ga("load",l);var y=!1,k=!1,U;for(U in p)if(p.hasOwnProperty(U)){var Ae=p[U];if(Ae!=null)switch(U){case"src":y=!0;break;case"srcSet":k=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:An(l,c,U,Ae,p,null)}}k&&An(l,c,"srcSet",p.srcSet,p,null),y&&An(l,c,"src",p.src,p,null);return;case"input":ga("invalid",l);var _e=U=Ae=k=null,Ve=null,lt=null;for(y in p)if(p.hasOwnProperty(y)){var kt=p[y];if(kt!=null)switch(y){case"name":k=kt;break;case"type":Ae=kt;break;case"checked":Ve=kt;break;case"defaultChecked":lt=kt;break;case"value":U=kt;break;case"defaultValue":_e=kt;break;case"children":case"dangerouslySetInnerHTML":if(kt!=null)throw Error(r(137,c));break;default:An(l,c,y,kt,p,null)}}oc(l,U,_e,Ve,lt,Ae,k,!1);return;case"select":ga("invalid",l),y=Ae=U=null;for(k in p)if(p.hasOwnProperty(k)&&(_e=p[k],_e!=null))switch(k){case"value":U=_e;break;case"defaultValue":Ae=_e;break;case"multiple":y=_e;default:An(l,c,k,_e,p,null)}c=U,p=Ae,l.multiple=!!y,c!=null?li(l,!!y,c,!1):p!=null&&li(l,!!y,p,!0);return;case"textarea":ga("invalid",l),U=k=y=null;for(Ae in p)if(p.hasOwnProperty(Ae)&&(_e=p[Ae],_e!=null))switch(Ae){case"value":y=_e;break;case"defaultValue":k=_e;break;case"children":U=_e;break;case"dangerouslySetInnerHTML":if(_e!=null)throw Error(r(91));break;default:An(l,c,Ae,_e,p,null)}Gi(l,y,k,U);return;case"option":for(Ve in p)if(p.hasOwnProperty(Ve)&&(y=p[Ve],y!=null))switch(Ve){case"selected":l.selected=y&&typeof y!="function"&&typeof y!="symbol";break;default:An(l,c,Ve,y,p,null)}return;case"dialog":ga("beforetoggle",l),ga("toggle",l),ga("cancel",l),ga("close",l);break;case"iframe":case"object":ga("load",l);break;case"video":case"audio":for(y=0;y<Pu.length;y++)ga(Pu[y],l);break;case"image":ga("error",l),ga("load",l);break;case"details":ga("toggle",l);break;case"embed":case"source":case"link":ga("error",l),ga("load",l);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(lt in p)if(p.hasOwnProperty(lt)&&(y=p[lt],y!=null))switch(lt){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:An(l,c,lt,y,p,null)}return;default:if(HA(c)){for(kt in p)p.hasOwnProperty(kt)&&(y=p[kt],y!==void 0&&n1(l,c,kt,y,p,void 0));return}}for(_e in p)p.hasOwnProperty(_e)&&(y=p[_e],y!=null&&An(l,c,_e,y,p,null))}function i1(l,c,p,y){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var k=null,U=null,Ae=null,_e=null,Ve=null,lt=null,kt=null;for(Nt in p){var _t=p[Nt];if(p.hasOwnProperty(Nt)&&_t!=null)switch(Nt){case"checked":break;case"value":break;case"defaultValue":Ve=_t;default:y.hasOwnProperty(Nt)||An(l,c,Nt,null,y,_t)}}for(var gt in y){var Nt=y[gt];if(_t=p[gt],y.hasOwnProperty(gt)&&(Nt!=null||_t!=null))switch(gt){case"type":U=Nt;break;case"name":k=Nt;break;case"checked":lt=Nt;break;case"defaultChecked":kt=Nt;break;case"value":Ae=Nt;break;case"defaultValue":_e=Nt;break;case"children":case"dangerouslySetInnerHTML":if(Nt!=null)throw Error(r(137,c));break;default:Nt!==_t&&An(l,c,gt,Nt,y,_t)}}qo(l,Ae,_e,Ve,lt,kt,U,k);return;case"select":Nt=Ae=_e=gt=null;for(U in p)if(Ve=p[U],p.hasOwnProperty(U)&&Ve!=null)switch(U){case"value":break;case"multiple":Nt=Ve;default:y.hasOwnProperty(U)||An(l,c,U,null,y,Ve)}for(k in y)if(U=y[k],Ve=p[k],y.hasOwnProperty(k)&&(U!=null||Ve!=null))switch(k){case"value":gt=U;break;case"defaultValue":_e=U;break;case"multiple":Ae=U;default:U!==Ve&&An(l,c,k,U,y,Ve)}c=_e,p=Ae,y=Nt,gt!=null?li(l,!!p,gt,!1):!!y!=!!p&&(c!=null?li(l,!!p,c,!0):li(l,!!p,p?[]:"",!1));return;case"textarea":Nt=gt=null;for(_e in p)if(k=p[_e],p.hasOwnProperty(_e)&&k!=null&&!y.hasOwnProperty(_e))switch(_e){case"value":break;case"children":break;default:An(l,c,_e,null,y,k)}for(Ae in y)if(k=y[Ae],U=p[Ae],y.hasOwnProperty(Ae)&&(k!=null||U!=null))switch(Ae){case"value":gt=k;break;case"defaultValue":Nt=k;break;case"children":break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(r(91));break;default:k!==U&&An(l,c,Ae,k,y,U)}Fs(l,gt,Nt);return;case"option":for(var Wr in p)if(gt=p[Wr],p.hasOwnProperty(Wr)&&gt!=null&&!y.hasOwnProperty(Wr))switch(Wr){case"selected":l.selected=!1;break;default:An(l,c,Wr,null,y,gt)}for(Ve in y)if(gt=y[Ve],Nt=p[Ve],y.hasOwnProperty(Ve)&&gt!==Nt&&(gt!=null||Nt!=null))switch(Ve){case"selected":l.selected=gt&&typeof gt!="function"&&typeof gt!="symbol";break;default:An(l,c,Ve,gt,y,Nt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ca in p)gt=p[Ca],p.hasOwnProperty(Ca)&&gt!=null&&!y.hasOwnProperty(Ca)&&An(l,c,Ca,null,y,gt);for(lt in y)if(gt=y[lt],Nt=p[lt],y.hasOwnProperty(lt)&&gt!==Nt&&(gt!=null||Nt!=null))switch(lt){case"children":case"dangerouslySetInnerHTML":if(gt!=null)throw Error(r(137,c));break;default:An(l,c,lt,gt,y,Nt)}return;default:if(HA(c)){for(var kn in p)gt=p[kn],p.hasOwnProperty(kn)&&gt!==void 0&&!y.hasOwnProperty(kn)&&n1(l,c,kn,void 0,y,gt);for(kt in y)gt=y[kt],Nt=p[kt],!y.hasOwnProperty(kt)||gt===Nt||gt===void 0&&Nt===void 0||n1(l,c,kt,gt,y,Nt);return}}for(var it in p)gt=p[it],p.hasOwnProperty(it)&&gt!=null&&!y.hasOwnProperty(it)&&An(l,c,it,null,y,gt);for(_t in y)gt=y[_t],Nt=p[_t],!y.hasOwnProperty(_t)||gt===Nt||gt==null&&Nt==null||An(l,c,_t,gt,y,Nt)}function o1(l){switch(l){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function l1(){if(typeof performance.getEntriesByType=="function"){for(var l=0,c=0,p=performance.getEntriesByType("resource"),y=0;y<p.length;y++){var k=p[y],U=k.transferSize,Ae=k.initiatorType,_e=k.duration;if(U&&_e&&o1(Ae)){for(Ae=0,_e=k.responseEnd,y+=1;y<p.length;y++){var Ve=p[y],lt=Ve.startTime;if(lt>_e)break;var kt=Ve.transferSize,_t=Ve.initiatorType;kt&&o1(_t)&&(Ve=Ve.responseEnd,Ae+=kt*(Ve<_e?1:(_e-lt)/(Ve-lt)))}if(--y,c+=8*(U+Ae)/(k.duration/1e3),l++,10<l)break}}if(0<l)return c/l/1e6}return navigator.connection&&(l=navigator.connection.downlink,typeof l=="number")?l:5}var Hf=null,gm=null;function J0(l){return l.nodeType===9?l:l.ownerDocument}function c1(l){switch(l){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function iA(l,c){if(l===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return l===1&&c==="foreignObject"?0:l}function zf(l,c){return l==="textarea"||l==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Z0=null;function xm(){var l=window.event;return l&&l.type==="popstate"?l===Z0?!1:(Z0=l,!0):(Z0=null,!1)}var bm=typeof setTimeout=="function"?setTimeout:void 0,px=typeof clearTimeout=="function"?clearTimeout:void 0,A1=typeof Promise=="function"?Promise:void 0,ym=typeof queueMicrotask=="function"?queueMicrotask:typeof A1<"u"?function(l){return A1.resolve(null).then(l).catch(gx)}:bm;function gx(l){setTimeout(function(){throw l})}function ud(l){return l==="head"}function vm(l,c){var p=c,y=0;do{var k=p.nextSibling;if(l.removeChild(p),k&&k.nodeType===8)if(p=k.data,p==="/$"||p==="/&"){if(y===0){l.removeChild(k),ea(c);return}y--}else if(p==="$"||p==="$?"||p==="$~"||p==="$!"||p==="&")y++;else if(p==="html")A(l.ownerDocument.documentElement);else if(p==="head"){p=l.ownerDocument.head,A(p);for(var U=p.firstChild;U;){var Ae=U.nextSibling,_e=U.nodeName;U[Fi]||_e==="SCRIPT"||_e==="STYLE"||_e==="LINK"&&U.rel.toLowerCase()==="stylesheet"||p.removeChild(U),U=Ae}}else p==="body"&&A(l.ownerDocument.body);p=k}while(p);ea(c)}function d1(l,c){var p=l;l=0;do{var y=p.nextSibling;if(p.nodeType===1?c?(p._stashedDisplay=p.style.display,p.style.display="none"):(p.style.display=p._stashedDisplay||"",p.getAttribute("style")===""&&p.removeAttribute("style")):p.nodeType===3&&(c?(p._stashedText=p.nodeValue,p.nodeValue=""):p.nodeValue=p._stashedText||""),y&&y.nodeType===8)if(p=y.data,p==="/$"){if(l===0)break;l--}else p!=="$"&&p!=="$?"&&p!=="$~"&&p!=="$!"||l++;p=y}while(p)}function wm(l){var c=l.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var p=c;switch(c=c.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":wm(p),Hl(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}l.removeChild(p)}}function Nm(l,c,p,y){for(;l.nodeType===1;){var k=p;if(l.nodeName.toLowerCase()!==c.toLowerCase()){if(!y&&(l.nodeName!=="INPUT"||l.type!=="hidden"))break}else if(y){if(!l[Fi])switch(c){case"meta":if(!l.hasAttribute("itemprop"))break;return l;case"link":if(U=l.getAttribute("rel"),U==="stylesheet"&&l.hasAttribute("data-precedence"))break;if(U!==k.rel||l.getAttribute("href")!==(k.href==null||k.href===""?null:k.href)||l.getAttribute("crossorigin")!==(k.crossOrigin==null?null:k.crossOrigin)||l.getAttribute("title")!==(k.title==null?null:k.title))break;return l;case"style":if(l.hasAttribute("data-precedence"))break;return l;case"script":if(U=l.getAttribute("src"),(U!==(k.src==null?null:k.src)||l.getAttribute("type")!==(k.type==null?null:k.type)||l.getAttribute("crossorigin")!==(k.crossOrigin==null?null:k.crossOrigin))&&U&&l.hasAttribute("async")&&!l.hasAttribute("itemprop"))break;return l;default:return l}}else if(c==="input"&&l.type==="hidden"){var U=k.name==null?null:""+k.name;if(k.type==="hidden"&&l.getAttribute("name")===U)return l}else return l;if(l=tc(l.nextSibling),l===null)break}return null}function u1(l,c,p){if(c==="")return null;for(;l.nodeType!==3;)if((l.nodeType!==1||l.nodeName!=="INPUT"||l.type!=="hidden")&&!p||(l=tc(l.nextSibling),l===null))return null;return l}function Cm(l,c){for(;l.nodeType!==8;)if((l.nodeType!==1||l.nodeName!=="INPUT"||l.type!=="hidden")&&!c||(l=tc(l.nextSibling),l===null))return null;return l}function jm(l){return l.data==="$?"||l.data==="$~"}function Kf(l){return l.data==="$!"||l.data==="$?"&&l.ownerDocument.readyState!=="loading"}function f1(l,c){var p=l.ownerDocument;if(l.data==="$~")l._reactRetry=c;else if(l.data!=="$?"||p.readyState!=="loading")c();else{var y=function(){c(),p.removeEventListener("DOMContentLoaded",y)};p.addEventListener("DOMContentLoaded",y),l._reactRetry=y}}function tc(l){for(;l!=null;l=l.nextSibling){var c=l.nodeType;if(c===1||c===3)break;if(c===8){if(c=l.data,c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"||c==="F!"||c==="F")break;if(c==="/$"||c==="/&")return null}}return l}var $d=null;function us(l){l=l.nextSibling;for(var c=0;l;){if(l.nodeType===8){var p=l.data;if(p==="/$"||p==="/&"){if(c===0)return tc(l.nextSibling);c--}else p!=="$"&&p!=="$!"&&p!=="$?"&&p!=="$~"&&p!=="&"||c++}l=l.nextSibling}return null}function xx(l){l=l.previousSibling;for(var c=0;l;){if(l.nodeType===8){var p=l.data;if(p==="$"||p==="$!"||p==="$?"||p==="$~"||p==="&"){if(c===0)return l;c--}else p!=="/$"&&p!=="/&"||c++}l=l.previousSibling}return null}function o(l,c,p){switch(c=J0(p),l){case"html":if(l=c.documentElement,!l)throw Error(r(452));return l;case"head":if(l=c.head,!l)throw Error(r(453));return l;case"body":if(l=c.body,!l)throw Error(r(454));return l;default:throw Error(r(451))}}function A(l){for(var c=l.attributes;c.length;)l.removeAttributeNode(c[0]);Hl(l)}var d=new Map,h=new Set;function x(l){return typeof l.getRootNode=="function"?l.getRootNode():l.nodeType===9?l:l.ownerDocument}var w=Ne.d;Ne.d={f:v,r:N,D:I,C:P,L:K,m:W,X:re,S:me,M:De};function v(){var l=w.f(),c=nm();return l||c}function N(l){var c=Do(l);c!==null&&c.tag===5&&c.type==="form"?Ng(c):w.r(l)}var S=typeof document>"u"?null:document;function E(l,c,p){var y=S;if(y&&typeof c=="string"&&c){var k=ma(c);k='link[rel="'+l+'"][href="'+k+'"]',typeof p=="string"&&(k+='[crossorigin="'+p+'"]'),h.has(k)||(h.add(k),l={rel:l,crossOrigin:p,href:c},y.querySelector(k)===null&&(c=y.createElement("link"),yo(c,"link",l),hn(c),y.head.appendChild(c)))}}function I(l){w.D(l),E("dns-prefetch",l,null)}function P(l,c){w.C(l,c),E("preconnect",l,c)}function K(l,c,p){w.L(l,c,p);var y=S;if(y&&l&&c){var k='link[rel="preload"][as="'+ma(c)+'"]';c==="image"&&p&&p.imageSrcSet?(k+='[imagesrcset="'+ma(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(k+='[imagesizes="'+ma(p.imageSizes)+'"]')):k+='[href="'+ma(l)+'"]';var U=k;switch(c){case"style":U=ce(l);break;case"script":U=$e(l)}d.has(U)||(l=j({rel:"preload",href:c==="image"&&p&&p.imageSrcSet?void 0:l,as:c},p),d.set(U,l),y.querySelector(k)!==null||c==="style"&&y.querySelector(Ee(U))||c==="script"&&y.querySelector(st(U))||(c=y.createElement("link"),yo(c,"link",l),hn(c),y.head.appendChild(c)))}}function W(l,c){w.m(l,c);var p=S;if(p&&l){var y=c&&typeof c.as=="string"?c.as:"script",k='link[rel="modulepreload"][as="'+ma(y)+'"][href="'+ma(l)+'"]',U=k;switch(y){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":U=$e(l)}if(!d.has(U)&&(l=j({rel:"modulepreload",href:l},c),d.set(U,l),p.querySelector(k)===null)){switch(y){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(st(U)))return}y=p.createElement("link"),yo(y,"link",l),hn(y),p.head.appendChild(y)}}}function me(l,c,p){w.S(l,c,p);var y=S;if(y&&l){var k=Ln(y).hoistableStyles,U=ce(l);c=c||"default";var Ae=k.get(U);if(!Ae){var _e={loading:0,preload:null};if(Ae=y.querySelector(Ee(U)))_e.loading=5;else{l=j({rel:"stylesheet",href:l,"data-precedence":c},p),(p=d.get(U))&&Mt(l,p);var Ve=Ae=y.createElement("link");hn(Ve),yo(Ve,"link",l),Ve._p=new Promise(function(lt,kt){Ve.onload=lt,Ve.onerror=kt}),Ve.addEventListener("load",function(){_e.loading|=1}),Ve.addEventListener("error",function(){_e.loading|=2}),_e.loading|=4,mt(Ae,c,y)}Ae={type:"stylesheet",instance:Ae,count:1,state:_e},k.set(U,Ae)}}}function re(l,c){w.X(l,c);var p=S;if(p&&l){var y=Ln(p).hoistableScripts,k=$e(l),U=y.get(k);U||(U=p.querySelector(st(k)),U||(l=j({src:l,async:!0},c),(c=d.get(k))&&Qt(l,c),U=p.createElement("script"),hn(U),yo(U,"link",l),p.head.appendChild(U)),U={type:"script",instance:U,count:1,state:null},y.set(k,U))}}function De(l,c){w.M(l,c);var p=S;if(p&&l){var y=Ln(p).hoistableScripts,k=$e(l),U=y.get(k);U||(U=p.querySelector(st(k)),U||(l=j({src:l,async:!0,type:"module"},c),(c=d.get(k))&&Qt(l,c),U=p.createElement("script"),hn(U),yo(U,"link",l),p.head.appendChild(U)),U={type:"script",instance:U,count:1,state:null},y.set(k,U))}}function be(l,c,p,y){var k=(k=ie.current)?x(k):null;if(!k)throw Error(r(446));switch(l){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(c=ce(p.href),p=Ln(k).hoistableStyles,y=p.get(c),y||(y={type:"style",instance:null,count:0,state:null},p.set(c,y)),y):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){l=ce(p.href);var U=Ln(k).hoistableStyles,Ae=U.get(l);if(Ae||(k=k.ownerDocument||k,Ae={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},U.set(l,Ae),(U=k.querySelector(Ee(l)))&&!U._p&&(Ae.instance=U,Ae.state.loading=5),d.has(l)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},d.set(l,p),U||Ie(k,l,p,Ae.state))),c&&y===null)throw Error(r(528,""));return Ae}if(c&&y!==null)throw Error(r(529,""));return null;case"script":return c=p.async,p=p.src,typeof p=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=$e(p),p=Ln(k).hoistableScripts,y=p.get(c),y||(y={type:"script",instance:null,count:0,state:null},p.set(c,y)),y):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,l))}}function ce(l){return'href="'+ma(l)+'"'}function Ee(l){return'link[rel="stylesheet"]['+l+"]"}function Ue(l){return j({},l,{"data-precedence":l.precedence,precedence:null})}function Ie(l,c,p,y){l.querySelector('link[rel="preload"][as="style"]['+c+"]")?y.loading=1:(c=l.createElement("link"),y.preload=c,c.addEventListener("load",function(){return y.loading|=1}),c.addEventListener("error",function(){return y.loading|=2}),yo(c,"link",p),hn(c),l.head.appendChild(c))}function $e(l){return'[src="'+ma(l)+'"]'}function st(l){return"script[async]"+l}function rt(l,c,p){if(c.count++,c.instance===null)switch(c.type){case"style":var y=l.querySelector('style[data-href~="'+ma(p.href)+'"]');if(y)return c.instance=y,hn(y),y;var k=j({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return y=(l.ownerDocument||l).createElement("style"),hn(y),yo(y,"style",k),mt(y,p.precedence,l),c.instance=y;case"stylesheet":k=ce(p.href);var U=l.querySelector(Ee(k));if(U)return c.state.loading|=4,c.instance=U,hn(U),U;y=Ue(p),(k=d.get(k))&&Mt(y,k),U=(l.ownerDocument||l).createElement("link"),hn(U);var Ae=U;return Ae._p=new Promise(function(_e,Ve){Ae.onload=_e,Ae.onerror=Ve}),yo(U,"link",y),c.state.loading|=4,mt(U,p.precedence,l),c.instance=U;case"script":return U=$e(p.src),(k=l.querySelector(st(U)))?(c.instance=k,hn(k),k):(y=p,(k=d.get(U))&&(y=j({},p),Qt(y,k)),l=l.ownerDocument||l,k=l.createElement("script"),hn(k),yo(k,"link",y),l.head.appendChild(k),c.instance=k);case"void":return null;default:throw Error(r(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(y=c.instance,c.state.loading|=4,mt(y,p.precedence,l));return c.instance}function mt(l,c,p){for(var y=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),k=y.length?y[y.length-1]:null,U=k,Ae=0;Ae<y.length;Ae++){var _e=y[Ae];if(_e.dataset.precedence===c)U=_e;else if(U!==k)break}U?U.parentNode.insertBefore(l,U.nextSibling):(c=p.nodeType===9?p.head:p,c.insertBefore(l,c.firstChild))}function Mt(l,c){l.crossOrigin==null&&(l.crossOrigin=c.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=c.referrerPolicy),l.title==null&&(l.title=c.title)}function Qt(l,c){l.crossOrigin==null&&(l.crossOrigin=c.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=c.referrerPolicy),l.integrity==null&&(l.integrity=c.integrity)}var vt=null;function Zt(l,c,p){if(vt===null){var y=new Map,k=vt=new Map;k.set(p,y)}else k=vt,y=k.get(p),y||(y=new Map,k.set(p,y));if(y.has(l))return y;for(y.set(l,null),p=p.getElementsByTagName(l),k=0;k<p.length;k++){var U=p[k];if(!(U[Fi]||U[Is]||l==="link"&&U.getAttribute("rel")==="stylesheet")&&U.namespaceURI!=="http://www.w3.org/2000/svg"){var Ae=U.getAttribute(c)||"";Ae=l+Ae;var _e=y.get(Ae);_e?_e.push(U):y.set(Ae,[U])}}return y}function Br(l,c,p){l=l.ownerDocument||l,l.head.insertBefore(p,c==="title"?l.querySelector("head > title"):null)}function wr(l,c,p){if(p===1||c.itemProp!=null)return!1;switch(l){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return l=c.disabled,typeof c.precedence=="string"&&l==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function cr(l){return!(l.type==="stylesheet"&&(l.state.loading&3)===0)}function ur(l,c,p,y){if(p.type==="stylesheet"&&(typeof y.media!="string"||matchMedia(y.media).matches!==!1)&&(p.state.loading&4)===0){if(p.instance===null){var k=ce(y.href),U=c.querySelector(Ee(k));if(U){c=U._p,c!==null&&typeof c=="object"&&typeof c.then=="function"&&(l.count++,l=kr.bind(l),c.then(l,l)),p.state.loading|=4,p.instance=U,hn(U);return}U=c.ownerDocument||c,y=Ue(y),(k=d.get(k))&&Mt(y,k),U=U.createElement("link"),hn(U);var Ae=U;Ae._p=new Promise(function(_e,Ve){Ae.onload=_e,Ae.onerror=Ve}),yo(U,"link",y),p.instance=U}l.stylesheets===null&&(l.stylesheets=new Map),l.stylesheets.set(p,c),(c=p.state.preload)&&(p.state.loading&3)===0&&(l.count++,p=kr.bind(l),c.addEventListener("load",p),c.addEventListener("error",p))}}var nr=0;function Vt(l,c){return l.stylesheets&&l.count===0&&na(l,l.stylesheets),0<l.count||0<l.imgCount?function(p){var y=setTimeout(function(){if(l.stylesheets&&na(l,l.stylesheets),l.unsuspend){var U=l.unsuspend;l.unsuspend=null,U()}},6e4+c);0<l.imgBytes&&nr===0&&(nr=62500*l1());var k=setTimeout(function(){if(l.waitingForImages=!1,l.count===0&&(l.stylesheets&&na(l,l.stylesheets),l.unsuspend)){var U=l.unsuspend;l.unsuspend=null,U()}},(l.imgBytes>nr?50:800)+c);return l.unsuspend=p,function(){l.unsuspend=null,clearTimeout(y),clearTimeout(k)}}:null}function kr(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)na(this,this.stylesheets);else if(this.unsuspend){var l=this.unsuspend;this.unsuspend=null,l()}}}var Rr=null;function na(l,c){l.stylesheets=null,l.unsuspend!==null&&(l.count++,Rr=new Map,c.forEach(Ga,l),Rr=null,kr.call(l))}function Ga(l,c){if(!(c.state.loading&4)){var p=Rr.get(l);if(p)var y=p.get(null);else{p=new Map,Rr.set(l,p);for(var k=l.querySelectorAll("link[data-precedence],style[data-precedence]"),U=0;U<k.length;U++){var Ae=k[U];(Ae.nodeName==="LINK"||Ae.getAttribute("media")!=="not all")&&(p.set(Ae.dataset.precedence,Ae),y=Ae)}y&&p.set(null,y)}k=c.instance,Ae=k.getAttribute("data-precedence"),U=p.get(Ae)||y,U===y&&p.set(null,k),p.set(Ae,k),this.count++,y=kr.bind(this),k.addEventListener("load",y),k.addEventListener("error",y),U?U.parentNode.insertBefore(k,U.nextSibling):(l=l.nodeType===9?l.head:l,l.insertBefore(k,l.firstChild)),c.state.loading|=4}}var Sr={$$typeof:O,Provider:null,Consumer:null,_currentValue:xe,_currentValue2:xe,_threadCount:0};function er(l,c,p,y,k,U,Ae,_e,Ve){this.tag=1,this.containerInfo=l,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=co(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=co(0),this.hiddenUpdates=co(null),this.identifierPrefix=y,this.onUncaughtError=k,this.onCaughtError=U,this.onRecoverableError=Ae,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Ve,this.incompleteTransitions=new Map}function Na(l,c,p,y,k,U,Ae,_e,Ve,lt,kt,_t){return l=new er(l,c,p,Ae,Ve,lt,kt,_t,_e),c=1,U===!0&&(c|=24),U=Ws(3,null,null,c),l.current=U,U.stateNode=l,c=Jc(),c.refCount++,l.pooledCache=c,c.refCount++,U.memoizedState={element:y,isDehydrated:p,cache:c},xr(U),l}function is(l){return l?(l=Di,l):Di}function Ja(l,c,p,y,k,U){k=is(k),y.context===null?y.context=k:y.pendingContext=k,y=sa(c),y.payload={element:p},U=U===void 0?null:U,U!==null&&(y.callback=U),p=Ia(l,y,c),p!==null&&(ul(p,l,c),ks(p,l,c))}function Ls(l,c){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var p=l.retryLane;l.retryLane=p!==0&&p<c?p:c}}function Zn(l,c){Ls(l,c),(l=l.alternate)&&Ls(l,c)}function Je(l){if(l.tag===13||l.tag===31){var c=Mo(l,67108864);c!==null&&ul(c,l,67108864),Zn(l,67108864)}}function Us(l){if(l.tag===13||l.tag===31){var c=dl();c=en(c);var p=Mo(l,c);p!==null&&ul(p,l,c),Zn(l,c)}}var bs=!0;function eo(l,c,p,y){var k=he.T;he.T=null;var U=Ne.p;try{Ne.p=2,Pe(l,c,p,y)}finally{Ne.p=U,he.T=k}}function kc(l,c,p,y){var k=he.T;he.T=null;var U=Ne.p;try{Ne.p=8,Pe(l,c,p,y)}finally{Ne.p=U,he.T=k}}function Pe(l,c,p,y){if(bs){var k=wt(y);if(k===null)mm(l,c,y,qe,p),yr(l,y);else if(Jr(k,l,c,p,y))y.stopPropagation();else if(yr(l,y),c&4&&-1<Dr.indexOf(l)){for(;k!==null;){var U=Do(k);if(U!==null)switch(U.tag){case 3:if(U=U.stateNode,U.current.memoizedState.isDehydrated){var Ae=Nr(U.pendingLanes);if(Ae!==0){var _e=U;for(_e.pendingLanes|=2,_e.entangledLanes|=2;Ae;){var Ve=1<<31-Gr(Ae);_e.entanglements[1]|=Ve,Ae&=~Ve}bo(U),(Qs&6)===0&&(tm=mr()+500,Qu(0))}}break;case 31:case 13:_e=Mo(U,2),_e!==null&&ul(_e,U,2),nm(),Zn(U,2)}if(U=wt(y),U===null&&mm(l,c,y,qe,p),U===k)break;k=U}k!==null&&y.stopPropagation()}else mm(l,c,y,null,p)}}function wt(l){return l=cs(l),yt(l)}var qe=null;function yt(l){if(qe=null,l=$o(l),l!==null){var c=e(l);if(c===null)l=null;else{var p=c.tag;if(p===13){if(l=u(c),l!==null)return l;l=null}else if(p===31){if(l=f(c),l!==null)return l;l=null}else if(p===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;l=null}else c!==l&&(l=null)}}return qe=l,null}function We(l){switch(l){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ar()){case bt:return 2;case Yt:return 8;case vr:case gr:return 32;case Mr:return 268435456;default:return 32}default:return 32}}var Wt=!1,pt=null,Bt=null,dt=null,Tt=new Map,tr=new Map,_r=[],Dr="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function yr(l,c){switch(l){case"focusin":case"focusout":pt=null;break;case"dragenter":case"dragleave":Bt=null;break;case"mouseover":case"mouseout":dt=null;break;case"pointerover":case"pointerout":Tt.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":tr.delete(c.pointerId)}}function Lr(l,c,p,y,k,U){return l===null||l.nativeEvent!==U?(l={blockedOn:c,domEventName:p,eventSystemFlags:y,nativeEvent:U,targetContainers:[k]},c!==null&&(c=Do(c),c!==null&&Je(c)),l):(l.eventSystemFlags|=y,c=l.targetContainers,k!==null&&c.indexOf(k)===-1&&c.push(k),l)}function Jr(l,c,p,y,k){switch(c){case"focusin":return pt=Lr(pt,l,c,p,y,k),!0;case"dragenter":return Bt=Lr(Bt,l,c,p,y,k),!0;case"mouseover":return dt=Lr(dt,l,c,p,y,k),!0;case"pointerover":var U=k.pointerId;return Tt.set(U,Lr(Tt.get(U)||null,l,c,p,y,k)),!0;case"gotpointercapture":return U=k.pointerId,tr.set(U,Lr(tr.get(U)||null,l,c,p,y,k)),!0}return!1}function qr(l){var c=$o(l.target);if(c!==null){var p=e(c);if(p!==null){if(c=p.tag,c===13){if(c=u(p),c!==null){l.blockedOn=c,Yo(l.priority,function(){Us(p)});return}}else if(c===31){if(c=f(p),c!==null){l.blockedOn=c,Yo(l.priority,function(){Us(p)});return}}else if(c===3&&p.stateNode.current.memoizedState.isDehydrated){l.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}l.blockedOn=null}function fr(l){if(l.blockedOn!==null)return!1;for(var c=l.targetContainers;0<c.length;){var p=wt(l.nativeEvent);if(p===null){p=l.nativeEvent;var y=new p.constructor(p.type,p);yl=y,p.target.dispatchEvent(y),yl=null}else return c=Do(p),c!==null&&Je(c),l.blockedOn=p,!1;c.shift()}return!0}function sr(l,c,p){fr(l)&&p.delete(c)}function Zr(){Wt=!1,pt!==null&&fr(pt)&&(pt=null),Bt!==null&&fr(Bt)&&(Bt=null),dt!==null&&fr(dt)&&(dt=null),Tt.forEach(sr),tr.forEach(sr)}function Fr(l,c){l.blockedOn===c&&(l.blockedOn=null,Wt||(Wt=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Zr)))}var ir=null;function ca(l){ir!==l&&(ir=l,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){ir===l&&(ir=null);for(var c=0;c<l.length;c+=3){var p=l[c],y=l[c+1],k=l[c+2];if(typeof y!="function"){if(yt(y||p)===null)continue;break}var U=Do(p);U!==null&&(l.splice(c,3),c-=3,Np(U,{pending:!0,data:k,method:p.method,action:y},y,k))}}))}function ea(l){function c(Ve){return Fr(Ve,l)}pt!==null&&Fr(pt,l),Bt!==null&&Fr(Bt,l),dt!==null&&Fr(dt,l),Tt.forEach(c),tr.forEach(c);for(var p=0;p<_r.length;p++){var y=_r[p];y.blockedOn===l&&(y.blockedOn=null)}for(;0<_r.length&&(p=_r[0],p.blockedOn===null);)qr(p),p.blockedOn===null&&_r.shift();if(p=(l.ownerDocument||l).$$reactFormReplay,p!=null)for(y=0;y<p.length;y+=3){var k=p[y],U=p[y+1],Ae=k[ba]||null;if(typeof U=="function")Ae||ca(p);else if(Ae){var _e=null;if(U&&U.hasAttribute("formAction")){if(k=U,Ae=U[ba]||null)_e=Ae.formAction;else if(yt(k)!==null)continue}else _e=Ae.action;typeof _e=="function"?p[y+1]=_e:(p.splice(y,3),y-=3),ca(p)}}}function dn(){function l(U){U.canIntercept&&U.info==="react-transition"&&U.intercept({handler:function(){return new Promise(function(Ae){return k=Ae})},focusReset:"manual",scroll:"manual"})}function c(){k!==null&&(k(),k=null),y||setTimeout(p,20)}function p(){if(!y&&!navigation.transition){var U=navigation.currentEntry;U&&U.url!=null&&navigation.navigate(U.url,{state:U.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var y=!1,k=null;return navigation.addEventListener("navigate",l),navigation.addEventListener("navigatesuccess",c),navigation.addEventListener("navigateerror",c),setTimeout(p,100),function(){y=!0,navigation.removeEventListener("navigate",l),navigation.removeEventListener("navigatesuccess",c),navigation.removeEventListener("navigateerror",c),k!==null&&(k(),k=null)}}}function pa(l){this._internalRoot=l}_a.prototype.render=pa.prototype.render=function(l){var c=this._internalRoot;if(c===null)throw Error(r(409));var p=c.current,y=dl();Ja(p,y,l,c,null,null)},_a.prototype.unmount=pa.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var c=l.containerInfo;Ja(l.current,2,null,l,null,null),nm(),c[Cn]=null}};function _a(l){this._internalRoot=l}_a.prototype.unstable_scheduleHydration=function(l){if(l){var c=_n();l={blockedOn:null,target:l,priority:c};for(var p=0;p<_r.length&&c!==0&&c<_r[p].priority;p++);_r.splice(p,0,l),p===0&&qr(l)}};var Yr=a.version;if(Yr!=="19.2.0")throw Error(r(527,Yr,"19.2.0"));Ne.findDOMNode=function(l){var c=l._reactInternals;if(c===void 0)throw typeof l.render=="function"?Error(r(188)):(l=Object.keys(l).join(","),Error(r(268,l)));return l=g(c),l=l!==null?b(l):null,l=l===null?null:l.stateNode,l};var as={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:he,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wa.isDisabled&&Wa.supportsFiber)try{oa=Wa.inject(as),hr=Wa}catch{}}return m1.createRoot=function(l,c){if(!s(l))throw Error(r(299));var p=!1,y="",k=Qh,U=Lg,Ae=Ug;return c!=null&&(c.unstable_strictMode===!0&&(p=!0),c.identifierPrefix!==void 0&&(y=c.identifierPrefix),c.onUncaughtError!==void 0&&(k=c.onUncaughtError),c.onCaughtError!==void 0&&(U=c.onCaughtError),c.onRecoverableError!==void 0&&(Ae=c.onRecoverableError)),c=Na(l,1,!1,null,null,p,y,null,k,U,Ae,dn),l[Cn]=c.current,r1(l),new pa(c)},m1.hydrateRoot=function(l,c,p){if(!s(l))throw Error(r(299));var y=!1,k="",U=Qh,Ae=Lg,_e=Ug,Ve=null;return p!=null&&(p.unstable_strictMode===!0&&(y=!0),p.identifierPrefix!==void 0&&(k=p.identifierPrefix),p.onUncaughtError!==void 0&&(U=p.onUncaughtError),p.onCaughtError!==void 0&&(Ae=p.onCaughtError),p.onRecoverableError!==void 0&&(_e=p.onRecoverableError),p.formState!==void 0&&(Ve=p.formState)),c=Na(l,1,!0,c,p??null,y,k,Ve,U,Ae,_e,dn),c.context=is(null),p=c.current,y=dl(),y=en(y),k=sa(y),k.callback=null,Ia(p,k,y),p=y,c.current.lanes=p,ra(c,p),bo(c),l[Cn]=c.current,r1(l),new _a(c)},m1.version="19.2.0",m1}var X5;function hS(){if(X5)return py.exports;X5=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(a){console.error(a)}}return n(),py.exports=fS(),py.exports}var mS=hS(),yy={exports:{}},vy={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J5;function pS(){if(J5)return vy;J5=1;var n=jb();function a(m,g){return m===g&&(m!==0||1/m===1/g)||m!==m&&g!==g}var t=typeof Object.is=="function"?Object.is:a,r=n.useSyncExternalStore,s=n.useRef,e=n.useEffect,u=n.useMemo,f=n.useDebugValue;return vy.useSyncExternalStoreWithSelector=function(m,g,b,j,F){var C=s(null);if(C.current===null){var M={hasValue:!1,value:null};C.current=M}else M=C.current;C=u(function(){function L(Z){if(!T){if(T=!0,H=Z,Z=j(Z),F!==void 0&&M.hasValue){var ee=M.value;if(F(ee,Z))return O=ee}return O=Z}if(ee=O,t(H,Z))return ee;var se=j(Z);return F!==void 0&&F(ee,se)?(H=Z,ee):(H=Z,O=se)}var T=!1,H,O,Q=b===void 0?null:b;return[function(){return L(g())},Q===null?void 0:function(){return L(Q())}]},[g,b,j,F]);var _=r(m,C[0],C[1]);return e(function(){M.hasValue=!0,M.value=_},[_]),f(_),_},vy}var Z5;function gS(){return Z5||(Z5=1,yy.exports=pS()),yy.exports}var xS=gS();function bS(n){n()}function yS(){let n=null,a=null;return{clear(){n=null,a=null},notify(){bS(()=>{let t=n;for(;t;)t.callback(),t=t.next})},get(){const t=[];let r=n;for(;r;)t.push(r),r=r.next;return t},subscribe(t){let r=!0;const s=a={callback:t,next:null,prev:a};return s.prev?s.prev.next=s:n=s,function(){!r||n===null||(r=!1,s.next?s.next.prev=s.prev:a=s.prev,s.prev?s.prev.next=s.next:n=s.next)}}}}var e4={notify(){},get:()=>[]};function vS(n,a){let t,r=e4,s=0,e=!1;function u(_){b();const L=r.subscribe(_);let T=!1;return()=>{T||(T=!0,L(),j())}}function f(){r.notify()}function m(){M.onStateChange&&M.onStateChange()}function g(){return e}function b(){s++,t||(t=n.subscribe(m),r=yS())}function j(){s--,t&&s===0&&(t(),t=void 0,r.clear(),r=e4)}function F(){e||(e=!0,b())}function C(){e&&(e=!1,j())}const M={addNestedSub:u,notifyNestedSubs:f,handleChangeWrapper:m,isSubscribed:g,trySubscribe:F,tryUnsubscribe:C,getListeners:()=>r};return M}var wS=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",NS=wS(),CS=()=>typeof navigator<"u"&&navigator.product==="ReactNative",jS=CS(),BS=()=>NS||jS?ne.useLayoutEffect:ne.useEffect,SS=BS(),FS=Symbol.for("react-redux-context"),ES=typeof globalThis<"u"?globalThis:{};function kS(){if(!ne.createContext)return{};const n=ES[FS]??=new Map;let a=n.get(ne.createContext);return a||(a=ne.createContext(null),n.set(ne.createContext,a)),a}var d0=kS();function DS(n){const{children:a,context:t,serverState:r,store:s}=n,e=ne.useMemo(()=>{const m=vS(s);return{store:s,subscription:m,getServerState:r?()=>r:void 0}},[s,r]),u=ne.useMemo(()=>s.getState(),[s]);SS(()=>{const{subscription:m}=e;return m.onStateChange=m.notifyNestedSubs,m.trySubscribe(),u!==s.getState()&&m.notifyNestedSubs(),()=>{m.tryUnsubscribe(),m.onStateChange=void 0}},[e,u]);const f=t||d0;return ne.createElement(f.Provider,{value:e},a)}var TS=DS;function qw(n=d0){return function(){return ne.useContext(n)}}var KN=qw();function GN(n=d0){const a=n===d0?KN:qw(n),t=()=>{const{store:r}=a();return r};return Object.assign(t,{withTypes:()=>t}),t}var _S=GN();function LS(n=d0){const a=n===d0?_S:GN(n),t=()=>a().dispatch;return Object.assign(t,{withTypes:()=>t}),t}var Pn=LS(),US=(n,a)=>n===a;function MS(n=d0){const a=n===d0?KN:qw(n),t=(r,s={})=>{const{equalityFn:e=US}=typeof s=="function"?{equalityFn:s}:s,u=a(),{store:f,subscription:m,getServerState:g}=u;ne.useRef(!0);const b=ne.useCallback({[r.name](F){return r(F)}}[r.name],[r]),j=xS.useSyncExternalStoreWithSelector(m.addNestedSub,f.getState,g||f.getState,b,e);return ne.useDebugValue(j),j};return Object.assign(t,{withTypes:()=>t}),t}var rr=MS();function hl(n){return`Minified Redux error #${n}; visit https://redux.js.org/Errors?code=${n} for the full message or use the non-minified dev environment for full errors. `}var IS=typeof Symbol=="function"&&Symbol.observable||"@@observable",t4=IS,wy=()=>Math.random().toString(36).substring(7).split("").join("."),OS={INIT:`@@redux/INIT${wy()}`,REPLACE:`@@redux/REPLACE${wy()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${wy()}`},Q2=OS;function Xw(n){if(typeof n!="object"||n===null)return!1;let a=n;for(;Object.getPrototypeOf(a)!==null;)a=Object.getPrototypeOf(a);return Object.getPrototypeOf(n)===a||Object.getPrototypeOf(n)===null}function VN(n,a,t){if(typeof n!="function")throw new Error(hl(2));if(typeof a=="function"&&typeof t=="function"||typeof t=="function"&&typeof arguments[3]=="function")throw new Error(hl(0));if(typeof a=="function"&&typeof t>"u"&&(t=a,a=void 0),typeof t<"u"){if(typeof t!="function")throw new Error(hl(1));return t(VN)(n,a)}let r=n,s=a,e=new Map,u=e,f=0,m=!1;function g(){u===e&&(u=new Map,e.forEach((L,T)=>{u.set(T,L)}))}function b(){if(m)throw new Error(hl(3));return s}function j(L){if(typeof L!="function")throw new Error(hl(4));if(m)throw new Error(hl(5));let T=!0;g();const H=f++;return u.set(H,L),function(){if(T){if(m)throw new Error(hl(6));T=!1,g(),u.delete(H),e=null}}}function F(L){if(!Xw(L))throw new Error(hl(7));if(typeof L.type>"u")throw new Error(hl(8));if(typeof L.type!="string")throw new Error(hl(17));if(m)throw new Error(hl(9));try{m=!0,s=r(s,L)}finally{m=!1}return(e=u).forEach(H=>{H()}),L}function C(L){if(typeof L!="function")throw new Error(hl(10));r=L,F({type:Q2.REPLACE})}function M(){const L=j;return{subscribe(T){if(typeof T!="object"||T===null)throw new Error(hl(11));function H(){const Q=T;Q.next&&Q.next(b())}return H(),{unsubscribe:L(H)}},[t4](){return this}}}return F({type:Q2.INIT}),{dispatch:F,subscribe:j,getState:b,replaceReducer:C,[t4]:M}}function QS(n){Object.keys(n).forEach(a=>{const t=n[a];if(typeof t(void 0,{type:Q2.INIT})>"u")throw new Error(hl(12));if(typeof t(void 0,{type:Q2.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(hl(13))})}function RS(n){const a=Object.keys(n),t={};for(let e=0;e<a.length;e++){const u=a[e];typeof n[u]=="function"&&(t[u]=n[u])}const r=Object.keys(t);let s;try{QS(t)}catch(e){s=e}return function(u={},f){if(s)throw s;let m=!1;const g={};for(let b=0;b<r.length;b++){const j=r[b],F=t[j],C=u[j],M=F(C,f);if(typeof M>"u")throw f&&f.type,new Error(hl(14));g[j]=M,m=m||M!==C}return m=m||r.length!==Object.keys(u).length,m?g:u}}function R2(...n){return n.length===0?a=>a:n.length===1?n[0]:n.reduce((a,t)=>(...r)=>a(t(...r)))}function PS(...n){return a=>(t,r)=>{const s=a(t,r);let e=()=>{throw new Error(hl(15))};const u={getState:s.getState,dispatch:(m,...g)=>e(m,...g)},f=n.map(m=>m(u));return e=R2(...f)(s.dispatch),{...s,dispatch:e}}}function HS(n){return Xw(n)&&"type"in n&&typeof n.type=="string"}var YN=Symbol.for("immer-nothing"),r4=Symbol.for("immer-draftable"),uA=Symbol.for("immer-state");function pd(n,...a){throw new Error(`[Immer] minified error nr: ${n}. Full error at: https://bit.ly/3cXEKWf`)}var Zm=Object.getPrototypeOf;function bh(n){return!!n&&!!n[uA]}function af(n){return n?WN(n)||Array.isArray(n)||!!n[r4]||!!n.constructor?.[r4]||dg(n)||Sb(n):!1}var zS=Object.prototype.constructor.toString();function WN(n){if(!n||typeof n!="object")return!1;const a=Zm(n);if(a===null)return!0;const t=Object.hasOwnProperty.call(a,"constructor")&&a.constructor;return t===Object?!0:typeof t=="function"&&Function.toString.call(t)===zS}function P2(n,a){Bb(n)===0?Reflect.ownKeys(n).forEach(t=>{a(t,n[t],n)}):n.forEach((t,r)=>a(r,t,n))}function Bb(n){const a=n[uA];return a?a.type_:Array.isArray(n)?1:dg(n)?2:Sb(n)?3:0}function Rv(n,a){return Bb(n)===2?n.has(a):Object.prototype.hasOwnProperty.call(n,a)}function $N(n,a,t){const r=Bb(n);r===2?n.set(a,t):r===3?n.add(t):n[a]=t}function KS(n,a){return n===a?n!==0||1/n===1/a:n!==n&&a!==a}function dg(n){return n instanceof Map}function Sb(n){return n instanceof Set}function th(n){return n.copy_||n.base_}function Pv(n,a){if(dg(n))return new Map(n);if(Sb(n))return new Set(n);if(Array.isArray(n))return Array.prototype.slice.call(n);const t=WN(n);if(a===!0||a==="class_only"&&!t){const r=Object.getOwnPropertyDescriptors(n);delete r[uA];let s=Reflect.ownKeys(r);for(let e=0;e<s.length;e++){const u=s[e],f=r[u];f.writable===!1&&(f.writable=!0,f.configurable=!0),(f.get||f.set)&&(r[u]={configurable:!0,writable:!0,enumerable:f.enumerable,value:n[u]})}return Object.create(Zm(n),r)}else{const r=Zm(n);if(r!==null&&t)return{...n};const s=Object.create(r);return Object.assign(s,n)}}function Jw(n,a=!1){return Fb(n)||bh(n)||!af(n)||(Bb(n)>1&&Object.defineProperties(n,{set:{value:bx},add:{value:bx},clear:{value:bx},delete:{value:bx}}),Object.freeze(n),a&&Object.values(n).forEach(t=>Jw(t,!0))),n}function bx(){pd(2)}function Fb(n){return Object.isFrozen(n)}var GS={};function yh(n){const a=GS[n];return a||pd(0,n),a}var q1;function qN(){return q1}function VS(n,a){return{drafts_:[],parent_:n,immer_:a,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function a4(n,a){a&&(yh("Patches"),n.patches_=[],n.inversePatches_=[],n.patchListener_=a)}function Hv(n){zv(n),n.drafts_.forEach(YS),n.drafts_=null}function zv(n){n===q1&&(q1=n.parent_)}function s4(n){return q1=VS(q1,n)}function YS(n){const a=n[uA];a.type_===0||a.type_===1?a.revoke_():a.revoked_=!0}function n4(n,a){a.unfinalizedDrafts_=a.drafts_.length;const t=a.drafts_[0];return n!==void 0&&n!==t?(t[uA].modified_&&(Hv(a),pd(4)),af(n)&&(n=H2(a,n),a.parent_||z2(a,n)),a.patches_&&yh("Patches").generateReplacementPatches_(t[uA].base_,n,a.patches_,a.inversePatches_)):n=H2(a,t,[]),Hv(a),a.patches_&&a.patchListener_(a.patches_,a.inversePatches_),n!==YN?n:void 0}function H2(n,a,t){if(Fb(a))return a;const r=a[uA];if(!r)return P2(a,(s,e)=>i4(n,r,a,s,e,t)),a;if(r.scope_!==n)return a;if(!r.modified_)return z2(n,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let e=s,u=!1;r.type_===3&&(e=new Set(s),s.clear(),u=!0),P2(e,(f,m)=>i4(n,r,s,f,m,t,u)),z2(n,s,!1),t&&n.patches_&&yh("Patches").generatePatches_(r,t,n.patches_,n.inversePatches_)}return r.copy_}function i4(n,a,t,r,s,e,u){if(bh(s)){const f=e&&a&&a.type_!==3&&!Rv(a.assigned_,r)?e.concat(r):void 0,m=H2(n,s,f);if($N(t,r,m),bh(m))n.canAutoFreeze_=!1;else return}else u&&t.add(s);if(af(s)&&!Fb(s)){if(!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1)return;H2(n,s),(!a||!a.scope_.parent_)&&typeof r!="symbol"&&(dg(t)?t.has(r):Object.prototype.propertyIsEnumerable.call(t,r))&&z2(n,s)}}function z2(n,a,t=!1){!n.parent_&&n.immer_.autoFreeze_&&n.canAutoFreeze_&&Jw(a,t)}function WS(n,a){const t=Array.isArray(n),r={type_:t?1:0,scope_:a?a.scope_:qN(),modified_:!1,finalized_:!1,assigned_:{},parent_:a,base_:n,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=r,e=Zw;t&&(s=[r],e=X1);const{revoke:u,proxy:f}=Proxy.revocable(s,e);return r.draft_=f,r.revoke_=u,f}var Zw={get(n,a){if(a===uA)return n;const t=th(n);if(!Rv(t,a))return $S(n,t,a);const r=t[a];return n.finalized_||!af(r)?r:r===Ny(n.base_,a)?(Cy(n),n.copy_[a]=Gv(r,n)):r},has(n,a){return a in th(n)},ownKeys(n){return Reflect.ownKeys(th(n))},set(n,a,t){const r=XN(th(n),a);if(r?.set)return r.set.call(n.draft_,t),!0;if(!n.modified_){const s=Ny(th(n),a),e=s?.[uA];if(e&&e.base_===t)return n.copy_[a]=t,n.assigned_[a]=!1,!0;if(KS(t,s)&&(t!==void 0||Rv(n.base_,a)))return!0;Cy(n),Kv(n)}return n.copy_[a]===t&&(t!==void 0||a in n.copy_)||Number.isNaN(t)&&Number.isNaN(n.copy_[a])||(n.copy_[a]=t,n.assigned_[a]=!0),!0},deleteProperty(n,a){return Ny(n.base_,a)!==void 0||a in n.base_?(n.assigned_[a]=!1,Cy(n),Kv(n)):delete n.assigned_[a],n.copy_&&delete n.copy_[a],!0},getOwnPropertyDescriptor(n,a){const t=th(n),r=Reflect.getOwnPropertyDescriptor(t,a);return r&&{writable:!0,configurable:n.type_!==1||a!=="length",enumerable:r.enumerable,value:t[a]}},defineProperty(){pd(11)},getPrototypeOf(n){return Zm(n.base_)},setPrototypeOf(){pd(12)}},X1={};P2(Zw,(n,a)=>{X1[n]=function(){return arguments[0]=arguments[0][0],a.apply(this,arguments)}});X1.deleteProperty=function(n,a){return X1.set.call(this,n,a,void 0)};X1.set=function(n,a,t){return Zw.set.call(this,n[0],a,t,n[0])};function Ny(n,a){const t=n[uA];return(t?th(t):n)[a]}function $S(n,a,t){const r=XN(a,t);return r?"value"in r?r.value:r.get?.call(n.draft_):void 0}function XN(n,a){if(!(a in n))return;let t=Zm(n);for(;t;){const r=Object.getOwnPropertyDescriptor(t,a);if(r)return r;t=Zm(t)}}function Kv(n){n.modified_||(n.modified_=!0,n.parent_&&Kv(n.parent_))}function Cy(n){n.copy_||(n.copy_=Pv(n.base_,n.scope_.immer_.useStrictShallowCopy_))}var qS=class{constructor(n){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(a,t,r)=>{if(typeof a=="function"&&typeof t!="function"){const e=t;t=a;const u=this;return function(m=e,...g){return u.produce(m,b=>t.call(this,b,...g))}}typeof t!="function"&&pd(6),r!==void 0&&typeof r!="function"&&pd(7);let s;if(af(a)){const e=s4(this),u=Gv(a,void 0);let f=!0;try{s=t(u),f=!1}finally{f?Hv(e):zv(e)}return a4(e,r),n4(s,e)}else if(!a||typeof a!="object"){if(s=t(a),s===void 0&&(s=a),s===YN&&(s=void 0),this.autoFreeze_&&Jw(s,!0),r){const e=[],u=[];yh("Patches").generateReplacementPatches_(a,s,e,u),r(e,u)}return s}else pd(1,a)},this.produceWithPatches=(a,t)=>{if(typeof a=="function")return(u,...f)=>this.produceWithPatches(u,m=>a(m,...f));let r,s;return[this.produce(a,t,(u,f)=>{r=u,s=f}),r,s]},typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze),typeof n?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(n.useStrictShallowCopy)}createDraft(n){af(n)||pd(8),bh(n)&&(n=XS(n));const a=s4(this),t=Gv(n,void 0);return t[uA].isManual_=!0,zv(a),t}finishDraft(n,a){const t=n&&n[uA];(!t||!t.isManual_)&&pd(9);const{scope_:r}=t;return a4(r,a),n4(void 0,r)}setAutoFreeze(n){this.autoFreeze_=n}setUseStrictShallowCopy(n){this.useStrictShallowCopy_=n}applyPatches(n,a){let t;for(t=a.length-1;t>=0;t--){const s=a[t];if(s.path.length===0&&s.op==="replace"){n=s.value;break}}t>-1&&(a=a.slice(t+1));const r=yh("Patches").applyPatches_;return bh(n)?r(n,a):this.produce(n,s=>r(s,a))}};function Gv(n,a){const t=dg(n)?yh("MapSet").proxyMap_(n,a):Sb(n)?yh("MapSet").proxySet_(n,a):WS(n,a);return(a?a.scope_:qN()).drafts_.push(t),t}function XS(n){return bh(n)||pd(10,n),JN(n)}function JN(n){if(!af(n)||Fb(n))return n;const a=n[uA];let t;if(a){if(!a.modified_)return a.base_;a.finalized_=!0,t=Pv(n,a.scope_.immer_.useStrictShallowCopy_)}else t=Pv(n,!0);return P2(t,(r,s)=>{$N(t,r,JN(s))}),a&&(a.finalized_=!1),t}var JS=new qS,ZN=JS.produce;function ZS(n,a=`expected a function, instead received ${typeof n}`){if(typeof n!="function")throw new TypeError(a)}function eF(n,a=`expected an object, instead received ${typeof n}`){if(typeof n!="object")throw new TypeError(a)}function tF(n,a="expected all items to be functions, instead received the following types: "){if(!n.every(t=>typeof t=="function")){const t=n.map(r=>typeof r=="function"?`function ${r.name||"unnamed"}()`:typeof r).join(", ");throw new TypeError(`${a}[${t}]`)}}var o4=n=>Array.isArray(n)?n:[n];function rF(n){const a=Array.isArray(n[0])?n[0]:n;return tF(a,"createSelector expects all input-selectors to be functions, but received the following types: "),a}function aF(n,a){const t=[],{length:r}=n;for(let s=0;s<r;s++)t.push(n[s].apply(null,a));return t}var sF=class{constructor(n){this.value=n}deref(){return this.value}},nF=typeof WeakRef<"u"?WeakRef:sF,iF=0,l4=1;function yx(){return{s:iF,v:void 0,o:null,p:null}}function eC(n,a={}){let t=yx();const{resultEqualityCheck:r}=a;let s,e=0;function u(){let f=t;const{length:m}=arguments;for(let j=0,F=m;j<F;j++){const C=arguments[j];if(typeof C=="function"||typeof C=="object"&&C!==null){let M=f.o;M===null&&(f.o=M=new WeakMap);const _=M.get(C);_===void 0?(f=yx(),M.set(C,f)):f=_}else{let M=f.p;M===null&&(f.p=M=new Map);const _=M.get(C);_===void 0?(f=yx(),M.set(C,f)):f=_}}const g=f;let b;if(f.s===l4)b=f.v;else if(b=n.apply(null,arguments),e++,r){const j=s?.deref?.()??s;j!=null&&r(j,b)&&(b=j,e!==0&&e--),s=typeof b=="object"&&b!==null||typeof b=="function"?new nF(b):b}return g.s=l4,g.v=b,b}return u.clearCache=()=>{t=yx(),u.resetResultsCount()},u.resultsCount=()=>e,u.resetResultsCount=()=>{e=0},u}function oF(n,...a){const t=typeof n=="function"?{memoize:n,memoizeOptions:a}:n,r=(...s)=>{let e=0,u=0,f,m={},g=s.pop();typeof g=="object"&&(m=g,g=s.pop()),ZS(g,`createSelector expects an output function after the inputs, but received: [${typeof g}]`);const b={...t,...m},{memoize:j,memoizeOptions:F=[],argsMemoize:C=eC,argsMemoizeOptions:M=[]}=b,_=o4(F),L=o4(M),T=rF(s),H=j(function(){return e++,g.apply(null,arguments)},..._),O=C(function(){u++;const Z=aF(T,arguments);return f=H.apply(null,Z),f},...L);return Object.assign(O,{resultFunc:g,memoizedResultFunc:H,dependencies:T,dependencyRecomputations:()=>u,resetDependencyRecomputations:()=>{u=0},lastResult:()=>f,recomputations:()=>e,resetRecomputations:()=>{e=0},memoize:j,argsMemoize:C})};return Object.assign(r,{withTypes:()=>r}),r}var PA=oF(eC),lF=Object.assign((n,a=PA)=>{eF(n,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof n}`);const t=Object.keys(n),r=t.map(e=>n[e]);return a(r,(...e)=>e.reduce((u,f,m)=>(u[t[m]]=f,u),{}))},{withTypes:()=>lF});function tC(n){return({dispatch:t,getState:r})=>s=>e=>typeof e=="function"?e(t,r,n):s(e)}var cF=tC(),AF=tC,dF=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?R2:R2.apply(null,arguments)},uF=n=>n&&typeof n.match=="function";function I1(n,a){function t(...r){if(a){let s=a(...r);if(!s)throw new Error($u(0));return{type:n,payload:s.payload,..."meta"in s&&{meta:s.meta},..."error"in s&&{error:s.error}}}return{type:n,payload:r[0]}}return t.toString=()=>`${n}`,t.type=n,t.match=r=>HS(r)&&r.type===n,t}var rC=class F1 extends Array{constructor(...a){super(...a),Object.setPrototypeOf(this,F1.prototype)}static get[Symbol.species](){return F1}concat(...a){return super.concat.apply(this,a)}prepend(...a){return a.length===1&&Array.isArray(a[0])?new F1(...a[0].concat(this)):new F1(...a.concat(this))}};function c4(n){return af(n)?ZN(n,()=>{}):n}function vx(n,a,t){return n.has(a)?n.get(a):n.set(a,t(a)).get(a)}function fF(n){return typeof n=="boolean"}var hF=()=>function(a){const{thunk:t=!0,immutableCheck:r=!0,serializableCheck:s=!0,actionCreatorCheck:e=!0}=a??{};let u=new rC;return t&&(fF(t)?u.push(cF):u.push(AF(t.extraArgument))),u},mF="RTK_autoBatch",A4=n=>a=>{setTimeout(a,n)},pF=(n={type:"raf"})=>a=>(...t)=>{const r=a(...t);let s=!0,e=!1,u=!1;const f=new Set,m=n.type==="tick"?queueMicrotask:n.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:A4(10):n.type==="callback"?n.queueNotification:A4(n.timeout),g=()=>{u=!1,e&&(e=!1,f.forEach(b=>b()))};return Object.assign({},r,{subscribe(b){const j=()=>s&&b(),F=r.subscribe(j);return f.add(b),()=>{F(),f.delete(b)}},dispatch(b){try{return s=!b?.meta?.[mF],e=!s,e&&(u||(u=!0,m(g))),r.dispatch(b)}finally{s=!0}}})},gF=n=>function(t){const{autoBatch:r=!0}=t??{};let s=new rC(n);return r&&s.push(pF(typeof r=="object"?r:void 0)),s};function xF(n){const a=hF(),{reducer:t=void 0,middleware:r,devTools:s=!0,preloadedState:e=void 0,enhancers:u=void 0}=n||{};let f;if(typeof t=="function")f=t;else if(Xw(t))f=RS(t);else throw new Error($u(1));let m;typeof r=="function"?m=r(a):m=a();let g=R2;s&&(g=dF({trace:!1,...typeof s=="object"&&s}));const b=PS(...m),j=gF(b);let F=typeof u=="function"?u(j):j();const C=g(...F);return VN(f,e,C)}function aC(n){const a={},t=[];let r;const s={addCase(e,u){const f=typeof e=="string"?e:e.type;if(!f)throw new Error($u(28));if(f in a)throw new Error($u(29));return a[f]=u,s},addAsyncThunk(e,u){return u.pending&&(a[e.pending.type]=u.pending),u.rejected&&(a[e.rejected.type]=u.rejected),u.fulfilled&&(a[e.fulfilled.type]=u.fulfilled),u.settled&&t.push({matcher:e.settled,reducer:u.settled}),s},addMatcher(e,u){return t.push({matcher:e,reducer:u}),s},addDefaultCase(e){return r=e,s}};return n(s),[a,t,r]}function bF(n){return typeof n=="function"}function yF(n,a){let[t,r,s]=aC(a),e;if(bF(n))e=()=>c4(n());else{const f=c4(n);e=()=>f}function u(f=e(),m){let g=[t[m.type],...r.filter(({matcher:b})=>b(m)).map(({reducer:b})=>b)];return g.filter(b=>!!b).length===0&&(g=[s]),g.reduce((b,j)=>{if(j)if(bh(b)){const C=j(b,m);return C===void 0?b:C}else{if(af(b))return ZN(b,F=>j(F,m));{const F=j(b,m);if(F===void 0){if(b===null)return b;throw Error("A case reducer on a non-draftable value must not return undefined")}return F}}return b},f)}return u.getInitialState=e,u}var vF=(n,a)=>uF(n)?n.match(a):n(a);function wF(...n){return a=>n.some(t=>vF(t,a))}var NF="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",CF=(n=21)=>{let a="",t=n;for(;t--;)a+=NF[Math.random()*64|0];return a},jF=["name","message","stack","code"],jy=class{constructor(n,a){this.payload=n,this.meta=a}_type},d4=class{constructor(n,a){this.payload=n,this.meta=a}_type},BF=n=>{if(typeof n=="object"&&n!==null){const a={};for(const t of jF)typeof n[t]=="string"&&(a[t]=n[t]);return a}return{message:String(n)}},u4="External signal was aborted",Ss=(()=>{function n(a,t,r){const s=I1(a+"/fulfilled",(m,g,b,j)=>({payload:m,meta:{...j||{},arg:b,requestId:g,requestStatus:"fulfilled"}})),e=I1(a+"/pending",(m,g,b)=>({payload:void 0,meta:{...b||{},arg:g,requestId:m,requestStatus:"pending"}})),u=I1(a+"/rejected",(m,g,b,j,F)=>({payload:j,error:(r&&r.serializeError||BF)(m||"Rejected"),meta:{...F||{},arg:b,requestId:g,rejectedWithValue:!!j,requestStatus:"rejected",aborted:m?.name==="AbortError",condition:m?.name==="ConditionError"}}));function f(m,{signal:g}={}){return(b,j,F)=>{const C=r?.idGenerator?r.idGenerator(m):CF(),M=new AbortController;let _,L;function T(O){L=O,M.abort()}g&&(g.aborted?T(u4):g.addEventListener("abort",()=>T(u4),{once:!0}));const H=(async function(){let O;try{let Z=r?.condition?.(m,{getState:j,extra:F});if(FF(Z)&&(Z=await Z),Z===!1||M.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const ee=new Promise((se,ue)=>{_=()=>{ue({name:"AbortError",message:L||"Aborted"})},M.signal.addEventListener("abort",_)});b(e(C,m,r?.getPendingMeta?.({requestId:C,arg:m},{getState:j,extra:F}))),O=await Promise.race([ee,Promise.resolve(t(m,{dispatch:b,getState:j,extra:F,requestId:C,signal:M.signal,abort:T,rejectWithValue:(se,ue)=>new jy(se,ue),fulfillWithValue:(se,ue)=>new d4(se,ue)})).then(se=>{if(se instanceof jy)throw se;return se instanceof d4?s(se.payload,C,m,se.meta):s(se,C,m)})])}catch(Z){O=Z instanceof jy?u(null,C,m,Z.payload,Z.meta):u(Z,C,m)}finally{_&&M.signal.removeEventListener("abort",_)}return r&&!r.dispatchConditionRejection&&u.match(O)&&O.meta.condition||b(O),O})();return Object.assign(H,{abort:T,requestId:C,arg:m,unwrap(){return H.then(SF)}})}}return Object.assign(f,{pending:e,rejected:u,fulfilled:s,settled:wF(u,s),typePrefix:a})}return n.withTypes=()=>n,n})();function SF(n){if(n.meta&&n.meta.rejectedWithValue)throw n.payload;if(n.error)throw n.error;return n.payload}function FF(n){return n!==null&&typeof n=="object"&&typeof n.then=="function"}var EF=Symbol.for("rtk-slice-createasyncthunk");function kF(n,a){return`${n}/${a}`}function DF({creators:n}={}){const a=n?.asyncThunk?.[EF];return function(r){const{name:s,reducerPath:e=s}=r;if(!s)throw new Error($u(11));const u=(typeof r.reducers=="function"?r.reducers(_F()):r.reducers)||{},f=Object.keys(u),m={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},g={addCase(O,Q){const Z=typeof O=="string"?O:O.type;if(!Z)throw new Error($u(12));if(Z in m.sliceCaseReducersByType)throw new Error($u(13));return m.sliceCaseReducersByType[Z]=Q,g},addMatcher(O,Q){return m.sliceMatchers.push({matcher:O,reducer:Q}),g},exposeAction(O,Q){return m.actionCreators[O]=Q,g},exposeCaseReducer(O,Q){return m.sliceCaseReducersByName[O]=Q,g}};f.forEach(O=>{const Q=u[O],Z={reducerName:O,type:kF(s,O),createNotation:typeof r.reducers=="function"};UF(Q)?IF(Z,Q,g,a):LF(Z,Q,g)});function b(){const[O={},Q=[],Z=void 0]=typeof r.extraReducers=="function"?aC(r.extraReducers):[r.extraReducers],ee={...O,...m.sliceCaseReducersByType};return yF(r.initialState,se=>{for(let ue in ee)se.addCase(ue,ee[ue]);for(let ue of m.sliceMatchers)se.addMatcher(ue.matcher,ue.reducer);for(let ue of Q)se.addMatcher(ue.matcher,ue.reducer);Z&&se.addDefaultCase(Z)})}const j=O=>O,F=new Map,C=new WeakMap;let M;function _(O,Q){return M||(M=b()),M(O,Q)}function L(){return M||(M=b()),M.getInitialState()}function T(O,Q=!1){function Z(se){let ue=se[O];return typeof ue>"u"&&Q&&(ue=vx(C,Z,L)),ue}function ee(se=j){const ue=vx(F,Q,()=>new WeakMap);return vx(ue,se,()=>{const ae={};for(const[pe,z]of Object.entries(r.selectors??{}))ae[pe]=TF(z,se,()=>vx(C,se,L),Q);return ae})}return{reducerPath:O,getSelectors:ee,get selectors(){return ee(Z)},selectSlice:Z}}const H={name:s,reducer:_,actions:m.actionCreators,caseReducers:m.sliceCaseReducersByName,getInitialState:L,...T(e),injectInto(O,{reducerPath:Q,...Z}={}){const ee=Q??e;return O.inject({reducerPath:ee,reducer:_},Z),{...H,...T(ee,!0)}}};return H}}function TF(n,a,t,r){function s(e,...u){let f=a(e);return typeof f>"u"&&r&&(f=t()),n(f,...u)}return s.unwrapped=n,s}var Pl=DF();function _F(){function n(a,t){return{_reducerDefinitionType:"asyncThunk",payloadCreator:a,...t}}return n.withTypes=()=>n,{reducer(a){return Object.assign({[a.name](...t){return a(...t)}}[a.name],{_reducerDefinitionType:"reducer"})},preparedReducer(a,t){return{_reducerDefinitionType:"reducerWithPrepare",prepare:a,reducer:t}},asyncThunk:n}}function LF({type:n,reducerName:a,createNotation:t},r,s){let e,u;if("reducer"in r){if(t&&!MF(r))throw new Error($u(17));e=r.reducer,u=r.prepare}else e=r;s.addCase(n,e).exposeCaseReducer(a,e).exposeAction(a,u?I1(n,u):I1(n))}function UF(n){return n._reducerDefinitionType==="asyncThunk"}function MF(n){return n._reducerDefinitionType==="reducerWithPrepare"}function IF({type:n,reducerName:a},t,r,s){if(!s)throw new Error($u(18));const{payloadCreator:e,fulfilled:u,pending:f,rejected:m,settled:g,options:b}=t,j=s(n,e,b);r.exposeAction(a,j),u&&r.addCase(j.fulfilled,u),f&&r.addCase(j.pending,f),m&&r.addCase(j.rejected,m),g&&r.addMatcher(j.settled,g),r.exposeCaseReducer(a,{fulfilled:u||wx,pending:f||wx,rejected:m||wx,settled:g||wx})}function wx(){}function $u(n){return`Minified Redux Toolkit error #${n}; visit https://redux-toolkit.js.org/Errors?code=${n} for the full message or use the non-minified dev environment for full errors. `}function sC(n){var a,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(a=0;a<s;a++)n[a]&&(t=sC(n[a]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function hi(){for(var n,a,t=0,r="",s=arguments.length;t<s;t++)(n=arguments[t])&&(a=sC(n))&&(r&&(r+=" "),r+=a);return r}function OF(n){if(typeof document>"u")return;let a=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",a.firstChild?a.insertBefore(t,a.firstChild):a.appendChild(t),t.styleSheet?t.styleSheet.cssText=n:t.appendChild(document.createTextNode(n))}OF(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var ug=n=>typeof n=="number"&&!isNaN(n),vh=n=>typeof n=="string",sf=n=>typeof n=="function",QF=n=>vh(n)||ug(n),Vv=n=>vh(n)||sf(n)?n:null,RF=(n,a)=>n===!1||ug(n)&&n>0?n:a,Yv=n=>ne.isValidElement(n)||vh(n)||sf(n)||ug(n);function PF(n,a,t=300){let{scrollHeight:r,style:s}=n;requestAnimationFrame(()=>{s.minHeight="initial",s.height=r+"px",s.transition=`all ${t}ms`,requestAnimationFrame(()=>{s.height="0",s.padding="0",s.margin="0",setTimeout(a,t)})})}function HF({enter:n,exit:a,appendPosition:t=!1,collapse:r=!0,collapseDuration:s=300}){return function({children:e,position:u,preventExitTransition:f,done:m,nodeRef:g,isIn:b,playToast:j}){let F=t?`${n}--${u}`:n,C=t?`${a}--${u}`:a,M=ne.useRef(0);return ne.useLayoutEffect(()=>{let _=g.current,L=F.split(" "),T=H=>{H.target===g.current&&(j(),_.removeEventListener("animationend",T),_.removeEventListener("animationcancel",T),M.current===0&&H.type!=="animationcancel"&&_.classList.remove(...L))};_.classList.add(...L),_.addEventListener("animationend",T),_.addEventListener("animationcancel",T)},[]),ne.useEffect(()=>{let _=g.current,L=()=>{_.removeEventListener("animationend",L),r?PF(_,m,s):m()};b||(f?L():(M.current=1,_.className+=` ${C}`,_.addEventListener("animationend",L)))},[b]),At.createElement(At.Fragment,null,e)}}function f4(n,a){return{content:nC(n.content,n.props),containerId:n.props.containerId,id:n.props.toastId,theme:n.props.theme,type:n.props.type,data:n.props.data||{},isLoading:n.props.isLoading,icon:n.props.icon,reason:n.removalReason,status:a}}function nC(n,a,t=!1){return ne.isValidElement(n)&&!vh(n.type)?ne.cloneElement(n,{closeToast:a.closeToast,toastProps:a,data:a.data,isPaused:t}):sf(n)?n({closeToast:a.closeToast,toastProps:a,data:a.data,isPaused:t}):n}function zF({closeToast:n,theme:a,ariaLabel:t="close"}){return At.createElement("button",{className:`Toastify__close-button Toastify__close-button--${a}`,type:"button",onClick:r=>{r.stopPropagation(),n(!0)},"aria-label":t},At.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},At.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function KF({delay:n,isRunning:a,closeToast:t,type:r="default",hide:s,className:e,controlledProgress:u,progress:f,rtl:m,isIn:g,theme:b}){let j=s||u&&f===0,F={animationDuration:`${n}ms`,animationPlayState:a?"running":"paused"};u&&(F.transform=`scaleX(${f})`);let C=hi("Toastify__progress-bar",u?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${b}`,`Toastify__progress-bar--${r}`,{"Toastify__progress-bar--rtl":m}),M=sf(e)?e({rtl:m,type:r,defaultClassName:C}):hi(C,e),_={[u&&f>=1?"onTransitionEnd":"onAnimationEnd"]:u&&f<1?null:()=>{g&&t()}};return At.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":j},At.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${b} Toastify__progress-bar--${r}`}),At.createElement("div",{role:"progressbar","aria-hidden":j?"true":"false","aria-label":"notification timer",className:M,style:F,..._}))}var GF=1,iC=()=>`${GF++}`;function VF(n,a,t){let r=1,s=0,e=[],u=[],f=a,m=new Map,g=new Set,b=H=>(g.add(H),()=>g.delete(H)),j=()=>{u=Array.from(m.values()),g.forEach(H=>H())},F=({containerId:H,toastId:O,updateId:Q})=>{let Z=H?H!==n:n!==1,ee=m.has(O)&&Q==null;return Z||ee},C=(H,O)=>{m.forEach(Q=>{var Z;(O==null||O===Q.props.toastId)&&((Z=Q.toggle)==null||Z.call(Q,H))})},M=H=>{var O,Q;(Q=(O=H.props)==null?void 0:O.onClose)==null||Q.call(O,H.removalReason),H.isActive=!1},_=H=>{if(H==null)m.forEach(M);else{let O=m.get(H);O&&M(O)}j()},L=()=>{s-=e.length,e=[]},T=H=>{var O,Q;let{toastId:Z,updateId:ee}=H.props,se=ee==null;H.staleId&&m.delete(H.staleId),H.isActive=!0,m.set(Z,H),j(),t(f4(H,se?"added":"updated")),se&&((Q=(O=H.props).onOpen)==null||Q.call(O))};return{id:n,props:f,observe:b,toggle:C,removeToast:_,toasts:m,clearQueue:L,buildToast:(H,O)=>{if(F(O))return;let{toastId:Q,updateId:Z,data:ee,staleId:se,delay:ue}=O,ae=Z==null;ae&&s++;let pe={...f,style:f.toastStyle,key:r++,...Object.fromEntries(Object.entries(O).filter(([J,ge])=>ge!=null)),toastId:Q,updateId:Z,data:ee,isIn:!1,className:Vv(O.className||f.toastClassName),progressClassName:Vv(O.progressClassName||f.progressClassName),autoClose:O.isLoading?!1:RF(O.autoClose,f.autoClose),closeToast(J){m.get(Q).removalReason=J,_(Q)},deleteToast(){let J=m.get(Q);if(J!=null){if(t(f4(J,"removed")),m.delete(Q),s--,s<0&&(s=0),e.length>0){T(e.shift());return}j()}}};pe.closeButton=f.closeButton,O.closeButton===!1||Yv(O.closeButton)?pe.closeButton=O.closeButton:O.closeButton===!0&&(pe.closeButton=Yv(f.closeButton)?f.closeButton:!0);let z={content:H,props:pe,staleId:se};f.limit&&f.limit>0&&s>f.limit&&ae?e.push(z):ug(ue)?setTimeout(()=>{T(z)},ue):T(z)},setProps(H){f=H},setToggle:(H,O)=>{let Q=m.get(H);Q&&(Q.toggle=O)},isToastActive:H=>{var O;return(O=m.get(H))==null?void 0:O.isActive},getSnapshot:()=>u}}var sc=new Map,J1=[],Wv=new Set,YF=n=>Wv.forEach(a=>a(n)),oC=()=>sc.size>0;function WF(){J1.forEach(n=>cC(n.content,n.options)),J1=[]}var $F=(n,{containerId:a})=>{var t;return(t=sc.get(a||1))==null?void 0:t.toasts.get(n)};function lC(n,a){var t;if(a)return!!((t=sc.get(a))!=null&&t.isToastActive(n));let r=!1;return sc.forEach(s=>{s.isToastActive(n)&&(r=!0)}),r}function qF(n){if(!oC()){J1=J1.filter(a=>n!=null&&a.options.toastId!==n);return}if(n==null||QF(n))sc.forEach(a=>{a.removeToast(n)});else if(n&&("containerId"in n||"id"in n)){let a=sc.get(n.containerId);a?a.removeToast(n.id):sc.forEach(t=>{t.removeToast(n.id)})}}var XF=(n={})=>{sc.forEach(a=>{a.props.limit&&(!n.containerId||a.id===n.containerId)&&a.clearQueue()})};function cC(n,a){Yv(n)&&(oC()||J1.push({content:n,options:a}),sc.forEach(t=>{t.buildToast(n,a)}))}function JF(n){var a;(a=sc.get(n.containerId||1))==null||a.setToggle(n.id,n.fn)}function AC(n,a){sc.forEach(t=>{(a==null||!(a!=null&&a.containerId)||a?.containerId===t.id)&&t.toggle(n,a?.id)})}function ZF(n){let a=n.containerId||1;return{subscribe(t){let r=VF(a,n,YF);sc.set(a,r);let s=r.observe(t);return WF(),()=>{s(),sc.delete(a)}},setProps(t){var r;(r=sc.get(a))==null||r.setProps(t)},getSnapshot(){var t;return(t=sc.get(a))==null?void 0:t.getSnapshot()}}}function e7(n){return Wv.add(n),()=>{Wv.delete(n)}}function t7(n){return n&&(vh(n.toastId)||ug(n.toastId))?n.toastId:iC()}function fg(n,a){return cC(n,a),a.toastId}function Eb(n,a){return{...a,type:a&&a.type||n,toastId:t7(a)}}function kb(n){return(a,t)=>fg(a,Eb(n,t))}function Js(n,a){return fg(n,Eb("default",a))}Js.loading=(n,a)=>fg(n,Eb("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...a}));function r7(n,{pending:a,error:t,success:r},s){let e;a&&(e=vh(a)?Js.loading(a,s):Js.loading(a.render,{...s,...a}));let u={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},f=(g,b,j)=>{if(b==null){Js.dismiss(e);return}let F={type:g,...u,...s,data:j},C=vh(b)?{render:b}:b;return e?Js.update(e,{...F,...C}):Js(C.render,{...F,...C}),j},m=sf(n)?n():n;return m.then(g=>f("success",r,g)).catch(g=>f("error",t,g)),m}Js.promise=r7;Js.success=kb("success");Js.info=kb("info");Js.error=kb("error");Js.warning=kb("warning");Js.warn=Js.warning;Js.dark=(n,a)=>fg(n,Eb("default",{theme:"dark",...a}));function a7(n){qF(n)}Js.dismiss=a7;Js.clearWaitingQueue=XF;Js.isActive=lC;Js.update=(n,a={})=>{let t=$F(n,a);if(t){let{props:r,content:s}=t,e={delay:100,...r,...a,toastId:a.toastId||n,updateId:iC()};e.toastId!==n&&(e.staleId=n);let u=e.render||s;delete e.render,fg(u,e)}};Js.done=n=>{Js.update(n,{progress:1})};Js.onChange=e7;Js.play=n=>AC(!0,n);Js.pause=n=>AC(!1,n);function s7(n){var a;let{subscribe:t,getSnapshot:r,setProps:s}=ne.useRef(ZF(n)).current;s(n);let e=(a=ne.useSyncExternalStore(t,r,r))==null?void 0:a.slice();function u(f){if(!e)return[];let m=new Map;return n.newestOnTop&&e.reverse(),e.forEach(g=>{let{position:b}=g.props;m.has(b)||m.set(b,[]),m.get(b).push(g)}),Array.from(m,g=>f(g[0],g[1]))}return{getToastToRender:u,isToastActive:lC,count:e?.length}}function n7(n){let[a,t]=ne.useState(!1),[r,s]=ne.useState(!1),e=ne.useRef(null),u=ne.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:f,pauseOnHover:m,closeToast:g,onClick:b,closeOnClick:j}=n;JF({id:n.toastId,containerId:n.containerId,fn:t}),ne.useEffect(()=>{if(n.pauseOnFocusLoss)return F(),()=>{C()}},[n.pauseOnFocusLoss]);function F(){document.hasFocus()||T(),window.addEventListener("focus",L),window.addEventListener("blur",T)}function C(){window.removeEventListener("focus",L),window.removeEventListener("blur",T)}function M(se){if(n.draggable===!0||n.draggable===se.pointerType){H();let ue=e.current;u.canCloseOnClick=!0,u.canDrag=!0,ue.style.transition="none",n.draggableDirection==="x"?(u.start=se.clientX,u.removalDistance=ue.offsetWidth*(n.draggablePercent/100)):(u.start=se.clientY,u.removalDistance=ue.offsetHeight*(n.draggablePercent===80?n.draggablePercent*1.5:n.draggablePercent)/100)}}function _(se){let{top:ue,bottom:ae,left:pe,right:z}=e.current.getBoundingClientRect();se.nativeEvent.type!=="touchend"&&n.pauseOnHover&&se.clientX>=pe&&se.clientX<=z&&se.clientY>=ue&&se.clientY<=ae?T():L()}function L(){t(!0)}function T(){t(!1)}function H(){u.didMove=!1,document.addEventListener("pointermove",Q),document.addEventListener("pointerup",Z)}function O(){document.removeEventListener("pointermove",Q),document.removeEventListener("pointerup",Z)}function Q(se){let ue=e.current;if(u.canDrag&&ue){u.didMove=!0,a&&T(),n.draggableDirection==="x"?u.delta=se.clientX-u.start:u.delta=se.clientY-u.start,u.start!==se.clientX&&(u.canCloseOnClick=!1);let ae=n.draggableDirection==="x"?`${u.delta}px, var(--y)`:`0, calc(${u.delta}px + var(--y))`;ue.style.transform=`translate3d(${ae},0)`,ue.style.opacity=`${1-Math.abs(u.delta/u.removalDistance)}`}}function Z(){O();let se=e.current;if(u.canDrag&&u.didMove&&se){if(u.canDrag=!1,Math.abs(u.delta)>u.removalDistance){s(!0),n.closeToast(!0),n.collapseAll();return}se.style.transition="transform 0.2s, opacity 0.2s",se.style.removeProperty("transform"),se.style.removeProperty("opacity")}}let ee={onPointerDown:M,onPointerUp:_};return f&&m&&(ee.onMouseEnter=T,n.stacked||(ee.onMouseLeave=L)),j&&(ee.onClick=se=>{b&&b(se),u.canCloseOnClick&&g(!0)}),{playToast:L,pauseToast:T,isRunning:a,preventExitTransition:r,toastRef:e,eventHandlers:ee}}var i7=typeof window<"u"?ne.useLayoutEffect:ne.useEffect,Db=({theme:n,type:a,isLoading:t,...r})=>At.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:n==="colored"?"currentColor":`var(--toastify-icon-color-${a})`,...r});function o7(n){return At.createElement(Db,{...n},At.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function l7(n){return At.createElement(Db,{...n},At.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function c7(n){return At.createElement(Db,{...n},At.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function A7(n){return At.createElement(Db,{...n},At.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function d7(){return At.createElement("div",{className:"Toastify__spinner"})}var $v={info:l7,warning:o7,success:c7,error:A7,spinner:d7},u7=n=>n in $v;function f7({theme:n,type:a,isLoading:t,icon:r}){let s=null,e={theme:n,type:a};return r===!1||(sf(r)?s=r({...e,isLoading:t}):ne.isValidElement(r)?s=ne.cloneElement(r,e):t?s=$v.spinner():u7(a)&&(s=$v[a](e))),s}var h7=n=>{let{isRunning:a,preventExitTransition:t,toastRef:r,eventHandlers:s,playToast:e}=n7(n),{closeButton:u,children:f,autoClose:m,onClick:g,type:b,hideProgressBar:j,closeToast:F,transition:C,position:M,className:_,style:L,progressClassName:T,updateId:H,role:O,progress:Q,rtl:Z,toastId:ee,deleteToast:se,isIn:ue,isLoading:ae,closeOnClick:pe,theme:z,ariaLabel:J}=n,ge=hi("Toastify__toast",`Toastify__toast-theme--${z}`,`Toastify__toast--${b}`,{"Toastify__toast--rtl":Z},{"Toastify__toast--close-on-click":pe}),fe=sf(_)?_({rtl:Z,position:M,type:b,defaultClassName:ge}):hi(ge,_),ke=f7(n),he=!!Q||!m,Ne={closeToast:F,type:b,theme:z},xe=null;return u===!1||(sf(u)?xe=u(Ne):ne.isValidElement(u)?xe=ne.cloneElement(u,Ne):xe=zF(Ne)),At.createElement(C,{isIn:ue,done:se,position:M,preventExitTransition:t,nodeRef:r,playToast:e},At.createElement("div",{id:ee,tabIndex:0,onClick:g,"data-in":ue,className:fe,...s,style:L,ref:r,...ue&&{role:O,"aria-label":J}},ke!=null&&At.createElement("div",{className:hi("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!ae})},ke),nC(f,n,!a),xe,!n.customProgressBar&&At.createElement(KF,{...H&&!he?{key:`p-${H}`}:{},rtl:Z,theme:z,delay:m,isRunning:a,isIn:ue,closeToast:F,hide:j,type:b,className:T,controlledProgress:he,progress:Q||0})))},m7=(n,a=!1)=>({enter:`Toastify--animate Toastify__${n}-enter`,exit:`Toastify--animate Toastify__${n}-exit`,appendPosition:a}),p7=HF(m7("bounce",!0)),g7={position:"top-right",transition:p7,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:n=>n.altKey&&n.code==="KeyT"};function x7(n){let a={...g7,...n},t=n.stacked,[r,s]=ne.useState(!0),e=ne.useRef(null),{getToastToRender:u,isToastActive:f,count:m}=s7(a),{className:g,style:b,rtl:j,containerId:F,hotKeys:C}=a;function M(L){let T=hi("Toastify__toast-container",`Toastify__toast-container--${L}`,{"Toastify__toast-container--rtl":j});return sf(g)?g({position:L,rtl:j,defaultClassName:T}):hi(T,Vv(g))}function _(){t&&(s(!0),Js.play())}return i7(()=>{var L;if(t){let T=e.current.querySelectorAll('[data-in="true"]'),H=12,O=(L=a.position)==null?void 0:L.includes("top"),Q=0,Z=0;Array.from(T).reverse().forEach((ee,se)=>{let ue=ee;ue.classList.add("Toastify__toast--stacked"),se>0&&(ue.dataset.collapsed=`${r}`),ue.dataset.pos||(ue.dataset.pos=O?"top":"bot");let ae=Q*(r?.2:1)+(r?0:H*se);ue.style.setProperty("--y",`${O?ae:ae*-1}px`),ue.style.setProperty("--g",`${H}`),ue.style.setProperty("--s",`${1-(r?Z:0)}`),Q+=ue.offsetHeight,Z+=.025})}},[r,m,t]),ne.useEffect(()=>{function L(T){var H;let O=e.current;C(T)&&((H=O.querySelector('[tabIndex="0"]'))==null||H.focus(),s(!1),Js.pause()),T.key==="Escape"&&(document.activeElement===O||O!=null&&O.contains(document.activeElement))&&(s(!0),Js.play())}return document.addEventListener("keydown",L),()=>{document.removeEventListener("keydown",L)}},[C]),At.createElement("section",{ref:e,className:"Toastify",id:F,onMouseEnter:()=>{t&&(s(!1),Js.pause())},onMouseLeave:_,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":a["aria-label"]},u((L,T)=>{let H=T.length?{...b}:{...b,pointerEvents:"none"};return At.createElement("div",{tabIndex:-1,className:M(L),"data-stacked":t,style:H,key:`c-${L}`},T.map(({content:O,props:Q})=>At.createElement(h7,{...Q,stacked:t,collapseAll:_,isIn:f(Q.toastId,Q.containerId),key:`t-${Q.key}`},O)))}))}const dr="/dawn-school/backend/api.php?endpoint=",b7="/dawn-school/backend/api.php?endpoint=photos",gl=n=>{const a=n.startsWith("/")?n.substring(1):n;return`${dr}${a}`},fs=(n,a,{successMessage:t,errorMessage:r,delay:s=500}={})=>Ss(n,async(e,u)=>{try{s>0&&await new Promise(m=>setTimeout(m,s));const f=await a(e,u);return t&&Js.success(t),f}catch(f){return r&&Js.error(r),u.rejectWithValue(f.message||f)}}),e5=(n,a,t={})=>{const s={...{successMessage:"Item added successfully",errorMessage:"Failed to add item",delay:500},...t};return fs(n,async e=>{const u={id:Date.now().toString(),...e};return await a(u)},s)},t5=(n,a,t={})=>{const s={...{successMessage:"Item updated successfully",errorMessage:"Failed to update item",delay:500},...t};return fs(n,async e=>await a(e),s)},r5=(n,a,t={})=>{const s={...{successMessage:"Item deleted successfully",errorMessage:"Failed to delete item",delay:500},...t};return fs(n,async e=>await a(e),s)},dC=n=>{if(!n)return"";const a=n.replace(/\D/g,"");return a.startsWith("92")?`+${a}`:a.startsWith("03")&&a.length===11?`+92${a.substring(1)}`:a.startsWith("3")&&a.length===10?`+92${a}`:n},y7={students:[],loading:!1,error:null},Lc=fs("students/fetchStudents",async()=>{const n=await fetch(gl("students"));if(!n.ok)throw new Error("Failed to fetch students");return await n.json()},{delay:500}),uC=e5("students/addStudent",async n=>{if(!n.class)throw new Error("Student must have a class assigned");let a=parseFloat(n.totalFees)||0;const t=parseFloat(n.monthlyFees)||0,r=parseFloat(n.admissionFees)||0;let s=parseFloat(n.feesPaid)||0;a<=0&&(a=t+r),s+=r;const e=[],u=await fetch(gl("batches"));if(!u.ok)throw new Error("Failed to fetch batches for student creation");const f=await u.json(),m=Array.isArray(f)?f.find(H=>H&&H.status==="active"):null;let g;if(m&&typeof m.name=="string"&&m.name.trim())g=m.name.trim();else throw new Error("No active batch found. Please create an active batch before adding students.");const b=g,j=await fetch(gl("students"));if(!j.ok)throw new Error("Failed to fetch students for roll number validation");if((await j.json()).some(H=>H.class===n.class&&H.academicYear===g&&H.grNo===n.grNo))throw new Error(`Roll number ${n.grNo} is already taken in ${n.class} for academic year ${g}`);const M=dC(n.parentContact);r>0&&e.push({id:`challan-${Date.now()}-01`,month:"Admission Fees",amount:r,paid:!0,date:n.dateOfAdmission||new Date().toISOString(),dueDate:n.dateOfAdmission||new Date().toISOString().split("T")[0],status:"paid",type:"admission",academicYear:b,paymentTimestamp:new Date().toISOString()});const _=n.familyId||`family-${Date.now()}`,L={...n,photo:n.photo||`https://api.dicebear.com/7.x/initials/svg?seed=${n.firstName} ${n.lastName}`,parentContact:M,monthlyFees:t,admissionFees:r,feesPaid:s,totalFees:a,familyId:_,feesHistory:e,status:"studying",academicYear:g,admissionTimestamp:new Date().toISOString()},T=await fetch(gl("students"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)});if(!T.ok)throw new Error("Failed to add student");return await T.json()},{successMessage:"Student added successfully",errorMessage:"Failed to add student",delay:500}),a0=t5("students/updateStudent",async n=>{if(!n.class)throw new Error("Student must have a class assigned");const a=dC(n.parentContact),t={...n,parentContact:a,photo:n.photo&&n.photo.startsWith("data:")?"":n.photo},r=await fetch(gl(`students/${n.id}`),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok)throw new Error("Failed to update student");return await r.json()},{successMessage:"Student updated successfully",errorMessage:"Failed to update student",delay:500}),v7=r5("students/deleteStudent",async n=>{if(!(await fetch(gl(`students/${n}`),{method:"DELETE"})).ok)throw new Error("Failed to delete student");return n},{successMessage:"Student deleted successfully",errorMessage:"Failed to delete student",delay:500}),fC=fs("students/payFees",async({challanId:n,paymentMethod:a,paymentDate:t,discountAmount:r,discountReason:s,actualAmountPaid:e})=>{const u=await fetch(gl("students"));if(!u.ok)throw new Error("Failed to fetch students");const f=await u.json();let m=null,g=null;for(const _ of f)if(_.feesHistory){const L=_.feesHistory.find(T=>T.id===n);if(L){m=_,g=L;break}}if(!m||!g)throw new Error("Challan not found");const j=(_=>{if(!_)return 0;const L=new Date(t||new Date),T=new Date(_);return L.setHours(0,0,0,0),T.setHours(0,0,0,0),L>T?500:0})(g.dueDate);g.paid=!0,g.status="paid",g.date=t||new Date().toISOString(),g.paymentMethod=a||"cash",g.paymentTimestamp=new Date().toISOString(),g.fineAmount=j,g.discountAmount=r||0,g.discountReason=s||"",g.discountedAmount=(parseFloat(g.amount)||0)-(r||0);const F=(parseFloat(g.amount)||0)-(r||0)+j,C=e!==void 0?e:F;m.feesPaid=(parseFloat(m.feesPaid)||0)+C;const M=await fetch(gl(`students/${m.id}`),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)});if(!M.ok)throw new Error("Failed to update student fees");return await M.json()},{successMessage:"Fees paid successfully",errorMessage:"Failed to pay fees",delay:500}),hC=fs("students/generateChallan",async n=>{const a=await fetch(gl(`students/${n.studentId}`));if(!a.ok)throw new Error("Failed to fetch student");const t=await a.json(),r=["January","February","March","April","May","June","July","August","September","October","November","December"],[s,e]=(n.month||"2025-01").split("-"),f=`${r[parseInt(e)-1]||"Unknown"} ${s}`,m=s,g=parseInt(m)+1,b=`${m}-${g}`;if(t.feesHistory){if(t.feesHistory.find(L=>L.month===f&&L.type==="monthly"&&L.academicYear===b))throw new Error(`A challan for ${f} already exists for this student in academic year ${b}`);if(t.feesHistory.filter(L=>L.type==="monthly"&&L.academicYear===b).length>=12)throw new Error(`Maximum 12 challans allowed per academic year. Student already has 12 challans for ${b}`)}const j={month:f,amount:parseFloat(n.amount)||0,dueDate:n.dueDate||new Date(Date.now()+14400*60*1e3).toISOString().split("T")[0],description:n.description||"",paid:!1,date:null,status:"pending",type:"monthly",academicYear:b,generationTimestamp:new Date().toISOString()},F={...t,feesHistory:[...t.feesHistory||[],j]},C=await fetch(gl(`students/${n.studentId}`),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(F)});if(!C.ok)throw new Error("Failed to generate challan");return await C.json()},{successMessage:"Challan generated successfully",errorMessage:"Failed to generate challan",delay:500}),mC=fs("students/bulkGenerateChallans",async({studentIds:n,challanTemplate:a})=>{const t=[],r=["January","February","March","April","May","June","July","August","September","October","November","December"],s=a.month||new Date().toISOString().slice(0,7),[e,u]=s.split("-"),m=`${r[parseInt(u)-1]||"Unknown"} ${e}`;for(const g of n){const b=await fetch(gl(`students/${g}`));if(!b.ok)throw new Error(`Failed to fetch student ${g}`);const j=await b.json(),F=e,C=parseInt(F)+1,M=`${F}-${C}`;if(j.feesHistory){if(j.feesHistory.find(Z=>Z.month===m&&Z.type==="monthly"&&Z.academicYear===M))throw new Error(`A challan for ${m} already exists for student ${j.firstName} ${j.lastName} in academic year ${M}`);if(j.feesHistory.filter(Z=>Z.type==="monthly"&&Z.academicYear===M).length>=12)throw new Error(`Maximum 12 challans allowed per academic year. Student ${j.firstName} ${j.lastName} already has 12 challans for ${M}`)}let _=0;if(j.monthlyFees&&(_=parseFloat(j.monthlyFees)||0),_===0&&j.class)try{const O=`${dr}classes&name=${encodeURIComponent(j.class)}`,Q=await fetch(O);if(Q.ok){const Z=await Q.json();Z&&Z.monthlyFees&&(_=parseFloat(Z.monthlyFees)||0)}}catch(O){console.warn(`Failed to fetch class data for ${j.class}:`,O)}const L={month:m,amount:_,dueDate:a.dueDate||new Date(Date.now()+14400*60*1e3).toISOString().split("T")[0],description:a.description||"",paid:!1,date:null,status:"pending",type:"monthly",academicYear:M,generationTimestamp:new Date().toISOString()},T={...j,feesHistory:[...j.feesHistory||[],L]},H=await fetch(gl(`students/${g}`),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)});if(!H.ok)throw new Error(`Failed to update student ${g}`);t.push(await H.json())}return{studentIds:n,challanTemplate:a,updatedStudents:t}},{successMessage:"Challans generated successfully",errorMessage:"Failed to generate challans",delay:1e3}),qv=fs("students/bulkUpdateChallanStatuses",async({challanUpdates:n})=>{const a={};n.forEach(r=>{const{studentId:s,challanId:e,paymentMethod:u,paymentDate:f,discountAmount:m,discountReason:g}=r||{};!s||!e||(a[s]||(a[s]=[]),a[s].push({challanId:e,paymentMethod:u||"cash",paymentDate:f||new Date().toISOString().split("T")[0],discountAmount:m||0,discountReason:g||""}))});const t=[];for(const[r,s]of Object.entries(a)){const e=await fetch(gl(`students/${r}`));if(!e.ok)throw new Error(`Failed to fetch student ${r}`);const u=await e.json();let f=!1,m=0;if(s.forEach(g=>{const{challanId:b,paymentMethod:j,paymentDate:F,discountAmount:C,discountReason:M}=g;if(u.feesHistory){const _=u.feesHistory.find(L=>L.id===b);if(_&&!_.paid){_.paid=!0,_.status="paid",_.date=F,_.paymentMethod=j,_.discountAmount=C||0,_.discountReason=M||"",_.discountedAmount=(parseFloat(_.amount)||0)-(C||0);const L=(parseFloat(_.amount)||0)-(C||0);m+=L,f=!0}}}),f){u.feesPaid=(parseFloat(u.feesPaid)||0)+m;const g=await fetch(gl(`students/${r}`),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!g.ok)throw new Error(`Failed to update student ${r}`);t.push(await g.json())}}return{challanUpdates:n,updatedStudents:t}},{successMessage:"Challan statuses updated successfully",errorMessage:"Failed to update challan statuses",delay:1e3}),pC=fs("students/markStudentAsLeft",async n=>{const a={...n,status:"left",dateOfLeaving:n.leavingDate||new Date().toISOString().split("T")[0],reasonOfLeaving:n.leavingReason||"Left school",classInWhichLeft:n.class||"",...n.dateOfLeaving&&{dateOfLeaving:n.dateOfLeaving},...n.reasonOfLeaving&&{reasonOfLeaving:n.reasonOfLeaving},...n.classInWhichLeft&&{classInWhichLeft:n.classInWhichLeft}},t=await fetch(gl(`students/${n.id}`),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!t.ok)throw new Error("Failed to mark student as left");return await t.json()},{successMessage:"Student marked as left successfully",errorMessage:"Failed to mark student as left",delay:500}),w7=Pl({name:"students",initialState:y7,reducers:{},extraReducers:n=>{n.addCase(Lc.pending,a=>{a.loading=!0,a.error=null}).addCase(Lc.fulfilled,(a,t)=>{a.loading=!1,a.students=t.payload}).addCase(Lc.rejected,(a,t)=>{a.loading=!1,a.error=t.error.message}).addCase(uC.fulfilled,(a,t)=>{console.log("Adding student to state:",t.payload),a.students.push(t.payload),console.log("Students array after adding:",a.students)}).addCase(a0.fulfilled,(a,t)=>{const r=a.students.findIndex(s=>s.id===t.payload.id);r!==-1&&(a.students[r]=t.payload)}).addCase(v7.fulfilled,(a,t)=>{a.students=a.students.filter(r=>r.id!==t.payload)}).addCase(fC.fulfilled,(a,t)=>{const r=a.students.findIndex(s=>s.id===t.payload.id);r!==-1&&(a.students[r]=t.payload)}).addCase(hC.fulfilled,(a,t)=>{const r=a.students.findIndex(s=>s.id===t.payload.id);r!==-1&&(a.students[r]=t.payload)}).addCase(mC.fulfilled,(a,t)=>{const{updatedStudents:r}=t.payload;r.forEach(s=>{const e=a.students.findIndex(u=>u.id===s.id);e!==-1&&(a.students[e]=s)})}).addCase(qv.fulfilled,(a,t)=>{const{challanUpdates:r,updatedStudents:s}=t.payload;s.forEach(e=>{const u=a.students.findIndex(f=>f.id===e.id);u!==-1&&(a.students[u]=e)})}).addCase(pC.fulfilled,(a,t)=>{const r=a.students.findIndex(s=>s.id===t.payload.id);r!==-1&&(a.students[r]=t.payload)})}}),N7=w7.reducer,C7={alumni:[],batches:[],loading:!1,error:null},By=fs("alumni/fetchAlumni",async()=>{const n=await fetch(`${dr}/alumni`);if(!n.ok)throw new Error("Failed to fetch alumni");return await n.json()},{delay:500}),Km=fs("alumni/fetchBatches",async()=>{const n=await fetch(`${dr}/batches`);if(!n.ok)throw new Error("Failed to fetch batches");return await n.json()},{delay:500}),j7=fs("alumni/addAlumnus",async n=>{const a={id:Date.now().toString(),...n,addedTimestamp:new Date().toISOString()},t=await fetch(`${dr}/alumni`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!t.ok)throw new Error("Failed to add alumnus");return await t.json()},{successMessage:"Alumnus added successfully",errorMessage:"Failed to add alumnus",delay:500}),B7=fs("alumni/updateAlumnus",async n=>{const a=await fetch(`${dr}/alumni/${n.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!a.ok)throw new Error("Failed to update alumnus");return await a.json()},{successMessage:"Alumnus updated successfully",errorMessage:"Failed to update alumnus",delay:500}),S7=fs("alumni/deleteAlumnus",async n=>{if(!(await fetch(`${dr}/alumni/${n}`,{method:"DELETE"})).ok)throw new Error("Failed to delete alumnus");return n},{successMessage:"Alumnus deleted successfully",errorMessage:"Failed to delete alumnus",delay:500}),gC=fs("alumni/addBatch",async n=>{const a={id:Date.now().toString(),...n,addedTimestamp:new Date().toISOString()},t=await fetch(`${dr}/batches`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!t.ok)throw new Error("Failed to add batch");return await t.json()},{successMessage:"Batch added successfully",errorMessage:"Failed to add batch",delay:500}),Xv=fs("alumni/updateBatch",async n=>{const a=await fetch(`${dr}/batches/${n.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!a.ok)throw new Error("Failed to update batch");return await a.json()},{successMessage:"Batch updated successfully",errorMessage:"Failed to update batch",delay:500}),xC=fs("alumni/deleteBatch",async n=>{if(!(await fetch(`${dr}/batches/${n}`,{method:"DELETE"})).ok)throw new Error("Failed to delete batch");return n},{successMessage:"Batch deleted successfully",errorMessage:"Failed to delete batch",delay:500}),F7=Pl({name:"alumni",initialState:C7,reducers:{},extraReducers:n=>{n.addCase(By.pending,a=>{a.loading=!0,a.error=null}).addCase(By.fulfilled,(a,t)=>{a.loading=!1,a.alumni=t.payload}).addCase(By.rejected,(a,t)=>{a.loading=!1,a.error=t.error.message}).addCase(Km.pending,a=>{a.loading=!0,a.error=null}).addCase(Km.fulfilled,(a,t)=>{a.loading=!1,a.batches=t.payload}).addCase(Km.rejected,(a,t)=>{a.loading=!1,a.error=t.error.message}).addCase(j7.fulfilled,(a,t)=>{a.alumni.push(t.payload)}).addCase(B7.fulfilled,(a,t)=>{const r=a.alumni.findIndex(s=>s.id===t.payload.id);r!==-1&&(a.alumni[r]=t.payload)}).addCase(S7.fulfilled,(a,t)=>{a.alumni=a.alumni.filter(r=>r.id!==t.payload)}).addCase(gC.fulfilled,(a,t)=>{a.batches.push(t.payload)}).addCase(Xv.fulfilled,(a,t)=>{const r=a.batches.findIndex(s=>s.id===t.payload.id);r!==-1&&(a.batches[r]=t.payload)}).addCase(xC.fulfilled,(a,t)=>{a.batches=a.batches.filter(r=>r.id!==t.payload)})}}),E7=F7.reducer,k7={events:[],loading:!1,error:null},Sy=fs("events/fetchEvents",async()=>{const n=await fetch(`${dr}/events`);if(!n.ok)throw new Error("Failed to fetch events");return await n.json()},{delay:500}),D7=fs("events/addEvent",async n=>{const a={id:Date.now().toString(),...n,addedTimestamp:new Date().toISOString()},t=await fetch(`${dr}/events`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!t.ok)throw new Error("Failed to add event");return await t.json()},{successMessage:"Event added successfully",errorMessage:"Failed to add event",delay:500}),T7=fs("events/updateEvent",async n=>{const a=await fetch(`${dr}/events/${n.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!a.ok)throw new Error("Failed to update event");return await a.json()},{successMessage:"Event updated successfully",errorMessage:"Failed to update event",delay:500}),_7=fs("events/deleteEvent",async n=>{if(!(await fetch(`${dr}/events/${n}`,{method:"DELETE"})).ok)throw new Error("Failed to delete event");return n},{successMessage:"Event deleted successfully",errorMessage:"Failed to delete event",delay:500}),L7=Pl({name:"events",initialState:k7,reducers:{},extraReducers:n=>{n.addCase(Sy.pending,a=>{a.loading=!0,a.error=null}).addCase(Sy.fulfilled,(a,t)=>{a.loading=!1,a.events=t.payload}).addCase(Sy.rejected,(a,t)=>{a.loading=!1,a.error=t.error.message}).addCase(D7.fulfilled,(a,t)=>{a.events.push(t.payload)}).addCase(T7.fulfilled,(a,t)=>{const r=a.events.findIndex(s=>s.id===t.payload.id);r!==-1&&(a.events[r]=t.payload)}).addCase(_7.fulfilled,(a,t)=>{a.events=a.events.filter(r=>r.id!==t.payload)})}}),U7=L7.reducer,u2=Ss("notifications/fetchNotifications",async()=>{const n=await fetch(`${API_BASE_URL}/notifications`);if(!n.ok)throw new Error("Failed to fetch notifications");return n.json()}),M7=Ss("notifications/addNotification",async n=>{const a=await fetch(`${API_BASE_URL}/notifications`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!a.ok)throw new Error("Failed to add notification");return a.json()}),bC=Pl({name:"notifications",initialState:{notifications:[],loading:!1,error:null},reducers:{markAsRead:(n,a)=>{const t=a.payload,r=n.notifications.find(s=>s.id===t);r&&(r.read=!0)},markAllAsRead:n=>{n.notifications.forEach(a=>{a.read=!0})}},extraReducers:n=>{n.addCase(u2.pending,a=>{a.loading=!0,a.error=null}).addCase(u2.fulfilled,(a,t)=>{a.loading=!1,a.notifications=t.payload}).addCase(u2.rejected,(a,t)=>{a.loading=!1,a.error=t.error.message}).addCase(M7.fulfilled,(a,t)=>{a.notifications.push(t.payload)})}}),{markAsRead:DG,markAllAsRead:TG}=bC.actions,I7=bC.reducer,Pm={Owner:{permissions:["all","students","classes","staff","fees","expenses","subsidies","reports","financial-reports","student-reports","settings","attendance","staff-attendance","marksheets","certificates","examinations"]},Admin:{permissions:["students","classes","staff","attendance","staff-attendance","marksheets","certificates","examinations","student-reports","reports"]},Teacher:{permissions:["marksheets","student-reports","reports"]},Staff:{permissions:["students","attendance","staff-attendance","marksheets","certificates","fees","examinations","student-reports","reports"]}},K2=[{id:"1",username:"owner",email:"owner@school.com",role:"Owner",permissions:Pm.Owner.permissions,lastLogin:"2023-10-05T14:30:00Z",loginHistory:[{id:"login-1",timestamp:"2023-10-05T14:30:00Z",status:"success",ip:"192.168.1.100"},{id:"login-2",timestamp:"2023-10-04T09:15:00Z",status:"success",ip:"192.168.1.100"},{id:"login-3",timestamp:"2023-10-03T16:45:00Z",status:"failed",ip:"192.168.1.101"}]},{id:"2",username:"admin",email:"admin@school.com",role:"Admin",permissions:Pm.Admin.permissions,lastLogin:"2023-10-05T14:30:00Z",loginHistory:[{id:"login-1",timestamp:"2023-10-05T14:30:00Z",status:"success",ip:"192.168.1.100"},{id:"login-2",timestamp:"2023-10-04T09:15:00Z",status:"success",ip:"192.168.1.100"},{id:"login-3",timestamp:"2023-10-03T16:45:00Z",status:"failed",ip:"192.168.1.101"}]},{id:"3",username:"teacher",email:"teacher@school.com",role:"Teacher",permissions:Pm.Teacher.permissions,lastLogin:"2023-10-05T08:45:00Z",loginHistory:[{id:"login-6",timestamp:"2023-10-05T08:45:00Z",status:"success",ip:"192.168.1.103"},{id:"login-7",timestamp:"2023-10-04T07:50:00Z",status:"success",ip:"192.168.1.103"}]},{id:"4",username:"staff",email:"staff@school.com",role:"Staff",permissions:Pm.Staff.permissions,lastLogin:"2023-10-05T10:20:00Z",loginHistory:[{id:"login-4",timestamp:"2023-10-05T10:20:00Z",status:"success",ip:"192.168.1.102"},{id:"login-5",timestamp:"2023-10-04T11:30:00Z",status:"success",ip:"192.168.1.102"}]}],O7={users:JSON.parse(JSON.stringify(K2)),currentUser:JSON.parse(localStorage.getItem("currentUser"))||null,loading:!1,error:null},dh=(n,a)=>{const t=n.users.currentUser;return t?t.role==="Owner"?!0:t.permissions?.includes(a)||t.permissions?.includes("all")||!1:!1},Q7=(n,a)=>n.users.currentUser?a.some(t=>dh(n,t)):!1,R7=(n,a)=>n.users.currentUser?a.every(t=>dh(n,t)):!1,P7=n=>n.users.currentUser?.role==="Owner"||!1,H7=n=>n.users.currentUser?.role==="Admin"||!1,z7=n=>n.users.currentUser?.role==="Teacher"||!1,K7=n=>n.users.currentUser?.role==="Staff"||!1,Fy=Ss("users/fetchUsers",async()=>(await new Promise(n=>setTimeout(n,500)),JSON.parse(JSON.stringify(K2)))),G7=Ss("users/addUser",async n=>{await new Promise(r=>setTimeout(r,500));let a=[];return Pm[n.role]&&(a=Pm[n.role].permissions),{id:Date.now().toString(),...n,permissions:a,loginHistory:[]}}),V7=Ss("users/updateUser",async n=>(await new Promise(a=>setTimeout(a,500)),n)),Y7=Ss("users/deleteUser",async n=>(await new Promise(a=>setTimeout(a,500)),n)),f2=Ss("users/loginUser",async({username:n,password:a},{rejectWithValue:t})=>{try{await new Promise(e=>setTimeout(e,500));let r=null;if(n==="owner"&&a==="owner123"||n==="admin"&&a==="admin123"||n==="teacher"&&a==="teacher123"||n==="staff"&&a==="staff123"){const e=K2.findIndex(u=>u.username===n);e!==-1&&(r=JSON.parse(JSON.stringify(K2[e])))}if(!r)throw new Error("Invalid credentials");r.lastLogin=new Date().toISOString();const s={id:`login-${Date.now()}`,timestamp:new Date().toISOString(),status:"success",ip:"192.168.1.100"};return r}catch(r){return t(r.message||"Login failed")}}),yC=Pl({name:"users",initialState:O7,reducers:{logout:n=>{n.currentUser=null,localStorage.removeItem("currentUser")},setCurrentUser:(n,a)=>{n.currentUser=a.payload,localStorage.setItem("currentUser",JSON.stringify(a.payload))}},extraReducers:n=>{n.addCase(Fy.pending,a=>{a.loading=!0,a.error=null}).addCase(Fy.fulfilled,(a,t)=>{a.loading=!1,a.users=t.payload}).addCase(Fy.rejected,(a,t)=>{a.loading=!1,a.error=t.error.message}).addCase(G7.fulfilled,(a,t)=>{a.users.push(JSON.parse(JSON.stringify(t.payload)))}).addCase(V7.fulfilled,(a,t)=>{const r=a.users.findIndex(s=>s.id===t.payload.id);r!==-1&&(a.users[r]=JSON.parse(JSON.stringify(t.payload)))}).addCase(Y7.fulfilled,(a,t)=>{a.users=a.users.filter(r=>r.id!==t.payload)}).addCase(f2.pending,a=>{a.loading=!0,a.error=null}).addCase(f2.fulfilled,(a,t)=>{a.loading=!1,a.currentUser=t.payload,localStorage.setItem("currentUser",JSON.stringify(t.payload));const r=a.users.findIndex(s=>s.id===t.payload.id);r!==-1&&(a.users[r]=JSON.parse(JSON.stringify(t.payload))),a.error=null}).addCase(f2.rejected,(a,t)=>{a.loading=!1,a.error=t.payload})}}),{logout:W7,setCurrentUser:$7}=yC.actions,q7=yC.reducer,X7={expenses:[],categories:["Stationary","Utilities","Salary","Maintenance"],loading:!1,error:null},O1=fs("expenses/fetchExpenses",async()=>{const n=await fetch(`${dr}/expenses`);if(!n.ok)throw new Error("Failed to fetch expenses");return await n.json()},{delay:500}),vC=e5("expenses/addExpense",async n=>{const t=new Date(n.date||new Date).getFullYear(),r=t+1,s=`${t}-${r}`,e={id:Date.now().toString(),...n,academicYear:s,addedTimestamp:new Date().toISOString()},u=await fetch(`${dr}/expenses`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!u.ok)throw new Error("Failed to add expense");return await u.json()},{successMessage:"Expense added successfully",errorMessage:"Failed to add expense",delay:500}),wC=t5("expenses/updateExpense",async n=>{const a=await fetch(`${dr}/expenses/${n.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!a.ok)throw new Error("Failed to update expense");return await a.json()},{successMessage:"Expense updated successfully",errorMessage:"Failed to update expense",delay:500}),NC=r5("expenses/deleteExpense",async n=>{if(!(await fetch(`${dr}/expenses/${n}`,{method:"DELETE"})).ok)throw new Error("Failed to delete expense");return n},{successMessage:"Expense deleted successfully",errorMessage:"Failed to delete expense",delay:500}),CC=fs("expenses/addCategory",async n=>n,{successMessage:"Category added successfully",errorMessage:"Failed to add category",delay:500}),J7=Pl({name:"expenses",initialState:X7,reducers:{},extraReducers:n=>{n.addCase(O1.pending,a=>{a.loading=!0,a.error=null}).addCase(O1.fulfilled,(a,t)=>{a.loading=!1,a.expenses=t.payload}).addCase(O1.rejected,(a,t)=>{a.loading=!1,a.error=t.error.message}).addCase(vC.fulfilled,(a,t)=>{a.expenses.push(t.payload)}).addCase(wC.fulfilled,(a,t)=>{const r=a.expenses.findIndex(s=>s.id===t.payload.id);r!==-1&&(a.expenses[r]=t.payload)}).addCase(NC.fulfilled,(a,t)=>{a.expenses=a.expenses.filter(r=>r.id!==t.payload)}).addCase(CC.fulfilled,(a,t)=>{const r=t.payload;a.categories.includes(r)||a.categories.push(r)})}}),Z7=J7.reducer,eE=async n=>{try{const a=await fetch(`${dr}staffAttendance&date=${n.date}`);let t=[];if(a.ok){const r=await a.json();Array.isArray(r)&&(t=r.map(s=>({...s,records:Array.isArray(s.records)?s.records:[]})))}if(t&&t.length>0){const r=t[0],s=await fetch(`${dr}staffAttendance/${r.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!s.ok)throw new Error("Failed to update staff attendance record");const e=await s.json();return{...e,records:Array.isArray(e.records)?e.records:[]}}else{const r=await fetch(`${dr}staffAttendance`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok)throw new Error("Failed to add staff attendance record");const s=await r.json();return{...s,records:Array.isArray(s.records)?s.records:[]}}}catch(a){throw console.error("Error adding staff attendance record:",a),a}},tE=async n=>{try{const a=await fetch(`${dr}staffAttendance&date=${n}`);if(!a.ok)throw new Error("Failed to fetch staff attendance by date");const t=await a.json();return Array.isArray(t)?t.map(r=>({...r,records:Array.isArray(r.records)?r.records:[]})):[]}catch(a){throw console.error("Error fetching staff attendance by date:",a),a}},rE=async(n,a,t)=>{try{const r=await fetch(`${dr}staffAttendance`);if(!r.ok)throw new Error("Failed to fetch staff attendance by date range");const s=await r.json(),e=[];return Array.isArray(s)&&s.forEach(u=>{if(u.date>=a&&u.date<=t){const m=(Array.isArray(u.records)?u.records:[]).find(g=>g.staffId===n);m&&e.push({date:u.date,status:m.status})}}),e}catch(r){throw console.error("Error fetching staff attendance by date range:",r),r}},aE={staff:[],attendanceRecords:[],loading:!1,error:null},uh=Ss("staff/fetchStaff",async()=>{const n=await fetch(`${dr}/staff`);if(!n.ok)throw new Error("Failed to fetch staff");return await n.json()}),jC=Ss("staff/fetchStaffAttendanceByDate",async n=>{try{const a=await fetch(`${dr}staffAttendance&date=${n}`);if(!a.ok)throw new Error("Failed to fetch staff attendance");return await a.json()}catch{return await new Promise(r=>setTimeout(r,500)),await tE(n)}}),BC=Ss("staff/addStaff",async n=>{const{id:a,...t}=n,r=await fetch(`${dr}/staff`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok)throw new Error("Failed to add staff");return await r.json()}),SC=Ss("staff/updateStaff",async n=>{const a=await fetch(`${dr}/staff/${n.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!a.ok)throw new Error("Failed to update staff");return await a.json()}),FC=Ss("staff/deleteStaff",async n=>{if(!(await fetch(`${dr}/staff/${n}`,{method:"DELETE"})).ok)throw new Error("Failed to delete staff");return n}),EC=Ss("staff/addStaffAdvance",async({staffId:n,advanceAmount:a,reason:t})=>{const r=await fetch(`${dr}/staff/${n}`);if(!r.ok)throw new Error("Failed to fetch staff member");const s=await r.json(),e={id:`advance-${n}-${Date.now()}`,month:new Date().toLocaleDateString("en-US",{month:"long",year:"numeric"}),baseSalary:0,allowances:0,deductions:parseFloat(a),netSalary:-parseFloat(a),status:"advance",paymentDate:new Date().toISOString().split("T")[0],reason:t||"Advance taken",paymentTimestamp:new Date().toISOString()},u={...s,salaryHistory:[...s.salaryHistory||[],e]},f=await fetch(`${dr}/staff/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!f.ok)throw new Error("Failed to add staff advance");return await f.json()}),kC=Ss("staff/payStaffSalary",async({staffId:n,month:a,paymentMethod:t})=>{const r=await fetch(`${dr}/staff/${n}`);if(!r.ok)throw new Error("Failed to fetch staff member");const s=await r.json();let e=(s.salaryHistory||[]).find(g=>g.month===a&&g.status!=="advance");if(e)e={...e,status:"paid",paymentDate:new Date().toISOString().split("T")[0],paymentMethod:t,paymentTimestamp:new Date().toISOString()};else{const g=(s.allowances||[]).reduce((F,C)=>F+parseFloat(C.amount||0),0),b=parseFloat(s.salary||0),j=b+g;e={id:`sal-${n}-${Date.now()}`,month:a,baseSalary:b,allowances:g,deductions:0,netSalary:j,status:"paid",paymentDate:new Date().toISOString().split("T")[0],paymentMethod:t,paymentTimestamp:new Date().toISOString()}}const u=[...s.salaryHistory||[]];if(e.id){const g=u.findIndex(b=>b.id===e.id);g!==-1?u[g]=e:u.push(e)}else u.push(e);const f={...s,salaryHistory:u},m=await fetch(`${dr}/staff/${n}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)});if(!m.ok)throw new Error("Failed to pay staff salary");return await m.json()}),DC=Ss("staff/addStaffAttendance",async({date:n,records:a})=>{try{const t=await fetch(`${dr}staffAttendance&date=${n}`);let r=[];if(t.ok){const e=await t.json();Array.isArray(e)&&(r=e.map(u=>({...u,records:Array.isArray(u.records)?u.records:[]})))}const s={date:n,records:a};if(r&&r.length>0){const e=r[0],u=await fetch(`${dr}/staffAttendance/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!u.ok)throw new Error("Failed to update staff attendance");const f=await u.json();return{...f,records:Array.isArray(f.records)?f.records:[]}}else{const e=await fetch(`${dr}/staffAttendance`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!e.ok)throw new Error("Failed to add staff attendance");const u=await e.json();return{...u,records:Array.isArray(u.records)?u.records:[]}}}catch{return await new Promise(r=>setTimeout(r,500)),await eE({date:n,records:a}),{date:n,records:a}}}),sE=Pl({name:"staff",initialState:aE,reducers:{},extraReducers:n=>{n.addCase(uh.pending,a=>{a.loading=!0,a.error=null}).addCase(uh.fulfilled,(a,t)=>{a.loading=!1,a.staff=t.payload.map(r=>({...r,attendance:Array.isArray(r.attendance)?r.attendance:[]}))}).addCase(uh.rejected,(a,t)=>{a.loading=!1,a.error=t.error.message}).addCase(jC.fulfilled,(a,t)=>{a.attendanceRecords=t.payload}).addCase(BC.fulfilled,(a,t)=>{a.staff.unshift({...t.payload,attendance:[]})}).addCase(SC.fulfilled,(a,t)=>{const r=a.staff.findIndex(s=>s.id===t.payload.id);r!==-1&&(a.staff[r]={...t.payload,attendance:Array.isArray(t.payload.attendance)?t.payload.attendance:[]})}).addCase(FC.fulfilled,(a,t)=>{a.staff=a.staff.filter(r=>r.id!==t.payload)}).addCase(EC.fulfilled,(a,t)=>{const r=t.payload,s=a.staff.findIndex(e=>e.id===r.id);s!==-1&&(a.staff[s]={...r,attendance:Array.isArray(r.attendance)?r.attendance:[]})}).addCase(kC.fulfilled,(a,t)=>{const r=t.payload,s=a.staff.findIndex(e=>e.id===r.id);s!==-1&&(a.staff[s]={...r,attendance:Array.isArray(r.attendance)?r.attendance:[]})}).addCase(DC.fulfilled,(a,t)=>{const{date:r,records:s}=t.payload;Array.isArray(s)&&s.forEach(u=>{const f=a.staff.find(m=>m.id===u.staffId);if(f){Array.isArray(f.attendance)||(f.attendance=[]);const m=f.attendance.findIndex(g=>g.date===r);m!==-1?f.attendance[m]={...f.attendance[m],status:u.status}:f.attendance.push({date:r,status:u.status})}});const e=a.attendanceRecords.findIndex(u=>u.date===r);e!==-1?a.attendanceRecords[e]={date:r,records:Array.isArray(s)?s:[]}:a.attendanceRecords.push({date:r,records:Array.isArray(s)?s:[]})})}}),nE=sE.reducer,iE={classes:[],loading:!1,error:null},gd=fs("classes/fetchClasses",async()=>{const n=await fetch(`${dr}/classes`);if(!n.ok)throw new Error("Failed to fetch classes");return await n.json()},{delay:500}),TC=e5("classes/addClass",async n=>{const a={id:Date.now().toString(),name:n.name,monthlyFees:n.monthlyFees||0,admissionFees:n.admissionFees||0,sections:n.sections||[]},t=await fetch(`${dr}/classes`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!t.ok)throw new Error("Failed to add class");return await t.json()},{successMessage:"Class added successfully",errorMessage:"Failed to add class",delay:500}),_C=t5("classes/updateClass",async n=>{const a={id:n.id,name:n.name,monthlyFees:n.monthlyFees||0,admissionFees:n.admissionFees||0,sections:n.sections||[]},t=await fetch(`${dr}/classes/${n.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!t.ok)throw new Error("Failed to update class");return await t.json()},{successMessage:"Class updated successfully",errorMessage:"Failed to update class",delay:500}),LC=r5("classes/deleteClass",async n=>{if(!(await fetch(`${dr}/classes/${n}`,{method:"DELETE"})).ok)throw new Error("Failed to delete class");return n},{successMessage:"Class deleted successfully",errorMessage:"Failed to delete class",delay:500}),UC=fs("classes/updateClassFees",async({classId:n,monthlyFees:a})=>({classId:n,monthlyFees:a}),{successMessage:"Class fees updated successfully",errorMessage:"Failed to update class fees",delay:500});fs("classes/addSectionToClass",async({classId:n,section:a})=>{const t={id:Date.now().toString(),class_id:n,name:a.name};if(!(await fetch(`${dr}/sections`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw new Error("Failed to add section to class");const s=await fetch(`${dr}/classes/${n}`);if(!s.ok)throw new Error("Failed to fetch updated class");return await s.json()},{successMessage:"Section added successfully",errorMessage:"Failed to add section",delay:500});fs("classes/removeSectionFromClass",async({classId:n,sectionId:a})=>{if(!(await fetch(`${dr}/sections/${a}`,{method:"DELETE"})).ok)throw new Error("Failed to remove section from class");const r=await fetch(`${dr}/classes/${n}`);if(!r.ok)throw new Error("Failed to fetch updated class");return await r.json()},{successMessage:"Section removed successfully",errorMessage:"Failed to remove section",delay:500});const MC=fs("classes/addSubjectToClass",async({classId:n,subject:a})=>{const t={id:Date.now().toString(),class_id:n,name:a.name,code:a.code||"",teacher_id:a.teacherId||null,maxMarks:a.maxMarks||100};if(!(await fetch(`${dr}/subjects`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw new Error("Failed to add subject to class");const s=await fetch(`${dr}/classes/${n}`);if(!s.ok)throw new Error("Failed to fetch updated class");return await s.json()},{successMessage:"Subject added successfully",errorMessage:"Failed to add subject",delay:500}),IC=fs("classes/removeSubjectFromClass",async({classId:n,subjectId:a})=>{if(!(await fetch(`${dr}/subjects/${a}`,{method:"DELETE"})).ok)throw new Error("Failed to remove subject from class");const r=await fetch(`${dr}/classes/${n}`);if(!r.ok)throw new Error("Failed to fetch updated class");return await r.json()},{successMessage:"Subject removed successfully",errorMessage:"Failed to remove subject",delay:500}),OC=fs("classes/updateSubjectInClass",async({classId:n,subjectId:a,updatedSubjectData:t})=>{const r={class_id:n,name:t.name,code:t.code||"",teacher_id:t.teacherId||null,maxMarks:t.maxMarks||100};if(!(await fetch(`${dr}/subjects/${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok)throw new Error("Failed to update subject in class");const e=await fetch(`${dr}/classes/${n}`);if(!e.ok)throw new Error("Failed to fetch updated class");return await e.json()},{successMessage:"Subject updated successfully",errorMessage:"Failed to update subject",delay:500}),oE=Pl({name:"classes",initialState:iE,reducers:{},extraReducers:n=>{n.addCase(gd.pending,a=>{a.loading=!0,a.error=null}).addCase(gd.fulfilled,(a,t)=>{a.loading=!1,a.classes=t.payload}).addCase(gd.rejected,(a,t)=>{a.loading=!1,a.error=t.error.message}).addCase(TC.fulfilled,(a,t)=>{a.classes.push(t.payload)}).addCase(_C.fulfilled,(a,t)=>{const r=a.classes.findIndex(s=>s.id===t.payload.id);r!==-1&&(a.classes[r]=t.payload)}).addCase(LC.fulfilled,(a,t)=>{a.classes=a.classes.filter(r=>r.id!==t.payload)}).addCase(UC.fulfilled,(a,t)=>{const{classId:r,monthlyFees:s}=t.payload,e=a.classes.find(u=>u.id===r);e&&(e.monthlyFees=s)}).addCase(MC.fulfilled,(a,t)=>{const r=t.payload,s=a.classes.findIndex(e=>e.id===r.id);s!==-1&&(a.classes[s]=r)}).addCase(IC.fulfilled,(a,t)=>{const r=t.payload,s=a.classes.findIndex(e=>e.id===r.id);s!==-1&&(a.classes[s]=r)}).addCase(OC.fulfilled,(a,t)=>{const r=t.payload,s=a.classes.findIndex(e=>e.id===r.id);s!==-1&&(a.classes[s]=r)})}}),lE=oE.reducer,cE={marks:[],loading:!1,error:null},qu=fs("marks/fetchMarks",async()=>{const n=await fetch(`${dr}/marks`);if(!n.ok)throw new Error("Failed to fetch marks");return await n.json()},{delay:500}),Jv=fs("marks/addMarks",async n=>{if(Array.isArray(n)){const r=[];for(const s of n){const e=await fetch(`${dr}/marks`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!e.ok)throw new Error("Failed to add marks");r.push(await e.json())}return r}if(n.marks&&Array.isArray(n.marks)){const r=[];for(const s of n.marks){const e={id:s.id||`${n.studentId}_${n.examType}_${s.subjectId||s.subjectName}`,studentId:n.studentId,studentName:n.studentName,class:n.class,section:n.section||"",examType:n.examType,examName:n.examType,subject:s.subjectName,subjectId:s.subjectId,marksObtained:s.marksObtained,totalMarks:s.totalMarks,grade:s.grade,academicYear:n.academicYear||new Date().getFullYear().toString(),year:n.year||new Date().getFullYear().toString()},u=await fetch(`${dr}/marks`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!u.ok)throw new Error("Failed to add marks");r.push(await u.json())}return r}const a={id:n.id||Date.now().toString(),...n},t=await fetch(`${dr}/marks`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!t.ok)throw new Error("Failed to add marks");return await t.json()},{successMessage:"Marks added successfully",errorMessage:"Failed to add marks",delay:500}),Zv=fs("marks/updateMarks",async n=>{if(Array.isArray(n)){const t=[];for(const r of n){const s=await fetch(`${dr}/marks/${r.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!s.ok)throw new Error("Failed to update marks");t.push(await s.json())}return t}if(n.marks&&Array.isArray(n.marks)){const t=[];for(const r of n.marks){const s={id:r.id||`${n.studentId}_${n.examType}_${r.subjectId||r.subjectName}`,studentId:n.studentId,studentName:n.studentName,class:n.class,section:n.section||"",examType:n.examType,examName:n.examType,subject:r.subjectName,subjectId:r.subjectId,marksObtained:r.marksObtained,totalMarks:r.totalMarks,grade:r.grade,academicYear:n.academicYear||new Date().getFullYear().toString(),year:n.year||new Date().getFullYear().toString()},e=await fetch(`${dr}/marks/${s.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!e.ok)throw new Error("Failed to update marks");t.push(await e.json())}return t}const a=await fetch(`${dr}/marks/${n.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!a.ok)throw new Error("Failed to update marks");return await a.json()},{successMessage:"Marks updated successfully",errorMessage:"Failed to update marks",delay:500}),QC=fs("marks/deleteMarks",async n=>{if(Array.isArray(n)){const t=[];for(const r of n){if(!(await fetch(`${dr}/marks/${r}`,{method:"DELETE"})).ok)throw new Error("Failed to delete marks");t.push(r)}return t}if(!(await fetch(`${dr}/marks/${n}`,{method:"DELETE"})).ok)throw new Error("Failed to delete marks");return n},{successMessage:"Marks deleted successfully",errorMessage:"Failed to delete marks",delay:500}),AE=Pl({name:"marks",initialState:cE,reducers:{},extraReducers:n=>{n.addCase(qu.pending,a=>{a.loading=!0,a.error=null}).addCase(qu.fulfilled,(a,t)=>{a.loading=!1,a.marks=p1(t.payload)}).addCase(qu.rejected,(a,t)=>{a.loading=!1,a.error=t.error.message}).addCase(Jv.fulfilled,(a,t)=>{if(Array.isArray(t.payload))p1(t.payload).forEach(s=>{const e=s.examId||s.examType,u=a.marks.findIndex(f=>f.studentId===s.studentId&&(f.examId===e||f.examType===e));u!==-1?a.marks[u]=s:a.marks.push(s)});else{const r=p1([t.payload]);if(r.length>0){const s=r[0],e=s.examId||s.examType,u=a.marks.findIndex(f=>f.studentId===s.studentId&&(f.examId===e||f.examType===e));u!==-1?a.marks[u]=s:a.marks.push(s)}}}).addCase(Zv.fulfilled,(a,t)=>{if(Array.isArray(t.payload))p1(t.payload).forEach(s=>{const e=s.examId||s.examType,u=a.marks.findIndex(f=>f.studentId===s.studentId&&(f.examId===e||f.examType===e));u!==-1?a.marks[u]=s:a.marks.push(s)});else{const r=p1([t.payload]);if(r.length>0){const s=r[0],e=s.examId||s.examType,u=a.marks.findIndex(f=>f.studentId===s.studentId&&(f.examId===e||f.examType===e));u!==-1?a.marks[u]=s:a.marks.push(s)}}}).addCase(QC.fulfilled,(a,t)=>{Array.isArray(t.payload)?t.payload.forEach(r=>{a.marks=a.marks.filter(s=>s.id!==r)}):a.marks=a.marks.filter(r=>r.id!==t.payload)})}});function p1(n){if(!Array.isArray(n)||n.length===0)return[];const a={};return n.forEach(t=>{if(!t.studentId||!t.examType&&!t.examId)return;const r=t.examId||t.examType,s=`${t.studentId}_${r}`;a[s]||(a[s]={id:t.id?.split("_")[0]||`${t.studentId}_${r}`,studentId:t.studentId,studentName:t.studentName,class:t.class,section:t.section||"",examId:t.examId,examType:t.examType,examName:t.examName||t.examType,year:t.year||new Date().getFullYear().toString(),marks:[],totalObtained:0,totalMarks:0,percentage:0,overallGrade:""}),a[s].marks.push({id:t.id,subjectId:t.subjectId,subjectName:t.subject,marksObtained:t.marksObtained||0,totalMarks:t.totalMarks||0,grade:t.grade||""})}),Object.values(a).forEach(t=>{let r=0,s=0;t.marks.forEach(u=>{r+=parseFloat(u.marksObtained)||0,s+=parseFloat(u.totalMarks)||0}),t.totalObtained=r,t.totalMarks=s,t.percentage=s>0?(r/s*100).toFixed(2):0;const e=parseFloat(t.percentage);e>=90?t.overallGrade="A+":e>=80?t.overallGrade="A":e>=70?t.overallGrade="B+":e>=60?t.overallGrade="B":e>=50?t.overallGrade="C":e>=40?t.overallGrade="D":t.overallGrade="F"}),Object.values(a)}const dE=AE.reducer,EA={level:"high",hasPG:!0,hasNursery:!0,hasKG:!0},s0=Ss("settings/fetchSchoolInfo",async(n,{rejectWithValue:a})=>{try{const t=await fetch(`${dr}/settings`);if(!t.ok)throw new Error("Failed to fetch school settings");const r=await t.json();return Array.isArray(r)&&r.length>0?r[0]:r}catch(t){return a(t.message||"Failed to fetch school information")}}),h2=Ss("settings/updateSchoolInfo",async(n,{getState:a,rejectWithValue:t})=>{try{const s=a().settings.schoolInfo?.id||"settings-1",e=await fetch(`${dr}/settings/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!e.ok){const f=await e.text();throw new Error(`Failed to update school settings: ${f}`)}return await e.json()}catch(r){return t(r.message||"Failed to update school information")}}),h4={schoolInfo:null,loading:!1,error:null},RC=Pl({name:"settings",initialState:h4,reducers:{clearError:n=>{n.error=null},resetSettings:()=>h4,setHolidays:(n,a)=>{n.schoolInfo&&(n.schoolInfo.holidays=a.payload)}},extraReducers:n=>{n.addCase(s0.pending,a=>{a.loading=!0,a.error=null}).addCase(s0.fulfilled,(a,t)=>{a.loading=!1,a.schoolInfo=t.payload}).addCase(s0.rejected,(a,t)=>{a.loading=!1,a.error=t.payload}).addCase(h2.pending,a=>{a.loading=!0,a.error=null}).addCase(h2.fulfilled,(a,t)=>{a.loading=!1,a.schoolInfo=t.payload}).addCase(h2.rejected,(a,t)=>{a.loading=!1,a.error=t.payload})}}),{clearError:_G,resetSettings:LG,setHolidays:UG}=RC.actions,uE=RC.reducer,fE={exams:[],loading:!1,error:null},Q1=fs("exams/fetchExams",async(n,{rejectWithValue:a})=>{try{const t=await fetch(`${dr}/exams`);if(!t.ok){const r=await t.text();throw new Error(`Failed to fetch examinations: ${t.status} ${t.statusText} - ${r}`)}return await t.json()}catch(t){return a(t.message||"Failed to fetch examinations")}},{errorMessage:"Failed to load examinations",successMessage:null,delay:0}),PC=fs("exams/addExam",async(n,{rejectWithValue:a})=>{try{const t=new Date().getFullYear(),r=t+1,s=`${t}-${r}`,e={...n,academicYear:s},u=await fetch(`${dr}/exams`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!u.ok)throw new Error("Failed to add examination");return await u.json()}catch(t){return a(t.message)}},{errorMessage:"Failed to add examination",successMessage:"Examination added successfully",delay:500}),HC=fs("exams/updateExam",async(n,{rejectWithValue:a})=>{try{const t=await fetch(`${dr}/exams/${n.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok)throw new Error("Failed to update examination");return await t.json()}catch(t){return a(t.message)}},{errorMessage:"Failed to update examination",successMessage:"Examination updated successfully",delay:500}),zC=fs("exams/deleteExam",async(n,{rejectWithValue:a})=>{try{if(!(await fetch(`${dr}/exams/${n}`,{method:"DELETE"})).ok)throw new Error("Failed to delete examination");return n}catch(t){return a(t.message)}},{errorMessage:"Failed to delete examination",successMessage:"Examination deleted successfully",delay:500}),hE=Pl({name:"exams",initialState:fE,reducers:{},extraReducers:n=>{n.addCase(Q1.pending,a=>{a.loading=!0,a.error=null}).addCase(Q1.fulfilled,(a,t)=>{a.loading=!1,a.exams=t.payload}).addCase(Q1.rejected,(a,t)=>{a.loading=!1,a.error=t.payload||t.error.message||"Failed to load examinations"}).addCase(PC.fulfilled,(a,t)=>{a.exams.push(t.payload)}).addCase(HC.fulfilled,(a,t)=>{const r=a.exams.findIndex(s=>s.id===t.payload.id);r!==-1&&(a.exams[r]=t.payload)}).addCase(zC.fulfilled,(a,t)=>{a.exams=a.exams.filter(r=>r.id!==t.payload)})}}),mE=hE.reducer,m2=Ss("subsidies/fetchSubsidies",async()=>{const n=await fetch(`${dr}/subsidies`);if(!n.ok)throw new Error("Failed to fetch subsidies");return await n.json()}),p2=Ss("subsidies/addSubsidy",async(n,{rejectWithValue:a})=>{try{const t=await fetch(`${dr}/subsidies`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok)throw new Error("Failed to add subsidy");return await t.json()}catch(t){return a(t.message||"Failed to add subsidy")}}),Ey=Ss("subsidies/updateSubsidy",async(n,{rejectWithValue:a})=>{try{const t=await fetch(`${dr}/subsidies/${n.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok)throw new Error("Failed to update subsidy");return await t.json()}catch(t){return a(t.message||"Failed to update subsidy")}}),pE={subsidies:[],loading:!1,error:null},gE=Pl({name:"subsidies",initialState:pE,reducers:{},extraReducers:n=>{n.addCase(m2.pending,a=>{a.loading=!0,a.error=null}).addCase(m2.fulfilled,(a,t)=>{a.loading=!1,a.subsidies=t.payload}).addCase(m2.rejected,(a,t)=>{a.loading=!1,a.error=t.error.message}).addCase(p2.pending,a=>{a.loading=!0,a.error=null}).addCase(p2.fulfilled,(a,t)=>{a.loading=!1,a.subsidies.push(t.payload)}).addCase(p2.rejected,(a,t)=>{a.loading=!1,a.error=t.payload}).addCase(Ey.pending,a=>{a.loading=!0,a.error=null}).addCase(Ey.fulfilled,(a,t)=>{a.loading=!1;const r=a.subsidies.findIndex(s=>s.id===t.payload.id);r!==-1&&(a.subsidies[r]=t.payload)}).addCase(Ey.rejected,(a,t)=>{a.loading=!1,a.error=t.payload})}}),xE=gE.reducer,bE=async()=>{try{const n=await fetch(`${dr}studentsAttendance`);if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);return await n.json()}catch(n){throw console.error("Error fetching attendance records:",n),n}},yE=async n=>{try{const a=new Date;a.setHours(0,0,0,0);const t=new Date(n.date);if(t.setHours(0,0,0,0),t>a)throw new Error("Cannot record attendance for future dates");const r=await fetch(`${dr}studentsAttendance&date=${n.date}&classId=${n.classId}`);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const s=await r.json();if(n.records.filter((u,f,m)=>m.findIndex(g=>g.studentId===u.studentId)!==f).length>0)throw new Error("Duplicate student records found in attendance data");if(s&&s.length>0){const u=s[0];if([...u.records.map(F=>F.studentId),...n.records.map(F=>F.studentId)].filter((F,C,M)=>M.indexOf(F)!==C).length>0)throw new Error("Duplicate student records found when updating attendance");const g={...u,records:[...u.records,...n.records]},b=await fetch(`${dr}studentsAttendance/${u.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)});if(!b.ok)throw new Error(`HTTP error! status: ${b.status}`);return await b.json()}else{const u=t.getFullYear(),f=u+1,m=`${u}-${f}`,g={...n,academicYear:m},b=await fetch(`${dr}studentsAttendance`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)});if(!b.ok)throw new Error(`HTTP error! status: ${b.status}`);return await b.json()}}catch(a){throw console.error("Error saving attendance record:",a),a}},vE=async n=>{try{const a=await fetch(`${dr}studentsAttendance/${n.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return await a.json()}catch(a){throw console.error("Error updating attendance record:",a),a}},wE=async(n,a)=>{try{console.log(`Fetching attendance for date=${n}, classId=${a}`);let t=`${dr}studentsAttendance&date=${n}`;a&&(t+=`&classId=${a}`);const r=await fetch(t);if(console.log("API Response status:",r.status),!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const s=await r.json();return console.log("API Response data:",s),s}catch(t){throw console.error("Error fetching attendance by date and class:",t),t}},NE=async n=>{try{const a=await fetch(`${dr}studentsAttendance`);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return(await a.json()).filter(s=>s.records.some(e=>e.studentId===n))}catch(a){throw console.error("Error fetching attendance by student:",a),a}},CE=async(n,a,t)=>{try{let r=`${dr}studentsAttendance?`;const s=await fetch(r);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);let e=await s.json();n&&a&&(e=e.filter(f=>f.date>=n&&f.date<=a)),t&&(e=e.filter(f=>f.classId===t));const u={totalDays:e.length,present:0,absent:0,late:0,leave:0};return e.forEach(f=>{f.records.forEach(m=>{switch(m.status){case"present":u.present++;break;case"absent":u.absent++;break;case"late":u.late++;break;case"leave":u.leave++;break}})}),{records:e,stats:u}}catch(r){throw console.error("Error generating attendance report:",r),r}},m4={attendanceRecords:[],loading:!1,error:null,selectedDate:new Date().toISOString().split("T")[0],selectedClass:""},g2=Ss("attendance/fetchAllAttendanceRecords",async(n,{rejectWithValue:a})=>{try{return await bE()}catch(t){return a(t.message||"Failed to fetch attendance records")}}),x2=Ss("attendance/addNewAttendanceRecord",async(n,{rejectWithValue:a})=>{try{return await yE(n)}catch(t){return a(t.message||"Failed to add attendance record")}}),ky=Ss("attendance/updateExistingAttendanceRecord",async(n,{rejectWithValue:a})=>{try{return await vE(n)}catch(t){return a(t.message||"Failed to update attendance record")}}),b2=Ss("attendance/fetchAttendanceByDateAndClass",async({date:n,classId:a},{rejectWithValue:t})=>{try{console.log(`API Call: Fetching attendance for date=${n}, classId=${a}`);const r=await wE(n,a);return console.log("API Response:",r),r}catch(r){return console.error("API Error:",r),t(r.message||"Failed to fetch attendance records")}}),Dy=Ss("attendance/fetchAttendanceByStudent",async(n,{rejectWithValue:a})=>{try{return await NE(n)}catch(t){return a(t.message||"Failed to fetch attendance records")}}),Ty=Ss("attendance/generateReport",async({startDate:n,endDate:a,classId:t},{rejectWithValue:r})=>{try{return await CE(n,a,t)}catch(s){return r(s.message||"Failed to generate attendance report")}}),KC=Pl({name:"attendance",initialState:m4,reducers:{clearError:n=>{n.error=null},resetAttendance:()=>m4,setSelectedDate:(n,a)=>{n.selectedDate=a.payload},setSelectedClass:(n,a)=>{n.selectedClass=a.payload}},extraReducers:n=>{n.addCase(g2.pending,a=>{a.loading=!0,a.error=null}).addCase(g2.fulfilled,(a,t)=>{a.loading=!1,a.attendanceRecords=t.payload}).addCase(g2.rejected,(a,t)=>{a.loading=!1,a.error=t.payload}).addCase(x2.pending,a=>{a.loading=!0,a.error=null}).addCase(x2.fulfilled,(a,t)=>{a.loading=!1;const r=a.attendanceRecords.findIndex(s=>s.date===t.payload.date&&s.classId===t.payload.classId);r!==-1?a.attendanceRecords[r]=t.payload:a.attendanceRecords.push(t.payload)}).addCase(x2.rejected,(a,t)=>{a.loading=!1,a.error=t.payload}).addCase(ky.pending,a=>{a.loading=!0,a.error=null}).addCase(ky.fulfilled,(a,t)=>{a.loading=!1;const r=a.attendanceRecords.findIndex(s=>s.id===t.payload.id);r!==-1&&(a.attendanceRecords[r]=t.payload)}).addCase(ky.rejected,(a,t)=>{a.loading=!1,a.error=t.payload}).addCase(b2.pending,a=>{a.loading=!0,a.error=null}).addCase(b2.fulfilled,(a,t)=>{a.loading=!1,console.log("API Response in Slice:",t.payload),a.attendanceRecords=t.payload}).addCase(b2.rejected,(a,t)=>{a.loading=!1,a.error=t.payload}).addCase(Dy.pending,a=>{a.loading=!0,a.error=null}).addCase(Dy.fulfilled,(a,t)=>{a.loading=!1,a.attendanceRecords=t.payload}).addCase(Dy.rejected,(a,t)=>{a.loading=!1,a.error=t.payload}).addCase(Ty.pending,a=>{a.loading=!0,a.error=null}).addCase(Ty.fulfilled,(a,t)=>{a.loading=!1}).addCase(Ty.rejected,(a,t)=>{a.loading=!1,a.error=t.payload})}}),{clearError:MG,resetAttendance:IG,setSelectedDate:OG,setSelectedClass:QG}=KC.actions,jE=KC.reducer,a5=n=>n.students,s5=PA([a5],n=>n.students);PA([a5],n=>n.loading);PA([a5],n=>n.error);PA([s5],n=>{if(!n||!Array.isArray(n))return{totalStudents:0,available:0,unavailable:0,left:0,families:0,feesCollected:0,pendingFees:0};const a=n.length,t=n.filter(g=>{const b=g.feesHistory&&g.feesHistory.some(C=>C.type==="monthly"),j=parseFloat(g.totalFees)||0,F=parseFloat(g.feesPaid)||0;return b?F>=j:!0}),r=n.filter(g=>{const b=g.feesHistory&&g.feesHistory.some(M=>M.type==="monthly"),j=parseFloat(g.totalFees)||0,F=parseFloat(g.feesPaid)||0,C=g.status==="left"||g.status==="passed_out"||g.class&&g.class.includes("Passed");return b?!C&&F<j:!1}),s=n.filter(g=>g.status==="left"||g.status==="passed_out"||g.class&&g.class.includes("Passed")||g.graduationDate&&new Date(g.graduationDate)<new Date),e={};n.forEach(g=>{const b=g.familyId||`unknown-${g.id}`;e[b]||(e[b]=[]),e[b].push(g)});const u=Object.keys(e).length,f=n.reduce((g,b)=>g+(parseFloat(b.feesPaid)||0),0),m=n.reduce((g,b)=>{const j=parseFloat(b.totalFees)||0,F=parseFloat(b.feesPaid)||0;return g+Math.max(0,j-F)},0);return{totalStudents:a,available:t.length,unavailable:r.length,left:s.length,families:u,feesCollected:f,pendingFees:m}});const hg=PA([s5],n=>{if(!n||!Array.isArray(n))return{available:[],unavailable:[],left:[],byClass:{},byFamily:{}};const a=n.reduce((s,e)=>(e.status==="left"||e.status==="passed_out"||e.class&&e.class.includes("Passed")||e.graduationDate&&new Date(e.graduationDate)<new Date?s.left.push(e):s.available.push(e),s),{available:[],unavailable:[],left:[]}),t=n.reduce((s,e)=>(s[e.class]||(s[e.class]=[]),s[e.class].push(e),s),{}),r=n.reduce((s,e)=>{const u=e.familyId||`unknown-${e.id}`;return s[u]||(s[u]=[]),s[u].push(e),s},{});return{...a,byClass:t,byFamily:r}}),BE=PA([s5,(n,a)=>a],(n,a)=>!n||!Array.isArray(n)||!a?null:n.find(t=>t.id===a)||null);PA([hg,(n,a)=>a],(n,a)=>a?n.byClass[a]||[]:[]);PA([hg,(n,a)=>a],(n,a)=>a?n.byFamily[a]||[]:[]);PA([hg],n=>n.available);PA([hg],n=>n.unavailable);PA([hg],n=>n.left);const p4={reports:[],currentReport:null,loading:!1,error:null,filters:{studentId:"",class:"",academicYear:"",startDate:"",endDate:"",reportType:"monthly",reportPeriod:""}},y2=Ss("reports/generateStudentReport",async(n,{getState:a,rejectWithValue:t})=>{try{const{studentId:r,startDate:s,endDate:e,class:u,academicYear:f,reportType:m}=n,g=a();let b=null;r?b=BE(g,r):u&&(b=null);const j=b&&b.academicHistory?b.academicHistory:[];let F=[],C=[];r&&(F=g.attendance.attendanceRecords.filter(O=>O.records.some(Q=>Q.studentId===r)&&O.date>=s&&O.date<=e&&(f?O.academicYear===f:!0)),C=F.flatMap(O=>new Date(O.date).getDay()===0?[]:O.records.filter(Z=>Z.studentId===r).map(Z=>({date:O.date,status:Z.status,classId:O.classId,academicYear:O.academicYear}))));let M=[],_=[];r&&(M=g.marks.marks.filter(O=>O.studentId===r&&(f?O.academicYear===f:!0)&&O.year>=new Date(s).getFullYear().toString()&&O.year<=new Date(e).getFullYear().toString()),_=M);const L=SE(F,r),T=GC(M);return{id:Date.now().toString(),studentId:r,studentName:b?`${b.firstName} ${b.lastName}`:"Class Report",grNo:b?b.grNo:"",class:b?b.class:u,section:b?b.section:"",academicYear:f||"All Years",generatedDate:new Date().toISOString().split("T")[0],period:{startDate:s,endDate:e,type:m},attendance:L,attendanceDetails:C,academicPerformance:T,academicPerformanceDetails:_,academicHistory:j,comments:"",behavior:""}}catch(r){return t(r.message||"Failed to generate student report")}}),_y=Ss("reports/generateClassReport",async(n,{getState:a,rejectWithValue:t})=>{try{const{className:r,academicYear:s,startDate:e,endDate:u,reportType:f}=n,m=a(),g=m.students.students.filter(L=>L.class===r&&(s?L.academicYear===s:!0));let b=m.attendance.attendanceRecords.filter(L=>L.classId===r&&L.date>=e&&L.date<=u&&(s?L.academicYear===s:!0));const j=b.flatMap(L=>new Date(L.date).getDay()===0?[]:L.records.map(H=>({date:L.date,studentId:H.studentId,status:H.status,classId:L.classId,academicYear:L.academicYear})));let F=m.marks.marks.filter(L=>L.class===r&&(s?L.academicYear===s:!0)&&L.year>=new Date(e).getFullYear().toString()&&L.year<=new Date(u).getFullYear().toString());const C=FE(b,g),M=EE(F);return{id:`class-report-${Date.now()}`,className:r,academicYear:s||"All Years",generatedDate:new Date().toISOString().split("T")[0],period:{startDate:e,endDate:u,type:f},studentCount:g.length,attendance:C,attendanceDetails:j,academicPerformance:M,comments:""}}catch(r){return t(r.message||"Failed to generate class report")}}),SE=(n,a)=>{if(!n||n.length===0)return{totalDays:0,present:0,absent:0,late:0,leave:0,percentage:0};let t=0,r=0,s=0,e=0;n.forEach(m=>{if(new Date(m.date).getDay()===0)return;const b=m.records.find(j=>j.studentId===a);if(b)switch(b.status){case"present":t++;break;case"absent":r++;break;case"late":s++;break;case"leave":e++;break}});const u=t+r+s+e,f=u>0?Math.round(t/u*100):0;return{totalDays:u,present:t,absent:r,late:s,leave:e,percentage:f}},FE=(n,a)=>{if(!n||n.length===0||!a||a.length===0)return{totalDays:0,present:0,absent:0,late:0,leave:0,percentage:0,studentAttendance:[]};const t=a.map(b=>({studentId:b.id,studentName:`${b.firstName} ${b.lastName}`,present:0,absent:0,late:0,leave:0,total:0,percentage:0}));let r=0;n.forEach(b=>{new Date(b.date).getDay()!==0&&(r++,t.forEach(F=>{const C=b.records.find(M=>M.studentId===F.studentId);if(C){switch(C.status){case"present":F.present++;break;case"absent":F.absent++;break;case"late":F.late++;break;case"leave":F.leave++;break}F.total++}}))}),t.forEach(b=>{b.percentage=b.total>0?Math.round(b.present/b.total*100):0});const s=t.reduce((b,j)=>b+j.present,0),e=t.reduce((b,j)=>b+j.absent,0),u=t.reduce((b,j)=>b+j.late,0),f=t.reduce((b,j)=>b+j.leave,0),m=s+e+u+f,g=m>0?Math.round(s/m*100):0;return{totalDays:r,present:s,absent:e,late:u,leave:f,percentage:g,studentAttendance:t}},GC=n=>{if(!n||n.length===0)return{subjects:[],overallPercentage:0,overallGrade:"",totalObtained:0,totalMarks:0};const a={};n.forEach(f=>{f.marks.forEach(m=>{a[m.subjectName]||(a[m.subjectName]={subjectName:m.subjectName,totalObtained:0,totalMarks:0,examCount:0}),a[m.subjectName].totalObtained+=m.marksObtained,a[m.subjectName].totalMarks+=m.totalMarks,a[m.subjectName].examCount++})});const t=Object.values(a).map(f=>{const m=f.totalObtained/f.examCount,g=f.totalMarks/f.examCount,b=g>0?m/g*100:0,j=G2(b);return{subjectName:f.subjectName,averageObtained:Math.round(m*100)/100,averageTotal:Math.round(g*100)/100,percentage:Math.round(b*100)/100,grade:j}}),r=t.reduce((f,m)=>f+m.averageObtained,0),s=t.reduce((f,m)=>f+m.averageTotal,0),e=s>0?r/s*100:0,u=G2(e);return{subjects:t,overallPercentage:Math.round(e*100)/100,overallGrade:u,totalObtained:Math.round(r*100)/100,totalMarks:Math.round(s*100)/100}},EE=n=>{if(!n||n.length===0)return{subjects:[],overallPercentage:0,overallGrade:"",totalObtained:0,totalMarks:0,studentPerformance:[]};const a={};n.forEach(g=>{a[g.studentId]||(a[g.studentId]={studentId:g.studentId,studentName:g.studentName,marks:[]}),a[g.studentId].marks.push(g)});const t=Object.values(a).map(g=>{const b=GC(g.marks);return{studentId:g.studentId,studentName:g.studentName,...b}}),r={};n.forEach(g=>{g.marks.forEach(b=>{r[b.subjectName]||(r[b.subjectName]={subjectName:b.subjectName,totalObtained:0,totalMarks:0,examCount:0}),r[b.subjectName].totalObtained+=b.marksObtained,r[b.subjectName].totalMarks+=b.totalMarks,r[b.subjectName].examCount++})});const s=Object.values(r).map(g=>{const b=g.totalObtained/g.examCount,j=g.totalMarks/g.examCount,F=j>0?b/j*100:0,C=G2(F);return{subjectName:g.subjectName,averageObtained:Math.round(b*100)/100,averageTotal:Math.round(j*100)/100,percentage:Math.round(F*100)/100,grade:C}}),e=s.reduce((g,b)=>g+b.averageObtained,0),u=s.reduce((g,b)=>g+b.averageTotal,0),f=u>0?e/u*100:0,m=G2(f);return{subjects:s,overallPercentage:Math.round(f*100)/100,overallGrade:m,totalObtained:Math.round(e*100)/100,totalMarks:Math.round(u*100)/100,studentPerformance:t}},G2=n=>n>=90?"A+":n>=80?"A":n>=70?"B+":n>=60?"B":n>=50?"C":n>=40?"D":"F",VC=Pl({name:"reports",initialState:p4,reducers:{clearError:n=>{n.error=null},resetReports:()=>p4,setFilters:(n,a)=>{n.filters={...n.filters,...a.payload}},updateCurrentReport:(n,a)=>{n.currentReport=a.payload},addComment:(n,a)=>{n.currentReport&&(n.currentReport.comments=a.payload)},addBehavioralAssessment:(n,a)=>{n.currentReport&&(n.currentReport.behavior=a.payload)}},extraReducers:n=>{n.addCase(y2.pending,a=>{a.loading=!0,a.error=null}).addCase(y2.fulfilled,(a,t)=>{a.loading=!1,a.currentReport=t.payload,a.reports.push(t.payload)}).addCase(y2.rejected,(a,t)=>{a.loading=!1,a.error=t.payload,Js.error(t.payload)}).addCase(_y.pending,a=>{a.loading=!0,a.error=null}).addCase(_y.fulfilled,(a,t)=>{a.loading=!1,a.currentReport=t.payload,a.reports.push(t.payload)}).addCase(_y.rejected,(a,t)=>{a.loading=!1,a.error=t.payload,Js.error(t.payload)})}}),{clearError:RG,resetReports:PG,setFilters:HG,updateCurrentReport:zG,addComment:kE,addBehavioralAssessment:DE}=VC.actions,TE=VC.reducer,_E=[{id:"parent-1",firstName:"Muhammad",lastName:"Khan",email:"muhammad.khan@email.com",phone:"+923001234567",address:"123 Main Street, Karachi, Sindh",relationship:"father",studentIds:["1","2"]},{id:"parent-2",firstName:"Usman",lastName:"Malik",email:"usman.malik@email.com",phone:"+923002345678",address:"789 Pine Road, Islamabad, Capital",relationship:"father",studentIds:["3"]},{id:"parent-3",firstName:"Tariq",lastName:"Javed",email:"tariq.javed@email.com",phone:"+923003456789",address:"321 Elm Street, Lahore, Punjab",relationship:"father",studentIds:["4"]},{id:"parent-4",firstName:"Hamid",lastName:"Raza",email:"hamid.raza@email.com",phone:"+923004567890",address:"654 Maple Avenue, Karachi, Sindh",relationship:"father",studentIds:["5"]},{id:"parent-5",firstName:"Asif",lastName:"Hussain",email:"asif.hussain@email.com",phone:"+923005678901",address:"987 Oak Road, Islamabad, Capital",relationship:"father",studentIds:["6"]},{id:"parent-6",firstName:"Irfan",lastName:"Qureshi",email:"irfan.qureshi@email.com",phone:"+923006789012",address:"147 Pine Street, Lahore, Punjab",relationship:"father",studentIds:["7"]},{id:"parent-7",firstName:"Farooq",lastName:"Sheikh",email:"farooq.sheikh@email.com",phone:"+923007890123",address:"258 Cedar Road, Karachi, Sindh",relationship:"father",studentIds:["8"]}],LE={parents:_E,loading:!1,error:null},YC=Pl({name:"parents",initialState:LE,reducers:{addParent:(n,a)=>{n.parents.push(a.payload)},updateParent:(n,a)=>{const t=n.parents.findIndex(r=>r.id===a.payload.id);t!==-1&&(n.parents[t]=a.payload)},deleteParent:(n,a)=>{n.parents=n.parents.filter(t=>t.id!==a.payload)}}}),{addParent:UE,updateParent:ME,deleteParent:KG}=YC.actions,IE=YC.reducer,OE=xF({reducer:{students:N7,alumni:E7,events:U7,notifications:I7,users:q7,expenses:Z7,staff:nE,classes:lE,marks:dE,settings:uE,exams:mE,subsidies:xE,reports:TE,attendance:jE,parents:IE}});/**
 * @remix-run/router v1.3.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Z1(){return Z1=Object.assign?Object.assign.bind():function(n){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Z1.apply(this,arguments)}var Jf;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Jf||(Jf={}));const g4="popstate";function QE(n){n===void 0&&(n={});function a(r,s){let{pathname:e,search:u,hash:f}=r.location;return ew("",{pathname:e,search:u,hash:f},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(r,s){return typeof s=="string"?s:eg(s)}return PE(a,t,null,n)}function No(n,a){if(n===!1||n===null||typeof n>"u")throw new Error(a)}function RE(){return Math.random().toString(36).substr(2,8)}function x4(n,a){return{usr:n.state,key:n.key,idx:a}}function ew(n,a,t,r){return t===void 0&&(t=null),Z1({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof a=="string"?Ap(a):a,{state:t,key:a&&a.key||r||RE()})}function eg(n){let{pathname:a="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(a+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(a+=r.charAt(0)==="#"?r:"#"+r),a}function Ap(n){let a={};if(n){let t=n.indexOf("#");t>=0&&(a.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(a.search=n.substr(r),n=n.substr(0,r)),n&&(a.pathname=n)}return a}function PE(n,a,t,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:e=!1}=r,u=s.history,f=Jf.Pop,m=null,g=b();g==null&&(g=0,u.replaceState(Z1({},u.state,{idx:g}),""));function b(){return(u.state||{idx:null}).idx}function j(){f=Jf.Pop;let L=b(),T=L==null?null:L-g;g=L,m&&m({action:f,location:_.location,delta:T})}function F(L,T){f=Jf.Push;let H=ew(_.location,L,T);g=b()+1;let O=x4(H,g),Q=_.createHref(H);try{u.pushState(O,"",Q)}catch{s.location.assign(Q)}e&&m&&m({action:f,location:_.location,delta:1})}function C(L,T){f=Jf.Replace;let H=ew(_.location,L,T);g=b();let O=x4(H,g),Q=_.createHref(H);u.replaceState(O,"",Q),e&&m&&m({action:f,location:_.location,delta:0})}function M(L){let T=s.location.origin!=="null"?s.location.origin:s.location.href,H=typeof L=="string"?L:eg(L);return No(T,"No window.location.(origin|href) available to create URL for href: "+H),new URL(H,T)}let _={get action(){return f},get location(){return n(s,u)},listen(L){if(m)throw new Error("A history only accepts one active listener");return s.addEventListener(g4,j),m=L,()=>{s.removeEventListener(g4,j),m=null}},createHref(L){return a(s,L)},createURL:M,encodeLocation(L){let T=M(L);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:F,replace:C,go(L){return u.go(L)}};return _}var b4;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(b4||(b4={}));function HE(n,a,t){t===void 0&&(t="/");let r=typeof a=="string"?Ap(a):a,s=qC(r.pathname||"/",t);if(s==null)return null;let e=WC(n);zE(e);let u=null;for(let f=0;u==null&&f<e.length;++f)u=JE(e[f],tk(s));return u}function WC(n,a,t,r){a===void 0&&(a=[]),t===void 0&&(t=[]),r===void 0&&(r="");let s=(e,u,f)=>{let m={relativePath:f===void 0?e.path||"":f,caseSensitive:e.caseSensitive===!0,childrenIndex:u,route:e};m.relativePath.startsWith("/")&&(No(m.relativePath.startsWith(r),'Absolute route path "'+m.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),m.relativePath=m.relativePath.slice(r.length));let g=n0([r,m.relativePath]),b=t.concat(m);e.children&&e.children.length>0&&(No(e.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+g+'".')),WC(e.children,a,b,g)),!(e.path==null&&!e.index)&&a.push({path:g,score:qE(g,e.index),routesMeta:b})};return n.forEach((e,u)=>{var f;if(e.path===""||!((f=e.path)!=null&&f.includes("?")))s(e,u);else for(let m of $C(e.path))s(e,u,m)}),a}function $C(n){let a=n.split("/");if(a.length===0)return[];let[t,...r]=a,s=t.endsWith("?"),e=t.replace(/\?$/,"");if(r.length===0)return s?[e,""]:[e];let u=$C(r.join("/")),f=[];return f.push(...u.map(m=>m===""?e:[e,m].join("/"))),s&&f.push(...u),f.map(m=>n.startsWith("/")&&m===""?"/":m)}function zE(n){n.sort((a,t)=>a.score!==t.score?t.score-a.score:XE(a.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const KE=/^:\w+$/,GE=3,VE=2,YE=1,WE=10,$E=-2,y4=n=>n==="*";function qE(n,a){let t=n.split("/"),r=t.length;return t.some(y4)&&(r+=$E),a&&(r+=VE),t.filter(s=>!y4(s)).reduce((s,e)=>s+(KE.test(e)?GE:e===""?YE:WE),r)}function XE(n,a){return n.length===a.length&&n.slice(0,-1).every((r,s)=>r===a[s])?n[n.length-1]-a[a.length-1]:0}function JE(n,a){let{routesMeta:t}=n,r={},s="/",e=[];for(let u=0;u<t.length;++u){let f=t[u],m=u===t.length-1,g=s==="/"?a:a.slice(s.length)||"/",b=ZE({path:f.relativePath,caseSensitive:f.caseSensitive,end:m},g);if(!b)return null;Object.assign(r,b.params);let j=f.route;e.push({params:r,pathname:n0([s,b.pathname]),pathnameBase:nk(n0([s,b.pathnameBase])),route:j}),b.pathnameBase!=="/"&&(s=n0([s,b.pathnameBase]))}return e}function ZE(n,a){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=ek(n.path,n.caseSensitive,n.end),s=a.match(t);if(!s)return null;let e=s[0],u=e.replace(/(.)\/+$/,"$1"),f=s.slice(1);return{params:r.reduce((g,b,j)=>{if(b==="*"){let F=f[j]||"";u=e.slice(0,e.length-F.length).replace(/(.)\/+$/,"$1")}return g[b]=rk(f[j]||"",b),g},{}),pathname:e,pathnameBase:u,pattern:n}}function ek(n,a,t){a===void 0&&(a=!1),t===void 0&&(t=!0),n5(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(u,f)=>(r.push(f),"/([^\\/]+)"));return n.endsWith("*")?(r.push("*"),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,a?void 0:"i"),r]}function tk(n){try{return decodeURI(n)}catch(a){return n5(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+a+").")),n}}function rk(n,a){try{return decodeURIComponent(n)}catch(t){return n5(!1,'The value for the URL param "'+a+'" will not be decoded because'+(' the string "'+n+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+t+").")),n}}function qC(n,a){if(a==="/")return n;if(!n.toLowerCase().startsWith(a.toLowerCase()))return null;let t=a.endsWith("/")?a.length-1:a.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function n5(n,a){if(!n){typeof console<"u"&&console.warn(a);try{throw new Error(a)}catch{}}}function ak(n,a){a===void 0&&(a="/");let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?Ap(n):n;return{pathname:t?t.startsWith("/")?t:sk(t,a):a,search:ik(r),hash:ok(s)}}function sk(n,a){let t=a.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function Ly(n,a,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+a+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function XC(n){return n.filter((a,t)=>t===0||a.route.path&&a.route.path.length>0)}function JC(n,a,t,r){r===void 0&&(r=!1);let s;typeof n=="string"?s=Ap(n):(s=Z1({},n),No(!s.pathname||!s.pathname.includes("?"),Ly("?","pathname","search",s)),No(!s.pathname||!s.pathname.includes("#"),Ly("#","pathname","hash",s)),No(!s.search||!s.search.includes("#"),Ly("#","search","hash",s)));let e=n===""||s.pathname==="",u=e?"/":s.pathname,f;if(r||u==null)f=t;else{let j=a.length-1;if(u.startsWith("..")){let F=u.split("/");for(;F[0]==="..";)F.shift(),j-=1;s.pathname=F.join("/")}f=j>=0?a[j]:"/"}let m=ak(s,f),g=u&&u!=="/"&&u.endsWith("/"),b=(e||u===".")&&t.endsWith("/");return!m.pathname.endsWith("/")&&(g||b)&&(m.pathname+="/"),m}const n0=n=>n.join("/").replace(/\/\/+/g,"/"),nk=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),ik=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,ok=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function lk(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const ZC=["post","put","patch","delete"];new Set(ZC);const ck=["get",...ZC];new Set(ck);/**
 * React Router v6.8.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function tw(){return tw=Object.assign?Object.assign.bind():function(n){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},tw.apply(this,arguments)}const ej=ne.createContext(null),i5=ne.createContext(null),Tb=ne.createContext(null),_b=ne.createContext(null),Sh=ne.createContext({outlet:null,matches:[]}),tj=ne.createContext(null);function Ak(n,a){let{relative:t}=a===void 0?{}:a;dp()||No(!1);let{basename:r,navigator:s}=ne.useContext(Tb),{hash:e,pathname:u,search:f}=rj(n,{relative:t}),m=u;return r!=="/"&&(m=u==="/"?r:n0([r,u])),s.createHref({pathname:m,search:f,hash:e})}function dp(){return ne.useContext(_b)!=null}function Fh(){return dp()||No(!1),ne.useContext(_b).location}function Cd(){dp()||No(!1);let{basename:n,navigator:a}=ne.useContext(Tb),{matches:t}=ne.useContext(Sh),{pathname:r}=Fh(),s=JSON.stringify(XC(t).map(f=>f.pathnameBase)),e=ne.useRef(!1);return ne.useEffect(()=>{e.current=!0}),ne.useCallback(function(f,m){if(m===void 0&&(m={}),!e.current)return;if(typeof f=="number"){a.go(f);return}let g=JC(f,JSON.parse(s),r,m.relative==="path");n!=="/"&&(g.pathname=g.pathname==="/"?n:n0([n,g.pathname])),(m.replace?a.replace:a.push)(g,m.state,m)},[n,a,s,r])}function dk(){let{matches:n}=ne.useContext(Sh),a=n[n.length-1];return a?a.params:{}}function rj(n,a){let{relative:t}=a===void 0?{}:a,{matches:r}=ne.useContext(Sh),{pathname:s}=Fh(),e=JSON.stringify(XC(r).map(u=>u.pathnameBase));return ne.useMemo(()=>JC(n,JSON.parse(e),s,t==="path"),[n,e,s,t])}function uk(n,a){dp()||No(!1);let{navigator:t}=ne.useContext(Tb),r=ne.useContext(i5),{matches:s}=ne.useContext(Sh),e=s[s.length-1],u=e?e.params:{};e&&e.pathname;let f=e?e.pathnameBase:"/";e&&e.route;let m=Fh(),g;if(a){var b;let _=typeof a=="string"?Ap(a):a;f==="/"||(b=_.pathname)!=null&&b.startsWith(f)||No(!1),g=_}else g=m;let j=g.pathname||"/",F=f==="/"?j:j.slice(f.length)||"/",C=HE(n,{pathname:F}),M=pk(C&&C.map(_=>Object.assign({},_,{params:Object.assign({},u,_.params),pathname:n0([f,t.encodeLocation?t.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?f:n0([f,t.encodeLocation?t.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),s,r||void 0);return a&&M?ne.createElement(_b.Provider,{value:{location:tw({pathname:"/",search:"",hash:"",state:null,key:"default"},g),navigationType:Jf.Pop}},M):M}function fk(){let n=yk(),a=lk(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return ne.createElement(ne.Fragment,null,ne.createElement("h2",null,"Unexpected Application Error!"),ne.createElement("h3",{style:{fontStyle:"italic"}},a),t?ne.createElement("pre",{style:s},t):null,null)}class hk extends ne.Component{constructor(a){super(a),this.state={location:a.location,error:a.error}}static getDerivedStateFromError(a){return{error:a}}static getDerivedStateFromProps(a,t){return t.location!==a.location?{error:a.error,location:a.location}:{error:a.error||t.error,location:t.location}}componentDidCatch(a,t){console.error("React Router caught the following error during render",a,t)}render(){return this.state.error?ne.createElement(Sh.Provider,{value:this.props.routeContext},ne.createElement(tj.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function mk(n){let{routeContext:a,match:t,children:r}=n,s=ne.useContext(ej);return s&&s.static&&s.staticContext&&t.route.errorElement&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),ne.createElement(Sh.Provider,{value:a},r)}function pk(n,a,t){if(a===void 0&&(a=[]),n==null)if(t!=null&&t.errors)n=t.matches;else return null;let r=n,s=t?.errors;if(s!=null){let e=r.findIndex(u=>u.route.id&&s?.[u.route.id]);e>=0||No(!1),r=r.slice(0,Math.min(r.length,e+1))}return r.reduceRight((e,u,f)=>{let m=u.route.id?s?.[u.route.id]:null,g=t?u.route.errorElement||ne.createElement(fk,null):null,b=a.concat(r.slice(0,f+1)),j=()=>ne.createElement(mk,{match:u,routeContext:{outlet:e,matches:b}},m?g:u.route.element!==void 0?u.route.element:e);return t&&(u.route.errorElement||f===0)?ne.createElement(hk,{location:t.location,component:g,error:m,children:j(),routeContext:{outlet:null,matches:b}}):j()},null)}var v4;(function(n){n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator"})(v4||(v4={}));var V2;(function(n){n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator"})(V2||(V2={}));function gk(n){let a=ne.useContext(i5);return a||No(!1),a}function xk(n){let a=ne.useContext(Sh);return a||No(!1),a}function bk(n){let a=xk(),t=a.matches[a.matches.length-1];return t.route.id||No(!1),t.route.id}function yk(){var n;let a=ne.useContext(tj),t=gk(V2.UseRouteError),r=bk(V2.UseRouteError);return a||((n=t.errors)==null?void 0:n[r])}function w4(n){let{to:a,replace:t,state:r,relative:s}=n;dp()||No(!1);let e=ne.useContext(i5),u=Cd();return ne.useEffect(()=>{e&&e.navigation.state!=="idle"||u(a,{replace:t,state:r,relative:s})}),null}function Ci(n){No(!1)}function vk(n){let{basename:a="/",children:t=null,location:r,navigationType:s=Jf.Pop,navigator:e,static:u=!1}=n;dp()&&No(!1);let f=a.replace(/^\/*/,"/"),m=ne.useMemo(()=>({basename:f,navigator:e,static:u}),[f,e,u]);typeof r=="string"&&(r=Ap(r));let{pathname:g="/",search:b="",hash:j="",state:F=null,key:C="default"}=r,M=ne.useMemo(()=>{let _=qC(g,f);return _==null?null:{pathname:_,search:b,hash:j,state:F,key:C}},[f,g,b,j,F,C]);return M==null?null:ne.createElement(Tb.Provider,{value:m},ne.createElement(_b.Provider,{children:t,value:{location:M,navigationType:s}}))}function wk(n){let{children:a,location:t}=n,r=ne.useContext(ej),s=r&&!a?r.router.routes:rw(a);return uk(s,t)}var N4;(function(n){n[n.pending=0]="pending",n[n.success=1]="success",n[n.error=2]="error"})(N4||(N4={}));new Promise(()=>{});function rw(n,a){a===void 0&&(a=[]);let t=[];return ne.Children.forEach(n,(r,s)=>{if(!ne.isValidElement(r))return;if(r.type===ne.Fragment){t.push.apply(t,rw(r.props.children,a));return}r.type!==Ci&&No(!1),!r.props.index||!r.props.children||No(!1);let e=[...a,s],u={id:r.props.id||e.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,hasErrorBoundary:r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle};r.props.children&&(u.children=rw(r.props.children,e)),t.push(u)}),t}/**
 * React Router DOM v6.8.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function aw(){return aw=Object.assign?Object.assign.bind():function(n){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},aw.apply(this,arguments)}function Nk(n,a){if(n==null)return{};var t={},r=Object.keys(n),s,e;for(e=0;e<r.length;e++)s=r[e],!(a.indexOf(s)>=0)&&(t[s]=n[s]);return t}function Ck(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function jk(n,a){return n.button===0&&(!a||a==="_self")&&!Ck(n)}const Bk=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"];function Sk(n){let{basename:a,children:t,window:r}=n,s=ne.useRef();s.current==null&&(s.current=QE({window:r,v5Compat:!0}));let e=s.current,[u,f]=ne.useState({action:e.action,location:e.location});return ne.useLayoutEffect(()=>e.listen(f),[e]),ne.createElement(vk,{basename:a,children:t,location:u.location,navigationType:u.action,navigator:e})}const Fk=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",C4=ne.forwardRef(function(a,t){let{onClick:r,relative:s,reloadDocument:e,replace:u,state:f,target:m,to:g,preventScrollReset:b}=a,j=Nk(a,Bk),F=typeof g=="string"?g:eg(g),C=/^[a-z+]+:\/\//i.test(F)||F.startsWith("//"),M=F,_=!1;if(Fk&&C){let O=new URL(window.location.href),Q=F.startsWith("//")?new URL(O.protocol+F):new URL(F);Q.origin===O.origin?M=Q.pathname+Q.search+Q.hash:_=!0}let L=Ak(M,{relative:s}),T=Ek(M,{replace:u,state:f,target:m,preventScrollReset:b,relative:s});function H(O){r&&r(O),O.defaultPrevented||T(O)}return ne.createElement("a",aw({},j,{href:C?F:L,onClick:_||e?r:H,ref:t,target:m}))});var j4;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmitImpl="useSubmitImpl",n.UseFetcher="useFetcher"})(j4||(j4={}));var B4;(function(n){n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(B4||(B4={}));function Ek(n,a){let{target:t,replace:r,state:s,preventScrollReset:e,relative:u}=a===void 0?{}:a,f=Cd(),m=Fh(),g=rj(n,{relative:u});return ne.useCallback(b=>{if(jk(b,t)){b.preventDefault();let j=r!==void 0?r:eg(m)===eg(g);f(n,{replace:j,state:s,preventScrollReset:e,relative:u})}},[m,f,g,r,s,t,n,e,u])}var aj={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},S4=At.createContext&&At.createContext(aj),kk=["attr","size","title"];function Dk(n,a){if(n==null)return{};var t=Tk(n,a),r,s;if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(n);for(s=0;s<e.length;s++)r=e[s],!(a.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}function Tk(n,a){if(n==null)return{};var t={};for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){if(a.indexOf(r)>=0)continue;t[r]=n[r]}return t}function Y2(){return Y2=Object.assign?Object.assign.bind():function(n){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Y2.apply(this,arguments)}function F4(n,a){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);a&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function W2(n){for(var a=1;a<arguments.length;a++){var t=arguments[a]!=null?arguments[a]:{};a%2?F4(Object(t),!0).forEach(function(r){_k(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):F4(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function _k(n,a,t){return a=Lk(a),a in n?Object.defineProperty(n,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[a]=t,n}function Lk(n){var a=Uk(n,"string");return typeof a=="symbol"?a:a+""}function Uk(n,a){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,a);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(n)}function sj(n){return n&&n.map((a,t)=>At.createElement(a.tag,W2({key:t},a.attr),sj(a.child)))}function Hr(n){return a=>At.createElement(Mk,Y2({attr:W2({},n.attr)},a),sj(n.child))}function Mk(n){var a=t=>{var{attr:r,size:s,title:e}=n,u=Dk(n,kk),f=s||t.size||"1em",m;return t.className&&(m=t.className),n.className&&(m=(m?m+" ":"")+n.className),At.createElement("svg",Y2({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,u,{className:m,style:W2(W2({color:n.color||t.color},t.style),n.style),height:f,width:f,xmlns:"http://www.w3.org/2000/svg"}),e&&At.createElement("title",null,e),n.children)};return S4!==void 0?At.createElement(S4.Consumer,null,t=>a(t)):a(aj)}function E4(n){return Hr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"},child:[]}]})(n)}function o5(n){return Hr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"},child:[]}]})(n)}function Ik(n){return Hr({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M256 336h-.02c0-16.18 1.34-8.73-85.05-181.51-17.65-35.29-68.19-35.36-85.87 0C-2.06 328.75.02 320.33.02 336H0c0 44.18 57.31 80 128 80s128-35.82 128-80zM128 176l72 144H56l72-144zm511.98 160c0-16.18 1.34-8.73-85.05-181.51-17.65-35.29-68.19-35.36-85.87 0-87.12 174.26-85.04 165.84-85.04 181.51H384c0 44.18 57.31 80 128 80s128-35.82 128-80h-.02zM440 320l72-144 72 144H440zm88 128H352V153.25c23.51-10.29 41.16-31.48 46.39-57.25H528c8.84 0 16-7.16 16-16V48c0-8.84-7.16-16-16-16H383.64C369.04 12.68 346.09 0 320 0s-49.04 12.68-63.64 32H112c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h129.61c5.23 25.76 22.87 46.96 46.39 57.25V448H112c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h416c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16z"},child:[]}]})(n)}function Ok(n){return Hr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 512c35.32 0 63.97-28.65 63.97-64H160.03c0 35.35 28.65 64 63.97 64zm215.39-149.71c-19.32-20.76-55.47-51.99-55.47-154.29 0-77.7-54.48-139.9-127.94-155.16V32c0-17.67-14.32-32-31.98-32s-31.98 14.33-31.98 32v20.84C118.56 68.1 64.08 130.3 64.08 208c0 102.3-36.15 133.53-55.47 154.29-6 6.45-8.66 14.16-8.61 21.71.11 16.4 12.98 32 32.1 32h383.8c19.12 0 32-15.6 32.1-32 .05-7.55-2.61-15.27-8.61-21.71z"},child:[]}]})(n)}function nc(n){return Hr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448 360V24c0-13.3-10.7-24-24-24H96C43 0 0 43 0 96v320c0 53 43 96 96 96h328c13.3 0 24-10.7 24-24v-16c0-7.5-3.5-14.3-8.9-18.7-4.2-15.4-4.2-59.3 0-74.7 5.4-4.3 8.9-11.1 8.9-18.6zM128 134c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm0 64c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm253.4 250H96c-17.7 0-32-14.3-32-32 0-17.6 14.4-32 32-32h285.4c-1.9 17.1-1.9 46.9 0 64z"},child:[]}]})(n)}function tg(n){return Hr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M320 336c0 8.84-7.16 16-16 16h-96c-8.84 0-16-7.16-16-16v-48H0v144c0 25.6 22.4 48 48 48h416c25.6 0 48-22.4 48-48V288H320v48zm144-208h-80V80c0-25.6-22.4-48-48-48H176c-25.6 0-48 22.4-48 48v48H48c-25.6 0-48 22.4-48 48v80h512v-80c0-25.6-22.4-48-48-48zm-144 0H192V96h128v32z"},child:[]}]})(n)}function Qk(n){return Hr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M436 480h-20V24c0-13.255-10.745-24-24-24H56C42.745 0 32 10.745 32 24v456H12c-6.627 0-12 5.373-12 12v20h448v-20c0-6.627-5.373-12-12-12zM128 76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76zm0 96c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40zm52 148h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12zm76 160h-64v-84c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v84zm64-172c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40z"},child:[]}]})(n)}function Rl(n){return Hr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V192H0v272zm320-196c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM192 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM64 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM400 64h-48V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H160V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H48C21.5 64 0 85.5 0 112v48h448v-48c0-26.5-21.5-48-48-48z"},child:[]}]})(n)}function xd(n){return Hr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M12 192h424c6.6 0 12 5.4 12 12v260c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V204c0-6.6 5.4-12 12-12zm436-44v-36c0-26.5-21.5-48-48-48h-48V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H160V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H48C21.5 64 0 85.5 0 112v36c0 6.6 5.4 12 12 12h424c6.6 0 12-5.4 12-12z"},child:[]}]})(n)}function ep(n){return Hr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M512 144v288c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V144c0-26.5 21.5-48 48-48h88l12.3-32.9c7-18.7 24.9-31.1 44.9-31.1h125.5c20 0 37.9 12.4 44.9 31.1L376 96h88c26.5 0 48 21.5 48 48zM376 288c0-66.2-53.8-120-120-120s-120 53.8-120 120 53.8 120 120 120 120-53.8 120-120zm-32 0c0 48.5-39.5 88-88 88s-88-39.5-88-88 39.5-88 88-88 88 39.5 88 88z"},child:[]}]})(n)}function rh(n){return Hr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M458.622 255.92l45.985-45.005c13.708-12.977 7.316-36.039-10.664-40.339l-62.65-15.99 17.661-62.015c4.991-17.838-11.829-34.663-29.661-29.671l-61.994 17.667-15.984-62.671C337.085.197 313.765-6.276 300.99 7.228L256 53.57 211.011 7.229c-12.63-13.351-36.047-7.234-40.325 10.668l-15.984 62.671-61.995-17.667C74.87 57.907 58.056 74.738 63.046 92.572l17.661 62.015-62.65 15.99C.069 174.878-6.31 197.944 7.392 210.915l45.985 45.005-45.985 45.004c-13.708 12.977-7.316 36.039 10.664 40.339l62.65 15.99-17.661 62.015c-4.991 17.838 11.829 34.663 29.661 29.671l61.994-17.667 15.984 62.671c4.439 18.575 27.696 24.018 40.325 10.668L256 458.61l44.989 46.001c12.5 13.488 35.987 7.486 40.325-10.668l15.984-62.671 61.994 17.667c17.836 4.994 34.651-11.837 29.661-29.671l-17.661-62.015 62.65-15.99c17.987-4.302 24.366-27.367 10.664-40.339l-45.984-45.004z"},child:[]}]})(n)}function up(n){return Hr({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M208 352c-2.39 0-4.78.35-7.06 1.09C187.98 357.3 174.35 360 160 360c-14.35 0-27.98-2.7-40.95-6.91-2.28-.74-4.66-1.09-7.05-1.09C49.94 352-.33 402.48 0 464.62.14 490.88 21.73 512 48 512h224c26.27 0 47.86-21.12 48-47.38.33-62.14-49.94-112.62-112-112.62zm-48-32c53.02 0 96-42.98 96-96s-42.98-96-96-96-96 42.98-96 96 42.98 96 96 96zM592 0H208c-26.47 0-48 22.25-48 49.59V96c23.42 0 45.1 6.78 64 17.8V64h352v288h-64v-64H384v64h-76.24c19.1 16.69 33.12 38.73 39.69 64H592c26.47 0 48-22.25 48-49.59V49.59C640 22.25 618.47 0 592 0z"},child:[]}]})(n)}function wh(n){return Hr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M332.8 320h38.4c6.4 0 12.8-6.4 12.8-12.8V172.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v134.4c0 6.4 6.4 12.8 12.8 12.8zm96 0h38.4c6.4 0 12.8-6.4 12.8-12.8V76.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v230.4c0 6.4 6.4 12.8 12.8 12.8zm-288 0h38.4c6.4 0 12.8-6.4 12.8-12.8v-70.4c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v70.4c0 6.4 6.4 12.8 12.8 12.8zm96 0h38.4c6.4 0 12.8-6.4 12.8-12.8V108.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v198.4c0 6.4 6.4 12.8 12.8 12.8zM496 384H64V80c0-8.84-7.16-16-16-16H16C7.16 64 0 71.16 0 80v336c0 17.67 14.33 32 32 32h464c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16z"},child:[]}]})(n)}function i0(n){return Hr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M496 384H64V80c0-8.84-7.16-16-16-16H16C7.16 64 0 71.16 0 80v336c0 17.67 14.33 32 32 32h464c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16zM464 96H345.94c-21.38 0-32.09 25.85-16.97 40.97l32.4 32.4L288 242.75l-73.37-73.37c-12.5-12.5-32.76-12.5-45.25 0l-68.69 68.69c-6.25 6.25-6.25 16.38 0 22.63l22.62 22.62c6.25 6.25 16.38 6.25 22.63 0L192 237.25l73.37 73.37c12.5 12.5 32.76 12.5 45.25 0l96-96 32.4 32.4c15.12 15.12 40.97 4.41 40.97-16.97V112c.01-8.84-7.15-16-15.99-16z"},child:[]}]})(n)}function Rk(n){return Hr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"},child:[]}]})(n)}function nf(n){return Hr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"},child:[]}]})(n)}function Lb(n){return Hr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"},child:[]}]})(n)}function l5(n){return Hr({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"},child:[]}]})(n)}function c5(n){return Hr({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"},child:[]}]})(n)}function A5(n){return Hr({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM96 424c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm96-192c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm128 368c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16z"},child:[]}]})(n)}function Pk(n){return Hr({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M384 112v352c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h80c0-35.29 28.71-64 64-64s64 28.71 64 64h80c26.51 0 48 21.49 48 48zM192 40c-13.255 0-24 10.745-24 24s10.745 24 24 24 24-10.745 24-24-10.745-24-24-24m96 114v-20a6 6 0 0 0-6-6H102a6 6 0 0 0-6 6v20a6 6 0 0 0 6 6h180a6 6 0 0 0 6-6z"},child:[]}]})(n)}function eu(n){return Hr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"},child:[]}]})(n)}function nj(n){return Hr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(n)}function Hk(n){return Hr({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M512.1 191l-8.2 14.3c-3 5.3-9.4 7.5-15.1 5.4-11.8-4.4-22.6-10.7-32.1-18.6-4.6-3.8-5.8-10.5-2.8-15.7l8.2-14.3c-6.9-8-12.3-17.3-15.9-27.4h-16.5c-6 0-11.2-4.3-12.2-10.3-2-12-2.1-24.6 0-37.1 1-6 6.2-10.4 12.2-10.4h16.5c3.6-10.1 9-19.4 15.9-27.4l-8.2-14.3c-3-5.2-1.9-11.9 2.8-15.7 9.5-7.9 20.4-14.2 32.1-18.6 5.7-2.1 12.1.1 15.1 5.4l8.2 14.3c10.5-1.9 21.2-1.9 31.7 0L552 6.3c3-5.3 9.4-7.5 15.1-5.4 11.8 4.4 22.6 10.7 32.1 18.6 4.6 3.8 5.8 10.5 2.8 15.7l-8.2 14.3c6.9 8 12.3 17.3 15.9 27.4h16.5c6 0 11.2 4.3 12.2 10.3 2 12 2.1 24.6 0 37.1-1 6-6.2 10.4-12.2 10.4h-16.5c-3.6 10.1-9 19.4-15.9 27.4l8.2 14.3c3 5.2 1.9 11.9-2.8 15.7-9.5 7.9-20.4 14.2-32.1 18.6-5.7 2.1-12.1-.1-15.1-5.4l-8.2-14.3c-10.4 1.9-21.2 1.9-31.7 0zm-10.5-58.8c38.5 29.6 82.4-14.3 52.8-52.8-38.5-29.7-82.4 14.3-52.8 52.8zM386.3 286.1l33.7 16.8c10.1 5.8 14.5 18.1 10.5 29.1-8.9 24.2-26.4 46.4-42.6 65.8-7.4 8.9-20.2 11.1-30.3 5.3l-29.1-16.8c-16 13.7-34.6 24.6-54.9 31.7v33.6c0 11.6-8.3 21.6-19.7 23.6-24.6 4.2-50.4 4.4-75.9 0-11.5-2-20-11.9-20-23.6V418c-20.3-7.2-38.9-18-54.9-31.7L74 403c-10 5.8-22.9 3.6-30.3-5.3-16.2-19.4-33.3-41.6-42.2-65.7-4-10.9.4-23.2 10.5-29.1l33.3-16.8c-3.9-20.9-3.9-42.4 0-63.4L12 205.8c-10.1-5.8-14.6-18.1-10.5-29 8.9-24.2 26-46.4 42.2-65.8 7.4-8.9 20.2-11.1 30.3-5.3l29.1 16.8c16-13.7 34.6-24.6 54.9-31.7V57.1c0-11.5 8.2-21.5 19.6-23.5 24.6-4.2 50.5-4.4 76-.1 11.5 2 20 11.9 20 23.6v33.6c20.3 7.2 38.9 18 54.9 31.7l29.1-16.8c10-5.8 22.9-3.6 30.3 5.3 16.2 19.4 33.2 41.6 42.1 65.8 4 10.9.1 23.2-10 29.1l-33.7 16.8c3.9 21 3.9 42.5 0 63.5zm-117.6 21.1c59.2-77-28.7-164.9-105.7-105.7-59.2 77 28.7 164.9 105.7 105.7zm243.4 182.7l-8.2 14.3c-3 5.3-9.4 7.5-15.1 5.4-11.8-4.4-22.6-10.7-32.1-18.6-4.6-3.8-5.8-10.5-2.8-15.7l8.2-14.3c-6.9-8-12.3-17.3-15.9-27.4h-16.5c-6 0-11.2-4.3-12.2-10.3-2-12-2.1-24.6 0-37.1 1-6 6.2-10.4 12.2-10.4h16.5c3.6-10.1 9-19.4 15.9-27.4l-8.2-14.3c-3-5.2-1.9-11.9 2.8-15.7 9.5-7.9 20.4-14.2 32.1-18.6 5.7-2.1 12.1.1 15.1 5.4l8.2 14.3c10.5-1.9 21.2-1.9 31.7 0l8.2-14.3c3-5.3 9.4-7.5 15.1-5.4 11.8 4.4 22.6 10.7 32.1 18.6 4.6 3.8 5.8 10.5 2.8 15.7l-8.2 14.3c6.9 8 12.3 17.3 15.9 27.4h16.5c6 0 11.2 4.3 12.2 10.3 2 12 2.1 24.6 0 37.1-1 6-6.2 10.4-12.2 10.4h-16.5c-3.6 10.1-9 19.4-15.9 27.4l8.2 14.3c3 5.2 1.9 11.9-2.8 15.7-9.5 7.9-20.4 14.2-32.1 18.6-5.7 2.1-12.1-.1-15.1-5.4l-8.2-14.3c-10.4 1.9-21.2 1.9-31.7 0zM501.6 431c38.5 29.6 82.4-14.3 52.8-52.8-38.5-29.6-82.4 14.3-52.8 52.8z"},child:[]}]})(n)}function Co(n){return Hr({attr:{viewBox:"0 0 288 512"},child:[{tag:"path",attr:{d:"M209.2 233.4l-108-31.6C88.7 198.2 80 186.5 80 173.5c0-16.3 13.2-29.5 29.5-29.5h66.3c12.2 0 24.2 3.7 34.2 10.5 6.1 4.1 14.3 3.1 19.5-2l34.8-34c7.1-6.9 6.1-18.4-1.8-24.5C238 74.8 207.4 64.1 176 64V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48h-2.5C45.8 64-5.4 118.7.5 183.6c4.2 46.1 39.4 83.6 83.8 96.6l102.5 30c12.5 3.7 21.2 15.3 21.2 28.3 0 16.3-13.2 29.5-29.5 29.5h-66.3C100 368 88 364.3 78 357.5c-6.1-4.1-14.3-3.1-19.5 2l-34.8 34c-7.1 6.9-6.1 18.4 1.8 24.5 24.5 19.2 55.1 29.9 86.5 30v48c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-48.2c46.6-.9 90.3-28.6 105.7-72.7 21.5-61.6-14.6-124.8-72.5-141.7z"},child:[]}]})(n)}function Nx(n){return Hr({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M624 448h-80V113.45C544 86.19 522.47 64 496 64H384v64h96v384h144c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16zM312.24 1.01l-192 49.74C105.99 54.44 96 67.7 96 82.92V448H16c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h336V33.18c0-21.58-19.56-37.41-39.76-32.17zM264 288c-13.25 0-24-14.33-24-32s10.75-32 24-32 24 14.33 24 32-10.75 32-24 32z"},child:[]}]})(n)}function lu(n){return Hr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(n)}function IA(n){return Hr({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(n)}function zk(n){return Hr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(n)}function d5(n){return Hr({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(n)}function Kk(n){return Hr({attr:{viewBox:"0 0 192 512"},child:[{tag:"path",attr:{d:"M176 432c0 44.112-35.888 80-80 80s-80-35.888-80-80 35.888-80 80-80 80 35.888 80 80zM25.26 25.199l13.6 272C39.499 309.972 50.041 320 62.83 320h66.34c12.789 0 23.331-10.028 23.97-22.801l13.6-272C167.425 11.49 156.496 0 142.77 0H49.23C35.504 0 24.575 11.49 25.26 25.199z"},child:[]}]})(n)}function rg(n){return Hr({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"},child:[]}]})(n)}function Gk(n){return Hr({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm64 236c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-64c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-72v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm96-114.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"},child:[]}]})(n)}function Vk(n){return Hr({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M288 256H96v64h192v-64zm89-151L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-153 31V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zM64 72c0-4.42 3.58-8 8-8h80c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8H72c-4.42 0-8-3.58-8-8V72zm0 64c0-4.42 3.58-8 8-8h80c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8H72c-4.42 0-8-3.58-8-8v-16zm256 304c0 4.42-3.58 8-8 8h-80c-4.42 0-8-3.58-8-8v-16c0-4.42 3.58-8 8-8h80c4.42 0 8 3.58 8 8v16zm0-200v96c0 8.84-7.16 16-16 16H80c-8.84 0-16-7.16-16-16v-96c0-8.84 7.16-16 16-16h224c8.84 0 16 7.16 16 16z"},child:[]}]})(n)}function Yk(n){return Hr({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M181.9 256.1c-5-16-4.9-46.9-2-46.9 8.4 0 7.6 36.9 2 46.9zm-1.7 47.2c-7.7 20.2-17.3 43.3-28.4 62.7 18.3-7 39-17.2 62.9-21.9-12.7-9.6-24.9-23.4-34.5-40.8zM86.1 428.1c0 .8 13.2-5.4 34.9-40.2-6.7 6.3-29.1 24.5-34.9 40.2zM248 160h136v328c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V24C0 10.7 10.7 0 24 0h200v136c0 13.2 10.8 24 24 24zm-8 171.8c-20-12.2-33.3-29-42.7-53.8 4.5-18.5 11.6-46.6 6.2-64.2-4.7-29.4-42.4-26.5-47.8-6.8-5 18.3-.4 44.1 8.1 77-11.6 27.6-28.7 64.6-40.8 85.8-.1 0-.1.1-.2.1-27.1 13.9-73.6 44.5-54.5 68 5.6 6.9 16 10 21.5 10 17.9 0 35.7-18 61.1-61.8 25.8-8.5 54.1-19.1 79-23.2 21.7 11.8 47.1 19.5 64 19.5 29.2 0 31.2-32 19.7-43.4-13.9-13.6-54.3-9.7-73.6-7.2zM377 105L279 7c-4.5-4.5-10.6-7-17-7h-6v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-74.1 255.3c4.1-2.7-2.5-11.9-42.8-9 37.1 15.8 42.8 9 42.8 9z"},child:[]}]})(n)}function io(n){return Hr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.976 0H24.028C2.71 0-8.047 25.866 7.058 40.971L192 225.941V432c0 7.831 3.821 15.17 10.237 19.662l80 55.98C298.02 518.69 320 507.493 320 487.98V225.941l184.947-184.97C520.021 25.896 509.338 0 487.976 0z"},child:[]}]})(n)}function OA(n){return Hr({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M622.34 153.2L343.4 67.5c-15.2-4.67-31.6-4.67-46.79 0L17.66 153.2c-23.54 7.23-23.54 38.36 0 45.59l48.63 14.94c-10.67 13.19-17.23 29.28-17.88 46.9C38.78 266.15 32 276.11 32 288c0 10.78 5.68 19.85 13.86 25.65L20.33 428.53C18.11 438.52 25.71 448 35.94 448h56.11c10.24 0 17.84-9.48 15.62-19.47L82.14 313.65C90.32 307.85 96 298.78 96 288c0-11.57-6.47-21.25-15.66-26.87.76-15.02 8.44-28.3 20.69-36.72L296.6 284.5c9.06 2.78 26.44 6.25 46.79 0l278.95-85.7c23.55-7.24 23.55-38.36 0-45.6zM352.79 315.09c-28.53 8.76-52.84 3.92-65.59 0l-145.02-44.55L128 384c0 35.35 85.96 64 192 64s192-28.65 192-64l-14.18-113.47-145.03 44.56z"},child:[]}]})(n)}function u5(n){return Hr({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M271.06,144.3l54.27,14.3a8.59,8.59,0,0,1,6.63,8.1c0,4.6-4.09,8.4-9.12,8.4h-35.6a30,30,0,0,1-11.19-2.2c-5.24-2.2-11.28-1.7-15.3,2l-19,17.5a11.68,11.68,0,0,0-2.25,2.66,11.42,11.42,0,0,0,3.88,15.74,83.77,83.77,0,0,0,34.51,11.5V240c0,8.8,7.83,16,17.37,16h17.37c9.55,0,17.38-7.2,17.38-16V222.4c32.93-3.6,57.84-31,53.5-63-3.15-23-22.46-41.3-46.56-47.7L282.68,97.4a8.59,8.59,0,0,1-6.63-8.1c0-4.6,4.09-8.4,9.12-8.4h35.6A30,30,0,0,1,332,83.1c5.23,2.2,11.28,1.7,15.3-2l19-17.5A11.31,11.31,0,0,0,368.47,61a11.43,11.43,0,0,0-3.84-15.78,83.82,83.82,0,0,0-34.52-11.5V16c0-8.8-7.82-16-17.37-16H295.37C285.82,0,278,7.2,278,16V33.6c-32.89,3.6-57.85,31-53.51,63C227.63,119.6,247,137.9,271.06,144.3ZM565.27,328.1c-11.8-10.7-30.2-10-42.6,0L430.27,402a63.64,63.64,0,0,1-40,14H272a16,16,0,0,1,0-32h78.29c15.9,0,30.71-10.9,33.25-26.6a31.2,31.2,0,0,0,.46-5.46A32,32,0,0,0,352,320H192a117.66,117.66,0,0,0-74.1,26.29L71.4,384H16A16,16,0,0,0,0,400v96a16,16,0,0,0,16,16H372.77a64,64,0,0,0,40-14L564,377a32,32,0,0,0,1.28-48.9Z"},child:[]}]})(n)}function sw(n){return Hr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"},child:[]}]})(n)}function f5(n){return Hr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M80 368H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm0-320H16A16 16 0 0 0 0 64v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16V64a16 16 0 0 0-16-16zm0 160H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm416 176H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z"},child:[]}]})(n)}function Wk(n){return Hr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M400 224h-24v-72C376 68.2 307.8 0 224 0S72 68.2 72 152v72H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48zm-104 0H152v-72c0-39.7 32.3-72 72-72s72 32.3 72 72v72z"},child:[]}]})(n)}function $2(n){return Hr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M223.75 130.75L154.62 15.54A31.997 31.997 0 0 0 127.18 0H16.03C3.08 0-4.5 14.57 2.92 25.18l111.27 158.96c29.72-27.77 67.52-46.83 109.56-53.39zM495.97 0H384.82c-11.24 0-21.66 5.9-27.44 15.54l-69.13 115.21c42.04 6.56 79.84 25.62 109.56 53.38L509.08 25.18C516.5 14.57 508.92 0 495.97 0zM256 160c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm92.52 157.26l-37.93 36.96 8.97 52.22c1.6 9.36-8.26 16.51-16.65 12.09L256 393.88l-46.9 24.65c-8.4 4.45-18.25-2.74-16.65-12.09l8.97-52.22-37.93-36.96c-6.82-6.64-3.05-18.23 6.35-19.59l52.43-7.64 23.43-47.52c2.11-4.28 6.19-6.39 10.28-6.39 4.11 0 8.22 2.14 10.33 6.39l23.43 47.52 52.43 7.64c9.4 1.36 13.17 12.95 6.35 19.59z"},child:[]}]})(n)}function bd(n){return Hr({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M621.16 54.46C582.37 38.19 543.55 32 504.75 32c-123.17-.01-246.33 62.34-369.5 62.34-30.89 0-61.76-3.92-92.65-13.72-3.47-1.1-6.95-1.62-10.35-1.62C15.04 79 0 92.32 0 110.81v317.26c0 12.63 7.23 24.6 18.84 29.46C57.63 473.81 96.45 480 135.25 480c123.17 0 246.34-62.35 369.51-62.35 30.89 0 61.76 3.92 92.65 13.72 3.47 1.1 6.95 1.62 10.35 1.62 17.21 0 32.25-13.32 32.25-31.81V83.93c-.01-12.64-7.24-24.6-18.85-29.47zM48 132.22c20.12 5.04 41.12 7.57 62.72 8.93C104.84 170.54 79 192.69 48 192.69v-60.47zm0 285v-47.78c34.37 0 62.18 27.27 63.71 61.4-22.53-1.81-43.59-6.31-63.71-13.62zM320 352c-44.19 0-80-42.99-80-96 0-53.02 35.82-96 80-96s80 42.98 80 96c0 53.03-35.83 96-80 96zm272 27.78c-17.52-4.39-35.71-6.85-54.32-8.44 5.87-26.08 27.5-45.88 54.32-49.28v57.72zm0-236.11c-30.89-3.91-54.86-29.7-55.81-61.55 19.54 2.17 38.09 6.23 55.81 12.66v48.89z"},child:[]}]})(n)}function h5(n){return Hr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M493.4 24.6l-104-24c-11.3-2.6-22.9 3.3-27.5 13.9l-48 112c-4.2 9.8-1.4 21.3 6.9 28l60.6 49.6c-36 76.7-98.9 140.5-177.2 177.2l-49.6-60.6c-6.8-8.3-18.2-11.1-28-6.9l-112 48C3.9 366.5-2 378.1.6 389.4l24 104C27.1 504.2 36.7 512 48 512c256.1 0 464-207.5 464-464 0-11.2-7.7-20.9-18.6-23.4z"},child:[]}]})(n)}function xl(n){return Hr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(n)}function mi(n){return Hr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M448 192V77.25c0-8.49-3.37-16.62-9.37-22.63L393.37 9.37c-6-6-14.14-9.37-22.63-9.37H96C78.33 0 64 14.33 64 32v160c-35.35 0-64 28.65-64 64v112c0 8.84 7.16 16 16 16h48v96c0 17.67 14.33 32 32 32h320c17.67 0 32-14.33 32-32v-96h48c8.84 0 16-7.16 16-16V256c0-35.35-28.65-64-64-64zm-64 256H128v-96h256v96zm0-224H128V64h192v48c0 8.84 7.16 16 16 16h48v96zm48 72c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24z"},child:[]}]})(n)}function ij(n){return Hr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zM262.655 90c-54.497 0-89.255 22.957-116.549 63.758-3.536 5.286-2.353 12.415 2.715 16.258l34.699 26.31c5.205 3.947 12.621 3.008 16.665-2.122 17.864-22.658 30.113-35.797 57.303-35.797 20.429 0 45.698 13.148 45.698 32.958 0 14.976-12.363 22.667-32.534 33.976C247.128 238.528 216 254.941 216 296v4c0 6.627 5.373 12 12 12h56c6.627 0 12-5.373 12-12v-1.333c0-28.462 83.186-29.647 83.186-106.667 0-58.002-60.165-102-116.531-102zM256 338c-25.365 0-46 20.635-46 46 0 25.364 20.635 46 46 46s46-20.636 46-46c0-25.365-20.635-46-46-46z"},child:[]}]})(n)}function ag(n){return Hr({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M358.4 3.2L320 48 265.6 3.2a15.9 15.9 0 0 0-19.2 0L192 48 137.6 3.2a15.9 15.9 0 0 0-19.2 0L64 48 25.6 3.2C15-4.7 0 2.8 0 16v480c0 13.2 15 20.7 25.6 12.8L64 464l54.4 44.8a15.9 15.9 0 0 0 19.2 0L192 464l54.4 44.8a15.9 15.9 0 0 0 19.2 0L320 464l38.4 44.8c10.5 7.9 25.6.4 25.6-12.8V16c0-13.2-15-20.7-25.6-12.8zM320 360c0 4.4-3.6 8-8 8H72c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h240c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H72c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h240c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H72c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h240c4.4 0 8 3.6 8 8v16z"},child:[]}]})(n)}function m5(n){return Hr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(n)}function fA(n){return Hr({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M0 224v272c0 8.84 7.16 16 16 16h80V192H32c-17.67 0-32 14.33-32 32zm360-48h-24v-40c0-4.42-3.58-8-8-8h-16c-4.42 0-8 3.58-8 8v64c0 4.42 3.58 8 8 8h48c4.42 0 8-3.58 8-8v-16c0-4.42-3.58-8-8-8zm137.75-63.96l-160-106.67a32.02 32.02 0 0 0-35.5 0l-160 106.67A32.002 32.002 0 0 0 128 138.66V512h128V368c0-8.84 7.16-16 16-16h96c8.84 0 16 7.16 16 16v144h128V138.67c0-10.7-5.35-20.7-14.25-26.63zM320 256c-44.18 0-80-35.82-80-80s35.82-80 80-80 80 35.82 80 80-35.82 80-80 80zm288-64h-64v320h80c8.84 0 16-7.16 16-16V224c0-17.67-14.33-32-32-32z"},child:[]}]})(n)}function Bi(n){return Hr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(n)}function $k(n){return Hr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M503.691 189.836L327.687 37.851C312.281 24.546 288 35.347 288 56.015v80.053C127.371 137.907 0 170.1 0 322.326c0 61.441 39.581 122.309 83.333 154.132 13.653 9.931 33.111-2.533 28.077-18.631C66.066 312.814 132.917 274.316 288 272.085V360c0 20.7 24.3 31.453 39.687 18.164l176.004-152c11.071-9.562 11.086-26.753 0-36.328z"},child:[]}]})(n)}function qk(n){return Hr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"},child:[]}]})(n)}function Xk(n){return Hr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M440.3 345.2l-33.8-19.5 26-7c8.2-2.2 13.1-10.7 10.9-18.9l-4-14.9c-2.2-8.2-10.7-13.1-18.9-10.9l-70.8 19-63.9-37 63.8-36.9 70.8 19c8.2 2.2 16.7-2.7 18.9-10.9l4-14.9c2.2-8.2-2.7-16.7-10.9-18.9l-26-7 33.8-19.5c7.4-4.3 9.9-13.7 5.7-21.1L430.4 119c-4.3-7.4-13.7-9.9-21.1-5.7l-33.8 19.5 7-26c2.2-8.2-2.7-16.7-10.9-18.9l-14.9-4c-8.2-2.2-16.7 2.7-18.9 10.9l-19 70.8-62.8 36.2v-77.5l53.7-53.7c6.2-6.2 6.2-16.4 0-22.6l-11.3-11.3c-6.2-6.2-16.4-6.2-22.6 0L256 56.4V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v40.4l-19.7-19.7c-6.2-6.2-16.4-6.2-22.6 0L138.3 48c-6.3 6.2-6.3 16.4 0 22.6l53.7 53.7v77.5l-62.8-36.2-19-70.8c-2.2-8.2-10.7-13.1-18.9-10.9l-14.9 4c-8.2 2.2-13.1 10.7-10.9 18.9l7 26-33.8-19.5c-7.4-4.3-16.8-1.7-21.1 5.7L2.1 145.7c-4.3 7.4-1.7 16.8 5.7 21.1l33.8 19.5-26 7c-8.3 2.2-13.2 10.7-11 19l4 14.9c2.2 8.2 10.7 13.1 18.9 10.9l70.8-19 63.8 36.9-63.8 36.9-70.8-19c-8.2-2.2-16.7 2.7-18.9 10.9l-4 14.9c-2.2 8.2 2.7 16.7 10.9 18.9l26 7-33.8 19.6c-7.4 4.3-9.9 13.7-5.7 21.1l15.5 26.8c4.3 7.4 13.7 9.9 21.1 5.7l33.8-19.5-7 26c-2.2 8.2 2.7 16.7 10.9 18.9l14.9 4c8.2 2.2 16.7-2.7 18.9-10.9l19-70.8 62.8-36.2v77.5l-53.7 53.7c-6.3 6.2-6.3 16.4 0 22.6l11.3 11.3c6.2 6.2 16.4 6.2 22.6 0l19.7-19.7V496c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-40.4l19.7 19.7c6.2 6.2 16.4 6.2 22.6 0l11.3-11.3c6.2-6.2 6.2-16.4 0-22.6L256 387.7v-77.5l62.8 36.2 19 70.8c2.2 8.2 10.7 13.1 18.9 10.9l14.9-4c8.2-2.2 13.1-10.7 10.9-18.9l-7-26 33.8 19.5c7.4 4.3 16.8 1.7 21.1-5.7l15.5-26.8c4.3-7.3 1.8-16.8-5.6-21z"},child:[]}]})(n)}function k4(n){return Hr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"},child:[]}]})(n)}function tp(n){return Hr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"},child:[]}]})(n)}function vd(n){return Hr({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(n)}function Cx(n){return Hr({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M384 64H192C85.961 64 0 149.961 0 256s85.961 192 192 192h192c106.039 0 192-85.961 192-192S490.039 64 384 64zM64 256c0-70.741 57.249-128 128-128 70.741 0 128 57.249 128 128 0 70.741-57.249 128-128 128-70.741 0-128-57.249-128-128zm320 128h-48.905c65.217-72.858 65.236-183.12 0-256H384c70.741 0 128 57.249 128 128 0 70.74-57.249 128-128 128z"},child:[]}]})(n)}function jx(n){return Hr({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M384 64H192C86 64 0 150 0 256s86 192 192 192h192c106 0 192-86 192-192S490 64 384 64zm0 320c-70.8 0-128-57.3-128-128 0-70.8 57.3-128 128-128 70.8 0 128 57.3 128 128 0 70.8-57.3 128-128 128z"},child:[]}]})(n)}function cu(n){return Hr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(n)}function nw(n){return Hr({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M552 64H448V24c0-13.3-10.7-24-24-24H152c-13.3 0-24 10.7-24 24v40H24C10.7 64 0 74.7 0 88v56c0 35.7 22.5 72.4 61.9 100.7 31.5 22.7 69.8 37.1 110 41.7C203.3 338.5 240 360 240 360v72h-48c-35.3 0-64 20.7-64 56v12c0 6.6 5.4 12 12 12h296c6.6 0 12-5.4 12-12v-12c0-35.3-28.7-56-64-56h-48v-72s36.7-21.5 68.1-73.6c40.3-4.6 78.6-19 110-41.7 39.3-28.3 61.9-65 61.9-100.7V88c0-13.3-10.7-24-24-24zM99.3 192.8C74.9 175.2 64 155.6 64 144v-16h64.2c1 32.6 5.8 61.2 12.8 86.2-15.1-5.2-29.2-12.4-41.7-21.4zM512 144c0 16.1-17.7 36.1-35.3 48.8-12.5 9-26.7 16.2-41.8 21.4 7-25 11.8-53.6 12.8-86.2H512v16z"},child:[]}]})(n)}function Jk(n){return Hr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M212.333 224.333H12c-6.627 0-12-5.373-12-12V12C0 5.373 5.373 0 12 0h48c6.627 0 12 5.373 12 12v78.112C117.773 39.279 184.26 7.47 258.175 8.007c136.906.994 246.448 111.623 246.157 248.532C504.041 393.258 393.12 504 256.333 504c-64.089 0-122.496-24.313-166.51-64.215-5.099-4.622-5.334-12.554-.467-17.42l33.967-33.967c4.474-4.474 11.662-4.717 16.401-.525C170.76 415.336 211.58 432 256.333 432c97.268 0 176-78.716 176-176 0-97.267-78.716-176-176-176-58.496 0-110.28 28.476-142.274 72.333h98.274c6.627 0 12 5.373 12 12v48c0 6.627-5.373 12-12 12z"},child:[]}]})(n)}function cA(n){return Hr({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4zm323-128.4l-27.8-28.1c-4.6-4.7-12.1-4.7-16.8-.1l-104.8 104-45.5-45.8c-4.6-4.7-12.1-4.7-16.8-.1l-28.1 27.9c-4.7 4.6-4.7 12.1-.1 16.8l81.7 82.3c4.6 4.7 12.1 4.7 16.8.1l141.3-140.2c4.6-4.7 4.7-12.2.1-16.8z"},child:[]}]})(n)}function Zk(n){return Hr({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z"},child:[]}]})(n)}function eD(n){return Hr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M319.4 320.6L224 416l-95.4-95.4C57.1 323.7 0 382.2 0 454.4v9.6c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-9.6c0-72.2-57.1-130.7-128.6-133.8zM13.6 79.8l6.4 1.5v58.4c-7 4.2-12 11.5-12 20.3 0 8.4 4.6 15.4 11.1 19.7L3.5 242c-1.7 6.9 2.1 14 7.6 14h41.8c5.5 0 9.3-7.1 7.6-14l-15.6-62.3C51.4 175.4 56 168.4 56 160c0-8.8-5-16.1-12-20.3V87.1l66 15.9c-8.6 17.2-14 36.4-14 57 0 70.7 57.3 128 128 128s128-57.3 128-128c0-20.6-5.3-39.8-14-57l96.3-23.2c18.2-4.4 18.2-27.1 0-31.5l-190.4-46c-13-3.1-26.7-3.1-39.7 0L13.6 48.2c-18.1 4.4-18.1 27.2 0 31.6z"},child:[]}]})(n)}function tD(n){return Hr({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M624 208h-64v-64c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v64h-64c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h64v64c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-64h64c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zm-400 48c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(n)}function rD(n){return Hr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm95.8 32.6L272 480l-32-136 32-56h-96l32 56-32 136-47.8-191.4C56.9 292 0 350.3 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-72.1-56.9-130.4-128.2-133.8z"},child:[]}]})(n)}function Tc(n){return Hr({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M589.6 240l45.6-45.6c6.3-6.3 6.3-16.5 0-22.8l-22.8-22.8c-6.3-6.3-16.5-6.3-22.8 0L544 194.4l-45.6-45.6c-6.3-6.3-16.5-6.3-22.8 0l-22.8 22.8c-6.3 6.3-6.3 16.5 0 22.8l45.6 45.6-45.6 45.6c-6.3 6.3-6.3 16.5 0 22.8l22.8 22.8c6.3 6.3 16.5 6.3 22.8 0l45.6-45.6 45.6 45.6c6.3 6.3 16.5 6.3 22.8 0l22.8-22.8c6.3-6.3 6.3-16.5 0-22.8L589.6 240zM224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(n)}function Pi(n){return Hr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(n)}function _c(n){return Hr({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(n)}const Ub="/dawn-school/assets/d-logo-cVKrp59A.jpeg",Eh=()=>{const n=rr(s=>s.settings.schoolInfo),a=n?.fundingType||"traditional";return{fundingType:a,isNGOSchool:a==="ngo",isTraditionalSchool:a==="traditional",schoolInfo:n}},p5=()=>({hasPermission:f=>rr(m=>dh(m,f)),hasAnyPermission:f=>rr(m=>Q7(m,f)),hasAllPermissions:f=>rr(m=>R7(m,f)),isOwner:()=>rr(P7),isAdmin:()=>rr(H7),isTeacher:()=>rr(z7),isStaff:()=>rr(K7)}),aD=()=>{const n=Pn(),{students:a,loading:t}=rr(M=>M.students),{batches:r}=rr(M=>M.alumni),{events:s}=rr(M=>M.events||{events:[]}),{notifications:e,loading:u}=rr(M=>M.notifications||{notifications:[],loading:!1}),[f,m]=ne.useState(!1),[g,b]=ne.useState([]);ne.useEffect(()=>{n(Lc()),n(u2())},[n]),ne.useEffect(()=>{const M=[...e];r.forEach(L=>{if(L.status==="active"){const T=new Date(L.endDate),H=new Date,O=T.getTime()-H.getTime(),Q=Math.ceil(O/(1e3*3600*24));Q<=7&&Q>0&&M.push({id:`batch-ending-${L.id}`,type:"batch-ending",title:"Batch Ending Soon",message:`Academic year ${L.name} ends in ${Q} days. Prepare for student promotions.`,date:new Date().toISOString(),read:!1,icon:i.jsx(OA,{className:"text-yellow-500"})})}});const _=r.find(L=>L.status==="active");if(_){const L=a.filter(T=>T.academicYear===_.name&&T.status==="studying");L.length>0&&M.push({id:`student-promotion-${_.id}`,type:"student-promotion",title:"Student Promotion Due",message:`Review ${L.length} students for promotion in batch ${_.name}`,date:new Date().toISOString(),read:!1,icon:i.jsx(OA,{className:"text-blue-500"})})}s.forEach(L=>{if(L.type==="event"){const T=new Date(L.date),H=new Date,O=T.getTime()-H.getTime(),Q=Math.ceil(O/(1e3*3600*24));Q===1?M.push({id:`event-tomorrow-${L.id}`,type:"event",title:"Event Tomorrow",message:`${L.title} is scheduled for tomorrow at ${L.startTime}`,date:new Date().toISOString(),read:!1,icon:i.jsx(Rl,{className:"text-green-500"})}):Q===0&&M.push({id:`event-today-${L.id}`,type:"event",title:"Event Today",message:`${L.title} is scheduled for today at ${L.startTime}`,date:new Date().toISOString(),read:!1,icon:i.jsx(Rl,{className:"text-green-500"})})}}),M.sort((L,T)=>new Date(T.date)-new Date(L.date)),b(M)},[r,a,s,e]);const j=M=>{b(_=>_.map(L=>L.id===M?{...L,read:!0}:L))},F=()=>{b(M=>M.map(_=>({..._,read:!0})))},C=g.filter(M=>!M.read).length;return i.jsxs("div",{className:"relative",children:[i.jsxs("button",{onClick:()=>m(!f),className:"relative p-2 text-gray-500 hover:text-gray-700 focus:outline-none",children:[i.jsx(Ok,{className:"h-6 w-6"}),C>0&&i.jsx("span",{className:"absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-red-500 rounded-full",children:C})]}),f&&i.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-md shadow-lg py-1 z-50 border border-gray-200",children:[i.jsxs("div",{className:"px-4 py-2 border-b border-gray-100 flex justify-between items-center",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Notifications"}),i.jsxs("div",{className:"flex space-x-2",children:[C>0&&i.jsx("button",{onClick:F,className:"text-xs text-blue-600 hover:text-blue-800",children:"Mark all as read"}),i.jsx("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600",children:i.jsx(vd,{className:"h-4 w-4"})})]})]}),i.jsx("div",{className:"max-h-96 overflow-y-auto",children:g.length===0?i.jsx("div",{className:"px-4 py-3 text-sm text-gray-500 text-center",children:"No notifications"}):g.map(M=>i.jsx("div",{className:`px-4 py-3 border-b border-gray-100 hover:bg-gray-50 ${M.read?"":"bg-blue-50"}`,onClick:()=>j(M.id),children:i.jsxs("div",{className:"flex items-start",children:[i.jsx("div",{className:"flex-shrink-0 pt-1",children:M.icon||i.jsx(d5,{className:"text-gray-500"})}),i.jsxs("div",{className:"ml-3 flex-1",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:M.title}),i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:M.message}),i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:new Date(M.date).toLocaleDateString()})]}),!M.read&&i.jsx("div",{className:"flex-shrink-0",children:i.jsx("div",{className:"h-2 w-2 rounded-full bg-blue-500"})})]})},M.id))}),i.jsx("div",{className:"px-4 py-2 border-t border-gray-100 text-center",children:i.jsx("button",{className:"text-xs text-gray-500 hover:text-gray-700",children:"View all notifications"})})]})]})},vo=({children:n})=>{const a=Pn(),t=Cd(),r=Fh();rr(ee=>ee.students.students),rr(ee=>ee.expenses.expenses),rr(ee=>ee.staff.staff),rr(ee=>ee.classes.classes);const{currentUser:s}=rr(ee=>ee.users),{isNGOSchool:e}=Eh(),u=p5(),{hasPermission:f,isOwner:m,isStaff:g}=u,[b,j]=ne.useState(null),[F,C]=ne.useState(!1);ne.useEffect(()=>{a(Lc()),a(O1()),a(uh()),a(gd()),a(m2()),a(s0())},[a]),ne.useEffect(()=>{if(!s){const ee=localStorage.getItem("currentUser");if(ee)try{const se=JSON.parse(ee);a($7(se))}catch(se){console.error("Error parsing stored user:",se),localStorage.removeItem("currentUser")}}},[s,a]),ne.useEffect(()=>{!s&&r.pathname!=="/login"&&t("/login")},[s,r.pathname,t]);const M=ee=>r.pathname===ee,_=ee=>{j(b===ee?null:ee)},L=()=>{j(null)},T=async()=>{try{await a(W7()),t("/login")}catch(ee){console.error("Logout failed:",ee)}};ne.useEffect(()=>{const ee=se=>{!se.target.closest(".dropdown-container")&&!se.target.closest(".user-menu")&&(L(),C(!1))};return document.addEventListener("click",ee),()=>{document.removeEventListener("click",ee)}},[]);const O=(()=>{if(!s)return[];const ee=[{name:"Dashboard",path:"/",icon:i.jsx(i0,{className:"mr-2"}),exact:!0}];try{f("students")&&ee.push({name:"Batch Management",path:"/batches",icon:i.jsx(OA,{className:"mr-2"})})}catch(se){console.warn("Error checking batch management permissions:",se)}try{(f("students")||f("attendance")||f("marksheets")||f("reports")||f("certificates")||f("examinations"))&&ee.push({name:"Students",path:"/students",icon:i.jsx(_c,{className:"mr-2"}),dropdown:[{name:"Attendance",path:"/students/attendance",permission:"attendance"},{name:"Reports",path:"/students/reports",permission:"student-reports"},{name:"Marksheets",path:"/marksheets",permission:"marksheets"},{name:"Certificates",path:"/certificates",permission:"certificates"},{name:"Examinations",path:"/examinations",permission:"examinations"}].filter(se=>!se.permission||f(se.permission))})}catch(se){console.warn("Error checking student permissions:",se)}try{f("classes")&&ee.push({name:"Classes",path:"/classes",icon:i.jsx(nc,{className:"mr-2"})})}catch(se){console.warn("Error checking class permissions:",se)}try{f("staff")&&ee.push({name:"Staff",path:"/staff",icon:i.jsx(up,{className:"mr-2"}),dropdown:[{name:"All Staff",path:"/staff"},{name:"Attendance",path:"/staff/attendance",permission:"staff-attendance"},{name:"Attendance Reports",path:"/staff/attendance-reports",permission:"staff-attendance"}].filter(se=>!se.permission||f(se.permission))})}catch(se){console.warn("Error checking staff permissions:",se)}try{!e&&(m()||g()||f("fees"))&&ee.push({name:"Fees",path:"/fees",icon:i.jsx(Vk,{className:"mr-2"})})}catch(se){console.warn("Error checking fee permissions:",se)}try{(m()||f("expenses"))&&ee.push({name:"Expenses",path:"/expenses",icon:i.jsx(bd,{className:"mr-2"})})}catch(se){console.warn("Error checking expense permissions:",se)}try{e&&(m()||f("subsidies"))&&ee.push({name:"NGO Subsidies",path:"/subsidies",icon:i.jsx(u5,{className:"mr-2"})})}catch(se){console.warn("Error checking subsidy permissions:",se)}try{(m()||f("financial-reports"))&&ee.push({name:"Financial Report",path:"/financial-reporting",icon:i.jsx(i0,{className:"mr-2"})})}catch(se){console.warn("Error checking financial report permissions:",se)}try{(m()||f("settings"))&&ee.push({name:"Settings",path:"/settings",icon:i.jsx(nj,{className:"mr-2"})})}catch(se){console.warn("Error checking settings permissions:",se)}return ee})(),Q=r.pathname==="/login";return!s&&!Q?null:Q?i.jsx("div",{children:n}):i.jsxs("div",{className:"min-h-screen bg-gray-50",children:[i.jsx("header",{className:"bg-white shadow-sm",children:i.jsx("div",{className:"max-w-8xl mx-auto px-4 py-4 sm:px-6 lg:px-12",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"rounded-xl",children:i.jsx("img",{src:Ub,alt:"Logo",className:"h-14 w-auto"})}),i.jsx("h1",{className:"ml-3 text-2xl font-bold text-gray-900",children:rr(ee=>ee.settings.schoolInfo)?.schoolName||"School Management System"})]}),i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx(aD,{}),s?i.jsxs("div",{className:"relative user-menu",children:[i.jsxs("button",{onClick:()=>C(!F),className:"flex items-center space-x-2 focus:outline-none",children:[i.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 p-2 rounded-full",children:i.jsx(Pi,{className:"text-white"})}),i.jsxs("div",{className:"hidden md:block text-left",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.username}),i.jsx("p",{className:"text-xs text-gray-500",children:s.role})]})]}),F&&i.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50 border border-gray-200",children:[i.jsxs("div",{className:"px-4 py-2 border-b border-gray-100",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.username}),i.jsx("p",{className:"text-xs text-gray-500",children:s.role})]}),i.jsxs("button",{onClick:T,className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:[i.jsx(qk,{className:"mr-2"}),"Logout"]})]})]}):i.jsx("div",{className:"relative",children:i.jsx("div",{className:"bg-gray-200 border-2 border-dashed rounded-xl w-10 h-10"})})]})]})})}),i.jsx("nav",{className:"bg-white shadow-sm border-t border-gray-200 sticky top-0 z-10",children:i.jsx("div",{className:"max-w-8xl mx-auto px-4 sm:px-6 lg:px-12",children:i.jsx("div",{className:"flex py-3 space-x-6",children:O.map((ee,se)=>i.jsx("div",{className:"dropdown-container relative",children:ee.dropdown?i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:()=>_(ee.name),className:`flex items-center px-3 py-2 rounded-lg text-sm font-medium whitespace-nowrap transition-colors duration-200 ${M(ee.path)||ee.dropdown.some(ue=>M(ue.path))?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:[ee.icon,ee.name,i.jsx(Lb,{className:"ml-1 text-xs"})]}),b===ee.name&&i.jsx("div",{className:"absolute left-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50 border border-gray-200",children:ee.dropdown.map((ue,ae)=>i.jsx(C4,{to:ue.path,className:`block px-4 py-2 text-sm ${M(ue.path)?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-100"}`,onClick:L,children:ue.name},ae))})]}):i.jsxs(C4,{to:ee.path,className:`flex items-center px-3 py-2 rounded-lg text-sm font-medium whitespace-nowrap transition-colors duration-200 ${M(ee.path)?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,onClick:L,children:[ee.icon,ee.name]})},se))})})}),i.jsx("main",{className:"max-w-8xl mx-auto px-4 sm:px-6 lg:px-8 xl:px-12 py-6",children:n})]})},jd=({title:n,subtitle:a,actionButton:t,quarterYearFilters:r,children:s})=>i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:n}),a&&i.jsx("p",{className:"mt-1 text-sm text-gray-600",children:a}),s&&i.jsx("div",{className:"mt-2",children:s})]}),i.jsxs("div",{className:"flex items-center space-x-2 mt-4 md:mt-0",children:[r&&i.jsx("div",{className:"flex space-x-2",children:r}),t&&i.jsx("div",{children:t})]})]}),sD=({filteredActivities:n,calculateTotals:a,activityType:t,transactionType:r,selectedQuarter:s,selectedYear:e,schoolInfo:u})=>{const f=new Date().toISOString().split("T")[0],m=()=>t==="all"?"All Activities":t==="daily"?"Today":t==="monthly"?"This Month":"Custom Range",g=()=>r==="all"?"All Transactions":r==="in"?"Income":"Expenses",b=()=>s==="all"&&e==="all"?"":`Filtered for ${s!=="all"?`Q${s} `:""}${e!=="all"?e:""}`,j=u||{name:"School Management System",address:"123 Education Street, Learning City",phone:"+1 (555) 123-4567"};return i.jsxs("div",{className:"w-full mx-auto bg-white font-sans activities-print-view",children:[i.jsxs("div",{className:"activities-section",children:[i.jsxs("div",{className:"text-center border-b border-gray-300 pb-3 mb-4 print:hidden",children:[i.jsxs("div",{className:"flex items-center justify-center mb-2",children:[i.jsx(fA,{className:"text-blue-600 text-xl mr-3"}),i.jsx("h1",{className:"text-xl font-bold text-gray-800",children:j.name})]}),i.jsx("p",{className:"text-gray-600 text-sm mb-1",children:j.address}),i.jsxs("p",{className:"text-gray-600 text-sm",children:["Phone: ",j.phone]})]}),i.jsxs("div",{className:"text-center mb-6",children:[i.jsx("h2",{className:"text-lg font-bold text-gray-800 border-b border-gray-200 pb-2",children:"RECENT ACTIVITIES REPORT"}),i.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["Generated on ",f]}),b()&&i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:b()})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-6",children:[i.jsxs("div",{className:"bg-gray-50 p-3 rounded border",children:[i.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Total Activities"}),i.jsx("div",{className:"text-lg font-bold text-gray-800",children:n.length})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded border",children:[i.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Total Income"}),i.jsxs("div",{className:"text-lg font-bold text-green-600",children:["Rs ",a.income.toLocaleString()]})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded border",children:[i.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Total Expenses"}),i.jsxs("div",{className:"text-lg font-bold text-red-600",children:["Rs ",a.expense.toLocaleString()]})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded border",children:[i.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Net Position"}),i.jsxs("div",{className:`text-lg font-bold ${a.net>=0?"text-green-600":"text-red-600"}`,children:["Rs ",Math.abs(a.net).toLocaleString()," ",a.net>=0?"":"(Loss)"]})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded border",children:[i.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Filter Type"}),i.jsx("div",{className:"text-sm font-medium text-gray-800",children:m()})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded border",children:[i.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Transaction Type"}),i.jsx("div",{className:"text-sm font-medium text-gray-800",children:g()})]})]}),i.jsxs("div",{className:"mb-6",children:[i.jsxs("h3",{className:"font-bold text-gray-800 mb-3 text-sm flex items-center",children:[i.jsx(i0,{className:"mr-2 text-blue-600 text-sm"})," Activity Details"]}),i.jsxs("div",{className:"border rounded",children:[i.jsxs("div",{className:"grid grid-cols-5 gap-1 p-3 bg-gray-50 border-b text-sm font-medium",children:[i.jsx("span",{className:"col-span-1",children:"Activity"}),i.jsx("span",{className:"col-span-2",children:"Description"}),i.jsx("span",{className:"text-center",children:"Category"}),i.jsx("span",{className:"text-center",children:"Amount"}),i.jsx("span",{className:"text-center",children:"Date"})]}),i.jsx("div",{className:"divide-y divide-gray-200",children:n.map((F,C)=>i.jsxs("div",{className:"grid grid-cols-5 gap-1 p-3 text-sm",children:[i.jsx("span",{className:"col-span-1 font-medium",children:F.type}),i.jsx("span",{className:"col-span-2",children:F.description}),i.jsx("span",{className:"text-center",children:i.jsx("span",{className:`px-2 py-1 rounded text-xs ${F.category==="Students"?"bg-blue-100 text-blue-800":F.category==="Fees"?"bg-green-100 text-green-800":F.category==="Income"?"bg-emerald-100 text-emerald-800":F.category==="Expenses"?"bg-red-100 text-red-800":F.category==="Staff"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:F.category})}),i.jsx("span",{className:"text-center font-medium",children:F.amount>=0?i.jsxs("span",{className:"text-green-600",children:["+Rs ",F.amount.toLocaleString()]}):i.jsxs("span",{className:"text-red-600",children:["-Rs ",Math.abs(F.amount).toLocaleString()]})}),i.jsx("span",{className:"text-center text-gray-600",children:F.date?new Date(F.date).toISOString().split("T")[0]:"N/A"})]},C))})]})]}),i.jsxs("div",{className:"border-t border-gray-300 pt-4 mt-6 text-center text-sm text-gray-600",children:[i.jsxs("p",{className:"mb-1",children:["This is an official report generated on ",f]}),i.jsxs("p",{className:"text-xs",children:[j.name," - Activities Report"]})]})]}),i.jsx("style",{children:`
        @media print {
          body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          }
          
          .activities-section {
            padding: 15px;
            max-width: 100%;
            page-break-inside: avoid;
            page-break-after: always;
          }
          
          /* Remove page break after the last section */
          .activities-section:last-child {
            page-break-after: avoid;
          }
          
          @page {
            size: A4;
            margin: 0.5in;
          }
          
          .activities-print-view {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          }
          
          /* Enhanced print styling */
          .text-center { text-align: center; }
          .flex { display: flex; }
          .items-center { align-items: center; }
          .justify-center { justify-content: center; }
          .border-b { border-bottom: 1px solid #d1d5db; }
          .border-t { border-top: 1px solid #d1d5db; }
          .border-gray-300 { border-color: #d1d5db; }
          .pb-2 { padding-bottom: 0.5rem; }
          .pb-3 { padding-bottom: 0.75rem; }
          .mb-3 { margin-bottom: 0.75rem; }
          .mb-4 { margin-bottom: 1rem; }
          .mb-6 { margin-bottom: 1.5rem; }
          .mt-1 { margin-top: 0.25rem; }
          .mt-2 { margin-top: 0.5rem; }
          .mt-6 { margin-top: 1.5rem; }
          .pt-4 { padding-top: 1rem; }
          .text-lg { font-size: 1.125rem; }
          .text-base { font-size: 1rem; }
          .text-sm { font-size: 0.875rem; }
          .text-xs { font-size: 0.75rem; }
          .font-bold { font-weight: 700; }
          .font-medium { font-weight: 500; }
          .text-gray-800 { color: #1f2937; }
          .text-gray-600 { color: #4b5563; }
          .text-gray-500 { color: #6b7280; }
          .text-green-600 { color: #16a34a; }
          .text-red-600 { color: #dc2626; }
          .bg-gray-50 { background-color: #f9fafb; }
          .bg-blue-100 { background-color: #dbeafe; }
          .bg-green-100 { background-color: #dcfce7; }
          .bg-emerald-100 { background-color: #d1fae5; }
          .bg-red-100 { background-color: #fee2e2; }
          .bg-purple-100 { background-color: #f3e8ff; }
          .bg-gray-100 { background-color: #f3f4f6; }
          .text-blue-800 { color: #1e40af; }
          .text-green-800 { color: #166534; }
          .text-emerald-800 { color: #065f46; }
          .text-red-800 { color: #991b1b; }
          .text-purple-800 { color: #6b21a8; }
          .rounded { border-radius: 0.25rem; }
          .p-3 { padding: 0.75rem; }
          .px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
          .py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
          .grid { display: grid; }
          .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
          .grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
          .grid-cols-5 { grid-template-columns: repeat(5, minmax(0, 1fr)); }
          .gap-1 { gap: 0.25rem; }
          .gap-4 { gap: 1rem; }
          .col-span-1 { grid-column: span 1 / span 1; }
          .col-span-2 { grid-column: span 2 / span 2; }
          .border { border: 1px solid #d1d5db; }
          .divide-y > :not([hidden]) ~ :not([hidden]) { border-top: 1px solid #e5e7eb; }
          .divide-gray-200 > :not([hidden]) ~ :not([hidden]) { border-color: #e5e7eb; }
        }
      `})]})},md=({children:n,showFor:a="both",fallback:t=null})=>{const{isNGOSchool:r,isTraditionalSchool:s}=Eh();return a==="both"||a==="ngo"&&r||a==="traditional"&&s?n:t},oj=()=>i.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-500 p-4 rounded",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx(u5,{className:"h-5 w-5 text-blue-500"})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"NGO Funded School"}),i.jsxs("div",{className:"mt-2 text-sm text-blue-700",children:[i.jsx("p",{children:"This school is funded by quarterly NGO subsidies. No fees are charged to students."}),i.jsx("p",{className:"mt-1",children:"All operational costs are covered through NGO partnerships."})]})]})]})}),nD=()=>{const n=Pn(),{schoolInfo:a}=rr(X=>X.settings),[t,r]=ne.useState(new Date),[s,e]=ne.useState(!1),[u,f]=ne.useState(null),[m,g]=ne.useState([]),[b,j]=ne.useState({title:"",description:"",startTime:"",endTime:""}),[F,C]=ne.useState(!1),[M,_]=ne.useState(null),[L,T]=ne.useState(!1),[H,O]=ne.useState(null);ne.useEffect(()=>{n(s0()),Q()},[n]);const Q=async()=>{try{const X=await fetch(`${dr}/events`);if(X.ok){const G=(await X.json()).map(q=>({...q,date:new Date(q.date)}));g(G)}}catch(X){console.error("Failed to fetch events:",X)}},ee=[...(()=>{const X=[];if(a&&a.holidays&&Array.isArray(a.holidays)&&a.holidays.forEach((ie,G)=>{if(ie){const q=typeof ie=="string"?ie:ie.date,ve=typeof ie=="string"?"Holiday":ie.title||"Holiday";q&&X.push({id:`holiday-${G}`,title:ve,date:new Date(q),type:"holiday"})}}),a&&a.vacations){const{summer:ie,winter:G}=a.vacations;if(ie&&ie.start&&ie.end){const q=new Date(ie.start);new Date(ie.end),X.push({id:"summer-vacation-start",title:"Summer Vacation",date:q,type:"vacation"})}if(G&&G.start&&G.end){const q=new Date(G.start);new Date(G.end),X.push({id:"winter-vacation-start",title:"Winter Break",date:q,type:"vacation"})}}return X})(),...m],se=(X,ie)=>new Date(X,ie+1,0).getDate(),ue=(X,ie)=>new Date(X,ie,1).getDay(),ae=()=>{r(X=>{const ie=new Date(X);return ie.setMonth(ie.getMonth()-1),ie})},pe=()=>{r(X=>{const ie=new Date(X);return ie.setMonth(ie.getMonth()+1),ie})},z=X=>{const ie=ee.filter(G=>G.date.getDate()===X.getDate()&&G.date.getMonth()===X.getMonth()&&G.date.getFullYear()===X.getFullYear());if(a&&a.vacations){const{summer:G,winter:q}=a.vacations,ve=X.toISOString().split("T")[0];G&&G.start&&G.end&&ve>=G.start&&ve<=G.end&&(ie.some(Fe=>Fe.type==="vacation")||ie.push({id:`vacation-${ve}`,title:"Vacation",date:X,type:"vacation"})),q&&q.start&&q.end&&ve>=q.start&&ve<=q.end&&(ie.some(Fe=>Fe.type==="vacation")||ie.push({id:`vacation-${ve}`,title:"Vacation",date:X,type:"vacation"}))}return ie},ge=(()=>{const X=t.getFullYear(),ie=t.getMonth(),G=se(X,ie),q=ue(X,ie),ve=[];for(let Fe=0;Fe<q;Fe++)ve.push(null);for(let Fe=1;Fe<=G;Fe++){const Qe=new Date(X,ie,Fe);ve.push(Qe)}return ve})(),fe=["January","February","March","April","May","June","July","August","September","October","November","December"],ke=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],he=X=>{const ie=new Date;ie.setHours(0,0,0,0);const G=new Date(X);if(G.setHours(0,0,0,0),G<ie)return;const q=z(X);if(q.some(Qe=>Qe.type==="holiday"||Qe.type==="vacation"))return;const Fe=q.filter(Qe=>Qe.type==="event");if(Fe.length>0){const Qe=Fe[0];f(X),j({title:Qe.title,description:Qe.description||"",startTime:Qe.startTime||"",endTime:Qe.endTime||""}),_(Qe.id),e(!0)}else f(X),j({title:"",description:"",startTime:"",endTime:""}),_(null),e(!0)},Ne=X=>{const{name:ie,value:G}=X.target;j(q=>({...q,[ie]:G}))},xe=()=>{if(!u||!b.startTime)return!1;const X=ee.filter(G=>G.date.getDate()===u.getDate()&&G.date.getMonth()===u.getMonth()&&G.date.getFullYear()===u.getFullYear()&&G.type==="event"),ie=M?X.filter(G=>G.id!==M):X;for(const G of ie)if(G.startTime){if(b.endTime&&G.endTime){if(b.startTime<G.endTime&&b.endTime>G.startTime)return!0}else if(b.startTime===G.startTime)return!0}return!1},we=async()=>{if(!b.title||!u)return;if(xe()){alert("There is already an event scheduled at this time. Please choose a different time.");return}const X={title:b.title,description:b.description,date:u.toISOString(),startTime:b.startTime,endTime:b.endTime,type:"event"};try{let ie;if(M?(X.id=M,ie=await fetch(`${dr}/events/${M}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(X)})):(X.id=`event-${Date.now()}`,ie=await fetch(`${dr}/events`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(X)})),ie.ok){const G=await ie.json(),q={...G,date:new Date(G.date)};M?g(ve=>ve.map(Fe=>Fe.id===M?q:Fe)):(g(ve=>[...ve,q]),O(q),T(!0)),e(!1),_(null)}else console.error("Failed to save event")}catch(ie){console.error("Error saving event:",ie)}},ye=()=>{C(!0),setTimeout(()=>{window.print()},500)},te=()=>{if(!H)return"";let X=`*School Event Notification*

`;return X+=` *Event:* ${H.title}
`,X+=` *Date:* ${H.date.toLocaleDateString()}
`,H.startTime&&(X+=` *Time:* ${H.startTime}`,H.endTime&&(X+=` - ${H.endTime}`),X+=`
`),H.description&&(X+=` *Details:* ${H.description}
`),X+=`
Please mark your calendars!`,`https://web.whatsapp.com/send?text=${encodeURIComponent(X)}`},V=()=>{const X=te();X&&(window.open(X,"_blank"),T(!1),O(null))},le=()=>{T(!1),O(null)},de=()=>i.jsx("div",{className:"print-view",style:{display:F?"block":"none"},children:i.jsxs("div",{className:"p-8",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"School Event Calendar"}),i.jsxs("p",{className:"text-gray-600 mt-2",children:[fe[t.getMonth()]," ",t.getFullYear()]})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:ee.filter(X=>X.date.getMonth()===t.getMonth()&&X.date.getFullYear()===t.getFullYear()).sort((X,ie)=>X.date-ie.date).map(X=>i.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:X.title}),i.jsxs("p",{className:"text-gray-600 text-sm mt-1",children:[X.date.toLocaleDateString(),X.startTime&&` at ${X.startTime}${X.endTime?` - ${X.endTime}`:""}`]})]}),i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${X.type==="holiday"?"bg-red-100 text-red-800":X.type==="vacation"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:X.type.charAt(0).toUpperCase()+X.type.slice(1)})]}),X.description&&i.jsx("p",{className:"mt-3 text-gray-700",children:X.description})]},X.id))}),i.jsx("div",{className:"mt-8 text-center text-gray-500 text-sm",children:i.jsxs("p",{children:["Generated on ",new Date().toLocaleDateString()]})})]})});return i.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[i.jsx(de,{}),i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[i.jsx(Rl,{className:"mr-2 text-blue-500"}),"Event Calendar"]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("button",{onClick:ye,className:"p-2 rounded-md hover:bg-gray-100 transition-colors text-gray-600",title:"Print Events",children:i.jsx(mi,{})}),i.jsx("button",{onClick:ae,className:"p-2 rounded-md hover:bg-gray-100 transition-colors",children:i.jsx(l5,{})}),i.jsxs("span",{className:"font-medium",children:[fe[t.getMonth()]," ",t.getFullYear()]}),i.jsx("button",{onClick:pe,className:"p-2 rounded-md hover:bg-gray-100 transition-colors",children:i.jsx(c5,{})})]})]}),i.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:ke.map(X=>i.jsx("div",{className:"text-center text-xs font-medium text-gray-500 py-2",children:X},X))}),i.jsx("div",{className:"grid grid-cols-7 gap-1",children:ge.map((X,ie)=>{if(!X)return i.jsx("div",{className:"h-16 border border-gray-100 rounded"},ie);const G=z(X),q=G.filter(Qe=>Qe.type==="event"),ve=X.toDateString()===new Date().toDateString(),Fe=G.some(Qe=>Qe.type==="holiday"||Qe.type==="vacation");return i.jsxs("div",{onClick:()=>he(X),className:`h-16 border border-gray-100 rounded p-1 relative ${ve?"bg-blue-50 border-blue-200":Fe?"bg-gray-100 cursor-not-allowed":X<new Date(new Date().setHours(0,0,0,0))?"bg-gray-50 cursor-not-allowed":q.length>0?"bg-blue-50":"hover:bg-gray-50 cursor-pointer"}`,children:[i.jsxs("div",{className:`text-sm font-medium ${ve?"text-blue-600":Fe||X<new Date(new Date().setHours(0,0,0,0))?"text-gray-400":"text-gray-700"}`,children:[X.getDate(),Fe&&i.jsx("span",{className:"absolute top-0 right-0 text-[8px] text-red-500",children:""}),X<new Date(new Date().setHours(0,0,0,0))&&i.jsx("span",{className:"absolute top-0 right-0 text-[8px] text-gray-400",children:""}),!Fe&&X>=new Date(new Date().setHours(0,0,0,0))&&i.jsx("button",{className:"absolute top-0 left-0 p-1 text-gray-400 hover:text-gray-600"})]}),i.jsxs("div",{className:"mt-1 space-y-0.5",children:[G.slice(0,2).map(Qe=>i.jsxs("div",{className:`text-[10px] truncate px-1 rounded ${Qe.type==="holiday"?"bg-red-100 text-red-800":Qe.type==="vacation"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:[Qe.title,Qe.type==="event"&&Qe.startTime&&i.jsxs("b",{className:"block text-[10px]",children:[Qe.startTime,Qe.endTime&&`-${Qe.endTime}`]}),Qe.type==="event"&&i.jsx("div",{className:"flex justify-end mt-1",children:i.jsx("button",{onClick:Ge=>{Ge.stopPropagation(),O(Qe),T(!0)},className:"text-green-600 hover:text-green-800",title:"Share event"})})]},Qe.id)),G.length>2&&i.jsxs("div",{className:"text-[10px] text-gray-500 truncate",children:["+",G.length-2," more"]})]})]},ie)})}),i.jsxs("div",{className:"flex items-center justify-center mt-4 space-x-4 text-xs",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-3 h-3 bg-red-100 rounded mr-1"}),i.jsx("span",{children:"Holiday"})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-3 h-3 bg-yellow-100 rounded mr-1"}),i.jsx("span",{children:"Vacation"})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-3 h-3 bg-blue-100 rounded mr-1"}),i.jsx("span",{children:"Event"})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-3 h-3 bg-gray-100 rounded mr-1"}),i.jsx("span",{children:"Disabled"})]})]}),s&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[i.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:[M?"Edit Event":"Add Event"," for ",u?.toLocaleDateString()]}),i.jsx("button",{onClick:()=>{e(!1),_(null)},className:"text-gray-400 hover:text-gray-500",children:i.jsx(vd,{})})]})}),i.jsxs("div",{className:"px-6 py-4 space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Event Title *"}),i.jsx("input",{type:"text",name:"title",value:b.title,onChange:Ne,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Parent-Teacher Meeting"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),i.jsx("textarea",{name:"description",value:b.description,onChange:Ne,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Event details..."})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Time"}),i.jsx("input",{type:"time",name:"startTime",value:b.startTime,onChange:Ne,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Time"}),i.jsx("input",{type:"time",name:"endTime",value:b.endTime,onChange:Ne,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]})]}),xe()&&i.jsx("div",{className:"text-red-500 text-sm",children:"Warning: This time conflicts with an existing event."})]}),i.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-end space-x-3",children:[i.jsx("button",{type:"button",onClick:()=>{e(!1),_(null)},className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),i.jsx("button",{type:"button",onClick:we,disabled:!b.title||xe(),className:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${!b.title||xe()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:M?"Update Event":"Save Event"}),M&&i.jsxs("button",{type:"button",onClick:()=>{const X=m.find(ie=>ie.id===M);X&&(O(X),T(!0),e(!1))},className:"inline-flex items-center px-4 py-2 border border-green-300 text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[i.jsx($k,{className:"mr-2"}),"Share"]})]})]})}),L&&H&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[i.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Share Event"}),i.jsx("button",{onClick:le,className:"text-gray-400 hover:text-gray-500",children:i.jsx(vd,{})})]})}),i.jsxs("div",{className:"px-6 py-4",children:[i.jsxs("div",{className:"text-center mb-4",children:[i.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100",children:i.jsx(E4,{className:"h-6 w-6 text-green-600"})}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mt-2",children:"Share via WhatsApp"}),i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Share event details with parents group on WhatsApp"})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[i.jsx("h4",{className:"font-medium text-gray-900",children:H.title}),i.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[H.date.toLocaleDateString(),H.startTime&&` at ${H.startTime}${H.endTime?` - ${H.endTime}`:""}`]}),H.description&&i.jsx("p",{className:"text-sm text-gray-600 mt-2",children:H.description})]}),i.jsxs("div",{className:"flex justify-center space-x-3",children:[i.jsx("button",{type:"button",onClick:le,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),i.jsxs("button",{type:"button",onClick:V,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[i.jsx(E4,{className:"mr-2"}),"Share on WhatsApp"]})]})]})]})})]})},iD=()=>{Fh();const n=rr(q=>q.students.students),a=rr(q=>q.expenses.expenses),t=rr(q=>q.staff.staff),r=rr(q=>q.classes.classes),s=rr(q=>q.subsidies.subsidies),e=rr(q=>q.settings.schoolInfo),u=rr(q=>q.users.currentUser),{isNGOSchool:f}=Eh(),{isOwner:m,isAdmin:g}=p5(),[b,j]=ne.useState(f?"subsidies":"fees");At.useEffect(()=>{j(f?"subsidies":"fees")},[f]);const[F,C]=ne.useState("all"),[M,_]=ne.useState(""),[L,T]=ne.useState({start:"",end:""}),[H,O]=ne.useState("all"),[Q,Z]=ne.useState(!1),[ee,se]=ne.useState("all"),[ue,ae]=ne.useState("all"),[pe,z]=ne.useState(1),[J]=ne.useState(10),ge=ne.useMemo(()=>{if(b==="subsidies"){const q=new Set;return s.forEach(ve=>{ve.year&&ve.status==="received"&&q.add(ve.year)}),Array.from(q).sort((ve,Fe)=>Fe-ve)}else{const q=new Set;return n.forEach(ve=>{ve.feesHistory&&ve.feesHistory.forEach(Fe=>{if(Fe.date){const Qe=new Date(Fe.date).getFullYear();Qe&&q.add(Qe)}})}),Array.from(q).sort((ve,Fe)=>Fe-ve)}},[n,s,b]),fe=ne.useMemo(()=>{if(b==="subsidies"){const q=new Set;return s.forEach(ve=>{if(ve.quarter&&ve.status==="received"){const Fe=parseInt(ve.quarter.replace("Q",""));Fe>=1&&Fe<=4&&q.add(Fe)}}),Array.from(q).sort((ve,Fe)=>ve-Fe)}else{const q=new Set;return n.forEach(ve=>{ve.feesHistory&&ve.feesHistory.forEach(Fe=>{if(Fe.date){const Ge=new Date(Fe.date).getMonth(),je=Math.floor(Ge/3)+1;je>=1&&je<=4&&q.add(je)}})}),Array.from(q).sort((ve,Fe)=>ve-Fe)}},[n,s,b]),ke=ne.useMemo(()=>{if(ee==="all"&&ue==="all")return b==="subsidies"?{filteredExpenses:a,filteredStaff:t,filteredSubsidies:s}:{filteredExpenses:a,filteredStaff:t,filteredFees:n};if(b==="subsidies"){const q=s.filter(Qe=>!(ue!=="all"&&Qe.year!==parseInt(ue)||ee!=="all"&&parseInt(Qe.quarter.replace("Q",""))!==parseInt(ee))),ve=a.filter(Qe=>{if(!Qe.date)return!1;const Ge=new Date(Qe.date),je=Ge.getFullYear(),Me=Ge.getMonth(),Se=Math.floor(Me/3)+1;return!(ue!=="all"&&je!==parseInt(ue)||ee!=="all"&&Se!==parseInt(ee))}),Fe=t.map(Qe=>{if(!Qe.salaryHistory)return Qe;const Ge=Qe.salaryHistory.filter(je=>{if(!je.paymentDate)return!1;const Me=new Date(je.paymentDate),Se=Me.getFullYear(),ft=Me.getMonth(),jt=Math.floor(ft/3)+1;return!(ue!=="all"&&Se!==parseInt(ue)||ee!=="all"&&jt!==parseInt(ee))});return{...Qe,salaryHistory:Ge}});return{filteredExpenses:ve,filteredStaff:Fe,filteredSubsidies:q}}else{const q=a.filter(Qe=>{if(!Qe.date)return!1;const Ge=new Date(Qe.date),je=Ge.getFullYear(),Me=Ge.getMonth(),Se=Math.floor(Me/3)+1;return!(ue!=="all"&&je!==parseInt(ue)||ee!=="all"&&Se!==parseInt(ee))}),ve=t.map(Qe=>{if(!Qe.salaryHistory)return Qe;const Ge=Qe.salaryHistory.filter(je=>{if(!je.paymentDate)return!1;const Me=new Date(je.paymentDate),Se=Me.getFullYear(),ft=Me.getMonth(),jt=Math.floor(ft/3)+1;return!(ue!=="all"&&Se!==parseInt(ue)||ee!=="all"&&jt!==parseInt(ee))});return{...Qe,salaryHistory:Ge}}),Fe=n.map(Qe=>{if(!Qe.feesHistory)return Qe;const Ge=Qe.feesHistory.filter(je=>{if(!je.date)return!1;const Me=new Date(je.date),Se=Me.getFullYear(),ft=Me.getMonth(),jt=Math.floor(ft/3)+1;return!(ue!=="all"&&Se!==parseInt(ue)||ee!=="all"&&jt!==parseInt(ee))});return{...Qe,feesHistory:Ge}});return{filteredExpenses:q,filteredStaff:ve,filteredFees:Fe}}},[a,t,n,ee,ue,b]),he=ne.useMemo(()=>{const{filteredExpenses:q,filteredStaff:ve,filteredFees:Fe,filteredSubsidies:Qe}=ke,Ge=ve.reduce((ft,jt)=>{const It=(jt.allowances||[]).reduce((ut,Rt)=>ut+parseFloat(Rt.amount||0),0);return ft+parseFloat(jt.salary||0)+It},0),je=q.filter(ft=>ft.category!=="Salary").reduce((ft,jt)=>ft+parseFloat(jt.amount),0),Me=Ge+je,Se=n.length;if(b==="subsidies"){const ft=Qe.filter(bt=>bt.status==="received").reduce((bt,Yt)=>bt+parseFloat(Yt.amount||0),0),jt=ft-Me,It={};r.forEach(bt=>{It[bt.name]=0}),n.forEach(bt=>{It[bt.class]||(It[bt.class]=0),It[bt.class]+=1});const ut=q.reduce((bt,Yt)=>(bt[Yt.category]||(bt[Yt.category]=0),bt[Yt.category]+=parseFloat(Yt.amount),bt),{}),Rt=ve.reduce((bt,Yt)=>(bt[Yt.position]||(bt[Yt.position]=0),bt[Yt.position]+=1,bt),{}),Ye=r.length,St=r.reduce((bt,Yt)=>bt+(Yt.sections?.length||0),0),Jt=r.flatMap(bt=>bt.subjects?.map(Yt=>Yt.name)||[]),ar=[...new Set(Jt)].length;return{totalExpenses:Me,totalStaffSalaries:Ge,otherExpenses:je,netProfit:jt,totalStudents:Se,totalSubsidiesReceived:ft,studentsByClass:It,expensesByCategory:ut,staffByPosition:Rt,totalStaff:ve.length,totalClasses:Ye,totalSections:St,totalSubjects:ar}}else{const ft=Fe.reduce((bt,Yt)=>Yt.feesHistory?bt+Yt.feesHistory.filter(vr=>vr.status==="paid").reduce((vr,gr)=>vr+parseFloat(gr.amount||0),0):bt,0),jt=ft-Me,It={};r.forEach(bt=>{It[bt.name]=0}),n.forEach(bt=>{It[bt.class]||(It[bt.class]=0),It[bt.class]+=1});const ut=q.reduce((bt,Yt)=>(bt[Yt.category]||(bt[Yt.category]=0),bt[Yt.category]+=parseFloat(Yt.amount),bt),{}),Rt=ve.reduce((bt,Yt)=>(bt[Yt.position]||(bt[Yt.position]=0),bt[Yt.position]+=1,bt),{}),Ye=r.length,St=r.reduce((bt,Yt)=>bt+(Yt.sections?.length||0),0),Jt=r.flatMap(bt=>bt.subjects?.map(Yt=>Yt.name)||[]),ar=[...new Set(Jt)].length;return{totalExpenses:Me,totalStaffSalaries:Ge,otherExpenses:je,netProfit:jt,totalStudents:Se,totalFeesCollected:ft,studentsByClass:It,expensesByCategory:ut,staffByPosition:Rt,totalStaff:ve.length,totalClasses:Ye,totalSections:St,totalSubjects:ar}}},[n,ke,r,ee,ue,b]),Ne=ne.useMemo(()=>{const{filteredExpenses:q,filteredStaff:ve,filteredFees:Fe,filteredSubsidies:Qe}=ke,Ge=[];return n.forEach(je=>{Ge.push({id:`student-${je.id}`,type:"Student Admission",description:`${je.firstName} admitted to ${je.class}`,date:je.admissionTimestamp||je.dateOfAdmission||new Date().toISOString(),category:"Students",amount:0})}),b==="subsidies"?Qe.forEach(je=>{je.status==="received"&&je.receivedDate&&Ge.push({id:`subsidy-${je.id}`,type:"Subsidy Received",description:`${je.description} for ${je.quarter} ${je.year}`,date:je.receivedDate,category:"Income",amount:parseFloat(je.amount)})}):Fe.forEach(je=>{je.feesHistory&&je.feesHistory.filter(Me=>Me.status==="paid"&&(Me.paymentTimestamp||Me.date)).forEach(Me=>{let Se="";Me.type==="admission"?Se=`Admission fees collected from ${je.firstName}`:Se=`Fee collected for ${Me.month} from ${je.firstName}`,Ge.push({id:`fee-${je.id}-${Me.id}`,type:"Fee Collection",description:Se,date:Me.paymentTimestamp||Me.date,category:"Fees",amount:parseFloat(Me.amount)})})}),q.forEach(je=>{Ge.push({id:`expense-${je.id}`,type:"Expense",description:`${je.description}`,date:je.addedTimestamp||je.date||new Date().toISOString(),category:"Expenses",amount:-parseFloat(je.amount)})}),ve.forEach(je=>{je.salaryHistory&&(je.salaryHistory.filter(Me=>Me.status==="paid"&&(Me.paymentTimestamp||Me.paymentDate)).forEach(Me=>{Ge.push({id:`salary-${je.id}-${Me.id}`,type:"Salary Payment",description:`Salary paid to ${je.firstName} ${je.lastName} for ${Me.month}`,date:Me.paymentTimestamp||Me.paymentDate,category:"Expenses",amount:-parseFloat(Me.netSalary||0)})}),je.salaryHistory.filter(Me=>Me.status==="advance"&&(Me.paymentTimestamp||Me.paymentDate)).forEach(Me=>{Ge.push({id:`advance-${je.id}-${Me.id}`,type:"Advance Payment",description:`Advance paid to ${je.firstName} ${je.lastName} for ${Me.reason||"No reason provided"}`,date:Me.paymentTimestamp||Me.paymentDate,category:"Expenses",amount:-Math.abs(parseFloat(Me.netSalary||0))})})),Ge.push({id:`staff-${je.id}`,type:"Staff",description:`${je.firstName} ${je.lastName} joined as ${je.position}`,date:je.addedTimestamp||je.dateOfJoining||new Date().toISOString(),category:"Staff",amount:0})}),Ge.sort((je,Me)=>{const Se=new Date(je.date),ft=new Date(Me.date);return isNaN(Se.getTime())&&isNaN(ft.getTime())?0:isNaN(Se.getTime())?1:isNaN(ft.getTime())?-1:ft-Se})},[n,ke,ee,ue,b]),xe=ne.useMemo(()=>{let q=[...Ne];M&&(q=q.filter(Fe=>Fe.description.toLowerCase().includes(M.toLowerCase())||Fe.type.toLowerCase().includes(M.toLowerCase())||Fe.category.toLowerCase().includes(M.toLowerCase()))),H==="in"?q=q.filter(Fe=>Fe.category==="Income"&&Fe.amount>0||Fe.category==="Students"):H==="out"&&(q=q.filter(Fe=>Fe.category==="Expenses"&&Fe.amount<0||Fe.category==="Fees"&&Fe.amount<0)),F==="custom"&&L.start&&L.end&&(q=q.filter(Fe=>{const Qe=new Date(Fe.date),Ge=new Date(L.start),je=new Date(L.end);return je.setHours(23,59,59,999),Qe>=Ge&&Qe<=je}));const ve=new Date;if(F==="daily"){const Fe=new Date(ve.getFullYear(),ve.getMonth(),ve.getDate()),Qe=new Date(Fe);Qe.setDate(Qe.getDate()+1),q=q.filter(Ge=>{const je=new Date(Ge.date);return je>=Fe&&je<Qe})}else if(F==="monthly"){const Fe=new Date(ve.getFullYear(),ve.getMonth(),1),Qe=new Date(ve.getFullYear(),ve.getMonth()+1,1);q=q.filter(Ge=>{const je=new Date(Ge.date);return je>=Fe&&je<Qe})}return q},[Ne,F,M,L,H]),we=ne.useMemo(()=>{let q=0,ve=0;return xe.forEach(Fe=>{Fe.category==="Income"&&Fe.amount>0||Fe.category==="Students"||Fe.category==="Fees"&&Fe.amount>0?q+=Math.abs(Fe.amount):(Fe.category==="Expenses"&&Fe.amount<0||Fe.category==="Fees"&&Fe.amount<0)&&(ve+=Math.abs(Fe.amount))}),{income:q,expense:ve,net:q-ve}},[xe]),ye=()=>{const q=[["Activity Type","Description","Category","Date","Amount"],...xe.map(Ge=>[Ge.type,Ge.description,Ge.category,Ge.date?new Date(Ge.date).toISOString().split("T")[0]:"N/A",Ge.amount])].map(Ge=>Ge.join(",")).join(`
`),ve=new Blob([q],{type:"text/csv;charset=utf-8;"}),Fe=URL.createObjectURL(ve),Qe=document.createElement("a");Qe.setAttribute("href",Fe),Qe.setAttribute("download",`activities-${F}.csv`),Qe.style.visibility="hidden",document.body.appendChild(Qe),Qe.click(),document.body.removeChild(Qe)},te=()=>{Z(!0),setTimeout(()=>{window.scrollTo(0,0),setTimeout(()=>{window.print(),setTimeout(()=>{Z(!1)},1e3)},500)},100)},V=q=>z(q),le=pe*J,de=le-J,X=xe.slice(de,le),ie=Math.ceil(xe.length/J);At.useEffect(()=>{z(1)},[xe]);const G=b==="subsidies"?i.jsxs(i.Fragment,{children:[i.jsxs("select",{value:ue,onChange:q=>ae(q.target.value),className:"block w-full md:w-auto pl-3 pr-10 py-1 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm",children:[i.jsx("option",{value:"all",children:"All Years"}),ge.map(q=>i.jsx("option",{value:q,children:q},q))]}),i.jsxs("select",{value:ee,onChange:q=>se(q.target.value),className:"block w-full md:w-auto pl-3 pr-10 py-1 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm",children:[i.jsx("option",{value:"all",children:"All Quarters"}),fe.map(q=>i.jsx("option",{value:q,children:`Q${q}`},q))]})]}):null;return i.jsxs("div",{children:[i.jsx(jd,{title:`Dashboard - ${u?.role||"Guest"}`,subtitle:`Welcome back, ${u?.username||"Guest"}! Here's what's happening with your school today.`,quarterYearFilters:G}),i.jsx(md,{showFor:"ngo",children:i.jsx("div",{className:"mb-6",children:i.jsx(oj,{})})}),i.jsx(nD,{}),g()&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[i.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-cyan-600 rounded-2xl shadow-lg p-6 text-white transform transition-all duration-300 hover:scale-[1.02]",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-white text-opacity-90 text-sm font-medium mb-1",children:"Total Students"}),i.jsx("p",{className:"text-3xl font-bold mt-2",children:he.totalStudents})]}),i.jsx("div",{className:"p-3 bg-white bg-opacity-20 rounded-lg",children:i.jsx(_c,{className:"text-white text-xl"})})]})}),i.jsx("div",{className:"bg-gradient-to-br from-green-500 to-emerald-600 rounded-2xl shadow-lg p-6 text-white transform transition-all duration-300 hover:scale-[1.02]",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-white text-opacity-90 text-sm font-medium mb-1",children:"Total Classes"}),i.jsx("p",{className:"text-3xl font-bold mt-2",children:he.totalClasses})]}),i.jsx("div",{className:"p-3 bg-white bg-opacity-20 rounded-lg",children:i.jsx(nc,{className:"text-white text-xl"})})]})}),i.jsx("div",{className:"bg-gradient-to-br from-purple-500 to-fuchsia-600 rounded-2xl shadow-lg p-6 text-white transform transition-all duration-300 hover:scale-[1.02]",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-white text-opacity-90 text-sm font-medium mb-1",children:"Total Sections"}),i.jsx("p",{className:"text-3xl font-bold mt-2",children:he.totalSections})]}),i.jsx("div",{className:"p-3 bg-white bg-opacity-20 rounded-lg",children:i.jsx(OA,{className:"text-white text-xl"})})]})}),i.jsx("div",{className:"bg-gradient-to-br from-amber-500 to-orange-600 rounded-2xl shadow-lg p-6 text-white transform transition-all duration-300 hover:scale-[1.02]",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-white text-opacity-90 text-sm font-medium mb-1",children:"Total Staff"}),i.jsx("p",{className:"text-3xl font-bold mt-2",children:he.totalStaff})]}),i.jsx("div",{className:"p-3 bg-white bg-opacity-20 rounded-lg",children:i.jsx(rD,{className:"text-white text-xl"})})]})})]}),i.jsxs("div",{className:"bg-white shadow-lg p-6",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4 md:mb-0",children:"Recent Activities"}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsxs("select",{value:F,onChange:q=>{C(q.target.value),q.target.value!=="custom"&&T({start:"",end:""})},className:"block w-full md:w-auto pl-3 pr-10 py-1 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm",children:[i.jsx("option",{value:"all",children:"All Activities"}),i.jsx("option",{value:"daily",children:"Today"}),i.jsx("option",{value:"monthly",children:"This Month"}),i.jsx("option",{value:"custom",children:"Custom Range"})]}),i.jsxs("select",{value:H,onChange:q=>O(q.target.value),className:"block w-full md:w-auto pl-3 pr-10 py-1 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm",children:[i.jsx("option",{value:"all",children:"All Transactions"}),i.jsx("option",{value:"in",children:"Income"}),i.jsx("option",{value:"out",children:"Expenses"})]}),i.jsxs("div",{className:"relative flex-grow max-w-md md:max-w-xs",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Bi,{className:"text-gray-400"})}),i.jsx("input",{type:"text",placeholder:"Search activities...",className:"block w-full pl-10 pr-3 py-1 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm",value:M,onChange:q=>_(q.target.value)})]}),i.jsxs("button",{onClick:ye,className:"flex items-center px-3 py-1 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:[i.jsx(lu,{className:"mr-1"})," CSV"]}),i.jsxs("button",{onClick:te,className:"flex items-center px-3 py-1 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:[i.jsx(mi,{className:"mr-1"})," Print"]})]})]}),F==="custom"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),i.jsx("input",{type:"date",className:"block w-full pl-3 pr-10 py-1 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm",value:L.start,onChange:q=>T({...L,start:q.target.value})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),i.jsx("input",{type:"date",className:"block w-full pl-3 pr-10 py-1 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm",value:L.end,onChange:q=>T({...L,end:q.target.value})})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Activity"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:X.length>0?X.map(q=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:q.type}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:q.description}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:i.jsx("span",{className:`px-2 py-1 rounded text-xs ${q.category==="Students"?"bg-blue-100 text-blue-800":q.category==="Fees"?"bg-green-100 text-green-800":q.category==="Income"?"bg-emerald-100 text-emerald-800":q.category==="Expenses"?"bg-red-100 text-red-800":q.category==="Staff"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:q.category})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium",children:q.amount>=0?i.jsxs("span",{className:"text-green-600",children:["+Rs ",q.amount.toLocaleString()]}):i.jsxs("span",{className:"text-red-600",children:["-Rs ",Math.abs(q.amount).toLocaleString()]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm text-gray-500",children:q.date?new Date(q.date).toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}):"N/A"})]},q.id)):i.jsx("tr",{children:i.jsx("td",{colSpan:"5",className:"px-6 py-4 text-center text-sm text-gray-500",children:"No activities found"})})})]})}),ie>1&&i.jsxs("div",{className:"flex items-center justify-between border-t border-gray-200 px-4 py-3 sm:px-6 mt-4",children:[i.jsxs("div",{className:"flex flex-1 justify-between sm:hidden",children:[i.jsx("button",{onClick:()=>V(pe-1),disabled:pe===1,className:`relative inline-flex items-center px-4 py-2 text-sm font-medium rounded-md ${pe===1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:"Previous"}),i.jsx("button",{onClick:()=>V(pe+1),disabled:pe===ie,className:`relative ml-3 inline-flex items-center px-4 py-2 text-sm font-medium rounded-md ${pe===ie?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:"Next"})]}),i.jsxs("div",{className:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between",children:[i.jsx("div",{children:i.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",i.jsx("span",{className:"font-medium",children:de+1})," to"," ",i.jsx("span",{className:"font-medium",children:Math.min(le,xe.length)})," ","of ",i.jsx("span",{className:"font-medium",children:xe.length})," results"]})}),i.jsx("div",{children:i.jsxs("nav",{className:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination",children:[i.jsxs("button",{onClick:()=>V(pe-1),disabled:pe===1,className:`relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600 ${pe===1?"cursor-not-allowed":""}`,children:[i.jsx("span",{className:"sr-only",children:"Previous"}),i.jsx(l5,{})]}),[...Array(ie)].map((q,ve)=>{const Fe=ve+1;return Fe===1||Fe===ie||Fe>=pe-1&&Fe<=pe+1?i.jsx("button",{onClick:()=>V(Fe),className:`relative inline-flex items-center px-4 py-2 text-sm font-semibold ${pe===Fe?"z-10 bg-blue-600 text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:outline-offset-0"}`,children:Fe},Fe):Fe===pe-2||Fe===pe+2?i.jsx("span",{className:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700 ring-1 ring-inset ring-gray-300 focus:outline-offset-0",children:"..."},Fe):null}),i.jsxs("button",{onClick:()=>V(pe+1),disabled:pe===ie,className:`relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 ${pe===ie?"cursor-not-allowed":""}`,children:[i.jsx("span",{className:"sr-only",children:"Next"}),i.jsx(c5,{})]})]})})]})]})]}),m()&&i.jsx("div",{className:"bg-white shadow-lg p-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx("div",{className:"bg-gradient-to-r from-red-500 to-red-600 rounded-xl shadow p-4 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-red-100 text-xs font-medium",children:"Total Expenses"}),i.jsxs("p",{className:"text-2xl font-bold mt-1",children:["Rs ",Math.abs(we.expense).toLocaleString()]})]}),i.jsx("div",{className:"p-2 bg-red-400 bg-opacity-30 rounded-full",children:i.jsx(bd,{size:20})})]})}),i.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-xl shadow p-4 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-green-100 text-xs font-medium",children:"Total Income"}),i.jsxs("p",{className:"text-2xl font-bold mt-1",children:["Rs ",we.income.toLocaleString()]})]}),i.jsx("div",{className:"p-2 bg-green-400 bg-opacity-30 rounded-full",children:i.jsx(i0,{size:20})})]})}),i.jsx("div",{className:`bg-gradient-to-r ${we.net>=0?"from-blue-500 to-blue-600":"from-orange-500 to-orange-600"} rounded-xl shadow p-4 text-white`,children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-blue-100 text-xs font-medium",children:"Net Profit/Loss"}),i.jsxs("p",{className:"text-2xl font-bold mt-1",children:["Rs ",Math.abs(we.net).toLocaleString(),i.jsx("span",{className:"text-sm ml-1",children:we.net>=0?" (Profit)":" (Loss)"})]})]}),i.jsx("div",{className:"p-2 bg-blue-400 bg-opacity-30 rounded-full",children:i.jsx(Ik,{size:20})})]})})]})}),Q&&i.jsx(sD,{filteredActivities:xe,calculateTotals:we,activityType:F,transactionType:H,selectedQuarter:ee,selectedYear:ue,schoolInfo:e})]})},Bd=({currentPage:n,totalPages:a,itemsPerPage:t,totalItems:r,paginate:s,onPageChange:e,nextPage:u,prevPage:f,showItemsInfo:m=!0})=>{const g=s||e;if(a<=1)return null;const b=n*t,j=b-t+1,F=Math.min(b,r),C=Math.min(j,F);return i.jsxs("div",{className:"flex items-center justify-between border-t border-gray-200 px-4 py-3 sm:px-6 mt-4",children:[m&&i.jsxs("div",{className:"flex flex-1 justify-between sm:hidden",children:[i.jsx("button",{onClick:()=>typeof f=="function"?f():typeof g=="function"?g(n-1):console.error("prevPage and handlePageChange are not functions"),disabled:n===1,className:`relative inline-flex items-center px-4 py-2 text-sm font-medium rounded-md ${n===1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:"Previous"}),i.jsx("button",{onClick:()=>typeof u=="function"?u():typeof g=="function"?g(n+1):console.error("nextPage and handlePageChange are not functions"),disabled:n===a,className:`relative ml-3 inline-flex items-center px-4 py-2 text-sm font-medium rounded-md ${n===a?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:"Next"})]}),i.jsxs("div",{className:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between",children:[m&&i.jsx("div",{children:i.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",i.jsx("span",{className:"font-medium",children:C})," to"," ",i.jsx("span",{className:"font-medium",children:F})," ","of ",i.jsx("span",{className:"font-medium",children:r})," results"]})}),i.jsx("div",{children:i.jsxs("nav",{className:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination",children:[i.jsxs("button",{onClick:()=>typeof f=="function"?f():typeof g=="function"?g(n-1):console.error("prevPage and handlePageChange are not functions"),disabled:n===1,className:`relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600 ${n===1?"cursor-not-allowed":""}`,children:[i.jsx("span",{className:"sr-only",children:"Previous"}),i.jsx(l5,{className:"h-5 w-5"})]}),[...Array(a)].map((M,_)=>{const L=_+1;return L===1||L===a||L>=n-1&&L<=n+1?i.jsx("button",{onClick:()=>typeof g=="function"?g(L):console.error("handlePageChange is not a function"),className:`relative inline-flex items-center px-4 py-2 text-sm font-semibold ${n===L?"z-10 bg-blue-600 text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:outline-offset-0"}`,children:L},L):L===n-2||L===n+2?i.jsx("span",{className:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700 ring-1 ring-inset ring-gray-300 focus:outline-offset-0",children:"..."},L):null}),i.jsxs("button",{onClick:()=>typeof u=="function"?u():typeof g=="function"?g(n+1):console.error("nextPage and handlePageChange are not functions"),disabled:n===a,className:`relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 ${n===a?"cursor-not-allowed":""}`,children:[i.jsx("span",{className:"sr-only",children:"Next"}),i.jsx(c5,{className:"h-5 w-5"})]})]})})]})]})};function v2(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Bx={exports:{}},w2={exports:{}};/*! cpexcel.js (C) 2013-present SheetJS -- http://sheetjs.com */var oD=w2.exports,D4;function lD(){return D4||(D4=1,(function(n){var a={version:"1.15.0"};a[437]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[620]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[737]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[850]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[852]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[857]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[861]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[865]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[866]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[874]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[895]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[932]=(function(){var t=[],r={},s=[],e;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=s[0].length;++e)s[0][e].charCodeAt(0)!==65533&&(r[s[0][e]]=0+e,t[0+e]=s[0][e]);for(s[129]="".split(""),e=0;e!=s[129].length;++e)s[129][e].charCodeAt(0)!==65533&&(r[s[129][e]]=33024+e,t[33024+e]=s[129][e]);for(s[130]="".split(""),e=0;e!=s[130].length;++e)s[130][e].charCodeAt(0)!==65533&&(r[s[130][e]]=33280+e,t[33280+e]=s[130][e]);for(s[131]="".split(""),e=0;e!=s[131].length;++e)s[131][e].charCodeAt(0)!==65533&&(r[s[131][e]]=33536+e,t[33536+e]=s[131][e]);for(s[132]="".split(""),e=0;e!=s[132].length;++e)s[132][e].charCodeAt(0)!==65533&&(r[s[132][e]]=33792+e,t[33792+e]=s[132][e]);for(s[135]="".split(""),e=0;e!=s[135].length;++e)s[135][e].charCodeAt(0)!==65533&&(r[s[135][e]]=34560+e,t[34560+e]=s[135][e]);for(s[136]="".split(""),e=0;e!=s[136].length;++e)s[136][e].charCodeAt(0)!==65533&&(r[s[136][e]]=34816+e,t[34816+e]=s[136][e]);for(s[137]="".split(""),e=0;e!=s[137].length;++e)s[137][e].charCodeAt(0)!==65533&&(r[s[137][e]]=35072+e,t[35072+e]=s[137][e]);for(s[138]="".split(""),e=0;e!=s[138].length;++e)s[138][e].charCodeAt(0)!==65533&&(r[s[138][e]]=35328+e,t[35328+e]=s[138][e]);for(s[139]="".split(""),e=0;e!=s[139].length;++e)s[139][e].charCodeAt(0)!==65533&&(r[s[139][e]]=35584+e,t[35584+e]=s[139][e]);for(s[140]="".split(""),e=0;e!=s[140].length;++e)s[140][e].charCodeAt(0)!==65533&&(r[s[140][e]]=35840+e,t[35840+e]=s[140][e]);for(s[141]="".split(""),e=0;e!=s[141].length;++e)s[141][e].charCodeAt(0)!==65533&&(r[s[141][e]]=36096+e,t[36096+e]=s[141][e]);for(s[142]="".split(""),e=0;e!=s[142].length;++e)s[142][e].charCodeAt(0)!==65533&&(r[s[142][e]]=36352+e,t[36352+e]=s[142][e]);for(s[143]="".split(""),e=0;e!=s[143].length;++e)s[143][e].charCodeAt(0)!==65533&&(r[s[143][e]]=36608+e,t[36608+e]=s[143][e]);for(s[144]="".split(""),e=0;e!=s[144].length;++e)s[144][e].charCodeAt(0)!==65533&&(r[s[144][e]]=36864+e,t[36864+e]=s[144][e]);for(s[145]="".split(""),e=0;e!=s[145].length;++e)s[145][e].charCodeAt(0)!==65533&&(r[s[145][e]]=37120+e,t[37120+e]=s[145][e]);for(s[146]="".split(""),e=0;e!=s[146].length;++e)s[146][e].charCodeAt(0)!==65533&&(r[s[146][e]]=37376+e,t[37376+e]=s[146][e]);for(s[147]="".split(""),e=0;e!=s[147].length;++e)s[147][e].charCodeAt(0)!==65533&&(r[s[147][e]]=37632+e,t[37632+e]=s[147][e]);for(s[148]="".split(""),e=0;e!=s[148].length;++e)s[148][e].charCodeAt(0)!==65533&&(r[s[148][e]]=37888+e,t[37888+e]=s[148][e]);for(s[149]="".split(""),e=0;e!=s[149].length;++e)s[149][e].charCodeAt(0)!==65533&&(r[s[149][e]]=38144+e,t[38144+e]=s[149][e]);for(s[150]="".split(""),e=0;e!=s[150].length;++e)s[150][e].charCodeAt(0)!==65533&&(r[s[150][e]]=38400+e,t[38400+e]=s[150][e]);for(s[151]="".split(""),e=0;e!=s[151].length;++e)s[151][e].charCodeAt(0)!==65533&&(r[s[151][e]]=38656+e,t[38656+e]=s[151][e]);for(s[152]="".split(""),e=0;e!=s[152].length;++e)s[152][e].charCodeAt(0)!==65533&&(r[s[152][e]]=38912+e,t[38912+e]=s[152][e]);for(s[153]="".split(""),e=0;e!=s[153].length;++e)s[153][e].charCodeAt(0)!==65533&&(r[s[153][e]]=39168+e,t[39168+e]=s[153][e]);for(s[154]="".split(""),e=0;e!=s[154].length;++e)s[154][e].charCodeAt(0)!==65533&&(r[s[154][e]]=39424+e,t[39424+e]=s[154][e]);for(s[155]="".split(""),e=0;e!=s[155].length;++e)s[155][e].charCodeAt(0)!==65533&&(r[s[155][e]]=39680+e,t[39680+e]=s[155][e]);for(s[156]="".split(""),e=0;e!=s[156].length;++e)s[156][e].charCodeAt(0)!==65533&&(r[s[156][e]]=39936+e,t[39936+e]=s[156][e]);for(s[157]="".split(""),e=0;e!=s[157].length;++e)s[157][e].charCodeAt(0)!==65533&&(r[s[157][e]]=40192+e,t[40192+e]=s[157][e]);for(s[158]="".split(""),e=0;e!=s[158].length;++e)s[158][e].charCodeAt(0)!==65533&&(r[s[158][e]]=40448+e,t[40448+e]=s[158][e]);for(s[159]="".split(""),e=0;e!=s[159].length;++e)s[159][e].charCodeAt(0)!==65533&&(r[s[159][e]]=40704+e,t[40704+e]=s[159][e]);for(s[224]="".split(""),e=0;e!=s[224].length;++e)s[224][e].charCodeAt(0)!==65533&&(r[s[224][e]]=57344+e,t[57344+e]=s[224][e]);for(s[225]="".split(""),e=0;e!=s[225].length;++e)s[225][e].charCodeAt(0)!==65533&&(r[s[225][e]]=57600+e,t[57600+e]=s[225][e]);for(s[226]="".split(""),e=0;e!=s[226].length;++e)s[226][e].charCodeAt(0)!==65533&&(r[s[226][e]]=57856+e,t[57856+e]=s[226][e]);for(s[227]="".split(""),e=0;e!=s[227].length;++e)s[227][e].charCodeAt(0)!==65533&&(r[s[227][e]]=58112+e,t[58112+e]=s[227][e]);for(s[228]="".split(""),e=0;e!=s[228].length;++e)s[228][e].charCodeAt(0)!==65533&&(r[s[228][e]]=58368+e,t[58368+e]=s[228][e]);for(s[229]="".split(""),e=0;e!=s[229].length;++e)s[229][e].charCodeAt(0)!==65533&&(r[s[229][e]]=58624+e,t[58624+e]=s[229][e]);for(s[230]="".split(""),e=0;e!=s[230].length;++e)s[230][e].charCodeAt(0)!==65533&&(r[s[230][e]]=58880+e,t[58880+e]=s[230][e]);for(s[231]="".split(""),e=0;e!=s[231].length;++e)s[231][e].charCodeAt(0)!==65533&&(r[s[231][e]]=59136+e,t[59136+e]=s[231][e]);for(s[232]="".split(""),e=0;e!=s[232].length;++e)s[232][e].charCodeAt(0)!==65533&&(r[s[232][e]]=59392+e,t[59392+e]=s[232][e]);for(s[233]="".split(""),e=0;e!=s[233].length;++e)s[233][e].charCodeAt(0)!==65533&&(r[s[233][e]]=59648+e,t[59648+e]=s[233][e]);for(s[234]="".split(""),e=0;e!=s[234].length;++e)s[234][e].charCodeAt(0)!==65533&&(r[s[234][e]]=59904+e,t[59904+e]=s[234][e]);for(s[237]="".split(""),e=0;e!=s[237].length;++e)s[237][e].charCodeAt(0)!==65533&&(r[s[237][e]]=60672+e,t[60672+e]=s[237][e]);for(s[238]="".split(""),e=0;e!=s[238].length;++e)s[238][e].charCodeAt(0)!==65533&&(r[s[238][e]]=60928+e,t[60928+e]=s[238][e]);for(s[250]="".split(""),e=0;e!=s[250].length;++e)s[250][e].charCodeAt(0)!==65533&&(r[s[250][e]]=64e3+e,t[64e3+e]=s[250][e]);for(s[251]="".split(""),e=0;e!=s[251].length;++e)s[251][e].charCodeAt(0)!==65533&&(r[s[251][e]]=64256+e,t[64256+e]=s[251][e]);for(s[252]="".split(""),e=0;e!=s[252].length;++e)s[252][e].charCodeAt(0)!==65533&&(r[s[252][e]]=64512+e,t[64512+e]=s[252][e]);return{enc:r,dec:t}})(),a[936]=(function(){var t=[],r={},s=[],e;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=s[0].length;++e)s[0][e].charCodeAt(0)!==65533&&(r[s[0][e]]=0+e,t[0+e]=s[0][e]);for(s[129]="".split(""),e=0;e!=s[129].length;++e)s[129][e].charCodeAt(0)!==65533&&(r[s[129][e]]=33024+e,t[33024+e]=s[129][e]);for(s[130]="".split(""),e=0;e!=s[130].length;++e)s[130][e].charCodeAt(0)!==65533&&(r[s[130][e]]=33280+e,t[33280+e]=s[130][e]);for(s[131]="".split(""),e=0;e!=s[131].length;++e)s[131][e].charCodeAt(0)!==65533&&(r[s[131][e]]=33536+e,t[33536+e]=s[131][e]);for(s[132]="".split(""),e=0;e!=s[132].length;++e)s[132][e].charCodeAt(0)!==65533&&(r[s[132][e]]=33792+e,t[33792+e]=s[132][e]);for(s[133]="".split(""),e=0;e!=s[133].length;++e)s[133][e].charCodeAt(0)!==65533&&(r[s[133][e]]=34048+e,t[34048+e]=s[133][e]);for(s[134]="".split(""),e=0;e!=s[134].length;++e)s[134][e].charCodeAt(0)!==65533&&(r[s[134][e]]=34304+e,t[34304+e]=s[134][e]);for(s[135]="".split(""),e=0;e!=s[135].length;++e)s[135][e].charCodeAt(0)!==65533&&(r[s[135][e]]=34560+e,t[34560+e]=s[135][e]);for(s[136]="".split(""),e=0;e!=s[136].length;++e)s[136][e].charCodeAt(0)!==65533&&(r[s[136][e]]=34816+e,t[34816+e]=s[136][e]);for(s[137]="".split(""),e=0;e!=s[137].length;++e)s[137][e].charCodeAt(0)!==65533&&(r[s[137][e]]=35072+e,t[35072+e]=s[137][e]);for(s[138]="".split(""),e=0;e!=s[138].length;++e)s[138][e].charCodeAt(0)!==65533&&(r[s[138][e]]=35328+e,t[35328+e]=s[138][e]);for(s[139]="".split(""),e=0;e!=s[139].length;++e)s[139][e].charCodeAt(0)!==65533&&(r[s[139][e]]=35584+e,t[35584+e]=s[139][e]);for(s[140]="".split(""),e=0;e!=s[140].length;++e)s[140][e].charCodeAt(0)!==65533&&(r[s[140][e]]=35840+e,t[35840+e]=s[140][e]);for(s[141]="".split(""),e=0;e!=s[141].length;++e)s[141][e].charCodeAt(0)!==65533&&(r[s[141][e]]=36096+e,t[36096+e]=s[141][e]);for(s[142]="".split(""),e=0;e!=s[142].length;++e)s[142][e].charCodeAt(0)!==65533&&(r[s[142][e]]=36352+e,t[36352+e]=s[142][e]);for(s[143]="".split(""),e=0;e!=s[143].length;++e)s[143][e].charCodeAt(0)!==65533&&(r[s[143][e]]=36608+e,t[36608+e]=s[143][e]);for(s[144]="".split(""),e=0;e!=s[144].length;++e)s[144][e].charCodeAt(0)!==65533&&(r[s[144][e]]=36864+e,t[36864+e]=s[144][e]);for(s[145]="".split(""),e=0;e!=s[145].length;++e)s[145][e].charCodeAt(0)!==65533&&(r[s[145][e]]=37120+e,t[37120+e]=s[145][e]);for(s[146]="".split(""),e=0;e!=s[146].length;++e)s[146][e].charCodeAt(0)!==65533&&(r[s[146][e]]=37376+e,t[37376+e]=s[146][e]);for(s[147]="".split(""),e=0;e!=s[147].length;++e)s[147][e].charCodeAt(0)!==65533&&(r[s[147][e]]=37632+e,t[37632+e]=s[147][e]);for(s[148]="".split(""),e=0;e!=s[148].length;++e)s[148][e].charCodeAt(0)!==65533&&(r[s[148][e]]=37888+e,t[37888+e]=s[148][e]);for(s[149]="".split(""),e=0;e!=s[149].length;++e)s[149][e].charCodeAt(0)!==65533&&(r[s[149][e]]=38144+e,t[38144+e]=s[149][e]);for(s[150]="".split(""),e=0;e!=s[150].length;++e)s[150][e].charCodeAt(0)!==65533&&(r[s[150][e]]=38400+e,t[38400+e]=s[150][e]);for(s[151]="".split(""),e=0;e!=s[151].length;++e)s[151][e].charCodeAt(0)!==65533&&(r[s[151][e]]=38656+e,t[38656+e]=s[151][e]);for(s[152]="".split(""),e=0;e!=s[152].length;++e)s[152][e].charCodeAt(0)!==65533&&(r[s[152][e]]=38912+e,t[38912+e]=s[152][e]);for(s[153]="".split(""),e=0;e!=s[153].length;++e)s[153][e].charCodeAt(0)!==65533&&(r[s[153][e]]=39168+e,t[39168+e]=s[153][e]);for(s[154]="".split(""),e=0;e!=s[154].length;++e)s[154][e].charCodeAt(0)!==65533&&(r[s[154][e]]=39424+e,t[39424+e]=s[154][e]);for(s[155]="".split(""),e=0;e!=s[155].length;++e)s[155][e].charCodeAt(0)!==65533&&(r[s[155][e]]=39680+e,t[39680+e]=s[155][e]);for(s[156]="".split(""),e=0;e!=s[156].length;++e)s[156][e].charCodeAt(0)!==65533&&(r[s[156][e]]=39936+e,t[39936+e]=s[156][e]);for(s[157]="".split(""),e=0;e!=s[157].length;++e)s[157][e].charCodeAt(0)!==65533&&(r[s[157][e]]=40192+e,t[40192+e]=s[157][e]);for(s[158]="".split(""),e=0;e!=s[158].length;++e)s[158][e].charCodeAt(0)!==65533&&(r[s[158][e]]=40448+e,t[40448+e]=s[158][e]);for(s[159]="".split(""),e=0;e!=s[159].length;++e)s[159][e].charCodeAt(0)!==65533&&(r[s[159][e]]=40704+e,t[40704+e]=s[159][e]);for(s[160]="".split(""),e=0;e!=s[160].length;++e)s[160][e].charCodeAt(0)!==65533&&(r[s[160][e]]=40960+e,t[40960+e]=s[160][e]);for(s[161]="".split(""),e=0;e!=s[161].length;++e)s[161][e].charCodeAt(0)!==65533&&(r[s[161][e]]=41216+e,t[41216+e]=s[161][e]);for(s[162]="".split(""),e=0;e!=s[162].length;++e)s[162][e].charCodeAt(0)!==65533&&(r[s[162][e]]=41472+e,t[41472+e]=s[162][e]);for(s[163]="".split(""),e=0;e!=s[163].length;++e)s[163][e].charCodeAt(0)!==65533&&(r[s[163][e]]=41728+e,t[41728+e]=s[163][e]);for(s[164]="".split(""),e=0;e!=s[164].length;++e)s[164][e].charCodeAt(0)!==65533&&(r[s[164][e]]=41984+e,t[41984+e]=s[164][e]);for(s[165]="".split(""),e=0;e!=s[165].length;++e)s[165][e].charCodeAt(0)!==65533&&(r[s[165][e]]=42240+e,t[42240+e]=s[165][e]);for(s[166]="".split(""),e=0;e!=s[166].length;++e)s[166][e].charCodeAt(0)!==65533&&(r[s[166][e]]=42496+e,t[42496+e]=s[166][e]);for(s[167]="".split(""),e=0;e!=s[167].length;++e)s[167][e].charCodeAt(0)!==65533&&(r[s[167][e]]=42752+e,t[42752+e]=s[167][e]);for(s[168]="".split(""),e=0;e!=s[168].length;++e)s[168][e].charCodeAt(0)!==65533&&(r[s[168][e]]=43008+e,t[43008+e]=s[168][e]);for(s[169]="".split(""),e=0;e!=s[169].length;++e)s[169][e].charCodeAt(0)!==65533&&(r[s[169][e]]=43264+e,t[43264+e]=s[169][e]);for(s[170]="".split(""),e=0;e!=s[170].length;++e)s[170][e].charCodeAt(0)!==65533&&(r[s[170][e]]=43520+e,t[43520+e]=s[170][e]);for(s[171]="".split(""),e=0;e!=s[171].length;++e)s[171][e].charCodeAt(0)!==65533&&(r[s[171][e]]=43776+e,t[43776+e]=s[171][e]);for(s[172]="".split(""),e=0;e!=s[172].length;++e)s[172][e].charCodeAt(0)!==65533&&(r[s[172][e]]=44032+e,t[44032+e]=s[172][e]);for(s[173]="".split(""),e=0;e!=s[173].length;++e)s[173][e].charCodeAt(0)!==65533&&(r[s[173][e]]=44288+e,t[44288+e]=s[173][e]);for(s[174]="".split(""),e=0;e!=s[174].length;++e)s[174][e].charCodeAt(0)!==65533&&(r[s[174][e]]=44544+e,t[44544+e]=s[174][e]);for(s[175]="".split(""),e=0;e!=s[175].length;++e)s[175][e].charCodeAt(0)!==65533&&(r[s[175][e]]=44800+e,t[44800+e]=s[175][e]);for(s[176]="".split(""),e=0;e!=s[176].length;++e)s[176][e].charCodeAt(0)!==65533&&(r[s[176][e]]=45056+e,t[45056+e]=s[176][e]);for(s[177]="".split(""),e=0;e!=s[177].length;++e)s[177][e].charCodeAt(0)!==65533&&(r[s[177][e]]=45312+e,t[45312+e]=s[177][e]);for(s[178]="".split(""),e=0;e!=s[178].length;++e)s[178][e].charCodeAt(0)!==65533&&(r[s[178][e]]=45568+e,t[45568+e]=s[178][e]);for(s[179]="".split(""),e=0;e!=s[179].length;++e)s[179][e].charCodeAt(0)!==65533&&(r[s[179][e]]=45824+e,t[45824+e]=s[179][e]);for(s[180]="".split(""),e=0;e!=s[180].length;++e)s[180][e].charCodeAt(0)!==65533&&(r[s[180][e]]=46080+e,t[46080+e]=s[180][e]);for(s[181]="".split(""),e=0;e!=s[181].length;++e)s[181][e].charCodeAt(0)!==65533&&(r[s[181][e]]=46336+e,t[46336+e]=s[181][e]);for(s[182]="".split(""),e=0;e!=s[182].length;++e)s[182][e].charCodeAt(0)!==65533&&(r[s[182][e]]=46592+e,t[46592+e]=s[182][e]);for(s[183]="".split(""),e=0;e!=s[183].length;++e)s[183][e].charCodeAt(0)!==65533&&(r[s[183][e]]=46848+e,t[46848+e]=s[183][e]);for(s[184]="".split(""),e=0;e!=s[184].length;++e)s[184][e].charCodeAt(0)!==65533&&(r[s[184][e]]=47104+e,t[47104+e]=s[184][e]);for(s[185]="".split(""),e=0;e!=s[185].length;++e)s[185][e].charCodeAt(0)!==65533&&(r[s[185][e]]=47360+e,t[47360+e]=s[185][e]);for(s[186]="".split(""),e=0;e!=s[186].length;++e)s[186][e].charCodeAt(0)!==65533&&(r[s[186][e]]=47616+e,t[47616+e]=s[186][e]);for(s[187]="".split(""),e=0;e!=s[187].length;++e)s[187][e].charCodeAt(0)!==65533&&(r[s[187][e]]=47872+e,t[47872+e]=s[187][e]);for(s[188]="".split(""),e=0;e!=s[188].length;++e)s[188][e].charCodeAt(0)!==65533&&(r[s[188][e]]=48128+e,t[48128+e]=s[188][e]);for(s[189]="".split(""),e=0;e!=s[189].length;++e)s[189][e].charCodeAt(0)!==65533&&(r[s[189][e]]=48384+e,t[48384+e]=s[189][e]);for(s[190]="".split(""),e=0;e!=s[190].length;++e)s[190][e].charCodeAt(0)!==65533&&(r[s[190][e]]=48640+e,t[48640+e]=s[190][e]);for(s[191]="".split(""),e=0;e!=s[191].length;++e)s[191][e].charCodeAt(0)!==65533&&(r[s[191][e]]=48896+e,t[48896+e]=s[191][e]);for(s[192]="".split(""),e=0;e!=s[192].length;++e)s[192][e].charCodeAt(0)!==65533&&(r[s[192][e]]=49152+e,t[49152+e]=s[192][e]);for(s[193]="".split(""),e=0;e!=s[193].length;++e)s[193][e].charCodeAt(0)!==65533&&(r[s[193][e]]=49408+e,t[49408+e]=s[193][e]);for(s[194]="".split(""),e=0;e!=s[194].length;++e)s[194][e].charCodeAt(0)!==65533&&(r[s[194][e]]=49664+e,t[49664+e]=s[194][e]);for(s[195]="".split(""),e=0;e!=s[195].length;++e)s[195][e].charCodeAt(0)!==65533&&(r[s[195][e]]=49920+e,t[49920+e]=s[195][e]);for(s[196]="".split(""),e=0;e!=s[196].length;++e)s[196][e].charCodeAt(0)!==65533&&(r[s[196][e]]=50176+e,t[50176+e]=s[196][e]);for(s[197]="".split(""),e=0;e!=s[197].length;++e)s[197][e].charCodeAt(0)!==65533&&(r[s[197][e]]=50432+e,t[50432+e]=s[197][e]);for(s[198]="".split(""),e=0;e!=s[198].length;++e)s[198][e].charCodeAt(0)!==65533&&(r[s[198][e]]=50688+e,t[50688+e]=s[198][e]);for(s[199]="".split(""),e=0;e!=s[199].length;++e)s[199][e].charCodeAt(0)!==65533&&(r[s[199][e]]=50944+e,t[50944+e]=s[199][e]);for(s[200]="".split(""),e=0;e!=s[200].length;++e)s[200][e].charCodeAt(0)!==65533&&(r[s[200][e]]=51200+e,t[51200+e]=s[200][e]);for(s[201]="".split(""),e=0;e!=s[201].length;++e)s[201][e].charCodeAt(0)!==65533&&(r[s[201][e]]=51456+e,t[51456+e]=s[201][e]);for(s[202]="".split(""),e=0;e!=s[202].length;++e)s[202][e].charCodeAt(0)!==65533&&(r[s[202][e]]=51712+e,t[51712+e]=s[202][e]);for(s[203]="".split(""),e=0;e!=s[203].length;++e)s[203][e].charCodeAt(0)!==65533&&(r[s[203][e]]=51968+e,t[51968+e]=s[203][e]);for(s[204]="".split(""),e=0;e!=s[204].length;++e)s[204][e].charCodeAt(0)!==65533&&(r[s[204][e]]=52224+e,t[52224+e]=s[204][e]);for(s[205]="".split(""),e=0;e!=s[205].length;++e)s[205][e].charCodeAt(0)!==65533&&(r[s[205][e]]=52480+e,t[52480+e]=s[205][e]);for(s[206]="".split(""),e=0;e!=s[206].length;++e)s[206][e].charCodeAt(0)!==65533&&(r[s[206][e]]=52736+e,t[52736+e]=s[206][e]);for(s[207]="".split(""),e=0;e!=s[207].length;++e)s[207][e].charCodeAt(0)!==65533&&(r[s[207][e]]=52992+e,t[52992+e]=s[207][e]);for(s[208]="".split(""),e=0;e!=s[208].length;++e)s[208][e].charCodeAt(0)!==65533&&(r[s[208][e]]=53248+e,t[53248+e]=s[208][e]);for(s[209]="".split(""),e=0;e!=s[209].length;++e)s[209][e].charCodeAt(0)!==65533&&(r[s[209][e]]=53504+e,t[53504+e]=s[209][e]);for(s[210]="".split(""),e=0;e!=s[210].length;++e)s[210][e].charCodeAt(0)!==65533&&(r[s[210][e]]=53760+e,t[53760+e]=s[210][e]);for(s[211]="".split(""),e=0;e!=s[211].length;++e)s[211][e].charCodeAt(0)!==65533&&(r[s[211][e]]=54016+e,t[54016+e]=s[211][e]);for(s[212]="".split(""),e=0;e!=s[212].length;++e)s[212][e].charCodeAt(0)!==65533&&(r[s[212][e]]=54272+e,t[54272+e]=s[212][e]);for(s[213]="".split(""),e=0;e!=s[213].length;++e)s[213][e].charCodeAt(0)!==65533&&(r[s[213][e]]=54528+e,t[54528+e]=s[213][e]);for(s[214]="".split(""),e=0;e!=s[214].length;++e)s[214][e].charCodeAt(0)!==65533&&(r[s[214][e]]=54784+e,t[54784+e]=s[214][e]);for(s[215]="".split(""),e=0;e!=s[215].length;++e)s[215][e].charCodeAt(0)!==65533&&(r[s[215][e]]=55040+e,t[55040+e]=s[215][e]);for(s[216]="".split(""),e=0;e!=s[216].length;++e)s[216][e].charCodeAt(0)!==65533&&(r[s[216][e]]=55296+e,t[55296+e]=s[216][e]);for(s[217]="".split(""),e=0;e!=s[217].length;++e)s[217][e].charCodeAt(0)!==65533&&(r[s[217][e]]=55552+e,t[55552+e]=s[217][e]);for(s[218]="".split(""),e=0;e!=s[218].length;++e)s[218][e].charCodeAt(0)!==65533&&(r[s[218][e]]=55808+e,t[55808+e]=s[218][e]);for(s[219]="".split(""),e=0;e!=s[219].length;++e)s[219][e].charCodeAt(0)!==65533&&(r[s[219][e]]=56064+e,t[56064+e]=s[219][e]);for(s[220]="".split(""),e=0;e!=s[220].length;++e)s[220][e].charCodeAt(0)!==65533&&(r[s[220][e]]=56320+e,t[56320+e]=s[220][e]);for(s[221]="".split(""),e=0;e!=s[221].length;++e)s[221][e].charCodeAt(0)!==65533&&(r[s[221][e]]=56576+e,t[56576+e]=s[221][e]);for(s[222]="".split(""),e=0;e!=s[222].length;++e)s[222][e].charCodeAt(0)!==65533&&(r[s[222][e]]=56832+e,t[56832+e]=s[222][e]);for(s[223]="".split(""),e=0;e!=s[223].length;++e)s[223][e].charCodeAt(0)!==65533&&(r[s[223][e]]=57088+e,t[57088+e]=s[223][e]);for(s[224]="".split(""),e=0;e!=s[224].length;++e)s[224][e].charCodeAt(0)!==65533&&(r[s[224][e]]=57344+e,t[57344+e]=s[224][e]);for(s[225]="".split(""),e=0;e!=s[225].length;++e)s[225][e].charCodeAt(0)!==65533&&(r[s[225][e]]=57600+e,t[57600+e]=s[225][e]);for(s[226]="".split(""),e=0;e!=s[226].length;++e)s[226][e].charCodeAt(0)!==65533&&(r[s[226][e]]=57856+e,t[57856+e]=s[226][e]);for(s[227]="".split(""),e=0;e!=s[227].length;++e)s[227][e].charCodeAt(0)!==65533&&(r[s[227][e]]=58112+e,t[58112+e]=s[227][e]);for(s[228]="".split(""),e=0;e!=s[228].length;++e)s[228][e].charCodeAt(0)!==65533&&(r[s[228][e]]=58368+e,t[58368+e]=s[228][e]);for(s[229]="".split(""),e=0;e!=s[229].length;++e)s[229][e].charCodeAt(0)!==65533&&(r[s[229][e]]=58624+e,t[58624+e]=s[229][e]);for(s[230]="".split(""),e=0;e!=s[230].length;++e)s[230][e].charCodeAt(0)!==65533&&(r[s[230][e]]=58880+e,t[58880+e]=s[230][e]);for(s[231]="".split(""),e=0;e!=s[231].length;++e)s[231][e].charCodeAt(0)!==65533&&(r[s[231][e]]=59136+e,t[59136+e]=s[231][e]);for(s[232]="".split(""),e=0;e!=s[232].length;++e)s[232][e].charCodeAt(0)!==65533&&(r[s[232][e]]=59392+e,t[59392+e]=s[232][e]);for(s[233]="".split(""),e=0;e!=s[233].length;++e)s[233][e].charCodeAt(0)!==65533&&(r[s[233][e]]=59648+e,t[59648+e]=s[233][e]);for(s[234]="".split(""),e=0;e!=s[234].length;++e)s[234][e].charCodeAt(0)!==65533&&(r[s[234][e]]=59904+e,t[59904+e]=s[234][e]);for(s[235]="".split(""),e=0;e!=s[235].length;++e)s[235][e].charCodeAt(0)!==65533&&(r[s[235][e]]=60160+e,t[60160+e]=s[235][e]);for(s[236]="".split(""),e=0;e!=s[236].length;++e)s[236][e].charCodeAt(0)!==65533&&(r[s[236][e]]=60416+e,t[60416+e]=s[236][e]);for(s[237]="".split(""),e=0;e!=s[237].length;++e)s[237][e].charCodeAt(0)!==65533&&(r[s[237][e]]=60672+e,t[60672+e]=s[237][e]);for(s[238]="".split(""),e=0;e!=s[238].length;++e)s[238][e].charCodeAt(0)!==65533&&(r[s[238][e]]=60928+e,t[60928+e]=s[238][e]);for(s[239]="".split(""),e=0;e!=s[239].length;++e)s[239][e].charCodeAt(0)!==65533&&(r[s[239][e]]=61184+e,t[61184+e]=s[239][e]);for(s[240]="".split(""),e=0;e!=s[240].length;++e)s[240][e].charCodeAt(0)!==65533&&(r[s[240][e]]=61440+e,t[61440+e]=s[240][e]);for(s[241]="".split(""),e=0;e!=s[241].length;++e)s[241][e].charCodeAt(0)!==65533&&(r[s[241][e]]=61696+e,t[61696+e]=s[241][e]);for(s[242]="".split(""),e=0;e!=s[242].length;++e)s[242][e].charCodeAt(0)!==65533&&(r[s[242][e]]=61952+e,t[61952+e]=s[242][e]);for(s[243]="".split(""),e=0;e!=s[243].length;++e)s[243][e].charCodeAt(0)!==65533&&(r[s[243][e]]=62208+e,t[62208+e]=s[243][e]);for(s[244]="".split(""),e=0;e!=s[244].length;++e)s[244][e].charCodeAt(0)!==65533&&(r[s[244][e]]=62464+e,t[62464+e]=s[244][e]);for(s[245]="".split(""),e=0;e!=s[245].length;++e)s[245][e].charCodeAt(0)!==65533&&(r[s[245][e]]=62720+e,t[62720+e]=s[245][e]);for(s[246]="".split(""),e=0;e!=s[246].length;++e)s[246][e].charCodeAt(0)!==65533&&(r[s[246][e]]=62976+e,t[62976+e]=s[246][e]);for(s[247]="".split(""),e=0;e!=s[247].length;++e)s[247][e].charCodeAt(0)!==65533&&(r[s[247][e]]=63232+e,t[63232+e]=s[247][e]);for(s[248]="".split(""),e=0;e!=s[248].length;++e)s[248][e].charCodeAt(0)!==65533&&(r[s[248][e]]=63488+e,t[63488+e]=s[248][e]);for(s[249]="".split(""),e=0;e!=s[249].length;++e)s[249][e].charCodeAt(0)!==65533&&(r[s[249][e]]=63744+e,t[63744+e]=s[249][e]);for(s[250]="".split(""),e=0;e!=s[250].length;++e)s[250][e].charCodeAt(0)!==65533&&(r[s[250][e]]=64e3+e,t[64e3+e]=s[250][e]);for(s[251]="".split(""),e=0;e!=s[251].length;++e)s[251][e].charCodeAt(0)!==65533&&(r[s[251][e]]=64256+e,t[64256+e]=s[251][e]);for(s[252]="".split(""),e=0;e!=s[252].length;++e)s[252][e].charCodeAt(0)!==65533&&(r[s[252][e]]=64512+e,t[64512+e]=s[252][e]);for(s[253]="".split(""),e=0;e!=s[253].length;++e)s[253][e].charCodeAt(0)!==65533&&(r[s[253][e]]=64768+e,t[64768+e]=s[253][e]);for(s[254]="".split(""),e=0;e!=s[254].length;++e)s[254][e].charCodeAt(0)!==65533&&(r[s[254][e]]=65024+e,t[65024+e]=s[254][e]);return{enc:r,dec:t}})(),a[949]=(function(){var t=[],r={},s=[],e;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=s[0].length;++e)s[0][e].charCodeAt(0)!==65533&&(r[s[0][e]]=0+e,t[0+e]=s[0][e]);for(s[129]="".split(""),e=0;e!=s[129].length;++e)s[129][e].charCodeAt(0)!==65533&&(r[s[129][e]]=33024+e,t[33024+e]=s[129][e]);for(s[130]="".split(""),e=0;e!=s[130].length;++e)s[130][e].charCodeAt(0)!==65533&&(r[s[130][e]]=33280+e,t[33280+e]=s[130][e]);for(s[131]="".split(""),e=0;e!=s[131].length;++e)s[131][e].charCodeAt(0)!==65533&&(r[s[131][e]]=33536+e,t[33536+e]=s[131][e]);for(s[132]="".split(""),e=0;e!=s[132].length;++e)s[132][e].charCodeAt(0)!==65533&&(r[s[132][e]]=33792+e,t[33792+e]=s[132][e]);for(s[133]="".split(""),e=0;e!=s[133].length;++e)s[133][e].charCodeAt(0)!==65533&&(r[s[133][e]]=34048+e,t[34048+e]=s[133][e]);for(s[134]="".split(""),e=0;e!=s[134].length;++e)s[134][e].charCodeAt(0)!==65533&&(r[s[134][e]]=34304+e,t[34304+e]=s[134][e]);for(s[135]="".split(""),e=0;e!=s[135].length;++e)s[135][e].charCodeAt(0)!==65533&&(r[s[135][e]]=34560+e,t[34560+e]=s[135][e]);for(s[136]="".split(""),e=0;e!=s[136].length;++e)s[136][e].charCodeAt(0)!==65533&&(r[s[136][e]]=34816+e,t[34816+e]=s[136][e]);for(s[137]="".split(""),e=0;e!=s[137].length;++e)s[137][e].charCodeAt(0)!==65533&&(r[s[137][e]]=35072+e,t[35072+e]=s[137][e]);for(s[138]="".split(""),e=0;e!=s[138].length;++e)s[138][e].charCodeAt(0)!==65533&&(r[s[138][e]]=35328+e,t[35328+e]=s[138][e]);for(s[139]="".split(""),e=0;e!=s[139].length;++e)s[139][e].charCodeAt(0)!==65533&&(r[s[139][e]]=35584+e,t[35584+e]=s[139][e]);for(s[140]="".split(""),e=0;e!=s[140].length;++e)s[140][e].charCodeAt(0)!==65533&&(r[s[140][e]]=35840+e,t[35840+e]=s[140][e]);for(s[141]="".split(""),e=0;e!=s[141].length;++e)s[141][e].charCodeAt(0)!==65533&&(r[s[141][e]]=36096+e,t[36096+e]=s[141][e]);for(s[142]="".split(""),e=0;e!=s[142].length;++e)s[142][e].charCodeAt(0)!==65533&&(r[s[142][e]]=36352+e,t[36352+e]=s[142][e]);for(s[143]="".split(""),e=0;e!=s[143].length;++e)s[143][e].charCodeAt(0)!==65533&&(r[s[143][e]]=36608+e,t[36608+e]=s[143][e]);for(s[144]="".split(""),e=0;e!=s[144].length;++e)s[144][e].charCodeAt(0)!==65533&&(r[s[144][e]]=36864+e,t[36864+e]=s[144][e]);for(s[145]="".split(""),e=0;e!=s[145].length;++e)s[145][e].charCodeAt(0)!==65533&&(r[s[145][e]]=37120+e,t[37120+e]=s[145][e]);for(s[146]="".split(""),e=0;e!=s[146].length;++e)s[146][e].charCodeAt(0)!==65533&&(r[s[146][e]]=37376+e,t[37376+e]=s[146][e]);for(s[147]="".split(""),e=0;e!=s[147].length;++e)s[147][e].charCodeAt(0)!==65533&&(r[s[147][e]]=37632+e,t[37632+e]=s[147][e]);for(s[148]="".split(""),e=0;e!=s[148].length;++e)s[148][e].charCodeAt(0)!==65533&&(r[s[148][e]]=37888+e,t[37888+e]=s[148][e]);for(s[149]="".split(""),e=0;e!=s[149].length;++e)s[149][e].charCodeAt(0)!==65533&&(r[s[149][e]]=38144+e,t[38144+e]=s[149][e]);for(s[150]="".split(""),e=0;e!=s[150].length;++e)s[150][e].charCodeAt(0)!==65533&&(r[s[150][e]]=38400+e,t[38400+e]=s[150][e]);for(s[151]="".split(""),e=0;e!=s[151].length;++e)s[151][e].charCodeAt(0)!==65533&&(r[s[151][e]]=38656+e,t[38656+e]=s[151][e]);for(s[152]="".split(""),e=0;e!=s[152].length;++e)s[152][e].charCodeAt(0)!==65533&&(r[s[152][e]]=38912+e,t[38912+e]=s[152][e]);for(s[153]="".split(""),e=0;e!=s[153].length;++e)s[153][e].charCodeAt(0)!==65533&&(r[s[153][e]]=39168+e,t[39168+e]=s[153][e]);for(s[154]="".split(""),e=0;e!=s[154].length;++e)s[154][e].charCodeAt(0)!==65533&&(r[s[154][e]]=39424+e,t[39424+e]=s[154][e]);for(s[155]="".split(""),e=0;e!=s[155].length;++e)s[155][e].charCodeAt(0)!==65533&&(r[s[155][e]]=39680+e,t[39680+e]=s[155][e]);for(s[156]="".split(""),e=0;e!=s[156].length;++e)s[156][e].charCodeAt(0)!==65533&&(r[s[156][e]]=39936+e,t[39936+e]=s[156][e]);for(s[157]="".split(""),e=0;e!=s[157].length;++e)s[157][e].charCodeAt(0)!==65533&&(r[s[157][e]]=40192+e,t[40192+e]=s[157][e]);for(s[158]="".split(""),e=0;e!=s[158].length;++e)s[158][e].charCodeAt(0)!==65533&&(r[s[158][e]]=40448+e,t[40448+e]=s[158][e]);for(s[159]="".split(""),e=0;e!=s[159].length;++e)s[159][e].charCodeAt(0)!==65533&&(r[s[159][e]]=40704+e,t[40704+e]=s[159][e]);for(s[160]="".split(""),e=0;e!=s[160].length;++e)s[160][e].charCodeAt(0)!==65533&&(r[s[160][e]]=40960+e,t[40960+e]=s[160][e]);for(s[161]="".split(""),e=0;e!=s[161].length;++e)s[161][e].charCodeAt(0)!==65533&&(r[s[161][e]]=41216+e,t[41216+e]=s[161][e]);for(s[162]="".split(""),e=0;e!=s[162].length;++e)s[162][e].charCodeAt(0)!==65533&&(r[s[162][e]]=41472+e,t[41472+e]=s[162][e]);for(s[163]="".split(""),e=0;e!=s[163].length;++e)s[163][e].charCodeAt(0)!==65533&&(r[s[163][e]]=41728+e,t[41728+e]=s[163][e]);for(s[164]="".split(""),e=0;e!=s[164].length;++e)s[164][e].charCodeAt(0)!==65533&&(r[s[164][e]]=41984+e,t[41984+e]=s[164][e]);for(s[165]="".split(""),e=0;e!=s[165].length;++e)s[165][e].charCodeAt(0)!==65533&&(r[s[165][e]]=42240+e,t[42240+e]=s[165][e]);for(s[166]="".split(""),e=0;e!=s[166].length;++e)s[166][e].charCodeAt(0)!==65533&&(r[s[166][e]]=42496+e,t[42496+e]=s[166][e]);for(s[167]="".split(""),e=0;e!=s[167].length;++e)s[167][e].charCodeAt(0)!==65533&&(r[s[167][e]]=42752+e,t[42752+e]=s[167][e]);for(s[168]="".split(""),e=0;e!=s[168].length;++e)s[168][e].charCodeAt(0)!==65533&&(r[s[168][e]]=43008+e,t[43008+e]=s[168][e]);for(s[169]="".split(""),e=0;e!=s[169].length;++e)s[169][e].charCodeAt(0)!==65533&&(r[s[169][e]]=43264+e,t[43264+e]=s[169][e]);for(s[170]="".split(""),e=0;e!=s[170].length;++e)s[170][e].charCodeAt(0)!==65533&&(r[s[170][e]]=43520+e,t[43520+e]=s[170][e]);for(s[171]="".split(""),e=0;e!=s[171].length;++e)s[171][e].charCodeAt(0)!==65533&&(r[s[171][e]]=43776+e,t[43776+e]=s[171][e]);for(s[172]="".split(""),e=0;e!=s[172].length;++e)s[172][e].charCodeAt(0)!==65533&&(r[s[172][e]]=44032+e,t[44032+e]=s[172][e]);for(s[173]="".split(""),e=0;e!=s[173].length;++e)s[173][e].charCodeAt(0)!==65533&&(r[s[173][e]]=44288+e,t[44288+e]=s[173][e]);for(s[174]="".split(""),e=0;e!=s[174].length;++e)s[174][e].charCodeAt(0)!==65533&&(r[s[174][e]]=44544+e,t[44544+e]=s[174][e]);for(s[175]="".split(""),e=0;e!=s[175].length;++e)s[175][e].charCodeAt(0)!==65533&&(r[s[175][e]]=44800+e,t[44800+e]=s[175][e]);for(s[176]="".split(""),e=0;e!=s[176].length;++e)s[176][e].charCodeAt(0)!==65533&&(r[s[176][e]]=45056+e,t[45056+e]=s[176][e]);for(s[177]="".split(""),e=0;e!=s[177].length;++e)s[177][e].charCodeAt(0)!==65533&&(r[s[177][e]]=45312+e,t[45312+e]=s[177][e]);for(s[178]="".split(""),e=0;e!=s[178].length;++e)s[178][e].charCodeAt(0)!==65533&&(r[s[178][e]]=45568+e,t[45568+e]=s[178][e]);for(s[179]="".split(""),e=0;e!=s[179].length;++e)s[179][e].charCodeAt(0)!==65533&&(r[s[179][e]]=45824+e,t[45824+e]=s[179][e]);for(s[180]="".split(""),e=0;e!=s[180].length;++e)s[180][e].charCodeAt(0)!==65533&&(r[s[180][e]]=46080+e,t[46080+e]=s[180][e]);for(s[181]="".split(""),e=0;e!=s[181].length;++e)s[181][e].charCodeAt(0)!==65533&&(r[s[181][e]]=46336+e,t[46336+e]=s[181][e]);for(s[182]="".split(""),e=0;e!=s[182].length;++e)s[182][e].charCodeAt(0)!==65533&&(r[s[182][e]]=46592+e,t[46592+e]=s[182][e]);for(s[183]="".split(""),e=0;e!=s[183].length;++e)s[183][e].charCodeAt(0)!==65533&&(r[s[183][e]]=46848+e,t[46848+e]=s[183][e]);for(s[184]="".split(""),e=0;e!=s[184].length;++e)s[184][e].charCodeAt(0)!==65533&&(r[s[184][e]]=47104+e,t[47104+e]=s[184][e]);for(s[185]="".split(""),e=0;e!=s[185].length;++e)s[185][e].charCodeAt(0)!==65533&&(r[s[185][e]]=47360+e,t[47360+e]=s[185][e]);for(s[186]="".split(""),e=0;e!=s[186].length;++e)s[186][e].charCodeAt(0)!==65533&&(r[s[186][e]]=47616+e,t[47616+e]=s[186][e]);for(s[187]="".split(""),e=0;e!=s[187].length;++e)s[187][e].charCodeAt(0)!==65533&&(r[s[187][e]]=47872+e,t[47872+e]=s[187][e]);for(s[188]="".split(""),e=0;e!=s[188].length;++e)s[188][e].charCodeAt(0)!==65533&&(r[s[188][e]]=48128+e,t[48128+e]=s[188][e]);for(s[189]="".split(""),e=0;e!=s[189].length;++e)s[189][e].charCodeAt(0)!==65533&&(r[s[189][e]]=48384+e,t[48384+e]=s[189][e]);for(s[190]="".split(""),e=0;e!=s[190].length;++e)s[190][e].charCodeAt(0)!==65533&&(r[s[190][e]]=48640+e,t[48640+e]=s[190][e]);for(s[191]="".split(""),e=0;e!=s[191].length;++e)s[191][e].charCodeAt(0)!==65533&&(r[s[191][e]]=48896+e,t[48896+e]=s[191][e]);for(s[192]="".split(""),e=0;e!=s[192].length;++e)s[192][e].charCodeAt(0)!==65533&&(r[s[192][e]]=49152+e,t[49152+e]=s[192][e]);for(s[193]="".split(""),e=0;e!=s[193].length;++e)s[193][e].charCodeAt(0)!==65533&&(r[s[193][e]]=49408+e,t[49408+e]=s[193][e]);for(s[194]="".split(""),e=0;e!=s[194].length;++e)s[194][e].charCodeAt(0)!==65533&&(r[s[194][e]]=49664+e,t[49664+e]=s[194][e]);for(s[195]="".split(""),e=0;e!=s[195].length;++e)s[195][e].charCodeAt(0)!==65533&&(r[s[195][e]]=49920+e,t[49920+e]=s[195][e]);for(s[196]="".split(""),e=0;e!=s[196].length;++e)s[196][e].charCodeAt(0)!==65533&&(r[s[196][e]]=50176+e,t[50176+e]=s[196][e]);for(s[197]="".split(""),e=0;e!=s[197].length;++e)s[197][e].charCodeAt(0)!==65533&&(r[s[197][e]]=50432+e,t[50432+e]=s[197][e]);for(s[198]="".split(""),e=0;e!=s[198].length;++e)s[198][e].charCodeAt(0)!==65533&&(r[s[198][e]]=50688+e,t[50688+e]=s[198][e]);for(s[199]="".split(""),e=0;e!=s[199].length;++e)s[199][e].charCodeAt(0)!==65533&&(r[s[199][e]]=50944+e,t[50944+e]=s[199][e]);for(s[200]="".split(""),e=0;e!=s[200].length;++e)s[200][e].charCodeAt(0)!==65533&&(r[s[200][e]]=51200+e,t[51200+e]=s[200][e]);for(s[202]="".split(""),e=0;e!=s[202].length;++e)s[202][e].charCodeAt(0)!==65533&&(r[s[202][e]]=51712+e,t[51712+e]=s[202][e]);for(s[203]="".split(""),e=0;e!=s[203].length;++e)s[203][e].charCodeAt(0)!==65533&&(r[s[203][e]]=51968+e,t[51968+e]=s[203][e]);for(s[204]="".split(""),e=0;e!=s[204].length;++e)s[204][e].charCodeAt(0)!==65533&&(r[s[204][e]]=52224+e,t[52224+e]=s[204][e]);for(s[205]="".split(""),e=0;e!=s[205].length;++e)s[205][e].charCodeAt(0)!==65533&&(r[s[205][e]]=52480+e,t[52480+e]=s[205][e]);for(s[206]="".split(""),e=0;e!=s[206].length;++e)s[206][e].charCodeAt(0)!==65533&&(r[s[206][e]]=52736+e,t[52736+e]=s[206][e]);for(s[207]="".split(""),e=0;e!=s[207].length;++e)s[207][e].charCodeAt(0)!==65533&&(r[s[207][e]]=52992+e,t[52992+e]=s[207][e]);for(s[208]="".split(""),e=0;e!=s[208].length;++e)s[208][e].charCodeAt(0)!==65533&&(r[s[208][e]]=53248+e,t[53248+e]=s[208][e]);for(s[209]="".split(""),e=0;e!=s[209].length;++e)s[209][e].charCodeAt(0)!==65533&&(r[s[209][e]]=53504+e,t[53504+e]=s[209][e]);for(s[210]="".split(""),e=0;e!=s[210].length;++e)s[210][e].charCodeAt(0)!==65533&&(r[s[210][e]]=53760+e,t[53760+e]=s[210][e]);for(s[211]="".split(""),e=0;e!=s[211].length;++e)s[211][e].charCodeAt(0)!==65533&&(r[s[211][e]]=54016+e,t[54016+e]=s[211][e]);for(s[212]="".split(""),e=0;e!=s[212].length;++e)s[212][e].charCodeAt(0)!==65533&&(r[s[212][e]]=54272+e,t[54272+e]=s[212][e]);for(s[213]="".split(""),e=0;e!=s[213].length;++e)s[213][e].charCodeAt(0)!==65533&&(r[s[213][e]]=54528+e,t[54528+e]=s[213][e]);for(s[214]="".split(""),e=0;e!=s[214].length;++e)s[214][e].charCodeAt(0)!==65533&&(r[s[214][e]]=54784+e,t[54784+e]=s[214][e]);for(s[215]="".split(""),e=0;e!=s[215].length;++e)s[215][e].charCodeAt(0)!==65533&&(r[s[215][e]]=55040+e,t[55040+e]=s[215][e]);for(s[216]="".split(""),e=0;e!=s[216].length;++e)s[216][e].charCodeAt(0)!==65533&&(r[s[216][e]]=55296+e,t[55296+e]=s[216][e]);for(s[217]="".split(""),e=0;e!=s[217].length;++e)s[217][e].charCodeAt(0)!==65533&&(r[s[217][e]]=55552+e,t[55552+e]=s[217][e]);for(s[218]="".split(""),e=0;e!=s[218].length;++e)s[218][e].charCodeAt(0)!==65533&&(r[s[218][e]]=55808+e,t[55808+e]=s[218][e]);for(s[219]="".split(""),e=0;e!=s[219].length;++e)s[219][e].charCodeAt(0)!==65533&&(r[s[219][e]]=56064+e,t[56064+e]=s[219][e]);for(s[220]="".split(""),e=0;e!=s[220].length;++e)s[220][e].charCodeAt(0)!==65533&&(r[s[220][e]]=56320+e,t[56320+e]=s[220][e]);for(s[221]="".split(""),e=0;e!=s[221].length;++e)s[221][e].charCodeAt(0)!==65533&&(r[s[221][e]]=56576+e,t[56576+e]=s[221][e]);for(s[222]="".split(""),e=0;e!=s[222].length;++e)s[222][e].charCodeAt(0)!==65533&&(r[s[222][e]]=56832+e,t[56832+e]=s[222][e]);for(s[223]="".split(""),e=0;e!=s[223].length;++e)s[223][e].charCodeAt(0)!==65533&&(r[s[223][e]]=57088+e,t[57088+e]=s[223][e]);for(s[224]="".split(""),e=0;e!=s[224].length;++e)s[224][e].charCodeAt(0)!==65533&&(r[s[224][e]]=57344+e,t[57344+e]=s[224][e]);for(s[225]="".split(""),e=0;e!=s[225].length;++e)s[225][e].charCodeAt(0)!==65533&&(r[s[225][e]]=57600+e,t[57600+e]=s[225][e]);for(s[226]="".split(""),e=0;e!=s[226].length;++e)s[226][e].charCodeAt(0)!==65533&&(r[s[226][e]]=57856+e,t[57856+e]=s[226][e]);for(s[227]="".split(""),e=0;e!=s[227].length;++e)s[227][e].charCodeAt(0)!==65533&&(r[s[227][e]]=58112+e,t[58112+e]=s[227][e]);for(s[228]="".split(""),e=0;e!=s[228].length;++e)s[228][e].charCodeAt(0)!==65533&&(r[s[228][e]]=58368+e,t[58368+e]=s[228][e]);for(s[229]="".split(""),e=0;e!=s[229].length;++e)s[229][e].charCodeAt(0)!==65533&&(r[s[229][e]]=58624+e,t[58624+e]=s[229][e]);for(s[230]="".split(""),e=0;e!=s[230].length;++e)s[230][e].charCodeAt(0)!==65533&&(r[s[230][e]]=58880+e,t[58880+e]=s[230][e]);for(s[231]="".split(""),e=0;e!=s[231].length;++e)s[231][e].charCodeAt(0)!==65533&&(r[s[231][e]]=59136+e,t[59136+e]=s[231][e]);for(s[232]="".split(""),e=0;e!=s[232].length;++e)s[232][e].charCodeAt(0)!==65533&&(r[s[232][e]]=59392+e,t[59392+e]=s[232][e]);for(s[233]="".split(""),e=0;e!=s[233].length;++e)s[233][e].charCodeAt(0)!==65533&&(r[s[233][e]]=59648+e,t[59648+e]=s[233][e]);for(s[234]="".split(""),e=0;e!=s[234].length;++e)s[234][e].charCodeAt(0)!==65533&&(r[s[234][e]]=59904+e,t[59904+e]=s[234][e]);for(s[235]="".split(""),e=0;e!=s[235].length;++e)s[235][e].charCodeAt(0)!==65533&&(r[s[235][e]]=60160+e,t[60160+e]=s[235][e]);for(s[236]="".split(""),e=0;e!=s[236].length;++e)s[236][e].charCodeAt(0)!==65533&&(r[s[236][e]]=60416+e,t[60416+e]=s[236][e]);for(s[237]="".split(""),e=0;e!=s[237].length;++e)s[237][e].charCodeAt(0)!==65533&&(r[s[237][e]]=60672+e,t[60672+e]=s[237][e]);for(s[238]="".split(""),e=0;e!=s[238].length;++e)s[238][e].charCodeAt(0)!==65533&&(r[s[238][e]]=60928+e,t[60928+e]=s[238][e]);for(s[239]="".split(""),e=0;e!=s[239].length;++e)s[239][e].charCodeAt(0)!==65533&&(r[s[239][e]]=61184+e,t[61184+e]=s[239][e]);for(s[240]="".split(""),e=0;e!=s[240].length;++e)s[240][e].charCodeAt(0)!==65533&&(r[s[240][e]]=61440+e,t[61440+e]=s[240][e]);for(s[241]="".split(""),e=0;e!=s[241].length;++e)s[241][e].charCodeAt(0)!==65533&&(r[s[241][e]]=61696+e,t[61696+e]=s[241][e]);for(s[242]="".split(""),e=0;e!=s[242].length;++e)s[242][e].charCodeAt(0)!==65533&&(r[s[242][e]]=61952+e,t[61952+e]=s[242][e]);for(s[243]="".split(""),e=0;e!=s[243].length;++e)s[243][e].charCodeAt(0)!==65533&&(r[s[243][e]]=62208+e,t[62208+e]=s[243][e]);for(s[244]="".split(""),e=0;e!=s[244].length;++e)s[244][e].charCodeAt(0)!==65533&&(r[s[244][e]]=62464+e,t[62464+e]=s[244][e]);for(s[245]="".split(""),e=0;e!=s[245].length;++e)s[245][e].charCodeAt(0)!==65533&&(r[s[245][e]]=62720+e,t[62720+e]=s[245][e]);for(s[246]="".split(""),e=0;e!=s[246].length;++e)s[246][e].charCodeAt(0)!==65533&&(r[s[246][e]]=62976+e,t[62976+e]=s[246][e]);for(s[247]="".split(""),e=0;e!=s[247].length;++e)s[247][e].charCodeAt(0)!==65533&&(r[s[247][e]]=63232+e,t[63232+e]=s[247][e]);for(s[248]="".split(""),e=0;e!=s[248].length;++e)s[248][e].charCodeAt(0)!==65533&&(r[s[248][e]]=63488+e,t[63488+e]=s[248][e]);for(s[249]="".split(""),e=0;e!=s[249].length;++e)s[249][e].charCodeAt(0)!==65533&&(r[s[249][e]]=63744+e,t[63744+e]=s[249][e]);for(s[250]="".split(""),e=0;e!=s[250].length;++e)s[250][e].charCodeAt(0)!==65533&&(r[s[250][e]]=64e3+e,t[64e3+e]=s[250][e]);for(s[251]="".split(""),e=0;e!=s[251].length;++e)s[251][e].charCodeAt(0)!==65533&&(r[s[251][e]]=64256+e,t[64256+e]=s[251][e]);for(s[252]="".split(""),e=0;e!=s[252].length;++e)s[252][e].charCodeAt(0)!==65533&&(r[s[252][e]]=64512+e,t[64512+e]=s[252][e]);for(s[253]="".split(""),e=0;e!=s[253].length;++e)s[253][e].charCodeAt(0)!==65533&&(r[s[253][e]]=64768+e,t[64768+e]=s[253][e]);return{enc:r,dec:t}})(),a[950]=(function(){var t=[],r={},s=[],e;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=s[0].length;++e)s[0][e].charCodeAt(0)!==65533&&(r[s[0][e]]=0+e,t[0+e]=s[0][e]);for(s[161]="".split(""),e=0;e!=s[161].length;++e)s[161][e].charCodeAt(0)!==65533&&(r[s[161][e]]=41216+e,t[41216+e]=s[161][e]);for(s[162]="".split(""),e=0;e!=s[162].length;++e)s[162][e].charCodeAt(0)!==65533&&(r[s[162][e]]=41472+e,t[41472+e]=s[162][e]);for(s[163]="".split(""),e=0;e!=s[163].length;++e)s[163][e].charCodeAt(0)!==65533&&(r[s[163][e]]=41728+e,t[41728+e]=s[163][e]);for(s[164]="".split(""),e=0;e!=s[164].length;++e)s[164][e].charCodeAt(0)!==65533&&(r[s[164][e]]=41984+e,t[41984+e]=s[164][e]);for(s[165]="".split(""),e=0;e!=s[165].length;++e)s[165][e].charCodeAt(0)!==65533&&(r[s[165][e]]=42240+e,t[42240+e]=s[165][e]);for(s[166]="".split(""),e=0;e!=s[166].length;++e)s[166][e].charCodeAt(0)!==65533&&(r[s[166][e]]=42496+e,t[42496+e]=s[166][e]);for(s[167]="".split(""),e=0;e!=s[167].length;++e)s[167][e].charCodeAt(0)!==65533&&(r[s[167][e]]=42752+e,t[42752+e]=s[167][e]);for(s[168]="".split(""),e=0;e!=s[168].length;++e)s[168][e].charCodeAt(0)!==65533&&(r[s[168][e]]=43008+e,t[43008+e]=s[168][e]);for(s[169]="".split(""),e=0;e!=s[169].length;++e)s[169][e].charCodeAt(0)!==65533&&(r[s[169][e]]=43264+e,t[43264+e]=s[169][e]);for(s[170]="".split(""),e=0;e!=s[170].length;++e)s[170][e].charCodeAt(0)!==65533&&(r[s[170][e]]=43520+e,t[43520+e]=s[170][e]);for(s[171]="".split(""),e=0;e!=s[171].length;++e)s[171][e].charCodeAt(0)!==65533&&(r[s[171][e]]=43776+e,t[43776+e]=s[171][e]);for(s[172]="".split(""),e=0;e!=s[172].length;++e)s[172][e].charCodeAt(0)!==65533&&(r[s[172][e]]=44032+e,t[44032+e]=s[172][e]);for(s[173]="".split(""),e=0;e!=s[173].length;++e)s[173][e].charCodeAt(0)!==65533&&(r[s[173][e]]=44288+e,t[44288+e]=s[173][e]);for(s[174]="".split(""),e=0;e!=s[174].length;++e)s[174][e].charCodeAt(0)!==65533&&(r[s[174][e]]=44544+e,t[44544+e]=s[174][e]);for(s[175]="".split(""),e=0;e!=s[175].length;++e)s[175][e].charCodeAt(0)!==65533&&(r[s[175][e]]=44800+e,t[44800+e]=s[175][e]);for(s[176]="".split(""),e=0;e!=s[176].length;++e)s[176][e].charCodeAt(0)!==65533&&(r[s[176][e]]=45056+e,t[45056+e]=s[176][e]);for(s[177]="".split(""),e=0;e!=s[177].length;++e)s[177][e].charCodeAt(0)!==65533&&(r[s[177][e]]=45312+e,t[45312+e]=s[177][e]);for(s[178]="".split(""),e=0;e!=s[178].length;++e)s[178][e].charCodeAt(0)!==65533&&(r[s[178][e]]=45568+e,t[45568+e]=s[178][e]);for(s[179]="".split(""),e=0;e!=s[179].length;++e)s[179][e].charCodeAt(0)!==65533&&(r[s[179][e]]=45824+e,t[45824+e]=s[179][e]);for(s[180]="".split(""),e=0;e!=s[180].length;++e)s[180][e].charCodeAt(0)!==65533&&(r[s[180][e]]=46080+e,t[46080+e]=s[180][e]);for(s[181]="".split(""),e=0;e!=s[181].length;++e)s[181][e].charCodeAt(0)!==65533&&(r[s[181][e]]=46336+e,t[46336+e]=s[181][e]);for(s[182]="".split(""),e=0;e!=s[182].length;++e)s[182][e].charCodeAt(0)!==65533&&(r[s[182][e]]=46592+e,t[46592+e]=s[182][e]);for(s[183]="".split(""),e=0;e!=s[183].length;++e)s[183][e].charCodeAt(0)!==65533&&(r[s[183][e]]=46848+e,t[46848+e]=s[183][e]);for(s[184]="".split(""),e=0;e!=s[184].length;++e)s[184][e].charCodeAt(0)!==65533&&(r[s[184][e]]=47104+e,t[47104+e]=s[184][e]);for(s[185]="".split(""),e=0;e!=s[185].length;++e)s[185][e].charCodeAt(0)!==65533&&(r[s[185][e]]=47360+e,t[47360+e]=s[185][e]);for(s[186]="".split(""),e=0;e!=s[186].length;++e)s[186][e].charCodeAt(0)!==65533&&(r[s[186][e]]=47616+e,t[47616+e]=s[186][e]);for(s[187]="".split(""),e=0;e!=s[187].length;++e)s[187][e].charCodeAt(0)!==65533&&(r[s[187][e]]=47872+e,t[47872+e]=s[187][e]);for(s[188]="".split(""),e=0;e!=s[188].length;++e)s[188][e].charCodeAt(0)!==65533&&(r[s[188][e]]=48128+e,t[48128+e]=s[188][e]);for(s[189]="".split(""),e=0;e!=s[189].length;++e)s[189][e].charCodeAt(0)!==65533&&(r[s[189][e]]=48384+e,t[48384+e]=s[189][e]);for(s[190]="".split(""),e=0;e!=s[190].length;++e)s[190][e].charCodeAt(0)!==65533&&(r[s[190][e]]=48640+e,t[48640+e]=s[190][e]);for(s[191]="".split(""),e=0;e!=s[191].length;++e)s[191][e].charCodeAt(0)!==65533&&(r[s[191][e]]=48896+e,t[48896+e]=s[191][e]);for(s[192]="".split(""),e=0;e!=s[192].length;++e)s[192][e].charCodeAt(0)!==65533&&(r[s[192][e]]=49152+e,t[49152+e]=s[192][e]);for(s[193]="".split(""),e=0;e!=s[193].length;++e)s[193][e].charCodeAt(0)!==65533&&(r[s[193][e]]=49408+e,t[49408+e]=s[193][e]);for(s[194]="".split(""),e=0;e!=s[194].length;++e)s[194][e].charCodeAt(0)!==65533&&(r[s[194][e]]=49664+e,t[49664+e]=s[194][e]);for(s[195]="".split(""),e=0;e!=s[195].length;++e)s[195][e].charCodeAt(0)!==65533&&(r[s[195][e]]=49920+e,t[49920+e]=s[195][e]);for(s[196]="".split(""),e=0;e!=s[196].length;++e)s[196][e].charCodeAt(0)!==65533&&(r[s[196][e]]=50176+e,t[50176+e]=s[196][e]);for(s[197]="".split(""),e=0;e!=s[197].length;++e)s[197][e].charCodeAt(0)!==65533&&(r[s[197][e]]=50432+e,t[50432+e]=s[197][e]);for(s[198]="".split(""),e=0;e!=s[198].length;++e)s[198][e].charCodeAt(0)!==65533&&(r[s[198][e]]=50688+e,t[50688+e]=s[198][e]);for(s[201]="".split(""),e=0;e!=s[201].length;++e)s[201][e].charCodeAt(0)!==65533&&(r[s[201][e]]=51456+e,t[51456+e]=s[201][e]);for(s[202]="".split(""),e=0;e!=s[202].length;++e)s[202][e].charCodeAt(0)!==65533&&(r[s[202][e]]=51712+e,t[51712+e]=s[202][e]);for(s[203]="".split(""),e=0;e!=s[203].length;++e)s[203][e].charCodeAt(0)!==65533&&(r[s[203][e]]=51968+e,t[51968+e]=s[203][e]);for(s[204]="".split(""),e=0;e!=s[204].length;++e)s[204][e].charCodeAt(0)!==65533&&(r[s[204][e]]=52224+e,t[52224+e]=s[204][e]);for(s[205]="".split(""),e=0;e!=s[205].length;++e)s[205][e].charCodeAt(0)!==65533&&(r[s[205][e]]=52480+e,t[52480+e]=s[205][e]);for(s[206]="".split(""),e=0;e!=s[206].length;++e)s[206][e].charCodeAt(0)!==65533&&(r[s[206][e]]=52736+e,t[52736+e]=s[206][e]);for(s[207]="".split(""),e=0;e!=s[207].length;++e)s[207][e].charCodeAt(0)!==65533&&(r[s[207][e]]=52992+e,t[52992+e]=s[207][e]);for(s[208]="".split(""),e=0;e!=s[208].length;++e)s[208][e].charCodeAt(0)!==65533&&(r[s[208][e]]=53248+e,t[53248+e]=s[208][e]);for(s[209]="".split(""),e=0;e!=s[209].length;++e)s[209][e].charCodeAt(0)!==65533&&(r[s[209][e]]=53504+e,t[53504+e]=s[209][e]);for(s[210]="".split(""),e=0;e!=s[210].length;++e)s[210][e].charCodeAt(0)!==65533&&(r[s[210][e]]=53760+e,t[53760+e]=s[210][e]);for(s[211]="".split(""),e=0;e!=s[211].length;++e)s[211][e].charCodeAt(0)!==65533&&(r[s[211][e]]=54016+e,t[54016+e]=s[211][e]);for(s[212]="".split(""),e=0;e!=s[212].length;++e)s[212][e].charCodeAt(0)!==65533&&(r[s[212][e]]=54272+e,t[54272+e]=s[212][e]);for(s[213]="".split(""),e=0;e!=s[213].length;++e)s[213][e].charCodeAt(0)!==65533&&(r[s[213][e]]=54528+e,t[54528+e]=s[213][e]);for(s[214]="".split(""),e=0;e!=s[214].length;++e)s[214][e].charCodeAt(0)!==65533&&(r[s[214][e]]=54784+e,t[54784+e]=s[214][e]);for(s[215]="".split(""),e=0;e!=s[215].length;++e)s[215][e].charCodeAt(0)!==65533&&(r[s[215][e]]=55040+e,t[55040+e]=s[215][e]);for(s[216]="".split(""),e=0;e!=s[216].length;++e)s[216][e].charCodeAt(0)!==65533&&(r[s[216][e]]=55296+e,t[55296+e]=s[216][e]);for(s[217]="".split(""),e=0;e!=s[217].length;++e)s[217][e].charCodeAt(0)!==65533&&(r[s[217][e]]=55552+e,t[55552+e]=s[217][e]);for(s[218]="".split(""),e=0;e!=s[218].length;++e)s[218][e].charCodeAt(0)!==65533&&(r[s[218][e]]=55808+e,t[55808+e]=s[218][e]);for(s[219]="".split(""),e=0;e!=s[219].length;++e)s[219][e].charCodeAt(0)!==65533&&(r[s[219][e]]=56064+e,t[56064+e]=s[219][e]);for(s[220]="".split(""),e=0;e!=s[220].length;++e)s[220][e].charCodeAt(0)!==65533&&(r[s[220][e]]=56320+e,t[56320+e]=s[220][e]);for(s[221]="".split(""),e=0;e!=s[221].length;++e)s[221][e].charCodeAt(0)!==65533&&(r[s[221][e]]=56576+e,t[56576+e]=s[221][e]);for(s[222]="".split(""),e=0;e!=s[222].length;++e)s[222][e].charCodeAt(0)!==65533&&(r[s[222][e]]=56832+e,t[56832+e]=s[222][e]);for(s[223]="".split(""),e=0;e!=s[223].length;++e)s[223][e].charCodeAt(0)!==65533&&(r[s[223][e]]=57088+e,t[57088+e]=s[223][e]);for(s[224]="".split(""),e=0;e!=s[224].length;++e)s[224][e].charCodeAt(0)!==65533&&(r[s[224][e]]=57344+e,t[57344+e]=s[224][e]);for(s[225]="".split(""),e=0;e!=s[225].length;++e)s[225][e].charCodeAt(0)!==65533&&(r[s[225][e]]=57600+e,t[57600+e]=s[225][e]);for(s[226]="".split(""),e=0;e!=s[226].length;++e)s[226][e].charCodeAt(0)!==65533&&(r[s[226][e]]=57856+e,t[57856+e]=s[226][e]);for(s[227]="".split(""),e=0;e!=s[227].length;++e)s[227][e].charCodeAt(0)!==65533&&(r[s[227][e]]=58112+e,t[58112+e]=s[227][e]);for(s[228]="".split(""),e=0;e!=s[228].length;++e)s[228][e].charCodeAt(0)!==65533&&(r[s[228][e]]=58368+e,t[58368+e]=s[228][e]);for(s[229]="".split(""),e=0;e!=s[229].length;++e)s[229][e].charCodeAt(0)!==65533&&(r[s[229][e]]=58624+e,t[58624+e]=s[229][e]);for(s[230]="".split(""),e=0;e!=s[230].length;++e)s[230][e].charCodeAt(0)!==65533&&(r[s[230][e]]=58880+e,t[58880+e]=s[230][e]);for(s[231]="".split(""),e=0;e!=s[231].length;++e)s[231][e].charCodeAt(0)!==65533&&(r[s[231][e]]=59136+e,t[59136+e]=s[231][e]);for(s[232]="".split(""),e=0;e!=s[232].length;++e)s[232][e].charCodeAt(0)!==65533&&(r[s[232][e]]=59392+e,t[59392+e]=s[232][e]);for(s[233]="".split(""),e=0;e!=s[233].length;++e)s[233][e].charCodeAt(0)!==65533&&(r[s[233][e]]=59648+e,t[59648+e]=s[233][e]);for(s[234]="".split(""),e=0;e!=s[234].length;++e)s[234][e].charCodeAt(0)!==65533&&(r[s[234][e]]=59904+e,t[59904+e]=s[234][e]);for(s[235]="".split(""),e=0;e!=s[235].length;++e)s[235][e].charCodeAt(0)!==65533&&(r[s[235][e]]=60160+e,t[60160+e]=s[235][e]);for(s[236]="".split(""),e=0;e!=s[236].length;++e)s[236][e].charCodeAt(0)!==65533&&(r[s[236][e]]=60416+e,t[60416+e]=s[236][e]);for(s[237]="".split(""),e=0;e!=s[237].length;++e)s[237][e].charCodeAt(0)!==65533&&(r[s[237][e]]=60672+e,t[60672+e]=s[237][e]);for(s[238]="".split(""),e=0;e!=s[238].length;++e)s[238][e].charCodeAt(0)!==65533&&(r[s[238][e]]=60928+e,t[60928+e]=s[238][e]);for(s[239]="".split(""),e=0;e!=s[239].length;++e)s[239][e].charCodeAt(0)!==65533&&(r[s[239][e]]=61184+e,t[61184+e]=s[239][e]);for(s[240]="".split(""),e=0;e!=s[240].length;++e)s[240][e].charCodeAt(0)!==65533&&(r[s[240][e]]=61440+e,t[61440+e]=s[240][e]);for(s[241]="".split(""),e=0;e!=s[241].length;++e)s[241][e].charCodeAt(0)!==65533&&(r[s[241][e]]=61696+e,t[61696+e]=s[241][e]);for(s[242]="".split(""),e=0;e!=s[242].length;++e)s[242][e].charCodeAt(0)!==65533&&(r[s[242][e]]=61952+e,t[61952+e]=s[242][e]);for(s[243]="".split(""),e=0;e!=s[243].length;++e)s[243][e].charCodeAt(0)!==65533&&(r[s[243][e]]=62208+e,t[62208+e]=s[243][e]);for(s[244]="".split(""),e=0;e!=s[244].length;++e)s[244][e].charCodeAt(0)!==65533&&(r[s[244][e]]=62464+e,t[62464+e]=s[244][e]);for(s[245]="".split(""),e=0;e!=s[245].length;++e)s[245][e].charCodeAt(0)!==65533&&(r[s[245][e]]=62720+e,t[62720+e]=s[245][e]);for(s[246]="".split(""),e=0;e!=s[246].length;++e)s[246][e].charCodeAt(0)!==65533&&(r[s[246][e]]=62976+e,t[62976+e]=s[246][e]);for(s[247]="".split(""),e=0;e!=s[247].length;++e)s[247][e].charCodeAt(0)!==65533&&(r[s[247][e]]=63232+e,t[63232+e]=s[247][e]);for(s[248]="".split(""),e=0;e!=s[248].length;++e)s[248][e].charCodeAt(0)!==65533&&(r[s[248][e]]=63488+e,t[63488+e]=s[248][e]);for(s[249]="".split(""),e=0;e!=s[249].length;++e)s[249][e].charCodeAt(0)!==65533&&(r[s[249][e]]=63744+e,t[63744+e]=s[249][e]);return{enc:r,dec:t}})(),a[1250]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[1251]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[1252]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[1253]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[1254]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[1255]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[1256]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[1257]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[1258]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[1e4]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[10006]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[10007]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[10008]=(function(){var t=[],r={},s=[],e;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),e=0;e!=s[0].length;++e)s[0][e].charCodeAt(0)!==65533&&(r[s[0][e]]=0+e,t[0+e]=s[0][e]);for(s[161]="".split(""),e=0;e!=s[161].length;++e)s[161][e].charCodeAt(0)!==65533&&(r[s[161][e]]=41216+e,t[41216+e]=s[161][e]);for(s[162]="".split(""),e=0;e!=s[162].length;++e)s[162][e].charCodeAt(0)!==65533&&(r[s[162][e]]=41472+e,t[41472+e]=s[162][e]);for(s[163]="".split(""),e=0;e!=s[163].length;++e)s[163][e].charCodeAt(0)!==65533&&(r[s[163][e]]=41728+e,t[41728+e]=s[163][e]);for(s[164]="".split(""),e=0;e!=s[164].length;++e)s[164][e].charCodeAt(0)!==65533&&(r[s[164][e]]=41984+e,t[41984+e]=s[164][e]);for(s[165]="".split(""),e=0;e!=s[165].length;++e)s[165][e].charCodeAt(0)!==65533&&(r[s[165][e]]=42240+e,t[42240+e]=s[165][e]);for(s[166]="".split(""),e=0;e!=s[166].length;++e)s[166][e].charCodeAt(0)!==65533&&(r[s[166][e]]=42496+e,t[42496+e]=s[166][e]);for(s[167]="".split(""),e=0;e!=s[167].length;++e)s[167][e].charCodeAt(0)!==65533&&(r[s[167][e]]=42752+e,t[42752+e]=s[167][e]);for(s[168]="".split(""),e=0;e!=s[168].length;++e)s[168][e].charCodeAt(0)!==65533&&(r[s[168][e]]=43008+e,t[43008+e]=s[168][e]);for(s[169]="".split(""),e=0;e!=s[169].length;++e)s[169][e].charCodeAt(0)!==65533&&(r[s[169][e]]=43264+e,t[43264+e]=s[169][e]);for(s[176]="".split(""),e=0;e!=s[176].length;++e)s[176][e].charCodeAt(0)!==65533&&(r[s[176][e]]=45056+e,t[45056+e]=s[176][e]);for(s[177]="".split(""),e=0;e!=s[177].length;++e)s[177][e].charCodeAt(0)!==65533&&(r[s[177][e]]=45312+e,t[45312+e]=s[177][e]);for(s[178]="".split(""),e=0;e!=s[178].length;++e)s[178][e].charCodeAt(0)!==65533&&(r[s[178][e]]=45568+e,t[45568+e]=s[178][e]);for(s[179]="".split(""),e=0;e!=s[179].length;++e)s[179][e].charCodeAt(0)!==65533&&(r[s[179][e]]=45824+e,t[45824+e]=s[179][e]);for(s[180]="".split(""),e=0;e!=s[180].length;++e)s[180][e].charCodeAt(0)!==65533&&(r[s[180][e]]=46080+e,t[46080+e]=s[180][e]);for(s[181]="".split(""),e=0;e!=s[181].length;++e)s[181][e].charCodeAt(0)!==65533&&(r[s[181][e]]=46336+e,t[46336+e]=s[181][e]);for(s[182]="".split(""),e=0;e!=s[182].length;++e)s[182][e].charCodeAt(0)!==65533&&(r[s[182][e]]=46592+e,t[46592+e]=s[182][e]);for(s[183]="".split(""),e=0;e!=s[183].length;++e)s[183][e].charCodeAt(0)!==65533&&(r[s[183][e]]=46848+e,t[46848+e]=s[183][e]);for(s[184]="".split(""),e=0;e!=s[184].length;++e)s[184][e].charCodeAt(0)!==65533&&(r[s[184][e]]=47104+e,t[47104+e]=s[184][e]);for(s[185]="".split(""),e=0;e!=s[185].length;++e)s[185][e].charCodeAt(0)!==65533&&(r[s[185][e]]=47360+e,t[47360+e]=s[185][e]);for(s[186]="".split(""),e=0;e!=s[186].length;++e)s[186][e].charCodeAt(0)!==65533&&(r[s[186][e]]=47616+e,t[47616+e]=s[186][e]);for(s[187]="".split(""),e=0;e!=s[187].length;++e)s[187][e].charCodeAt(0)!==65533&&(r[s[187][e]]=47872+e,t[47872+e]=s[187][e]);for(s[188]="".split(""),e=0;e!=s[188].length;++e)s[188][e].charCodeAt(0)!==65533&&(r[s[188][e]]=48128+e,t[48128+e]=s[188][e]);for(s[189]="".split(""),e=0;e!=s[189].length;++e)s[189][e].charCodeAt(0)!==65533&&(r[s[189][e]]=48384+e,t[48384+e]=s[189][e]);for(s[190]="".split(""),e=0;e!=s[190].length;++e)s[190][e].charCodeAt(0)!==65533&&(r[s[190][e]]=48640+e,t[48640+e]=s[190][e]);for(s[191]="".split(""),e=0;e!=s[191].length;++e)s[191][e].charCodeAt(0)!==65533&&(r[s[191][e]]=48896+e,t[48896+e]=s[191][e]);for(s[192]="".split(""),e=0;e!=s[192].length;++e)s[192][e].charCodeAt(0)!==65533&&(r[s[192][e]]=49152+e,t[49152+e]=s[192][e]);for(s[193]="".split(""),e=0;e!=s[193].length;++e)s[193][e].charCodeAt(0)!==65533&&(r[s[193][e]]=49408+e,t[49408+e]=s[193][e]);for(s[194]="".split(""),e=0;e!=s[194].length;++e)s[194][e].charCodeAt(0)!==65533&&(r[s[194][e]]=49664+e,t[49664+e]=s[194][e]);for(s[195]="".split(""),e=0;e!=s[195].length;++e)s[195][e].charCodeAt(0)!==65533&&(r[s[195][e]]=49920+e,t[49920+e]=s[195][e]);for(s[196]="".split(""),e=0;e!=s[196].length;++e)s[196][e].charCodeAt(0)!==65533&&(r[s[196][e]]=50176+e,t[50176+e]=s[196][e]);for(s[197]="".split(""),e=0;e!=s[197].length;++e)s[197][e].charCodeAt(0)!==65533&&(r[s[197][e]]=50432+e,t[50432+e]=s[197][e]);for(s[198]="".split(""),e=0;e!=s[198].length;++e)s[198][e].charCodeAt(0)!==65533&&(r[s[198][e]]=50688+e,t[50688+e]=s[198][e]);for(s[199]="".split(""),e=0;e!=s[199].length;++e)s[199][e].charCodeAt(0)!==65533&&(r[s[199][e]]=50944+e,t[50944+e]=s[199][e]);for(s[200]="".split(""),e=0;e!=s[200].length;++e)s[200][e].charCodeAt(0)!==65533&&(r[s[200][e]]=51200+e,t[51200+e]=s[200][e]);for(s[201]="".split(""),e=0;e!=s[201].length;++e)s[201][e].charCodeAt(0)!==65533&&(r[s[201][e]]=51456+e,t[51456+e]=s[201][e]);for(s[202]="".split(""),e=0;e!=s[202].length;++e)s[202][e].charCodeAt(0)!==65533&&(r[s[202][e]]=51712+e,t[51712+e]=s[202][e]);for(s[203]="".split(""),e=0;e!=s[203].length;++e)s[203][e].charCodeAt(0)!==65533&&(r[s[203][e]]=51968+e,t[51968+e]=s[203][e]);for(s[204]="".split(""),e=0;e!=s[204].length;++e)s[204][e].charCodeAt(0)!==65533&&(r[s[204][e]]=52224+e,t[52224+e]=s[204][e]);for(s[205]="".split(""),e=0;e!=s[205].length;++e)s[205][e].charCodeAt(0)!==65533&&(r[s[205][e]]=52480+e,t[52480+e]=s[205][e]);for(s[206]="".split(""),e=0;e!=s[206].length;++e)s[206][e].charCodeAt(0)!==65533&&(r[s[206][e]]=52736+e,t[52736+e]=s[206][e]);for(s[207]="".split(""),e=0;e!=s[207].length;++e)s[207][e].charCodeAt(0)!==65533&&(r[s[207][e]]=52992+e,t[52992+e]=s[207][e]);for(s[208]="".split(""),e=0;e!=s[208].length;++e)s[208][e].charCodeAt(0)!==65533&&(r[s[208][e]]=53248+e,t[53248+e]=s[208][e]);for(s[209]="".split(""),e=0;e!=s[209].length;++e)s[209][e].charCodeAt(0)!==65533&&(r[s[209][e]]=53504+e,t[53504+e]=s[209][e]);for(s[210]="".split(""),e=0;e!=s[210].length;++e)s[210][e].charCodeAt(0)!==65533&&(r[s[210][e]]=53760+e,t[53760+e]=s[210][e]);for(s[211]="".split(""),e=0;e!=s[211].length;++e)s[211][e].charCodeAt(0)!==65533&&(r[s[211][e]]=54016+e,t[54016+e]=s[211][e]);for(s[212]="".split(""),e=0;e!=s[212].length;++e)s[212][e].charCodeAt(0)!==65533&&(r[s[212][e]]=54272+e,t[54272+e]=s[212][e]);for(s[213]="".split(""),e=0;e!=s[213].length;++e)s[213][e].charCodeAt(0)!==65533&&(r[s[213][e]]=54528+e,t[54528+e]=s[213][e]);for(s[214]="".split(""),e=0;e!=s[214].length;++e)s[214][e].charCodeAt(0)!==65533&&(r[s[214][e]]=54784+e,t[54784+e]=s[214][e]);for(s[215]="".split(""),e=0;e!=s[215].length;++e)s[215][e].charCodeAt(0)!==65533&&(r[s[215][e]]=55040+e,t[55040+e]=s[215][e]);for(s[216]="".split(""),e=0;e!=s[216].length;++e)s[216][e].charCodeAt(0)!==65533&&(r[s[216][e]]=55296+e,t[55296+e]=s[216][e]);for(s[217]="".split(""),e=0;e!=s[217].length;++e)s[217][e].charCodeAt(0)!==65533&&(r[s[217][e]]=55552+e,t[55552+e]=s[217][e]);for(s[218]="".split(""),e=0;e!=s[218].length;++e)s[218][e].charCodeAt(0)!==65533&&(r[s[218][e]]=55808+e,t[55808+e]=s[218][e]);for(s[219]="".split(""),e=0;e!=s[219].length;++e)s[219][e].charCodeAt(0)!==65533&&(r[s[219][e]]=56064+e,t[56064+e]=s[219][e]);for(s[220]="".split(""),e=0;e!=s[220].length;++e)s[220][e].charCodeAt(0)!==65533&&(r[s[220][e]]=56320+e,t[56320+e]=s[220][e]);for(s[221]="".split(""),e=0;e!=s[221].length;++e)s[221][e].charCodeAt(0)!==65533&&(r[s[221][e]]=56576+e,t[56576+e]=s[221][e]);for(s[222]="".split(""),e=0;e!=s[222].length;++e)s[222][e].charCodeAt(0)!==65533&&(r[s[222][e]]=56832+e,t[56832+e]=s[222][e]);for(s[223]="".split(""),e=0;e!=s[223].length;++e)s[223][e].charCodeAt(0)!==65533&&(r[s[223][e]]=57088+e,t[57088+e]=s[223][e]);for(s[224]="".split(""),e=0;e!=s[224].length;++e)s[224][e].charCodeAt(0)!==65533&&(r[s[224][e]]=57344+e,t[57344+e]=s[224][e]);for(s[225]="".split(""),e=0;e!=s[225].length;++e)s[225][e].charCodeAt(0)!==65533&&(r[s[225][e]]=57600+e,t[57600+e]=s[225][e]);for(s[226]="".split(""),e=0;e!=s[226].length;++e)s[226][e].charCodeAt(0)!==65533&&(r[s[226][e]]=57856+e,t[57856+e]=s[226][e]);for(s[227]="".split(""),e=0;e!=s[227].length;++e)s[227][e].charCodeAt(0)!==65533&&(r[s[227][e]]=58112+e,t[58112+e]=s[227][e]);for(s[228]="".split(""),e=0;e!=s[228].length;++e)s[228][e].charCodeAt(0)!==65533&&(r[s[228][e]]=58368+e,t[58368+e]=s[228][e]);for(s[229]="".split(""),e=0;e!=s[229].length;++e)s[229][e].charCodeAt(0)!==65533&&(r[s[229][e]]=58624+e,t[58624+e]=s[229][e]);for(s[230]="".split(""),e=0;e!=s[230].length;++e)s[230][e].charCodeAt(0)!==65533&&(r[s[230][e]]=58880+e,t[58880+e]=s[230][e]);for(s[231]="".split(""),e=0;e!=s[231].length;++e)s[231][e].charCodeAt(0)!==65533&&(r[s[231][e]]=59136+e,t[59136+e]=s[231][e]);for(s[232]="".split(""),e=0;e!=s[232].length;++e)s[232][e].charCodeAt(0)!==65533&&(r[s[232][e]]=59392+e,t[59392+e]=s[232][e]);for(s[233]="".split(""),e=0;e!=s[233].length;++e)s[233][e].charCodeAt(0)!==65533&&(r[s[233][e]]=59648+e,t[59648+e]=s[233][e]);for(s[234]="".split(""),e=0;e!=s[234].length;++e)s[234][e].charCodeAt(0)!==65533&&(r[s[234][e]]=59904+e,t[59904+e]=s[234][e]);for(s[235]="".split(""),e=0;e!=s[235].length;++e)s[235][e].charCodeAt(0)!==65533&&(r[s[235][e]]=60160+e,t[60160+e]=s[235][e]);for(s[236]="".split(""),e=0;e!=s[236].length;++e)s[236][e].charCodeAt(0)!==65533&&(r[s[236][e]]=60416+e,t[60416+e]=s[236][e]);for(s[237]="".split(""),e=0;e!=s[237].length;++e)s[237][e].charCodeAt(0)!==65533&&(r[s[237][e]]=60672+e,t[60672+e]=s[237][e]);for(s[238]="".split(""),e=0;e!=s[238].length;++e)s[238][e].charCodeAt(0)!==65533&&(r[s[238][e]]=60928+e,t[60928+e]=s[238][e]);for(s[239]="".split(""),e=0;e!=s[239].length;++e)s[239][e].charCodeAt(0)!==65533&&(r[s[239][e]]=61184+e,t[61184+e]=s[239][e]);for(s[240]="".split(""),e=0;e!=s[240].length;++e)s[240][e].charCodeAt(0)!==65533&&(r[s[240][e]]=61440+e,t[61440+e]=s[240][e]);for(s[241]="".split(""),e=0;e!=s[241].length;++e)s[241][e].charCodeAt(0)!==65533&&(r[s[241][e]]=61696+e,t[61696+e]=s[241][e]);for(s[242]="".split(""),e=0;e!=s[242].length;++e)s[242][e].charCodeAt(0)!==65533&&(r[s[242][e]]=61952+e,t[61952+e]=s[242][e]);for(s[243]="".split(""),e=0;e!=s[243].length;++e)s[243][e].charCodeAt(0)!==65533&&(r[s[243][e]]=62208+e,t[62208+e]=s[243][e]);for(s[244]="".split(""),e=0;e!=s[244].length;++e)s[244][e].charCodeAt(0)!==65533&&(r[s[244][e]]=62464+e,t[62464+e]=s[244][e]);for(s[245]="".split(""),e=0;e!=s[245].length;++e)s[245][e].charCodeAt(0)!==65533&&(r[s[245][e]]=62720+e,t[62720+e]=s[245][e]);for(s[246]="".split(""),e=0;e!=s[246].length;++e)s[246][e].charCodeAt(0)!==65533&&(r[s[246][e]]=62976+e,t[62976+e]=s[246][e]);for(s[247]="".split(""),e=0;e!=s[247].length;++e)s[247][e].charCodeAt(0)!==65533&&(r[s[247][e]]=63232+e,t[63232+e]=s[247][e]);return{enc:r,dec:t}})(),a[10029]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[10079]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[10081]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),a[28591]=(function(){for(var t=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,r=[],s={},e=0;e!=t.length;++e)t.charCodeAt(e)!==65533&&(s[t.charAt(e)]=e),r[e]=t.charAt(e);return{enc:s,dec:r}})(),n.exports&&typeof DO_NOT_EXPORT_CODEPAGE>"u"&&(n.exports=a);/*! cputils.js (C) 2013-present SheetJS -- http://sheetjs.com */(function(t,r){if(typeof a>"u")if(typeof v2<"u"){var s=a;n.exports&&typeof DO_NOT_EXPORT_CODEPAGE>"u"?n.exports=r(s):t.cptable=r(s)}else throw new Error("cptable not found");else a=r(a)})(oD,function(t){var r={1200:"utf16le",1201:"utf16be",12e3:"utf32le",12001:"utf32be",16969:"utf64le",20127:"ascii",65e3:"utf7",65001:"utf8"},s=[874,1250,1251,1252,1253,1254,1255,1256,1e4],e=[932,936,949,950],u=[65001],f={},m={},g={},b={},j=function(ye){return String.fromCharCode(ye)},F=function(ye){return ye.charCodeAt(0)},C=typeof Buffer<"u",M=function(){};if(C){var _=!Buffer.from;if(!_)try{Buffer.from("foo","utf8")}catch{_=!0}M=_?function(we,ye){return ye?new Buffer(we,ye):new Buffer(we)}:Buffer.from.bind(Buffer),Buffer.allocUnsafe||(Buffer.allocUnsafe=function(we){return new Buffer(we)});var L=1024,T=Buffer.allocUnsafe(L),H=function(ye){for(var te=Buffer.allocUnsafe(65536),V=0;V<65536;++V)te[V]=0;for(var le=Object.keys(ye),de=le.length,X=0,ie=le[X];X<de;++X)(ie=le[X])&&(te[ie.charCodeAt(0)]=ye[ie]);return te},O=function(ye){var te=H(t[ye].enc);return function(le,de){var X=le.length,ie,G=0,q=0,ve=0,Fe=0;if(typeof le=="string")for(ie=Buffer.allocUnsafe(X),G=0;G<X;++G)ie[G]=te[le.charCodeAt(G)];else if(Buffer.isBuffer(le)){for(ie=Buffer.allocUnsafe(2*X),q=0,G=0;G<X;++G)ve=le[G],ve<128?ie[q++]=te[ve]:ve<224?(ie[q++]=te[((ve&31)<<6)+(le[G+1]&63)],++G):ve<240?(ie[q++]=te[((ve&15)<<12)+((le[G+1]&63)<<6)+(le[G+2]&63)],G+=2):(Fe=((ve&7)<<18)+((le[G+1]&63)<<12)+((le[G+2]&63)<<6)+(le[G+3]&63),G+=3,Fe<65536?ie[q++]=te[Fe]:(Fe-=65536,ie[q++]=te[55296+(Fe>>10&1023)],ie[q++]=te[56320+(Fe&1023)]));ie=ie.slice(0,q)}else for(ie=Buffer.allocUnsafe(X),G=0;G<X;++G)ie[G]=te[le[G].charCodeAt(0)];return!de||de==="buf"?ie:de!=="arr"?ie.toString("binary"):[].slice.call(ie)}},Q=function(ye){var te=t[ye].dec,V=Buffer.allocUnsafe(131072),le=0,de="";for(le=0;le<te.length;++le)if(de=te[le]){var X=de.charCodeAt(0);V[2*le]=X&255,V[2*le+1]=X>>8}return function(G){var q=G.length,ve=0,Fe=0;if(2*q>L&&(L=2*q,T=Buffer.allocUnsafe(L)),Buffer.isBuffer(G))for(ve=0;ve<q;ve++)Fe=2*G[ve],T[2*ve]=V[Fe],T[2*ve+1]=V[Fe+1];else if(typeof G=="string")for(ve=0;ve<q;ve++)Fe=2*G.charCodeAt(ve),T[2*ve]=V[Fe],T[2*ve+1]=V[Fe+1];else for(ve=0;ve<q;ve++)Fe=2*G[ve],T[2*ve]=V[Fe],T[2*ve+1]=V[Fe+1];return T.slice(0,2*q).toString("ucs2")}},Z=function(ye){for(var te=t[ye].enc,V=Buffer.allocUnsafe(131072),le=0;le<131072;++le)V[le]=0;for(var de=Object.keys(te),X=0,ie=de[X];X<de.length;++X)if(ie=de[X]){var G=ie.charCodeAt(0);V[2*G]=te[ie]&255,V[2*G+1]=te[ie]>>8}return function(ve,Fe){var Qe=ve.length,Ge=Buffer.allocUnsafe(2*Qe),je=0,Me=0,Se=0,ft=0,jt=0;if(typeof ve=="string"){for(je=ft=0;je<Qe;++je)Me=ve.charCodeAt(je)*2,Ge[ft++]=V[Me+1]||V[Me],V[Me+1]>0&&(Ge[ft++]=V[Me]);Ge=Ge.slice(0,ft)}else if(Buffer.isBuffer(ve)){for(je=ft=0;je<Qe;++je)jt=ve[je],jt<128?Me=jt:jt<224?(Me=((jt&31)<<6)+(ve[je+1]&63),++je):jt<240?(Me=((jt&15)<<12)+((ve[je+1]&63)<<6)+(ve[je+2]&63),je+=2):(Me=((jt&7)<<18)+((ve[je+1]&63)<<12)+((ve[je+2]&63)<<6)+(ve[je+3]&63),je+=3),Me<65536?(Me*=2,Ge[ft++]=V[Me+1]||V[Me],V[Me+1]>0&&(Ge[ft++]=V[Me])):(Se=Me-65536,Me=2*(55296+(Se>>10&1023)),Ge[ft++]=V[Me+1]||V[Me],V[Me+1]>0&&(Ge[ft++]=V[Me]),Me=2*(56320+(Se&1023)),Ge[ft++]=V[Me+1]||V[Me],V[Me+1]>0&&(Ge[ft++]=V[Me]));Ge=Ge.slice(0,ft)}else for(je=ft=0;je<Qe;je++)Me=ve[je].charCodeAt(0)*2,Ge[ft++]=V[Me+1]||V[Me],V[Me+1]>0&&(Ge[ft++]=V[Me]);return!Fe||Fe==="buf"?Ge:Fe!=="arr"?Ge.toString("binary"):[].slice.call(Ge)}},ee=function(ye){var te=t[ye].dec,V=Buffer.allocUnsafe(131072),le=0,de,X=0,ie=0,G=0;for(G=0;G<65536;++G)V[2*G]=255,V[2*G+1]=253;for(le=0;le<te.length;++le)(de=te[le])&&(X=de.charCodeAt(0),ie=2*le,V[ie]=X&255,V[ie+1]=X>>8);return function(ve){var Fe=ve.length,Qe=Buffer.allocUnsafe(2*Fe),Ge=0,je=0,Me=0;if(Buffer.isBuffer(ve))for(Ge=0;Ge<Fe;Ge++)je=2*ve[Ge],V[je]===255&&V[je+1]===253&&(je=2*((ve[Ge]<<8)+ve[Ge+1]),++Ge),Qe[Me++]=V[je],Qe[Me++]=V[je+1];else if(typeof ve=="string")for(Ge=0;Ge<Fe;Ge++)je=2*ve.charCodeAt(Ge),V[je]===255&&V[je+1]===253&&(je=2*((ve.charCodeAt(Ge)<<8)+ve.charCodeAt(Ge+1)),++Ge),Qe[Me++]=V[je],Qe[Me++]=V[je+1];else for(Ge=0;Ge<Fe;Ge++)je=2*ve[Ge],V[je]===255&&V[je+1]===253&&(je=2*((ve[Ge]<<8)+ve[Ge+1]),++Ge),Qe[Me++]=V[je],Qe[Me++]=V[je+1];return Qe.slice(0,Me).toString("ucs2")}};f[65001]=function we(ye){if(typeof ye=="string")return we(ye.split("").map(F));var te=ye.length,V=0,le=0;4*te>L&&(L=4*te,T=Buffer.allocUnsafe(L));var de=0;te>=3&&ye[0]==239&&ye[1]==187&&ye[2]==191&&(de=3);for(var X=1,ie=0,G=0;de<te;de+=X)X=1,G=ye[de],G<128?V=G:G<224?(V=(G&31)*64+(ye[de+1]&63),X=2):G<240?(V=((G&15)<<12)+(ye[de+1]&63)*64+(ye[de+2]&63),X=3):(V=(G&7)*262144+((ye[de+1]&63)<<12)+(ye[de+2]&63)*64+(ye[de+3]&63),X=4),V<65536?(T[ie++]=V&255,T[ie++]=V>>8):(V-=65536,le=55296+(V>>10&1023),V=56320+(V&1023),T[ie++]=le&255,T[ie++]=le>>>8,T[ie++]=V&255,T[ie++]=V>>>8&255);return T.slice(0,ie).toString("ucs2")},m[65001]=function(ye,te){if(C&&Buffer.isBuffer(ye))return!te||te==="buf"?ye:te!=="arr"?ye.toString("binary"):[].slice.call(ye);var V=ye.length,le=0,de=0,X=0,ie=typeof ye=="string";4*V>L&&(L=4*V,T=Buffer.allocUnsafe(L));for(var G=0;G<V;++G)le=ie?ye.charCodeAt(G):ye[G].charCodeAt(0),le<=127?T[X++]=le:le<=2047?(T[X++]=192+(le>>6),T[X++]=128+(le&63)):le>=55296&&le<=57343?(le-=55296,++G,de=(ie?ye.charCodeAt(G):ye[G].charCodeAt(0))-56320+(le<<10),T[X++]=240+(de>>>18&7),T[X++]=144+(de>>>12&63),T[X++]=128+(de>>>6&63),T[X++]=128+(de&63)):(T[X++]=224+(le>>12),T[X++]=128+(le>>6&63),T[X++]=128+(le&63));return!te||te==="buf"?T.slice(0,X):te!=="arr"?T.slice(0,X).toString("binary"):[].slice.call(T,0,X)}}var se=function(){if(C){if(g[s[0]])return;var ye=0,te=0;for(ye=0;ye<s.length;++ye)te=s[ye],t[te]&&(g[te]=Q(te),b[te]=O(te));for(ye=0;ye<e.length;++ye)te=e[ye],t[te]&&(g[te]=ee(te),b[te]=Z(te));for(ye=0;ye<u.length;++ye)te=u[ye],f[te]&&(g[te]=f[te]),m[te]&&(b[te]=m[te])}},ue=function(we,ye){return""},ae=function(ye){delete g[ye],delete b[ye]},pe=function(){if(C){if(!g[s[0]])return;s.forEach(ae),e.forEach(ae),u.forEach(ae)}fe=ue,ke=0},z={encache:se,decache:pe,sbcs:s,dbcs:e};se();var J="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ge="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'(),-./:?",fe=ue,ke=0,he=function we(ye,te,V){if(ye===ke&&fe)return fe(te,V);if(b[ye])return fe=b[ke=ye],fe(te,V);C&&Buffer.isBuffer(te)&&(te=te.toString("utf8"));var le=te.length,de=C?Buffer.allocUnsafe(4*le):[],X=0,ie=0,G=0,q=0,ve=t[ye],Fe,Qe="",Ge=typeof te=="string";if(ve&&(Fe=ve.enc))for(ie=0;ie<le;++ie,++G)X=Fe[Ge?te.charAt(ie):te[ie]],X>255?(de[G]=X>>8,de[++G]=X&255):de[G]=X&255;else if(Qe=r[ye])switch(Qe){case"utf8":if(C&&Ge){de=M(te,Qe),G=de.length;break}for(ie=0;ie<le;++ie,++G)X=Ge?te.charCodeAt(ie):te[ie].charCodeAt(0),X<=127?de[G]=X:X<=2047?(de[G]=192+(X>>6),de[++G]=128+(X&63)):X>=55296&&X<=57343?(X-=55296,q=(Ge?te.charCodeAt(++ie):te[++ie].charCodeAt(0))-56320+(X<<10),de[G]=240+(q>>>18&7),de[++G]=144+(q>>>12&63),de[++G]=128+(q>>>6&63),de[++G]=128+(q&63)):(de[G]=224+(X>>12),de[++G]=128+(X>>6&63),de[++G]=128+(X&63));break;case"ascii":if(C&&typeof te=="string"){de=M(te,Qe),G=de.length;break}for(ie=0;ie<le;++ie,++G)if(X=Ge?te.charCodeAt(ie):te[ie].charCodeAt(0),X<=127)de[G]=X;else throw new Error("bad ascii "+X);break;case"utf16le":if(C&&typeof te=="string"){de=M(te,Qe),G=de.length;break}for(ie=0;ie<le;++ie)X=Ge?te.charCodeAt(ie):te[ie].charCodeAt(0),de[G++]=X&255,de[G++]=X>>8;break;case"utf16be":for(ie=0;ie<le;++ie)X=Ge?te.charCodeAt(ie):te[ie].charCodeAt(0),de[G++]=X>>8,de[G++]=X&255;break;case"utf32le":for(ie=0;ie<le;++ie)X=Ge?te.charCodeAt(ie):te[ie].charCodeAt(0),X>=55296&&X<=57343&&(X=65536+(X-55296<<10)+(te[++ie].charCodeAt(0)-56320)),de[G++]=X&255,X>>=8,de[G++]=X&255,X>>=8,de[G++]=X&255,X>>=8,de[G++]=X&255;break;case"utf32be":for(ie=0;ie<le;++ie)X=Ge?te.charCodeAt(ie):te[ie].charCodeAt(0),X>=55296&&X<=57343&&(X=65536+(X-55296<<10)+(te[++ie].charCodeAt(0)-56320)),de[G+3]=X&255,X>>=8,de[G+2]=X&255,X>>=8,de[G+1]=X&255,X>>=8,de[G]=X&255,G+=4;break;case"utf7":for(ie=0;ie<le;ie++){var je=Ge?te.charAt(ie):te[ie].charAt(0);if(je==="+"){de[G++]=43,de[G++]=45;continue}if(ge.indexOf(je)>-1){de[G++]=je.charCodeAt(0);continue}var Me=we(1201,je);de[G++]=43,de[G++]=J.charCodeAt(Me[0]>>2),de[G++]=J.charCodeAt(((Me[0]&3)<<4)+((Me[1]||0)>>4)),de[G++]=J.charCodeAt(((Me[1]&15)<<2)+((Me[2]||0)>>6)),de[G++]=45}break;default:throw new Error("Unsupported magic: "+ye+" "+r[ye])}else throw new Error("Unrecognized CP: "+ye);return de=de.slice(0,G),C?!V||V==="buf"?de:V!=="arr"?de.toString("binary"):[].slice.call(de):V=="str"?de.map(j).join(""):de},Ne=function we(ye,te){var V;if(V=g[ye])return V(te);if(typeof te=="string")return we(ye,te.split("").map(F));var le=te.length,de=new Array(le),X="",ie=0,G=0,q=1,ve=0,Fe=0,Qe=t[ye],Ge,je="";if(Qe&&(Ge=Qe.dec))for(G=0;G<le;G+=q){if(q=2,X=Ge[(te[G]<<8)+te[G+1]],X||(q=1,X=Ge[te[G]]),!X)throw new Error("Unrecognized code: "+te[G]+" "+te[G+q-1]+" "+G+" "+q+" "+Ge[te[G]]);de[ve++]=X}else if(je=r[ye])switch(je){case"utf8":for(le>=3&&te[0]==239&&te[1]==187&&te[2]==191&&(G=3);G<le;G+=q)q=1,te[G]<128?ie=te[G]:te[G]<224?(ie=(te[G]&31)*64+(te[G+1]&63),q=2):te[G]<240?(ie=((te[G]&15)<<12)+(te[G+1]&63)*64+(te[G+2]&63),q=3):(ie=(te[G]&7)*262144+((te[G+1]&63)<<12)+(te[G+2]&63)*64+(te[G+3]&63),q=4),ie<65536||(ie-=65536,Fe=55296+(ie>>10&1023),ie=56320+(ie&1023),de[ve++]=String.fromCharCode(Fe)),de[ve++]=String.fromCharCode(ie);break;case"ascii":if(C&&Buffer.isBuffer(te))return te.toString(je);for(G=0;G<le;G++)de[G]=String.fromCharCode(te[G]);ve=le;break;case"utf16le":if(le>=2&&te[0]==255&&te[1]==254&&(G=2),C&&Buffer.isBuffer(te))return te.toString(je);for(q=2;G+1<le;G+=q)de[ve++]=String.fromCharCode((te[G+1]<<8)+te[G]);break;case"utf16be":for(le>=2&&te[0]==254&&te[1]==255&&(G=2),q=2;G+1<le;G+=q)de[ve++]=String.fromCharCode((te[G]<<8)+te[G+1]);break;case"utf32le":for(le>=4&&te[0]==255&&te[1]==254&&te[2]===0&&te[3]===0&&(G=4),q=4;G<le;G+=q)ie=(te[G+3]<<24)+(te[G+2]<<16)+(te[G+1]<<8)+te[G],ie>65535?(ie-=65536,de[ve++]=String.fromCharCode(55296+(ie>>10&1023)),de[ve++]=String.fromCharCode(56320+(ie&1023))):de[ve++]=String.fromCharCode(ie);break;case"utf32be":for(le>=4&&te[3]==255&&te[2]==254&&te[1]===0&&te[0]===0&&(G=4),q=4;G<le;G+=q)ie=(te[G]<<24)+(te[G+1]<<16)+(te[G+2]<<8)+te[G+3],ie>65535?(ie-=65536,de[ve++]=String.fromCharCode(55296+(ie>>10&1023)),de[ve++]=String.fromCharCode(56320+(ie&1023))):de[ve++]=String.fromCharCode(ie);break;case"utf7":for(le>=4&&te[0]==43&&te[1]==47&&te[2]==118&&(le>=5&&te[3]==56&&te[4]==45?G=5:(te[3]==56||te[3]==57||te[3]==43||te[3]==47)&&(G=4));G<le;G+=q){if(te[G]!==43){q=1,de[ve++]=String.fromCharCode(te[G]);continue}if(q=1,te[G+1]===45){q=2,de[ve++]="+";continue}for(;String.fromCharCode(te[G+q]).match(/[A-Za-z0-9+\/]/);)q++;var Me=0;te[G+q]===45&&(++q,Me=1);for(var Se=[],ft="",jt=0,It=0,ut=0,Rt=0,Ye=0,St=0,Jt=0,mr=1;mr<q-Me&&(Rt=J.indexOf(String.fromCharCode(te[G+mr++])),Ye=J.indexOf(String.fromCharCode(te[G+mr++])),jt=Rt<<2|Ye>>4,Se.push(jt),St=J.indexOf(String.fromCharCode(te[G+mr++])),!(St===-1||(It=(Ye&15)<<4|St>>2,Se.push(It),Jt=J.indexOf(String.fromCharCode(te[G+mr++])),Jt===-1)));)ut=(St&3)<<6|Jt,Jt<64&&Se.push(ut);for(ft=we(1201,Se),mr=0;mr<ft.length;++mr)de[ve++]=ft.charAt(mr)}break;default:throw new Error("Unsupported magic: "+ye+" "+r[ye])}else throw new Error("Unrecognized CP: "+ye);return de.slice(0,ve).join("")},xe=function(ye){return!!(t[ye]||r[ye])};return t.utils={decode:Ne,encode:he,hascp:xe,magic:r,cache:z},t})})(w2)),w2.exports}const cD={},AD=Object.freeze(Object.defineProperty({__proto__:null,default:cD},Symbol.toStringTag,{value:"Module"})),Uy=iS(AD);var T4;function dD(){return T4||(T4=1,(function(n,a){var t={};function r(s){s.version="0.18.5",s.style_version="1.2.0";var e,u=1200,f=1252;typeof cptable<"u"?e=cptable:typeof v2<"u"&&(e=lD());var m=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],g={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},b=function(o){m.indexOf(o)!=-1&&(f=g[0]=o)},j=function(o){b(u=o)};function F(){j(1200),b(1252)}function C(o){for(var A=[],d=0,h=o.length;d<h;++d)A[d]=o.charCodeAt(d);return A}function M(o){for(var A=[],d=0;d<o.length>>1;++d)A[d]=String.fromCharCode(o.charCodeAt(2*d+1)+(o.charCodeAt(2*d)<<8));return A.join("")}var _=function(o){var A=o.charCodeAt(0),d=o.charCodeAt(1);return A==255&&d==254?(function(h){for(var x=[],w=0;w<h.length>>1;++w)x[w]=String.fromCharCode(h.charCodeAt(2*w)+(h.charCodeAt(2*w+1)<<8));return x.join("")})(o.slice(2)):A==254&&d==255?M(o.slice(2)):A==65279?o.slice(1):o},L=function(o){return String.fromCharCode(o)},T=function(o){return String.fromCharCode(o)};e!==void 0&&(j=function(o){b(u=o)},_=function(o){return o.charCodeAt(0)===255&&o.charCodeAt(1)===254?e.utils.decode(1200,C(o.slice(2))):o},L=function(o){return u===1200?String.fromCharCode(o):e.utils.decode(u,[255&o,o>>8])[0]},T=function(o){return e.utils.decode(f,[o])[0]});var H="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function O(o){for(var A,d,h,x,w,v="",N=0,S=0,E=0;E<o.length;)x=(A=o.charCodeAt(E++))>>2,w=(3&A)<<4|(d=o.charCodeAt(E++))>>4,N=(15&d)<<2|(h=o.charCodeAt(E++))>>6,S=63&h,isNaN(d)?N=S=64:isNaN(h)&&(S=64),v+=H.charAt(x)+H.charAt(w)+H.charAt(N)+H.charAt(S);return v}function Q(o){var A,d,h,x,w,v,N="";o=o.replace(/[^\w\+\/\=]/g,"");for(var S=0;S<o.length;)A=H.indexOf(o.charAt(S++))<<2|(x=H.indexOf(o.charAt(S++)))>>4,N+=String.fromCharCode(A),d=(15&x)<<4|(w=H.indexOf(o.charAt(S++)))>>2,w!==64&&(N+=String.fromCharCode(d)),h=(3&w)<<6|(v=H.indexOf(o.charAt(S++))),v!==64&&(N+=String.fromCharCode(h));return N}var Z=typeof Buffer<"u"&&typeof process<"u"&&process.versions!==void 0&&!!process.versions.node,ee=(function(){if(typeof Buffer>"u")return function(){};var o=!Buffer.from;if(!o)try{Buffer.from("foo","utf8")}catch{o=!0}return o?function(A,d){return d?new Buffer(A,d):new Buffer(A)}:Buffer.from.bind(Buffer)})();function se(o){return Z?Buffer.alloc?Buffer.alloc(o):new Buffer(o):new(typeof Uint8Array<"u"?Uint8Array:Array)(o)}function ue(o){return Z?Buffer.allocUnsafe?Buffer.allocUnsafe(o):new Buffer(o):new(typeof Uint8Array<"u"?Uint8Array:Array)(o)}var ae=function(o){return Z?ee(o,"binary"):o.split("").map(function(A){return 255&A.charCodeAt(0)})};function pe(o){if(typeof ArrayBuffer>"u")return ae(o);for(var A=new ArrayBuffer(o.length),d=new Uint8Array(A),h=0;h!=o.length;++h)d[h]=255&o.charCodeAt(h);return A}function z(o){if(Array.isArray(o))return o.map(function(h){return String.fromCharCode(h)}).join("");for(var A=[],d=0;d<o.length;++d)A[d]=String.fromCharCode(o[d]);return A.join("")}function J(o){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(o instanceof ArrayBuffer)return J(new Uint8Array(o));for(var A=new Array(o.length),d=0;d<o.length;++d)A[d]=o[d];return A}var ge=Z?function(o){return Buffer.concat(o.map(function(A){return Buffer.isBuffer(A)?A:ee(A)}))}:function(o){if(typeof Uint8Array>"u")return[].concat.apply([],o.map(function(w){return Array.isArray(w)?w:[].slice.call(w)}));for(var d=0,A=0,d=0;d<o.length;++d)A+=o[d].length;for(var h,x=new Uint8Array(A),A=d=0;d<o.length;A+=h,++d)if(h=o[d].length,o[d]instanceof Uint8Array)x.set(o[d],A);else{if(typeof o[d]=="string")throw"wtf";x.set(new Uint8Array(o[d]),A)}return x},fe=/\u0000/g,ke=/[\u0001-\u0006]/g;function he(o){for(var A="",d=o.length-1;0<=d;)A+=o.charAt(d--);return A}function Ne(o,A){return o=""+o,A<=o.length?o:ss("0",A-o.length)+o}function xe(o,A){return o=""+o,A<=o.length?o:ss(" ",A-o.length)+o}function we(o,A){return o=""+o,A<=o.length?o:o+ss(" ",A-o.length)}var ye=Math.pow(2,32);function te(x,A){if(ye<x||x<-ye)return d=x,h=A,d=""+Math.round(d),h<=d.length?d:ss("0",h-d.length)+d;var d,h,x=Math.round(x);return(A=A)<=(x=""+(x=x)).length?x:ss("0",A-x.length)+x}function V(o,A){return A=A||0,o.length>=7+A&&(32|o.charCodeAt(A))==103&&(32|o.charCodeAt(A+1))==101&&(32|o.charCodeAt(A+2))==110&&(32|o.charCodeAt(A+3))==101&&(32|o.charCodeAt(A+4))==114&&(32|o.charCodeAt(A+5))==97&&(32|o.charCodeAt(A+6))==108}var le=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],de=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],X={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},ie={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},G={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function q(o,A,d){for(var h=o<0?-1:1,x=o*h,w=0,v=1,N=0,S=1,E=0,I=0,P=Math.floor(x);E<A&&(N=(P=Math.floor(x))*v+w,I=P*E+S,!(x-P<5e-8));)x=1/(x-P),w=v,v=N,S=E,E=I;return A<I&&(N=A<E?(I=S,w):(I=E,v)),d?(d=Math.floor(h*N/I),[d,h*N-d*I,I]):[0,h*N,I]}function ve(N,A,d){if(2958465<N||N<0)return null;var h=0|N,x=Math.floor(86400*(N-h)),w=0,v=[],N={D:h,T:x,u:86400*(N-h)-x,y:0,m:0,d:0,H:0,M:0,S:0,q:0};return Math.abs(N.u)<1e-6&&(N.u=0),A&&A.date1904&&(h+=1462),.9999<N.u&&(N.u=0,++x==86400&&(N.T=x=0,++h,++N.D)),h===60?(v=d?[1317,10,29]:[1900,2,29],w=3):h===0?(v=d?[1317,8,29]:[1900,1,0],w=6):(60<h&&--h,(A=new Date(1900,0,1)).setDate(A.getDate()+h-1),v=[A.getFullYear(),A.getMonth()+1,A.getDate()],w=A.getDay(),h<60&&(w=(w+6)%7),d&&(w=(function(S,E){return E[0]-=581,E=S.getDay(),S<60&&(E=(E+6)%7),E})(A,v))),N.y=v[0],N.m=v[1],N.d=v[2],N.S=x%60,x=Math.floor(x/60),N.M=x%60,x=Math.floor(x/60),N.H=x,N.q=w,N}var Fe=new Date(1899,11,31,0,0,0),Qe=Fe.getTime(),Ge=new Date(1900,2,1,0,0,0);function je(o,A){var d=o.getTime();return A?d-=1262304e5:Ge<=o&&(d+=864e5),(d-(Qe+6e4*(o.getTimezoneOffset()-Fe.getTimezoneOffset())))/864e5}function Me(o){return o.indexOf(".")==-1?o:o.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Se(o){var A,d,h,x=Math.floor(Math.log(Math.abs(o))*Math.LOG10E),w=-4<=x&&x<=-1?o.toPrecision(10+x):Math.abs(x)<=9?(d=(A=o)<0?12:11,(h=Me(A.toFixed(12))).length<=d||(h=A.toPrecision(10)).length<=d?h:A.toExponential(5)):x===10?o.toFixed(10).substr(0,12):(w=Me((o=o).toFixed(11))).length>(o<0?12:11)||w==="0"||w==="-0"?o.toPrecision(6):w;return Me((w=w.toUpperCase()).indexOf("E")==-1?w:w.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2"))}function ft(o,A){switch(typeof o){case"string":return o;case"boolean":return o?"TRUE":"FALSE";case"number":return(0|o)===o?o.toString(10):Se(o);case"undefined":return"";case"object":if(o==null)return"";if(o instanceof Date)return pr(14,je(o,A&&A.date1904),A)}throw new Error("unsupported value in General format: "+o)}function jt(o){if(o.length<=3)return o;for(var A=o.length%3,d=o.substr(0,A);A!=o.length;A+=3)d+=(0<d.length?",":"")+o.substr(A,3);return d}var It=/%/g,ut=/# (\?+)( ?)\/( ?)(\d+)/,Rt=/^#*0*\.([0#]+)/,Ye=/\).*[0#]/,St=/\(###\) ###\\?-####/;function Jt(o){for(var A,d="",h=0;h!=o.length;++h)switch(A=o.charCodeAt(h)){case 35:break;case 63:d+=" ";break;case 48:d+="0";break;default:d+=String.fromCharCode(A)}return d}function mr(o,A){return A=Math.pow(10,A),""+Math.round(o*A)/A}function ar(h,A){var d=h-Math.floor(h),h=Math.pow(10,A);return A<(""+Math.round(d*h)).length?0:Math.round(d*h)}function bt(o,A,d){if(o.charCodeAt(0)===40&&!A.match(Ye)){var h=A.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return 0<=d?bt("n",h,d):"("+bt("n",h,-d)+")"}if(A.charCodeAt(A.length-1)===44)return(function(ce,Ee,Ue){for(var Ie=Ee.length-1;Ee.charCodeAt(Ie-1)===44;)--Ie;return vr(ce,Ee.substr(0,Ie),Ue/Math.pow(10,3*(Ee.length-Ie)))})(o,A,d);if(A.indexOf("%")!==-1)return N=o,E=d,S=(I=A).replace(It,""),I=I.length-S.length,vr(N,S,E*Math.pow(10,2*I))+ss("%",I);var x;if(A.indexOf("E")!==-1)return(function ce(Ee,Ue){var Ie,$e=Ee.indexOf("E")-Ee.indexOf(".")-1;if(Ee.match(/^#+0.0E\+0$/)){if(Ue==0)return"0.0E+0";if(Ue<0)return"-"+ce(Ee,-Ue);var st=Ee.indexOf(".");st===-1&&(st=Ee.indexOf("E"));var rt=Math.floor(Math.log(Ue)*Math.LOG10E)%st;if(rt<0&&(rt+=st),(Ie=(Ue/Math.pow(10,rt)).toPrecision(1+$e+(st+rt)%st)).indexOf("e")===-1){var mt=Math.floor(Math.log(Ue)*Math.LOG10E);for(Ie.indexOf(".")===-1?Ie=Ie.charAt(0)+"."+Ie.substr(1)+"E+"+(mt-Ie.length+rt):Ie+="E+"+(mt-rt);Ie.substr(0,2)==="0.";)Ie=(Ie=Ie.charAt(0)+Ie.substr(2,st)+"."+Ie.substr(2+st)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");Ie=Ie.replace(/\+-/,"-")}Ie=Ie.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(Mt,Qt,vt,Zt){return Qt+vt+Zt.substr(0,(st+rt)%st)+"."+Zt.substr(rt)+"E"})}else Ie=Ue.toExponential($e);return Ee.match(/E\+00$/)&&Ie.match(/e[+-]\d$/)&&(Ie=Ie.substr(0,Ie.length-1)+"0"+Ie.charAt(Ie.length-1)),(Ie=Ee.match(/E\-/)&&Ie.match(/e\+/)?Ie.replace(/e\+/,"e"):Ie).replace("e","E")})(A,d);if(A.charCodeAt(0)===36)return"$"+bt(o,A.substr(A.charAt(1)==" "?2:1),d);var w,v,N,S,E,I,P,K=Math.abs(d),W=d<0?"-":"";if(A.match(/^00+$/))return W+te(K,A.length);if(A.match(/^[#?]+$/))return(x=(x=te(d,0))==="0"?"":x).length>A.length?x:Jt(A.substr(0,A.length-x.length))+x;if(w=A.match(ut))return P=w,N=K,S=W,E=parseInt(P[4],10),I=Math.round(N*E),N=Math.floor(I/E),S+(N===0?"":""+N)+" "+((I-=N*E)==0?ss(" ",P[1].length+1+P[4].length):xe(I,P[1].length)+P[2]+"/"+P[3]+Ne(E,P[4].length));if(A.match(/^#+0+$/))return W+te(K,A.length-A.indexOf("0"));if(w=A.match(Rt))return x=mr(d,w[1].length).replace(/^([^\.]+)$/,"$1."+Jt(w[1])).replace(/\.$/,"."+Jt(w[1])).replace(/\.(\d*)$/,function(ce,Ee){return"."+Ee+ss("0",Jt(w[1]).length-Ee.length)}),A.indexOf("0.")!==-1?x:x.replace(/^0\./,".");if(A=A.replace(/^#+([0.])/,"$1"),w=A.match(/^(0*)\.(#*)$/))return W+mr(K,w[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,w[1].length?"0.":".");if(w=A.match(/^#{1,3},##0(\.?)$/))return W+jt(te(K,0));if(w=A.match(/^#,##0\.([#0]*0)$/))return d<0?"-"+bt(o,A,-d):jt(""+(Math.floor(d)+(P=d,(me=w[1].length)<(""+Math.round((P-Math.floor(P))*Math.pow(10,me))).length?1:0)))+"."+Ne(ar(d,w[1].length),w[1].length);if(w=A.match(/^#,#*,#0/))return bt(o,A.replace(/^#,#*,/,""),d);if(w=A.match(/^([0#]+)(\\?-([0#]+))+$/))return x=he(bt(o,A.replace(/[\\-]/g,""),d)),v=0,he(he(A.replace(/\\/g,"")).replace(/[0#]/g,function(ce){return v<x.length?x.charAt(v++):ce==="0"?"0":""}));if(A.match(St))return"("+(x=bt(o,"##########",d)).substr(0,3)+") "+x.substr(3,3)+"-"+x.substr(6);var me="";if(w=A.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return v=Math.min(w[4].length,7),re=q(K,Math.pow(10,v)-1,!1),x=W,(me=vr("n",w[1],re[1])).charAt(me.length-1)==" "&&(me=me.substr(0,me.length-1)+"0"),x+=me+w[2]+"/"+w[3],(me=we(re[2],v)).length<w[4].length&&(me=Jt(w[4].substr(w[4].length-me.length))+me),x+=me;if(w=A.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return v=Math.min(Math.max(w[1].length,w[4].length),7),W+((re=q(K,Math.pow(10,v)-1,!0))[0]||(re[1]?"":"0"))+" "+(re[1]?xe(re[1],v)+w[2]+"/"+w[3]+we(re[2],v):ss(" ",2*v+1+w[2].length+w[3].length));if(w=A.match(/^[#0?]+$/))return x=te(d,0),A.length<=x.length?x:Jt(A.substr(0,A.length-x.length))+x;if(w=A.match(/^([#0?]+)\.([#0]+)$/)){x=""+d.toFixed(Math.min(w[2].length,10)).replace(/([^0])0+$/,"$1"),v=x.indexOf(".");var re=A.indexOf(".")-v,De=A.length-x.length-re;return Jt(A.substr(0,re)+x+A.substr(A.length-De))}if(w=A.match(/^00,000\.([#0]*0)$/))return v=ar(d,w[1].length),d<0?"-"+bt(o,A,-d):jt((De=d)<2147483647&&-2147483648<De?""+(0<=De?0|De:De-1|0):""+Math.floor(De)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(ce){return"00,"+(ce.length<3?Ne(0,3-ce.length):"")+ce})+"."+Ne(v,w[1].length);switch(A){case"###,##0.00":return bt(o,"#,##0.00",d);case"###,###":case"##,###":case"#,###":var be=jt(te(K,0));return be!=="0"?W+be:"";case"###,###.00":return bt(o,"###,##0.00",d).replace(/^0\./,".");case"#,###.00":return bt(o,"#,##0.00",d).replace(/^0\./,".")}throw new Error("unsupported format |"+A+"|")}function Yt(o,A,d){if(o.charCodeAt(0)===40&&!A.match(Ye)){var h=A.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return 0<=d?Yt("n",h,d):"("+Yt("n",h,-d)+")"}if(A.charCodeAt(A.length-1)===44)return(function(re,De,be){for(var ce=De.length-1;De.charCodeAt(ce-1)===44;)--ce;return vr(re,De.substr(0,ce),be/Math.pow(10,3*(De.length-ce)))})(o,A,d);if(A.indexOf("%")!==-1)return x=o,v=d,h=(w=A).replace(It,""),w=w.length-h.length,vr(x,h,v*Math.pow(10,2*w))+ss("%",w);var x,w,v,N;if(A.indexOf("E")!==-1)return(function re(De,be){var ce,Ee=De.indexOf("E")-De.indexOf(".")-1;if(De.match(/^#+0.0E\+0$/)){if(be==0)return"0.0E+0";if(be<0)return"-"+re(De,-be);var Ue=De.indexOf(".");Ue===-1&&(Ue=De.indexOf("E"));var Ie,$e=Math.floor(Math.log(be)*Math.LOG10E)%Ue;$e<0&&($e+=Ue),(ce=(be/Math.pow(10,$e)).toPrecision(1+Ee+(Ue+$e)%Ue)).match(/[Ee]/)||(Ie=Math.floor(Math.log(be)*Math.LOG10E),ce.indexOf(".")===-1?ce=ce.charAt(0)+"."+ce.substr(1)+"E+"+(Ie-ce.length+$e):ce+="E+"+(Ie-$e),ce=ce.replace(/\+-/,"-")),ce=ce.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(st,rt,mt,Mt){return rt+mt+Mt.substr(0,(Ue+$e)%Ue)+"."+Mt.substr($e)+"E"})}else ce=be.toExponential(Ee);return De.match(/E\+00$/)&&ce.match(/e[+-]\d$/)&&(ce=ce.substr(0,ce.length-1)+"0"+ce.charAt(ce.length-1)),(ce=De.match(/E\-/)&&ce.match(/e\+/)?ce.replace(/e\+/,"e"):ce).replace("e","E")})(A,d);if(A.charCodeAt(0)===36)return"$"+Yt(o,A.substr(A.charAt(1)==" "?2:1),d);var S,E,I=Math.abs(d),P=d<0?"-":"";if(A.match(/^00+$/))return P+Ne(I,A.length);if(A.match(/^[#?]+$/))return(N=d===0?"":""+d).length>A.length?N:Jt(A.substr(0,A.length-N.length))+N;if(S=A.match(ut))return P+((K=I)===0?"":""+K)+ss(" ",(K=S)[1].length+2+K[4].length);if(A.match(/^#+0+$/))return P+Ne(I,A.length-A.indexOf("0"));if(S=A.match(Rt))return N=(N=(""+d).replace(/^([^\.]+)$/,"$1."+Jt(S[1])).replace(/\.$/,"."+Jt(S[1]))).replace(/\.(\d*)$/,function(re,De){return"."+De+ss("0",Jt(S[1]).length-De.length)}),A.indexOf("0.")!==-1?N:N.replace(/^0\./,".");if(A=A.replace(/^#+([0.])/,"$1"),S=A.match(/^(0*)\.(#*)$/))return P+(""+I).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,S[1].length?"0.":".");if(S=A.match(/^#{1,3},##0(\.?)$/))return P+jt(""+I);if(S=A.match(/^#,##0\.([#0]*0)$/))return d<0?"-"+Yt(o,A,-d):jt(""+d)+"."+ss("0",S[1].length);if(S=A.match(/^#,#*,#0/))return Yt(o,A.replace(/^#,#*,/,""),d);if(S=A.match(/^([0#]+)(\\?-([0#]+))+$/))return N=he(Yt(o,A.replace(/[\\-]/g,""),d)),E=0,he(he(A.replace(/\\/g,"")).replace(/[0#]/g,function(re){return E<N.length?N.charAt(E++):re==="0"?"0":""}));if(A.match(St))return"("+(N=Yt(o,"##########",d)).substr(0,3)+") "+N.substr(3,3)+"-"+N.substr(6);var K="";if(S=A.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return E=Math.min(S[4].length,7),W=q(I,Math.pow(10,E)-1,!1),N=P,(K=vr("n",S[1],W[1])).charAt(K.length-1)==" "&&(K=K.substr(0,K.length-1)+"0"),N+=K+S[2]+"/"+S[3],(K=we(W[2],E)).length<S[4].length&&(K=Jt(S[4].substr(S[4].length-K.length))+K),N+=K;if(S=A.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return E=Math.min(Math.max(S[1].length,S[4].length),7),P+((W=q(I,Math.pow(10,E)-1,!0))[0]||(W[1]?"":"0"))+" "+(W[1]?xe(W[1],E)+S[2]+"/"+S[3]+we(W[2],E):ss(" ",2*E+1+S[2].length+S[3].length));if(S=A.match(/^[#0?]+$/))return N=""+d,A.length<=N.length?N:Jt(A.substr(0,A.length-N.length))+N;if(S=A.match(/^([#0]+)\.([#0]+)$/)){N=""+d.toFixed(Math.min(S[2].length,10)).replace(/([^0])0+$/,"$1"),E=N.indexOf(".");var K=A.indexOf(".")-E,W=A.length-N.length-K;return Jt(A.substr(0,K)+N+A.substr(A.length-W))}if(S=A.match(/^00,000\.([#0]*0)$/))return d<0?"-"+Yt(o,A,-d):jt(""+d).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(re){return"00,"+(re.length<3?Ne(0,3-re.length):"")+re})+"."+Ne(0,S[1].length);switch(A){case"###,###":case"##,###":case"#,###":var me=jt(""+I);return me!=="0"?P+me:"";default:if(A.match(/\.[0#?]*$/))return Yt(o,A.slice(0,A.lastIndexOf(".")),d)+Jt(A.slice(A.lastIndexOf(".")))}throw new Error("unsupported format |"+A+"|")}function vr(o,A,d){return((0|d)===d?Yt:bt)(o,A,d)}var gr=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Mr(o){for(var A=0,d="",h="";A<o.length;)switch(d=o.charAt(A)){case"G":V(o,A)&&(A+=6),A++;break;case'"':for(;o.charCodeAt(++A)!==34&&A<o.length;);++A;break;case"\\":case"_":A+=2;break;case"@":++A;break;case"B":case"b":if(o.charAt(A+1)==="1"||o.charAt(A+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(o.substr(A,3).toUpperCase()==="A/P"||o.substr(A,5).toUpperCase()==="AM/PM"||o.substr(A,5).toUpperCase()==="/")return!0;++A;break;case"[":for(h=d;o.charAt(A++)!=="]"&&A<o.length;)h+=o.charAt(A);if(h.match(gr))return!0;break;case".":case"0":case"#":for(;A<o.length&&(-1<"0#?.,E+-%".indexOf(d=o.charAt(++A))||d=="\\"&&o.charAt(A+1)=="-"&&-1<"0#".indexOf(o.charAt(A+2))););break;case"?":for(;o.charAt(++A)===d;);break;case"*":++A,o.charAt(A)!=" "&&o.charAt(A)!="*"||++A;break;case"(":case")":++A;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;A<o.length&&-1<"0123456789".indexOf(o.charAt(++A)););break;case" ":default:++A}return!1}function Ot(o,A,d,h){for(var x,w,v,N=[],S="",E=0,I="",P="t",K="H";E<o.length;)switch(I=o.charAt(E)){case"G":if(!V(o,E))throw new Error("unrecognized character "+I+" in "+o);N[N.length]={t:"G",v:"General"},E+=7;break;case'"':for(S="";(v=o.charCodeAt(++E))!==34&&E<o.length;)S+=String.fromCharCode(v);N[N.length]={t:"t",v:S},++E;break;case"\\":var W=o.charAt(++E),me=W==="("||W===")"?W:"t";N[N.length]={t:me,v:W},++E;break;case"_":N[N.length]={t:"t",v:" "},E+=2;break;case"@":N[N.length]={t:"T",v:A},++E;break;case"B":case"b":if(o.charAt(E+1)==="1"||o.charAt(E+1)==="2"){if(x==null&&(x=ve(A,d,o.charAt(E+1)==="2"))==null)return"";N[N.length]={t:"X",v:o.substr(E,2)},P=I,E+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":I=I.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(A<0||x==null&&(x=ve(A,d))==null)return"";for(S=I;++E<o.length&&o.charAt(E).toLowerCase()===I;)S+=I;(I=I==="m"&&P.toLowerCase()==="h"?"M":I)==="h"&&(I=K),N[N.length]={t:I,v:S},P=I;break;case"A":case"a":case"":if(W={t:I,v:I},x==null&&(x=ve(A,d)),o.substr(E,3).toUpperCase()==="A/P"?(x!=null&&(W.v=12<=x.H?"P":"A"),W.t="T",K="h",E+=3):o.substr(E,5).toUpperCase()==="AM/PM"?(x!=null&&(W.v=12<=x.H?"PM":"AM"),W.t="T",E+=5,K="h"):o.substr(E,5).toUpperCase()==="/"?(x!=null&&(W.v=12<=x.H?"":""),W.t="T",E+=5,K="h"):(W.t="t",++E),x==null&&W.t==="T")return"";N[N.length]=W,P=I;break;case"[":for(S=I;o.charAt(E++)!=="]"&&E<o.length;)S+=o.charAt(E);if(S.slice(-1)!=="]")throw'unterminated "[" block: |'+S+"|";if(S.match(gr)){if(x==null&&(x=ve(A,d))==null)return"";N[N.length]={t:"Z",v:S.toLowerCase()},P=S.charAt(1)}else-1<S.indexOf("$")&&(S=(S.match(/\$([^-\[\]]*)/)||[])[1]||"$",Mr(o)||(N[N.length]={t:"t",v:S}));break;case".":if(x!=null){for(S=I;++E<o.length&&(I=o.charAt(E))==="0";)S+=I;N[N.length]={t:"s",v:S};break}case"0":case"#":for(S=I;++E<o.length&&-1<"0#?.,E+-%".indexOf(I=o.charAt(E));)S+=I;N[N.length]={t:"n",v:S};break;case"?":for(S=I;o.charAt(++E)===I;)S+=I;N[N.length]={t:I,v:S},P=I;break;case"*":++E,o.charAt(E)!=" "&&o.charAt(E)!="*"||++E;break;case"(":case")":N[N.length]={t:h===1?"t":I,v:I},++E;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(S=I;E<o.length&&-1<"0123456789".indexOf(o.charAt(++E));)S+=o.charAt(E);N[N.length]={t:"D",v:S};break;case" ":N[N.length]={t:I,v:I},++E;break;case"$":N[N.length]={t:"t",v:"$"},++E;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(I)===-1)throw new Error("unrecognized character "+I+" in "+o);N[N.length]={t:"t",v:I},++E}var re,De=0,be=0;for(E=N.length-1,P="t";0<=E;--E)switch(N[E].t){case"h":case"H":N[E].t=K,P="h",De<1&&(De=1);break;case"s":(re=N[E].v.match(/\.0+$/))&&(be=Math.max(be,re[0].length-1)),De<3&&(De=3);case"d":case"y":case"M":case"e":P=N[E].t;break;case"m":P==="s"&&(N[E].t="M",De<2&&(De=2));break;case"X":break;case"Z":(De=(De=De<1&&N[E].v.match(/[Hh]/)?1:De)<2&&N[E].v.match(/[Mm]/)?2:De)<3&&N[E].v.match(/[Ss]/)&&(De=3)}switch(De){case 0:break;case 1:.5<=x.u&&(x.u=0,++x.S),60<=x.S&&(x.S=0,++x.M),60<=x.M&&(x.M=0,++x.H);break;case 2:.5<=x.u&&(x.u=0,++x.S),60<=x.S&&(x.S=0,++x.M)}var ce,Ee="";for(E=0;E<N.length;++E)switch(N[E].t){case"t":case"T":case" ":case"D":break;case"X":N[E].v="",N[E].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":N[E].v=(function(Mt,Qt,vt,Zt){var Br,wr="",cr=0,ur=0,nr=vt.y,Vt=0;switch(Mt){case 98:nr=vt.y+543;case 121:switch(Qt.length){case 1:case 2:Br=nr%100,Vt=2;break;default:Br=nr%1e4,Vt=4}break;case 109:switch(Qt.length){case 1:case 2:Br=vt.m,Vt=Qt.length;break;case 3:return de[vt.m-1][1];case 5:return de[vt.m-1][0];default:return de[vt.m-1][2]}break;case 100:switch(Qt.length){case 1:case 2:Br=vt.d,Vt=Qt.length;break;case 3:return le[vt.q][0];default:return le[vt.q][1]}break;case 104:switch(Qt.length){case 1:case 2:Br=1+(vt.H+11)%12,Vt=Qt.length;break;default:throw"bad hour format: "+Qt}break;case 72:switch(Qt.length){case 1:case 2:Br=vt.H,Vt=Qt.length;break;default:throw"bad hour format: "+Qt}break;case 77:switch(Qt.length){case 1:case 2:Br=vt.M,Vt=Qt.length;break;default:throw"bad minute format: "+Qt}break;case 115:if(Qt!="s"&&Qt!="ss"&&Qt!=".0"&&Qt!=".00"&&Qt!=".000")throw"bad second format: "+Qt;return vt.u!==0||Qt!="s"&&Qt!="ss"?(60*(ur=2<=Zt?Zt===3?1e3:100:Zt===1?10:1)<=(cr=Math.round(ur*(vt.S+vt.u)))&&(cr=0),Qt==="s"?cr===0?"0":""+cr/ur:(wr=Ne(cr,2+Zt),Qt==="ss"?wr.substr(0,2):"."+wr.substr(2,Qt.length-1))):Ne(vt.S,Qt.length);case 90:switch(Qt){case"[h]":case"[hh]":Br=24*vt.D+vt.H;break;case"[m]":case"[mm]":Br=60*(24*vt.D+vt.H)+vt.M;break;case"[s]":case"[ss]":Br=60*(60*(24*vt.D+vt.H)+vt.M)+Math.round(vt.S+vt.u);break;default:throw"bad abstime format: "+Qt}Vt=Qt.length===3?1:2;break;case 101:Br=nr,Vt=1}return 0<Vt?Ne(Br,Vt):""})(N[E].t.charCodeAt(0),N[E].v,x,be),N[E].t="t";break;case"n":case"?":for(ce=E+1;N[ce]!=null&&((I=N[ce].t)==="?"||I==="D"||(I===" "||I==="t")&&N[ce+1]!=null&&(N[ce+1].t==="?"||N[ce+1].t==="t"&&N[ce+1].v==="/")||N[E].t==="("&&(I===" "||I==="n"||I===")")||I==="t"&&(N[ce].v==="/"||N[ce].v===" "&&N[ce+1]!=null&&N[ce+1].t=="?"));)N[E].v+=N[ce].v,N[ce]={v:"",t:";"},++ce;Ee+=N[E].v,E=ce-1;break;case"G":N[E].t="t",N[E].v=ft(A,d)}var Ue,Ie,$e="";if(0<Ee.length){Ee.charCodeAt(0)==40?(Ue=A<0&&Ee.charCodeAt(0)===45?-A:A,Ie=vr("n",Ee,Ue)):(Ie=vr("n",Ee,Ue=A<0&&1<h?-A:A),Ue<0&&N[0]&&N[0].t=="t"&&(Ie=Ie.substr(1),N[0].v="-"+N[0].v)),ce=Ie.length-1;for(var st=N.length,E=0;E<N.length;++E)if(N[E]!=null&&N[E].t!="t"&&-1<N[E].v.indexOf(".")){st=E;break}var rt=N.length;if(st===N.length&&Ie.indexOf("E")===-1){for(E=N.length-1;0<=E;--E)N[E]!=null&&"n?".indexOf(N[E].t)!==-1&&(ce>=N[E].v.length-1?(ce-=N[E].v.length,N[E].v=Ie.substr(ce+1,N[E].v.length)):ce<0?N[E].v="":(N[E].v=Ie.substr(0,ce+1),ce=-1),N[E].t="t",rt=E);0<=ce&&rt<N.length&&(N[rt].v=Ie.substr(0,ce+1)+N[rt].v)}else if(st!==N.length&&Ie.indexOf("E")===-1){for(ce=Ie.indexOf(".")-1,E=st;0<=E;--E)if(N[E]!=null&&"n?".indexOf(N[E].t)!==-1){for(w=-1<N[E].v.indexOf(".")&&E===st?N[E].v.indexOf(".")-1:N[E].v.length-1,$e=N[E].v.substr(w+1);0<=w;--w)0<=ce&&(N[E].v.charAt(w)==="0"||N[E].v.charAt(w)==="#")&&($e=Ie.charAt(ce--)+$e);N[E].v=$e,N[E].t="t",rt=E}for(0<=ce&&rt<N.length&&(N[rt].v=Ie.substr(0,ce+1)+N[rt].v),ce=Ie.indexOf(".")+1,E=st;E<N.length;++E)if(N[E]!=null&&("n?(".indexOf(N[E].t)!==-1||E===st)){for(w=-1<N[E].v.indexOf(".")&&E===st?N[E].v.indexOf(".")+1:0,$e=N[E].v.substr(0,w);w<N[E].v.length;++w)ce<Ie.length&&($e+=Ie.charAt(ce++));N[E].v=$e,N[E].t="t",rt=E}}}for(E=0;E<N.length;++E)N[E]!=null&&-1<"n?".indexOf(N[E].t)&&(Ue=1<h&&A<0&&0<E&&N[E-1].v==="-"?-A:A,N[E].v=vr(N[E].t,N[E].v,Ue),N[E].t="t");var mt="";for(E=0;E!==N.length;++E)N[E]!=null&&(mt+=N[E].v);return mt}var ja=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function oa(o,A){if(A!=null){var d=parseFloat(A[2]);switch(A[1]){case"=":if(o==d)return 1;break;case">":if(d<o)return 1;break;case"<":if(o<d)return 1;break;case"<>":if(o!=d)return 1;break;case">=":if(d<=o)return 1;break;case"<=":if(o<=d)return 1}}}function hr(o,A){var d=(function(v){for(var N=[],S=!1,E=0,I=0;E<v.length;++E)switch(v.charCodeAt(E)){case 34:S=!S;break;case 95:case 42:case 92:++E;break;case 59:N[N.length]=v.substr(I,E-I),I=E+1}if(N[N.length]=v.substr(I),S===!0)throw new Error("Format |"+v+"| unterminated string ");return N})(o),h=d.length,x=d[h-1].indexOf("@");if(h<4&&-1<x&&--h,4<d.length)throw new Error("cannot find right format for |"+d.join("|")+"|");if(typeof A!="number")return[4,d.length===4||-1<x?d[d.length-1]:"@"];switch(d.length){case 1:d=-1<x?["General","General","General",d[0]]:[d[0],d[0],d[0],"@"];break;case 2:d=-1<x?[d[0],d[0],d[0],d[1]]:[d[0],d[1],d[0],"@"];break;case 3:d=-1<x?[d[0],d[1],d[0],d[2]]:[d[0],d[1],d[2],"@"]}var w=0<A?d[0]:A<0?d[1]:d[2];return d[0].indexOf("[")===-1&&d[1].indexOf("[")===-1?[h,w]:d[0].match(/\[[=<>]/)==null&&d[1].match(/\[[=<>]/)==null?[h,w]:(o=d[0].match(ja),w=d[1].match(ja),oa(A,o)?[h,d[0]]:oa(A,w)?[h,d[1]]:[h,d[o!=null&&w!=null?2:1]])}function pr(o,A,d){d==null&&(d={});var h="";switch(typeof o){case"string":h=o=="m/d/yy"&&d.dateNF?d.dateNF:o;break;case"number":(h=(h=o==14&&d.dateNF?d.dateNF:(d.table!=null?d.table:X)[o])==null?d.table&&d.table[ie[o]]||X[ie[o]]:h)==null&&(h=G[o]||"General")}if(V(h,0))return ft(A,d);var x=hr(h,A=A instanceof Date?je(A,d.date1904):A);if(V(x[1]))return ft(A,d);if(A===!0)A="TRUE";else if(A===!1)A="FALSE";else if(A===""||A==null)return"";return Ot(x[1],A,d,x[0])}function Gr(o,A){if(typeof A!="number"){A=+A||-1;for(var d=0;d<392;++d)if(X[d]!=null){if(X[d]==o){A=d;break}}else A<0&&(A=d);A<0&&(A=391)}return X[A]=o,A}function Pr(o){for(var A=0;A!=392;++A)o[A]!==void 0&&Gr(o[A],A)}function wa(){var o;(o=o||{})[0]="General",o[1]="0",o[2]="0.00",o[3]="#,##0",o[4]="#,##0.00",o[9]="0%",o[10]="0.00%",o[11]="0.00E+00",o[12]="# ?/?",o[13]="# ??/??",o[14]="m/d/yy",o[15]="d-mmm-yy",o[16]="d-mmm",o[17]="mmm-yy",o[18]="h:mm AM/PM",o[19]="h:mm:ss AM/PM",o[20]="h:mm",o[21]="h:mm:ss",o[22]="m/d/yy h:mm",o[37]="#,##0 ;(#,##0)",o[38]="#,##0 ;[Red](#,##0)",o[39]="#,##0.00;(#,##0.00)",o[40]="#,##0.00;[Red](#,##0.00)",o[45]="mm:ss",o[46]="[h]:mm:ss",o[47]="mmss.0",o[48]="##0.0E+0",o[49]="@",o[56]='"/ "hh""mm""ss" "',X=o}var jr={format:pr,load:Gr,_table:X,load_table:Pr,parse_date_code:ve,is_date:Mr,get_table:function(){return jr._table=X}},Ms={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Rs=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g,or,Nr=(function(){var o={};o.version="1.2.0";var A=(function(){for(var ce=0,Ee=new Array(256),Ue=0;Ue!=256;++Ue)ce=1&(ce=1&(ce=1&(ce=1&(ce=1&(ce=1&(ce=1&(ce=1&(ce=Ue)?-306674912^ce>>>1:ce>>>1)?-306674912^ce>>>1:ce>>>1)?-306674912^ce>>>1:ce>>>1)?-306674912^ce>>>1:ce>>>1)?-306674912^ce>>>1:ce>>>1)?-306674912^ce>>>1:ce>>>1)?-306674912^ce>>>1:ce>>>1)?-306674912^ce>>>1:ce>>>1,Ee[Ue]=ce;return typeof Int32Array<"u"?new Int32Array(Ee):Ee})(),d=(function(ce){for(var Ee=0,Ue=0,$e=0,Ie=new(typeof Int32Array<"u"?Int32Array:Array)(4096),$e=0;$e!=256;++$e)Ie[$e]=ce[$e];for($e=0;$e!=256;++$e)for(Ue=ce[$e],Ee=256+$e;Ee<4096;Ee+=256)Ue=Ie[Ee]=Ue>>>8^ce[255&Ue];var st=[];for($e=1;$e!=16;++$e)st[$e-1]=typeof Int32Array<"u"?Ie.subarray(256*$e,256*$e+256):Ie.slice(256*$e,256*$e+256);return st})(A),h=d[0],x=d[1],w=d[2],v=d[3],N=d[4],S=d[5],E=d[6],I=d[7],P=d[8],K=d[9],W=d[10],me=d[11],re=d[12],De=d[13],be=d[14];return o.table=A,o.bstr=function(ce,Ee){for(var Ue=-1^Ee,Ie=0,$e=ce.length;Ie<$e;)Ue=Ue>>>8^A[255&(Ue^ce.charCodeAt(Ie++))];return~Ue},o.buf=function(ce,Ee){for(var Ue=-1^Ee,Ie=ce.length-15,$e=0;$e<Ie;)Ue=be[ce[$e++]^255&Ue]^De[ce[$e++]^Ue>>8&255]^re[ce[$e++]^Ue>>16&255]^me[ce[$e++]^Ue>>>24]^W[ce[$e++]]^K[ce[$e++]]^P[ce[$e++]]^I[ce[$e++]]^E[ce[$e++]]^S[ce[$e++]]^N[ce[$e++]]^v[ce[$e++]]^w[ce[$e++]]^x[ce[$e++]]^h[ce[$e++]]^A[ce[$e++]];for(Ie+=15;$e<Ie;)Ue=Ue>>>8^A[255&(Ue^ce[$e++])];return~Ue},o.str=function(ce,Ee){for(var Ue,Ie=-1^Ee,$e=0,st=ce.length,rt=0;$e<st;)Ie=(rt=ce.charCodeAt($e++))<128?Ie>>>8^A[255&(Ie^rt)]:rt<2048?(Ie=Ie>>>8^A[255&(Ie^(192|rt>>6&31))])>>>8^A[255&(Ie^(128|63&rt))]:55296<=rt&&rt<57344?(rt=64+(1023&rt),Ue=1023&ce.charCodeAt($e++),(Ie=(Ie=(Ie=Ie>>>8^A[255&(Ie^(240|rt>>8&7))])>>>8^A[255&(Ie^(128|rt>>2&63))])>>>8^A[255&(Ie^(128|Ue>>6&15|(3&rt)<<4))])>>>8^A[255&(Ie^(128|63&Ue))]):(Ie=(Ie=Ie>>>8^A[255&(Ie^(224|rt>>12&15))])>>>8^A[255&(Ie^(128|rt>>6&63))])>>>8^A[255&(Ie^(128|63&rt))];return~Ie},o})(),$t=(function(){var o,A={};function d(Pe){if(Pe.charAt(Pe.length-1)=="/")return Pe.slice(0,-1).indexOf("/")===-1?Pe:d(Pe.slice(0,-1));var wt=Pe.lastIndexOf("/");return wt===-1?Pe:Pe.slice(0,wt+1)}function h(Pe){if(Pe.charAt(Pe.length-1)=="/")return h(Pe.slice(0,-1));var wt=Pe.lastIndexOf("/");return wt===-1?Pe:Pe.slice(wt+1)}function x(Pe){_s(Pe,0);for(var wt,qe={};Pe.l<=Pe.length-4;){var yt=Pe.read_shift(2),We=Pe.read_shift(2),Wt=Pe.l+We,pt={};yt===21589&&(1&(wt=Pe.read_shift(1))&&(pt.mtime=Pe.read_shift(4)),5<We&&(2&wt&&(pt.atime=Pe.read_shift(4)),4&wt&&(pt.ctime=Pe.read_shift(4))),pt.mtime&&(pt.mt=new Date(1e3*pt.mtime))),Pe.l=Wt,qe[yt]=pt}return qe}function w(){return o=o||Uy}function v(Pe,wt){if(Pe[0]==80&&Pe[1]==75)return bs(Pe,wt);if((32|Pe[0])==109&&(32|Pe[1])==105)return(function(sr,Zr){if(ce(sr.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Fr=Zr&&Zr.root||"",ir=(Z&&Buffer.isBuffer(sr)?sr.toString("binary"):ce(sr)).split(`\r
`),ca=0,ea="";for(ca=0;ca<ir.length;++ca)if(ea=ir[ca],/^Content-Location:/i.test(ea)&&(ea=ea.slice(ea.indexOf("file")),Fr=Fr||ea.slice(0,ea.lastIndexOf("/")+1),ea.slice(0,Fr.length)!=Fr))for(;0<Fr.length&&(Fr=(Fr=Fr.slice(0,Fr.length-1)).slice(0,Fr.lastIndexOf("/")+1),ea.slice(0,Fr.length)!=Fr););if(sr=(ir[1]||"").match(/boundary="(.*?)"/),!sr)throw new Error("MAD cannot find boundary");var dn="--"+(sr[1]||""),pa={FileIndex:[],FullPaths:[]};S(pa);var _a,Yr=0;for(ca=0;ca<ir.length;++ca){var as=ir[ca];as!==dn&&as!==dn+"--"||(Yr++&&(function(Wa,l,c){for(var p,y="",k="",U="",Ae=0;Ae<10;++Ae){var _e=l[Ae];if(!_e||_e.match(/^\s*$/))break;var Ve=_e.match(/^(.*?):\s*([^\s].*)$/);if(Ve)switch(Ve[1].toLowerCase()){case"content-location":y=Ve[2].trim();break;case"content-type":U=Ve[2].trim();break;case"content-transfer-encoding":k=Ve[2].trim()}}switch(++Ae,k.toLowerCase()){case"base64":p=ae(Q(l.slice(Ae).join("")));break;case"quoted-printable":p=(function(lt){for(var kt=[],_t=0;_t<lt.length;++_t){for(var gt=lt[_t];_t<=lt.length&&gt.charAt(gt.length-1)=="=";)gt=gt.slice(0,gt.length-1)+lt[++_t];kt.push(gt)}for(var Nt=0;Nt<kt.length;++Nt)kt[Nt]=kt[Nt].replace(/[=][0-9A-Fa-f]{2}/g,function(Wr){return String.fromCharCode(parseInt(Wr.slice(1),16))});return ae(kt.join(`\r
`))})(l.slice(Ae));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+k)}c=kc(Wa,y.slice(c.length),p,{unsafe:!0}),U&&(c.ctype=U)})(pa,ir.slice(_a,ca),Fr),_a=ca)}return pa})(Pe,wt);if(Pe.length<512)throw new Error("CFB file size "+Pe.length+" < 512");var qe,yt,We,Wt=3,pt=512,fr=0,Bt=[],dt=Pe.slice(0,512);_s(dt,0);var Tt=(function(sr){if(sr[sr.l]==80&&sr[sr.l+1]==75)return[0,0];sr.chk(me,"Header Signature: "),sr.l+=16;var Zr=sr.read_shift(2,"u");return[sr.read_shift(2,"u"),Zr]})(dt);switch(Wt=Tt[0]){case 3:pt=512;break;case 4:pt=4096;break;case 0:if(Tt[1]==0)return bs(Pe,wt);default:throw new Error("Major Version: Expected 3 or 4 saw "+Wt)}pt!==512&&_s(dt=Pe.slice(0,pt),28);var tr=Pe.slice(0,pt);(function(sr,Zr){var Fr=9;switch(sr.l+=2,Fr=sr.read_shift(2)){case 9:if(Zr!=3)throw new Error("Sector Shift: Expected 9 saw "+Fr);break;case 12:if(Zr!=4)throw new Error("Sector Shift: Expected 12 saw "+Fr);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Fr)}sr.chk("0600","Mini Sector Shift: "),sr.chk("000000000000","Reserved: ")})(dt,Wt);var Jr=dt.read_shift(4,"i");if(Wt===3&&Jr!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Jr);dt.l+=4,yt=dt.read_shift(4,"i"),dt.l+=4,dt.chk("00100000","Mini Stream Cutoff Size: "),We=dt.read_shift(4,"i"),qe=dt.read_shift(4,"i"),qr=dt.read_shift(4,"i"),fr=dt.read_shift(4,"i");for(var _r,Dr=0;Dr<109&&!((_r=dt.read_shift(4,"i"))<0);++Dr)Bt[Dr]=_r;var yr=(function(sr,Zr){for(var Fr=Math.ceil(sr.length/Zr)-1,ir=[],ca=1;ca<Fr;++ca)ir[ca-1]=sr.slice(ca*Zr,(ca+1)*Zr);return ir[Fr-1]=sr.slice(Fr*Zr),ir})(Pe,pt);(function sr(Zr,Fr,ir,ca,ea){var dn=W;if(Zr===W){if(Fr!==0)throw new Error("DIFAT chain shorter than expected")}else if(Zr!==-1){var pa=ir[Zr],_a=(ca>>>2)-1;if(pa){for(var Yr=0;Yr<_a&&(dn=$a(pa,4*Yr))!==W;++Yr)ea.push(dn);sr($a(pa,ca-4),Fr-1,ir,ca,ea)}}})(qr,fr,yr,pt,Bt);var Lr=(function(sr,Zr,Fr,ir){var ca=sr.length,ea=[],dn=[],pa=[],_a=[],Yr=ir-1,as=0,Wa=0,l=0,c=0;for(as=0;as<ca;++as)if(pa=[],ca<=(l=as+Zr)&&(l-=ca),!dn[l]){_a=[];var p=[];for(Wa=l;0<=Wa;){p[Wa]=!0,dn[Wa]=!0,pa[pa.length]=Wa,_a.push(sr[Wa]);var y=Fr[Math.floor(4*Wa/ir)];if(ir<4+(c=4*Wa&Yr))throw new Error("FAT boundary crossed: "+Wa+" 4 "+ir);if(!sr[y]||(Wa=$a(sr[y],c),p[Wa]))break}ea[l]={nodes:pa,data:gu([_a])}}return ea})(yr,yt,Bt,pt);Lr[yt].name="!Directory",0<qe&&We!==W&&(Lr[We].name="!MiniFAT"),Lr[Bt[0]].name="!FAT",Lr.fat_addrs=Bt,Lr.ssz=pt;var Jr=[],qr=[],fr=[];return(function(sr,Zr,Fr,ir,ca,ea,dn){for(var pa,_a=0,Yr=Fr.length?2:0,as=sr[yt].data,Wa=0,l=0;Wa<as.length;Wa+=128){var c=as.slice(Wa,Wa+128);_s(c,64),l=c.read_shift(2),pa=KA(c,0,l-Yr),Fr.push(pa);var p={name:pa,type:c.read_shift(1),color:c.read_shift(1),L:c.read_shift(4,"i"),R:c.read_shift(4,"i"),C:c.read_shift(4,"i"),clsid:c.read_shift(16),state:c.read_shift(4,"i"),start:0,size:0};c.read_shift(2)+c.read_shift(2)+c.read_shift(2)+c.read_shift(2)!==0&&(p.ct=N(c,c.l-8)),c.read_shift(2)+c.read_shift(2)+c.read_shift(2)+c.read_shift(2)!==0&&(p.mt=N(c,c.l-8)),p.start=c.read_shift(4,"i"),p.size=c.read_shift(4,"i"),p.size<0&&p.start<0&&(p.size=p.type=0,p.start=W,p.name=""),p.type===5?(_a=p.start,0<ir&&_a!==W&&(sr[_a].name="!StreamData")):4096<=p.size?(p.storage="fat",sr[p.start]===void 0&&(sr[p.start]=(function(y,k,U,Ae,_e){var Ve=[],lt=[];_e=_e||[];var kt=Ae-1,_t=0,gt=0;for(_t=k;0<=_t;){_e[_t]=!0,Ve[Ve.length]=_t,lt.push(y[_t]);var Nt=U[Math.floor(4*_t/Ae)];if(Ae<4+(gt=4*_t&kt))throw new Error("FAT boundary crossed: "+_t+" 4 "+Ae);if(!y[Nt])break;_t=$a(y[Nt],gt)}return{nodes:Ve,data:gu([lt])}})(Zr,p.start,sr.fat_addrs,sr.ssz)),sr[p.start].name=p.name,p.content=sr[p.start].data.slice(0,p.size)):(p.storage="minifat",p.size<0?p.size=0:_a!==W&&p.start!==W&&sr[_a]&&(p.content=(function(y,k,U){for(var Ae=y.start,_e=y.size,Ve=[],lt=Ae;U&&0<_e&&0<=lt;)Ve.push(k.slice(lt*K,lt*K+K)),_e-=K,lt=$a(U,4*lt);return Ve.length===0?Ft(0):ge(Ve).slice(0,y.size)})(p,sr[_a].data,(sr[dn]||{}).data))),p.content&&_s(p.content,0),ca[pa]=p,ea.push(p)}})(Lr,yr,Jr,qe,{},qr,We),(function(sr,Zr,Fr){for(var ir=0,ca=0,ea=0,dn=0,pa=0,_a=Fr.length,Yr=[],as=[];ir<_a;++ir)Yr[ir]=as[ir]=ir,Zr[ir]=Fr[ir];for(;pa<as.length;++pa)ir=as[pa],ca=sr[ir].L,ea=sr[ir].R,dn=sr[ir].C,Yr[ir]===ir&&(ca!==-1&&Yr[ca]!==ca&&(Yr[ir]=Yr[ca]),ea!==-1&&Yr[ea]!==ea&&(Yr[ir]=Yr[ea])),dn!==-1&&(Yr[dn]=ir),ca!==-1&&ir!=Yr[ir]&&(Yr[ca]=Yr[ir],as.lastIndexOf(ca)<pa&&as.push(ca)),ea!==-1&&ir!=Yr[ir]&&(Yr[ea]=Yr[ir],as.lastIndexOf(ea)<pa&&as.push(ea));for(ir=1;ir<_a;++ir)Yr[ir]===ir&&(ea!==-1&&Yr[ea]!==ea?Yr[ir]=Yr[ea]:ca!==-1&&Yr[ca]!==ca&&(Yr[ir]=Yr[ca]));for(ir=1;ir<_a;++ir)if(sr[ir].type!==0){if((pa=ir)!=Yr[pa])for(;pa=Yr[pa],Zr[ir]=Zr[pa]+"/"+Zr[ir],pa!==0&&Yr[pa]!==-1&&pa!=Yr[pa];);Yr[ir]=-1}for(Zr[0]+="/",ir=1;ir<_a;++ir)sr[ir].type!==2&&(Zr[ir]+="/")})(qr,fr,Jr),Jr.shift(),fr={FileIndex:qr,FullPaths:fr},wt&&wt.raw&&(fr.raw={header:tr,sectors:yr}),fr}function N(Pe,wt){return new Date(1e3*(Xr(Pe,wt+4)/1e7*Math.pow(2,32)+Xr(Pe,wt)/1e7-11644473600))}function S(Pe,yt){var qe=yt||{},yt=qe.root||"Root Entry";if(Pe.FullPaths||(Pe.FullPaths=[]),Pe.FileIndex||(Pe.FileIndex=[]),Pe.FullPaths.length!==Pe.FileIndex.length)throw new Error("inconsistent CFB structure");Pe.FullPaths.length===0&&(Pe.FullPaths[0]=yt+"/",Pe.FileIndex[0]={name:yt,type:5}),qe.CLSID&&(Pe.FileIndex[0].clsid=qe.CLSID),yt=Pe,qe="Sh33tJ5",$t.find(yt,"/"+qe)||((Pe=Ft(4))[0]=55,Pe[1]=Pe[3]=50,Pe[2]=54,yt.FileIndex.push({name:qe,type:2,content:Pe,size:4,L:69,R:69,C:69}),yt.FullPaths.push(yt.FullPaths[0]+qe),E(yt))}function E(Pe,wt){S(Pe);for(var qe=!1,yt=!1,We=Pe.FullPaths.length-1;0<=We;--We){var Wt=Pe.FileIndex[We];switch(Wt.type){case 0:yt?qe=!0:(Pe.FileIndex.pop(),Pe.FullPaths.pop());break;case 1:case 2:case 5:yt=!0,isNaN(Wt.R*Wt.L*Wt.C)&&(qe=!0),-1<Wt.R&&-1<Wt.L&&Wt.R==Wt.L&&(qe=!0);break;default:qe=!0}}if(qe||wt){for(var pt=new Date(1987,1,19),Bt=0,dt=Object.create?Object.create(null):{},Tt=[],We=0;We<Pe.FullPaths.length;++We)dt[Pe.FullPaths[We]]=!0,Pe.FileIndex[We].type!==0&&Tt.push([Pe.FullPaths[We],Pe.FileIndex[We]]);for(We=0;We<Tt.length;++We){var tr=d(Tt[We][0]);(yt=dt[tr])||(Tt.push([tr,{name:h(tr).replace("/",""),type:1,clsid:De,ct:pt,mt:pt,content:null}]),dt[tr]=!0)}for(Tt.sort(function(yr,Lr){return(function(Jr,qr){for(var fr,sr=Jr.split("/"),Zr=qr.split("/"),Fr=0,ir=Math.min(sr.length,Zr.length);Fr<ir;++Fr){if(fr=sr[Fr].length-Zr[Fr].length)return fr;if(sr[Fr]!=Zr[Fr])return sr[Fr]<Zr[Fr]?-1:1}return sr.length-Zr.length})(yr[0],Lr[0])}),Pe.FullPaths=[],Pe.FileIndex=[],We=0;We<Tt.length;++We)Pe.FullPaths[We]=Tt[We][0],Pe.FileIndex[We]=Tt[We][1];for(We=0;We<Tt.length;++We){var _r=Pe.FileIndex[We],Dr=Pe.FullPaths[We];if(_r.name=h(Dr).replace("/",""),_r.L=_r.R=_r.C=-(_r.color=1),_r.size=_r.content?_r.content.length:0,_r.start=0,_r.clsid=_r.clsid||De,We===0)_r.C=1<Tt.length?1:-1,_r.size=0,_r.type=5;else if(Dr.slice(-1)=="/"){for(Bt=We+1;Bt<Tt.length&&d(Pe.FullPaths[Bt])!=Dr;++Bt);for(_r.C=Bt>=Tt.length?-1:Bt,Bt=We+1;Bt<Tt.length&&d(Pe.FullPaths[Bt])!=d(Dr);++Bt);_r.R=Bt>=Tt.length?-1:Bt,_r.type=1}else d(Pe.FullPaths[We+1]||"")==d(Dr)&&(_r.R=We+1),_r.type=2}}}function I(Pe,wt){var qe=wt||{};if(qe.fileType=="mad")return(function(Dr,yr){for(var Lr=yr||{},Jr=Lr.boundary||"SheetJS",qr=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(Jr="------="+Jr).slice(2)+'"',"","",""],fr=Dr.FullPaths[0],sr=fr,Zr=Dr.FileIndex[0],Fr=1;Fr<Dr.FullPaths.length;++Fr)if(sr=Dr.FullPaths[Fr].slice(fr.length),(Zr=Dr.FileIndex[Fr]).size&&Zr.content&&sr!="Sh33tJ5"){sr=sr.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Yr){return"_x"+Yr.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Yr){return"_u"+Yr.charCodeAt(0).toString(16)+"_"});for(var ir=Zr.content,ca=Z&&Buffer.isBuffer(ir)?ir.toString("binary"):ce(ir),ea=0,dn=Math.min(1024,ca.length),pa=0,_a=0;_a<=dn;++_a)32<=(pa=ca.charCodeAt(_a))&&pa<128&&++ea;ir=4*dn/5<=ea,qr.push(Jr),qr.push("Content-Location: "+(Lr.root||"file:///C:/SheetJS/")+sr),qr.push("Content-Transfer-Encoding: "+(ir?"quoted-printable":"base64")),qr.push("Content-Type: "+(function(l,as){if(l.ctype)return l.ctype;var Wa=l.name||"",l=Wa.match(/\.([^\.]+)$/);return l&&eo[l[1]]||as&&(l=(Wa=as).match(/[\.\\]([^\.\\])+$/))&&eo[l[1]]?eo[l[1]]:"application/octet-stream"})(Zr,sr)),qr.push(""),qr.push((ir?function(Yr){Yr=Yr.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(U){return U=U.charCodeAt(0).toString(16).toUpperCase(),"="+(U.length==1?"0"+U:U)}),(Yr=Yr.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)==`
`&&(Yr="=0D"+Yr.slice(1)),Yr=Yr.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,`
=0A`).replace(/([^\r\n])\n/gm,"$1=0A");for(var as=[],Wa=Yr.split(`\r
`),l=0;l<Wa.length;++l){var c=Wa[l];if(c.length!=0)for(var p=0;p<c.length;){var y=76,k=c.slice(p,p+y);k.charAt(y-1)=="="?y--:k.charAt(y-2)=="="?y-=2:k.charAt(y-3)=="="&&(y-=3),k=c.slice(p,p+y),(p+=y)<c.length&&(k+="="),as.push(k)}else as.push("")}return as.join(`\r
`)}:function(Yr){for(var as=O(Yr),Wa=[],l=0;l<as.length;l+=76)Wa.push(as.slice(l,l+76));return Wa.join(`\r
`)+`\r
`})(ca))}return qr.push(Jr+`--\r
`),qr.join(`\r
`)})(Pe,qe);if(E(Pe),qe.fileType==="zip")return(function(Dr,Lr){var Lr=Lr||{},Jr=[],qr=[],fr=Ft(1),sr=Lr.compression?8:0,Zr=0,Fr=0,ir=0,ca=0,ea=0,dn=Dr.FullPaths[0],pa=dn,_a=Dr.FileIndex[0],Yr=[],as=0;for(Fr=1;Fr<Dr.FullPaths.length;++Fr)if(pa=Dr.FullPaths[Fr].slice(dn.length),(_a=Dr.FileIndex[Fr]).size&&_a.content&&pa!="Sh33tJ5"){var Wa=ca,l=Ft(pa.length);for(ir=0;ir<pa.length;++ir)l.write_shift(1,127&pa.charCodeAt(ir));l=l.slice(0,l.l),Yr[ea]=Nr.buf(_a.content,0);var c=_a.content;sr==8&&(c=(function(p){return P?P.deflateRawSync(p):Sr(p)})(c)),(fr=Ft(30)).write_shift(4,67324752),fr.write_shift(2,20),fr.write_shift(2,Zr),fr.write_shift(2,sr),_a.mt?(function(p,y){var k=(y=typeof y=="string"?new Date(y):y).getHours();k=(k=k<<6|y.getMinutes())<<5|y.getSeconds()>>>1,p.write_shift(2,k),k=(k=(k=y.getFullYear()-1980)<<4|y.getMonth()+1)<<5|y.getDate(),p.write_shift(2,k)})(fr,_a.mt):fr.write_shift(4,0),fr.write_shift(-4,Yr[ea]),fr.write_shift(4,c.length),fr.write_shift(4,_a.content.length),fr.write_shift(2,l.length),fr.write_shift(2,0),ca+=fr.length,Jr.push(fr),ca+=l.length,Jr.push(l),ca+=c.length,Jr.push(c),(fr=Ft(46)).write_shift(4,33639248),fr.write_shift(2,0),fr.write_shift(2,20),fr.write_shift(2,Zr),fr.write_shift(2,sr),fr.write_shift(4,0),fr.write_shift(-4,Yr[ea]),fr.write_shift(4,c.length),fr.write_shift(4,_a.content.length),fr.write_shift(2,l.length),fr.write_shift(2,0),fr.write_shift(2,0),fr.write_shift(2,0),fr.write_shift(2,0),fr.write_shift(4,0),fr.write_shift(4,Wa),as+=fr.l,qr.push(fr),as+=l.length,qr.push(l),++ea}return(fr=Ft(22)).write_shift(4,101010256),fr.write_shift(2,0),fr.write_shift(2,0),fr.write_shift(2,ea),fr.write_shift(2,ea),fr.write_shift(4,as),fr.write_shift(4,ca),fr.write_shift(2,0),ge([ge(Jr),ge(qr),fr])})(Pe,qe);for(var yt=(function(Dr){for(var yr=0,Lr=0,Jr=0;Jr<Dr.FileIndex.length;++Jr){var qr=Dr.FileIndex[Jr];qr.content&&0<(qr=qr.content.length)&&(qr<4096?yr+=qr+63>>6:Lr+=qr+511>>9)}for(var fr=Dr.FullPaths.length+3>>2,sr=yr+127>>7,Zr=(yr+7>>3)+Lr+fr+sr,Fr=Zr+127>>7,ir=Fr<=109?0:Math.ceil((Fr-109)/127);Fr<Zr+Fr+ir+127>>7;)ir=++Fr<=109?0:Math.ceil((Fr-109)/127);return fr=[1,ir,Fr,sr,fr,Lr,yr,0],Dr.FileIndex[0].size=yr<<6,fr[7]=(Dr.FileIndex[0].start=fr[0]+fr[1]+fr[2]+fr[3]+fr[4]+fr[5])+(fr[6]+7>>3),fr})(Pe),We=Ft(yt[7]<<9),pt=0,Wt=0,pt=0;pt<8;++pt)We.write_shift(1,re[pt]);for(pt=0;pt<8;++pt)We.write_shift(2,0);for(We.write_shift(2,62),We.write_shift(2,3),We.write_shift(2,65534),We.write_shift(2,9),We.write_shift(2,6),pt=0;pt<3;++pt)We.write_shift(2,0);for(We.write_shift(4,0),We.write_shift(4,yt[2]),We.write_shift(4,yt[0]+yt[1]+yt[2]+yt[3]-1),We.write_shift(4,0),We.write_shift(4,4096),We.write_shift(4,yt[3]?yt[0]+yt[1]+yt[2]-1:W),We.write_shift(4,yt[3]),We.write_shift(-4,yt[1]?yt[0]-1:W),We.write_shift(4,yt[1]),pt=0;pt<109;++pt)We.write_shift(-4,pt<yt[2]?yt[1]+pt:-1);if(yt[1])for(Wt=0;Wt<yt[1];++Wt){for(;pt<236+127*Wt;++pt)We.write_shift(-4,pt<yt[2]?yt[1]+pt:-1);We.write_shift(-4,Wt===yt[1]-1?W:Wt+1)}function Bt(Dr){for(Wt+=Dr;pt<Wt-1;++pt)We.write_shift(-4,pt+1);Dr&&(++pt,We.write_shift(-4,W))}for(Wt=pt=0,Wt+=yt[1];pt<Wt;++pt)We.write_shift(-4,be.DIFSECT);for(Wt+=yt[2];pt<Wt;++pt)We.write_shift(-4,be.FATSECT);Bt(yt[3]),Bt(yt[4]);for(var dt=0,Tt=0,tr=Pe.FileIndex[0];dt<Pe.FileIndex.length;++dt)(tr=Pe.FileIndex[dt]).content&&((Tt=tr.content.length)<4096||(tr.start=Wt,Bt(Tt+511>>9)));for(Bt(yt[6]+7>>3);511&We.l;)We.write_shift(-4,be.ENDOFCHAIN);for(dt=Wt=pt=0;dt<Pe.FileIndex.length;++dt)(tr=Pe.FileIndex[dt]).content&&(!(Tt=tr.content.length)||4096<=Tt||(tr.start=Wt,Bt(Tt+63>>6)));for(;511&We.l;)We.write_shift(-4,be.ENDOFCHAIN);for(pt=0;pt<yt[4]<<2;++pt){var _r=Pe.FullPaths[pt];if(_r&&_r.length!==0){if(tr=Pe.FileIndex[pt],pt===0&&(tr.start=tr.size?tr.start-1:W),_r=pt===0&&qe.root||tr.name,Tt=2*(_r.length+1),We.write_shift(64,_r,"utf16le"),We.write_shift(2,Tt),We.write_shift(1,tr.type),We.write_shift(1,tr.color),We.write_shift(-4,tr.L),We.write_shift(-4,tr.R),We.write_shift(-4,tr.C),tr.clsid)We.write_shift(16,tr.clsid,"hex");else for(dt=0;dt<4;++dt)We.write_shift(4,0);We.write_shift(4,tr.state||0),We.write_shift(4,0),We.write_shift(4,0),We.write_shift(4,0),We.write_shift(4,0),We.write_shift(4,tr.start),We.write_shift(4,tr.size),We.write_shift(4,0)}else{for(dt=0;dt<17;++dt)We.write_shift(4,0);for(dt=0;dt<3;++dt)We.write_shift(4,-1);for(dt=0;dt<12;++dt)We.write_shift(4,0)}}for(pt=1;pt<Pe.FileIndex.length;++pt)if(4096<=(tr=Pe.FileIndex[pt]).size)if(We.l=tr.start+1<<9,Z&&Buffer.isBuffer(tr.content))tr.content.copy(We,We.l,0,tr.size),We.l+=tr.size+511&-512;else{for(dt=0;dt<tr.size;++dt)We.write_shift(1,tr.content[dt]);for(;511&dt;++dt)We.write_shift(1,0)}for(pt=1;pt<Pe.FileIndex.length;++pt)if(0<(tr=Pe.FileIndex[pt]).size&&tr.size<4096)if(Z&&Buffer.isBuffer(tr.content))tr.content.copy(We,We.l,0,tr.size),We.l+=tr.size+63&-64;else{for(dt=0;dt<tr.size;++dt)We.write_shift(1,tr.content[dt]);for(;63&dt;++dt)We.write_shift(1,0)}if(Z)We.l=We.length;else for(;We.l<We.length;)We.write_shift(1,0);return We}A.version="1.2.1";var P,K=64,W=-2,me="d0cf11e0a1b11ae1",re=[208,207,17,224,161,177,26,225],De="00000000000000000000000000000000",be={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:W,FREESECT:-1,HEADER_SIGNATURE:me,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:De,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ce(Pe){for(var wt=new Array(Pe.length),qe=0;qe<Pe.length;++qe)wt[qe]=String.fromCharCode(Pe[qe]);return wt.join("")}for(var Ee=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Ue=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ie=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],$e,st=typeof Uint8Array<"u",rt=st?new Uint8Array(256):[],mt=0;mt<256;++mt)rt[mt]=255&(($e=139536&(($e=mt)<<1|$e<<11)|558144&($e<<5|$e<<15))>>16|$e>>8|$e);function Mt(Pe,yt){var qe=7&yt,yt=yt>>>3;return(Pe[yt]|(qe<=5?0:Pe[1+yt]<<8))>>>qe&7}function Qt(Pe,yt){var qe=7&yt,yt=yt>>>3;return(Pe[yt]|(qe<=3?0:Pe[1+yt]<<8))>>>qe&31}function vt(Pe,yt){var qe=7&yt,yt=yt>>>3;return(Pe[yt]|(qe<=1?0:Pe[1+yt]<<8))>>>qe&127}function Zt(Pe,pt,qe){var yt=7&pt,We=pt>>>3,Wt=(1<<qe)-1,pt=Pe[We]>>>yt;return qe<8-yt?pt&Wt:(pt|=Pe[1+We]<<8-yt,qe<16-yt?pt&Wt:(pt|=Pe[2+We]<<16-yt,qe<24-yt?pt&Wt:(pt|=Pe[3+We]<<24-yt)&Wt))}function Br(Pe,wt,qe){var yt=7&wt,We=wt>>>3;return yt<=5?Pe[We]|=(7&qe)<<yt:(Pe[We]|=qe<<yt&255,Pe[1+We]=(7&qe)>>8-yt),wt+3}function wr(Pe,wt,qe){var yt=wt>>>3;return qe<<=7&wt,Pe[yt]|=255&qe,qe>>>=8,Pe[1+yt]=qe,wt+8}function cr(Pe,wt,qe){var yt=wt>>>3;return qe<<=7&wt,Pe[yt]|=255&qe,qe>>>=8,Pe[1+yt]=255&qe,Pe[2+yt]=qe>>>8,wt+16}function ur(Pe,wt){var qe=Pe.length,yt=wt<2*qe?2*qe:wt+5,We=0;if(wt<=qe)return Pe;if(Z){var Wt=ue(yt);if(Pe.copy)Pe.copy(Wt);else for(;We<Pe.length;++We)Wt[We]=Pe[We];return Wt}if(st){var pt=new Uint8Array(yt);if(pt.set)pt.set(Pe);else for(;We<qe;++We)pt[We]=Pe[We];return pt}return Pe.length=yt,Pe}function nr(Pe){for(var wt=new Array(Pe),qe=0;qe<Pe;++qe)wt[qe]=0;return wt}function Vt(Pe,wt,qe){for(var yt,We=1,Tt=0,Wt=0,pt=0,Bt=Pe.length,dt=st?new Uint16Array(32):nr(32),Tt=0;Tt<32;++Tt)dt[Tt]=0;for(Tt=Bt;Tt<qe;++Tt)Pe[Tt]=0;Bt=Pe.length;var tr=st?new Uint16Array(Bt):nr(Bt);for(Tt=0;Tt<Bt;++Tt)dt[yt=Pe[Tt]]++,We<yt&&(We=yt),tr[Tt]=0;for(dt[0]=0,Tt=1;Tt<=We;++Tt)dt[Tt+16]=pt=pt+dt[Tt-1]<<1;for(Tt=0;Tt<Bt;++Tt)(pt=Pe[Tt])!=0&&(tr[Tt]=dt[pt+16]++);var _r,Dr,yr,Lr;for(Tt=0;Tt<Bt;++Tt)if((_r=Pe[Tt])!=0)for(Dr=tr[Tt],yr=We,Lr=void 0,Lr=rt[255&Dr],pt=(yr<=8?Lr>>>8-yr:(Lr=Lr<<8|rt[Dr>>8&255],yr<=16?Lr>>>16-yr:(Lr=Lr<<8|rt[Dr>>16&255])>>>24-yr))>>We-_r,Wt=(1<<We+4-_r)-1;0<=Wt;--Wt)wt[pt|Wt<<_r]=15&_r|Tt<<4;return We}var kr=st?new Uint16Array(512):nr(512),Rr=st?new Uint16Array(32):nr(32);if(!st){for(var na=0;na<512;++na)kr[na]=0;for(na=0;na<32;++na)Rr[na]=0}(function(){for(var Pe=[],wt=0;wt<32;wt++)Pe.push(5);Vt(Pe,Rr,32);for(var qe=[],wt=0;wt<=143;wt++)qe.push(8);for(;wt<=255;wt++)qe.push(9);for(;wt<=279;wt++)qe.push(7);for(;wt<=287;wt++)qe.push(8);Vt(qe,kr,288)})();var Ga=(function(){for(var Pe=st?new Uint8Array(32768):[],wt=0,qe=0;wt<Ie.length-1;++wt)for(;qe<Ie[wt+1];++qe)Pe[qe]=wt;for(;qe<32768;++qe)Pe[qe]=29;for(var yt=st?new Uint8Array(259):[],wt=0,qe=0;wt<Ue.length-1;++wt)for(;qe<Ue[wt+1];++qe)yt[qe]=wt;return function(We,Wt){return(We.length<8?function(pt,Bt){for(var dt=0;dt<pt.length;){var Tt=Math.min(65535,pt.length-dt),tr=dt+Tt==pt.length;for(Bt.write_shift(1,+tr),Bt.write_shift(2,Tt),Bt.write_shift(2,65535&~Tt);0<Tt--;)Bt[Bt.l++]=pt[dt++]}return Bt.l}:function(pt,Bt){for(var dt=0,Tt=0,tr=st?new Uint16Array(32768):[];Tt<pt.length;){var _r=Math.min(65535,pt.length-Tt);if(_r<10){for(7&(dt=Br(Bt,dt,+(Tt+_r==pt.length)))&&(dt+=8-(7&dt)),Bt.l=dt/8|0,Bt.write_shift(2,_r),Bt.write_shift(2,65535&~_r);0<_r--;)Bt[Bt.l++]=pt[Tt++];dt=8*Bt.l}else{dt=Br(Bt,dt,+(Tt+_r==pt.length)+2);for(var Dr=0;0<_r--;){var yr=pt[Tt],Dr=32767&(Dr<<5^yr),Lr=-1,Jr=0;if((Lr=tr[Dr])&&(Tt<(Lr|=-32768&Tt)&&(Lr-=32768),Lr<Tt))for(;pt[Lr+Jr]==pt[Tt+Jr]&&Jr<250;)++Jr;if(2<Jr){(yr=yt[Jr])<=22?dt=wr(Bt,dt,rt[yr+1]>>1)-1:(wr(Bt,dt,3),wr(Bt,dt+=5,rt[yr-23]>>5),dt+=3);var qr=yr<8?0:yr-4>>2;0<qr&&(cr(Bt,dt,Jr-Ue[yr]),dt+=qr),yr=Pe[Tt-Lr],dt=wr(Bt,dt,rt[yr]>>3),dt-=3;var fr=yr<4?0:yr-2>>1;0<fr&&(cr(Bt,dt,Tt-Lr-Ie[yr]),dt+=fr);for(var sr=0;sr<Jr;++sr)tr[Dr]=32767&Tt,Dr=32767&(Dr<<5^pt[Tt]),++Tt;_r-=Jr-1}else yr<=143?yr+=48:(qr=((qr=1)&qr)<<(7&(fr=dt)),Bt[fr>>>3]|=qr,dt=fr+1),dt=wr(Bt,dt,rt[yr]),tr[Dr]=32767&Tt,++Tt}dt=wr(Bt,dt,0)-1}}return Bt.l=(dt+7)/8|0,Bt.l})(We,Wt)}})();function Sr(qe){var wt=Ft(50+Math.floor(1.1*qe.length)),qe=Ga(qe,wt);return wt.slice(0,qe)}var er=st?new Uint16Array(32768):nr(32768),Na=st?new Uint16Array(32768):nr(32768),is=st?new Uint16Array(128):nr(128),Ja=1,Ls=1;function Zn(Pe,wt){if(Pe[0]==3&&!(3&Pe[1]))return[se(wt),2];for(var qe=0,yt=0,We=ue(wt||1<<18),Wt=0,pt=We.length>>>0,Bt=0,dt=0;(1&yt)==0;)if(yt=Mt(Pe,qe),qe+=3,yt>>>1!=0)for(dt=yt>>1==1?(Bt=9,5):(qe=(function(Jr,qr){var fr,sr,Zr,Fr=Qt(Jr,qr)+257,ir=Qt(Jr,qr+=5)+1,ca=(Zr=7&(sr=qr+=5),4+(((fr=Jr)[sr=sr>>>3]|(Zr<=4?0:fr[1+sr]<<8))>>>Zr&15));qr+=4;for(var ea=0,dn=st?new Uint8Array(19):nr(19),pa=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],_a=1,Yr=st?new Uint8Array(8):nr(8),as=st?new Uint8Array(8):nr(8),Wa=dn.length,l=0;l<ca;++l)dn[Ee[l]]=ea=Mt(Jr,qr),_a<ea&&(_a=ea),Yr[ea]++,qr+=3;var c=0;for(Yr[0]=0,l=1;l<=_a;++l)as[l]=c=c+Yr[l-1]<<1;for(l=0;l<Wa;++l)(c=dn[l])!=0&&(pa[l]=as[c]++);for(var p,l=0;l<Wa;++l)if((p=dn[l])!=0){c=rt[pa[l]]>>8-p;for(var y=(1<<7-p)-1;0<=y;--y)is[c|y<<p]=7&p|l<<3}for(var k,U,Ae,_e=[],_a=1;_e.length<Fr+ir;)switch(qr+=7&(c=is[vt(Jr,qr)]),c>>>=3){case 16:for(ea=3+(Ae=void 0,Ae=7&(U=qr),((k=Jr)[U=U>>>3]|(Ae<=6?0:k[1+U]<<8))>>>Ae&3),qr+=2,c=_e[_e.length-1];0<ea--;)_e.push(c);break;case 17:for(ea=3+Mt(Jr,qr),qr+=3;0<ea--;)_e.push(0);break;case 18:for(ea=11+vt(Jr,qr),qr+=7;0<ea--;)_e.push(0);break;default:_e.push(c),_a<c&&(_a=c)}var Ve=_e.slice(0,Fr),lt=_e.slice(Fr);for(l=Fr;l<286;++l)Ve[l]=0;for(l=ir;l<30;++l)lt[l]=0;return Ja=Vt(Ve,er,286),Ls=Vt(lt,Na,30),qr})(Pe,qe),Bt=Ja,Ls);;){!wt&&pt<Wt+32767&&(pt=(We=ur(We,Wt+32767)).length);var Tt=Zt(Pe,qe,Bt),tr=(yt>>>1==1?kr:er)[Tt];if(qe+=15&tr,((tr>>>=4)>>>8&255)==0)We[Wt++]=tr;else{if(tr==256)break;var _r=(tr-=257)<8?0:tr-4>>2;5<_r&&(_r=0);var Dr=Wt+Ue[tr];0<_r&&(Dr+=Zt(Pe,qe,_r),qe+=_r),Tt=Zt(Pe,qe,dt),qe+=15&(tr=(yt>>>1==1?Rr:Na)[Tt]);var Tt=(tr>>>=4)<4?0:tr-2>>1,yr=Ie[tr];for(0<Tt&&(yr+=Zt(Pe,qe,Tt),qe+=Tt),!wt&&pt<Dr&&(pt=(We=ur(We,Dr+100)).length);Wt<Dr;)We[Wt]=We[Wt-yr],++Wt}}else{7&qe&&(qe+=8-(7&qe));var Lr=Pe[qe>>>3]|Pe[1+(qe>>>3)]<<8;if(qe+=32,0<Lr)for(!wt&&pt<Wt+Lr&&(pt=(We=ur(We,Wt+Lr)).length);0<Lr--;)We[Wt++]=Pe[qe>>>3],qe+=8}return wt?[We,qe+7>>>3]:[We.slice(0,Wt),qe+7>>>3]}function Je(Pe,wt){return wt=Zn(Pe.slice(Pe.l||0),wt),Pe.l+=wt[1],wt[0]}function Us(Pe,wt){if(!Pe)throw new Error(wt);typeof console<"u"&&console.error(wt)}function bs(Pe,wt){var qe=Pe;_s(qe,0);var yt={FileIndex:[],FullPaths:[]};S(yt,{root:wt.root});for(var We=qe.length-4;(qe[We]!=80||qe[We+1]!=75||qe[We+2]!=5||qe[We+3]!=6)&&0<=We;)--We;qe.l=We+4,qe.l+=4;var Wt=qe.read_shift(2);for(qe.l+=6,wt=qe.read_shift(4),qe.l=wt,We=0;We<Wt;++We){qe.l+=20;var pt=qe.read_shift(4),Bt=qe.read_shift(4),dt=qe.read_shift(2),Tt=qe.read_shift(2),tr=qe.read_shift(2);qe.l+=8;var _r=qe.read_shift(4),Dr=x(qe.slice(qe.l+dt,qe.l+dt+Tt));qe.l+=dt+Tt+tr,tr=qe.l,qe.l=_r+4,(function(yr,Lr,Jr,qr,fr){yr.l+=2;var sr=yr.read_shift(2),Zr=yr.read_shift(2),Fr=(function(k){var l=65535&k.read_shift(2),c=65535&k.read_shift(2),p=new Date,y=31&c,k=15&(c>>>=5);return c>>>=4,p.setMilliseconds(0),p.setFullYear(1980+c),p.setMonth(k-1),p.setDate(y),k=31&l,y=63&(l>>>=5),l>>>=6,p.setHours(l),p.setMinutes(y),p.setSeconds(k<<1),p})(yr);if(8257&sr)throw new Error("Unsupported ZIP encryption");yr.read_shift(4);for(var ir,ca=yr.read_shift(4),ea=yr.read_shift(4),dn=yr.read_shift(2),pa=yr.read_shift(2),_a="",Yr=0;Yr<dn;++Yr)_a+=String.fromCharCode(yr[yr.l++]);pa&&(((ir=x(yr.slice(yr.l,yr.l+pa)))[21589]||{}).mt&&(Fr=ir[21589].mt),((fr||{})[21589]||{}).mt&&(Fr=fr[21589].mt)),yr.l+=pa;var as=yr.slice(yr.l,yr.l+ca);switch(Zr){case 8:as=(function(Wa,p){if(!P)return Je(Wa,p);var c=new P.InflateRaw,p=c._processChunk(Wa.slice(Wa.l),c._finishFlushFlag);return Wa.l+=c.bytesRead,p})(yr,ea);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Zr)}pa=!1,8&sr&&(yr.read_shift(4)==134695760&&(yr.read_shift(4),pa=!0),ca=yr.read_shift(4),ea=yr.read_shift(4)),ca!=Lr&&Us(pa,"Bad compressed size: "+Lr+" != "+ca),ea!=Jr&&Us(pa,"Bad uncompressed size: "+Jr+" != "+ea),kc(qr,_a,as,{unsafe:!0,mt:Fr})})(qe,pt,Bt,yt,Dr),qe.l=tr}return yt}var eo={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function kc(Pe,wt,qe,yt){var We=yt&&yt.unsafe;We||S(Pe);var Wt,pt=!We&&$t.find(Pe,wt);return pt||(Wt=Pe.FullPaths[0],Wt=wt.slice(0,Wt.length)==Wt?wt:(Wt.slice(-1)!="/"&&(Wt+="/"),(Wt+wt).replace("//","/")),pt={name:h(wt),type:2},Pe.FileIndex.push(pt),Pe.FullPaths.push(Wt),We||$t.utils.cfb_gc(Pe)),pt.content=qe,pt.size=qe?qe.length:0,yt&&(yt.CLSID&&(pt.clsid=yt.CLSID),yt.mt&&(pt.mt=yt.mt),yt.ct&&(pt.ct=yt.ct)),pt}return A.find=function(Pe,wt){var qe=Pe.FullPaths.map(function(dt){return dt.toUpperCase()}),yt=qe.map(function(dt){var Tt=dt.split("/");return Tt[Tt.length-(dt.slice(-1)=="/"?2:1)]}),We=!1;wt.charCodeAt(0)===47?(We=!0,wt=qe[0].slice(0,-1)+wt):We=wt.indexOf("/")!==-1;var Bt=wt.toUpperCase(),Wt=(We===!0?qe:yt).indexOf(Bt);if(Wt!==-1)return Pe.FileIndex[Wt];var pt=!Bt.match(ke),Bt=Bt.replace(fe,"");for(pt&&(Bt=Bt.replace(ke,"!")),Wt=0;Wt<qe.length;++Wt)if((pt?qe[Wt].replace(ke,"!"):qe[Wt]).replace(fe,"")==Bt||(pt?yt[Wt].replace(ke,"!"):yt[Wt]).replace(fe,"")==Bt)return Pe.FileIndex[Wt];return null},A.read=function(Pe,wt){var qe,yt,We=wt&&wt.type;switch(We||Z&&Buffer.isBuffer(Pe)&&(We="buffer"),We||"base64"){case"file":return qe=Pe,yt=wt,w(),v(o.readFileSync(qe),yt);case"base64":return v(ae(Q(Pe)),wt);case"binary":return v(ae(Pe),wt)}return v(Pe,wt)},A.parse=v,A.write=function(Pe,wt){var qe=I(Pe,wt);switch(wt&&wt.type||"buffer"){case"file":return w(),o.writeFileSync(wt.filename,qe),qe;case"binary":return typeof qe=="string"?qe:ce(qe);case"base64":return O(typeof qe=="string"?qe:ce(qe));case"buffer":if(Z)return Buffer.isBuffer(qe)?qe:ee(qe);case"array":return typeof qe=="string"?ae(qe):qe}return qe},A.writeFile=function(Pe,wt,qe){w(),qe=I(Pe,qe),o.writeFileSync(wt,qe)},A.utils={cfb_new:function(Pe){var wt={};return S(wt,Pe),wt},cfb_add:kc,cfb_del:function(Pe,wt){S(Pe);var qe=$t.find(Pe,wt);if(qe){for(var yt=0;yt<Pe.FileIndex.length;++yt)if(Pe.FileIndex[yt]==qe)return Pe.FileIndex.splice(yt,1),Pe.FullPaths.splice(yt,1),!0}return!1},cfb_mov:function(Pe,wt,qe){S(Pe);var yt=$t.find(Pe,wt);if(yt){for(var We=0;We<Pe.FileIndex.length;++We)if(Pe.FileIndex[We]==yt)return Pe.FileIndex[We].name=h(qe),Pe.FullPaths[We]=qe,!0}return!1},cfb_gc:function(Pe){E(Pe,!0)},ReadShift:mn,CheckField:el,prep_blob:_s,bconcat:ge,use_zlib:function(Pe){try{var wt=new Pe.InflateRaw;if(wt._processChunk(new Uint8Array([3,0]),wt._finishFlushFlag),!wt.bytesRead)throw new Error("zlib does not expose bytesRead");P=Pe}catch(qe){console.error("cannot use native zlib: "+(qe.message||qe))}},_deflateRaw:Sr,_inflateRaw:Je,consts:be},A})();if(typeof v2<"u")try{or=Uy}catch{}function Vo(o){return typeof o=="string"?pe(o):Array.isArray(o)?(function(A){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(A)})(o):o}function Hn(o,A,d){if(or!==void 0&&or.writeFileSync)return d?or.writeFileSync(o,A,d):or.writeFileSync(o,A);if(typeof Deno<"u"){if(d&&typeof A=="string")switch(d){case"utf8":A=new TextEncoder(d).encode(A);break;case"binary":A=pe(A);break;default:throw new Error("Unsupported encoding "+d)}return Deno.writeFileSync(o,A)}var h=d=="utf8"?aa(A):A;if(typeof IE_SaveFile<"u")return IE_SaveFile(h,o);if(typeof Blob<"u"){if(h=new Blob([Vo(h)],{type:"application/octet-stream"}),typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(h,o);if(typeof saveAs<"u")return saveAs(h,o);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var x=URL.createObjectURL(h);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(x)},6e4),chrome.downloads.download({url:x,filename:o,saveAs:!0});if(h=document.createElement("a"),h.download!=null)return h.download=o,h.href=x,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(x)},6e4),x}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var w=File(o);return w.open("w"),w.encoding="binary",Array.isArray(A)&&(A=z(A)),w.write(A),w.close(),A}catch(v){if(!v.message||!v.message.match(/onstruct/))throw v}throw new Error("cannot save file "+o)}function hs(o){for(var A=Object.keys(o),d=[],h=0;h<A.length;++h)Object.prototype.hasOwnProperty.call(o,A[h])&&d.push(A[h]);return d}function co(o,A){for(var d=[],h=hs(o),x=0;x!==h.length;++x)d[o[h[x]][A]]==null&&(d[o[h[x]][A]]=h[x]);return d}function ra(o){for(var A=[],d=hs(o),h=0;h!==d.length;++h)A[o[d[h]]]=d[h];return A}function ko(o){for(var A=[],d=hs(o),h=0;h!==d.length;++h)A[o[d[h]]]=parseInt(d[h],10);return A}var zi=new Date(1899,11,30,0,0,0);function ms(o,A){var d=o.getTime();return(d-(zi.getTime()+6e4*(o.getTimezoneOffset()-zi.getTimezoneOffset())))/864e5}var pi=new Date,en=zi.getTime()+6e4*(pi.getTimezoneOffset()-zi.getTimezoneOffset()),Tn=pi.getTimezoneOffset();function _n(o){var A=new Date;return A.setTime(24*o*60*60*1e3+en),A.getTimezoneOffset()!==Tn&&A.setTime(A.getTime()+6e4*(A.getTimezoneOffset()-Tn)),A}var Yo=new Date("2017-02-19T19:06:09.000Z"),Si=isNaN(Yo.getFullYear())?new Date("2/19/17"):Yo,Is=Si.getFullYear()==2017;function ba(o,A){var d=new Date(o);return Is?(0<A?d.setTime(d.getTime()+60*d.getTimezoneOffset()*1e3):A<0&&d.setTime(d.getTime()-60*d.getTimezoneOffset()*1e3),d):o instanceof Date?o:Si.getFullYear()==1917&&!isNaN(d.getFullYear())?(A=d.getFullYear(),-1<o.indexOf(""+A)||d.setFullYear(d.getFullYear()+100),d):(d=o.match(/\d+/g)||["2017","2","19","0","0","0"],d=new Date(+d[0],+d[1]-1,+d[2],+d[3]||0,+d[4]||0,+d[5]||0),d=-1<o.indexOf("Z")?new Date(d.getTime()-60*d.getTimezoneOffset()*1e3):d)}function Cn(o,A){if(Z&&Buffer.isBuffer(o)){if(A){if(o[0]==255&&o[1]==254)return aa(o.slice(2).toString("utf16le"));if(o[1]==254&&o[2]==255)return aa(M(o.slice(2).toString("binary")))}return o.toString("binary")}if(typeof TextDecoder<"u")try{if(A){if(o[0]==255&&o[1]==254)return aa(new TextDecoder("utf-16le").decode(o.slice(2)));if(o[0]==254&&o[1]==255)return aa(new TextDecoder("utf-16be").decode(o.slice(2)))}var d={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(o)&&(o=new Uint8Array(o)),new TextDecoder("latin1").decode(o).replace(/[]/g,function(w){return d[w]||w})}catch{}for(var h=[],x=0;x!=o.length;++x)h.push(String.fromCharCode(o[x]));return h.join("")}function Oa(o){if(typeof JSON<"u"&&!Array.isArray(o))return JSON.parse(JSON.stringify(o));if(typeof o!="object"||o==null)return o;if(o instanceof Date)return new Date(o.getTime());var A,d={};for(A in o)Object.prototype.hasOwnProperty.call(o,A)&&(d[A]=Oa(o[A]));return d}function ss(o,A){for(var d="";d.length<A;)d+=o;return d}function gi(h){var A=Number(h);if(!isNaN(A))return isFinite(A)?A:NaN;if(!/\d/.test(h))return A;var d=1,h=h.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return d*=100,""});return isNaN(A=Number(h))?(h=h.replace(/[(](.*)[)]/,function(x,w){return d=-d,w}),isNaN(A=Number(h))?A:A/d):A/d}var Wo=["january","february","march","april","may","june","july","august","september","october","november","december"];function Fi(o){var A=new Date(o),d=new Date(NaN),h=A.getYear(),x=A.getMonth(),w=A.getDate();if(isNaN(w))return d;var v=o.toLowerCase();if(v.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(3<(v=v.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length&&Wo.indexOf(v)==-1)return d}else if(v.match(/[a-z]/))return d;return h<0||8099<h||(!(0<x||1<w)||h==101)&&o.match(/[^-0-9:,\/\\]/)?d:A}var Hl,$o=(Hl="abacaba".split(/(:?b)/i).length==5,function(o,A,d){if(Hl||typeof A=="string")return o.split(A);for(var h=o.split(A),x=[h[0]],w=1;w<h.length;++w)x.push(d),x.push(h[w]);return x});function Do(o){return o?o.content&&o.type?Cn(o.content,!0):o.data?_(o.data):o.asNodeBuffer&&Z?_(o.asNodeBuffer().toString("binary")):o.asBinary?_(o.asBinary()):o._data&&o._data.getContent?_(Cn(Array.prototype.slice.call(o._data.getContent(),0))):null:null}function zl(o){if(!o)return null;if(o.data)return C(o.data);if(o.asNodeBuffer&&Z)return o.asNodeBuffer();if(o._data&&o._data.getContent){var A=o._data.getContent();return typeof A=="string"?C(A):Array.prototype.slice.call(A)}return o.content&&o.type?o.content:null}function Ln(o,A){for(var d=o.FullPaths||hs(o.files),h=A.toLowerCase().replace(/[\/]/g,"\\"),x=h.replace(/\\/g,"/"),w=0;w<d.length;++w){var v=d[w].replace(/^Root Entry[\/]/,"").toLowerCase();if(h==v||x==v)return o.files?o.files[d[w]]:o.FileIndex[w]}return null}function hn(o,A){if(o=Ln(o,A),o==null)throw new Error("Cannot find file "+A+" in zip");return o}function tt(o,A,d){if(!d)return((d=hn(o,A))&&d.name.slice(-4)===".bin"?zl:Do)(d);if(!A)return null;try{return tt(o,A)}catch{return null}}function zt(o,A,d){if(!d)return Do(hn(o,A));if(!A)return null;try{return zt(o,A)}catch{return null}}function qt(o){for(var A=o.FullPaths||hs(o.files),d=[],h=0;h<A.length;++h)A[h].slice(-1)!="/"&&d.push(A[h].replace(/^Root Entry[\/]/,""));return d.sort()}function Ct(o,A,d){if(o.FullPaths){if(typeof d=="string"){var h=(Z?ee:function(x){for(var w=[],v=0,N=x.length+250,S=se(x.length+255),E=0;E<x.length;++E){var I,P=x.charCodeAt(E);P<128?S[v++]=P:P<2048?(S[v++]=192|P>>6&31,S[v++]=128|63&P):55296<=P&&P<57344?(P=64+(1023&P),I=1023&x.charCodeAt(++E),S[v++]=240|P>>8&7,S[v++]=128|P>>2&63,S[v++]=128|I>>6&15|(3&P)<<4,S[v++]=128|63&I):(S[v++]=224|P>>12&15,S[v++]=128|P>>6&63,S[v++]=128|63&P),N<v&&(w.push(S.slice(0,v)),v=0,S=se(65535),N=65530)}return w.push(S.slice(0,v)),ge(w)})(d);return $t.utils.cfb_add(o,A,h)}$t.utils.cfb_add(o,A,d)}else o.file(A,d)}function Ar(){return $t.utils.cfb_new()}function $r(o,A){switch(A.type){case"base64":return $t.read(o,{type:"base64"});case"binary":return $t.read(o,{type:"binary"});case"buffer":case"array":return $t.read(o,{type:"buffer"})}throw new Error("Unrecognized type "+A.type)}function Ra(o,A){if(o.charAt(0)=="/")return o.slice(1);var d=A.split("/");A.slice(-1)!="/"&&d.pop();for(var h=o.split("/");h.length!==0;){var x=h.shift();x===".."?d.pop():x!=="."&&d.push(x)}return d.join("/")}var Ba=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,tn=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,R0=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,ns=Ba.match(R0)?R0:/<[^>]*>/g,Pa=/<\w*:/,ya=/<(\/?)\w+:/;function Cr(o,A,d){for(var h={},x=0,w=0;x!==o.length&&(w=o.charCodeAt(x))!==32&&w!==10&&w!==13;++x);if(A||(h[0]=o.slice(0,x)),x===o.length)return h;var v,N,S,E=o.match(tn),I=0,P=0,K="",W="";if(E)for(P=0;P!=E.length;++P){for(W=E[P],w=0;w!=W.length&&W.charCodeAt(w)!==61;++w);for(K=W.slice(0,w).trim();W.charCodeAt(w+1)==32;)++w;for(N=(x=W.charCodeAt(w+1))==34||x==39?1:0,v=W.slice(w+1+N,W.length-N),I=0;I!=K.length&&K.charCodeAt(I)!==58;++I);I===K.length?(h[K=0<K.indexOf("_")?K.slice(0,K.indexOf("_")):K]=v,h[K.toLowerCase()]=v):h[S=(I===5&&K.slice(0,5)==="xmlns"?"xmlns":"")+K.slice(I+1)]&&K.slice(I-3,I)=="ext"||(h[S]=v,h[S.toLowerCase()]=v)}return h}function rn(o){return o.replace(ya,"<$1")}var jo,xi,Ki={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Gs=ra(Ki),ma=(jo=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,xi=/_x([\da-fA-F]{4})_/gi,function o(A){var d=A+"",h=d.indexOf("<![CDATA[");return h==-1?d.replace(jo,function(x,w){return Ki[x]||String.fromCharCode(parseInt(w,-1<x.indexOf("x")?16:10))||x}).replace(xi,function(x,w){return String.fromCharCode(parseInt(w,16))}):(A=d.indexOf("]]>"),o(d.slice(0,h))+d.slice(h+9,A)+o(d.slice(A+3)))}),qo=/[&<>'"]/g,oc=/[\u0000-\u0008\u000b-\u001f]/g;function Va(o){return(o+"").replace(qo,function(A){return Gs[A]}).replace(oc,function(A){return"_x"+("000"+A.charCodeAt(0).toString(16)).slice(-4)+"_"})}function li(o){return Va(o).replace(/ /g,"_x0020_")}var Fs=/[\u0000-\u001f]/g;function Gi(o){return(o+"").replace(qo,function(A){return Gs[A]}).replace(/\n/g,"<br/>").replace(Fs,function(A){return"&#x"+("000"+A.charCodeAt(0).toString(16)).slice(-4)+";"})}var Vi,ls=(Vi=/&#(\d+);/g,function(o){return o.replace(Vi,jn)});function jn(o,A){return String.fromCharCode(parseInt(A,10))}function Ps(o){switch(o){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function HA(o){for(var A,d,h,x,w="",v=0,N=0;v<o.length;)(A=o.charCodeAt(v++))<128?w+=String.fromCharCode(A):(d=o.charCodeAt(v++),191<A&&A<224?(N=(31&A)<<6,N|=63&d,w+=String.fromCharCode(N)):(h=o.charCodeAt(v++),A<240?w+=String.fromCharCode((15&A)<<12|(63&d)<<6|63&h):(x=((7&A)<<18|(63&d)<<12|(63&h)<<6|63&(N=o.charCodeAt(v++)))-65536,w+=String.fromCharCode(55296+(x>>>10&1023)),w+=String.fromCharCode(56320+(1023&x)))));return w}function kd(o){for(var A,d,h=se(2*o.length),x=1,w=0,v=0,N=0;N<o.length;N+=x)x=1,(d=o.charCodeAt(N))<128?A=d:d<224?(A=64*(31&d)+(63&o.charCodeAt(N+1)),x=2):d<240?(A=4096*(15&d)+64*(63&o.charCodeAt(N+1))+(63&o.charCodeAt(N+2)),x=3):(x=4,A=262144*(7&d)+4096*(63&o.charCodeAt(N+1))+64*(63&o.charCodeAt(N+2))+(63&o.charCodeAt(N+3)),v=55296+((A-=65536)>>>10&1023),A=56320+(1023&A)),v!==0&&(h[w++]=255&v,h[w++]=v>>>8,v=0),h[w++]=A%256,h[w++]=A>>>8;return h.slice(0,w).toString("ucs2")}function hA(o){return ee(o,"binary").toString("utf8")}var Xo,To,yl,FA="foo bar baz",cs=Z&&(hA(FA)==HA(FA)?hA:kd(FA)==HA(FA)&&kd)||HA,aa=Z?function(o){return ee(o,"utf8").toString("binary")}:function(o){for(var A,d=[],h=0,x=0;h<o.length;)switch(!0){case(x=o.charCodeAt(h++))<128:d.push(String.fromCharCode(x));break;case x<2048:d.push(String.fromCharCode(192+(x>>6))),d.push(String.fromCharCode(128+(63&x)));break;case(55296<=x&&x<57344):x-=55296,A=o.charCodeAt(h++)-56320+(x<<10),d.push(String.fromCharCode(240+(A>>18&7))),d.push(String.fromCharCode(144+(A>>12&63))),d.push(String.fromCharCode(128+(A>>6&63))),d.push(String.fromCharCode(128+(63&A)));break;default:d.push(String.fromCharCode(224+(x>>12))),d.push(String.fromCharCode(128+(x>>6&63))),d.push(String.fromCharCode(128+(63&x)))}return d.join("")},vl=(Xo={},function(o,A){var d=o+"|"+(A||"");return Xo[d]||(Xo[d]=new RegExp("<(?:\\w+:)?"+o+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+o+">",A||""))}),mu=(To=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(o){return[new RegExp("&"+o[0]+";","ig"),o[1]]}),function(o){for(var A=o.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),d=0;d<To.length;++d)A=A.replace(To[d][0],To[d][1]);return A}),pu=(yl={},function(o){return yl[o]!==void 0?yl[o]:yl[o]=new RegExp("<(?:vt:)?"+o+">([\\s\\S]*?)</(?:vt:)?"+o+">","g")}),df=/<\/?(?:vt:)?variant>/g,Jo=/<(?:vt:)([^>]*)>([\s\S]*)</;function Ei(h,A){var d=Cr(h),h=h.match(pu(d.baseType))||[],x=[];if(h.length==d.size)return h.forEach(function(w){w=w.replace(df,"").match(Jo),w&&x.push({v:cs(w[2]),t:w[1]})}),x;if(A.WTF)throw new Error("unexpected vector length "+h.length+" != "+d.size);return x}var Dd=/(^\s|\s$|\n)/;function Un(o,A){return"<"+o+(A.match(Dd)?' xml:space="preserve"':"")+">"+A+"</"+o+">"}function Yi(o){return hs(o).map(function(A){return" "+A+'="'+o[A]+'"'}).join("")}function lr(o,A,d){return"<"+o+(d!=null?Yi(d):"")+(A!=null?(A.match(Dd)?' xml:space="preserve"':"")+">"+A+"</"+o:"/")+">"}function wl(o,A){try{return o.toISOString().replace(/\.\d*/,"")}catch(d){if(A)throw d}return""}function Mc(o){if(Z&&Buffer.isBuffer(o))return o.toString("utf8");if(typeof o=="string")return o;if(typeof Uint8Array<"u"&&o instanceof Uint8Array)return cs(z(J(o)));throw new Error("Bad input format: expected Buffer or string")}var Zo=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,Bn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Nl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ts={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function _o(o){for(var A=[],d=0;d<o[0].length;++d)if(o[0][d])for(var h=0,x=o[0][d].length;h<x;h+=10240)A.push.apply(A,o[0][d].slice(h,h+10240));return A}function Kl(o,A,d){for(var h=[],x=A;x<d;x+=2)h.push(String.fromCharCode(Qr(o,x)));return h.join("").replace(fe,"")}function lc(o,A,d){for(var h=[],x=A;x<A+d;++x)h.push(("0"+o[x].toString(16)).slice(-2));return h.join("")}function zA(o,A,d){for(var h=[],x=A;x<d;x++)h.push(String.fromCharCode(Ir(o,x)));return h.join("")}function mA(o,A){var d=Xr(o,A);return 0<d?Oc(o,A+4,A+4+d-1):""}function cc(o,A){var d=Xr(o,A);return 0<d?Oc(o,A+4,A+4+d-1):""}function Ic(o,A){var d=2*Xr(o,A);return 0<d?Oc(o,A+4,A+4+d-1):""}function pA(o,A){var d=Xr(o,A);return 0<d?KA(o,A+4,A+4+d):""}function Gl(o,A){var d=Xr(o,A);return 0<d?Oc(o,A+4,A+4+d):""}function Ac(o,A){for(var d=1-2*(o[A+7]>>>7),h=((127&o[A+7])<<4)+(o[A+6]>>>4&15),x=15&o[A+6],w=5;0<=w;--w)x=256*x+o[A+w];return h==2047?x==0?1/0*d:NaN:(h==0?h=-1022:(h-=1023,x+=Math.pow(2,52)),d*Math.pow(2,h-52)*x)}var gu=Z?function(o){return 0<o[0].length&&Buffer.isBuffer(o[0][0])?Buffer.concat(o[0].map(function(A){return Buffer.isBuffer(A)?A:ee(A)})):_o(o)}:_o,KA=Z?function(o,A,d){return Buffer.isBuffer(o)?o.toString("utf16le",A,d).replace(fe,""):Kl(o,A,d)}:Kl,dc=Z?function(o,A,d){return Buffer.isBuffer(o)?o.toString("hex",A,A+d):lc(o,A,d)}:lc,Oc=Z?function(o,A,d){return Buffer.isBuffer(o)?o.toString("utf8",A,d):zA(o,A,d)}:zA,R=mA,Ce=cc,Ke=Ic,Xe=pA,nt=Gl,Lt=Ac,Gt=function(o){return Array.isArray(o)||typeof Uint8Array<"u"&&o instanceof Uint8Array};Z&&(R=function(o,A){if(!Buffer.isBuffer(o))return mA(o,A);var d=o.readUInt32LE(A);return 0<d?o.toString("utf8",A+4,A+4+d-1):""},Ce=function(o,A){if(!Buffer.isBuffer(o))return cc(o,A);var d=o.readUInt32LE(A);return 0<d?o.toString("utf8",A+4,A+4+d-1):""},Ke=function(o,A){if(!Buffer.isBuffer(o))return Ic(o,A);var d=2*o.readUInt32LE(A);return o.toString("utf16le",A+4,A+4+d-1)},Xe=function(o,A){if(!Buffer.isBuffer(o))return pA(o,A);var d=o.readUInt32LE(A);return o.toString("utf16le",A+4,A+4+d)},nt=function(o,A){if(!Buffer.isBuffer(o))return Gl(o,A);var d=o.readUInt32LE(A);return o.toString("utf8",A+4,A+4+d)},Lt=function(o,A){return Buffer.isBuffer(o)?o.readDoubleLE(A):Ac(o,A)},Gt=function(o){return Buffer.isBuffer(o)||Array.isArray(o)||typeof Uint8Array<"u"&&o instanceof Uint8Array}),e!==void 0&&(KA=function(o,A,d){return e.utils.decode(1200,o.slice(A,d)).replace(fe,"")},Oc=function(o,A,d){return e.utils.decode(65001,o.slice(A,d))},R=function(o,A){var d=Xr(o,A);return 0<d?e.utils.decode(f,o.slice(A+4,A+4+d-1)):""},Ce=function(o,A){var d=Xr(o,A);return 0<d?e.utils.decode(u,o.slice(A+4,A+4+d-1)):""},Ke=function(o,A){var d=2*Xr(o,A);return 0<d?e.utils.decode(1200,o.slice(A+4,A+4+d-1)):""},Xe=function(o,A){var d=Xr(o,A);return 0<d?e.utils.decode(1200,o.slice(A+4,A+4+d)):""},nt=function(o,A){var d=Xr(o,A);return 0<d?e.utils.decode(65001,o.slice(A+4,A+4+d)):""});var Ir=function(o,A){return o[A]},Qr=function(o,A){return 256*o[A+1]+o[A]},va=function(o,A){return A=256*o[A+1]+o[A],A<32768?A:-1*(65535-A+1)},Xr=function(o,A){return o[A+3]*(1<<24)+(o[A+2]<<16)+(o[A+1]<<8)+o[A]},$a=function(o,A){return o[A+3]<<24|o[A+2]<<16|o[A+1]<<8|o[A]},Mn=function(o,A){return o[A]<<24|o[A+1]<<16|o[A+2]<<8|o[A+3]};function mn(o,A){var d,h,x,w,v,N,S="",E=[];switch(A){case"dbcs":if(N=this.l,Z&&Buffer.isBuffer(this))S=this.slice(this.l,this.l+2*o).toString("utf16le");else for(v=0;v<o;++v)S+=String.fromCharCode(Qr(this,N)),N+=2;o*=2;break;case"utf8":S=Oc(this,this.l,this.l+o);break;case"utf16le":o*=2,S=KA(this,this.l,this.l+o);break;case"wstr":if(e===void 0)return mn.call(this,o,"dbcs");S=e.utils.decode(u,this.slice(this.l,this.l+2*o)),o*=2;break;case"lpstr-ansi":S=R(this,this.l),o=4+Xr(this,this.l);break;case"lpstr-cp":S=Ce(this,this.l),o=4+Xr(this,this.l);break;case"lpwstr":S=Ke(this,this.l),o=4+2*Xr(this,this.l);break;case"lpp4":o=4+Xr(this,this.l),S=Xe(this,this.l),2&o&&(o+=2);break;case"8lpp4":o=4+Xr(this,this.l),S=nt(this,this.l),3&o&&(o+=4-(3&o));break;case"cstr":for(o=0,S="";(x=Ir(this,this.l+o++))!==0;)E.push(L(x));S=E.join("");break;case"_wstr":for(o=0,S="";(x=Qr(this,this.l+o))!==0;)E.push(L(x)),o+=2;o+=2,S=E.join("");break;case"dbcs-cont":for(S="",N=this.l,v=0;v<o;++v){if(this.lens&&this.lens.indexOf(N)!==-1)return x=Ir(this,N),this.l=N+1,w=mn.call(this,o-v,x?"dbcs-cont":"sbcs-cont"),E.join("")+w;E.push(L(Qr(this,N))),N+=2}S=E.join(""),o*=2;break;case"cpstr":if(e!==void 0){S=e.utils.decode(u,this.slice(this.l,this.l+o));break}case"sbcs-cont":for(S="",N=this.l,v=0;v!=o;++v){if(this.lens&&this.lens.indexOf(N)!==-1)return x=Ir(this,N),this.l=N+1,w=mn.call(this,o-v,x?"dbcs-cont":"sbcs-cont"),E.join("")+w;E.push(L(Ir(this,N))),N+=1}S=E.join("");break;default:switch(o){case 1:return d=Ir(this,this.l),this.l++,d;case 2:return d=(A==="i"?va:Qr)(this,this.l),this.l+=2,d;case 4:case-4:return A==="i"||(128&this[this.l+3])==0?(d=(0<o?$a:Mn)(this,this.l),this.l+=4,d):(h=Xr(this,this.l),this.l+=4,h);case 8:case-8:if(A==="f")return h=o==8?Lt(this,this.l):Lt([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,h;o=8;case 16:S=dc(this,this.l,o)}}return this.l+=o,S}var an=function(o,A,d){o[d]=255&A,o[d+1]=A>>>8&255,o[d+2]=A>>>16&255,o[d+3]=A>>>24&255},bi=function(o,A,d){o[d]=255&A,o[d+1]=A>>8&255,o[d+2]=A>>16&255,o[d+3]=A>>24&255},ci=function(o,A,d){o[d]=255&A,o[d+1]=A>>>8&255};function Wi(o,A,d){var h=0,x=0;if(d==="dbcs"){for(x=0;x!=A.length;++x)ci(this,A.charCodeAt(x),this.l+2*x);h=2*A.length}else if(d==="sbcs"){if(e!==void 0&&f==874)for(x=0;x!=A.length;++x){var w=e.utils.encode(f,A.charAt(x));this[this.l+x]=w[0]}else for(A=A.replace(/[^\x00-\x7F]/g,"_"),x=0;x!=A.length;++x)this[this.l+x]=255&A.charCodeAt(x);h=A.length}else{if(d==="hex"){for(;x<o;++x)this[this.l++]=parseInt(A.slice(2*x,2*x+2),16)||0;return this}if(d==="utf16le"){for(var v=Math.min(this.l+o,this.length),x=0;x<Math.min(A.length,o);++x){var N=A.charCodeAt(x);this[this.l++]=255&N,this[this.l++]=N>>8}for(;this.l<v;)this[this.l++]=0;return this}switch(o){case 1:h=1,this[this.l]=255&A;break;case 2:h=2,this[this.l]=255&A,A>>>=8,this[this.l+1]=255&A;break;case 3:h=3,this[this.l]=255&A,A>>>=8,this[this.l+1]=255&A,A>>>=8,this[this.l+2]=255&A;break;case 4:h=4,an(this,A,this.l);break;case 8:if(h=8,d==="f"){(function(S,E,I){var P=(E<0||1/E==-1/0?1:0)<<7,K=0,W=0,me=P?-E:E;isFinite(me)?me==0?K=W=0:(K=Math.floor(Math.log(me)/Math.LN2),W=me*Math.pow(2,52-K),K<=-1023&&(!isFinite(W)||W<Math.pow(2,52))?K=-1022:(W-=Math.pow(2,52),K+=1023)):(K=2047,W=isNaN(E)?26985:0);for(var re=0;re<=5;++re,W/=256)S[I+re]=255&W;S[I+6]=(15&K)<<4|15&W,S[I+7]=K>>4|P})(this,A,this.l);break}case 16:break;case-4:h=4,bi(this,A,this.l)}}return this.l+=h,this}function el(o,A){var d=dc(this,this.l,o.length>>1);if(d!==o)throw new Error(A+"Expected "+o+" saw "+d);this.l+=o.length>>1}function _s(o,A){o.l=A,o.read_shift=mn,o.chk=el,o.write_shift=Wi}function yi(o,A){o.l+=A}function Ft(o){return o=se(o),_s(o,0),o}function Bo(o,A,d){if(o){_s(o,o.l||0);for(var h,x=o.length,w=0;o.l<x;){128&(w=o.read_shift(1))&&(w=(127&w)+((127&o.read_shift(1))<<7));for(var v,N=Iu[w]||Iu[65535],S=127&(v=o.read_shift(1)),E=1;E<4&&128&v;++E)S+=(127&(v=o.read_shift(1)))<<7*E;h=o.l+S;var I=N.f&&N.f(o,S,d);if(o.l=h,A(I,N,w))return}}}function In(){function o(v){return _s(v=Ft(v),0),v}function A(){w&&(w.length>w.l&&((w=w.slice(0,w.l)).l=w.length),0<w.length&&h.push(w),w=null)}function d(v){return w&&v<w.length-w.l?w:(A(),w=o(Math.max(v+1,x)))}var h=[],x=Z?256:2048,w=o(x);return{next:d,push:function(v){A(),(w=v).l==null&&(w.l=w.length),d(x)},end:function(){return A(),ge(h)},_bufs:h}}function Pt(o,A,d,h){var x=+A;if(!isNaN(x)){A=1+(128<=x?1:0)+1,128<=(h=h||Iu[x].p||(d||[]).length||0)&&++A,16384<=h&&++A,2097152<=h&&++A;var w=o.next(A);x<=127?w.write_shift(1,x):(w.write_shift(1,128+(127&x)),w.write_shift(1,x>>7));for(var v=0;v!=4;++v){if(!(128<=h)){w.write_shift(1,h);break}w.write_shift(1,128+(127&h)),h>>=7}0<h&&Gt(d)&&o.push(d)}}function Vl(o,A,d){var h=Oa(o);if(A.s?(h.cRel&&(h.c+=A.s.c),h.rRel&&(h.r+=A.s.r)):(h.cRel&&(h.c+=A.c),h.rRel&&(h.r+=A.r)),!d||d.biff<12){for(;256<=h.c;)h.c-=256;for(;65536<=h.r;)h.r-=65536}return h}function Qc(o,A,d){return o=Oa(o),o.s=Vl(o.s,A.s,d),o.e=Vl(o.e,A.s,d),o}function ti(o,A){if(o.cRel&&o.c<0)for(o=Oa(o);o.c<0;)o.c+=8<A?16384:256;if(o.rRel&&o.r<0)for(o=Oa(o);o.r<0;)o.r+=8<A?1048576:5<A?65536:16384;var d=ha(o);return o.cRel||o.cRel==null||(d=d.replace(/^([A-Z])/,"$$$1")),d=!o.rRel&&o.rRel!=null?d.replace(/([A-Z]|^)(\d+)$/,"$1$$$2"):d}function uc(o,A){return o.s.r!=0||o.s.rRel||o.e.r!=(12<=A.biff?1048575:8<=A.biff?65536:16384)||o.e.rRel?o.s.c!=0||o.s.cRel||o.e.c!=(12<=A.biff?16383:255)||o.e.cRel?ti(o.s,A.biff)+":"+ti(o.e,A.biff):(o.s.rRel?"":"$")+Vs(o.s.r)+":"+(o.e.rRel?"":"$")+Vs(o.e.r):(o.s.cRel?"":"$")+Sa(o.s.c)+":"+(o.e.cRel?"":"$")+Sa(o.e.c)}function fc(o){return parseInt(o.replace(/\$(\d+)$/,"$1"),10)-1}function Vs(o){return""+(o+1)}function Cl(o){for(var A=o.replace(/^\$([A-Z])/,"$1"),d=0,h=0;h!==A.length;++h)d=26*d+A.charCodeAt(h)-64;return d-1}function Sa(o){if(o<0)throw new Error("invalid column "+o);var A="";for(++o;o;o=Math.floor((o-1)/26))A=String.fromCharCode((o-1)%26+65)+A;return A}function Es(o){for(var A=0,d=0,h=0;h<o.length;++h){var x=o.charCodeAt(h);48<=x&&x<=57?A=10*A+(x-48):65<=x&&x<=90&&(d=26*d+(x-64))}return{c:d-1,r:A-1}}function ha(o){for(var A=o.c+1,d="";A;A=(A-1)/26|0)d=String.fromCharCode((A-1)%26+65)+d;return d+(o.r+1)}function vi(o){var A=o.indexOf(":");return A==-1?{s:Es(o),e:Es(o)}:{s:Es(o.slice(0,A)),e:Es(o.slice(A+1))}}function fa(o,A){return A===void 0||typeof A=="number"?fa(o.s,o.e):(o=typeof o!="string"?ha(o):o)==(A=typeof A!="string"?ha(A):A)?o:o+":"+A}function Fa(o){for(var A={s:{c:0,r:0},e:{c:0,r:0}},w=0,d=0,h=0,x=o.length,w=0;d<x&&!((h=o.charCodeAt(d)-64)<1||26<h);++d)w=26*w+h;for(A.s.c=--w,w=0;d<x&&!((h=o.charCodeAt(d)-48)<0||9<h);++d)w=10*w+h;if(A.s.r=--w,d===x||h!=10)return A.e.c=A.s.c,A.e.r=A.s.r,A;for(++d,w=0;d!=x&&!((h=o.charCodeAt(d)-64)<1||26<h);++d)w=26*w+h;for(A.e.c=--w,w=0;d!=x&&!((h=o.charCodeAt(d)-48)<0||9<h);++d)w=10*w+h;return A.e.r=--w,A}function Rc(o,A){var d=o.t=="d"&&A instanceof Date;if(o.z!=null)try{return o.w=pr(o.z,d?ms(A):A)}catch{}try{return o.w=pr((o.XF||{}).numFmtId||(d?14:0),d?ms(A):A)}catch{return""+A}}function Lo(o,A,d){return o==null||o.t==null||o.t=="z"?"":o.w!==void 0?o.w:(o.t=="d"&&!o.z&&d&&d.dateNF&&(o.z=d.dateNF),o.t=="e"?So[o.v]||o.v:Rc(o,A??o.v))}function ki(o,h){var d=h&&h.sheet?h.sheet:"Sheet1",h={};return h[d]=o,{SheetNames:[d],Sheets:h}}function Pc(o,A,d){var h=d||{},x=o?Array.isArray(o):h.dense,w=o||(x?[]:{}),v=0,N=0;w&&h.origin!=null&&(typeof h.origin=="number"?v=h.origin:(v=(S=typeof h.origin=="string"?Es(h.origin):h.origin).r,N=S.c),w["!ref"]||(w["!ref"]="A1:A1"));var S,E={s:{c:1e7,r:1e7},e:{c:0,r:0}};w["!ref"]&&(S=Fa(w["!ref"]),E.s.c=S.s.c,E.s.r=S.s.r,E.e.c=Math.max(E.e.c,S.e.c),E.e.r=Math.max(E.e.r,S.e.r),v==-1&&(E.e.r=v=S.e.r+1));for(var I=0;I!=A.length;++I)if(A[I]){if(!Array.isArray(A[I]))throw new Error("aoa_to_sheet expects an array of arrays");for(var P=0;P!=A[I].length;++P)if(A[I][P]!==void 0){var K={v:A[I][P]},W=v+I,me=N+P;if(E.s.r>W&&(E.s.r=W),E.s.c>me&&(E.s.c=me),E.e.r<W&&(E.e.r=W),E.e.c<me&&(E.e.c=me),!A[I][P]||typeof A[I][P]!="object"||Array.isArray(A[I][P])||A[I][P]instanceof Date)if(Array.isArray(K.v)&&(K.f=A[I][P][1],K.v=K.v[0]),K.v===null)if(K.f)K.t="n";else if(h.nullError)K.t="e",K.v=0;else{if(!h.sheetStubs)continue;K.t="z"}else typeof K.v=="number"?K.t="n":typeof K.v=="boolean"?K.t="b":K.v instanceof Date?(K.z=h.dateNF||X[14],h.cellDates?(K.t="d",K.w=pr(K.z,ms(K.v))):(K.t="n",K.v=ms(K.v),K.w=pr(K.z,K.v))):K.t="s";else K=A[I][P];x?(w[W]||(w[W]=[]),w[W][me]&&w[W][me].z&&(K.z=w[W][me].z),w[W][me]=K):(w[W=ha({c:me,r:W})]&&w[W].z&&(K.z=w[W].z),w[W]=K)}}return E.s.c<1e7&&(w["!ref"]=fa(E)),w}function wi(o,A){return Pc(null,o,A)}function pn(o,A){return(A=A||Ft(4)).write_shift(4,o),A}function gn(o){var A=o.read_shift(4);return A===0?"":o.read_shift(A,"dbcs")}function Ys(o,A){var d=!1;return A==null&&(d=!0,A=Ft(4+2*o.length)),A.write_shift(4,o.length),0<o.length&&A.write_shift(0,o,"dbcs"),d?A.slice(0,A.l):A}function Yl(o,A){var d,h=o.l,x=o.read_shift(1),v=gn(o),w=[],v={t:v,h:v};if((1&x)!=0){for(var N=o.read_shift(4),S=0;S!=N;++S)w.push({ich:(d=o).read_shift(2),ifnt:d.read_shift(2)});v.r=w}else v.r=[{ich:0,ifnt:0}];return o.l=h+A,v}var Td=Yl;function _d(o,A){var d,h=!1;return A==null&&(h=!0,A=Ft(23+4*o.t.length)),A.write_shift(1,1),Ys(o.t,A),A.write_shift(4,1),d={ich:0,ifnt:0},(o=(o=A)||Ft(4)).write_shift(2,d.ich||0),o.write_shift(2,d.ifnt||0),h?A.slice(0,A.l):A}function ys(o){var A=o.read_shift(4),d=o.read_shift(2);return d+=o.read_shift(1)<<16,o.l++,{c:A,iStyleRef:d}}function hc(o,A){return(A=A??Ft(8)).write_shift(-4,o.c),A.write_shift(3,o.iStyleRef||o.s),A.write_shift(1,0),A}function Ao(o){var A=o.read_shift(2);return A+=o.read_shift(1)<<16,o.l++,{c:-1,iStyleRef:A}}function uo(o,A){return(A=A??Ft(4)).write_shift(3,o.iStyleRef||o.s),A.write_shift(1,0),A}var $i=gn,mc=Ys;function gA(o){var A=o.read_shift(4);return A===0||A===4294967295?"":o.read_shift(A,"dbcs")}function Hc(o,A){var d=!1;return A==null&&(d=!0,A=Ft(127)),A.write_shift(4,0<o.length?o.length:4294967295),0<o.length&&A.write_shift(0,o,"dbcs"),d?A.slice(0,A.l):A}var zc=gn,Wl=gA,jl=Hc;function Kc(o){var A=o.slice(o.l,o.l+4),d=1&A[0],h=2&A[0];return o.l+=4,A=h==0?Lt([0,0,0,0,252&A[0],A[1],A[2],A[3]],0):$a(A,0)>>2,d?A/100:A}function Uo(o,A){A==null&&(A=Ft(4));var d=0,h=0,x=100*o;if(o==(0|o)&&-536870912<=o&&o<1<<29?h=1:x==(0|x)&&-536870912<=x&&x<1<<29&&(d=h=1),!h)throw new Error("unsupported RkNumber "+o);A.write_shift(-4,((d?x:o)<<2)+(d+2))}function pc(o){var A={s:{},e:{}};return A.s.r=o.read_shift(4),A.e.r=o.read_shift(4),A.s.c=o.read_shift(4),A.e.c=o.read_shift(4),A}var zn=pc,qi=function(o,A){return(A=A||Ft(16)).write_shift(4,o.s.r),A.write_shift(4,o.e.r),A.write_shift(4,o.s.c),A.write_shift(4,o.e.c),A};function Ea(o){if(o.length-o.l<8)throw"XLS Xnum Buffer underflow";return o.read_shift(8,"f")}function Ya(o,A){return(A||Ft(8)).write_shift(8,o,"f")}function Os(o,A){if(A=A||Ft(8),!o||o.auto)return A.write_shift(4,0),A.write_shift(4,0),A;o.index!=null?(A.write_shift(1,2),A.write_shift(1,o.index)):o.theme!=null?(A.write_shift(1,6),A.write_shift(1,o.theme)):(A.write_shift(1,5),A.write_shift(1,0));var d=o.tint||0;return 0<d?d*=32767:d<0&&(d*=32768),A.write_shift(2,d),o.rgb&&o.theme==null?(typeof(o=o.rgb||"FFFFFF")=="number"&&(o=("000000"+o.toString(16)).slice(-6)),A.write_shift(1,parseInt(o.slice(0,2),16)),A.write_shift(1,parseInt(o.slice(2,4),16)),A.write_shift(1,parseInt(o.slice(4,6),16)),A.write_shift(1,255)):(A.write_shift(2,0),A.write_shift(1,0),A.write_shift(1,0)),A}function Kn(o,A){var d=o.read_shift(4);switch(d){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[o.read_shift(4)]||""}if(400<d)throw new Error("Unsupported Clipboard: "+d.toString(16));return o.l-=4,o.read_shift(0,A==1?"lpstr":"lpwstr")}var Bl=2,Sn=3,xA=12,Ld=81,p0=[80,Ld],uf={1:{n:"CodePage",t:Bl},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:Sn},5:{n:"LineCount",t:Sn},6:{n:"ParagraphCount",t:Sn},7:{n:"SlideCount",t:Sn},8:{n:"NoteCount",t:Sn},9:{n:"HiddenCount",t:Sn},10:{n:"MultimediaClipCount",t:Sn},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:Sn},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:Sn,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},ff={1:{n:"CodePage",t:Bl},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:Sn},15:{n:"WordCount",t:Sn},16:{n:"CharCount",t:Sn},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:Sn},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},g0={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},x0=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],GA=Oa([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].map(function(o){return[o>>16&255,o>>8&255,255&o]})),So={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},tl={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},VA={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},fo={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Gc(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function xu(o,A){var d,h=(function(S){for(var E=[],I=hs(S),P=0;P!==I.length;++P)E[S[I[P]]]==null&&(E[S[I[P]]]=[]),E[S[I[P]]].push(I[P]);return E})(VA),x=[];x[x.length]=Ba,x[x.length]=lr("Types",null,{xmlns:Bn.CT,"xmlns:xsd":Bn.xsd,"xmlns:xsi":Bn.xsi}),x=x.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(S){return lr("Default",null,{Extension:S[0],ContentType:S[1]})}));function w(S){o[S]&&0<o[S].length&&(d=o[S][0],x[x.length]=lr("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:fo[S][A.bookType]||fo[S].xlsx}))}function v(S){(o[S]||[]).forEach(function(E){x[x.length]=lr("Override",null,{PartName:(E[0]=="/"?"":"/")+E,ContentType:fo[S][A.bookType]||fo[S].xlsx})})}function N(S){(o[S]||[]).forEach(function(E){x[x.length]=lr("Override",null,{PartName:(E[0]=="/"?"":"/")+E,ContentType:h[S][0]})})}return w("workbooks"),v("sheets"),v("charts"),N("themes"),["strs","styles"].forEach(w),["coreprops","extprops","custprops"].forEach(N),N("vba"),N("comments"),N("threadedcomments"),N("drawings"),v("metadata"),N("people"),2<x.length&&(x[x.length]="</Types>",x[1]=x[1].replace("/>",">")),x.join("")}var Ta={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Vc(o){var A=o.lastIndexOf("/");return o.slice(0,A+1)+"_rels/"+o.slice(A+1)+".rels"}function bA(o,A){var d={"!id":{}};if(!o)return d;A.charAt(0)!=="/"&&(A="/"+A);var h={};return(o.match(ns)||[]).forEach(function(x){var w,v=Cr(x);v[0]==="<Relationship"&&((w={}).Type=v.Type,w.Target=v.Target,w.Id=v.Id,v.TargetMode&&(w.TargetMode=v.TargetMode),x=v.TargetMode==="External"?v.Target:Ra(v.Target,A),d[x]=w,h[v.Id]=w)}),d["!id"]=h,d}function Mo(o){var A=[Ba,lr("Relationships",null,{xmlns:Bn.RELS})];return hs(o["!id"]).forEach(function(d){A[A.length]=lr("Relationship",null,o["!id"][d])}),2<A.length&&(A[A.length]="</Relationships>",A[1]=A[1].replace("/>",">")),A.join("")}function ps(o,A,d,h,x,w){if(x=x||{},o["!id"]||(o["!id"]={}),o["!idx"]||(o["!idx"]=1),A<0)for(A=o["!idx"];o["!id"]["rId"+A];++A);if(o["!idx"]=A+1,x.Id="rId"+A,x.Type=h,x.Target=d,-1<[Ta.HLINK,Ta.XPATH,Ta.XMISS].indexOf(x.Type)&&(x.TargetMode="External"),o["!id"][x.Id])throw new Error("Cannot rewrite rId "+A);return o["!id"][x.Id]=x,o[("/"+x.Target).replace("//","/")]=x,A}var ho="application/vnd.oasis.opendocument.spreadsheet";function Di(o,A,d){return['  <rdf:Description rdf:about="'+o+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(d||"odf")+"#"+A+`"/>
`,`  </rdf:Description>
`].join("")}function bu(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+s.version+"</meta:generator></office:meta></office:document-meta>"}var Ws=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],hf=(function(){for(var o=new Array(Ws.length),A=0;A<Ws.length;++A){var d=Ws[A],d="(?:"+d[0].slice(0,d[0].indexOf(":"))+":)"+d[0].slice(d[0].indexOf(":")+1);o[A]=new RegExp("<"+d+"[^>]*>([\\s\\S]*?)</"+d+">")}return o})();function rl(o){var A={};o=cs(o);for(var d=0;d<Ws.length;++d){var h=Ws[d],x=o.match(hf[d]);x!=null&&0<x.length&&(A[h[1]]=ma(x[1])),h[2]==="date"&&A[h[1]]&&(A[h[1]]=ba(A[h[1]]))}return A}function YA(o,A,d,h,x){x[o]==null&&A!=null&&A!==""&&(A=Va(x[o]=A),h[h.length]=d?lr(o,A,d):Un(o,A))}function WA(o,A){var d=A||{},h=[Ba,lr("cp:coreProperties",null,{"xmlns:cp":Bn.CORE_PROPS,"xmlns:dc":Bn.dc,"xmlns:dcterms":Bn.dcterms,"xmlns:dcmitype":Bn.dcmitype,"xmlns:xsi":Bn.xsi})],x={};if(!o&&!d.Props)return h.join("");o&&(o.CreatedDate!=null&&YA("dcterms:created",typeof o.CreatedDate=="string"?o.CreatedDate:wl(o.CreatedDate,d.WTF),{"xsi:type":"dcterms:W3CDTF"},h,x),o.ModifiedDate!=null&&YA("dcterms:modified",typeof o.ModifiedDate=="string"?o.ModifiedDate:wl(o.ModifiedDate,d.WTF),{"xsi:type":"dcterms:W3CDTF"},h,x));for(var w=0;w!=Ws.length;++w){var v=Ws[w],N=d.Props&&d.Props[v[1]]!=null?d.Props[v[1]]:o?o[v[1]]:null;N===!0?N="1":N===!1?N="0":typeof N=="number"&&(N=String(N)),N!=null&&YA(v[0],N,null,h,x)}return 2<h.length&&(h[h.length]="</cp:coreProperties>",h[1]=h[1].replace("/>",">")),h.join("")}var Io=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Ud=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function yu(o,A,d,h){var x=[];if(typeof o=="string")x=Ei(o,h);else for(var w=0;w<o.length;++w)x=x.concat(o[w].map(function(I){return{v:I}}));var v,N=typeof A=="string"?Ei(A,h).map(function(I){return I.v}):A,S=0;if(0<N.length)for(var E=0;E!==x.length;E+=2){switch(v=+x[E+1].v,x[E].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":d.Worksheets=v,d.SheetNames=N.slice(S,S+v);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":d.NamedRanges=v,d.DefinedNames=N.slice(S,S+v);break;case"Charts":case"Diagramme":d.Chartsheets=v,d.ChartNames=N.slice(S,S+v)}S+=v}}function $A(o){var A=[],d=lr;return(o=o||{}).Application="SheetJS",A[A.length]=Ba,A[A.length]=lr("Properties",null,{xmlns:Bn.EXT_PROPS,"xmlns:vt":Bn.vt}),Io.forEach(function(h){if(o[h[1]]!==void 0){var x;switch(h[2]){case"string":x=Va(String(o[h[1]]));break;case"bool":x=o[h[1]]?"true":"false"}x!==void 0&&(A[A.length]=d(h[0],x))}}),A[A.length]=d("HeadingPairs",d("vt:vector",d("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+d("vt:variant",d("vt:i4",String(o.Worksheets))),{size:2,baseType:"variant"})),A[A.length]=d("TitlesOfParts",d("vt:vector",o.SheetNames.map(function(h){return"<vt:lpstr>"+Va(h)+"</vt:lpstr>"}).join(""),{size:o.Worksheets,baseType:"lpstr"})),2<A.length&&(A[A.length]="</Properties>",A[1]=A[1].replace("/>",">")),A.join("")}var mf=/<[^>]+>[^<]*/g;function al(o){var A=[Ba,lr("Properties",null,{xmlns:Bn.CUST_PROPS,"xmlns:vt":Bn.vt})];if(!o)return A.join("");var d=1;return hs(o).forEach(function(h){++d,A[A.length]=lr("property",(function(x,w){switch(typeof x){case"string":var v=lr("vt:lpwstr",Va(x));return v=v.replace(/&quot;/g,"_x0022_");case"number":return lr((0|x)==x?"vt:i4":"vt:r8",Va(String(x)));case"boolean":return lr("vt:bool",x?"true":"false")}if(x instanceof Date)return lr("vt:filetime",wl(x));throw new Error("Unable to serialize "+x)})(o[h]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:d,name:Va(h)})}),2<A.length&&(A[A.length]="</Properties>",A[1]=A[1].replace("/>",">")),A.join("")}var qA,Yc={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Md(d){var A=d.read_shift(4),d=d.read_shift(4);return new Date(1e3*(d/1e7*Math.pow(2,32)+A/1e7-11644473600)).toISOString().replace(/\.000/,"")}function Id(o,A,d){var h=o.l,x=o.read_shift(0,"lpstr-cp");if(d)for(;o.l-h&3;)++o.l;return x}function sl(o,A,d){var h=o.read_shift(0,"lpwstr");return h}function nl(o,A,d){return A===31?sl(o):Id(o,0,d)}function Wc(o,A,d){return nl(o,A,d===!1?0:4)}function Sl(o){for(var A,d,h,x=o.read_shift(4),w=[],v=0;v<x/2;++v)w.push((h=d=void 0,d=(A=o).l,h=vu(A,Ld),A[A.l]==0&&A[A.l+1]==0&&A.l-d&2&&(A.l+=2),[h,vu(A,Sn)]));return w}function il(o,A){for(var d=o.read_shift(4),h={},x=0;x!=d;++x){var w=o.read_shift(4),v=o.read_shift(4);h[w]=o.read_shift(v,A===1200?"utf16le":"utf8").replace(fe,"").replace(ke,"!"),A===1200&&v%2&&(o.l+=2)}return 3&o.l&&(o.l=o.l>>3<<2),h}function Oo(o){var A=o.read_shift(4),d=o.slice(o.l,o.l+A);return o.l+=A,0<(3&A)&&(o.l+=4-(3&A)&3),d}function vu(o,A,d){var h,x,w=o.read_shift(2),v=d||{};if(o.l+=2,A!==xA&&w!==A&&p0.indexOf(A)===-1&&((65534&A)!=4126||(65534&w)!=4126))throw new Error("Expected type "+A+" saw "+w);switch(A===xA?w:A){case 2:return h=o.read_shift(2,"i"),v.raw||(o.l+=2),h;case 3:return h=o.read_shift(4,"i");case 11:return o.read_shift(4)!==0;case 19:return h=o.read_shift(4);case 30:return Id(o,0,4).replace(fe,"");case 31:return sl(o);case 64:return Md(o);case 65:return Oo(o);case 71:return(x={}).Size=(h=o).read_shift(4),h.l+=x.Size+3-(x.Size-1)%4,x;case 80:return Wc(o,w,!v.raw).replace(fe,"");case 81:return(function(N,S){if(!S)throw new Error("VtUnalignedString must have positive length");return nl(N,S,0)})(o,w).replace(fe,"");case 4108:return Sl(o);case 4126:case 4127:return(w==4127?function(N){for(var S=N.read_shift(4),E=[],I=0;I!=S;++I){var P=N.l;E[I]=N.read_shift(0,"lpwstr").replace(fe,""),N.l-P&2&&(N.l+=2)}return E}:function(N){for(var S=N.read_shift(4),E=[],I=0;I!=S;++I)E[I]=N.read_shift(0,"lpstr-cp").replace(fe,"");return E})(o);default:throw new Error("TypedPropertyValue unrecognized type "+A+" "+w)}}function pf(o,A){var d,h,x,w=Ft(4),v=Ft(4);switch(w.write_shift(4,o==80?31:o),o){case 3:v.write_shift(-4,A);break;case 5:(v=Ft(8)).write_shift(8,A,"f");break;case 11:v.write_shift(4,A?1:0);break;case 64:h=(typeof(d=A)=="string"?new Date(Date.parse(d)):d).getTime()/1e3+11644473600,x=h%Math.pow(2,32),d=(h-x)/Math.pow(2,32),d*=1e7,0<(h=(x*=1e7)/Math.pow(2,32)|0)&&(x%=Math.pow(2,32),d+=h),(h=Ft(8)).write_shift(4,x),h.write_shift(4,d),v=h;break;case 31:case 80:for((v=Ft(4+2*(A.length+1)+(A.length%2?0:2))).write_shift(4,A.length+1),v.write_shift(0,A,"dbcs");v.l!=v.length;)v.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+o+" "+A)}return ge([w,v])}function wu(o,A){for(var d=o.l,h=o.read_shift(4),x=o.read_shift(4),w=[],E=0,v=0,N=-1,S={},E=0;E!=x;++E){var I=o.read_shift(4),P=o.read_shift(4);w[E]=[I,P+d]}w.sort(function(be,ce){return be[1]-ce[1]});var K={};for(E=0;E!=x;++E){if(o.l!==w[E][1]){var W=!0;if(0<E&&A)switch(A[w[E-1][0]].t){case 2:o.l+2===w[E][1]&&(o.l+=2,W=!1);break;case 80:case 4108:o.l<=w[E][1]&&(o.l=w[E][1],W=!1)}if((!A||E==0)&&o.l<=w[E][1]&&(W=!1,o.l=w[E][1]),W)throw new Error("Read Error: Expected address "+w[E][1]+" at "+o.l+" :"+E)}if(A){var me=A[w[E][0]];if(K[me.n]=vu(o,me.t,{raw:!0}),me.p==="version"&&(K[me.n]=String(K[me.n]>>16)+"."+("0000"+String(65535&K[me.n])).slice(-4)),me.n=="CodePage")switch(K[me.n]){case 0:K[me.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:j(v=K[me.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+K[me.n])}}else if(w[E][0]===1)v=K.CodePage=vu(o,Bl),j(v),N!==-1&&(De=o.l,o.l=w[N][1],S=il(o,v),o.l=De);else if(w[E][0]===0)v!==0?S=il(o,v):(N=E,o.l=w[E+1][1]);else{var re,De=S[w[E][0]];switch(o[o.l]){case 65:o.l+=4,re=Oo(o);break;case 30:case 31:o.l+=4,re=Wc(o,o[o.l-4]).replace(/\u0000+$/,"");break;case 3:o.l+=4,re=o.read_shift(4,"i");break;case 19:o.l+=4,re=o.read_shift(4);break;case 5:o.l+=4,re=o.read_shift(8,"f");break;case 11:o.l+=4,re=Ma(o,4);break;case 64:o.l+=4,re=ba(Md(o));break;default:throw new Error("unparsed value: "+o[o.l])}K[De]=re}}return o.l=d+h,K}var b0=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Ti(o,A,d){var h,x,w,v,N=Ft(8),S=[],E=[],I=8,P=0,K=Ft(8),W=Ft(8);if(K.write_shift(4,2),K.write_shift(4,1200),W.write_shift(4,1),E.push(K),S.push(W),I+=8+K.length,!A){(W=Ft(8)).write_shift(4,0),S.unshift(W);var me=[Ft(4)];for(me[0].write_shift(4,o.length),P=0;P<o.length;++P){var re=o[P][0];for((K=Ft(8+2*(re.length+1)+(re.length%2?0:2))).write_shift(4,P+2),K.write_shift(4,re.length+1),K.write_shift(0,re,"dbcs");K.l!=K.length;)K.write_shift(1,0);me.push(K)}K=ge(me),E.unshift(K),I+=8+K.length}for(P=0;P<o.length;++P)A&&!A[o[P][0]]||-1<b0.indexOf(o[P][0])||-1<Ud.indexOf(o[P][0])||o[P][1]!=null&&(w=o[P][1],h=0,K=A?((v=d[h=+A[o[P][0]]]).p=="version"&&typeof w=="string"&&(w=(+(x=w.split("."))[0]<<16)+(+x[1]||0)),pf(v.t,w)):((v=(function(be){switch(typeof be){case"boolean":return 11;case"number":return(0|be)==be?3:5;case"string":return 31;case"object":if(be instanceof Date)return 64}return-1})(w))==-1&&(v=31,w=String(w)),pf(v,w)),E.push(K),(W=Ft(8)).write_shift(4,A?h:2+P),S.push(W),I+=8+K.length);for(var De=8*(E.length+1),P=0;P<E.length;++P)S[P].write_shift(4,De),De+=E[P].length;return N.write_shift(4,I),N.write_shift(4,E.length),ge([N].concat(S).concat(E))}function sn(o,A,d){var h=o.content;if(!h)return{};_s(h,0);var x,w=0;h.chk("feff","Byte Order: "),h.read_shift(2);var v=h.read_shift(4),N=h.read_shift(16);if(N!==$t.utils.consts.HEADER_CLSID&&N!==d)throw new Error("Bad PropertySet CLSID "+N);if((o=h.read_shift(4))!==1&&o!==2)throw new Error("Unrecognized #Sets: "+o);if(d=h.read_shift(16),N=h.read_shift(4),o===1&&N!==h.l)throw new Error("Length mismatch: "+N+" !== "+h.l);o===2&&(x=h.read_shift(16),w=h.read_shift(4));var S,E,I=wu(h,A),P={SystemIdentifier:v};for(S in I)P[S]=I[S];if(P.FMTID=d,o===1)return P;if(w-h.l==2&&(h.l+=2),h.l!==w)throw new Error("Length mismatch 2: "+h.l+" !== "+w);try{E=wu(h,null)}catch{}for(S in E)P[S]=E[S];return P.FMTID=[d,x],P}function es(o,A,d,h,x,w){var v=Ft(x?68:48),N=[v];return v.write_shift(2,65534),v.write_shift(2,0),v.write_shift(4,842412599),v.write_shift(16,$t.utils.consts.HEADER_CLSID,"hex"),v.write_shift(4,x?2:1),v.write_shift(16,A,"hex"),v.write_shift(4,x?68:48),h=Ti(o,d,h),N.push(h),x&&(x=Ti(x,null,null),v.write_shift(16,w,"hex"),v.write_shift(4,68+h.length),N.push(x)),ge(N)}function Gn(o,A){return o.read_shift(A),null}function Ma(o,A){return o.read_shift(A)===1}function xn(o,A){return(A=A||Ft(2)).write_shift(2,+!!o),A}function $s(o){return o.read_shift(2,"u")}function Qo(o,A){return(A=A||Ft(2)).write_shift(2,o),A}function gc(o,A){return(function(d,h,x){for(var w=[],v=d.l+h;d.l<v;)w.push(x(d,v-d.l));if(v!==d.l)throw new Error("Slurp error");return w})(o,A,$s)}function _i(o,A,d){return(d=d||Ft(2)).write_shift(1,A=="e"?+o:+!!o),d.write_shift(1,A=="e"?1:0),d}function $l(o,A,d){var h=o.read_shift(d&&12<=d.biff?2:1),x="sbcs-cont",w=u;return d&&8<=d.biff&&(u=1200),d&&d.biff!=8?d.biff==12&&(x="wstr"):o.read_shift(1)&&(x="dbcs-cont"),2<=d.biff&&d.biff<=5&&(x="cpstr"),x=h?o.read_shift(h,x):"",u=w,x}function $c(o,A,d){if(d){if(2<=d.biff&&d.biff<=5)return o.read_shift(A,"cpstr");if(12<=d.biff)return o.read_shift(A,"dbcs-cont")}return o.read_shift(1)===0?o.read_shift(A,"sbcs-cont"):o.read_shift(A,"dbcs-cont")}function xc(o,A,d){var h=o.read_shift(d&&d.biff==2?1:2);return h===0?(o.l++,""):$c(o,h,d)}function bc(o,A,d){if(5<d.biff)return xc(o,0,d);var h=o.read_shift(1);return h===0?(o.l++,""):o.read_shift(h,d.biff<=4||!o.lens?"cpstr":"sbcs-cont")}function qc(o,A,d){return(d=d||Ft(3+2*o.length)).write_shift(2,o.length),d.write_shift(1,1),d.write_shift(31,o,"utf16le"),d}function yc(o){var A,d,h,x,w=o.read_shift(16);switch(w){case"e0c9ea79f9bace118c8200aa004ba90b":return d=(A=o).read_shift(4),h=A.l,x=!1,24<d&&(A.l+=d-24,A.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(x=!0),A.l=h),d=A.read_shift((x?d-24:d)>>1,"utf16le").replace(fe,""),x&&(A.l+=24),d;case"0303000000000000c000000000000046":return(function(v){for(var N=v.read_shift(2),S="";0<N--;)S+="../";var E=v.read_shift(0,"lpstr-ansi");if(v.l+=2,v.read_shift(2)!=57005)throw new Error("Bad FileMoniker");if(v.read_shift(4)===0)return S+E.replace(/\\/g,"/");if(E=v.read_shift(4),v.read_shift(2)!=3)throw new Error("Bad FileMoniker");return S+v.read_shift(E>>1,"utf16le").replace(fe,"")})(o);default:throw new Error("Unsupported Moniker "+w)}}function ql(o){var A=o.read_shift(4);return 0<A?o.read_shift(A,"utf16le").replace(fe,""):""}function ol(o,A){(A=A||Ft(6+2*o.length)).write_shift(4,1+o.length);for(var d=0;d<o.length;++d)A.write_shift(2,o.charCodeAt(d));return A.write_shift(2,0),A}function XA(o){return[o.read_shift(1),o.read_shift(1),o.read_shift(1),o.read_shift(1)]}function yA(o){return o=XA(o),o[3]=0,o}function Xi(o){return{r:o.read_shift(2),c:o.read_shift(2),ixfe:o.read_shift(2)}}function vc(o,A,d,h){return(h=h||Ft(6)).write_shift(2,o),h.write_shift(2,A),h.write_shift(2,d||0),h}function Xc(o){return[o.read_shift(2),Kc(o)]}function Ai(o){var A=o.read_shift(2),d=o.read_shift(2);return{s:{c:o.read_shift(2),r:A},e:{c:o.read_shift(2),r:d}}}function Nu(o,A){return(A=A||Ft(8)).write_shift(2,o.s.r),A.write_shift(2,o.e.r),A.write_shift(2,o.s.c),A.write_shift(2,o.e.c),A}function y0(o){var A=o.read_shift(2),d=o.read_shift(2);return{s:{c:o.read_shift(1),r:A},e:{c:o.read_shift(1),r:d}}}var pp=y0;function _h(o){o.l+=4;var A=o.read_shift(2),d=o.read_shift(2),h=o.read_shift(2);return o.l+=12,[d,A,h]}function mo(o){o.l+=2,o.l+=o.read_shift(2)}var ri={0:mo,4:mo,5:mo,6:mo,7:function(o){return o.l+=4,o.cf=o.read_shift(2),{}},8:mo,9:mo,10:mo,11:mo,12:mo,13:function(o){var A={};return o.l+=4,o.l+=16,A.fSharedNote=o.read_shift(2),o.l+=4,A},14:mo,15:mo,16:mo,17:mo,18:mo,19:mo,20:mo,21:_h};function Jc(o,A){var d={BIFFVer:0,dt:0};switch(d.BIFFVer=o.read_shift(2),2<=(A-=2)&&(d.dt=o.read_shift(2),o.l-=2),d.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(6<A)throw new Error("Unexpected BIFF Ver "+d.BIFFVer)}return o.read_shift(A),d}function JA(o,A,d){var h=1536,x=16;switch(d.bookType){case"biff8":break;case"biff5":h=1280,x=8;break;case"biff4":h=4,x=6;break;case"biff3":h=3,x=6;break;case"biff2":h=2,x=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}return d=Ft(x),d.write_shift(2,h),d.write_shift(2,A),4<x&&d.write_shift(2,29282),6<x&&d.write_shift(2,1997),8<x&&(d.write_shift(2,49161),d.write_shift(2,1),d.write_shift(2,1798),d.write_shift(2,0)),d}function Cu(o){var A=Ft(8);A.write_shift(4,o.Count),A.write_shift(4,o.Unique);for(var d,h,x,w=[],v=0;v<o.length;++v)w[v]=(d=o[v],x=h=void 0,h=d.t||"",(x=Ft(3)).write_shift(2,h.length),x.write_shift(1,1),(d=Ft(2*h.length)).write_shift(2*h.length,h,"utf16le"),ge([x,d]));var N=ge([A].concat(w));return N.parts=[A.length].concat(w.map(function(S){return S.length})),N}function ju(o,A,d){var h=0;return d&&d.biff==2||(h=o.read_shift(2)),o=o.read_shift(2),d&&d.biff==2&&(h=1-(o>>15),o&=32767),[{Unsynced:1&h,DyZero:(2&h)>>1,ExAsc:(4&h)>>2,ExDsc:(8&h)>>3},o]}var $d=bc;function B(o,w,v){var h=o.l+w,N=v.biff!=8&&v.biff?2:4,x=o.read_shift(N),w=o.read_shift(N),v=o.read_shift(2),N=o.read_shift(2);return o.l=h,{s:{r:x,c:v},e:{r:w,c:N}}}function D(o,A,d,h){return d=d&&d.biff==5,(h=h||Ft(d?16:20)).write_shift(2,0),o.style?(h.write_shift(2,o.numFmtId||0),h.write_shift(2,65524)):(h.write_shift(2,o.numFmtId||0),h.write_shift(2,A<<4)),A=0,0<o.numFmtId&&d&&(A|=1024),h.write_shift(4,A),h.write_shift(4,0),d||h.write_shift(4,0),h.write_shift(2,0),h}function Y(o,A,d){var h=Xi(o);return d.biff!=2&&A!=9||++o.l,o=(A=o).read_shift(1),o=A.read_shift(1)===1?o:o===1,h.val=o,h.t=o===!0||o===!1?"b":"e",h}function oe(o,A,d){return A===0?"":bc(o,0,d)}function Be(o,A,d){var h,x=o.read_shift(2),x={fBuiltIn:1&x,fWantAdvise:x>>>1&1,fWantPict:x>>>2&1,fOle:x>>>3&1,fOleLink:x>>>4&1,cf:x>>>5&1023,fIcon:x>>>15&1};return d.sbcch===14849&&(h=(function(w,E,N){w.l+=4,E-=4;var S=w.l+E,E=$l(w,0,N);if((N=w.read_shift(2))!==(S-=w.l))throw new Error("Malformed AddinUdf: padding = "+S+" != "+N);return w.l+=N,E})(o,A-2,d)),x.body=h||o.read_shift(A-2),typeof h=="string"&&(x.Name=h),x}var Te=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Le(o,S,d){var h=o.l+S,x=o.read_shift(2),w=o.read_shift(1),v=o.read_shift(1),N=o.read_shift(d&&d.biff==2?1:2),S=0;return(!d||5<=d.biff)&&(d.biff!=5&&(o.l+=2),S=o.read_shift(2),d.biff==5&&(o.l+=2),o.l+=4),v=$c(o,v,d),32&x&&(v=Te[v.charCodeAt(0)]),x=h-o.l,d&&d.biff==2&&--x,{chKey:w,Name:v,itab:S,rgce:h!=o.l&&N!==0&&0<x?(function(E,me,P,re){var W,me=E.l+me,re=M0(E,re,P);return me!==E.l&&(W=Lu(E,me-E.l,re,P)),[re,W]})(o,x,d,N):[]}}function Oe(o,A,d){if(d.biff<8)return(function(N,S){return N[N.l+1]==3&&N[N.l]++,S=$l(N,0,S),S.charCodeAt(0)==3?S.slice(1):S})(o,d);for(var h,x,w=[],A=o.l+A,v=o.read_shift(8<d.biff?4:2);v--!=0;)w.push((h=o,d.biff,x=8<(x=d).biff?4:2,[h.read_shift(x),h.read_shift(x,"i"),h.read_shift(x,"i")]));if(o.l!=A)throw new Error("Bad ExternSheet: "+o.l+" != "+A);return w}function Re(o,A,d){var h=pp(o);switch(d.biff){case 2:o.l++,A-=7;break;case 3:case 4:o.l+=2,A-=8;break;default:o.l+=6,A-=12}return[h,(function(x,w,v){var N,S=x.l+w,E=v.biff==2?1:2,I=x.read_shift(E);if(I==65535)return[[],yi(x,w-2)];var P=M0(x,I,v);return w!==I+E&&(N=Lu(x,w-I-E,P,v)),x.l=S,[P,N]})(o,A,d)]}var ze={8:function(o,A){var d=o.l+A;o.l+=10;var h=o.read_shift(2);return o.l+=4,o.l+=2,o.l+=2,o.l+=2,o.l+=4,A=o.read_shift(1),o.l+=A,o.l=d,{fmt:h}}};function Ze(o){var A=Ft(24),d=Es(o[0]);A.write_shift(2,d.r),A.write_shift(2,d.r),A.write_shift(2,d.c),A.write_shift(2,d.c);for(var h="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),x=0;x<16;++x)A.write_shift(1,parseInt(h[x],16));return ge([A,(function(w){var v=Ft(512),N=0,S=w.Target,E=-1<(w=(S=S.slice(0,7)=="file://"?S.slice(7):S).indexOf("#"))?31:23;switch(S.charAt(0)){case"#":E=28;break;case".":E&=-3}v.write_shift(4,2),v.write_shift(4,E);for(var I=[8,6815827,6619237,4849780,83],N=0;N<I.length;++N)v.write_shift(4,I[N]);if(E==28)ol(S=S.slice(1),v);else if(2&E){for(I="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),N=0;N<I.length;++N)v.write_shift(1,parseInt(I[N],16));var P=-1<w?S.slice(0,w):S;for(v.write_shift(4,2*(P.length+1)),N=0;N<P.length;++N)v.write_shift(2,P.charCodeAt(N));v.write_shift(2,0),8&E&&ol(-1<w?S.slice(w+1):"",v)}else{for(I="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),N=0;N<I.length;++N)v.write_shift(1,parseInt(I[N],16));for(var K=0;S.slice(3*K,3*K+3)=="../"||S.slice(3*K,3*K+3)=="..\\";)++K;for(v.write_shift(2,K),v.write_shift(4,S.length-3*K+1),N=0;N<S.length-3*K;++N)v.write_shift(1,255&S.charCodeAt(N+3*K));for(v.write_shift(1,0),v.write_shift(2,65535),v.write_shift(2,57005),N=0;N<6;++N)v.write_shift(4,0)}return v.slice(0,v.l)})(o[1])])}function ht(o,S,d){if(!d.cellStyles)return yi(o,S);var h=d&&12<=d.biff?4:2,x=o.read_shift(h),w=o.read_shift(h),v=o.read_shift(h),N=o.read_shift(h),S=o.read_shift(2);return h==2&&(o.l+=2),N={s:x,e:w,w:v,ixfe:N,flags:S},(5<=d.biff||!d.biff)&&(N.level=S>>8&7),N}var He=Xi,at=gc,f1=xc,ot,Dt,ct,Et=[2,3,48,49,131,139,140,245],Ut=(ot={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},Dt=ra({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127}),ct={B:8,C:250,L:1,D:8,"?":0,"":0},{to_workbook:function(o,A){try{return ki(Xt(o,A),A)}catch(d){if(A&&A.WTF)throw d}return{SheetNames:[],Sheets:{}}},to_sheet:Xt,from_sheet:function(o,A){if(0<=+(A=A||{}).codepage&&j(+A.codepage),A.type=="string")throw new Error("Cannot write DBF to JS string");for(var d=In(),h=(A=ym(o,{header:1,raw:!0,cellDates:!0}))[0],x=A.slice(1),w=o["!cols"]||[],E=0,v=0,N=0,S=1,E=0;E<h.length;++E)if(((w[E]||{}).DBF||{}).name)h[E]=w[E].DBF.name,++N;else if(h[E]!=null){if(++N,typeof h[E]=="number"&&(h[E]=h[E].toString(10)),typeof h[E]!="string")throw new Error("DBF Invalid column name "+h[E]+" |"+typeof h[E]+"|");if(h.indexOf(h[E])!==E){for(v=0;v<1024;++v)if(h.indexOf(h[E]+"_"+v)==-1){h[E]+="_"+v;break}}}var I=Fa(o["!ref"]),P=[],K=[],W=[];for(E=0;E<=I.e.c-I.s.c;++E){for(var me="",re="",De=0,be=[],v=0;v<x.length;++v)x[v][E]!=null&&be.push(x[v][E]);if(be.length!=0&&h[E]!=null){for(v=0;v<be.length;++v){switch(typeof be[v]){case"number":re="B";break;case"string":re="C";break;case"boolean":re="L";break;case"object":re=be[v]instanceof Date?"D":"C";break;default:re="C"}De=Math.max(De,String(be[v]).length),me=me&&me!=re?"C":re}250<De&&(De=250),(re=((w[E]||{}).DBF||{}).type)=="C"&&w[E].DBF.len>De&&(De=w[E].DBF.len),me=="B"&&re=="N"&&(me="N",W[E]=w[E].DBF.dec,De=w[E].DBF.len),K[E]=me=="C"||re=="N"?De:ct[me]||0,S+=K[E],P[E]=me}else P[E]="?"}var ce,Ee,Ue=d.next(32);for(Ue.write_shift(4,318902576),Ue.write_shift(4,x.length),Ue.write_shift(2,296+32*N),Ue.write_shift(2,S),E=0;E<4;++E)Ue.write_shift(4,0);for(Ue.write_shift(4,0|(+Dt[f]||3)<<8),v=E=0;E<h.length;++E)h[E]!=null&&(ce=d.next(32),Ee=(h[E].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11),ce.write_shift(1,Ee,"sbcs"),ce.write_shift(1,P[E]=="?"?"C":P[E],"sbcs"),ce.write_shift(4,v),ce.write_shift(1,K[E]||ct[P[E]]||0),ce.write_shift(1,W[E]||0),ce.write_shift(1,2),ce.write_shift(4,0),ce.write_shift(1,0),ce.write_shift(4,0),ce.write_shift(4,0),v+=K[E]||ct[P[E]]||0);var Ie=d.next(264);for(Ie.write_shift(4,13),E=0;E<65;++E)Ie.write_shift(4,0);for(E=0;E<x.length;++E){var $e=d.next(S);for($e.write_shift(1,0),v=0;v<h.length;++v)if(h[v]!=null)switch(P[v]){case"L":$e.write_shift(1,x[E][v]==null?63:x[E][v]?84:70);break;case"B":$e.write_shift(8,x[E][v]||0,"f");break;case"N":var st="0";for(typeof x[E][v]=="number"&&(st=x[E][v].toFixed(W[v]||0)),N=0;N<K[v]-st.length;++N)$e.write_shift(1,32);$e.write_shift(1,st,"sbcs");break;case"D":x[E][v]?($e.write_shift(4,("0000"+x[E][v].getFullYear()).slice(-4),"sbcs"),$e.write_shift(2,("00"+(x[E][v].getMonth()+1)).slice(-2),"sbcs"),$e.write_shift(2,("00"+x[E][v].getDate()).slice(-2),"sbcs")):$e.write_shift(8,"00000000","sbcs");break;case"C":var rt=String(x[E][v]!=null?x[E][v]:"").slice(0,K[v]);for($e.write_shift(1,rt,"sbcs"),N=0;N<K[v]-rt.length;++N)$e.write_shift(1,32)}}return d.next(1).write_shift(1,26),d.end()}});function Xt(o,A){return A=A||{},A.dateNF||(A.dateNF="yyyymmdd"),o=wi((function(d,h){var x=[],w=se(1);switch(h.type){case"base64":w=ae(Q(d));break;case"binary":w=ae(d);break;case"buffer":case"array":w=d}_s(w,0);var v=w.read_shift(1),N=!!(136&v),S=!1,E=!1;switch(v){case 2:case 3:break;case 48:case 49:N=S=!0;break;case 131:case 139:break;case 140:E=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var I=0,P=521;v==2&&(I=w.read_shift(2)),w.l+=3,1048576<(I=v!=2?w.read_shift(4):I)&&(I=1e6),v!=2&&(P=w.read_shift(2));var K=w.read_shift(2),W=h.codepage||1252;v!=2&&(w.l+=16,w.read_shift(1),w[w.l]!==0&&(W=ot[w[w.l]]),w.l+=1,w.l+=2),E&&(w.l+=36);for(var me=[],re={},De=Math.min(w.length,v==2?521:P-10-(S?264:0)),be=E?32:11;w.l<De&&w[w.l]!=13;)switch((re={}).name=e.utils.decode(W,w.slice(w.l,w.l+be)).replace(/[\u0000\r\n].*$/g,""),w.l+=be,re.type=String.fromCharCode(w.read_shift(1)),v==2||E||(re.offset=w.read_shift(4)),re.len=w.read_shift(1),v==2&&(re.offset=w.read_shift(2)),re.dec=w.read_shift(1),re.name.length&&me.push(re),v!=2&&(w.l+=E?13:14),re.type){case"B":S&&re.len==8||!h.WTF||console.log("Skipping "+re.name+":"+re.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+re.name+":"+re.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+re.type)}if(w[w.l]!==13&&(w.l=P-1),w.read_shift(1)!==13)throw new Error("DBF Terminator not found "+w.l+" "+w[w.l]);w.l=P;var ce=0,Ee=0;for(x[0]=[],Ee=0;Ee!=me.length;++Ee)x[0][Ee]=me[Ee].name;for(;0<I--;)if(w[w.l]!==42)for(++w.l,x[++ce]=[],Ee=Ee=0;Ee!=me.length;++Ee){var Ue=w.slice(w.l,w.l+me[Ee].len);w.l+=me[Ee].len,_s(Ue,0);var Ie=e.utils.decode(W,Ue);switch(me[Ee].type){case"C":Ie.trim().length&&(x[ce][Ee]=Ie.replace(/\s+$/,""));break;case"D":Ie.length===8?x[ce][Ee]=new Date(+Ie.slice(0,4),+Ie.slice(4,6)-1,+Ie.slice(6,8)):x[ce][Ee]=Ie;break;case"F":x[ce][Ee]=parseFloat(Ie.trim());break;case"+":case"I":x[ce][Ee]=E?2147483648^Ue.read_shift(-4,"i"):Ue.read_shift(4,"i");break;case"L":switch(Ie.trim().toUpperCase()){case"Y":case"T":x[ce][Ee]=!0;break;case"N":case"F":x[ce][Ee]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Ie+"|")}break;case"M":if(!N)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));x[ce][Ee]="##MEMO##"+(E?parseInt(Ie.trim(),10):Ue.read_shift(4));break;case"N":(Ie=Ie.replace(/\u0000/g,"").trim())&&Ie!="."&&(x[ce][Ee]=+Ie||0);break;case"@":x[ce][Ee]=new Date(Ue.read_shift(-8,"f")-621356832e5);break;case"T":x[ce][Ee]=new Date(864e5*(Ue.read_shift(4)-2440588)+Ue.read_shift(4));break;case"Y":x[ce][Ee]=Ue.read_shift(4,"i")/1e4+Ue.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":x[ce][Ee]=-Ue.read_shift(-8,"f");break;case"B":if(S&&me[Ee].len==8){x[ce][Ee]=Ue.read_shift(8,"f");break}case"G":case"P":Ue.l+=me[Ee].len;break;case"0":if(me[Ee].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+me[Ee].type)}}else w.l+=K;if(v!=2&&w.l<w.length&&w[w.l++]!=26)throw new Error("DBF EOF Marker missing "+(w.l-1)+" of "+w.length+" "+w[w.l-1].toString(16));return h&&h.sheetRows&&(x=x.slice(0,h.sheetRows)),h.DBF=me,x})(o,A),A),o["!cols"]=A.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete A.DBF,o}var Kt,Vr,Tr,ka,zr=(Kt={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},Vr=new RegExp("\x1BN("+hs(Kt).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),Tr=function(o,A){return A=Kt[A],typeof A=="number"?T(A):A},ka=function(o,A,d){return d=A.charCodeAt(0)-32<<4|d.charCodeAt(0)-48,d==59?o:T(d)},Kt["|"]=254,{to_workbook:function(o,A){return ki(nn(o,A),A)},to_sheet:nn,from_sheet:function(o,A){var d,h,x=["ID;PWXL;N;E"],w=[],v=Fa(o["!ref"]),N=Array.isArray(o),S=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),o["!cols"]&&(d=x,o["!cols"].forEach(function(K,W){W="F;W"+(W+1)+" "+(W+1)+" ",K.hidden?W+="0":(typeof K.width!="number"||K.wpx||(K.wpx=Qd(K.width)),typeof K.wpx!="number"||K.wch||(K.wch=jc(K.wpx)),typeof K.wch=="number"&&(W+=Math.round(K.wch))),W.charAt(W.length-1)!=" "&&d.push(W)})),o["!rows"]&&(h=x,o["!rows"].forEach(function(K,W){var me="F;";K.hidden?me+="M0;":K.hpt?me+="M"+20*K.hpt+";":K.hpx&&(me+="M"+20*jf(K.hpx)+";"),2<me.length&&h.push(me+"R"+(W+1))})),x.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var E=v.s.r;E<=v.e.r;++E)for(var I=v.s.c;I<=v.e.c;++I){var P=ha({r:E,c:I});(P=N?(o[E]||[])[I]:o[P])&&(P.v!=null||P.f&&!P.F)&&w.push((function(K,W,me){var re="C;Y"+(W+1)+";X"+(me+1)+";K";switch(K.t){case"n":re+=K.v||0,K.f&&!K.F&&(re+=";E"+Hh(K.f,{r:W,c:me}));break;case"b":re+=K.v?"TRUE":"FALSE";break;case"e":re+=K.w||K.v;break;case"d":re+='"'+(K.w||K.v)+'"';break;case"s":re+='"'+K.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return re})(P,E,I))}return x.join(S)+S+w.join(S)+S+"E"+S}});function Ka(K,A){var d,h,x=K.split(/[\n\r]+/),w=-1,v=-1,N=0,S=0,E=[],I=[],P=null,K={},W=[],me=[],re=0;for(0<=+A.codepage&&j(+A.codepage);N!==x.length;++N){re=0;var De,be=x[N].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,ka).replace(Vr,Tr),ce=be.replace(/;;/g,"\0").split(";").map(function(Zt){return Zt.replace(/\u0000/g,";")}),Ee=ce[0];if(0<be.length)switch(Ee){case"ID":case"E":case"B":case"O":case"W":break;case"P":ce[1].charAt(0)=="P"&&I.push(be.slice(3).replace(/;;/g,";"));break;case"C":for(var Ue=!1,Ie=!1,$e=!1,st=!1,rt=-1,mt=-1,S=1;S<ce.length;++S)switch(ce[S].charAt(0)){case"A":break;case"X":v=parseInt(ce[S].slice(1))-1,Ie=!0;break;case"Y":for(w=parseInt(ce[S].slice(1))-1,Ie||(v=0),h=E.length;h<=w;++h)E[h]=[];break;case"K":(De=ce[S].slice(1)).charAt(0)==='"'?De=De.slice(1,De.length-1):De==="TRUE"?De=!0:De==="FALSE"?De=!1:isNaN(gi(De))?isNaN(Fi(De).getDate())||(De=ba(De)):(De=gi(De),P!==null&&Mr(P)&&(De=_n(De))),e!==void 0&&typeof De=="string"&&(A||{}).type!="string"&&(A||{}).codepage&&(De=e.utils.decode(A.codepage,De)),Ue=!0;break;case"E":st=!0;var Mt=Tu(ce[S].slice(1),{r:w,c:v});E[w][v]=[E[w][v],Mt];break;case"S":$e=!0,E[w][v]=[E[w][v],"S5S"];break;case"G":break;case"R":rt=parseInt(ce[S].slice(1))-1;break;case"C":mt=parseInt(ce[S].slice(1))-1;break;default:if(A&&A.WTF)throw new Error("SYLK bad record "+be)}if(Ue&&(E[w][v]&&E[w][v].length==2?E[w][v][0]=De:E[w][v]=De,P=null),$e){if(st)throw new Error("SYLK shared formula cannot have own formula");var Qt=-1<rt&&E[rt][mt];if(!Qt||!Qt[1])throw new Error("SYLK shared formula cannot find base");E[w][v][1]=_0(Qt[1],{r:w-rt,c:v-mt})}break;case"F":var vt=0;for(S=1;S<ce.length;++S)switch(ce[S].charAt(0)){case"X":v=parseInt(ce[S].slice(1))-1,++vt;break;case"Y":for(w=parseInt(ce[S].slice(1))-1,h=E.length;h<=w;++h)E[h]=[];break;case"M":re=parseInt(ce[S].slice(1))/20;break;case"F":case"G":break;case"P":P=I[parseInt(ce[S].slice(1))];break;case"S":case"D":case"N":break;case"W":for(d=ce[S].slice(1).split(" "),h=parseInt(d[0],10);h<=parseInt(d[1],10);++h)re=parseInt(d[2],10),me[h-1]=re===0?{hidden:!0}:{wch:re},Rd(me[h-1]);break;case"C":me[v=parseInt(ce[S].slice(1))-1]||(me[v]={});break;case"R":W[w=parseInt(ce[S].slice(1))-1]||(W[w]={}),0<re?(W[w].hpt=re,W[w].hpx=Du(re)):re===0&&(W[w].hidden=!0);break;default:if(A&&A.WTF)throw new Error("SYLK bad record "+be)}vt<1&&(P=null);break;default:if(A&&A.WTF)throw new Error("SYLK bad record "+be)}}return 0<W.length&&(K["!rows"]=W),0<me.length&&(K["!cols"]=me),[E=A&&A.sheetRows?E.slice(0,A.sheetRows):E,K]}function nn(h,A){var d=(function(v,N){switch(N.type){case"base64":return Ka(Q(v),N);case"binary":return Ka(v,N);case"buffer":return Ka(Z&&Buffer.isBuffer(v)?v.toString("binary"):z(v),N);case"array":return Ka(Cn(v),N)}throw new Error("Unrecognized type "+N.type)})(h,A),h=d[0],x=d[1],w=wi(h,A);return hs(x).forEach(function(v){w[v]=x[v]}),w}var La={to_workbook:function(o,A){return ki(xr(o,A),A)},to_sheet:xr,from_sheet:function(o){var A=[],d=Fa(o["!ref"]),h=Array.isArray(o);on(A,"TABLE",0,1,"sheetjs"),on(A,"VECTORS",0,d.e.r-d.s.r+1,""),on(A,"TUPLES",0,d.e.c-d.s.c+1,""),on(A,"DATA",0,0,"");for(var x=d.s.r;x<=d.e.r;++x){sa(A,-1,0,"BOT");for(var w=d.s.c;w<=d.e.c;++w){var v,N=ha({r:x,c:w});if(v=h?(o[x]||[])[w]:o[N])switch(v.t){case"n":var S=v.w;(S=!S&&v.v!=null?v.v:S)==null?v.f&&!v.F?sa(A,1,0,"="+v.f):sa(A,1,0,""):sa(A,0,S,"V");break;case"b":sa(A,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":sa(A,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=pr(v.z||X[14],ms(ba(v.v)))),sa(A,0,v.w,"V");break;default:sa(A,1,0,"")}else sa(A,1,0,"")}}return sa(A,-1,0,"EOD"),A.join(`\r
`)}};function Er(o,A){for(var d=o.split(`
`),h=-1,x=-1,w=0,v=[];w!==d.length;++w)if(d[w].trim()!=="BOT"){if(!(h<0)){for(var N=d[w].trim().split(","),S=N[0],E=N[1],I=d[++w]||"";1&(I.match(/["]/g)||[]).length&&w<d.length-1;)I+=`
`+d[++w];switch(I=I.trim(),+S){case-1:if(I==="BOT"){v[++h]=[],x=0;continue}if(I!=="EOD")throw new Error("Unrecognized DIF special command "+I);break;case 0:I==="TRUE"?v[h][x]=!0:I==="FALSE"?v[h][x]=!1:isNaN(gi(E))?isNaN(Fi(E).getDate())?v[h][x]=E:v[h][x]=ba(E):v[h][x]=gi(E),++x;break;case 1:I=(I=I.slice(1,I.length-1)).replace(/""/g,'"'),I&&I.match(/^=".*"$/)&&(I=I.slice(2,-1)),v[h][x++]=I!==""?I:null}if(I==="EOD")break}}else v[++h]=[],x=0;return v=A&&A.sheetRows?v.slice(0,A.sheetRows):v}function xr(o,A){return wi((function(d,h){switch(h.type){case"base64":return Er(Q(d),h);case"binary":return Er(d,h);case"buffer":return Er(Z&&Buffer.isBuffer(d)?d.toString("binary"):z(d),h);case"array":return Er(Cn(d),h)}throw new Error("Unrecognized type "+h.type)})(o,A),A)}function on(o,A,d,h,x){o.push(A),o.push(d+","+h),o.push('"'+x.replace(/"/g,'""')+'"')}function sa(o,A,d,h){o.push(A+","+d),o.push(A==1?'"'+h.replace(/"/g,'""')+'"':h)}var Ia,ks,di,Li,qs=(Ia=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),ks=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,di=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),Li="--SocialCalcSpreadsheetControlSave--",{to_workbook:function(o,A){return ki(Ji(o,A),A)},to_sheet:Ji,from_sheet:function(o){return[Ia,ks,di,ks,(function(A){if(!A||!A["!ref"])return"";for(var d,h,x=[],w=[],v=vi(A["!ref"]),N=Array.isArray(A),S=v.s.r;S<=v.e.r;++S)for(var E=v.s.c;E<=v.e.c;++E)if(h=ha({r:S,c:E}),(d=N?(A[S]||[])[E]:A[h])&&d.v!=null&&d.t!=="z"){switch(w=["cell",h,"t"],d.t){case"s":case"str":w.push(Vn(d.v));break;case"n":d.f?(w[2]="vtf",w[3]="n",w[4]=d.v,w[5]=Vn(d.f)):(w[2]="v",w[3]=d.v);break;case"b":w[2]="vt"+(d.f?"f":"c"),w[3]="nl",w[4]=d.v?"1":"0",w[5]=Vn(d.f||(d.v?"TRUE":"FALSE"));break;case"d":var I=ms(ba(d.v));w[2]="vtc",w[3]="nd",w[4]=""+I,w[5]=d.w||pr(d.z||X[14],I);break;case"e":continue}x.push(w.join(":"))}return x.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)})(o),Li].join(`
`)}});function Vn(o){return o.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function Ji(o,A){return wi((function(d,h){for(var x,w=d.split(`
`),v=-1,N=0,S=[];N!==w.length;++N){var E=w[N].trim().split(":");if(E[0]==="cell"){var I=Es(E[1]);if(S.length<=I.r)for(v=S.length;v<=I.r;++v)S[v]||(S[v]=[]);switch(v=I.r,x=I.c,E[2]){case"t":S[v][x]=E[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`);break;case"v":S[v][x]=+E[3];break;case"vtf":var P=E[E.length-1];case"vtc":E[3]==="nl"?S[v][x]=!!+E[4]:S[v][x]=+E[4],E[2]=="vtf"&&(S[v][x]=[S[v][x],P])}}}return S=h&&h.sheetRows?S.slice(0,h.sheetRows):S})(o,A),A)}var Yn,Qa,qa=(Yn={44:",",9:"	",59:";",124:"|"},Qa={44:3,9:2,59:1,124:0},{to_workbook:function(o,A){return ki(gs(o,A),A)},to_sheet:gs,from_sheet:function(o){for(var A=[],d=Fa(o["!ref"]),h=Array.isArray(o),x=d.s.r;x<=d.e.r;++x){for(var w=[],v=d.s.c;v<=d.e.c;++v){var N=ha({r:x,c:v});if((N=h?(o[x]||[])[v]:o[N])&&N.v!=null){for(var S=(N.w||(Lo(N),N.w)||"").slice(0,10);S.length<10;)S+=" ";w.push(S+(v===0?" ":""))}else w.push("          ")}A.push(w.join(""))}return A.join(`
`)}});function Fn(o,A,d,h,x){x.raw?A[d][h]=o:o===""||(o==="TRUE"?A[d][h]=!0:o==="FALSE"?A[d][h]=!1:isNaN(gi(o))?isNaN(Fi(o).getDate())?A[d][h]=o:A[d][h]=ba(o):A[d][h]=gi(o))}function vs(o){for(var A={},d=!1,h=0,x=0;h<o.length;++h)(x=o.charCodeAt(h))==34?d=!d:!d&&x in Yn&&(A[x]=(A[x]||0)+1);for(h in x=[],A)Object.prototype.hasOwnProperty.call(A,h)&&x.push([A[h],h]);if(!x.length)for(h in A=Qa)Object.prototype.hasOwnProperty.call(A,h)&&x.push([A[h],h]);return x.sort(function(w,v){return w[0]-v[0]||Qa[w[1]]-Qa[v[1]]}),Yn[x.pop()[1]]||44}function Ni(o,h){var d=h||{},h="",x=d.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};o.slice(0,4)=="sep="?o.charCodeAt(5)==13&&o.charCodeAt(6)==10?(h=o.charAt(4),o=o.slice(7)):o.charCodeAt(5)==13||o.charCodeAt(5)==10?(h=o.charAt(4),o=o.slice(6)):h=vs(o.slice(0,1024)):h=d&&d.FS?d.FS:vs(o.slice(0,1024));var v=0,N=0,S=0,E=0,I=0,P=h.charCodeAt(0),K=!1,W=0,me=o.charCodeAt(0);o=o.replace(/\r\n/gm,`
`);var re=d.dateNF!=null?(h=(h=typeof(h=d.dateNF)=="number"?X[h]:h).replace(Rs,"(\\d+)"),new RegExp("^"+h+"$")):null;function De(){var be,ce=o.slice(E,I),Ee={};if((ce=ce.charAt(0)=='"'&&ce.charAt(ce.length-1)=='"'?ce.slice(1,-1).replace(/""/g,'"'):ce).length===0?Ee.t="z":d.raw||ce.trim().length===0?(Ee.t="s",Ee.v=ce):ce.charCodeAt(0)==61?ce.charCodeAt(1)==34&&ce.charCodeAt(ce.length-1)==34?(Ee.t="s",Ee.v=ce.slice(2,-1).replace(/""/g,'"')):ce.length!=1?(Ee.t="n",Ee.f=ce.slice(1)):(Ee.t="s",Ee.v=ce):ce=="TRUE"?(Ee.t="b",Ee.v=!0):ce=="FALSE"?(Ee.t="b",Ee.v=!1):isNaN(S=gi(ce))?!isNaN(Fi(ce).getDate())||re&&ce.match(re)?(Ee.z=d.dateNF||X[14],be=0,re&&ce.match(re)&&(ce=(function(Ue,Ie){var $e=-1,st=-1,rt=-1,mt=-1,Mt=-1,Qt=-1;(Ue.match(Rs)||[]).forEach(function(Zt,Br){var wr=parseInt(Ie[Br+1],10);switch(Zt.toLowerCase().charAt(0)){case"y":$e=wr;break;case"d":rt=wr;break;case"h":mt=wr;break;case"s":Qt=wr;break;case"m":0<=mt?Mt=wr:st=wr}}),0<=Qt&&Mt==-1&&0<=st&&(Mt=st,st=-1);var vt=(""+(0<=$e?$e:new Date().getFullYear())).slice(-4)+"-"+("00"+(1<=st?st:1)).slice(-2)+"-"+("00"+(1<=rt?rt:1)).slice(-2);return(vt=vt.length==7?"0"+vt:vt).length==8&&(vt="20"+vt),Ue=("00"+(0<=mt?mt:0)).slice(-2)+":"+("00"+(0<=Mt?Mt:0)).slice(-2)+":"+("00"+(0<=Qt?Qt:0)).slice(-2),mt==-1&&Mt==-1&&Qt==-1?vt:$e==-1&&st==-1&&rt==-1?Ue:vt+"T"+Ue})(d.dateNF,ce.match(re)||[]),be=1),d.cellDates?(Ee.t="d",Ee.v=ba(ce,be)):(Ee.t="n",Ee.v=ms(ba(ce,be))),d.cellText!==!1&&(Ee.w=pr(Ee.z,Ee.v instanceof Date?ms(Ee.v):Ee.v)),d.cellNF||delete Ee.z):(Ee.t="s",Ee.v=ce):(!(Ee.t="n")!==d.cellText&&(Ee.w=ce),Ee.v=S),Ee.t=="z"||(d.dense?(x[v]||(x[v]=[]),x[v][N]=Ee):x[ha({c:N,r:v})]=Ee),E=I+1,me=o.charCodeAt(E),w.e.c<N&&(w.e.c=N),w.e.r<v&&(w.e.r=v),W!=P)return N=0,++v,d.sheetRows&&d.sheetRows<=v?1:void 0;++N}e:for(;I<o.length;++I)switch(W=o.charCodeAt(I)){case 34:me===34&&(K=!K);break;case P:case 10:case 13:if(!K&&De())break e}return 0<I-E&&De(),x["!ref"]=fa(w),x}function On(o,A){return!A||!A.PRN||A.FS||o.slice(0,4)=="sep="||0<=o.indexOf("	")||0<=o.indexOf(",")||0<=o.indexOf(";")?Ni(o,A):wi((function(d,h){var x=h||{},w=[];if(!d||d.length===0)return w;for(var v=d.split(/[\r\n]/),N=v.length-1;0<=N&&v[N].length===0;)--N;for(var S=10,E=0,I=0;I<=N;++I)(E=v[I].indexOf(" "))==-1?E=v[I].length:E++,S=Math.max(S,E);for(I=0;I<=N;++I){w[I]=[];var P=0;for(Fn(v[I].slice(0,S).trim(),w,I,P,x),P=1;P<=(v[I].length-S)/10+1;++P)Fn(v[I].slice(S+10*(P-1),S+10*P).trim(),w,I,P,x)}return w=x.sheetRows?w.slice(0,x.sheetRows):w})(o,A),A)}function gs(o,A){var d="",h=A.type=="string"?[0,0,0,0]:i1(o,A);switch(A.type){case"base64":d=Q(o);break;case"binary":d=o;break;case"buffer":d=A.codepage==65001?o.toString("utf8"):A.codepage&&e!==void 0?e.utils.decode(A.codepage,o):Z&&Buffer.isBuffer(o)?o.toString("binary"):z(o);break;case"array":d=Cn(o);break;case"string":d=o;break;default:throw new Error("Unrecognized type "+A.type)}return h[0]==239&&h[1]==187&&h[2]==191?d=cs(d.slice(3)):A.type!="string"&&A.type!="buffer"&&A.codepage==65001?d=cs(d):A.type=="binary"&&e!==void 0&&A.codepage&&(d=e.utils.decode(A.codepage,e.utils.encode(28591,d))),d.slice(0,19)=="socialcalc:version:"?qs.to_sheet(A.type=="string"?d:cs(d),A):On(d,A)}var En,Ds,Wn,ai,xs=(En={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},Ds=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""],Wn={0:{n:"BOF",f:$s},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(o,A,d){var h={s:{c:0,r:0},e:{c:0,r:0}};return A==8&&d.qpro?(h.s.c=o.read_shift(1),o.l++,h.s.r=o.read_shift(2),h.e.c=o.read_shift(1),o.l++,h.e.r=o.read_shift(2)):(h.s.c=o.read_shift(2),h.s.r=o.read_shift(2),A==12&&d.qpro&&(o.l+=2),h.e.c=o.read_shift(2),h.e.r=o.read_shift(2),A==12&&d.qpro&&(o.l+=2),h.s.c==65535&&(h.s.c=h.e.c=h.s.r=h.e.r=0)),h}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(o,A,d){return(d=bn(o,0,d))[1].v=o.read_shift(2,"i"),d}},14:{n:"NUMBER",f:function(o,A,d){return(d=bn(o,0,d))[1].v=o.read_shift(8,"f"),d}},15:{n:"LABEL",f:da},16:{n:"FORMULA",f:function(o,A,d){var h=o.l+A;return(A=bn(o,0,d))[1].v=o.read_shift(8,"f"),d.qpro?o.l=h:(h=o.read_shift(2),(function(x,w){_s(x,0);for(var v=[],N=0,S="",E="",I="",P="";x.l<x.length;){var K=x[x.l++];switch(K){case 0:v.push(x.read_shift(8,"f"));break;case 1:E=ia(w[0].c,x.read_shift(2),!0),S=ia(w[0].r,x.read_shift(2),!1),v.push(E+S);break;case 2:var W=ia(w[0].c,x.read_shift(2),!0),me=ia(w[0].r,x.read_shift(2),!1);E=ia(w[0].c,x.read_shift(2),!0),S=ia(w[0].r,x.read_shift(2),!1),v.push(W+me+":"+E+S);break;case 3:if(x.l<x.length)return console.error("WK1 premature formula end");break;case 4:v.push("("+v.pop()+")");break;case 5:v.push(x.read_shift(2));break;case 6:for(var re="";K=x[x.l++];)re+=String.fromCharCode(K);v.push('"'+re.replace(/"/g,'""')+'"');break;case 8:v.push("-"+v.pop());break;case 23:v.push("+"+v.pop());break;case 22:v.push("NOT("+v.pop()+")");break;case 20:case 21:P=v.pop(),I=v.pop(),v.push(["AND","OR"][K-20]+"("+I+","+P+")");break;default:if(K<32&&Ds[K])P=v.pop(),I=v.pop(),v.push(I+Ds[K]+P);else{if(!En[K])return K<=7?console.error("WK1 invalid opcode "+K.toString(16)):K<=24?console.error("WK1 unsupported op "+K.toString(16)):K<=30?console.error("WK1 invalid opcode "+K.toString(16)):K<=115?console.error("WK1 unsupported function opcode "+K.toString(16)):console.error("WK1 unrecognized opcode "+K.toString(16));if((N=(N=En[K][1])==69?x[x.l++]:N)>v.length)return console.error("WK1 bad formula parse 0x"+K.toString(16)+":|"+v.join("|")+"|");me=v.slice(-N),v.length-=N,v.push(En[K][0]+"("+me.join(",")+")")}}}v.length==1?w[1].f=""+v[0]:console.error("WK1 bad formula parse |"+v.join("|")+"|")})(o.slice(o.l,o.l+h),A),o.l+=h),A}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:da},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:po},222:{n:"SHEETNAMELP",f:function(o,A){var d=o[o.l++];A-1<d&&(d=A-1);for(var h="";h.length<d;)h+=String.fromCharCode(o[o.l++]);return h}},65535:{n:""}},ai={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(o,A){var d=ts(o);return d[1].t="s",d[1].v=o.read_shift(A-4,"cstr"),d}},23:{n:"NUMBER17",f:Fo},24:{n:"NUMBER18",f:function(o,A){var d=ts(o);d[1].v=o.read_shift(2);var h=d[1].v>>1;if(1&d[1].v)switch(7&h){case 0:h=5e3*(h>>3);break;case 1:h=500*(h>>3);break;case 2:h=(h>>3)/20;break;case 3:h=(h>>3)/200;break;case 4:h=(h>>3)/2e3;break;case 5:h=(h>>3)/2e4;break;case 6:h=(h>>3)/16;break;case 7:h=(h>>3)/64}return d[1].v=h,d}},25:{n:"FORMULA19",f:function(o,A){var d=Fo(o);return o.l+=A-14,d}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(o,A){for(var d={},h=o.l+A;o.l<h;){var x=o.read_shift(2);if(x==14e3){for(d[x]=[0,""],d[x][0]=o.read_shift(2);o[o.l];)d[x][1]+=String.fromCharCode(o[o.l]),o.l++;o.l++}}return d}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(h,A){var d=ts(h),h=h.read_shift(4);return d[1].v=h>>6,d}},38:{n:"??"},39:{n:"NUMBER27",f:ll},40:{n:"FORMULA28",f:function(o,A){var d=ll(o);return o.l+=A-10,d}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:po},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(o,A,d){if(d.qpro&&!(A<21))return d=o.read_shift(1),o.l+=17,o.l+=1,o.l+=2,[d,o.read_shift(A-21,"cstr")]}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},{sheet_to_wk1:function(o,A){var d=A||{};if(0<=+d.codepage&&j(+d.codepage),d.type=="string")throw new Error("Cannot write WK1 to JS string");var h=In(),x=Fa(o["!ref"]),w=Array.isArray(o),v=[];br(h,0,(A=1030,(d=Ft(2)).write_shift(2,A),d)),br(h,6,(A=x,(d=Ft(8)).write_shift(2,A.s.c),d.write_shift(2,A.s.r),d.write_shift(2,A.e.c),d.write_shift(2,A.e.r),d));for(var N,S,E,I,P=Math.min(x.e.r,8191),K=x.s.r;K<=P;++K)for(var W=Vs(K),me=x.s.c;me<=x.e.c;++me){K===x.s.r&&(v[me]=Sa(me));var re=v[me]+W,re=w?(o[K]||[])[me]:o[re];re&&re.t!="z"&&(re.t=="n"?(0|re.v)==re.v&&-32768<=re.v&&re.v<=32767?br(h,13,(N=K,S=me,E=re.v,I=void 0,(I=Ft(7)).write_shift(1,255),I.write_shift(2,S),I.write_shift(2,N),I.write_shift(2,E,"i"),I)):br(h,14,(S=K,N=me,E=re.v,I=void 0,(I=Ft(13)).write_shift(1,255),I.write_shift(2,N),I.write_shift(2,S),I.write_shift(8,E,"f"),I)):br(h,15,(function(De,be,ce){var Ee=Ft(7+ce.length);Ee.write_shift(1,255),Ee.write_shift(2,be),Ee.write_shift(2,De),Ee.write_shift(1,39);for(var Ue=0;Ue<Ee.length;++Ue){var Ie=ce.charCodeAt(Ue);Ee.write_shift(1,128<=Ie?95:Ie)}return Ee.write_shift(1,0),Ee})(K,me,Lo(re).slice(0,239))))}return br(h,1),h.end()},book_to_wk3:function(o,A){if(0<=+(A=A||{}).codepage&&j(+A.codepage),A.type=="string")throw new Error("Cannot write WK3 to JS string");var d=In();br(d,0,(function(re){var De=Ft(26);De.write_shift(2,4096),De.write_shift(2,4),De.write_shift(4,0);for(var be=0,ce=0,Ee=0,Ue=0;Ue<re.SheetNames.length;++Ue){var Ie=re.SheetNames[Ue],Ie=re.Sheets[Ie];Ie&&Ie["!ref"]&&(++Ee,Ie=vi(Ie["!ref"]),be<Ie.e.r&&(be=Ie.e.r),ce<Ie.e.c&&(ce=Ie.e.c))}return 8191<be&&(be=8191),De.write_shift(2,be),De.write_shift(1,Ee),De.write_shift(1,ce),De.write_shift(2,0),De.write_shift(2,0),De.write_shift(1,1),De.write_shift(1,2),De.write_shift(4,0),De.write_shift(4,0),De})(o));for(var h=0,x=0;h<o.SheetNames.length;++h)(o.Sheets[o.SheetNames[h]]||{})["!ref"]&&br(d,27,(function(re,De){var be=Ft(5+re.length);be.write_shift(2,14e3),be.write_shift(2,De);for(var ce=0;ce<re.length;++ce){var Ee=re.charCodeAt(ce);be[be.l++]=127<Ee?95:Ee}return be[be.l++]=0,be})(o.SheetNames[h],x++));for(var w=0,h=0;h<o.SheetNames.length;++h){var v=o.Sheets[o.SheetNames[h]];if(v&&v["!ref"]){for(var N=Fa(v["!ref"]),S=Array.isArray(v),E=[],I=Math.min(N.e.r,8191),P=N.s.r;P<=I;++P)for(var K=Vs(P),W=N.s.c;W<=N.e.c;++W){P===N.s.r&&(E[W]=Sa(W));var me=E[W]+K,me=S?(v[P]||[])[W]:v[me];me&&me.t!="z"&&(me.t=="n"?br(d,23,(function($e,rt,st,Ee){var Ue=Ft(14);if(Ue.write_shift(2,$e),Ue.write_shift(1,st),Ue.write_shift(1,rt),Ee==0)return Ue.write_shift(4,0),Ue.write_shift(4,0),Ue.write_shift(2,65535),Ue;var Ie=0,$e=0,st=0,rt=0;return Ee<0&&(Ie=1,Ee=-Ee),$e=0|Math.log2(Ee),Ee/=Math.pow(2,$e-31),(2147483648&(rt=Ee>>>0))==0&&(++$e,rt=(Ee/=2)>>>0),Ee-=rt,rt|=2147483648,rt>>>=0,Ee*=Math.pow(2,32),st=Ee>>>0,Ue.write_shift(4,st),Ue.write_shift(4,rt),$e+=16383+(Ie?32768:0),Ue.write_shift(2,$e),Ue})(P,W,w,me.v)):br(d,22,(function(De,be,ce,Ee){var Ue=Ft(6+Ee.length);Ue.write_shift(2,De),Ue.write_shift(1,ce),Ue.write_shift(1,be),Ue.write_shift(1,39);for(var Ie=0;Ie<Ee.length;++Ie){var $e=Ee.charCodeAt(Ie);Ue.write_shift(1,128<=$e?95:$e)}return Ue.write_shift(1,0),Ue})(P,W,w,Lo(me).slice(0,239))))}++w}}return br(d,1),d.end()},to_workbook:function(o,A){switch(A.type){case"base64":return Ui(ae(Q(o)),A);case"binary":return Ui(ae(o),A);case"buffer":case"array":return Ui(o,A)}throw"Unsupported type "+A.type}});function As(o,A,d){if(o){_s(o,o.l||0);for(var h=d.Enum||Wn;o.l<o.length;){var x=o.read_shift(2),w=h[x]||h[65535],N=o.read_shift(2),v=o.l+N,N=w.f&&w.f(o,N,d);if(o.l=v,A(N,w,x))return}}}function Ui(o,A){if(!o)return o;var d=A||{},h=d.dense?[]:{},x="Sheet1",w="",v=0,N={},S=[],E=[],I={s:{r:0,c:0},e:{r:0,c:0}},P=d.sheetRows||0;if(o[2]==0&&(o[3]==8||o[3]==9)&&16<=o.length&&o[14]==5&&o[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(o[2]==2)d.Enum=Wn,As(o,function(re,De,be){switch(be){case 0:4096<=(d.vers=re)&&(d.qpro=!0);break;case 6:I=re;break;case 204:re&&(w=re);break;case 222:w=re;break;case 15:case 51:d.qpro||(re[1].v=re[1].v.slice(1));case 13:case 14:case 16:be==14&&(112&re[2])==112&&1<(15&re[2])&&(15&re[2])<15&&(re[1].z=d.dateNF||X[14],d.cellDates&&(re[1].t="d",re[1].v=_n(re[1].v))),d.qpro&&re[3]>v&&(h["!ref"]=fa(I),N[x]=h,S.push(x),h=d.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},v=re[3],x=w||"Sheet"+(v+1),w="");var ce=d.dense?(h[re[0].r]||[])[re[0].c]:h[ha(re[0])];if(ce){ce.t=re[1].t,ce.v=re[1].v,re[1].z!=null&&(ce.z=re[1].z),re[1].f!=null&&(ce.f=re[1].f);break}d.dense?(h[re[0].r]||(h[re[0].r]=[]),h[re[0].r][re[0].c]=re[1]):h[ha(re[0])]=re[1]}},d);else{if(o[2]!=26&&o[2]!=14)throw new Error("Unrecognized LOTUS BOF "+o[2]);d.Enum=ai,o[2]==14&&(d.qpro=!0,o.l=0),As(o,function(re,De,be){switch(be){case 204:x=re;break;case 22:re[1].v=re[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(re[3]>v&&(h["!ref"]=fa(I),N[x]=h,S.push(x),h=d.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},v=re[3],x="Sheet"+(v+1)),0<P&&re[0].r>=P)break;d.dense?(h[re[0].r]||(h[re[0].r]=[]),h[re[0].r][re[0].c]=re[1]):h[ha(re[0])]=re[1],I.e.c<re[0].c&&(I.e.c=re[0].c),I.e.r<re[0].r&&(I.e.r=re[0].r);break;case 27:re[14e3]&&(E[re[14e3][0]]=re[14e3][1]);break;case 1537:E[re[0]]=re[1],re[0]==v&&(x=re[1])}},d)}if(h["!ref"]=fa(I),N[w||x]=h,S.push(w||x),!E.length)return{SheetNames:S,Sheets:N};for(var K={},W=[],me=0;me<E.length;++me)N[S[me]]?(W.push(E[me]||S[me]),K[E[me]]=N[E[me]]||N[S[me]]):(W.push(E[me]),K[E[me]]={"!ref":"A1"});return{SheetNames:W,Sheets:K}}function bn(o,A,d){var h=[{c:0,r:0},{t:"n",v:0},0,0];return d.qpro&&d.vers!=20768?(h[0].c=o.read_shift(1),h[3]=o.read_shift(1),h[0].r=o.read_shift(2),o.l+=2):(h[2]=o.read_shift(1),h[0].c=o.read_shift(2),h[0].r=o.read_shift(2)),h}function da(o,x,d){var h=o.l+x,x=bn(o,0,d);return x[1].t="s",d.vers!=20768?(d.qpro&&o.l++,x[1].v=o.read_shift(h-o.l,"cstr"),x):(o.l++,h=o.read_shift(1),x[1].v=o.read_shift(h,"utf8"),x)}function ia(o,A,d){var h=32768&A;return(h?"":"$")+(d?Sa:Vs)(A=(h?o:0)+(8192<=(A&=-32769)?A-16384:A))}function ts(o){var A=[{c:0,r:0},{t:"n",v:0},0];return A[0].r=o.read_shift(2),A[3]=o[o.l++],A[0].c=o[o.l++],A}function Fo(w,A){var d=ts(w),h=w.read_shift(4),x=w.read_shift(4);if((v=w.read_shift(2))==65535)return h===0&&x===3221225472?(d[1].t="e",d[1].v=15):h===0&&x===3489660928?(d[1].t="e",d[1].v=42):d[1].v=0,d;var w=32768&v,v=(32767&v)-16446;return d[1].v=(1-2*w)*(x*Math.pow(2,32+v)+h*Math.pow(2,v)),d}function ll(h,A){var d=ts(h),h=h.read_shift(8,"f");return d[1].v=h,d}function po(o,A){return o[o.l+A-1]==0?o.read_shift(A,"cstr"):""}var si,Zc,eA,Bu,ln=(si=vl("t"),Zc=vl("rPr"),eA=/<(?:\w+:)?r>/g,Bu=/<\/(?:\w+:)?r>/,function(o){return o.replace(eA,"").split(Bu).map(v0).filter(function(A){return A.v})});function v0(o){var A=o.match(si);return A?(A={t:"s",v:ma(A[1])},o=o.match(Zc),o&&(A.s=(function(d){var h={},x=d.match(ns),w=0,v=!1;if(x)for(;w!=x.length;++w){var N=Cr(x[w]);switch(N[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!N.val)break;case"<shadow>":case"<shadow/>":h.shadow=1;break;case"</shadow>":break;case"<charset":if(N.val=="1")break;h.cp=g[parseInt(N.val,10)];break;case"<outline":if(!N.val)break;case"<outline>":case"<outline/>":h.outline=1;break;case"</outline>":break;case"<rFont":h.name=N.val;break;case"<sz":h.sz=N.val;break;case"<strike":if(!N.val)break;case"<strike>":case"<strike/>":h.strike=1;break;case"</strike>":break;case"<u":if(!N.val)break;switch(N.val){case"double":h.uval="double";break;case"singleAccounting":h.uval="single-accounting";break;case"doubleAccounting":h.uval="double-accounting"}case"<u>":case"<u/>":h.u=1;break;case"</u>":break;case"<b":if(N.val=="0")break;case"<b>":case"<b/>":h.b=1;break;case"</b>":break;case"<i":if(N.val=="0")break;case"<i>":case"<i/>":h.i=1;break;case"</i>":break;case"<color":N.rgb&&(h.color=N.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":h.family=N.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":h.valign=N.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":v=!0;break;case"</ext>":v=!1;break;default:if(N[0].charCodeAt(1)!==47&&!v)throw new Error("Unrecognized rich format "+N[0])}}return h})(o[1])),A):{t:"s",v:""}}var gf,xf=(gf=/(\r\n|\n)/g,function(o){return o.map(tA).join("")});function tA(o){var A,d,h,x=[[],o.v,[]];return o.v?(o.s&&(A=o.s,d=x[0],h=x[2],o=[],A.u&&o.push("text-decoration: underline;"),A.uval&&o.push("text-underline-style:"+A.uval+";"),A.sz&&o.push("font-size:"+A.sz+"pt;"),A.outline&&o.push("text-effect: outline;"),A.shadow&&o.push("text-shadow: auto;"),d.push('<span style="'+o.join("")+'">'),A.b&&(d.push("<b>"),h.push("</b>")),A.i&&(d.push("<i>"),h.push("</i>")),A.strike&&(d.push("<s>"),h.push("</s>")),(o=A.valign||"")=="superscript"||o=="super"?o="sup":o=="subscript"&&(o="sub"),o!=""&&(d.push("<"+o+">"),h.push("</"+o+">")),h.push("</span>")),x[0].join("")+x[1].replace(gf,"<br/>")+x[2].join("")):""}var gp=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,w0=/<(?:\w+:)?r>/,N0=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Od(o,h){var d=!h||h.cellHTML,h={};return o?(o.match(/^\s*<(?:\w+:)?t[^>]*>/)?(h.t=ma(cs(o.slice(o.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),h.r=cs(o),d&&(h.h=Gi(h.t))):o.match(w0)&&(h.r=cs(o),h.t=ma(cs((o.replace(N0,"").match(gp)||[]).join("").replace(ns,""))),d&&(h.h=xf(ln(h.r)))),h):{t:""}}var Mi=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,$n=/<(?:\w+:)?(?:si|sstItem)>/g,Su=/<\/(?:\w+:)?(?:si|sstItem)>/,vA=/^\s|\s$|[\t\n\r]/;function ZA(o,A){if(!A.bookSST)return"";var d=[Ba];d[d.length]=lr("sst",null,{xmlns:Nl[0],count:o.Count,uniqueCount:o.Unique});for(var h,x,w=0;w!=o.length;++w)o[w]!=null&&(x="<si>",(h=o[w]).r?x+=h.r:(x+="<t",h.t||(h.t=""),h.t.match(vA)&&(x+=' xml:space="preserve"'),x+=">"+Va(h.t)+"</t>"),x+="</si>",d[d.length]=x);return 2<d.length&&(d[d.length]="</sst>",d[1]=d[1].replace("/>",">")),d.join("")}var ed=function(o,A){var d=!1;return A==null&&(d=!0,A=Ft(15+4*o.t.length)),A.write_shift(1,0),Ys(o.t,A),d?A.slice(0,A.l):A};function wc(o){var A,d,h=In();Pt(h,159,(A=o,(d=d||Ft(8)).write_shift(4,A.Count),d.write_shift(4,A.Unique),d));for(var x=0;x<o.length;++x)Pt(h,19,ed(o[x]));return Pt(h,160),h.end()}function Fu(o){if(e!==void 0)return e.utils.encode(f,o);for(var A=[],d=o.split(""),h=0;h<d.length;++h)A[h]=d[h].charCodeAt(0);return A}function Ro(o,A){var d={};return d.Major=o.read_shift(2),d.Minor=o.read_shift(2),4<=A&&(o.l+=A-4),d}function bf(o){var A=[];o.l+=4;for(var d=o.read_shift(4);0<d--;)A.push((function(h){for(var w=h.read_shift(4),x=h.l+w-4,w={},v=h.read_shift(4),N=[];0<v--;)N.push({t:h.read_shift(4),v:h.read_shift(0,"lpp4")});if(w.name=h.read_shift(0,"lpp4"),w.comps=N,h.l!=x)throw new Error("Bad DataSpaceMapEntry: "+h.l+" != "+x);return w})(o));return A}function yf(o){var A,d,d=(d={},(A=o).read_shift(4),A.l+=4,d.id=A.read_shift(0,"lpp4"),d.name=A.read_shift(0,"lpp4"),d.R=Ro(A,4),d.U=Ro(A,4),d.W=Ro(A,4),d);if(d.ename=o.read_shift(0,"8lpp4"),d.blksz=o.read_shift(4),d.cmode=o.read_shift(4),o.read_shift(4)!=4)throw new Error("Bad !Primary record");return d}function Nc(o,d){var d=o.l+d,h={};h.Flags=63&o.read_shift(4),o.l+=4,h.AlgID=o.read_shift(4);var x=!1;switch(h.AlgID){case 26126:case 26127:case 26128:x=h.Flags==36;break;case 26625:x=h.Flags==4;break;case 0:x=h.Flags==16||h.Flags==4||h.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+h.AlgID}if(!x)throw new Error("Encryption Flags/AlgID mismatch");return h.AlgIDHash=o.read_shift(4),h.KeySize=o.read_shift(4),h.ProviderType=o.read_shift(4),o.l+=8,h.CSPName=o.read_shift(d-o.l>>1,"utf16le"),o.l=d,h}function vf(o,h){var d={},h=o.l+h;return o.l+=4,d.Salt=o.slice(o.l,o.l+16),o.l+=16,d.Verifier=o.slice(o.l,o.l+16),o.l+=16,o.read_shift(4),d.VerifierHash=o.slice(o.l,h),o.l=h,d}function C0(o){var A=Ro(o);switch(A.Minor){case 2:return[A.Minor,(function(x){if((63&x.read_shift(4))!=36)throw new Error("EncryptionInfo mismatch");var h=x.read_shift(4),h=Nc(x,h),x=vf(x,x.length-x.l);return{t:"Std",h,v:x}})(o)];case 3:return[A.Minor,(function(){throw new Error("File is password-protected: ECMA-376 Extensible")})()];case 4:return[A.Minor,(function(x){var h=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];x.l+=4;var x=x.read_shift(x.length-x.l,"utf8"),w={};return x.replace(ns,function(v){var N=Cr(v);switch(rn(N[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":h.forEach(function(S){w[S]=N[S]});break;case"<dataIntegrity":w.encryptedHmacKey=N.encryptedHmacKey,w.encryptedHmacValue=N.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":w.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":w.uri=N.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":w.encs.push(N);break;default:throw N[0]}}),w})(o)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+A.Minor)}function wf(o){var A,d=0,h=Fu(o),x=h.length+1,w=se(x);for(w[0]=h.length,A=1;A!=x;++A)w[A]=h[A-1];for(A=x-1;0<=A;--A)d=(((16384&d)==0?0:1)|d<<1&32767)^w[A];return 52811^d}var Eu,rA,j0,B0=(Eu=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],rA=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],j0=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],function(o){for(var A,d,h=Fu(o),x=(function(S){for(var E=rA[S.length-1],I=104,P=S.length-1;0<=P;--P)for(var K=S[P],W=0;W!=7;++W)64&K&&(E^=j0[I]),K*=2,--I;return E})(h),w=h.length,v=se(16),N=0;N!=16;++N)v[N]=0;for((1&w)==1&&(A=x>>8,v[w]=td(Eu[0],A),--w,A=255&x,o=h[h.length-1],v[w]=td(o,A));0<w;)A=x>>8,v[--w]=td(h[w],A),A=255&x,v[--w]=td(h[w],A);for(d=(w=15)-h.length;0<d;)A=x>>8,v[w]=td(Eu[d],A),--d,A=255&x,v[--w]=td(h[w],A),--w,--d;return v});function td(o,A){return 255&((A=o^A)/2|128*A)}var S0=function(o){var A=0,d=B0(o);return function(h){return h=(function(x,w,v,N,S){var E,I;for(S=S||w,N=N||B0(x),E=0;E!=w.length;++E)I=w[E],I=255&((I^=N[v])>>5|I<<3),S[E]=I,++v;return[S,v,N]})("",h,A,d),A=h[1],h[0]}};function Lh(o,A,d){return d=d||{},d.Info=o.read_shift(2),o.l-=2,d.Info===1?d.Data=(function(h){var x={},w=x.EncryptionVersionInfo=Ro(h,4);if(w.Major!=1||w.Minor!=1)throw"unrecognized version code "+w.Major+" : "+w.Minor;return x.Salt=h.read_shift(16),x.EncryptedVerifier=h.read_shift(16),x.EncryptedVerifierHash=h.read_shift(16),x})(o):d.Data=(function(h,x){var w={},v=w.EncryptionVersionInfo=Ro(h,4);if(x-=4,v.Minor!=2)throw new Error("unrecognized minor version code: "+v.Minor);if(4<v.Major||v.Major<2)throw new Error("unrecognized major version code: "+v.Major);return w.Flags=h.read_shift(4),x-=4,v=h.read_shift(4),x-=4,w.EncryptionHeader=Nc(h,v),x-=v,w.EncryptionVerifier=vf(h,x),w})(o,A),d}var wA={to_workbook:function(o,A){return ki(ku(o,A),A)},to_sheet:ku,from_sheet:function(o){for(var A=["{\\rtf1\\ansi"],d=Fa(o["!ref"]),h=Array.isArray(o),x=d.s.r;x<=d.e.r;++x){A.push("\\trowd\\trautofit1");for(var w=d.s.c;w<=d.e.c;++w)A.push("\\cellx"+(w+1));for(A.push("\\pard\\intbl"),w=d.s.c;w<=d.e.c;++w){var v=ha({r:x,c:w});(v=h?(o[x]||[])[w]:o[v])&&(v.v!=null||v.f&&!v.F)&&(A.push(" "+(v.w||(Lo(v),v.w))),A.push("\\cell"))}A.push("\\pard\\intbl\\row")}return A.join("")+"}"}};function ku(o,A){switch(A.type){case"base64":return NA(Q(o),A);case"binary":return NA(o,A);case"buffer":return NA(Z&&Buffer.isBuffer(o)?o.toString("binary"):z(o),A);case"array":return NA(Cn(o),A)}throw new Error("Unrecognized type "+A.type)}function NA(h,A){var d=(A||{}).dense?[]:{},h=h.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var x={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(w,v){Array.isArray(d)&&(d[v]=[]);for(var N,S=/\\\w+\b/g,E=0,I=-1;N=S.exec(w);)N[0]==="\\cell"&&(++I,(N=(N=w.slice(E,S.lastIndex-N[0].length))[0]==" "?N.slice(1):N).length&&(N={v:N,t:"s"},Array.isArray(d)?d[v][I]=N:d[ha({r:v,c:I})]=N)),E=S.lastIndex;I>x.e.c&&(x.e.c=I)}),d["!ref"]=fa(x),d}function Po(o){for(var A=0,d=1;A!=3;++A)d=256*d+(255<o[A]?255:o[A]<0?0:o[A]);return d.toString(16).toUpperCase().slice(1)}function Fl(o,A){return A===0?o:(o=(function(I){var h=I[0]/255,x=I[1]/255,w=I[2]/255,v=Math.max(h,x,w),N=Math.min(h,x,w),S=v-N;if(S==0)return[0,0,h];var E=0,I=0,I=S/(1<(N=v+N)?2-N:N);switch(v){case h:E=((x-w)/S+6)%6;break;case x:E=(w-h)/S+2;break;case w:E=(h-x)/S+4}return[E/6,I,N/2]})((o=(o=o).slice(o[0]==="#"?1:0).slice(0,6),[parseInt(o.slice(0,2),16),parseInt(o.slice(2,4),16),parseInt(o.slice(4,6),16)])),o[2]=A<0?o[2]*(1+A):1-(1-o[2])*(1-A),Po((function(v){var h,x=v[0],w=v[1],v=v[2],N=2*w*(v<.5?v:1-v),S=[v=v-N/2,v,v],E=6*x;if(w!==0)switch(0|E){case 0:case 6:h=N*E,S[0]+=N,S[1]+=h;break;case 1:h=N*(2-E),S[0]+=h,S[1]+=N;break;case 2:h=N*(E-2),S[1]+=N,S[2]+=h;break;case 3:h=N*(4-E),S[1]+=h,S[2]+=N;break;case 4:h=N*(E-4),S[2]+=N,S[0]+=h;break;case 5:h=N*(6-E),S[2]+=h,S[0]+=N}for(var I=0;I!=3;++I)S[I]=Math.round(255*S[I]);return S})(o)))}var Cc=6,Nf=15,Cf=1,qn=Cc;function Qd(o){return Math.floor((o+Math.round(128/qn)/256)*qn)}function jc(o){return Math.floor((o-5)/qn*100+.5)/100}function aA(o){return Math.round((o*qn+5)/qn*256)/256}function Uh(o){return aA(jc(Qd(o)))}function F0(o){var A=Math.abs(o-Uh(o)),d=qn;if(.005<A)for(qn=Cf;qn<Nf;++qn)Math.abs(o-Uh(o))<=A&&(A=Math.abs(o-Uh(o)),d=qn);qn=d}function Rd(o){o.width?(o.wpx=Qd(o.width),o.wch=jc(o.wpx),o.MDW=qn):o.wpx?(o.wch=jc(o.wpx),o.width=aA(o.wch),o.MDW=qn):typeof o.wch=="number"&&(o.width=aA(o.wch),o.wpx=Qd(o.width),o.MDW=qn),o.customWidth&&delete o.customWidth}var xp=96;function jf(o){return 96*o/xp}function Du(o){return o*xp/96}var wg={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"},E0=["numFmtId","fillId","fontId","borderId","xfId"],Bf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"],bp,yp,Mh,vp,wp,k0,Np=(bp=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,yp=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,Mh=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,vp=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,wp=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/,function(o,A,d){var h,x,w,v,N,S={};return o&&((h=(o=o.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(bp))&&(function(E,I,P){I.NumberFmt=[];for(var K=hs(X),W=0;W<K.length;++W)I.NumberFmt[K[W]]=X[K[W]];var me=E[0].match(ns);if(me)for(W=0;W<me.length;++W){var re=Cr(me[W]);switch(rn(re[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":var De=ma(cs(re.formatCode)),be=parseInt(re.numFmtId,10);if(I.NumberFmt[be]=De,0<be){if(392<be){for(be=392;60<be&&I.NumberFmt[be]!=null;--be);I.NumberFmt[be]=De}Gr(De,be)}break;case"</numFmt>":break;default:if(P.WTF)throw new Error("unrecognized "+re[0]+" in numFmts")}}})(h,S,d),(h=o.match(vp))&&(function(E,I,P,K){I.Fonts=[];var W={},me=!1;(E[0].match(ns)||[]).forEach(function(re){var De,be=Cr(re);switch(rn(be[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":I.Fonts.push(W),W={};break;case"<name":be.val&&(W.name=cs(be.val));break;case"<name/>":case"</name>":break;case"<b":W.bold=be.val?Ps(be.val):1;break;case"<b/>":W.bold=1;break;case"<i":W.italic=be.val?Ps(be.val):1;break;case"<i/>":W.italic=1;break;case"<u":switch(be.val){case"none":W.underline=0;break;case"single":W.underline=1;break;case"double":W.underline=2;break;case"singleAccounting":W.underline=33;break;case"doubleAccounting":W.underline=34}break;case"<u/>":W.underline=1;break;case"<strike":W.strike=be.val?Ps(be.val):1;break;case"<strike/>":W.strike=1;break;case"<outline":W.outline=be.val?Ps(be.val):1;break;case"<outline/>":W.outline=1;break;case"<shadow":W.shadow=be.val?Ps(be.val):1;break;case"<shadow/>":W.shadow=1;break;case"<condense":W.condense=be.val?Ps(be.val):1;break;case"<condense/>":W.condense=1;break;case"<extend":W.extend=be.val?Ps(be.val):1;break;case"<extend/>":W.extend=1;break;case"<sz":be.val&&(W.sz=+be.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":be.val&&(W.vertAlign=be.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":be.val&&(W.family=parseInt(be.val,10));break;case"<family/>":case"</family>":break;case"<scheme":be.val&&(W.scheme=be.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(be.val=="1")break;be.codepage=g[parseInt(be.val,10)];break;case"<color":W.color||(W.color={}),be.auto&&(W.color.auto=Ps(be.auto)),be.rgb?W.color.rgb=be.rgb.slice(-6):be.indexed?(W.color.index=parseInt(be.indexed,10),De=GA[W.color.index],De=(De=W.color.index==81?GA[1]:De)||GA[1],W.color.rgb=De[0].toString(16)+De[1].toString(16)+De[2].toString(16)):be.theme&&(W.color.theme=parseInt(be.theme,10),be.tint&&(W.color.tint=parseFloat(be.tint)),be.theme&&P.themeElements&&P.themeElements.clrScheme&&(W.color.rgb=Fl(P.themeElements.clrScheme[W.color.theme].rgb,W.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":me=!0;break;case"</AlternateContent>":me=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":me=!0;break;case"</ext>":me=!1;break;default:if(K&&K.WTF&&!me)throw new Error("unrecognized "+be[0]+" in fonts")}})})(h,S,A,d),(h=o.match(Mh))&&(function(E,I,P){I.Fills=[];var K={},W=!1;(E[0].match(ns)||[]).forEach(function(me){var re=Cr(me);switch(rn(re[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":K={},I.Fills.push(K);break;case"</fill>":case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":I.Fills.push(K),K={};break;case"<patternFill":case"<patternFill>":re.patternType&&(K.patternType=re.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":K.bgColor||(K.bgColor={}),re.indexed&&(K.bgColor.indexed=parseInt(re.indexed,10)),re.theme&&(K.bgColor.theme=parseInt(re.theme,10)),re.tint&&(K.bgColor.tint=parseFloat(re.tint)),re.rgb&&(K.bgColor.rgb=re.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":K.fgColor||(K.fgColor={}),re.theme&&(K.fgColor.theme=parseInt(re.theme,10)),re.tint&&(K.fgColor.tint=parseFloat(re.tint)),re.rgb!=null&&(K.fgColor.rgb=re.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":case"</stop>":break;case"<color":case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":W=!0;break;case"</ext>":W=!1;break;default:if(P&&P.WTF&&!W)throw new Error("unrecognized "+re[0]+" in fills")}})})(h,S,d),(h=o.match(wp))&&(function(E,I,P){I.Borders=[];var K={},W=!1;(E[0].match(ns)||[]).forEach(function(me){var re=Cr(me);switch(rn(re[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":K={},re.diagonalUp&&(K.diagonalUp=Ps(re.diagonalUp)),re.diagonalDown&&(K.diagonalDown=Ps(re.diagonalDown)),I.Borders.push(K);break;case"</border>":case"<left/>":break;case"<left":case"<left>":case"</left>":case"<right/>":break;case"<right":case"<right>":case"</right>":case"<top/>":break;case"<top":case"<top>":case"</top>":case"<bottom/>":break;case"<bottom":case"<bottom>":case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":break;case"<start":case"<start>":case"<start/>":case"</start>":break;case"<end":case"<end>":case"<end/>":case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":W=!0;break;case"</ext>":W=!1;break;default:if(P&&P.WTF&&!W)throw new Error("unrecognized "+re[0]+" in borders")}})})(h,S,d),(h=o.match(yp))&&(h=h,w=d,N=!((x=S).CellXf=[]),(h[0].match(ns)||[]).forEach(function(E){var I=Cr(E),P=0;switch(rn(I[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(delete(v=I)[0],P=0;P<E0.length;++P)v[E0[P]]&&(v[E0[P]]=parseInt(v[E0[P]],10));for(P=0;P<Bf.length;++P)v[Bf[P]]&&(v[Bf[P]]=Ps(v[Bf[P]]));if(x.NumberFmt&&392<v.numFmtId){for(P=392;60<P;--P)if(x.NumberFmt[v.numFmtId]==x.NumberFmt[P]){v.numFmtId=P;break}}x.CellXf.push(v);break;case"</xf>":break;case"<alignment":case"<alignment/>":var K={};I.vertical&&(K.vertical=I.vertical),I.horizontal&&(K.horizontal=I.horizontal),I.textRotation!=null&&(K.textRotation=I.textRotation),I.indent&&(K.indent=I.indent),I.wrapText&&(K.wrapText=Ps(I.wrapText)),v.alignment=K;break;case"</alignment>":case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":N=!0;break;case"</AlternateContent>":N=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":N=!0;break;case"</ext>":N=!1;break;default:if(w&&w.WTF&&!N)throw new Error("unrecognized "+I[0]+" in cellXfs")}}))),S});function Cp(o,A){if(k0!==void 0)return k0.toXml();var d,h,x,w,v=[Ba,lr("styleSheet",null,{xmlns:Nl[0],"xmlns:vt":Bn.vt})];return o.SSF&&(h=o.SSF,x=["<numFmts>"],[[5,8],[23,26],[41,44],[50,392]].forEach(function(N){for(var S=N[0];S<=N[1];++S)h[S]!=null&&(x[x.length]=lr("numFmt",null,{numFmtId:S,formatCode:Va(h[S])}))}),(d=x.length===1?"":(x[x.length]="</numFmts>",x[0]=lr("numFmts",null,{count:x.length-2}).replace("/>",">"),x.join("")))!=null)&&(v[v.length]=d),v[v.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',v[v.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',v[v.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',v[v.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',A=A.cellXfs,(w=[])[w.length]="<cellXfs/>",A.forEach(function(N){w[w.length]=lr("xf",null,N)}),w[w.length]="</cellXfs>",(d=w.length===2?"":(w[0]=lr("cellXfs",null,{count:w.length-2}).replace("/>",">"),w.join("")))&&(v[v.length]=d),v[v.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',v[v.length]='<dxfs count="0"/>',v[v.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',2<v.length&&(v[v.length]="</styleSheet>",v[1]=v[1].replace("/>",">")),v.join("")}function Ng(o,A){var d;(A=A||Ft(153)).write_shift(2,20*o.sz),d=o,h=(h=A)||Ft(2),d=(d.italic?2:0)|(d.strike?8:0)|(d.outline?16:0)|(d.shadow?32:0)|(d.condense?64:0)|(d.extend?128:0),h.write_shift(1,d),h.write_shift(1,0),A.write_shift(2,o.bold?700:400);var h=0;return o.vertAlign=="superscript"?h=1:o.vertAlign=="subscript"&&(h=2),A.write_shift(2,h),A.write_shift(1,o.underline||0),A.write_shift(1,o.family||0),A.write_shift(1,o.charset||0),A.write_shift(1,0),Os(o.color,A),h=0,o.scheme=="major"&&(h=1),o.scheme=="minor"&&(h=2),A.write_shift(1,h),Ys(o.name,A),A.length>A.l?A.slice(0,A.l):A}var Ih,Cg=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],jg=yi;function Bg(o,A){A=A||Ft(84),o=(Ih=Ih||ra(Cg))[o.patternType],o==null&&(o=40),A.write_shift(4,o);var d=0;if(o!=40)for(Os({auto:1},A),Os({auto:1},A);d<12;++d)A.write_shift(4,0);else{for(;d<4;++d)A.write_shift(4,0);for(;d<12;++d)A.write_shift(4,0)}return A.length>A.l?A.slice(0,A.l):A}function Sg(o,A,d){return(d=d||Ft(16)).write_shift(2,A||0),d.write_shift(2,o.numFmtId||0),d.write_shift(2,0),d.write_shift(2,0),d.write_shift(2,0),d.write_shift(1,0),d.write_shift(1,0),d.write_shift(1,0),d.write_shift(1,0),d.write_shift(1,0),d.write_shift(1,0),d}function Sf(o,A){return(A=A||Ft(10)).write_shift(1,0),A.write_shift(1,0),A.write_shift(4,0),A.write_shift(4,0),A}pi=yi;function D0(o,A){var d;A&&(d=0,[[5,8],[23,26],[41,44],[50,392]].forEach(function(h){for(var x=h[0];x<=h[1];++x)A[x]!=null&&++d}),d!=0&&(Pt(o,615,pn(d)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(h){for(var x,w,v,N=h[0];N<=h[1];++N)A[N]!=null&&Pt(o,44,(x=N,w=A[N],(v=(v=void 0)||Ft(6+4*w.length)).write_shift(2,x),Ys(w,v),w=v.length>v.l?v.slice(0,v.l):v,v.l==null&&(v.l=v.length),w))}),Pt(o,616)))}function jp(o){var A;Pt(o,613,pn(1)),Pt(o,46,((A=A||Ft(51)).write_shift(1,0),Sf(0,A),Sf(0,A),Sf(0,A),Sf(0,A),Sf(0,A),A.length>A.l?A.slice(0,A.l):A)),Pt(o,614)}function Oh(o){var A,d;Pt(o,619,pn(1)),Pt(o,48,(A={xfId:0,builtinId:0,name:"Normal"},(d=d||Ft(52)).write_shift(4,A.xfId),d.write_shift(2,1),d.write_shift(1,+A.builtinId),d.write_shift(1,0),Hc(A.name||"",d),d.length>d.l?d.slice(0,d.l):d)),Pt(o,620)}function Fg(o){var A,d,h,x;Pt(o,508,(A=0,d="TableStyleMedium9",h="PivotStyleMedium4",(x=Ft(2052)).write_shift(4,A),Hc(d,x),Hc(h,x),x.length>x.l?x.slice(0,x.l):x)),Pt(o,509)}function Eg(o,A){var d,h=In();return Pt(h,278),D0(h,o.SSF),Pt(o=h,611,pn(1)),Pt(o,43,Ng({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Pt(o,612),Pt(o=h,603,pn(2)),Pt(o,45,Bg({patternType:"none"})),Pt(o,45,Bg({patternType:"gray125"})),Pt(o,604),jp(h),Pt(o=h,626,pn(1)),Pt(o,47,Sg({numFmtId:0},65535)),Pt(o,627),d=h,A=A.cellXfs,Pt(d,617,pn(A.length)),A.forEach(function(x){Pt(d,47,Sg(x,0))}),Pt(d,618),Oh(h),Pt(A=h,505,pn(0)),Pt(A,506),Fg(h),Pt(h,279),h.end()}var T0=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function kg(o,A,d){A.themeElements.clrScheme=[];var h={};(o[0].match(ns)||[]).forEach(function(x){var w=Cr(x);switch(w[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":h.rgb=w.val;break;case"<a:sysClr":h.rgb=w.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":w[0].charAt(1)==="/"?(A.themeElements.clrScheme[T0.indexOf(w[0])]=h,h={}):h.name=w[0].slice(3,w[0].length-1);break;default:if(d&&d.WTF)throw new Error("Unrecognized "+w[0]+" in clrScheme")}})}function Bp(){}function Dg(){}var Sp=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Fp=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Tg=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/,_g=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Pd(o,A){var d,h,x,w,v,N={};if(!(d=(o=!o||o.length===0?Qh():o).match(_g)))throw new Error("themeElements not found in theme");return h=d[0],w=A,(x=N).themeElements={},[["clrScheme",Sp,kg],["fontScheme",Fp,Bp],["fmtScheme",Tg,Dg]].forEach(function(S){if(!(v=h.match(S[1])))throw new Error(S[0]+" not found in themeElements");S[2](v,x,w)}),N.raw=o,N}function Qh(o,A){return A&&A.themeXLSX?A.themeXLSX:o&&typeof o.raw=="string"?o.raw:(o=[Ba],o[o.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',o[o.length]="<a:themeElements>",o[o.length]='<a:clrScheme name="Office">',o[o.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',o[o.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',o[o.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',o[o.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',o[o.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',o[o.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',o[o.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',o[o.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',o[o.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',o[o.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',o[o.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',o[o.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',o[o.length]="</a:clrScheme>",o[o.length]='<a:fontScheme name="Office">',o[o.length]="<a:majorFont>",o[o.length]='<a:latin typeface="Cambria"/>',o[o.length]='<a:ea typeface=""/>',o[o.length]='<a:cs typeface=""/>',o[o.length]='<a:font script="Jpan" typeface=" "/>',o[o.length]='<a:font script="Hang" typeface=" "/>',o[o.length]='<a:font script="Hans" typeface=""/>',o[o.length]='<a:font script="Hant" typeface=""/>',o[o.length]='<a:font script="Arab" typeface="Times New Roman"/>',o[o.length]='<a:font script="Hebr" typeface="Times New Roman"/>',o[o.length]='<a:font script="Thai" typeface="Tahoma"/>',o[o.length]='<a:font script="Ethi" typeface="Nyala"/>',o[o.length]='<a:font script="Beng" typeface="Vrinda"/>',o[o.length]='<a:font script="Gujr" typeface="Shruti"/>',o[o.length]='<a:font script="Khmr" typeface="MoolBoran"/>',o[o.length]='<a:font script="Knda" typeface="Tunga"/>',o[o.length]='<a:font script="Guru" typeface="Raavi"/>',o[o.length]='<a:font script="Cans" typeface="Euphemia"/>',o[o.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',o[o.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',o[o.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',o[o.length]='<a:font script="Thaa" typeface="MV Boli"/>',o[o.length]='<a:font script="Deva" typeface="Mangal"/>',o[o.length]='<a:font script="Telu" typeface="Gautami"/>',o[o.length]='<a:font script="Taml" typeface="Latha"/>',o[o.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',o[o.length]='<a:font script="Orya" typeface="Kalinga"/>',o[o.length]='<a:font script="Mlym" typeface="Kartika"/>',o[o.length]='<a:font script="Laoo" typeface="DokChampa"/>',o[o.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',o[o.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',o[o.length]='<a:font script="Viet" typeface="Times New Roman"/>',o[o.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',o[o.length]='<a:font script="Geor" typeface="Sylfaen"/>',o[o.length]="</a:majorFont>",o[o.length]="<a:minorFont>",o[o.length]='<a:latin typeface="Calibri"/>',o[o.length]='<a:ea typeface=""/>',o[o.length]='<a:cs typeface=""/>',o[o.length]='<a:font script="Jpan" typeface=" "/>',o[o.length]='<a:font script="Hang" typeface=" "/>',o[o.length]='<a:font script="Hans" typeface=""/>',o[o.length]='<a:font script="Hant" typeface=""/>',o[o.length]='<a:font script="Arab" typeface="Arial"/>',o[o.length]='<a:font script="Hebr" typeface="Arial"/>',o[o.length]='<a:font script="Thai" typeface="Tahoma"/>',o[o.length]='<a:font script="Ethi" typeface="Nyala"/>',o[o.length]='<a:font script="Beng" typeface="Vrinda"/>',o[o.length]='<a:font script="Gujr" typeface="Shruti"/>',o[o.length]='<a:font script="Khmr" typeface="DaunPenh"/>',o[o.length]='<a:font script="Knda" typeface="Tunga"/>',o[o.length]='<a:font script="Guru" typeface="Raavi"/>',o[o.length]='<a:font script="Cans" typeface="Euphemia"/>',o[o.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',o[o.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',o[o.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',o[o.length]='<a:font script="Thaa" typeface="MV Boli"/>',o[o.length]='<a:font script="Deva" typeface="Mangal"/>',o[o.length]='<a:font script="Telu" typeface="Gautami"/>',o[o.length]='<a:font script="Taml" typeface="Latha"/>',o[o.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',o[o.length]='<a:font script="Orya" typeface="Kalinga"/>',o[o.length]='<a:font script="Mlym" typeface="Kartika"/>',o[o.length]='<a:font script="Laoo" typeface="DokChampa"/>',o[o.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',o[o.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',o[o.length]='<a:font script="Viet" typeface="Arial"/>',o[o.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',o[o.length]='<a:font script="Geor" typeface="Sylfaen"/>',o[o.length]="</a:minorFont>",o[o.length]="</a:fontScheme>",o[o.length]='<a:fmtScheme name="Office">',o[o.length]="<a:fillStyleLst>",o[o.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',o[o.length]='<a:gradFill rotWithShape="1">',o[o.length]="<a:gsLst>",o[o.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',o[o.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',o[o.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',o[o.length]="</a:gsLst>",o[o.length]='<a:lin ang="16200000" scaled="1"/>',o[o.length]="</a:gradFill>",o[o.length]='<a:gradFill rotWithShape="1">',o[o.length]="<a:gsLst>",o[o.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',o[o.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',o[o.length]="</a:gsLst>",o[o.length]='<a:lin ang="16200000" scaled="0"/>',o[o.length]="</a:gradFill>",o[o.length]="</a:fillStyleLst>",o[o.length]="<a:lnStyleLst>",o[o.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',o[o.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',o[o.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',o[o.length]="</a:lnStyleLst>",o[o.length]="<a:effectStyleLst>",o[o.length]="<a:effectStyle>",o[o.length]="<a:effectLst>",o[o.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',o[o.length]="</a:effectLst>",o[o.length]="</a:effectStyle>",o[o.length]="<a:effectStyle>",o[o.length]="<a:effectLst>",o[o.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',o[o.length]="</a:effectLst>",o[o.length]="</a:effectStyle>",o[o.length]="<a:effectStyle>",o[o.length]="<a:effectLst>",o[o.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',o[o.length]="</a:effectLst>",o[o.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',o[o.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',o[o.length]="</a:effectStyle>",o[o.length]="</a:effectStyleLst>",o[o.length]="<a:bgFillStyleLst>",o[o.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',o[o.length]='<a:gradFill rotWithShape="1">',o[o.length]="<a:gsLst>",o[o.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',o[o.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',o[o.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',o[o.length]="</a:gsLst>",o[o.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',o[o.length]="</a:gradFill>",o[o.length]='<a:gradFill rotWithShape="1">',o[o.length]="<a:gsLst>",o[o.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',o[o.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',o[o.length]="</a:gsLst>",o[o.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',o[o.length]="</a:gradFill>",o[o.length]="</a:bgFillStyleLst>",o[o.length]="</a:fmtScheme>",o[o.length]="</a:themeElements>",o[o.length]="<a:objectDefaults>",o[o.length]="<a:spDef>",o[o.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',o[o.length]="</a:spDef>",o[o.length]="<a:lnDef>",o[o.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',o[o.length]="</a:lnDef>",o[o.length]="</a:objectDefaults>",o[o.length]="<a:extraClrSchemeLst/>",o[o.length]="</a:theme>",o.join(""))}function Lg(o){var A={};switch(A.xclrType=o.read_shift(2),A.nTintShade=o.read_shift(2),A.xclrType){case 0:o.l+=4;break;case 1:A.xclrValue=yi(o,4);break;case 2:A.xclrValue=XA(o);break;case 3:A.xclrValue=o.read_shift(4);break;case 4:o.l+=4}return o.l+=8,A}function Ug(o){var A=o.read_shift(2),d=o.read_shift(2)-4,h=[A];switch(A){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:h[1]=Lg(o);break;case 6:h[1]=yi(o,d);break;case 14:case 15:h[1]=o.read_shift(d==1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+A+" "+d)}return h}function Rh(){var o,A,d,h=In();return Pt(h,332),Pt(h,334,pn(1)),Pt(h,335,((d=Ft(12+2*(A={name:"XLDAPR",version:12e4,flags:3496657072}).name.length)).write_shift(4,A.flags),d.write_shift(4,A.version),Ys(A.name,d),d.slice(0,d.l))),Pt(h,336),Pt(h,339,(o=1,(d=Ft(8+2*(A="XLDAPR").length)).write_shift(4,o),Ys(A,d),d.slice(0,d.l))),Pt(h,52),Pt(h,35,pn(514)),Pt(h,4096,pn(0)),Pt(h,4097,Qo(1)),Pt(h,36),Pt(h,53),Pt(h,340),Pt(h,337,(o=1,A=!0,(d=Ft(8)).write_shift(4,o),d.write_shift(4,A?1:0),d)),Pt(h,51,(function(x){var w=Ft(4+8*x.length);w.write_shift(4,x.length);for(var v=0;v<x.length;++v)w.write_shift(4,x[v][0]),w.write_shift(4,x[v][1]);return w})([[1,0]])),Pt(h,338),Pt(h,333),h.end()}function Ep(){var o=[Ba];return o.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),o.join("")}var Hd=1024;function kp(o,A){for(var d=[21600,21600],h=["m0,0l0",d[1],d[0],d[1],d[0],"0xe"].join(","),x=[lr("xml",null,{"xmlns:v":Ts.v,"xmlns:o":Ts.o,"xmlns:x":Ts.x,"xmlns:mv":Ts.mv}).replace(/\/>/,">"),lr("o:shapelayout",lr("o:idmap",null,{"v:ext":"edit",data:o}),{"v:ext":"edit"}),lr("v:shapetype",[lr("v:stroke",null,{joinstyle:"miter"}),lr("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:d.join(","),path:h})];Hd<1e3*o;)Hd+=1e3;return A.forEach(function(w){var v=Es(w[0]),S={color2:"#BEFF82",type:"gradient"};S.type=="gradient"&&(S.angle="-180");var N=S.type=="gradient"?lr("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,S=lr("v:fill",N,S);++Hd,x=x.concat(["<v:shape"+Yi({id:"_x0000_s"+Hd,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(w[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",S,lr("v:shadow",null,{on:"t",obscured:"t"}),lr("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Un("x:Anchor",[v.c+1,0,v.r+1,0,v.c+3,20,v.r+5,20].join(",")),Un("x:AutoFill","False"),Un("x:Row",String(v.r)),Un("x:Column",String(v.c)),w[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),x.push("</xml>"),x.join("")}function Dp(o,A,d,h){var x,w=Array.isArray(o);A.forEach(function(v){var N,S=Es(v.ref);(x=w?(o[S.r]||(o[S.r]=[]),o[S.r][S.c]):o[v.ref])||(x={t:"z"},w?o[S.r][S.c]=x:o[v.ref]=x,(N=Fa(o["!ref"]||"BDWGO1000001:A1")).s.r>S.r&&(N.s.r=S.r),N.e.r<S.r&&(N.e.r=S.r),N.s.c>S.c&&(N.s.c=S.c),N.e.c<S.c&&(N.e.c=S.c),(N=fa(N))!==o["!ref"]&&(o["!ref"]=N)),x.c||(x.c=[]);var E={a:v.author,t:v.t,r:v.r,T:d};v.h&&(E.h=v.h);for(var I=x.c.length-1;0<=I;--I){if(!d&&x.c[I].T)return;d&&!x.c[I].T&&x.c.splice(I,1)}if(d&&h){for(I=0;I<h.length;++I)if(E.a==h[I].id){E.a=h[I].name||E.a;break}}x.c.push(E)})}function Mg(o){var A=[Ba,lr("comments",null,{xmlns:Nl[0]})],d=[];return A.push("<authors>"),o.forEach(function(h){h[1].forEach(function(x){var w=Va(x.a);d.indexOf(w)==-1&&(d.push(w),A.push("<author>"+w+"</author>")),x.T&&x.ID&&d.indexOf("tc="+x.ID)==-1&&(d.push("tc="+x.ID),A.push("<author>tc="+x.ID+"</author>"))})}),d.length==0&&(d.push("SheetJ5"),A.push("<author>SheetJ5</author>")),A.push("</authors>"),A.push("<commentList>"),o.forEach(function(h){var x=0,w=[];if(h[1][0]&&h[1][0].T&&h[1][0].ID?x=d.indexOf("tc="+h[1][0].ID):h[1].forEach(function(S){S.a&&(x=d.indexOf(Va(S.a))),w.push(S.t||"")}),A.push('<comment ref="'+h[0]+'" authorId="'+x+'"><text>'),w.length<=1)A.push(Un("t",Va(w[0]||"")));else{for(var v=`Comment:
    `+w[0]+`
`,N=1;N<w.length;++N)v+=`Reply:
    `+w[N]+`
`;A.push(Un("t",Va(v)))}A.push("</text></comment>")}),A.push("</commentList>"),2<A.length&&(A[A.length]="</comments>",A[1]=A[1].replace("/>",">")),A.join("")}Yo=gn;function Tp(o){var A=In(),d=[];return Pt(A,628),Pt(A,630),o.forEach(function(h){h[1].forEach(function(x){-1<d.indexOf(x.a)||(d.push(x.a.slice(0,54)),Pt(A,632,Ys(x.a.slice(0,54))))})}),Pt(A,631),Pt(A,633),o.forEach(function(h){h[1].forEach(function(x){x.iauthor=d.indexOf(x.a);var w,v={s:Es(h[0]),e:Es(h[0])};Pt(A,635,(v=[v,x],(w=w??Ft(36)).write_shift(4,v[1].iauthor),qi(v[0],w),w.write_shift(4,0),w.write_shift(4,0),w.write_shift(4,0),w.write_shift(4,0),w)),x.t&&0<x.t.length&&Pt(A,637,_d(x)),Pt(A,636),delete x.iauthor})}),Pt(A,634),Pt(A,629),A.end()}var Ii="application/vnd.ms-office.vbaProject",go=["xlsb","xlsm","xlam","biff8","xla"],Ph,_p,Tu=(_p=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,function(o,A){return Ph=A,o.replace(_p,Ig)});function Ig(o,A,d,h){var x=!1,w=!1;return d.length==0?w=!0:d.charAt(0)=="["&&(w=!0,d=d.slice(1,-1)),h.length==0?x=!0:h.charAt(0)=="["&&(x=!0,h=h.slice(1,-1)),d=0<d.length?0|parseInt(d,10):0,h=0<h.length?0|parseInt(h,10):0,x?h+=Ph.c:--h,w?d+=Ph.r:--d,A+(x?"":"$")+Sa(h)+(w?"":"$")+Vs(d)}var _u=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Hh=function(o,A){return o.replace(_u,function(d,h,x,w,v,N){return w=Cl(w)-(x?0:A.c),N=fc(N)-(v?0:A.r),h+"R"+(N==0?"":v?1+N:"["+N+"]")+"C"+(w==0?"":x?1+w:"["+w+"]")})};function _0(o,A){return o.replace(_u,function(d,h,x,w,v,N){return h+(x=="$"?x+w:Sa(Cl(w)+A.c))+(v=="$"?v+N:Vs(fc(N)+A.r))})}function Lp(o){return o.replace(/_xlfn\./g,"")}function Oi(o){o.l+=1}function sA(o,A){return A=o.read_shift(A==1?1:2),[16383&A,A>>14&1,A>>15&1]}function zh(v,A,x){var w=2;if(x){if(2<=x.biff&&x.biff<=5)return Up(v);x.biff==12&&(w=4)}var h=v.read_shift(w),x=v.read_shift(w),w=sA(v,2),v=sA(v,2);return{s:{r:h,c:w[0],cRel:w[1],rRel:w[2]},e:{r:x,c:v[0],cRel:v[1],rRel:v[2]}}}function Up(x){var A=sA(x,2),d=sA(x,2),h=x.read_shift(1),x=x.read_shift(1);return{s:{r:A[0],c:h,cRel:A[1],rRel:A[2]},e:{r:d[0],c:x,cRel:d[1],rRel:d[2]}}}function Mp(v,A,w){if(w&&2<=w.biff&&w.biff<=5)return x=sA(h=v,2),h=h.read_shift(1),{r:x[0],c:h,cRel:x[1],rRel:x[2]};var h,x,w=v.read_shift(w&&w.biff==12?4:2),v=sA(v,2);return{r:w,c:v[0],cRel:v[1],rRel:v[2]}}function Og(v,A,w){if(w=w&&w.biff?w.biff:8,2<=w&&w<=5)return(function(P){var S=P.read_shift(2),E=P.read_shift(1),I=(32768&S)>>15,P=(16384&S)>>14;return S&=16383,I==1&&8192<=S&&(S-=16384),P==1&&128<=E&&(E-=256),{r:S,c:E,cRel:P,rRel:I}})(v);var h=v.read_shift(12<=w?4:2),x=v.read_shift(2),w=(16384&x)>>14,v=(32768&x)>>15;if(x&=16383,v==1)for(;524287<h;)h-=1048576;if(w==1)for(;8191<x;)x-=16384;return{r:h,c:x,cRel:w,rRel:v}}function Kh(o){var A=1&o[o.l+1];return o.l+=4,[A,1]}function Gh(o){return[o.read_shift(1),o.read_shift(1)]}function Ip(o,A,d){var h=0,x=0;d.biff==12?(h=o.read_shift(4),x=o.read_shift(4)):(x=1+o.read_shift(1),h=1+o.read_shift(2)),2<=d.biff&&d.biff<8&&(--h,--x==0&&(x=256));for(var w=0,v=[];w!=h&&(v[w]=[]);++w)for(var N=0;N!=x;++N)v[w][N]=(function(S,E){var I=[S.read_shift(1)];if(E==12)switch(I[0]){case 2:I[0]=4;break;case 4:I[0]=16;break;case 0:I[0]=1;break;case 1:I[0]=2}switch(I[0]){case 4:I[1]=Ma(S,1)?"TRUE":"FALSE",E!=12&&(S.l+=7);break;case 37:case 16:I[1]=So[S[S.l]],S.l+=E==12?4:8;break;case 0:S.l+=8;break;case 1:I[1]=Ea(S);break;case 2:I[1]=bc(S,0,{biff:0<E&&E<8?2:E});break;default:throw new Error("Bad SerAr: "+I[0])}return I})(o,d.biff);return v}function Ff(o,A,d){return o.l+=2,[(o=(h=o).read_shift(2),h=h.read_shift(2),{r:o,c:255&h,fQuoted:!!(16384&h),cRel:h>>15,rRel:h>>15})];var h}function L0(o){return o.l+=6,[]}function U0(o){return o.l+=2,[$s(o),1&o.read_shift(2)]}var Op=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],Qp={1:{n:"PtgExp",f:function(o,A,d){return o.l++,d&&d.biff==12?[o.read_shift(4,"i"),0]:[o.read_shift(2),o.read_shift(d&&d.biff==2?1:2)]}},2:{n:"PtgTbl",f:yi},3:{n:"PtgAdd",f:Oi},4:{n:"PtgSub",f:Oi},5:{n:"PtgMul",f:Oi},6:{n:"PtgDiv",f:Oi},7:{n:"PtgPower",f:Oi},8:{n:"PtgConcat",f:Oi},9:{n:"PtgLt",f:Oi},10:{n:"PtgLe",f:Oi},11:{n:"PtgEq",f:Oi},12:{n:"PtgGe",f:Oi},13:{n:"PtgGt",f:Oi},14:{n:"PtgNe",f:Oi},15:{n:"PtgIsect",f:Oi},16:{n:"PtgUnion",f:Oi},17:{n:"PtgRange",f:Oi},18:{n:"PtgUplus",f:Oi},19:{n:"PtgUminus",f:Oi},20:{n:"PtgPercent",f:Oi},21:{n:"PtgParen",f:Oi},22:{n:"PtgMissArg",f:Oi},23:{n:"PtgStr",f:function(o,A,d){return o.l++,$l(o,0,d)}},26:{n:"PtgSheet",f:function(o,A,d){return o.l+=5,o.l+=2,o.l+=d.biff==2?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(o,A,d){return o.l+=d.biff==2?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(o){return o.l++,So[o.read_shift(1)]}},29:{n:"PtgBool",f:function(o){return o.l++,o.read_shift(1)!==0}},30:{n:"PtgInt",f:function(o){return o.l++,o.read_shift(2)}},31:{n:"PtgNum",f:function(o){return o.l++,Ea(o)}},32:{n:"PtgArray",f:function(o,A,d){var h=(96&o[o.l++])>>5;return o.l+=d.biff==2?6:d.biff==12?14:7,[h]}},33:{n:"PtgFunc",f:function(o,A,d){var h=(96&o[o.l])>>5;return o.l+=1,d=o.read_shift(d&&d.biff<=3?1:2),[Hg[d],Pp[d],h]}},34:{n:"PtgFuncVar",f:function(o,A,d){var h=o[o.l++],x=o.read_shift(1),w=d&&d.biff<=3?[h==88?-1:0,o.read_shift(1)]:[(w=o)[w.l+1]>>7,32767&w.read_shift(2)];return[x,(w[0]===0?Pp:zd)[w[1]]]}},35:{n:"PtgName",f:function(o,A,d){var h=o.read_shift(1)>>>5&3,x=!d||8<=d.biff?4:2,x=o.read_shift(x);switch(d.biff){case 2:o.l+=5;break;case 3:case 4:o.l+=8;break;case 5:o.l+=12}return[h,0,x]}},36:{n:"PtgRef",f:function(o,A,d){var h=(96&o[o.l])>>5;return o.l+=1,[h,Mp(o,0,d)]}},37:{n:"PtgArea",f:function(o,A,d){return[(96&o[o.l++])>>5,zh(o,2<=d.biff&&d.biff,d)]}},38:{n:"PtgMemArea",f:function(o,A,d){var h=o.read_shift(1)>>>5&3;return o.l+=d&&d.biff==2?3:4,[h,o.read_shift(d&&d.biff==2?1:2)]}},39:{n:"PtgMemErr",f:yi},40:{n:"PtgMemNoMem",f:yi},41:{n:"PtgMemFunc",f:function(o,A,d){return[o.read_shift(1)>>>5&3,o.read_shift(d&&d.biff==2?1:2)]}},42:{n:"PtgRefErr",f:function(o,A,d){var h=o.read_shift(1)>>>5&3;return o.l+=4,d.biff<8&&o.l--,d.biff==12&&(o.l+=2),[h]}},43:{n:"PtgAreaErr",f:function(o,A,d){var h=(96&o[o.l++])>>5;return o.l+=d&&8<d.biff?12:d.biff<8?6:8,[h]}},44:{n:"PtgRefN",f:function(o,A,d){var h=(96&o[o.l])>>5;return o.l+=1,[h,Og(o,0,d)]}},45:{n:"PtgAreaN",f:function(o,A,d){return[(96&o[o.l++])>>5,(function(S,N){if(N.biff<8)return Up(S);var w=S.read_shift(N.biff==12?4:2),v=S.read_shift(N.biff==12?4:2),N=sA(S,2),S=sA(S,2);return{s:{r:w,c:N[0],cRel:N[1],rRel:N[2]},e:{r:v,c:S[0],cRel:S[1],rRel:S[2]}}})(o,d)]}},46:{n:"PtgMemAreaN",f:function(o){return[o.read_shift(1)>>>5&3,o.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(o){return[o.read_shift(1)>>>5&3,o.read_shift(2)]}},57:{n:"PtgNameX",f:function(o,A,d){return d.biff==5?(function(h){var x=h.read_shift(1)>>>5&3,w=h.read_shift(2,"i");h.l+=8;var v=h.read_shift(2);return h.l+=12,[x,w,v]})(o):[o.read_shift(1)>>>5&3,o.read_shift(2),o.read_shift(4)]}},58:{n:"PtgRef3d",f:function(o,A,d){var h=(96&o[o.l])>>5;o.l+=1;var x=o.read_shift(2);return d&&d.biff==5&&(o.l+=12),[h,x,Mp(o,0,d)]}},59:{n:"PtgArea3d",f:function(o,A,d){var h=(96&o[o.l++])>>5,x=o.read_shift(2,"i");if(d)switch(d.biff){case 5:o.l+=12;break}return[h,x,zh(o,0,d)]}},60:{n:"PtgRefErr3d",f:function(o,A,d){var h=(96&o[o.l++])>>5,x=o.read_shift(2),w=4;if(d)switch(d.biff){case 5:w=15;break;case 12:w=6}return o.l+=w,[h,x]}},61:{n:"PtgAreaErr3d",f:function(o,A,d){var h=(96&o[o.l++])>>5,x=o.read_shift(2),w=8;if(d)switch(d.biff){case 5:o.l+=12,w=6;break;case 12:w=12}return o.l+=w,[h,x]}},255:{}},Rp={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Qg={1:{n:"PtgElfLel",f:U0},2:{n:"PtgElfRw",f:Ff},3:{n:"PtgElfCol",f:Ff},6:{n:"PtgElfRwV",f:Ff},7:{n:"PtgElfColV",f:Ff},10:{n:"PtgElfRadical",f:Ff},11:{n:"PtgElfRadicalS",f:L0},13:{n:"PtgElfColS",f:L0},15:{n:"PtgElfColSV",f:L0},16:{n:"PtgElfRadicalLel",f:U0},25:{n:"PtgList",f:function(w){w.l+=2;var A=w.read_shift(2),d=w.read_shift(2),h=w.read_shift(4),x=w.read_shift(2),w=w.read_shift(2);return{ixti:A,coltype:3&d,rt:Op[d>>2&31],idx:h,c:x,C:w}}},29:{n:"PtgSxName",f:function(o){return o.l+=2,[o.read_shift(4)]}},255:{}},rd={0:{n:"PtgAttrNoop",f:function(o){return o.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(o,A,d){var h=255&o[o.l+1]?1:0;return o.l+=d&&d.biff==2?3:4,[h]}},2:{n:"PtgAttrIf",f:function(o,A,d){var h=255&o[o.l+1]?1:0;return o.l+=2,[h,o.read_shift(d&&d.biff==2?1:2)]}},4:{n:"PtgAttrChoose",f:function(o,A,d){o.l+=2;for(var h=o.read_shift(d&&d.biff==2?1:2),x=[],w=0;w<=h;++w)x.push(o.read_shift(d&&d.biff==2?1:2));return x}},8:{n:"PtgAttrGoto",f:function(o,A,d){var h=255&o[o.l+1]?1:0;return o.l+=2,[h,o.read_shift(d&&d.biff==2?1:2)]}},16:{n:"PtgAttrSum",f:function(o,A,d){o.l+=d&&d.biff==2?3:4}},32:{n:"PtgAttrBaxcel",f:Kh},33:{n:"PtgAttrBaxcel",f:Kh},64:{n:"PtgAttrSpace",f:function(o){return o.read_shift(2),Gh(o)}},65:{n:"PtgAttrSpaceSemi",f:function(o){return o.read_shift(2),Gh(o)}},128:{n:"PtgAttrIfError",f:function(o){var A=255&o[o.l+1]?1:0;return o.l+=2,[A,o.read_shift(2)]}},255:{}};function Lu(o,A,d,h){if(h.biff<8)return yi(o,A);for(var x=o.l+A,w=[],v=0;v!==d.length;++v)switch(d[v][0]){case"PtgArray":d[v][1]=Ip(o,0,h),w.push(d[v][1]);break;case"PtgMemArea":d[v][2]=(function(N,S){for(var E=N.read_shift(S.biff==12?4:2),I=[],P=0;P!=E;++P)I.push((S.biff==12?zn:Ai)(N));return I})(o,(d[v][1],h)),w.push(d[v][2]);break;case"PtgExp":h&&h.biff==12&&(d[v][1][1]=o.read_shift(4),w.push(d[v][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+d[v][0]}return(A=x-o.l)!==0&&w.push(yi(o,A)),w}function M0(o,A,d){for(var h,x,w=o.l+A,v=[];w!=o.l;)A=w-o.l,x=o[o.l],h=Qp[x]||Qp[Rp[x]],(h=x===24||x===25?(x===24?Qg:rd)[o[o.l+1]]:h)&&h.f?v.push([h.n,h.f(o,A,d)]):yi(o,A);return v}var Rg={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function CA(o,A,d){if(!o)return"SH33TJSERR0";if(8<d.biff&&(!o.XTI||!o.XTI[A]))return o.SheetNames[A];if(!o.XTI)return"SH33TJSERR6";var h=o.XTI[A];if(d.biff<8)return 1e4<A&&(A-=65536),(A=A<0?-A:A)==0?"":o.XTI[A-1];if(!h)return"SH33TJSERR1";var x="";if(8<d.biff)switch(o[h[0]][0]){case 357:return x=h[1]==-1?"#REF":o.SheetNames[h[1]],h[1]==h[2]?x:x+":"+o.SheetNames[h[2]];case 358:return d.SID!=null?o.SheetNames[d.SID]:"SH33TJSSAME"+o[h[0]][0];case 355:default:return"SH33TJSSRC"+o[h[0]][0]}switch(o[h[0]][0][0]){case 1025:return x=h[1]==-1?"#REF":o.SheetNames[h[1]]||"SH33TJSERR3",h[1]==h[2]?x:x+":"+o.SheetNames[h[2]];case 14849:return o[h[0]].slice(1).map(function(w){return w.Name}).join(";;");default:return o[h[0]][0][3]?(x=h[1]==-1?"#REF":o[h[0]][0][3][h[1]]||"SH33TJSERR4",h[1]==h[2]?x:x+":"+o[h[0]][0][3][h[2]]):"SH33TJSERR2"}}function Vh(o,A,d){return A=CA(o,A,d),A=="#REF"?A:(function(h,x){if(!(h||x&&x.biff<=5&&2<=x.biff))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(h)?"'"+h+"'":h})(A,d)}function Ho(o,A,d,h,x){var w,v,N,S=x&&x.biff||8,E={s:{c:0,r:0}},I=[],P=0,K=0,W="";if(!o[0]||!o[0][0])return"";for(var me=-1,re="",De=0,be=o[0].length;De<be;++De){var ce=o[0][De];switch(ce[0]){case"PtgUminus":I.push("-"+I.pop());break;case"PtgUplus":I.push("+"+I.pop());break;case"PtgPercent":I.push(I.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(Br=I.pop(),w=I.pop(),0<=me){switch(o[0][me][1][0]){case 0:re=ss(" ",o[0][me][1][1]);break;case 1:re=ss("\r",o[0][me][1][1]);break;default:if(re="",x.WTF)throw new Error("Unexpected PtgAttrSpaceType "+o[0][me][1][0])}w+=re,me=-1}I.push(w+Rg[ce[0]]+Br);break;case"PtgIsect":Br=I.pop(),w=I.pop(),I.push(w+" "+Br);break;case"PtgUnion":Br=I.pop(),w=I.pop(),I.push(w+","+Br);break;case"PtgRange":Br=I.pop(),w=I.pop(),I.push(w+":"+Br);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":break;case"PtgRef":v=Vl(ce[1][1],E,x),I.push(ti(v,S));break;case"PtgRefN":v=d?Vl(ce[1][1],d,x):ce[1][1],I.push(ti(v,S));break;case"PtgRef3d":P=ce[1][1],v=Vl(ce[1][2],E,x),W=Vh(h,P,x),I.push(W+"!"+ti(v,S));break;case"PtgFunc":case"PtgFuncVar":var Ue=ce[1][0],Ee=ce[1][1],Ue=Ue||0,Ie=(Ue&=127)==0?[]:I.slice(-Ue);I.length-=Ue,Ee==="User"&&(Ee=Ie.shift()),I.push(Ee+"("+Ie.join(",")+")");break;case"PtgBool":I.push(ce[1]?"TRUE":"FALSE");break;case"PtgInt":I.push(ce[1]);break;case"PtgNum":I.push(String(ce[1]));break;case"PtgStr":I.push('"'+ce[1].replace(/"/g,'""')+'"');break;case"PtgErr":I.push(ce[1]);break;case"PtgAreaN":N=Qc(ce[1][1],d?{s:d}:E,x),I.push(uc(N,x));break;case"PtgArea":N=Qc(ce[1][1],E,x),I.push(uc(N,x));break;case"PtgArea3d":P=ce[1][1],N=ce[1][2],W=Vh(h,P,x),I.push(W+"!"+uc(N,x));break;case"PtgAttrSum":I.push("SUM("+I.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":K=ce[1][2];var $e=(h.names||[])[K-1]||(h[0]||[])[K],st=$e?$e.Name:"SH33TJSNAME"+String(K);st&&st.slice(0,6)=="_xlfn."&&!x.xlfn&&(st=st.slice(6)),I.push(st);break;case"PtgNameX":var rt,mt=ce[1][1],K=ce[1][2];if(!(x.biff<=5)){$e="",((h[mt]||[])[0]||[])[0]==14849||(((h[mt]||[])[0]||[])[0]==1025?h[mt][K]&&0<h[mt][K].itab&&($e=h.SheetNames[h[mt][K].itab-1]+"!"):$e=h.SheetNames[K-1]+"!"),h[mt]&&h[mt][K]?$e+=h[mt][K].Name:h[0]&&h[0][K]?$e+=h[0][K].Name:(st=(CA(h,mt,x)||"").split(";;"))[K-1]?$e=st[K-1]:$e+="SH33TJSERRX",I.push($e);break}rt=(rt=h[mt=mt<0?-mt:mt]?h[mt][K]:rt)||{Name:"SH33TJSERRY"},I.push(rt.Name);break;case"PtgParen":var Mt="(",Qt=")";if(0<=me){switch(re="",o[0][me][1][0]){case 2:Mt=ss(" ",o[0][me][1][1])+Mt;break;case 3:Mt=ss("\r",o[0][me][1][1])+Mt;break;case 4:Qt=ss(" ",o[0][me][1][1])+Qt;break;case 5:Qt=ss("\r",o[0][me][1][1])+Qt;break;default:if(x.WTF)throw new Error("Unexpected PtgAttrSpaceType "+o[0][me][1][0])}me=-1}I.push(Mt+I.pop()+Qt);break;case"PtgRefErr":case"PtgRefErr3d":I.push("#REF!");break;case"PtgExp":v={c:ce[1][1],r:ce[1][0]};var vt={c:d.c,r:d.r};if(h.sharedf[ha(v)])mt=h.sharedf[ha(v)],I.push(Ho(mt,0,vt,h,x));else{for(var Zt=!1,Br=0;Br!=h.arrayf.length;++Br)if(w=h.arrayf[Br],!(v.c<w[0].s.c||v.c>w[0].e.c||v.r<w[0].s.r||v.r>w[0].e.r)){I.push(Ho(w[1],0,vt,h,x)),Zt=!0;break}Zt||I.push(ce[1])}break;case"PtgArray":I.push("{"+(function(ur){for(var nr=[],Vt=0;Vt<ur.length;++Vt){for(var kr=ur[Vt],Rr=[],na=0;na<kr.length;++na){var Ga=kr[na];Ga?Ga[0]===2?Rr.push('"'+Ga[1].replace(/"/g,'""')+'"'):Rr.push(Ga[1]):Rr.push("")}nr.push(Rr.join(","))}return nr.join(";")})(ce[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":me=De;break;case"PtgTbl":case"PtgMemErr":break;case"PtgMissArg":I.push("");break;case"PtgAreaErr":case"PtgAreaErr3d":I.push("#REF!");break;case"PtgList":I.push("Table"+ce[1].idx+"[#"+ce[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":default:throw new Error("Unrecognized Formula Token: "+String(ce))}if(x.biff!=3&&0<=me&&["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(o[0][De][0])==-1){var wr=!0;switch((ce=o[0][me])[1][0]){case 4:wr=!1;case 0:re=ss(" ",ce[1][1]);break;case 5:wr=!1;case 1:re=ss("\r",ce[1][1]);break;default:if(re="",x.WTF)throw new Error("Unexpected PtgAttrSpaceType "+ce[1][0])}I.push((wr?re:"")+I.pop()+(wr?"":re)),me=-1}}if(1<I.length&&x.WTF)throw new Error("bad formula stack");return I[0]}function Ef(o,v,d){var h=o.l+v,x=Xi(o);d.biff==2&&++o.l;var w=(function(N){var S;if(Qr(N,N.l+6)!==65535)return[Ea(N),"n"];switch(N[N.l]){case 0:return N.l+=8,["String","s"];case 1:return S=N[N.l+2]===1,N.l+=8,[S,"b"];case 2:return S=N[N.l+2],N.l+=8,[S,"e"];case 3:return N.l+=8,["","s"]}return[]})(o),v=o.read_shift(1);return d.biff!=2&&(o.read_shift(1),5<=d.biff&&o.read_shift(4)),d=(function(N,S,E){var I,P=N.l+S,K=E.biff==2?1:2,W=N.read_shift(K);if(W==65535)return[[],yi(N,S-2)];var me=M0(N,W,E);return S!==W+K&&(I=Lu(N,S-W-K,me,E)),N.l=P,[me,I]})(o,h-o.l,d),{cell:x,val:w[0],formula:d,shared:v>>3&1,tt:w[1]}}function I0(o,A,d,h,x){A=vc(A,d,x),x=(d=o.v)!=null?Ya(typeof d=="number"?d:0):((d=Ft(8)).write_shift(1,3),d.write_shift(1,0),d.write_shift(2,0),d.write_shift(2,0),d.write_shift(2,65535),d),d=Ft(6),d.write_shift(2,33),d.write_shift(4,0);for(var w=Ft(o.bf.length),v=0;v<o.bf.length;++v)w[v]=o.bf[v];return ge([A,x,d,w])}function cn(o,A,d){var x=o.read_shift(4),h=M0(o,x,d),x=o.read_shift(4);return[h,0<x?Lu(o,x,h,d):null]}var ny=cn,Yh=cn,Pg=cn,O0=cn,zd={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Pp={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Hg={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function kf(o){return(o=(o=(o=(o=(o=o.slice(0,3)=="of:"?o.slice(3):o).charCodeAt(0)==61&&(o=o.slice(1)).charCodeAt(0)==61?o.slice(1):o).replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(A,d){return d.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function Bc(o){return o=o.split(":"),[o[0].split(".")[0],o[0].split(".")[1]+(1<o.length?":"+(o[1].split(".")[1]||o[1].split(".")[0]):"")]}var Df={},Kd={},Tf=typeof Map<"u";function Q0(o,A,d){var h=0,x=o.length;if(d){if(Tf?d.has(A):Object.prototype.hasOwnProperty.call(d,A)){for(var w=Tf?d.get(A):d[A];h<w.length;++h)if(o[w[h]].t===A)return o.Count++,w[h]}}else for(;h<x;++h)if(o[h].t===A)return o.Count++,h;return o[x]={t:A},o.Count++,o.Unique++,d&&(Tf?(d.has(A)||d.set(A,[]),d.get(A).push(x)):(Object.prototype.hasOwnProperty.call(d,A)||(d[A]=[]),d[A].push(x))),x}function _f(h,A){var d={min:h+1,max:h+1},h=-1;return A.MDW&&(qn=A.MDW),A.width!=null?d.customWidth=1:A.wpx!=null?h=jc(A.wpx):A.wch!=null&&(h=A.wch),-1<h?(d.width=aA(h),d.customWidth=1):A.width!=null&&(d.width=A.width),A.hidden&&(d.hidden=!0),A.level!=null&&(d.outlineLevel=d.level=A.level),d}function jA(o,A){o&&(A=A=="xlml"?[1,1,1,1,.5,.5]:[.7,.7,.75,.75,.3,.3],o.left==null&&(o.left=A[0]),o.right==null&&(o.right=A[1]),o.top==null&&(o.top=A[2]),o.bottom==null&&(o.bottom=A[3]),o.header==null&&(o.header=A[4]),o.footer==null&&(o.footer=A[5]))}function ad(o,A,d){if(k0!==void 0){if(/^\d+$/.exec(A.s)||A.s&&A.s==+A.s)return A.s;var h=A.s||{};return A.z&&(h.numFmt=A.z),k0.addStyle(h)}var x=d.revssf[A.z!=null?A.z:"General"],w=60,v=o.length;if(x==null&&d.ssf){for(;w<392;++w)if(d.ssf[w]==null){Gr(A.z,w),d.ssf[w]=A.z,d.revssf[A.z]=x=w;break}}for(w=0;w!=v;++w)if(o[w].numFmtId===x)return w;return o[v]={numFmtId:x,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},v}function BA(o,A,d,h,x,w){try{h.cellNF&&(o.z=X[A])}catch(N){if(h.WTF)throw N}if(o.t!=="z"||h.cellStyles){if(o.t==="d"&&typeof o.v=="string"&&(o.v=ba(o.v)),(!h||h.cellText!==!1)&&o.t!=="z")try{if(X[A]==null&&Gr(Ms[A]||"General",A),o.t==="e")o.w=o.w||So[o.v];else if(A===0)if(o.t==="n")(0|o.v)===o.v?o.w=o.v.toString(10):o.w=Se(o.v);else if(o.t==="d"){var v=ms(o.v);o.w=(0|v)===v?v.toString(10):Se(v)}else{if(o.v===void 0)return;o.w=ft(o.v,Kd)}else o.t==="d"?o.w=pr(A,ms(o.v),Kd):o.w=pr(A,o.v,Kd)}catch(N){if(h.WTF)throw N}if(h.cellStyles&&d!=null)try{o.s=w.Fills[d],o.s.fgColor&&o.s.fgColor.theme&&!o.s.fgColor.rgb&&(o.s.fgColor.rgb=Fl(x.themeElements.clrScheme[o.s.fgColor.theme].rgb,o.s.fgColor.tint||0),h.WTF&&(o.s.fgColor.raw_rgb=x.themeElements.clrScheme[o.s.fgColor.theme].rgb)),o.s.bgColor&&o.s.bgColor.theme&&(o.s.bgColor.rgb=Fl(x.themeElements.clrScheme[o.s.bgColor.theme].rgb,o.s.bgColor.tint||0),h.WTF&&(o.s.bgColor.raw_rgb=x.themeElements.clrScheme[o.s.bgColor.theme].rgb))}catch(N){if(h.WTF&&w.Fills)throw N}}}var Qi=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Hp=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,zg=/<(?:\w:)?hyperlink [^>]*>/gm,xo=/"(\w*:\w*)"/,iy=/<(?:\w:)?col\b[^>]*[\/]?>/g,Kg=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Gg=/<(?:\w:)?pageMargins[^>]*\/>/g,Qn=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,El=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,sd=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Vg(o,A,d,h,x,w,v){if(!o)return o;h=h||{"!id":{}};var N=A.dense?[]:{},S={s:{r:2e6,c:2e6},e:{r:0,c:0}},E="",st="",I=o.match(Hp);I?(E=o.slice(0,I.index),st=o.slice(I.index+I[0].length)):E=st=o;var P=E.match(Qn);P?Wh(P[0],0,x,d):(P=E.match(El))&&(o=P[0],P[1],P=N,K=x,W=d,Wh(o.slice(0,o.indexOf(">")),0,K,W));var K,W,me=(E.match(/<(?:\w*:)?dimension/)||{index:-1}).index;0<me&&(K=E.slice(me,me+50).match(xo))&&(W=N,(De=Fa(De=K[1])).s.r<=De.e.r&&De.s.c<=De.e.c&&0<=De.s.r&&0<=De.s.c&&(W["!ref"]=fa(De)));var re,De=E.match(sd);De&&De[1]&&(ce=De[1],(re=x).Views||(re.Views=[{}]),(ce.match($h)||[]).forEach(function(rt,mt){rt=Cr(rt),re.Views[mt]||(re.Views[mt]={}),+rt.zoomScale&&(re.Views[mt].zoom=+rt.zoomScale),Ps(rt.rightToLeft)&&(re.Views[mt].RTL=!0)}));var be,ce=[];A.cellStyles&&(be=E.match(iy))&&(function(rt,mt){for(var Mt=!1,Qt=0;Qt!=mt.length;++Qt){var vt=Cr(mt[Qt],!0);vt.hidden&&(vt.hidden=Ps(vt.hidden));var Zt=parseInt(vt.min,10)-1,Br=parseInt(vt.max,10)-1;for(vt.outlineLevel&&(vt.level=+vt.outlineLevel||0),delete vt.min,delete vt.max,vt.width=+vt.width,!Mt&&vt.width&&(Mt=!0,F0(vt.width)),Rd(vt);Zt<=Br;)rt[Zt++]=Oa(vt)}})(ce,be),I&&nd(I[1],N,A,S,w,v),v=st.match(Kg),v&&(N["!autofilter"]={ref:(v[0].match(/ref="([^"]*)"/)||[])[1]});var Ee=[],Ue=st.match(Qi);if(Ue)for(me=0;me!=Ue.length;++me)Ee[me]=Fa(Ue[me].slice(Ue[me].indexOf('"')+1));v=st.match(zg),v&&(function(rt,mt,Mt){for(var Qt=Array.isArray(rt),vt=0;vt!=mt.length;++vt){var Zt=Cr(cs(mt[vt]),!0);if(!Zt.ref)return;var Br=((Mt||{})["!id"]||[])[Zt.id];Br?(Zt.Target=Br.Target,Zt.location&&(Zt.Target+="#"+ma(Zt.location))):(Zt.Target="#"+ma(Zt.location),Br={Target:Zt.Target,TargetMode:"Internal"}),Zt.Rel=Br,Zt.tooltip&&(Zt.Tooltip=Zt.tooltip,delete Zt.tooltip);for(var wr=Fa(Zt.ref),cr=wr.s.r;cr<=wr.e.r;++cr)for(var ur=wr.s.c;ur<=wr.e.c;++ur){var nr=ha({c:ur,r:cr});Qt?(rt[cr]||(rt[cr]=[]),rt[cr][ur]||(rt[cr][ur]={t:"z",v:void 0}),rt[cr][ur].l=Zt):(rt[nr]||(rt[nr]={t:"z",v:void 0}),rt[nr].l=Zt)}}})(N,v,h);var Ie,$e,st=st.match(Gg);return st&&(N["!margins"]=(Ie=Cr(st[0]),$e={},["left","right","top","bottom","header","footer"].forEach(function(rt){Ie[rt]&&($e[rt]=parseFloat(Ie[rt]))}),$e)),!N["!ref"]&&S.e.c>=S.s.c&&S.e.r>=S.s.r&&(N["!ref"]=fa(S)),0<A.sheetRows&&N["!ref"]&&(st=Fa(N["!ref"]),A.sheetRows<=+st.e.r&&(st.e.r=A.sheetRows-1,st.e.r>S.e.r&&(st.e.r=S.e.r),st.e.r<st.s.r&&(st.s.r=st.e.r),st.e.c>S.e.c&&(st.e.c=S.e.c),st.e.c<st.s.c&&(st.s.c=st.e.c),N["!fullref"]=N["!ref"],N["!ref"]=fa(st))),0<ce.length&&(N["!cols"]=ce),0<Ee.length&&(N["!merges"]=Ee),N}function Wh(o,A,d,h){o=Cr(o),d.Sheets[h]||(d.Sheets[h]={}),o.codeName&&(d.Sheets[h].CodeName=ma(cs(o.codeName)))}var Yg=["objects","scenarios","selectLockedCells","selectUnlockedCells"],oy=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"],$h=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/,cl,Sc,zp,Al,Kp,SA,Gd,nd=(cl=/<(?:\w+:)?c[ \/>]/,Sc=/<\/(?:\w+:)?row>/,zp=/r=["']([^"']*)["']/,Al=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,Kp=/ref=["']([^"']*)["']/,SA=vl("v"),Gd=vl("f"),function(o,A,d,h,x,w){for(var v,N,S,E,I,P,K=0,W="",me=[],re=[],De=0,be=0,ce="",Ee=0,Ue=0,Ie=0,$e=0,st=Array.isArray(w.CellXf),rt=[],mt=[],Mt=Array.isArray(A),Qt=[],vt={},Zt=!1,Br=!!d.sheetStubs,wr=o.split(Sc),cr=0,ur=wr.length;cr!=ur;++cr){var nr=(W=wr[cr].trim()).length;if(nr!==0){var Vt=0;e:for(K=0;K<nr;++K)switch(W[K]){case">":if(W[K-1]!="/"){++K;break e}if(d&&d.cellStyles){if(Ee=(S=Cr(W.slice(Vt,K),!0)).r!=null?parseInt(S.r,10):Ee+1,Ue=-1,d.sheetRows&&d.sheetRows<Ee)continue;Zt=!(vt={}),S.ht&&(Zt=!0,vt.hpt=parseFloat(S.ht),vt.hpx=Du(vt.hpt)),S.hidden=="1"&&(Zt=!0,vt.hidden=!0),S.outlineLevel!=null&&(Zt=!0,vt.level=+S.outlineLevel),Zt&&(Qt[Ee-1]=vt)}break;case"<":Vt=K}if(K<=Vt)break;if(Ee=(S=Cr(W.slice(Vt,K),!0)).r!=null?parseInt(S.r,10):Ee+1,Ue=-1,!(d.sheetRows&&d.sheetRows<Ee)){h.s.r>Ee-1&&(h.s.r=Ee-1),h.e.r<Ee-1&&(h.e.r=Ee-1),d&&d.cellStyles&&(Zt=!(vt={}),S.ht&&(Zt=!0,vt.hpt=parseFloat(S.ht),vt.hpx=Du(vt.hpt)),S.hidden=="1"&&(Zt=!0,vt.hidden=!0),S.outlineLevel!=null&&(Zt=!0,vt.level=+S.outlineLevel),Zt&&(Qt[Ee-1]=vt)),me=W.slice(K).split(cl);for(var kr,Rr=0;Rr!=me.length&&me[Rr].trim().charAt(0)=="<";++Rr);for(me=me.slice(Rr),K=0;K!=me.length;++K)if((W=me[K].trim()).length!==0){if(re=W.match(zp),De=K,be=0,W="<c "+(W.slice(0,1)=="<"?">":"")+W,re!=null&&re.length===2){for(De=0,ce=re[1],be=0;be!=ce.length&&!((v=ce.charCodeAt(be)-64)<1||26<v);++be)De=26*De+v;Ue=--De}else++Ue;for(be=0;be!=W.length&&W.charCodeAt(be)!==62;++be);if(++be,(S=Cr(W.slice(0,be),!0)).r||(S.r=ha({r:Ee-1,c:Ue})),N={t:""},(re=(ce=W.slice(be)).match(SA))!=null&&re[1]!==""&&(N.v=ma(re[1])),d.cellFormula){(re=ce.match(Gd))!=null&&re[1]!==""?(N.f=ma(cs(re[1])).replace(/\r\n/g,`
`),d.xlfn||(N.f=Lp(N.f)),-1<re[0].indexOf('t="array"')?(N.F=(ce.match(Kp)||[])[1],-1<N.F.indexOf(":")&&rt.push([Fa(N.F),N.F])):-1<re[0].indexOf('t="shared"')&&(I=Cr(re[0]),kr=ma(cs(re[1])),d.xlfn||(kr=Lp(kr)),mt[parseInt(I.si,10)]=[I,kr,S.r])):(re=ce.match(/<f[^>]*\/>/))&&mt[(I=Cr(re[0])).si]&&(N.f=(P=mt[I.si][1],Sr=mt[I.si][2],kr=S.r,Sr=vi(Sr).s,kr=Es(kr),_0(P,{r:kr.r-Sr.r,c:kr.c-Sr.c})));for(var na=Es(S.r),be=0;be<rt.length;++be)na.r>=rt[be][0].s.r&&na.r<=rt[be][0].e.r&&na.c>=rt[be][0].s.c&&na.c<=rt[be][0].e.c&&(N.F=rt[be][1])}if(S.t==null&&N.v===void 0)if(N.f||N.F)N.v=0,N.t="n";else{if(!Br)continue;N.t="z"}else N.t=S.t||"n";switch(h.s.c>Ue&&(h.s.c=Ue),h.e.c<Ue&&(h.e.c=Ue),N.t){case"n":if(N.v==""||N.v==null){if(!Br)continue;N.t="z"}else N.v=parseFloat(N.v);break;case"s":if(N.v===void 0){if(!Br)continue;N.t="z"}else E=Df[parseInt(N.v,10)],N.v=E.t,N.r=E.r,d.cellHTML&&(N.h=E.h);break;case"str":N.t="s",N.v=N.v!=null?cs(N.v):"",d.cellHTML&&(N.h=Gi(N.v));break;case"inlineStr":re=ce.match(Al),N.t="s",re!=null&&(E=Od(re[1]))?(N.v=E.t,d.cellHTML&&(N.h=E.h)):N.v="";break;case"b":N.v=Ps(N.v);break;case"d":d.cellDates?N.v=ba(N.v,1):(N.v=ms(ba(N.v,1)),N.t="n");break;case"e":d&&d.cellText===!1||(N.w=N.v),N.v=tl[N.v]}var Ga,Ie=$e=0,Sr=null;st&&S.s!==void 0&&(Sr=w.CellXf[S.s])!=null&&(Sr.numFmtId!=null&&(Ie=Sr.numFmtId),d.cellStyles&&Sr.fillId!=null&&($e=Sr.fillId)),BA(N,Ie,$e,d,x,w),d.cellDates&&st&&N.t=="n"&&Mr(X[Ie])&&(N.t="d",N.v=_n(N.v)),S.cm&&d.xlmeta&&(Ga=(d.xlmeta.Cell||[])[+S.cm-1])&&Ga.type=="XLDAPR"&&(N.D=!0),Mt?(A[(Ga=Es(S.r)).r]||(A[Ga.r]=[]),A[Ga.r][Ga.c]=N):A[S.r]=N}}}}0<Qt.length&&(A["!rows"]=Qt)});function Gp(o,A){for(var d,h,x,w,v=[],N=[],S=Fa(o["!ref"]),E=[],I=0,re=0,P=o["!rows"],K=Array.isArray(o),W={r:""},me=-1,re=S.s.c;re<=S.e.c;++re)E[re]=Sa(re);for(I=S.s.r;I<=S.e.r;++I){for(N=[],x=Vs(I),re=S.s.c;re<=S.e.c;++re){h=E[re]+x;var De=K?(o[I]||[])[re]:o[h];De!==void 0&&(d=(function(be,ce,Ee,Ue){if(be.c&&Ee["!comments"].push([ce,be.c]),be.v===void 0&&typeof be.f!="string"||be.t==="z"&&!be.f)return"";var Ie="",$e=be.t,st=be.v;if(be.t!=="z")switch(be.t){case"b":Ie=be.v?"1":"0";break;case"n":Ie=""+be.v;break;case"e":Ie=So[be.v];break;case"d":Ie=Ue&&Ue.cellDates?ba(be.v,-1).toISOString():((be=Oa(be)).t="n",""+(be.v=ms(ba(be.v)))),be.z===void 0&&(be.z=X[14]);break;default:Ie=be.v}var rt=Un("v",Va(Ie)),mt={r:ce},Mt=ad(Ue.cellXfs,be,Ue);switch(Mt!==0&&(mt.s=Mt),be.t){case"n":break;case"d":mt.t="d";break;case"b":mt.t="b";break;case"e":mt.t="e";break;case"z":break;default:if(be.v==null){delete be.t;break}if(32767<be.v.length)throw new Error("Text length must not exceed 32767 characters");if(Ue&&Ue.bookSST){rt=Un("v",""+Q0(Ue.Strings,be.v,Ue.revStrings)),mt.t="s";break}mt.t="str"}return be.t!=$e&&(be.t=$e,be.v=st),typeof be.f=="string"&&be.f&&(st=be.F&&be.F.slice(0,ce.length)==ce?{t:"array",ref:be.F}:null,rt=lr("f",Va(be.f),st)+(be.v!=null?rt:"")),be.l&&Ee["!links"].push([ce,be.l]),be.D&&(mt.cm=1),lr("c",rt,mt)})(De,h,o,A))!=null&&N.push(d)}(0<N.length||P&&P[I])&&(W={r:x},P&&P[I]&&((w=P[I]).hidden&&(W.hidden=1),me=-1,w.hpx?me=jf(w.hpx):w.hpt&&(me=w.hpt),-1<me&&(W.ht=me,W.customHeight=1),w.level&&(W.outlineLevel=w.level)),v[v.length]=lr("row",N.join(""),W))}if(P)for(;I<P.length;++I)P&&P[I]&&(W={r:I+1},(w=P[I]).hidden&&(W.hidden=1),me=-1,w.hpx?me=jf(w.hpx):w.hpt&&(me=w.hpt),-1<me&&(W.ht=me,W.customHeight=1),w.level&&(W.outlineLevel=w.level),v[v.length]=lr("row","",W));return v.join("")}function qh(o,A,d,h){var x,w,v=[Ba,lr("worksheet",null,{xmlns:Nl[0],"xmlns:r":Bn.r})],N=d.SheetNames[o],S=d.Sheets[N],E=(S=S??{})["!ref"]||"A1",I=Fa(E);if(16383<I.e.c||1048575<I.e.r){if(A.WTF)throw new Error("Range "+E+" exceeds format limit A1:XFD1048576");I.e.c=Math.min(I.e.c,16383),I.e.r=Math.min(I.e.c,1048575),E=fa(I)}h=h||{},S["!comments"]=[];var P,K,W=[];(function(be,ce,Ee,Ue,Ie){var $e=!1,st={},rt=null;if(Ue.bookType!=="xlsx"&&ce.vbaraw){var mt=ce.SheetNames[Ee];try{ce.Workbook&&(mt=ce.Workbook.Sheets[Ee].CodeName||mt)}catch{}$e=!0,st.codeName=aa(Va(mt))}be&&be["!outline"]&&(Ue={summaryBelow:1,summaryRight:1},be["!outline"].above&&(Ue.summaryBelow=0),be["!outline"].left&&(Ue.summaryRight=0),rt=(rt||"")+lr("outlinePr",null,Ue)),($e||rt)&&(Ie[Ie.length]=lr("sheetPr",rt,st))})(S,d,o,A,v),v[v.length]=lr("dimension",null,{ref:E}),v[v.length]=(N={workbookViewId:"0"},((((I=d)||{}).Workbook||{}).Views||[])[0]&&(N.rightToLeft=I.Workbook.Views[0].RTL?"1":"0"),lr("sheetViews",lr("sheetView",null,N),{})),A.sheetFormat&&(v[v.length]=lr("sheetFormatPr",null,{defaultRowHeight:A.sheetFormat.defaultRowHeight||"16",baseColWidth:A.sheetFormat.baseColWidth||"10",outlineLevelRow:A.sheetFormat.outlineLevelRow||"7"})),S["!cols"]!=null&&0<S["!cols"].length&&(v[v.length]=(function(be){for(var ce,Ee=["<cols>"],Ue=0;Ue!=be.length;++Ue)(ce=be[Ue])&&(Ee[Ee.length]=lr("col",null,_f(Ue,ce)));return Ee[Ee.length]="</cols>",Ee.join("")})(S["!cols"])),v[x=v.length]="<sheetData/>",S["!links"]=[],S["!ref"]!=null&&0<(w=Gp(S,A)).length&&(v[v.length]=w),v.length>x+1&&(v[v.length]="</sheetData>",v[x]=v[x].replace("/>",">")),S["!protect"]&&(v[v.length]=(P=S["!protect"],K={sheet:1},Yg.forEach(function(be){P[be]!=null&&P[be]&&(K[be]="1")}),oy.forEach(function(be){P[be]==null||P[be]||(K[be]="0")}),P.password&&(K.password=wf(P.password).toString(16).toUpperCase()),lr("sheetProtection",null,K))),S["!autofilter"]!=null&&(v[v.length]=(function(be,ce,Ee,Ue){var Ie=typeof be.ref=="string"?be.ref:fa(be.ref);Ee.Workbook||(Ee.Workbook={Sheets:[]}),Ee.Workbook.Names||(Ee.Workbook.Names=[]);var $e=Ee.Workbook.Names;(be=vi(Ie)).s.r==be.e.r&&(be.e.r=vi(ce["!ref"]).e.r,Ie=fa(be));for(var st=0;st<$e.length;++st){var rt=$e[st];if(rt.Name=="_xlnm._FilterDatabase"&&rt.Sheet==Ue){rt.Ref="'"+Ee.SheetNames[Ue]+"'!"+Ie;break}}return st==$e.length&&$e.push({Name:"_xlnm._FilterDatabase",Sheet:Ue,Ref:"'"+Ee.SheetNames[Ue]+"'!"+Ie}),lr("autoFilter",null,{ref:Ie})})(S["!autofilter"],S,d,o)),S["!merges"]!=null&&0<S["!merges"].length&&(v[v.length]=(function(be){if(be.length===0)return"";for(var ce='<mergeCells count="'+be.length+'">',Ee=0;Ee!=be.length;++Ee)ce+='<mergeCell ref="'+fa(be[Ee])+'"/>';return ce+"</mergeCells>"})(S["!merges"]));var me,re,De=-1;return 0<S["!links"].length&&(v[v.length]="<hyperlinks>",S["!links"].forEach(function(be){be[1].Target&&(re={ref:be[0]},be[1].Target.charAt(0)!="#"&&(De=ps(h,-1,Va(be[1].Target).replace(/#.*$/,""),Ta.HLINK),re["r:id"]="rId"+De),-1<(me=be[1].Target.indexOf("#"))&&(re.location=Va(be[1].Target.slice(me+1))),be[1].Tooltip&&(re.tooltip=Va(be[1].Tooltip)),v[v.length]=lr("hyperlink",null,re))}),v[v.length]="</hyperlinks>"),delete S["!links"],S["!margins"]!=null&&(v[v.length]=(jA(d=S["!margins"]),lr("pageMargins",null,d))),A&&!A.ignoreEC&&A.ignoreEC!=null||(v[v.length]=Un("ignoredErrors",lr("ignoredError",null,{numberStoredAsText:1,sqref:E}))),0<W.length&&(De=ps(h,-1,"../drawings/drawing"+(o+1)+".xml",Ta.DRAW),v[v.length]=lr("drawing",null,{"r:id":"rId"+De}),S["!drawing"]=W),0<S["!comments"].length&&(De=ps(h,-1,"../drawings/vmlDrawing"+(o+1)+".vml",Ta.VML),v[v.length]=lr("legacyDrawing",null,{"r:id":"rId"+De}),S["!legacy"]=De),1<v.length&&(v[v.length]="</worksheet>",v[1]=v[1].replace("/>",">")),v.join("")}function nA(o,A,d,h){d=(function(x,w,v){var N=Ft(145),S=(v["!rows"]||[])[x]||{};N.write_shift(4,x),N.write_shift(4,0);var I=320;S.hpx?I=20*jf(S.hpx):S.hpt&&(I=20*S.hpt),N.write_shift(2,I),N.write_shift(1,0),I=0,S.level&&(I|=S.level),S.hidden&&(I|=16),(S.hpx||S.hpt)&&(I|=32),N.write_shift(1,I),N.write_shift(1,0);var E=0,I=N.l;N.l+=4;for(var P={r:x,c:0},K=0;K<16;++K)if(!(w.s.c>K+1<<10||w.e.c<K<<10)){for(var W=-1,me=-1,re=K<<10;re<K+1<<10;++re)P.c=re,(Array.isArray(v)?(v[P.r]||[])[P.c]:v[ha(P)])&&(W<0&&(W=re),me=re);W<0||(++E,N.write_shift(4,W),N.write_shift(4,me))}return x=N.l,N.l=I,N.write_shift(4,E),N.l=x,N.length>N.l?N.slice(0,N.l):N})(h,d,A),(17<d.length||(A["!rows"]||[])[h])&&Pt(o,0,d)}var R0=zn,Lf=qi;function Uf(o){return[Ao(o),Ea(o),"n"]}var FA=zn,Mf=qi,Vp=["left","right","top","bottom","header","footer"];function Wg(o,A,d,h,x,w,v){if(A.v===void 0)return!1;var N="";switch(A.t){case"b":N=A.v?"1":"0";break;case"d":(A=Oa(A)).z=A.z||X[14],A.v=ms(ba(A.v)),A.t="n";break;case"n":case"e":N=""+A.v;break;default:N=A.v}var S,E,I,P,K,W,me,re,De,be,ce,Ee,Ue,Ie,$e,st,rt,mt,Mt,Qt,vt={r:d,c:h};switch(vt.s=ad(x.cellXfs,A,x),A.l&&w["!links"].push([ha(vt),A.l]),A.c&&w["!comments"].push([ha(vt),A.c]),A.t){case"s":case"str":return x.bookSST?(N=Q0(x.Strings,A.v,x.revStrings),vt.t="s",vt.v=N,v?Pt(o,18,(uo(rt=vt,mt=mt??Ft(8)),mt.write_shift(4,rt.v),mt)):Pt(o,7,(hc(rt=vt,st=st??Ft(12)),st.write_shift(4,rt.v),st))):(vt.t="str",v?Pt(o,17,(Ie=A,uo(vt,$e=$e??Ft(8+4*Ie.v.length)),Ys(Ie.v,$e),$e.length>$e.l?$e.slice(0,$e.l):$e)):Pt(o,6,(Ie=A,hc(vt,Ue=Ue??Ft(12+4*Ie.v.length)),Ys(Ie.v,Ue),Ue.length>Ue.l?Ue.slice(0,Ue.l):Ue))),!0;case"n":return A.v==(0|A.v)&&-1e3<A.v&&A.v<1e3?v?Pt(o,13,(ce=A,uo(vt,Ee=Ee??Ft(8)),Uo(ce.v,Ee),Ee)):Pt(o,2,(ce=A,hc(vt,be=be??Ft(12)),Uo(ce.v,be),be)):v?Pt(o,16,(re=A,uo(vt,De=De??Ft(12)),Ya(re.v,De),De)):Pt(o,5,(re=A,hc(vt,me=me??Ft(16)),Ya(re.v,me),me)),!0;case"b":return vt.t="b",v?Pt(o,15,(K=A,uo(vt,W=W??Ft(5)),W.write_shift(1,K.v?1:0),W)):Pt(o,4,(K=A,hc(vt,P=P??Ft(9)),P.write_shift(1,K.v?1:0),P)),!0;case"e":return vt.t="e",v?Pt(o,14,(E=A,uo(vt,I=I??Ft(8)),I.write_shift(1,E.v),I.write_shift(2,0),I.write_shift(1,0),I)):Pt(o,3,(E=A,hc(vt,S=S??Ft(9)),S.write_shift(1,E.v),S)),!0}return v?Pt(o,12,uo(vt,Qt=Qt??Ft(4))):Pt(o,1,hc(vt,Mt=Mt??Ft(8))),!0}function P0(o,A){var d,h;A&&A["!merges"]&&(Pt(o,177,(d=A["!merges"].length,(h=h??Ft(4)).write_shift(4,d),h)),A["!merges"].forEach(function(x){Pt(o,176,Mf(x))}),Pt(o,178))}function $g(o,A){A&&A["!cols"]&&(Pt(o,390),A["!cols"].forEach(function(d,h){d&&Pt(o,60,(function(x,w,v){v==null&&(v=Ft(18));var N=_f(x,w);return v.write_shift(-4,x),v.write_shift(-4,x),v.write_shift(4,256*(N.width||10)),v.write_shift(4,0),x=0,w.hidden&&(x|=1),typeof N.width=="number"&&(x|=2),w.level&&(x|=w.level<<8),v.write_shift(2,x),v})(h,d))}),Pt(o,391))}function Xh(o,A){var d;A&&A["!ref"]&&(Pt(o,648),Pt(o,649,(d=Fa(A["!ref"]),(A=Ft(24)).write_shift(4,4),A.write_shift(4,1),qi(d,A),A)),Pt(o,650))}function qg(o,A,d){A["!links"].forEach(function(h){var x,w;h[1].Target&&(x=ps(d,-1,h[1].Target.replace(/#.*$/,""),Ta.HLINK),Pt(o,494,(w=x,h=Ft(50+4*((x=h)[1].Target.length+(x[1].Tooltip||"").length)),qi({s:Es(x[0]),e:Es(x[0])},h),jl("rId"+w,h),Ys(((w=x[1].Target.indexOf("#"))==-1?"":x[1].Target.slice(w+1))||"",h),Ys(x[1].Tooltip||"",h),Ys("",h),h.slice(0,h.l))))}),delete A["!links"]}function ly(o,A,d){Pt(o,133),Pt(o,137,(function(h,x){x==null&&(x=Ft(30));var w=924;return(((h||{}).Views||[])[0]||{}).RTL&&(w|=32),x.write_shift(2,w),x.write_shift(4,0),x.write_shift(4,0),x.write_shift(4,0),x.write_shift(1,0),x.write_shift(1,0),x.write_shift(2,0),x.write_shift(2,100),x.write_shift(2,0),x.write_shift(2,0),x.write_shift(2,0),x.write_shift(4,0),x})(d)),Pt(o,138),Pt(o,134)}function cy(o,A){var d,h;A["!protect"]&&Pt(o,535,(d=A["!protect"],(h=h??Ft(66)).write_shift(2,d.password?wf(d.password):0),h.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(x){x[1]?h.write_shift(4,d[x[0]]==null||d[x[0]]?0:1):h.write_shift(4,d[x[0]]!=null&&d[x[0]]?0:1)}),h))}function Qs(o,A,d,h){var x=In(),E=d.SheetNames[o],w=d.Sheets[E]||{},v=E;try{d&&d.Workbook&&(v=d.Workbook.Sheets[o].CodeName||v)}catch{}var N,S,E=Fa(w["!ref"]||"A1");if(16383<E.e.c||1048575<E.e.r){if(A.WTF)throw new Error("Range "+(w["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");E.e.c=Math.min(E.e.c,16383),E.e.r=Math.min(E.e.c,1048575)}return w["!links"]=[],w["!comments"]=[],Pt(x,129),(d.vbaraw||w["!outline"])&&Pt(x,147,(function(I,P,K){K==null&&(K=Ft(84+4*I.length));var W=192;P&&(P.above&&(W&=-65),P.left&&(W&=-129)),K.write_shift(1,W);for(var me=1;me<3;++me)K.write_shift(1,0);return Os({auto:1},K),K.write_shift(-4,-1),K.write_shift(-4,-1),mc(I,K),K.slice(0,K.l)})(v,w["!outline"])),Pt(x,148,Lf(E)),ly(x,0,d.Workbook),$g(x,w),(function(I,P,K){var W,me=Fa(P["!ref"]||"A1"),re=[];Pt(I,145);var De=Array.isArray(P),be=me.e.r;P["!rows"]&&(be=Math.max(me.e.r,P["!rows"].length-1));for(var ce=me.s.r;ce<=be;++ce){W=Vs(ce),nA(I,P,me,ce);var Ee=!1;if(ce<=me.e.r)for(var Ue=me.s.c;Ue<=me.e.c;++Ue){ce===me.s.r&&(re[Ue]=Sa(Ue)),Ie=re[Ue]+W;var Ie=De?(P[ce]||[])[Ue]:P[Ie];Ie?Ee=Wg(I,Ie,ce,Ue,K,P,Ee):Ee=!1}}Pt(I,146)})(x,w,A),cy(x,w),(function(I,P,K,W){if(P["!autofilter"]){var De=P["!autofilter"],me=typeof De.ref=="string"?De.ref:fa(De.ref);K.Workbook||(K.Workbook={Sheets:[]}),K.Workbook.Names||(K.Workbook.Names=[]);var re=K.Workbook.Names,De=vi(me);De.s.r==De.e.r&&(De.e.r=vi(P["!ref"]).e.r,me=fa(De));for(var be=0;be<re.length;++be){var ce=re[be];if(ce.Name=="_xlnm._FilterDatabase"&&ce.Sheet==W){ce.Ref="'"+K.SheetNames[W]+"'!"+me;break}}be==re.length&&re.push({Name:"_xlnm._FilterDatabase",Sheet:W,Ref:"'"+K.SheetNames[W]+"'!"+me}),Pt(I,161,qi(Fa(me))),Pt(I,162)}})(x,w,d,o),P0(x,w),qg(x,w,h),w["!margins"]&&Pt(x,476,(N=w["!margins"],S==null&&(S=Ft(48)),jA(N),Vp.forEach(function(I){Ya(N[I],S)}),S)),A&&!A.ignoreEC&&A.ignoreEC!=null||Xh(x,w),E=x,A=o,h=h,0<(w=w)["!comments"].length&&(A=ps(h,-1,"../drawings/vmlDrawing"+(A+1)+".vml",Ta.VML),Pt(E,551,jl("rId"+A)),w["!legacy"]=A),Pt(x,130),x.end()}function yn(o,A,d,h,x,w){var v=w||{"!type":"chart"};if(!o)return w;var N,S=0,E=0,I={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(o.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(P){var K=(function(W){var me,re=[],De=W.match(/^<c:numCache>/);(W.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(ce){ce=ce.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/),ce&&(re[+ce[1]]=De?+ce[2]:ce[2])});var be=ma((W.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(W.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(ce){me=ce.replace(/<.*?>/g,"")}),[re,be,me]})(P);I.s.r=I.s.c=0,I.e.c=S,N=Sa(S),K[0].forEach(function(W,me){v[N+Vs(me)]={t:"n",v:W,z:K[1]},E=me}),I.e.r<E&&(I.e.r=E),++S}),0<S&&(v["!ref"]=fa(I)),v}var Xa=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],ds=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Xs=[],Xl=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function id(o,A){for(var d=0;d!=o.length;++d)for(var h=o[d],x=0;x!=A.length;++x){var w=A[x];if(h[w[0]]==null)h[w[0]]=w[1];else switch(w[2]){case"bool":typeof h[w[0]]=="string"&&(h[w[0]]=Ps(h[w[0]]));break;case"int":typeof h[w[0]]=="string"&&(h[w[0]]=parseInt(h[w[0]],10))}}}function Uu(o,A){for(var d=0;d!=A.length;++d){var h=A[d];if(o[h[0]]==null)o[h[0]]=h[1];else switch(h[2]){case"bool":typeof o[h[0]]=="string"&&(o[h[0]]=Ps(o[h[0]]));break;case"int":typeof o[h[0]]=="string"&&(o[h[0]]=parseInt(o[h[0]],10))}}}function Jh(o){Uu(o.WBProps,Xa),Uu(o.CalcPr,Xl),id(o.WBView,ds),id(o.Sheets,Xs),Kd.date1904=Ps(o.WBProps.date1904)}var od="][*?/\\".split("");function ni(o,A){if(31<o.length)throw new Error("Sheet names cannot exceed 31 chars");var d=!0;return od.forEach(function(h){if(o.indexOf(h)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),d}function ld(o){if(!o||!o.SheetNames||!o.Sheets)throw new Error("Invalid Workbook");if(!o.SheetNames.length)throw new Error("Workbook is empty");var A,d,h,x=o.Workbook&&o.Workbook.Sheets||[];A=o.SheetNames,d=x,h=!!o.vbaraw,A.forEach(function(v,N){ni(v);for(var S=0;S<N;++S)if(v==A[S])throw new Error("Duplicate Sheet Name: "+v);if(h){var E=d&&d[N]&&d[N].CodeName||v;if(E.charCodeAt(0)==95&&22<E.length)throw new Error("Bad Code Name: Worksheet"+E)}});for(var w=0;w<o.SheetNames.length;++w)(function(v,N){if(v&&v["!ref"]){var S=Fa(v["!ref"]);if(S.e.c<S.s.c||S.e.r<S.s.r)throw new Error("Bad range ("+N+"): "+v["!ref"])}})(o.Sheets[o.SheetNames[w]],(o.SheetNames[w],w))}var Mu=/<\w+:workbook/;function Zh(o){var A=[Ba];A[A.length]=lr("workbook",null,{xmlns:Nl[0],"xmlns:r":Bn.r});var d=o.Workbook&&0<(o.Workbook.Names||[]).length,h={codeName:"ThisWorkbook"};o.Workbook&&o.Workbook.WBProps&&(Xa.forEach(function(N){o.Workbook.WBProps[N[0]]!=null&&o.Workbook.WBProps[N[0]]!=N[1]&&(h[N[0]]=o.Workbook.WBProps[N[0]])}),o.Workbook.WBProps.CodeName&&(h.codeName=o.Workbook.WBProps.CodeName,delete h.CodeName)),A[A.length]=lr("workbookPr",null,h);var x=o.Workbook&&o.Workbook.Sheets||[],w=0;if(x&&x[0]&&x[0].Hidden){for(A[A.length]="<bookViews>",w=0;w!=o.SheetNames.length&&x[w]&&x[w].Hidden;++w);w==o.SheetNames.length&&(w=0),A[A.length]='<workbookView firstSheet="'+w+'" activeTab="'+w+'"/>',A[A.length]="</bookViews>"}for(A[A.length]="<sheets>",w=0;w!=o.SheetNames.length;++w){var v={name:Va(o.SheetNames[w].slice(0,31))};if(v.sheetId=""+(w+1),v["r:id"]="rId"+(w+1),x[w])switch(x[w].Hidden){case 1:v.state="hidden";break;case 2:v.state="veryHidden"}A[A.length]=lr("sheet",null,v)}return A[A.length]="</sheets>",d&&(A[A.length]="<definedNames>",o.Workbook&&o.Workbook.Names&&o.Workbook.Names.forEach(function(N){var S={name:N.Name};N.Comment&&(S.comment=N.Comment),N.Sheet!=null&&(S.localSheetId=""+N.Sheet),N.Hidden&&(S.hidden="1"),N.Ref&&(A[A.length]=lr("definedName",Va(N.Ref),S))}),A[A.length]="</definedNames>"),2<A.length&&(A[A.length]="</workbook>",A[1]=A[1].replace("/>",">")),A.join("")}function Jl(o,A){var d={};return o.read_shift(4),d.ArchID=o.read_shift(4),o.l+=A-8,d}function If(o,A){Pt(o,143);for(var d,h=0;h!=A.SheetNames.length;++h){var x={Hidden:A.Workbook&&A.Workbook.Sheets&&A.Workbook.Sheets[h]&&A.Workbook.Sheets[h].Hidden||0,iTabID:h+1,strRelID:"rId"+(h+1),name:A.SheetNames[h]};Pt(o,156,(d=x,(x=(x=void 0)||Ft(127)).write_shift(4,d.Hidden),x.write_shift(4,d.iTabID),jl(d.strRelID,x),Ys(d.name.slice(0,31),x),x.length>x.l?x.slice(0,x.l):x))}Pt(o,144)}function H0(o,A){if(A.Workbook&&A.Workbook.Sheets){for(var d,h=A.Workbook.Sheets,x=0,w=-1,v=-1;x<h.length;++x)!h[x]||!h[x].Hidden&&w==-1?w=x:h[x].Hidden==1&&v==-1&&(v=x);w<v||(Pt(o,135),Pt(o,158,(A=w,(d=d||Ft(29)).write_shift(-4,0),d.write_shift(-4,460),d.write_shift(4,28800),d.write_shift(4,17600),d.write_shift(4,500),d.write_shift(4,A),d.write_shift(4,A),d.write_shift(1,120),d.length>d.l?d.slice(0,d.l):d)),Pt(o,136))}}function kl(o,A){var d=In();return Pt(d,131),Pt(d,128,(function(h){h=h||Ft(127);for(var x=0;x!=4;++x)h.write_shift(4,0);return Ys("SheetJS",h),Ys(s.version,h),Ys(s.version,h),Ys("7262",h),h.length>h.l?h.slice(0,h.l):h})()),Pt(d,153,(function(h,x){x=x||Ft(72);var w=0;return h&&h.filterPrivacy&&(w|=8),x.write_shift(4,w),x.write_shift(4,0),mc(h&&h.CodeName||"ThisWorkbook",x),x.slice(0,x.l)})(o.Workbook&&o.Workbook.WBProps||null)),H0(d,o),If(d,o),Pt(d,132),d.end()}function Yp(o,A,d){return(A.slice(-4)===".bin"?function(h,x){var w={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},v=[],N=!1;(x=x||{}).biff=12;var S=[],E=[[]];return E.SheetNames=[],E.XTI=[],Iu[16]={n:"BrtFRTArchID$",f:Jl},Bo(h,function(I,P,K){switch(K){case 156:E.SheetNames.push(I.name),w.Sheets.push(I);break;case 153:w.WBProps=I;break;case 39:I.Sheet!=null&&(x.SID=I.Sheet),I.Ref=Ho(I.Ptg,0,null,E,x),delete x.SID,delete I.Ptg,S.push(I);break;case 1036:break;case 357:case 358:case 355:case 667:E[0].length?E.push([K,I]):E[0]=[K,I],E[E.length-1].XTI=[];break;case 362:E.length===0&&(E[0]=[],E[0].XTI=[]),E[E.length-1].XTI=E[E.length-1].XTI.concat(I),E.XTI=E.XTI.concat(I);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:v.push(K),N=!0;break;case 36:v.pop(),N=!1;break;case 37:v.push(K),N=!0;break;case 38:v.pop(),N=!1;break;case 16:break;default:if(!P.T&&(!N||x.WTF&&v[v.length-1]!=37&&v[v.length-1]!=35))throw new Error("Unexpected record 0x"+K.toString(16))}},x),Jh(w),w.Names=S,w.supbooks=E,w}:function(h,x){if(!h)throw new Error("Could not find file");var w={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},v=!1,N="xmlns",S={},E=0;if(h.replace(ns,function(I,P){var K=Cr(I);switch(rn(K[0])){case"<?xml":break;case"<workbook":I.match(Mu)&&(N="xmlns"+I.match(/<(\w+):/)[1]),w.xmlns=K[N];break;case"</workbook>":break;case"<fileVersion":delete K[0],w.AppVersion=K;break;case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Xa.forEach(function(W){if(K[W[0]]!=null)switch(W[2]){case"bool":w.WBProps[W[0]]=Ps(K[W[0]]);break;case"int":w.WBProps[W[0]]=parseInt(K[W[0]],10);break;default:w.WBProps[W[0]]=K[W[0]]}}),K.codeName&&(w.WBProps.CodeName=cs(K.codeName));break;case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete K[0],w.WBView.push(K);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(K.state){case"hidden":K.Hidden=1;break;case"veryHidden":K.Hidden=2;break;default:K.Hidden=0}delete K.state,K.name=ma(cs(K.name)),delete K[0],w.Sheets.push(K);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":break;case"<definedNames>":case"<definedNames":v=!0;break;case"</definedNames>":v=!1;break;case"<definedName":(S={}).Name=cs(K.name),K.comment&&(S.Comment=K.comment),K.localSheetId&&(S.Sheet=+K.localSheetId),Ps(K.hidden||"0")&&(S.Hidden=!0),E=P+I.length;break;case"</definedName>":S.Ref=ma(cs(h.slice(E,P))),w.Names.push(S);break;case"<definedName/>":break;case"<calcPr":case"<calcPr/>":delete K[0],w.CalcPr=K;break;case"</calcPr>":case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":v=!0;break;case"</ext>":v=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":v=!0;break;case"</AlternateContent>":v=!1;break;case"<revisionPtr":break;default:if(!v&&x.WTF)throw new Error("unrecognized "+K[0]+" in workbook")}return I}),Nl.indexOf(w.xmlns)===-1)throw new Error("Unknown Namespace: "+w.xmlns);return Jh(w),w})(o,d)}function em(o,A,d,h,x,w,v,N){return(A.slice(-4)===".bin"?function(S,E,I,P,K,W,me){if(!S)return S;var re=E||{};P=P||{"!id":{}};var De,be,ce,Ee,Ue,Ie,$e,st,rt,mt,Mt=re.dense?[]:{},Qt={s:{r:2e6,c:2e6},e:{r:0,c:0}},vt=!1,Zt=!1,Br=[];re.biff=12;var wr=re["!row"]=0,cr=!1,ur=[],nr={},Vt=re.supbooks||K.supbooks||[[]];if(Vt.sharedf=nr,Vt.arrayf=ur,Vt.SheetNames=K.SheetNames||K.Sheets.map(function(er){return er.name}),!re.supbooks&&(re.supbooks=Vt,K.Names))for(var kr=0;kr<K.Names.length;++kr)Vt[0][kr+1]=K.Names[kr];var Rr,na=[],Ga=[],Sr=!1;return Iu[16]={n:"BrtShortReal",f:Uf},Bo(S,function(er,Na,is){if(!Zt)switch(is){case 148:De=er;break;case 0:be=er,re.sheetRows&&re.sheetRows<=be.r&&(Zt=!0),rt=Vs(Ue=be.r),re["!row"]=be.r,(er.hidden||er.hpt||er.level!=null)&&(er.hpt&&(er.hpx=Du(er.hpt)),Ga[er.r]=er);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(ce={t:er[2]},er[2]){case"n":ce.v=er[1];break;case"s":st=Df[er[1]],ce.v=st.t,ce.r=st.r;break;case"b":ce.v=!!er[1];break;case"e":ce.v=er[1],re.cellText!==!1&&(ce.w=So[ce.v]);break;case"str":ce.t="s",ce.v=er[1];break;case"is":ce.t="s",ce.v=er[1].t}if((Ee=me.CellXf[er[0].iStyleRef])&&BA(ce,Ee.numFmtId,null,re,W,me),Ie=er[0].c==-1?Ie+1:er[0].c,re.dense?(Mt[Ue]||(Mt[Ue]=[]),Mt[Ue][Ie]=ce):Mt[Sa(Ie)+rt]=ce,re.cellFormula){for(cr=!1,wr=0;wr<ur.length;++wr){var Ja=ur[wr];be.r>=Ja[0].s.r&&be.r<=Ja[0].e.r&&Ie>=Ja[0].s.c&&Ie<=Ja[0].e.c&&(ce.F=fa(Ja[0]),cr=!0)}!cr&&3<er.length&&(ce.f=er[3])}Qt.s.r>be.r&&(Qt.s.r=be.r),Qt.s.c>Ie&&(Qt.s.c=Ie),Qt.e.r<be.r&&(Qt.e.r=be.r),Qt.e.c<Ie&&(Qt.e.c=Ie),re.cellDates&&Ee&&ce.t=="n"&&Mr(X[Ee.numFmtId])&&(Ls=ve(ce.v))&&(ce.t="d",ce.v=new Date(Ls.y,Ls.m-1,Ls.d,Ls.H,Ls.M,Ls.S,Ls.u)),Rr&&(Rr.type=="XLDAPR"&&(ce.D=!0),Rr=void 0);break;case 1:case 12:if(!re.sheetStubs||vt)break;ce={t:"z",v:void 0},Ie=er[0].c==-1?Ie+1:er[0].c,re.dense?(Mt[Ue]||(Mt[Ue]=[]),Mt[Ue][Ie]=ce):Mt[Sa(Ie)+rt]=ce,Qt.s.r>be.r&&(Qt.s.r=be.r),Qt.s.c>Ie&&(Qt.s.c=Ie),Qt.e.r<be.r&&(Qt.e.r=be.r),Qt.e.c<Ie&&(Qt.e.c=Ie),Rr&&(Rr.type=="XLDAPR"&&(ce.D=!0),Rr=void 0);break;case 176:Br.push(er);break;case 49:Rr=((re.xlmeta||{}).Cell||[])[er-1];break;case 494:var Ls=P["!id"][er.relId];for(Ls?(er.Target=Ls.Target,er.loc&&(er.Target+="#"+er.loc),er.Rel=Ls):er.relId==""&&(er.Target="#"+er.loc),Ue=er.rfx.s.r;Ue<=er.rfx.e.r;++Ue)for(Ie=er.rfx.s.c;Ie<=er.rfx.e.c;++Ie)re.dense?(Mt[Ue]||(Mt[Ue]=[]),Mt[Ue][Ie]||(Mt[Ue][Ie]={t:"z",v:void 0}),Mt[Ue][Ie].l=er):($e=ha({c:Ie,r:Ue}),Mt[$e]||(Mt[$e]={t:"z",v:void 0}),Mt[$e].l=er);break;case 426:if(!re.cellFormula)break;ur.push(er),(mt=re.dense?Mt[Ue][Ie]:Mt[Sa(Ie)+rt]).f=Ho(er[1],0,{r:be.r,c:Ie},Vt,re),mt.F=fa(er[0]);break;case 427:if(!re.cellFormula)break;nr[ha(er[0].s)]=er[1],(mt=re.dense?Mt[Ue][Ie]:Mt[Sa(Ie)+rt]).f=Ho(er[1],0,{r:be.r,c:Ie},Vt,re);break;case 60:if(!re.cellStyles)break;for(;er.e>=er.s;)na[er.e--]={width:er.w/256,hidden:!!(1&er.flags),level:er.level},Sr||(Sr=!0,F0(er.w/256)),Rd(na[er.e+1]);break;case 161:Mt["!autofilter"]={ref:fa(er)};break;case 476:Mt["!margins"]=er;break;case 147:K.Sheets[I]||(K.Sheets[I]={}),er.name&&(K.Sheets[I].CodeName=er.name),(er.above||er.left)&&(Mt["!outline"]={above:er.above,left:er.left});break;case 137:K.Views||(K.Views=[{}]),K.Views[0]||(K.Views[0]={}),er.RTL&&(K.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:vt=!0;break;case 36:vt=!1;break;case 37:vt=!0;break;case 38:vt=!1;break;default:if(!Na.T&&(!vt||re.WTF))throw new Error("Unexpected record 0x"+is.toString(16))}},re),delete re.supbooks,delete re["!row"],!Mt["!ref"]&&(Qt.s.r<2e6||De&&(0<De.e.r||0<De.e.c||0<De.s.r||0<De.s.c))&&(Mt["!ref"]=fa(De||Qt)),re.sheetRows&&Mt["!ref"]&&(S=Fa(Mt["!ref"]),re.sheetRows<=+S.e.r&&(S.e.r=re.sheetRows-1,S.e.r>Qt.e.r&&(S.e.r=Qt.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>Qt.e.c&&(S.e.c=Qt.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),Mt["!fullref"]=Mt["!ref"],Mt["!ref"]=fa(S))),0<Br.length&&(Mt["!merges"]=Br),0<na.length&&(Mt["!cols"]=na),0<Ga.length&&(Mt["!rows"]=Ga),Mt}:Vg)(o,h,d,x,w,v,N)}function Xg(o,A,d,h,x,w){return A.slice(-4)===".bin"?(function(v,N,S,E,I){if(!v)return v;E=E||{"!id":{}};var P={"!type":"chart","!drawel":null,"!rel":""},K=!1;return Bo(v,function(W,me,re){switch(re){case 550:P["!rel"]=W;break;case 651:I.Sheets[S]||(I.Sheets[S]={}),W.name&&(I.Sheets[S].CodeName=W.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:K=!0;break;case 36:K=!1;break;case 37:break;case 38:break;default:if(!(0<me.T)){if(!(me.T<0)){if(!K||N.WTF)throw new Error("Unexpected record 0x"+re.toString(16))}}}},N),E["!id"][P["!rel"]]&&(P["!drawel"]=E["!id"][P["!rel"]]),P})(o,h,d,x,w):(function(v,N,S,E){if(!v)return v;S=S||{"!id":{}};var I={"!type":"chart","!drawel":null,"!rel":""},P=v.match(Qn);return P&&Wh(P[0],0,E,N),(v=v.match(/drawing r:id="(.*?)"/))&&(I["!rel"]=v[1]),S["!id"][I["!rel"]]&&(I["!drawel"]=S["!id"][I["!rel"]]),I})(o,d,x,w)}function tm(o,A,d,h){return(A.slice(-4)===".bin"?function(x,w,v){var N,S={NumberFmt:[]};for(N in X)S.NumberFmt[N]=X[N];S.CellXf=[],S.Fonts=[];var E=[],I=!1;return Bo(x,function(P,K,W){switch(W){case 44:S.NumberFmt[P[0]]=P[1],Gr(P[1],P[0]);break;case 43:S.Fonts.push(P),P.color.theme!=null&&w&&w.themeElements&&w.themeElements.clrScheme&&(P.color.rgb=Fl(w.themeElements.clrScheme[P.color.theme].rgb,P.color.tint||0));break;case 1025:case 45:case 46:break;case 47:E[E.length-1]==617&&S.CellXf.push(P);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:I=!0;break;case 36:I=!1;break;case 37:E.push(W),I=!0;break;case 38:E.pop(),I=!1;break;default:if(0<K.T)E.push(W);else if(K.T<0)E.pop();else if(!I||v.WTF&&E[E.length-1]!=37)throw new Error("Unexpected record 0x"+W.toString(16))}}),S}:Np)(o,d,h)}function rm(o,A,d){return A.slice(-4)===".bin"?(h=d,w=!(x=[]),Bo(o,function(v,N,S){switch(S){case 159:x.Count=v[0],x.Unique=v[1];break;case 19:x.push(v);break;case 160:return 1;case 35:w=!0;break;case 36:w=!1;break;default:if(N.T,!w||h.WTF)throw new Error("Unexpected record 0x"+S.toString(16))}}),x):(function(v,N){var S=[],E="";if(!v)return S;if(v=v.match(Mi)){E=v[2].replace($n,"").split(Su);for(var I=0;I!=E.length;++I){var P=Od(E[I].trim(),N);P!=null&&(S[S.length]=P)}v=Cr(v[1]),S.Count=v.count,S.Unique=v.uniqueCount}return S})(o,d);var h,x,w}function Vd(o,A,d){return A.slice(-4)===".bin"?(h=d,x=[],w=[],N=!(v={}),Bo(o,function(S,E,I){switch(I){case 632:w.push(S);break;case 635:v=S;break;case 637:v.t=S.t,v.h=S.h,v.r=S.r;break;case 636:if(v.author=w[v.iauthor],delete v.iauthor,h.sheetRows&&v.rfx&&h.sheetRows<=v.rfx.r)break;v.t||(v.t=""),delete v.rfx,x.push(v);break;case 3072:break;case 35:N=!0;break;case 36:N=!1;break;case 37:case 38:break;default:if(!E.T&&(!N||h.WTF))throw new Error("Unexpected record 0x"+I.toString(16))}}),x):(function(S,E){if(S.match(/<(?:\w+:)?comments *\/>/))return[];var I=[],P=[],K=S.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);return K&&K[1]&&K[1].split(/<\/\w*:?author>/).forEach(function(W){W===""||W.trim()===""||(W=W.match(/<(?:\w+:)?author[^>]*>(.*)/))&&I.push(W[1])}),(S=S.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/))&&S[1]&&S[1].split(/<\/\w*:?comment>/).forEach(function(W){var me,re;W===""||W.trim()===""||(me=W.match(/<(?:\w+:)?comment[^>]*>/))&&(me={author:(re=Cr(me[0])).authorId&&I[re.authorId]||"sheetjsghost",ref:re.ref,guid:re.guid},re=Es(re.ref),E.sheetRows&&E.sheetRows<=re.r||(W=!!(W=W.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/))&&!!W[1]&&Od(W[1])||{r:"",t:"",h:""},me.r=W.r,W.r=="<t></t>"&&(W.t=W.h=""),me.t=(W.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),E.cellHTML&&(me.h=W.h),P.push(me)))}),P})(o,d);var h,x,w,v,N}function Zi(o,A){return A.slice(-4)===".bin"?(d=[],Bo(o,function(h,x,w){if(w===63)d.push(h);else if(!x.T)throw new Error("Unexpected record 0x"+w.toString(16))}),d):(function(h){var x=[];if(!h)return x;var w=1;return(h.match(ns)||[]).forEach(function(v){var N=Cr(v);switch(N[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete N[0],N.i?w=N.i:N.i=w,x.push(N)}}),x})(o);var d}function Yd(o,A,d,h){if(d.slice(-4)===".bin")return(function(x,w){if(!x)return x;var v=w||{},N=!1;Bo(x,function(S,E,I){switch(I){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:N=!0;break;case 36:N=!1;break;default:if(!E.T&&(!N||v.WTF))throw new Error("Unexpected record 0x"+I.toString(16))}},v)})(o,h)}function Of(o,A,d){return A.slice(-4)===".bin"?(h={Types:[],Cell:[],Value:[]},x=d||{},v=!(w=[]),N=2,Bo(o,function(S,E,I){switch(I){case 335:h.Types.push({name:S.name});break;case 51:S.forEach(function(P){N==1?h.Cell.push({type:h.Types[P[0]-1].name,index:P[1]}):N==0&&h.Value.push({type:h.Types[P[0]-1].name,index:P[1]})});break;case 337:N=S?1:0;break;case 338:N=2;break;case 35:w.push(I),v=!0;break;case 36:w.pop(),v=!1;break;default:if(!E.T&&(!v||x.WTF&&w[w.length-1]!=35))throw new Error("Unexpected record 0x"+I.toString(16))}}),h):(function(S,E){var I={Types:[],Cell:[],Value:[]};if(!S)return I;var P,K=!1,W=2;return S.replace(ns,function(me){var re=Cr(me);switch(rn(re[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":I.Types.push({name:re.name});break;case"</metadataType>":break;case"<futureMetadata":for(var De=0;De<I.Types.length;++De)I.Types[De].name==re.name&&(P=I.Types[De]);break;case"</futureMetadata>":case"<bk>":case"</bk>":break;case"<rc":W==1?I.Cell.push({type:I.Types[re.t-1].name,index:+re.v}):W==0&&I.Value.push({type:I.Types[re.t-1].name,index:+re.v});break;case"</rc>":break;case"<cellMetadata":W=1;break;case"</cellMetadata>":W=2;break;case"<valueMetadata":W=0;break;case"</valueMetadata>":W=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":K=!0;break;case"</ext>":K=!1;break;case"<rvb":if(!P)break;P.offsets||(P.offsets=[]),P.offsets.push(+re.i);break;default:if(!K&&E.WTF)throw new Error("unrecognized "+re[0]+" in metadata")}return me}),I})(o,d);var h,x,w,v,N}var Zl,am=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,sm=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Fc(o,A){var d=o.split(/\s+/),h=[];if(h[0]=d[0],d.length===1)return h;var x,w,v,N=o.match(am);if(N)for(v=0;v!=N.length;++v)(w=(x=N[v].match(sm))[1].indexOf(":"))===-1?h[x[1]]=x[2].slice(1,x[2].length-1):h[x[1].slice(0,6)==="xmlns:"?"xmlns"+x[1].slice(6):x[1].slice(w+1)]=x[2].slice(1,x[2].length-1);return h}function z0(o,A,d){if(o.t!=="z"){if(!d||d.cellText!==!1)try{o.t==="e"?o.w=o.w||So[o.v]:A==="General"?o.t==="n"?(0|o.v)===o.v?o.w=o.v.toString(10):o.w=Se(o.v):o.w=ft(o.v):o.w=(h=A||"General",x=o.v,(h=Zl[h]||ma(h))==="General"?ft(x):pr(h,x))}catch(v){if(d.WTF)throw v}var h,x;try{var w=Zl[A]||A||"General";d.cellNF&&(o.z=w),d.cellDates&&o.t=="n"&&Mr(w)&&(w=ve(o.v))&&(o.t="d",o.v=new Date(w.y,w.m-1,w.d,w.H,w.M,w.S,w.u))}catch(v){if(d.WTF)throw v}}}function K0(o,A){var d=A||{};wa();var h,x=_(Mc(o)),w=(x=d.type=="binary"||d.type=="array"||d.type=="base64"?e!==void 0?e.utils.decode(65001,C(x)):cs(x):x).slice(0,1024).toLowerCase(),v=!1;if((1023&(w=w.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&w.indexOf(","),1023&w.indexOf(";"))){var N=Oa(d);return N.type="string",qa.to_workbook(x,N)}if(w.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(We){0<=w.indexOf("<"+We)&&(v=!0)}),v)return(function(We,Wt){if(We=We.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi),!We||We.length==0)throw new Error("Invalid HTML: could not find <table>");if(We.length==1)return ki(W0(We[0],Wt),Wt);var pt=u1();return We.forEach(function(Bt,dt){Cm(pt,W0(Bt,Wt),"Sheet"+(dt+1))}),pt})(x,d);Zl={"General Number":"General","General Date":X[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":X[15],"Short Date":X[14],"Long Time":X[19],"Medium Time":X[18],"Short Time":X[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:X[2],Standard:X[4],Percent:X[10],Scientific:X[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var S,E=[],I,P={},K=[],W=d.dense?[]:{},me="",re={},De={},be=Fc('<Data ss:Type="String">'),ce=0,Ee=0,Ue=0,Ie={s:{r:2e6,c:2e6},e:{r:0,c:0}},$e={},st={},rt="",mt=0,Mt=[],Qt={},vt={},Zt=0,Br=[],wr=[],cr={},ur=[],nr=!1,Vt=[],kr=[],Rr={},na=0,Ga=0,Sr={Sheets:[],WBProps:{date1904:!1}},er={};Zo.lastIndex=0,x=x.replace(/<!--([\s\S]*?)-->/gm,"");for(var Na,is,Ja,Ls,Zn="";h=Zo.exec(x);)switch(h[3]=(Zn=h[3]).toLowerCase()){case"data":if(Zn=="data"){if(h[1]==="/"){if((S=E.pop())[0]!==h[3])throw new Error("Bad state: "+S.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&E.push([h[3],!0]);break}if(E[E.length-1][1])break;h[1]==="/"?(function(We,Wt,pt,Bt,dt,Tt,tr,_r,Dr,yr){var Lr="General",Jr=Bt.StyleID,qr={};yr=yr||{};var fr=[],sr=0;for((Jr=Jr===void 0&&_r?_r.StyleID:Jr)===void 0&&tr&&(Jr=tr.StyleID);Tt[Jr]!==void 0&&(Tt[Jr].nf&&(Lr=Tt[Jr].nf),Tt[Jr].Interior&&fr.push(Tt[Jr].Interior),Tt[Jr].Parent);)Jr=Tt[Jr].Parent;switch(pt.Type){case"Boolean":Bt.t="b",Bt.v=Ps(We);break;case"String":Bt.t="s",Bt.r=ls(ma(We)),Bt.v=-1<We.indexOf("<")?ma(Wt||We).replace(/<.*?>/g,""):Bt.r;break;case"DateTime":We.slice(-1)!="Z"&&(We+="Z"),Bt.v=(ba(We)-new Date(Date.UTC(1899,11,30)))/864e5,Bt.v!=Bt.v?Bt.v=ma(We):Bt.v<60&&(Bt.v=Bt.v-1),Lr&&Lr!="General"||(Lr="yyyy-mm-dd");case"Number":Bt.v===void 0&&(Bt.v=+We),Bt.t||(Bt.t="n");break;case"Error":Bt.t="e",Bt.v=tl[We],yr.cellText!==!1&&(Bt.w=We);break;default:We==""&&Wt==""?Bt.t="z":(Bt.t="s",Bt.v=ls(Wt||We))}if(z0(Bt,Lr,yr),yr.cellFormula!==!1)if(Bt.Formula)pt=ma(Bt.Formula),pt.charCodeAt(0)==61&&(pt=pt.slice(1)),Bt.f=Tu(pt,dt),delete Bt.Formula,Bt.ArrayRange=="RC"?Bt.F=Tu("RC:RC",dt):Bt.ArrayRange&&(Bt.F=Tu(Bt.ArrayRange,dt),Dr.push([Fa(Bt.F),Bt.F]));else for(sr=0;sr<Dr.length;++sr)dt.r>=Dr[sr][0].s.r&&dt.r<=Dr[sr][0].e.r&&dt.c>=Dr[sr][0].s.c&&dt.c<=Dr[sr][0].e.c&&(Bt.F=Dr[sr][1]);yr.cellStyles&&(fr.forEach(function(Zr){!qr.patternType&&Zr.patternType&&(qr.patternType=Zr.patternType)}),Bt.s=qr),Bt.StyleID!==void 0&&(Bt.ixfe=Bt.StyleID)})(x.slice(ce,h.index),rt,be,E[E.length-1][0]=="comment"?cr:re,{c:Ee,r:Ue},$e,ur[Ee],De,Vt,d):(rt="",be=Fc(h[0]),ce=h.index+h[0].length);break;case"cell":if(h[1]==="/")if(0<wr.length&&(re.c=wr),(!d.sheetRows||d.sheetRows>Ue)&&re.v!==void 0&&(d.dense?(W[Ue]||(W[Ue]=[]),W[Ue][Ee]=re):W[Sa(Ee)+Vs(Ue)]=re),re.HRef&&(re.l={Target:ma(re.HRef)},re.HRefScreenTip&&(re.l.Tooltip=re.HRefScreenTip),delete re.HRef,delete re.HRefScreenTip),(re.MergeAcross||re.MergeDown)&&(na=Ee+(0|parseInt(re.MergeAcross,10)),Ga=Ue+(0|parseInt(re.MergeDown,10)),Mt.push({s:{c:Ee,r:Ue},e:{c:na,r:Ga}})),d.sheetStubs)if(re.MergeAcross||re.MergeDown){for(var Je=Ee;Je<=na;++Je)for(var Us=Ue;Us<=Ga;++Us)(Ee<Je||Ue<Us)&&(d.dense?(W[Us]||(W[Us]=[]),W[Us][Je]={t:"z"}):W[Sa(Je)+Vs(Us)]={t:"z"});Ee=na+1}else++Ee;else re.MergeAcross?Ee=na+1:++Ee;else(Ee=(re=(function(We){var Wt={};if(We.split(/\s+/).length===1)return Wt;var pt,Bt,dt,Tt=We.match(am);if(Tt)for(dt=0;dt!=Tt.length;++dt)(Bt=(pt=Tt[dt].match(sm))[1].indexOf(":"))===-1?Wt[pt[1]]=pt[2].slice(1,pt[2].length-1):Wt[pt[1].slice(0,6)==="xmlns:"?"xmlns"+pt[1].slice(6):pt[1].slice(Bt+1)]=pt[2].slice(1,pt[2].length-1);return Wt})(h[0])).Index?+re.Index-1:Ee)<Ie.s.c&&(Ie.s.c=Ee),Ee>Ie.e.c&&(Ie.e.c=Ee),h[0].slice(-2)==="/>"&&++Ee,wr=[];break;case"row":h[1]==="/"||h[0].slice(-2)==="/>"?(Ue<Ie.s.r&&(Ie.s.r=Ue),Ue>Ie.e.r&&(Ie.e.r=Ue),h[0].slice(-2)==="/>"&&(De=Fc(h[0])).Index&&(Ue=+De.Index-1),Ee=0,++Ue):((De=Fc(h[0])).Index&&(Ue=+De.Index-1),Rr={},De.AutoFitHeight!="0"&&!De.Height||(Rr.hpx=parseInt(De.Height,10),Rr.hpt=jf(Rr.hpx),kr[Ue]=Rr),De.Hidden=="1"&&(Rr.hidden=!0,kr[Ue]=Rr));break;case"worksheet":if(h[1]==="/"){if((S=E.pop())[0]!==h[3])throw new Error("Bad state: "+S.join("|"));K.push(me),Ie.s.r<=Ie.e.r&&Ie.s.c<=Ie.e.c&&(W["!ref"]=fa(Ie),d.sheetRows&&d.sheetRows<=Ie.e.r&&(W["!fullref"]=W["!ref"],Ie.e.r=d.sheetRows-1,W["!ref"]=fa(Ie))),Mt.length&&(W["!merges"]=Mt),0<ur.length&&(W["!cols"]=ur),0<kr.length&&(W["!rows"]=kr),P[me]=W}else Ie={s:{r:2e6,c:2e6},e:{r:0,c:0}},Ue=Ee=0,E.push([h[3],!1]),S=Fc(h[0]),me=ma(S.Name),W=d.dense?[]:{},Mt=[],Vt=[],kr=[],er={name:me,Hidden:0},Sr.Sheets.push(er);break;case"table":if(h[1]==="/"){if((S=E.pop())[0]!==h[3])throw new Error("Bad state: "+S.join("|"))}else{if(h[0].slice(-2)=="/>")break;E.push([h[3],!1]),nr=!(ur=[])}break;case"style":h[1]==="/"?(is=$e,Ja=st,(Ls=d).cellStyles&&(!Ja.Interior||(Ls=Ja.Interior).Pattern&&(Ls.patternType=wg[Ls.Pattern]||Ls.Pattern)),is[Ja.ID]=Ja):st=Fc(h[0]);break;case"numberformat":st.nf=ma(Fc(h[0]).Format||"General"),Zl[st.nf]&&(st.nf=Zl[st.nf]);for(var bs=0;bs!=392&&X[bs]!=st.nf;++bs);if(bs==392){for(bs=57;bs!=392;++bs)if(X[bs]==null){Gr(st.nf,bs);break}}break;case"column":if(E[E.length-1][0]!=="table")break;if((I=Fc(h[0])).Hidden&&(I.hidden=!0,delete I.Hidden),I.Width&&(I.wpx=parseInt(I.Width,10)),!nr&&10<I.wpx){nr=!0,qn=Cc;for(var eo=0;eo<ur.length;++eo)ur[eo]&&Rd(ur[eo])}nr&&Rd(I),ur[I.Index-1||ur.length]=I;for(var kc=0;kc<+I.Span;++kc)ur[ur.length]=Oa(I);break;case"namedrange":if(h[1]==="/")break;Sr.Names||(Sr.Names=[]);var Pe=Cr(h[0]),wt={Name:Pe.Name,Ref:Tu(Pe.RefersTo.slice(1),{r:0,c:0})};0<Sr.Sheets.length&&(wt.Sheet=Sr.Sheets.length-1),Sr.Names.push(wt);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":break;case"font":if(h[0].slice(-2)==="/>")break;h[1]==="/"?rt+=x.slice(mt,h.index):mt=h.index+h[0].length;break;case"interior":if(!d.cellStyles)break;st.Interior=Fc(h[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(h[0].slice(-2)==="/>")break;h[1]==="/"?(Ja=Qt,Pe=Zn,wt=x.slice(Zt,h.index),Ja[Pe=(qA=qA||ra(Yc))[Pe]||Pe]=wt):Zt=h.index+h[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(h[1]==="/"){if((S=E.pop())[0]!==h[3])throw new Error("Bad state: "+S.join("|"))}else E.push([h[3],!1]);break;case"comment":if(h[1]==="/"){if((S=E.pop())[0]!==h[3])throw new Error("Bad state: "+S.join("|"));(Na=cr).t=Na.v||"",Na.t=Na.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),Na.v=Na.w=Na.ixfe=void 0,wr.push(cr)}else E.push([h[3],!1]),cr={a:(S=Fc(h[0])).Author};break;case"autofilter":if(h[1]==="/"){if((S=E.pop())[0]!==h[3])throw new Error("Bad state: "+S.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&(Na=Fc(h[0]),W["!autofilter"]={ref:Tu(Na.Range).replace(/\$/g,"")},E.push([h[3],!0]));break;case"name":break;case"datavalidation":if(h[1]==="/"){if((S=E.pop())[0]!==h[3])throw new Error("Bad state: "+S.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&E.push([h[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(h[1]==="/"){if((S=E.pop())[0]!==h[3])throw new Error("Bad state: "+S.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&E.push([h[3],!0]);break;case"null":break;default:if(E.length==0&&h[3]=="document"||E.length==0&&h[3]=="uof")return cm(x,d);var qe=!0;switch(E[E.length-1][0]){case"officedocumentsettings":switch(h[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:qe=!1}break;case"componentoptions":switch(h[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:qe=!1}break;case"excelworkbook":switch(h[3]){case"date1904":Sr.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:qe=!1}break;case"workbookoptions":switch(h[3]){case"owcversion":case"height":case"width":break;default:qe=!1}break;case"worksheetoptions":switch(h[3]){case"visible":if(h[0].slice(-2)!=="/>")if(h[1]==="/")switch(x.slice(Zt,h.index)){case"SheetHidden":er.Hidden=1;break;case"SheetVeryHidden":er.Hidden=2}else Zt=h.index+h[0].length;break;case"header":W["!margins"]||jA(W["!margins"]={},"xlml"),isNaN(+Cr(h[0]).Margin)||(W["!margins"].header=+Cr(h[0]).Margin);break;case"footer":W["!margins"]||jA(W["!margins"]={},"xlml"),isNaN(+Cr(h[0]).Margin)||(W["!margins"].footer=+Cr(h[0]).Margin);break;case"pagemargins":var yt=Cr(h[0]);W["!margins"]||jA(W["!margins"]={},"xlml"),isNaN(+yt.Top)||(W["!margins"].top=+yt.Top),isNaN(+yt.Left)||(W["!margins"].left=+yt.Left),isNaN(+yt.Right)||(W["!margins"].right=+yt.Right),isNaN(+yt.Bottom)||(W["!margins"].bottom=+yt.Bottom);break;case"displayrighttoleft":Sr.Views||(Sr.Views=[]),Sr.Views[0]||(Sr.Views[0]={}),Sr.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":break;case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":break;case"nosummaryrowsbelowdetail":W["!outline"]||(W["!outline"]={}),W["!outline"].above=!0;break;case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":W["!outline"]||(W["!outline"]={}),W["!outline"].left=!0;break;case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;default:qe=!1}break;case"pivottable":case"pivotcache":switch(h[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:qe=!1}break;case"pagebreaks":switch(h[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:qe=!1}break;case"autofilter":switch(h[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:qe=!1}break;case"querytable":switch(h[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:qe=!1}break;case"datavalidation":switch(h[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:qe=!1}break;case"sorting":case"conditionalformatting":switch(h[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:qe=!1}break;case"mapinfo":case"schema":case"data":switch(h[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:qe=!1}break;case"smarttags":break;default:qe=!1}if(qe||h[3].match(/!\[CDATA/))break;if(!E[E.length-1][1])throw"Unrecognized tag: "+h[3]+"|"+E.join("|");if(E[E.length-1][0]==="customdocumentproperties"){if(h[0].slice(-2)==="/>")break;h[1]==="/"?(function(We,Wt,pt,Bt){var dt=Bt;switch((pt[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":dt=Ps(Bt);break;case"i2":case"int":dt=parseInt(Bt,10);break;case"r4":case"float":dt=parseFloat(Bt);break;case"date":case"dateTime.tz":dt=ba(Bt);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+pt[0])}We[ma(Wt)]=dt})(vt,Zn,Br,x.slice(Zt,h.index)):Zt=(Br=h).index+h[0].length;break}if(d.WTF)throw"Unrecognized tag: "+h[3]+"|"+E.join("|")}return N={},d.bookSheets||d.bookProps||(N.Sheets=P),N.SheetNames=K,N.Workbook=Sr,N.SSF=Oa(X),N.Props=Qt,N.Custprops=vt,N}function dl(o,A){switch(a1(A=A||{}),A.type||"base64"){case"base64":return K0(Q(o),A);case"binary":case"buffer":case"file":return K0(o,A);case"array":return K0(z(o),A)}}function Jg(o,A){var d,h,x,w,v,N,S,E=[];return o.Props&&E.push((d=o.Props,h=A,x=[],hs(Yc).map(function(I){for(var P=0;P<Ws.length;++P)if(Ws[P][1]==I)return Ws[P];for(P=0;P<Io.length;++P)if(Io[P][1]==I)return Io[P];throw I}).forEach(function(I){var P;d[I[1]]!=null&&(P=(h&&h.Props&&h.Props[I[1]]!=null?h.Props:d)[I[1]],typeof(P=I[2]==="date"?new Date(P).toISOString().replace(/\.\d*Z/,"Z"):P)=="number"?P=String(P):P===!0||P===!1?P=P?"1":"0":P instanceof Date&&(P=new Date(P).toISOString().replace(/\.\d*Z/,"")),x.push(Un(Yc[I[1]]||I[1],P)))}),lr("DocumentProperties",x.join(""),{xmlns:Ts.o}))),o.Custprops&&E.push((w=o.Props,v=o.Custprops,N=["Worksheets","SheetNames"],o="CustomDocumentProperties",S=[],w&&hs(w).forEach(function(I){if(Object.prototype.hasOwnProperty.call(w,I)){for(var P=0;P<Ws.length;++P)if(I==Ws[P][1])return;for(P=0;P<Io.length;++P)if(I==Io[P][1])return;for(P=0;P<N.length;++P)if(I==N[P])return;var K="string",W=typeof(W=w[I])=="number"?(K="float",String(W)):W===!0||W===!1?(K="boolean",W?"1":"0"):String(W);S.push(lr(li(I),W,{"dt:dt":K}))}}),v&&hs(v).forEach(function(I){var P,K;Object.prototype.hasOwnProperty.call(v,I)&&(w&&Object.prototype.hasOwnProperty.call(w,I)||(P="string",K=typeof(K=v[I])=="number"?(P="float",String(K)):K===!0||K===!1?(P="boolean",K?"1":"0"):K instanceof Date?(P="dateTime.tz",K.toISOString()):String(K),S.push(lr(li(I),K,{"dt:dt":P}))))}),"<"+o+' xmlns="'+Ts.o+'">'+S.join("")+"</"+o+">")),E.join("")}function ul(o){return lr("NamedRange",null,{"ss:Name":o.Name,"ss:RefersTo":"="+Hh(o.Ref,{r:0,c:0})})}function Zg(o,A,d,h,x,w,v){if(!o||o.v==null&&o.f==null)return"";var N={};if(o.f&&(N["ss:Formula"]="="+Va(Hh(o.f,v))),o.F&&o.F.slice(0,A.length)==A&&(A=Es(o.F.slice(A.length+1)),N["ss:ArrayRange"]="RC:R"+(A.r==v.r?"":"["+(A.r-v.r)+"]")+"C"+(A.c==v.c?"":"["+(A.c-v.c)+"]")),o.l&&o.l.Target&&(N["ss:HRef"]=Va(o.l.Target),o.l.Tooltip&&(N["x:HRefScreenTip"]=Va(o.l.Tooltip))),d["!merges"])for(var S=d["!merges"],E=0;E!=S.length;++E)S[E].s.c==v.c&&S[E].s.r==v.r&&(S[E].e.c>S[E].s.c&&(N["ss:MergeAcross"]=S[E].e.c-S[E].s.c),S[E].e.r>S[E].s.r&&(N["ss:MergeDown"]=S[E].e.r-S[E].s.r));var I="",P="";switch(o.t){case"z":if(!h.sheetStubs)return"";break;case"n":I="Number",P=String(o.v);break;case"b":I="Boolean",P=o.v?"1":"0";break;case"e":I="Error",P=So[o.v];break;case"d":I="DateTime",P=new Date(o.v).toISOString(),o.z==null&&(o.z=o.z||X[14]);break;case"s":I="String",P=((o.v||"")+"").replace(qo,function(K){return Gs[K]}).replace(Fs,function(K){return"&#x"+K.charCodeAt(0).toString(16).toUpperCase()+";"})}return d=ad(h.cellXfs,o,h),N["ss:StyleID"]="s"+(21+d),N["ss:Index"]=v.c+1,d=o.v!=null?P:"",d=o.t=="z"?"":'<Data ss:Type="'+I+'">'+d+"</Data>",0<(o.c||[]).length&&(d+=o.c.map(function(K){var W=lr("ss:Data",(K.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return lr("Comment",W,{"ss:Author":K.a})}).join("")),lr("Cell",d,N)}function ex(o,A){if(!o["!ref"])return"";var d=Fa(o["!ref"]),h=o["!merges"]||[],x=0,w=[];o["!cols"]&&o["!cols"].forEach(function(De,Ue){Rd(De);var ce=!!De.width,Ee=_f(Ue,De),Ue={"ss:Index":Ue+1};ce&&(Ue["ss:Width"]=Qd(Ee.width)),De.hidden&&(Ue["ss:Hidden"]="1"),w.push(lr("Column",null,Ue))});for(var v,N,S=Array.isArray(o),E=d.s.r;E<=d.e.r;++E){for(var I=[(v=E,N=(o["!rows"]||[])[E],v='<Row ss:Index="'+(v+1)+'"',N&&(N.hpt&&!N.hpx&&(N.hpx=Du(N.hpt)),N.hpx&&(v+=' ss:AutoFitHeight="0" ss:Height="'+N.hpx+'"'),N.hidden&&(v+=' ss:Hidden="1"')),v+">")],P=d.s.c;P<=d.e.c;++P){for(var K,W,me,re=!1,x=0;x!=h.length;++x)if(!(h[x].s.c>P||h[x].s.r>E||h[x].e.c<P||h[x].e.r<E)){h[x].s.c==P&&h[x].s.r==E||(re=!0);break}re||(W=ha(K={r:E,c:P}),me=S?(o[E]||[])[P]:o[W],I.push(Zg(me,W,o,A,0,0,K)))}I.push("</Row>"),2<I.length&&w.push(I.join(""))}return w.join("")}function Ay(o,A,d){var h=[],w=d.SheetNames[o],x=d.Sheets[w],w=x?(function(v,N,S){if(!v||!((S||{}).Workbook||{}).Names)return"";for(var E=S.Workbook.Names,I=[],P=0;P<E.length;++P){var K=E[P];K.Sheet==N&&(K.Name.match(/^_xlfn\./)||I.push(ul(K)))}return I.join("")})(x,o,d):"";return 0<w.length&&h.push("<Names>"+w+"</Names>"),0<(w=x?ex(x,A):"").length&&h.push("<Table>"+w+"</Table>"),h.push((function(v,N,S){if(!v)return"";var E=[];if(v["!margins"]&&(E.push("<PageSetup>"),v["!margins"].header&&E.push(lr("Header",null,{"x:Margin":v["!margins"].header})),v["!margins"].footer&&E.push(lr("Footer",null,{"x:Margin":v["!margins"].footer})),E.push(lr("PageMargins",null,{"x:Bottom":v["!margins"].bottom||"0.75","x:Left":v["!margins"].left||"0.7","x:Right":v["!margins"].right||"0.7","x:Top":v["!margins"].top||"0.75"})),E.push("</PageSetup>")),S&&S.Workbook&&S.Workbook.Sheets&&S.Workbook.Sheets[N])if(S.Workbook.Sheets[N].Hidden)E.push(lr("Visible",S.Workbook.Sheets[N].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var I=0;I<N&&(!S.Workbook.Sheets[I]||S.Workbook.Sheets[I].Hidden);++I);I==N&&E.push("<Selected/>")}return((((S||{}).Workbook||{}).Views||[])[0]||{}).RTL&&E.push("<DisplayRightToLeft/>"),v["!protect"]&&(E.push(Un("ProtectContents","True")),v["!protect"].objects&&E.push(Un("ProtectObjects","True")),v["!protect"].scenarios&&E.push(Un("ProtectScenarios","True")),v["!protect"].selectLockedCells==null||v["!protect"].selectLockedCells?v["!protect"].selectUnlockedCells==null||v["!protect"].selectUnlockedCells||E.push(Un("EnableSelection","UnlockedCells")):E.push(Un("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(P){v["!protect"][P[0]]&&E.push("<"+P[1]+"/>")})),E.length==0?"":lr("WorksheetOptions",E.join(""),{xmlns:Ts.x})})(x,o,d)),h.join("")}function Wd(o,A){A=A||{},o.SSF||(o.SSF=Oa(X)),o.SSF&&(wa(),Pr(o.SSF),A.revssf=ko(o.SSF),A.revssf[o.SSF[65535]]=0,A.ssf=o.SSF,A.cellXfs=[],ad(A.cellXfs,{},{revssf:{General:0}}));var d=[];d.push(Jg(o,A)),d.push(""),d.push(""),d.push("");for(var h,x=0;x<o.SheetNames.length;++x)d.push(lr("Worksheet",Ay(x,A,o),{"ss:Name":Va(o.SheetNames[x])}));return d[2]=(h=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'],A.cellXfs.forEach(function(w,v){var N=[];N.push(lr("NumberFormat",null,{"ss:Format":Va(X[w.numFmtId])})),v={"ss:ID":"s"+(21+v)},h.push(lr("Style",N.join(""),v))}),lr("Styles",h.join(""))),d[3]=(function(w){if(!((w||{}).Workbook||{}).Names)return"";for(var v=w.Workbook.Names,N=[],S=0;S<v.length;++S){var E=v[S];E.Sheet==null&&(E.Name.match(/^_xlfn\./)||N.push(ul(E)))}return lr("Names",N.join(""))})(o),Ba+lr("Workbook",d.join(""),{xmlns:Ts.ss,"xmlns:o":Ts.o,"xmlns:x":Ts.x,"xmlns:ss":Ts.ss,"xmlns:dt":Ts.dt,"xmlns:html":Ts.html})}function nm(o){var A={},d=o.content;return d.l=28,A.AnsiUserType=d.read_shift(0,"lpstr-ansi"),A.AnsiClipboardFormat=Kn(d,1),d.length-d.l<=4?A:(o=d.read_shift(4),o==0||40<o?A:(d.l-=4,A.Reserved1=d.read_shift(0,"lpstr-ansi"),d.length-d.l<=4||(o=d.read_shift(4))!==1907505652?A:(A.UnicodeClipboardFormat=Kn(d,2),(o=d.read_shift(4))==0||40<o?A:(d.l-=4,void(A.Reserved2=d.read_shift(0,"lpwstr"))))))}var Wp=[60,1084,2066,2165,2175];function fl(o,A,d){if(o.t!=="z"&&o.XF){var h,x=0;try{x=o.z||o.XF.numFmtId||0,A.cellNF&&(o.z=X[x])}catch(w){if(A.WTF)throw w}if(!A||A.cellText!==!1)try{o.t==="e"?o.w=o.w||So[o.v]:x===0||x=="General"?o.t==="n"?(0|o.v)===o.v?o.w=o.v.toString(10):o.w=Se(o.v):o.w=ft(o.v):o.w=pr(x,o.v,{date1904:!!d,dateNF:A&&A.dateNF})}catch(w){if(A.WTF)throw w}A.cellDates&&x&&o.t=="n"&&Mr(X[x]||String(x))&&(h=ve(o.v))&&(o.t="d",o.v=new Date(h.y,h.m-1,h.d,h.H,h.M,h.S,h.u))}}function G0(o,A,d){return{v:o,ixfe:A,t:d}}function tx(o,A){var d={opts:{}},h={};function x(dt){return!(dt<8)&&dt<64&&$e[dt-8]||GA[dt]}function w(dt,Tt,tr){if(!(1<nr||tr.sheetRows&&dt.r>=tr.sheetRows)){var _r,Dr,yr;if(tr.cellStyles&&Tt.XF&&Tt.XF.data&&(Dr=tr,(yr=(_r=Tt).XF.data)&&yr.patternType&&Dr&&Dr.cellStyles&&(_r.s={},_r.s.patternType=yr.patternType,(Dr=Po(x(yr.icvFore)))&&(_r.s.fgColor={rgb:Dr}),(Dr=Po(x(yr.icvBack)))&&(_r.s.bgColor={rgb:Dr}))),delete Tt.ixfe,delete Tt.XF,ce=ha(v=dt),W&&W.s&&W.e||(W={s:{r:0,c:0},e:{r:0,c:0}}),dt.r<W.s.r&&(W.s.r=dt.r),dt.c<W.s.c&&(W.s.c=dt.c),dt.r+1>W.e.r&&(W.e.r=dt.r+1),dt.c+1>W.e.c&&(W.e.c=dt.c+1),tr.cellFormula&&Tt.f){for(var Lr=0;Lr<Ue.length;++Lr)if(!(Ue[Lr][0].s.c>dt.c||Ue[Lr][0].s.r>dt.r||Ue[Lr][0].e.c<dt.c||Ue[Lr][0].e.r<dt.r)){Tt.F=fa(Ue[Lr][0]),Ue[Lr][0].s.c==dt.c&&Ue[Lr][0].s.r==dt.r||delete Tt.f,Tt.f&&(Tt.f=""+Ho(Ue[Lr][1],0,dt,wr,mt));break}}tr.dense?(P[dt.r]||(P[dt.r]=[]),P[dt.r][dt.c]=Tt):P[ce]=Tt}}var v,N,S,E,I,P=A.dense?[]:{},K={},W={},me=null,re=[],De="",be={},ce="",Ee={},Ue=[],Ie=[],$e=[],st={Sheets:[],WBProps:{date1904:!1},Views:[{}]},rt={},mt={enc:!1,sbcch:0,snames:[],sharedf:Ee,arrayf:Ue,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!A&&!!A.cellStyles,WTF:!!A&&!!A.wtf};A.password&&(mt.password=A.password);var Mt=[],Qt=[],vt=[],Zt=[],Br=!1,wr=[];wr.SheetNames=mt.snames,wr.sharedf=mt.sharedf,wr.arrayf=mt.arrayf,wr.names=[],wr.XTI=[];var cr,ur=0,nr=0,Vt=0,kr=[],Rr=[];mt.codepage=1200,j(1200);for(var na=!1;o.l<o.length-1;){var Ga=o.l,Sr=o.read_shift(2);if(Sr===0&&ur===10)break;var er=o.l===o.length?0:o.read_shift(2),Na=$p[Sr];if(Na&&Na.f){if(A.bookSheets&&ur===133&&Sr!==133)break;if(ur=Sr,Na.r===2||Na.r==12){var is=o.read_shift(2);if(er-=2,!mt.enc&&is!==Sr&&((255&is)<<8|is>>8)!==Sr)throw new Error("rt mismatch: "+is+"!="+Sr);Na.r==12&&(o.l+=10,er-=10)}var Ja,Ls,Zn,Je={},Je=Sr===10?Na.f(o,er,mt):(function(dt,Tt,tr,_r,Dr){var yr=_r,Lr=[],Jr=tr.slice(tr.l,tr.l+yr);if(Dr&&Dr.enc&&Dr.enc.insitu&&0<Jr.length)switch(dt){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:Dr.enc.insitu(Jr)}Lr.push(Jr),tr.l+=yr;for(var qr=Qr(tr,tr.l),fr=$p[qr],sr=0;fr!=null&&-1<Wp.indexOf(qr);)yr=Qr(tr,tr.l+2),sr=tr.l+4,qr==2066?sr+=4:qr!=2165&&qr!=2175||(sr+=12),Jr=tr.slice(sr,tr.l+4+yr),Lr.push(Jr),tr.l+=4+yr,fr=$p[qr=Qr(tr,tr.l)];var Zr=ge(Lr);_s(Zr,0);var Fr=0;Zr.lens=[];for(var ir=0;ir<Lr.length;++ir)Zr.lens.push(Fr),Fr+=Lr[ir].length;if(Zr.length<_r)throw"XLS Record 0x"+dt.toString(16)+" Truncated: "+Zr.length+" < "+_r;return Tt.f(Zr,Zr.length,Dr)})(Sr,Na,o,er,mt);if(nr!=0||[9,521,1033,2057].indexOf(ur)!==-1)switch(Sr){case 34:d.opts.Date1904=st.WBProps.date1904=Je;break;case 134:d.opts.WriteProtect=!0;break;case 47:if(mt.enc||(o.l=0),mt.enc=Je,!A.password)throw new Error("File is password-protected");if(Je.valid==null)throw new Error("Encryption scheme unsupported");if(!Je.valid)throw new Error("Password is incorrect");break;case 92:mt.lastuser=Je;break;case 66:var Us=Number(Je);switch(Us){case 21010:Us=1200;break;case 32768:Us=1e4;break;case 32769:Us=1252}j(mt.codepage=Us),na=!0;break;case 317:mt.rrtabid=Je;break;case 25:mt.winlocked=Je;break;case 439:d.opts.RefreshAll=Je;break;case 12:d.opts.CalcCount=Je;break;case 16:d.opts.CalcDelta=Je;break;case 17:d.opts.CalcIter=Je;break;case 13:d.opts.CalcMode=Je;break;case 14:d.opts.CalcPrecision=Je;break;case 95:d.opts.CalcSaveRecalc=Je;break;case 15:mt.CalcRefMode=Je;break;case 2211:d.opts.FullCalc=Je;break;case 129:Je.fDialog&&(P["!type"]="dialog"),Je.fBelow||((P["!outline"]||(P["!outline"]={})).above=!0),Je.fRight||((P["!outline"]||(P["!outline"]={})).left=!0);break;case 224:Ie.push(Je);break;case 430:wr.push([Je]),wr[wr.length-1].XTI=[];break;case 35:case 547:wr[wr.length-1].push(Je);break;case 24:case 536:cr={Name:Je.Name,Ref:Ho(Je.rgce,0,null,wr,mt)},0<Je.itab&&(cr.Sheet=Je.itab-1),wr.names.push(cr),wr[0]||(wr[0]=[],wr[0].XTI=[]),wr[wr.length-1].push(Je),Je.Name=="_xlnm._FilterDatabase"&&0<Je.itab&&Je.rgce&&Je.rgce[0]&&Je.rgce[0][0]&&Je.rgce[0][0][0]=="PtgArea3d"&&(Rr[Je.itab-1]={ref:fa(Je.rgce[0][0][1][2])});break;case 22:mt.ExternCount=Je;break;case 23:wr.length==0&&(wr[0]=[],wr[0].XTI=[]),wr[wr.length-1].XTI=wr[wr.length-1].XTI.concat(Je),wr.XTI=wr.XTI.concat(Je);break;case 2196:if(mt.biff<8)break;cr!=null&&(cr.Comment=Je[1]);break;case 18:P["!protect"]=Je;break;case 19:Je!==0&&mt.WTF&&console.error("Password verifier: "+Je);break;case 133:K[Je.pos]=Je,mt.snames.push(Je.name);break;case 10:if(--nr)break;W.e&&(0<W.e.r&&0<W.e.c&&(W.e.r--,W.e.c--,P["!ref"]=fa(W),A.sheetRows&&A.sheetRows<=W.e.r&&(bs=W.e.r,W.e.r=A.sheetRows-1,P["!fullref"]=P["!ref"],P["!ref"]=fa(W),W.e.r=bs),W.e.r++,W.e.c++),0<Mt.length&&(P["!merges"]=Mt),0<Qt.length&&(P["!objects"]=Qt),0<vt.length&&(P["!cols"]=vt),0<Zt.length&&(P["!rows"]=Zt),st.Sheets.push(rt)),De===""?be=P:h[De]=P,P=A.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(mt.biff===8&&(mt.biff={9:2,521:3,1033:4}[Sr]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Je.BIFFVer]||8),mt.biffguess=Je.BIFFVer==0,Je.BIFFVer==0&&Je.dt==4096&&(mt.biff=5,na=!0,j(mt.codepage=28591)),mt.biff==8&&Je.BIFFVer==0&&Je.dt==16&&(mt.biff=2),nr++)break;var bs,P=A.dense?[]:{};mt.biff<8&&!na&&(na=!0,j(mt.codepage=A.codepage||1252)),mt.biff<5||Je.BIFFVer==0&&Je.dt==4096?(De===""&&(De="Sheet1"),W={s:{r:0,c:0},e:{r:0,c:0}},bs={pos:o.l-er,name:De},K[bs.pos]=bs,mt.snames.push(De)):De=(K[Ga]||{name:""}).name,Je.dt==32&&(P["!type"]="chart"),Je.dt==64&&(P["!type"]="macro"),Mt=[],Qt=[],mt.arrayf=Ue=[],vt=[],Br=!(Zt=[]),rt={Hidden:(K[Ga]||{hs:0}).hs,name:De};break;case 515:case 3:case 2:P["!type"]=="chart"&&(A.dense?(P[Je.r]||[])[Je.c]:P[ha({c:Je.c,r:Je.r})])&&++Je.c,Pe={ixfe:Je.ixfe,XF:Ie[Je.ixfe]||{},v:Je.val,t:"n"},0<Vt&&(Pe.z=kr[Pe.ixfe>>8&63]),fl(Pe,A,d.opts.Date1904),w({c:Je.c,r:Je.r},Pe,A);break;case 5:case 517:Pe={ixfe:Je.ixfe,XF:Ie[Je.ixfe],v:Je.val,t:Je.t},0<Vt&&(Pe.z=kr[Pe.ixfe>>8&63]),fl(Pe,A,d.opts.Date1904),w({c:Je.c,r:Je.r},Pe,A);break;case 638:Pe={ixfe:Je.ixfe,XF:Ie[Je.ixfe],v:Je.rknum,t:"n"},0<Vt&&(Pe.z=kr[Pe.ixfe>>8&63]),fl(Pe,A,d.opts.Date1904),w({c:Je.c,r:Je.r},Pe,A);break;case 189:for(var eo=Je.c;eo<=Je.C;++eo){var kc=Je.rkrec[eo-Je.c][0],Pe={ixfe:kc,XF:Ie[kc],v:Je.rkrec[eo-Je.c][1],t:"n"};0<Vt&&(Pe.z=kr[Pe.ixfe>>8&63]),fl(Pe,A,d.opts.Date1904),w({c:eo,r:Je.r},Pe,A)}break;case 6:case 518:case 1030:if(Je.val=="String"){me=Je;break}(Pe=G0(Je.val,Je.cell.ixfe,Je.tt)).XF=Ie[Pe.ixfe],A.cellFormula&&(!((wt=Je.formula)&&wt[0]&&wt[0][0]&&wt[0][0][0]=="PtgExp")||Ee[Zn=ha({r:Ja=wt[0][0][1][0],c:Ls=wt[0][0][1][1]})]?Pe.f=""+Ho(Je.formula,0,Je.cell,wr,mt):Pe.F=((A.dense?(P[Ja]||[])[Ls]:P[Zn])||{}).F),0<Vt&&(Pe.z=kr[Pe.ixfe>>8&63]),fl(Pe,A,d.opts.Date1904),w(Je.cell,Pe,A),me=Je;break;case 7:case 519:if(!me)throw new Error("String record expects Formula");(Pe=G0(me.val=Je,me.cell.ixfe,"s")).XF=Ie[Pe.ixfe],A.cellFormula&&(Pe.f=""+Ho(me.formula,0,me.cell,wr,mt)),0<Vt&&(Pe.z=kr[Pe.ixfe>>8&63]),fl(Pe,A,d.opts.Date1904),w(me.cell,Pe,A),me=null;break;case 33:case 545:Ue.push(Je);var wt=ha(Je[0].s),qe=A.dense?(P[Je[0].s.r]||[])[Je[0].s.c]:P[wt];if(A.cellFormula&&qe){if(!me||!wt||!qe)break;qe.f=""+Ho(Je[1],0,Je[0],wr,mt),qe.F=fa(Je[0])}break;case 1212:if(!A.cellFormula)break;if(ce){if(!me)break;Ee[ha(me.cell)]=Je[0],((qe=A.dense?(P[me.cell.r]||[])[me.cell.c]:P[ha(me.cell)])||{}).f=""+Ho(Je[0],0,v,wr,mt)}break;case 253:Pe=G0(re[Je.isst].t,Je.ixfe,"s"),re[Je.isst].h&&(Pe.h=re[Je.isst].h),Pe.XF=Ie[Pe.ixfe],0<Vt&&(Pe.z=kr[Pe.ixfe>>8&63]),fl(Pe,A,d.opts.Date1904),w({c:Je.c,r:Je.r},Pe,A);break;case 513:A.sheetStubs&&(Pe={ixfe:Je.ixfe,XF:Ie[Je.ixfe],t:"z"},0<Vt&&(Pe.z=kr[Pe.ixfe>>8&63]),fl(Pe,A,d.opts.Date1904),w({c:Je.c,r:Je.r},Pe,A));break;case 190:if(A.sheetStubs)for(var yt=Je.c;yt<=Je.C;++yt){var We=Je.ixfe[yt-Je.c];Pe={ixfe:We,XF:Ie[We],t:"z"},0<Vt&&(Pe.z=kr[Pe.ixfe>>8&63]),fl(Pe,A,d.opts.Date1904),w({c:yt,r:Je.r},Pe,A)}break;case 214:case 516:case 4:(Pe=G0(Je.val,Je.ixfe,"s")).XF=Ie[Pe.ixfe],0<Vt&&(Pe.z=kr[Pe.ixfe>>8&63]),fl(Pe,A,d.opts.Date1904),w({c:Je.c,r:Je.r},Pe,A);break;case 0:case 512:nr===1&&(W=Je);break;case 252:re=Je;break;case 1054:if(mt.biff==4){kr[Vt++]=Je[1];for(var Wt=0;Wt<Vt+163&&X[Wt]!=Je[1];++Wt);163<=Wt&&Gr(Je[1],Vt+163)}else Gr(Je[1],Je[0]);break;case 30:kr[Vt++]=Je;for(var pt=0;pt<Vt+163&&X[pt]!=Je;++pt);163<=pt&&Gr(Je,Vt+163);break;case 229:Mt=Mt.concat(Je);break;case 93:Qt[Je.cmo[0]]=mt.lastobj=Je;break;case 438:mt.lastobj.TxO=Je;break;case 127:mt.lastobj.ImData=Je;break;case 440:for(S=Je[0].s.r;S<=Je[0].e.r;++S)for(N=Je[0].s.c;N<=Je[0].e.c;++N)(qe=A.dense?(P[S]||[])[N]:P[ha({c:N,r:S})])&&(qe.l=Je[1]);break;case 2048:for(S=Je[0].s.r;S<=Je[0].e.r;++S)for(N=Je[0].s.c;N<=Je[0].e.c;++N)(qe=A.dense?(P[S]||[])[N]:P[ha({c:N,r:S})])&&qe.l&&(qe.l.Tooltip=Je[1]);break;case 28:if(mt.biff<=5&&2<=mt.biff)break;qe=A.dense?(P[Je[0].r]||[])[Je[0].c]:P[ha(Je[0])];var Bt=Qt[Je[2]];qe||(qe=A.dense?(P[Je[0].r]||(P[Je[0].r]=[]),P[Je[0].r][Je[0].c]={t:"z"}):P[ha(Je[0])]={t:"z"},W.e.r=Math.max(W.e.r,Je[0].r),W.s.r=Math.min(W.s.r,Je[0].r),W.e.c=Math.max(W.e.c,Je[0].c),W.s.c=Math.min(W.s.c,Je[0].c)),qe.c||(qe.c=[]),Bt={a:Je[1],t:Bt.TxO.t},qe.c.push(Bt);break;case 2173:Ie[Je.ixfe],Je.ext.forEach(function(Tt){Tt[0]});break;case 125:if(!mt.cellStyles)break;for(;Je.e>=Je.s;)vt[Je.e--]={width:Je.w/256,level:Je.level||0,hidden:!!(1&Je.flags)},Br||(Br=!0,F0(Je.w/256)),Rd(vt[Je.e+1]);break;case 520:Bt={},Je.level!=null&&((Zt[Je.r]=Bt).level=Je.level),Je.hidden&&((Zt[Je.r]=Bt).hidden=!0),Je.hpt&&((Zt[Je.r]=Bt).hpt=Je.hpt,Bt.hpx=Du(Je.hpt));break;case 38:case 39:case 40:case 41:P["!margins"]||jA(P["!margins"]={}),P["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Sr]]=Je;break;case 161:P["!margins"]||jA(P["!margins"]={}),P["!margins"].header=Je.header,P["!margins"].footer=Je.footer;break;case 574:Je.RTL&&(st.Views[0].RTL=!0);break;case 146:$e=Je;break;case 2198:I=Je;break;case 140:E=Je;break;case 442:De?rt.CodeName=Je||rt.name:st.WBProps.CodeName=Je||"ThisWorkbook"}}else Na||console.error("Missing Info for XLS Record 0x"+Sr.toString(16)),o.l+=er}return d.SheetNames=hs(K).sort(function(dt,Tt){return Number(dt)-Number(Tt)}).map(function(dt){return K[dt].name}),A.bookSheets||(d.Sheets=h),!d.SheetNames.length&&be["!ref"]?(d.SheetNames.push("Sheet1"),d.Sheets&&(d.Sheets.Sheet1=be)):d.Preamble=be,d.Sheets&&Rr.forEach(function(dt,Tt){d.Sheets[d.SheetNames[Tt]]["!autofilter"]=dt}),d.Strings=re,d.SSF=Oa(X),mt.enc&&(d.Encryption=mt.enc),I&&(d.Themes=I),d.Metadata={},E!==void 0&&(d.Metadata.Country=E),0<wr.names.length&&(st.Names=wr.names),d.Workbook=st,d}var Qf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function V0(o,A){var d,h,x,w,v;if(a1(A=A||{}),F(),A.codepage&&b(A.codepage),o.FullPaths){if($t.find(o,"/encryption"))throw new Error("File is password-protected");d=$t.find(o,"!CompObj"),x=$t.find(o,"/Workbook")||$t.find(o,"/Book")}else{switch(A.type){case"base64":o=ae(Q(o));break;case"binary":o=ae(o);break;case"buffer":break;case"array":Array.isArray(o)||(o=Array.prototype.slice.call(o))}_s(o,0),x={content:o}}if(d&&nm(d),A.bookProps&&!A.bookSheets)h={};else{var N=Z?"buffer":"array";if(x&&x.content)h=tx(x.content,A);else if((x=$t.find(o,"PerfectOffice_MAIN"))&&x.content)h=xs.to_workbook(x.content,(A.type=N,A));else{if(!(x=$t.find(o,"NativeContent_MAIN"))||!x.content)throw(x=$t.find(o,"MN0"))&&x.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");h=xs.to_workbook(x.content,(A.type=N,A))}A.bookVBA&&o.FullPaths&&$t.find(o,"/_VBA_PROJECT_CUR/VBA/dir")&&(h.vbaraw=(w=o,v=$t.utils.cfb_new({root:"R"}),w.FullPaths.forEach(function(S,E){S.slice(-1)!=="/"&&S.match(/_VBA_PROJECT_CUR/)&&(S=S.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,""),$t.utils.cfb_add(v,S,w.FileIndex[E].content))}),$t.write(v)))}return N={},o.FullPaths&&(function(S,E,I){var P=$t.find(S,"/!DocumentSummaryInformation");if(P&&0<P.size)try{var K,W=sn(P,uf,Qf.DSI);for(K in W)E[K]=W[K]}catch(be){if(I.WTF)throw be}var me=$t.find(S,"/!SummaryInformation");if(me&&0<me.size)try{var re,De=sn(me,ff,Qf.SI);for(re in De)E[re]==null&&(E[re]=De[re])}catch(be){if(I.WTF)throw be}E.HeadingPairs&&E.TitlesOfParts&&(yu(E.HeadingPairs,E.TitlesOfParts,E,I),delete E.HeadingPairs,delete E.TitlesOfParts)})(o,N,A),h.Props=h.Custprops=N,A.bookFiles&&(h.cfb=o),h}function im(o,w){var d,h,x=w||{},w=$t.utils.cfb_new({root:"R"}),v="/Workbook";switch(x.bookType||"xls"){case"xls":x.bookType="biff8";case"xla":x.bookType||(x.bookType="xla");case"biff8":v="/Workbook",x.biff=8;break;case"biff5":v="/Book",x.biff=5;break;default:throw new Error("invalid type "+x.bookType+" for XLS CFB")}return $t.utils.cfb_add(w,v,qp(o,x)),x.biff==8&&(o.Props||o.Custprops)&&(function(N,S){var E,I=[],P=[],K=[],W=0,me=co(uf,"n"),re=co(ff,"n");if(N.Props)for(E=hs(N.Props),W=0;W<E.length;++W)(Object.prototype.hasOwnProperty.call(me,E[W])?I:Object.prototype.hasOwnProperty.call(re,E[W])?P:K).push([E[W],N.Props[E[W]]]);if(N.Custprops)for(E=hs(N.Custprops),W=0;W<E.length;++W)Object.prototype.hasOwnProperty.call(N.Props||{},E[W])||(Object.prototype.hasOwnProperty.call(me,E[W])?I:Object.prototype.hasOwnProperty.call(re,E[W])?P:K).push([E[W],N.Custprops[E[W]]]);for(var De=[],W=0;W<K.length;++W)-1<b0.indexOf(K[W][0])||-1<Ud.indexOf(K[W][0])||K[W][1]!=null&&De.push(K[W]);P.length&&$t.utils.cfb_add(S,"/SummaryInformation",es(P,Qf.SI,re,ff)),(I.length||De.length)&&$t.utils.cfb_add(S,"/DocumentSummaryInformation",es(I,Qf.DSI,me,uf,De.length?De:null,Qf.UDI))})(o,w),x.biff==8&&o.vbaraw&&(d=w,(h=$t.read(o.vbaraw,{type:typeof o.vbaraw=="string"?"binary":"buffer"})).FullPaths.forEach(function(N,S){S==0||(N=N.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/")).slice(-1)!=="/"&&$t.utils.cfb_add(d,N,h.FileIndex[S].content)})),w}var Iu={0:{f:function(o,A){var d={},h=o.l+A;d.r=o.read_shift(4),o.l+=4;var x=o.read_shift(2);return o.l+=1,A=o.read_shift(1),o.l=h,7&A&&(d.level=7&A),16&A&&(d.hidden=!0),32&A&&(d.hpt=x/20),d}},1:{f:function(o){return[ys(o)]}},2:{f:function(o){return[ys(o),Kc(o),"n"]}},3:{f:function(o){return[ys(o),o.read_shift(1),"e"]}},4:{f:function(o){return[ys(o),o.read_shift(1),"b"]}},5:{f:function(o){return[ys(o),Ea(o),"n"]}},6:{f:function(o){return[ys(o),gn(o),"str"]}},7:{f:function(o){return[ys(o),o.read_shift(4),"s"]}},8:{f:function(o,A,d){var h=o.l+A,x=ys(o);x.r=d["!row"];var w=[x,gn(o),"str"];return d.cellFormula?(o.l+=2,A=Yh(o,h-o.l,d),w[3]=Ho(A,0,x,d.supbooks,d)):o.l=h,w}},9:{f:function(o,A,d){var h=o.l+A,x=ys(o);x.r=d["!row"];var w=[x,Ea(o),"n"];return d.cellFormula?(o.l+=2,A=Yh(o,h-o.l,d),w[3]=Ho(A,0,x,d.supbooks,d)):o.l=h,w}},10:{f:function(o,A,d){var h=o.l+A,x=ys(o);x.r=d["!row"];var w=[x,o.read_shift(1),"b"];return d.cellFormula?(o.l+=2,A=Yh(o,h-o.l,d),w[3]=Ho(A,0,x,d.supbooks,d)):o.l=h,w}},11:{f:function(o,A,d){var h=o.l+A,x=ys(o);x.r=d["!row"];var w=[x,o.read_shift(1),"e"];return d.cellFormula?(o.l+=2,A=Yh(o,h-o.l,d),w[3]=Ho(A,0,x,d.supbooks,d)):o.l=h,w}},12:{f:function(o){return[Ao(o)]}},13:{f:function(o){return[Ao(o),Kc(o),"n"]}},14:{f:function(o){return[Ao(o),o.read_shift(1),"e"]}},15:{f:function(o){return[Ao(o),o.read_shift(1),"b"]}},16:{f:Uf},17:{f:function(o){return[Ao(o),gn(o),"str"]}},18:{f:function(o){return[Ao(o),o.read_shift(4),"s"]}},19:{f:Yl},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(o,v,N){var h=o.l+v;o.l+=4,o.l+=1;var x=o.read_shift(4),w=zc(o),v=Pg(o,0,N),N=gA(o);return o.l=h,v={Name:w,Ptg:v},x<268435455&&(v.Sheet=x),N&&(v.Comment=N),v}},40:{},42:{},43:{f:function(o,A,d){var h={};h.sz=o.read_shift(2)/20;var x,w=(w=(x=o).read_shift(1),x.l++,{fBold:1&w,fItalic:2&w,fUnderline:4&w,fStrikeout:8&w,fOutline:16&w,fShadow:32&w,fCondense:64&w,fExtend:128&w});switch(w.fItalic&&(h.italic=1),w.fCondense&&(h.condense=1),w.fExtend&&(h.extend=1),w.fShadow&&(h.shadow=1),w.fOutline&&(h.outline=1),w.fStrikeout&&(h.strike=1),o.read_shift(2)===700&&(h.bold=1),o.read_shift(2)){case 1:h.vertAlign="superscript";break;case 2:h.vertAlign="subscript"}switch((w=o.read_shift(1))!=0&&(h.underline=w),0<(w=o.read_shift(1))&&(h.family=w),0<(w=o.read_shift(1))&&(h.charset=w),o.l++,h.color=(function(v){var N={},S=v.read_shift(1)>>>1,E=v.read_shift(1),I=v.read_shift(2,"i"),P=v.read_shift(1),K=v.read_shift(1),W=v.read_shift(1);switch(v.l++,S){case 0:N.auto=1;break;case 1:N.index=E;var me=GA[E];me&&(N.rgb=Po(me));break;case 2:N.rgb=Po([P,K,W]);break;case 3:N.theme=E}return I!=0&&(N.tint=0<I?I/32767:I/32768),N})(o),o.read_shift(1)){case 1:h.scheme="major";break;case 2:h.scheme="minor"}return h.name=gn(o),h}},44:{f:function(o,A){return[o.read_shift(2),gn(o)]}},45:{f:jg},46:{f:pi},47:{f:function(o,x){var d=o.l+x,h=o.read_shift(2),x=o.read_shift(2);return o.l=d,{ixfe:h,numFmtId:x}}},48:{},49:{f:function(o){return o.read_shift(4,"i")}},50:{},51:{f:function(o){for(var A=[],d=o.read_shift(4);0<d--;)A.push([o.read_shift(4),o.read_shift(4)]);return A}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ht},62:{f:function(o){return[ys(o),Yl(o),"is"]}},63:{f:function(o){var A={};A.i=o.read_shift(4);var d={};return d.r=o.read_shift(4),d.c=o.read_shift(4),A.r=ha(d),2&(o=o.read_shift(1))&&(A.l="1"),8&o&&(A.a="1"),A}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:yi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(o){var A=o.read_shift(2);return o.l+=28,{RTL:32&A}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(o,A){var d={},h=o[o.l];return++o.l,d.above=!(64&h),d.left=!(128&h),o.l+=18,d.name=$i(o),d}},148:{f:R0,p:16},151:{f:function(){}},152:{},153:{f:function(o,A){var d={},h=o.read_shift(4);return d.defaultThemeVersion=o.read_shift(4),0<(o=8<A?gn(o):"").length&&(d.CodeName=o),d.autoCompressPictures=!!(65536&h),d.backupFile=!!(64&h),d.checkCompatibility=!!(4096&h),d.date1904=!!(1&h),d.filterPrivacy=!!(8&h),d.hidePivotFieldList=!!(1024&h),d.promptedSolutions=!!(16&h),d.publishItems=!!(2048&h),d.refreshAllConnections=!!(262144&h),d.saveExternalLinkValues=!!(128&h),d.showBorderUnselectedTables=!!(4&h),d.showInkAnnotation=!!(32&h),d.showObjects=["all","placeholders","none"][h>>13&3],d.showPivotChartFilter=!!(32768&h),d.updateLinks=["userSet","never","always"][h>>8&3],d}},154:{},155:{},156:{f:function(o,A){var d={};return d.Hidden=o.read_shift(4),d.iTabID=o.read_shift(4),d.strRelID=Wl(o),d.name=gn(o),d}},157:{},158:{},159:{T:1,f:function(o){return[o.read_shift(4),o.read_shift(4)]}},160:{T:-1},161:{T:1,f:zn},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:FA},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(o,A){return{flags:o.read_shift(4),version:o.read_shift(4),name:gn(o)}}},336:{T:-1},337:{f:function(o){return o.l+=4,o.read_shift(4)!=0},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Wl},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Oe},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(o,w,d){var h=o.l+w,x=pc(o),w=o.read_shift(1);return(x=[x])[2]=w,d.cellFormula?(d=ny(o,h-o.l,d),x[1]=d):o.l=h,x}},427:{f:function(o,x,d){var h=o.l+x,x=[zn(o)];return d.cellFormula&&(d=O0(o,h-o.l,d),x[1]=d),o.l=h,x}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(o){var A={};return Vp.forEach(function(d){A[d]=Ea(o)}),A}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(o,N){var d=o.l+N,h=zn(o),x=gA(o),w=gn(o),v=gn(o),N=gn(o);return o.l=d,N={rfx:h,relId:x,loc:w,display:N},v&&(N.Tooltip=v),N}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Wl},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Yo},633:{T:1},634:{T:-1},635:{T:1,f:function(o){var A={};A.iauthor=o.read_shift(4);var d=zn(o);return A.rfx=d.s,A.ref=ha(d.s),o.l+=16,A}},636:{T:-1},637:{f:Td},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(o,A){return o.l+=10,{name:gn(o)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},$p={6:{f:Ef},10:{f:Gn},12:{f:$s},13:{f:$s},14:{f:Ma},15:{f:Ma},16:{f:Ea},17:{f:Ma},18:{f:Ma},19:{f:$s},20:{f:oe},21:{f:oe},23:{f:Oe},24:{f:Le},25:{f:Ma},26:{},27:{},28:{f:function(o,A,d){return(function(h,x){if(!(x.biff<8)){var w=h.read_shift(2),v=h.read_shift(2),N=h.read_shift(2),S=h.read_shift(2),E=bc(h,0,x);return x.biff<8&&h.read_shift(1),[{r:w,c:v},E,S,N]}})(o,d)}},29:{},34:{f:Ma},35:{f:Be},38:{f:Ea},39:{f:Ea},40:{f:Ea},41:{f:Ea},42:{f:Ma},43:{f:Ma},47:{f:function(o,A,d){var h={Type:8<=d.biff?o.read_shift(2):0};return h.Type?Lh(o,A-2,h):(A=o,d.biff,o=d,d=h,A={key:$s(A),verificationBytes:$s(A)},o.password&&(A.verifier=wf(o.password)),d.valid=A.verificationBytes===A.verifier,d.valid&&(d.insitu=S0(o.password))),h}},49:{f:function(o,A,d){var h={dyHeight:o.read_shift(2),fl:o.read_shift(2)};switch(d&&d.biff||8){case 2:break;case 3:case 4:o.l+=2;break;default:o.l+=10}return h.name=$l(o,0,d),h}},51:{f:$s},60:{},61:{f:function(o){return{Pos:[o.read_shift(2),o.read_shift(2)],Dim:[o.read_shift(2),o.read_shift(2)],Flags:o.read_shift(2),CurTab:o.read_shift(2),FirstTab:o.read_shift(2),Selected:o.read_shift(2),TabRatio:o.read_shift(2)}}},64:{f:Ma},65:{f:function(){}},66:{f:$s},77:{},80:{},81:{},82:{},85:{f:$s},89:{},90:{},91:{},92:{f:function(o,A,x){if(x.enc)return o.l+=A,"";var h=o.l,x=bc(o,0,x);return o.read_shift(A+h-o.l),x}},93:{f:function(o,A,d){return d&&d.biff<8?(function(h,x,w){h.l+=4;var v=h.read_shift(2),N=h.read_shift(2),S=h.read_shift(2);h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=2,h.l+=6,x-=36;var E=[];return E.push((ze[v]||yi)(h,x,w)),{cmo:[N,v,S],ft:E}})(o,A,d):{cmo:d=_h(o),ft:(function(h,x){for(var w=h.l+x,v=[];h.l<w;){var N=h.read_shift(2);h.l-=2;try{v.push(ri[N](h,w-h.l))}catch{return h.l=w,v}}return h.l!=w&&(h.l=w),v})(o,A-22,d[1])}}},94:{},95:{f:Ma},96:{},97:{},99:{f:Ma},125:{f:ht},128:{f:function(o){if(o.l+=4,(o=[o.read_shift(2),o.read_shift(2)])[0]!==0&&o[0]--,o[1]!==0&&o[1]--,7<o[0]||7<o[1])throw new Error("Bad Gutters: "+o.join("|"));return o}},129:{f:function(o,A,d){return{fDialog:16&(A=d&&d.biff==8||A==2?o.read_shift(2):(o.l+=A,0)),fBelow:64&A,fRight:128&A}}},130:{f:$s},131:{f:Ma},132:{f:Ma},133:{f:function(o,A,d){var h=o.read_shift(4),x=3&o.read_shift(1),w=o.read_shift(1);switch(w){case 0:w="Worksheet";break;case 1:w="Macrosheet";break;case 2:w="Chartsheet";break;case 6:w="VBAModule"}return d=$l(o,0,d),{pos:h,hs:x,dt:w,name:d=d.length===0?"Sheet1":d}}},134:{},140:{f:function(o){var A=[0,0],d=o.read_shift(2);return A[0]=g0[d]||d,d=o.read_shift(2),A[1]=g0[d]||d,A}},141:{f:$s},144:{},146:{f:function(o){for(var A=o.read_shift(2),d=[];0<A--;)d.push(yA(o));return d}},151:{},152:{},153:{},154:{},155:{},156:{f:$s},157:{},158:{},160:{f:at},161:{f:function(o,A){var d={};return A<32||(o.l+=16,d.header=Ea(o),d.footer=Ea(o),o.l+=2),d}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(o,A){for(var d=o.l+A-2,h=o.read_shift(2),x=o.read_shift(2),w=[];o.l<d;)w.push(Xc(o));if(o.l!==d)throw new Error("MulRK read error");if(A=o.read_shift(2),w.length!=A-x+1)throw new Error("MulRK length mismatch");return{r:h,c:x,C:A,rkrec:w}}},190:{f:function(o,A){for(var d=o.l+A-2,h=o.read_shift(2),x=o.read_shift(2),w=[];o.l<d;)w.push(o.read_shift(2));if(o.l!==d)throw new Error("MulBlank read error");if(A=o.read_shift(2),w.length!=A-x+1)throw new Error("MulBlank length mismatch");return{r:h,c:x,C:A,ixfe:w}}},193:{f:Gn},197:{},198:{},199:{},200:{},201:{},202:{f:Ma},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:$s},220:{},221:{f:Ma},222:{},224:{f:function(o,A,d){var h,x,w,v={};return v.ifnt=o.read_shift(2),v.numFmtId=o.read_shift(2),v.flags=o.read_shift(2),v.fStyle=v.flags>>2&1,A-=6,v.data=(h=o,v.fStyle,x=d,w={},A=h.read_shift(4),o=h.read_shift(4),d=h.read_shift(4),h=h.read_shift(2),w.patternType=x0[d>>26],x.cellStyles&&(w.alc=7&A,w.fWrap=A>>3&1,w.alcV=A>>4&7,w.fJustLast=A>>7&1,w.trot=A>>8&255,w.cIndent=A>>16&15,w.fShrinkToFit=A>>20&1,w.iReadOrder=A>>22&2,w.fAtrNum=A>>26&1,w.fAtrFnt=A>>27&1,w.fAtrAlc=A>>28&1,w.fAtrBdr=A>>29&1,w.fAtrPat=A>>30&1,w.fAtrProt=A>>31&1,w.dgLeft=15&o,w.dgRight=o>>4&15,w.dgTop=o>>8&15,w.dgBottom=o>>12&15,w.icvLeft=o>>16&127,w.icvRight=o>>23&127,w.grbitDiag=o>>30&3,w.icvTop=127&d,w.icvBottom=d>>7&127,w.icvDiag=d>>14&127,w.dgDiag=d>>21&15,w.icvFore=127&h,w.icvBack=h>>7&127,w.fsxButton=h>>14&1),w),v}},225:{f:function(o,A){return A===0||o.read_shift(2),1200}},226:{f:Gn},227:{},229:{f:function(o,A){for(var d=[],h=o.read_shift(2);h--;)d.push(Ai(o));return d}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(o,A){for(var d=o.l+A,A=o.read_shift(4),h=o.read_shift(4),x=[],w=0;w!=h&&o.l<d;++w)x.push((function(N){var S=u;u=1200;var E,I=N.read_shift(2),P=4&(re=N.read_shift(1)),K=8&re,W=1+(1&re),me=0,re={};return K&&(me=N.read_shift(2)),P&&(E=N.read_shift(4)),W=W==2?"dbcs-cont":"sbcs-cont",W=I===0?"":N.read_shift(I,W),K&&(N.l+=4*me),P&&(N.l+=E),re.t=W,K||(re.raw="<t>"+re.t+"</t>",re.r=re.t),u=S,re})(o));return x.Count=A,x.Unique=h,x}},253:{f:function(o){var A=Xi(o);return A.isst=o.read_shift(4),A}},255:{f:function(o,A){var d={};return d.dsst=o.read_shift(2),o.l+=A-2,d}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:gc},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ma},353:{f:Gn},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(o,w,d){var h=o.l+w,x=o.read_shift(2),w=o.read_shift(2);if((d.sbcch=w)==1025||w==14849)return[w,x];if(w<1||255<w)throw new Error("Unexpected SupBook type: "+w);for(var d=$c(o,w),v=[];h>o.l;)v.push(xc(o));return[w,x,d,v]}},431:{f:Ma},432:{},433:{},434:{},437:{},438:{f:function(o,A,d){var h=o.l,x="";try{o.l+=4;var w=(d.lastobj||{cmo:[0,0]}).cmo[1];[0,5,7,11,12,14].indexOf(w)==-1?o.l+=6:(function(E){var I=E.read_shift(1);E.l++;var P=E.read_shift(2);E.l+=2})(o);var v=o.read_shift(2);o.read_shift(2),$s(o),w=o.read_shift(2),o.l+=w;for(var N=1;N<o.lens.length-1;++N){if(o.l-h!=o.lens[N])throw new Error("TxO: bad continue record");var S=o[o.l];if((x+=$c(o,o.lens[N+1]-o.lens[N]-1)).length>=(S?v:2*v))break}if(x.length!==v&&x.length!==2*v)throw new Error("cchText: "+v+" != "+x.length);return o.l=h+A,{t:x}}catch{return o.l=h+A,{t:x}}}},439:{f:Ma},440:{f:function(o,A){var d=Ai(o);return o.l+=16,[d,(function(h,x){var w=h.l+x;if((P=h.read_shift(4))!==2)throw new Error("Unrecognized streamVersion: "+P);x=h.read_shift(2),h.l+=2;var v,N,S,E,I,P="";16&x&&(v=ql(h,h.l)),128&x&&(N=ql(h,h.l)),(257&x)==257&&(S=ql(h,h.l)),(257&x)==1&&(K=yc(h,h.l)),8&x&&(P=ql(h,h.l)),32&x&&(E=h.read_shift(16)),64&x&&(I=Md(h)),h.l=w;var K=N||S||K||"";return K&&P&&(K+="#"+P),K=K||"#"+P,K={Target:K=2&x&&K.charAt(0)=="/"&&K.charAt(1)!="/"?"file://"+K:K},E&&(K.guid=E),I&&(K.time=I),v&&(K.Tooltip=v),K})(o,A-24)]}},441:{},442:{f:xc},443:{},444:{f:$s},445:{},446:{},448:{f:Gn},449:{f:function(o){return o.read_shift(2),o.read_shift(4)},r:2},450:{f:Gn},512:{f:B},513:{f:He},515:{f:function(o,A,d){return d.biffguess&&d.biff==2&&(d.biff=5),d=Xi(o),o=Ea(o),d.val=o,d}},516:{f:function(o,A,d){return d.biffguess&&d.biff==2&&(d.biff=5),o.l,A=Xi(o),d.biff==2&&o.l++,d=xc(o,o.l,d),A.val=d,A}},517:{f:Y},519:{f:f1},520:{f:function(o){var A={};A.r=o.read_shift(2),A.c=o.read_shift(2),A.cnt=o.read_shift(2)-A.c;var d=o.read_shift(2);o.l+=4;var h=o.read_shift(1);return o.l+=3,7&h&&(A.level=7&h),32&h&&(A.hidden=!0),64&h&&(A.hpt=d/20),A}},523:{},545:{f:Re},549:{f:ju},566:{},574:{f:function(o,A,d){return d&&2<=d.biff&&d.biff<5?{}:{RTL:64&o.read_shift(2)}}},638:{f:function(h){var A=h.read_shift(2),d=h.read_shift(2),h=Xc(h);return{r:A,c:d,ixfe:h[0],rknum:h[1]}}},659:{},1048:{},1054:{f:function(o,A,d){return[o.read_shift(2),bc(o,0,d)]}},1084:{},1212:{f:function(o,A,d){var h=y0(o);o.l++;var x=o.read_shift(1);return[(function(w,v,N){var S,E=w.l+v,I=w.read_shift(2),P=M0(w,I,N);return I==65535?[[],yi(w,v-2)]:(v!==I+2&&(S=Lu(w,E-I-2,P,N)),[P,S])})(o,A-=8,d),x,h]}},2048:{f:function(o,A){return o.read_shift(2),[Ai(o),o.read_shift((A-10)/2,"dbcs-cont").replace(fe,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Jc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Gn},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(o){o.l+=2;var A={cxfs:0,crc:0};return A.cxfs=o.read_shift(2),A.crc=o.read_shift(4),A},r:12},2173:{f:function(o,A){o.l,o.l+=2,A=o.read_shift(2),o.l+=2;for(var d=o.read_shift(2),h=[];0<d--;)h.push(Ug(o,o.l));return{ixfe:A,ext:h}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ma,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(o,A,d){if(!(d.biff<8)){var h=o.read_shift(2),x=o.read_shift(2);return[$c(o,h,d),$c(o,x,d)]}o.l+=A},r:12},2197:{},2198:{f:function(o,A,d){var h=o.l+A;if(o.read_shift(4)!==124226)if(d.cellStyles){var x,w=o.slice(o.l);o.l=h;try{x=$r(w,{type:"array"})}catch{return}if(A=zt(x,"theme/theme/theme1.xml",!0),A)return Pd(A,d)}else o.l=h},r:12},2199:{},2200:{},2201:{},2202:{f:function(o){return[o.read_shift(4)!==0,o.read_shift(4)!==0,o.read_shift(4)]},r:12},2203:{f:Gn},2204:{},2205:{},2206:{},2207:{},2211:{f:function(o){var A,d,h=(d=(A=o).read_shift(2),h=A.read_shift(2),A.l+=8,{type:d});if(h.type!=2211)throw new Error("Invalid Future Record "+h.type);return o.read_shift(4)!==0}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:$s},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(o,A,d){var h={area:!1};return d.biff!=5?o.l+=A:(A=o.read_shift(1),o.l+=3,16&A&&(h.area=!0)),h}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(o){for(var A=o.read_shift(2),d=[];0<A--;)d.push(yA(o));return d}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:B},1:{},2:{f:function(o){var A=Xi(o);return++o.l,o=o.read_shift(2),A.t="n",A.val=o,A}},3:{f:function(o){var A=Xi(o);return++o.l,o=Ea(o),A.t="n",A.val=o,A}},4:{f:function(o,A,d){d.biffguess&&d.biff==5&&(d.biff=2);var h=Xi(o);return++o.l,d=bc(o,0,d),h.t="str",h.val=d,h}},5:{f:Y},7:{f:function(o){var A=o.read_shift(1);return A===0?(o.l++,""):o.read_shift(A,"sbcs-cont")}},8:{},9:{f:Jc},11:{},22:{f:$s},30:{f:$d},31:{},32:{},33:{f:Re},36:{},37:{f:ju},50:{f:function(o,A){o.l+=6,o.l+=2,o.l+=1,o.l+=3,o.l+=1,o.l+=A-13}},62:{},52:{},67:{},68:{f:$s},69:{},86:{},126:{},127:{f:function(o){var A=o.read_shift(2),h=o.read_shift(2),d=o.read_shift(4),h={fmt:A,env:h,len:d,data:o.slice(o.l,o.l+d)};return o.l+=d,h}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(o,w,v){var h=o.l+w,x=Xi(o),w=o.read_shift(2),v=$c(o,w,v);return o.l=h,x.t="str",x.val=v,x}},223:{},234:{},354:{},421:{},518:{f:Ef},521:{f:Jc},536:{f:Le},547:{f:Be},561:{},579:{},1030:{f:Ef},1033:{f:Jc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function br(o,A,d,h){var x=A;isNaN(x)||(A=h||(d||[]).length||0,(h=o.next(4)).write_shift(2,x),h.write_shift(2,A),0<A&&Gt(d)&&o.push(d))}function Y0(o,A,d){return(o=o||Ft(7)).write_shift(2,A),o.write_shift(2,d),o.write_shift(2,0),o.write_shift(1,0),o}function rx(o,A,d,h){if(A.v!=null)switch(A.t){case"d":case"n":var x=A.t=="d"?ms(ba(A.v)):A.v;return void(x==(0|x)&&0<=x&&x<65536?br(o,2,(I=d,P=h,K=x,Y0(W=Ft(9),I,P),W.write_shift(2,K),W)):br(o,3,(K=d,W=h,x=x,Y0(E=Ft(15),K,W),E.write_shift(8,x,"f"),E)));case"b":case"e":return void br(o,5,(E=d,w=h,v=A.v,N=A.t,Y0(S=Ft(9),E,w),_i(v,N||"b",S),S));case"s":case"str":return void br(o,4,(w=d,v=h,N=(A.v||"").slice(0,255),Y0(S=Ft(8+2*N.length),w,v),S.write_shift(1,N.length),S.write_shift(N.length,N,"sbcs"),S.l<S.length?S.slice(0,S.l):S))}var w,v,N,S,E,I,P,K,W;br(o,1,Y0(null,d,h))}function ax(o,A){for(var d=A||{},A=In(),h=0,x=0;x<o.SheetNames.length;++x)o.SheetNames[x]==d.sheet&&(h=x);if(h==0&&d.sheet&&o.SheetNames[0]!=d.sheet)throw new Error("Sheet not found: "+d.sheet);return br(A,d.biff==4?1033:d.biff==3?521:9,JA(0,16,d)),(function(w,v,N){var S,E,I=Array.isArray(v),P=Fa(v["!ref"]||"A1"),K=[];if(255<P.e.c||16383<P.e.r){if(N.WTF)throw new Error("Range "+(v["!ref"]||"A1")+" exceeds format limit A1:IV16384");P.e.c=Math.min(P.e.c,255),P.e.r=Math.min(P.e.c,16383),S=fa(P)}for(var W=P.s.r;W<=P.e.r;++W){E=Vs(W);for(var me=P.s.c;me<=P.e.c;++me){W===P.s.r&&(K[me]=Sa(me)),S=K[me]+E;var re=I?(v[W]||[])[me]:v[S];re&&rx(w,re,W,me)}}})(A,o.Sheets[o.SheetNames[h]],d),br(A,10),A.end()}function Rf(o,A,d){var h,x;br(o,49,(x=(h={sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"}).name||"Arial",(o=Ft((d=(o=d)&&o.biff==5)?15+x.length:16+2*x.length)).write_shift(2,20*(h.sz||12)),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,x.length),d||o.write_shift(1,1),o.write_shift((d?1:2)*x.length,x,d?"sbcs":"utf16le"),o))}function om(o,A,d){A&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(h){for(var x,w,v,N,S=h[0];S<=h[1];++S)A[S]!=null&&br(o,1054,(x=S,w=A[S],N=void 0,v=(v=d)&&v.biff==5,(N=N||Ft(v?3+w.length:5+2*w.length)).write_shift(2,x),N.write_shift(v?1:2,w.length),v||N.write_shift(1,1),N.write_shift((v?1:2)*w.length,w,v?"sbcs":"utf16le"),(N=N.length>N.l?N.slice(0,N.l):N).l==null&&(N.l=N.length),N))})}function sx(o,A){for(var d=0;d<A["!links"].length;++d){var h=A["!links"][d];br(o,440,Ze(h)),h[1].Tooltip&&br(o,2048,(function(x){var w=x[1].Tooltip,v=Ft(10+2*(w.length+1));v.write_shift(2,2048),x=Es(x[0]),v.write_shift(2,x.r),v.write_shift(2,x.r),v.write_shift(2,x.c),v.write_shift(2,x.c);for(var N=0;N<w.length;++N)v.write_shift(2,w.charCodeAt(N));return v.write_shift(2,0),v})(h))}delete A["!links"]}function nx(o,A){var d;A&&(d=0,A.forEach(function(h,x){var w;++d<=256&&h&&br(o,125,(w=_f(x,h),h=x,(x=Ft(12)).write_shift(2,h),x.write_shift(2,h),x.write_shift(2,256*w.width),x.write_shift(2,0),h=0,w.hidden&&(h|=1),x.write_shift(1,h),h=w.level||0,x.write_shift(1,h),x.write_shift(2,0),x))}))}function ix(o,A,d,h,x){var w,v,N,S,E,I,P,K,W,me,re,De=16+ad(x.cellXfs,A,x);if(A.v!=null||A.bf)if(A.bf)br(o,6,I0(A,d,h,0,De));else switch(A.t){case"d":case"n":var be=A.t=="d"?ms(ba(A.v)):A.v;br(o,515,(I=d,P=h,K=be,W=De,me=Ft(14),vc(I,P,W,me),Ya(K,me),me));break;case"b":case"e":br(o,517,(be=d,I=h,P=A.v,W=De,K=A.t,me=Ft(8),vc(be,I,W,me),_i(P,K,me),me));break;case"s":case"str":x.bookSST?(re=Q0(x.Strings,A.v,x.revStrings),br(o,253,(w=d,v=h,N=re,S=De,E=Ft(10),vc(w,v,S,E),E.write_shift(4,N),E))):br(o,516,(re=d,w=h,v=(A.v||"").slice(0,255),S=De,N=Ft(+(E=!(N=x)||N.biff==8)+8+(1+E)*v.length),vc(re,w,S,N),N.write_shift(2,v.length),E&&N.write_shift(1,1),N.write_shift((1+E)*v.length,v,E?"utf16le":"sbcs"),N));break;default:br(o,513,vc(d,h,De))}else br(o,513,vc(d,h,De))}function ox(o,A,d){var h,x,w=In(),Ee=d.SheetNames[o],v=d.Sheets[Ee]||{},N=(d||{}).Workbook||{},S=(N.Sheets||[])[o]||{},E=Array.isArray(v),I=A.biff==8,P=[],K=Fa(v["!ref"]||"A1"),W=I?65536:16384;if(255<K.e.c||K.e.r>=W){if(A.WTF)throw new Error("Range "+(v["!ref"]||"A1")+" exceeds format limit A1:IV16384");K.e.c=Math.min(K.e.c,255),K.e.r=Math.min(K.e.c,W-1)}br(w,2057,JA(0,16,A)),br(w,13,Qo(1)),br(w,12,Qo(100)),br(w,15,xn(!0)),br(w,17,xn(!1)),br(w,16,Ya(.001)),br(w,95,xn(!0)),br(w,42,xn(!1)),br(w,43,xn(!1)),br(w,130,Qo(1)),br(w,128,(d=[0,0],(o=Ft(8)).write_shift(4,0),o.write_shift(2,d[0]?d[0]+1:0),o.write_shift(2,d[1]?d[1]+1:0),o)),br(w,131,xn(!1)),br(w,132,xn(!1)),I&&nx(w,v["!cols"]),br(w,512,(W=K,(d=Ft(2*(o=(d=A).biff!=8&&d.biff?2:4)+6)).write_shift(o,W.s.r),d.write_shift(o,W.e.r+1),d.write_shift(2,W.s.c),d.write_shift(2,W.e.c+1),d.write_shift(2,0),d)),I&&(v["!links"]=[]);for(var me=K.s.r;me<=K.e.r;++me){x=Vs(me);for(var re=K.s.c;re<=K.e.c;++re){me===K.s.r&&(P[re]=Sa(re)),h=P[re]+x;var De=E?(v[me]||[])[re]:v[h];De&&(ix(w,De,me,re,A),I&&De.l&&v["!links"].push([h,De.l]))}}var be,ce,Ee=S.CodeName||S.name||Ee;return I&&br(w,574,(N=(N.Views||[])[0],ce=Ft(18),be=1718,N&&N.RTL&&(be|=64),ce.write_shift(2,be),ce.write_shift(4,0),ce.write_shift(4,64),ce.write_shift(4,0),ce.write_shift(4,0),ce)),I&&(v["!merges"]||[]).length&&br(w,229,(function(Ue){var Ie=Ft(2+8*Ue.length);Ie.write_shift(2,Ue.length);for(var $e=0;$e<Ue.length;++$e)Nu(Ue[$e],Ie);return Ie})(v["!merges"])),I&&sx(w,v),br(w,442,qc(Ee)),I&&(be=w,ce=v,(Ee=Ft(19)).write_shift(4,2151),Ee.write_shift(4,0),Ee.write_shift(4,0),Ee.write_shift(2,3),Ee.write_shift(1,1),Ee.write_shift(4,0),br(be,2151,Ee),(Ee=Ft(39)).write_shift(4,2152),Ee.write_shift(4,0),Ee.write_shift(4,0),Ee.write_shift(2,3),Ee.write_shift(1,0),Ee.write_shift(4,0),Ee.write_shift(2,1),Ee.write_shift(4,4),Ee.write_shift(2,0),Nu(Fa(ce["!ref"]||"A1"),Ee),Ee.write_shift(4,4),br(be,2152,Ee)),br(w,10),w.end()}function lx(o,A,d){var h=In(),N=(o||{}).Workbook||{},x=N.Sheets||[],w=N.WBProps||{},v=d.biff==8,N=d.biff==5;br(h,2057,JA(0,5,d)),d.bookType=="xla"&&br(h,135),br(h,225,v?Qo(1200):null),br(h,193,(function(be,ce){ce=ce||Ft(be);for(var Ee=0;Ee<be;++Ee)ce.write_shift(1,0);return ce})(2)),N&&br(h,191),N&&br(h,192),br(h,226),br(h,92,(function(be){var ce=!be||be.biff==8,Ee=Ft(ce?112:54);for(Ee.write_shift(be.biff==8?2:1,7),ce&&Ee.write_shift(1,0),Ee.write_shift(4,859007059),Ee.write_shift(4,5458548|(ce?0:536870912));Ee.l<Ee.length;)Ee.write_shift(1,ce?0:32);return Ee})(d)),br(h,66,Qo(v?1200:1252)),v&&br(h,353,Qo(0)),v&&br(h,448),br(h,317,(function(be){for(var ce=Ft(2*be),Ee=0;Ee<be;++Ee)ce.write_shift(2,Ee+1);return ce})(o.SheetNames.length)),v&&o.vbaraw&&br(h,211),v&&o.vbaraw&&br(h,442,qc(w.CodeName||"ThisWorkbook")),br(h,156,Qo(17)),br(h,25,xn(!1)),br(h,18,xn(!1)),br(h,19,Qo(0)),v&&br(h,431,xn(!1)),v&&br(h,444,Qo(0)),br(h,61,((N=Ft(18)).write_shift(2,0),N.write_shift(2,0),N.write_shift(2,29280),N.write_shift(2,17600),N.write_shift(2,56),N.write_shift(2,0),N.write_shift(2,0),N.write_shift(2,1),N.write_shift(2,500),N)),br(h,64,xn(!1)),br(h,141,Qo(0)),br(h,34,xn(((w=o).Workbook&&w.Workbook.WBProps&&Ps(w.Workbook.WBProps.date1904)?"true":"false")=="true")),br(h,14,xn(!0)),v&&br(h,439,xn(!1)),br(h,218,Qo(0)),Rf(h,0,d),om(h,o.SSF,d),(function(be,ce){for(var Ee=0;Ee<16;++Ee)br(be,224,D({numFmtId:0,style:!0},0,ce));ce.cellXfs.forEach(function(Ue){br(be,224,D(Ue,0,ce))})})(h,d),v&&br(h,352,xn(!1)),N=h.end(),w=In(),v&&br(w,140,((De=De||Ft(4)).write_shift(2,1),De.write_shift(2,1),De)),v&&d.Strings&&(function(be,ce,Ee){var Ue=(Ee||[]).length||0;if(Ue<=8224)return br(be,ce,Ee,Ue);if(!isNaN(ce)){for(var Ie=Ee.parts||[],$e=0,st=0,rt=0;rt+(Ie[$e]||8224)<=8224;)rt+=Ie[$e]||8224,$e++;var mt=be.next(4);for(mt.write_shift(2,ce),mt.write_shift(2,rt),be.push(Ee.slice(st,st+rt)),st+=rt;st<Ue;){for((mt=be.next(4)).write_shift(2,60),rt=0;rt+(Ie[$e]||8224)<=8224;)rt+=Ie[$e]||8224,$e++;mt.write_shift(2,rt),be.push(Ee.slice(st,st+rt)),st+=rt}}})(w,252,Cu(d.Strings)),br(w,10);for(var h=w.end(),S=In(),E=0,I=0,I=0;I<o.SheetNames.length;++I)E+=(v?12:11)+(v?2:1)*o.SheetNames[I].length;var P,K,W,me,re=N.length+E+h.length;for(I=0;I<o.SheetNames.length;++I)br(S,133,(P={pos:re,hs:(x[I]||{}).Hidden||0,dt:0,name:o.SheetNames[I]},me=W=void 0,W=!(K=d)||8<=K.biff?2:1,(me=Ft(8+W*P.name.length)).write_shift(4,P.pos),me.write_shift(1,P.hs||0),me.write_shift(1,P.dt),me.write_shift(1,P.name.length),8<=K.biff&&me.write_shift(1,1),me.write_shift(W*P.name.length,P.name,K.biff<8?"sbcs":"utf16le"),(K=me.slice(0,me.l)).l=me.l,K)),re+=A[I].length;var De=S.end();if(E!=De.length)throw new Error("BS8 "+E+" != "+De.length);return w=[],N.length&&w.push(N),De.length&&w.push(De),h.length&&w.push(h),ge(w)}function qp(o,A){for(var d=0;d<=o.SheetNames.length;++d){var h=o.Sheets[o.SheetNames[d]];h&&h["!ref"]&&255<vi(h["!ref"]).e.c&&typeof console<"u"&&console.error&&console.error("Worksheet '"+o.SheetNames[d]+"' extends beyond column IV (255).  Data may be lost.")}var x=A||{};switch(x.biff||2){case 8:case 5:return(function(w,v){var N=v||{},S=[];w&&!w.SSF&&(w.SSF=Oa(X)),w&&w.SSF&&(wa(),Pr(w.SSF),N.revssf=ko(w.SSF),N.revssf[w.SSF[65535]]=0,N.ssf=w.SSF),N.Strings=[],N.Strings.Count=0,N.Strings.Unique=0,pm(N),N.cellXfs=[],ad(N.cellXfs,{},{revssf:{General:0}}),w.Props||(w.Props={});for(var E=0;E<w.SheetNames.length;++E)S[S.length]=ox(E,N,w);return S.unshift(lx(w,S,N)),ge(S)})(o,A);case 4:case 3:case 2:return ax(o,A)}throw new Error("invalid type "+x.bookType+" for BIFF")}function W0(o,A){var d=A||{},h=d.dense?[]:{},x=(o=o.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!x)throw new Error("Invalid HTML: could not find <table>");for(var w,A=o.match(/<\/table/i),K=x.index,v=A&&A.index||o.length,N=$o(o.slice(K,v),/(:?<tr[^>]*>)/i,"<tr>"),S=-1,E=0,I={s:{r:1e7,c:1e7},e:{r:0,c:0}},P=[],K=0;K<N.length;++K){var W=N[K].trim(),me=W.slice(0,3).toLowerCase();if(me!="<tr"){if(me=="<td"||me=="<th")for(var re=W.split(/<\/t[dh]>/i),v=0;v<re.length;++v){var De=re[v].trim();if(De.match(/<t[dh]/i)){for(var be=De,ce=0;be.charAt(0)=="<"&&-1<(ce=be.indexOf(">"));)be=be.slice(ce+1);for(var Ee=0;Ee<P.length;++Ee){var Ue=P[Ee];Ue.s.c==E&&Ue.s.r<S&&S<=Ue.e.r&&(E=Ue.e.c+1,Ee=-1)}var Ie=Cr(De.slice(0,De.indexOf(">"))),$e=Ie.colspan?+Ie.colspan:1;(1<(w=+Ie.rowspan)||1<$e)&&P.push({s:{r:S,c:E},e:{r:S+(w||1)-1,c:E+$e-1}}),De=Ie.t||Ie["data-t"]||"",be.length&&(be=mu(be),I.s.r>S&&(I.s.r=S),I.e.r<S&&(I.e.r=S),I.s.c>E&&(I.s.c=E),I.e.c<E&&(I.e.c=E),be.length&&(Ie={t:"s",v:be},d.raw||!be.trim().length||De=="s"||(be==="TRUE"?Ie={t:"b",v:!0}:be==="FALSE"?Ie={t:"b",v:!1}:isNaN(gi(be))?isNaN(Fi(be).getDate())||(Ie={t:"d",v:ba(be)},(Ie=d.cellDates?Ie:{t:"n",v:ms(Ie.v)}).z=d.dateNF||X[14]):Ie={t:"n",v:gi(be)}),d.dense?(h[S]||(h[S]=[]),h[S][E]=Ie):h[ha({r:S,c:E})]=Ie)),E+=$e}}}else{if(++S,d.sheetRows&&d.sheetRows<=S){--S;break}E=0}}return h["!ref"]=fa(I),P.length&&(h["!merges"]=P),h}function Xp(o,A,d,h){for(var x=o["!merges"]||[],w=[],v=A.s.c;v<=A.e.c;++v){for(var N,S,E,I,P=0,K=0,W=0;W<x.length;++W)if(!(x[W].s.r>d||x[W].s.c>v||x[W].e.r<d||x[W].e.c<v)){if(x[W].s.r<d||x[W].s.c<v){P=-1;break}P=x[W].e.r-x[W].s.r+1,K=x[W].e.c-x[W].s.c+1;break}P<0||(N=ha({r:d,c:v}),E=(S=h.dense?(o[d]||[])[v]:o[N])&&S.v!=null&&(S.h||Gi(S.w||(Lo(S),S.w)||""))||"",I={},1<P&&(I.rowspan=P),1<K&&(I.colspan=K),h.editable?E='<span contenteditable="true">'+E+"</span>":S&&(I["data-t"]=S&&S.t||"z",S.v!=null&&(I["data-v"]=S.v),S.z!=null&&(I["data-z"]=S.z),S.l&&(S.l.Target||"#").charAt(0)!="#"&&(E='<a href="'+S.l.Target+'">'+E+"</a>")),I.id=(h.id||"sjs")+"-"+N,w.push(lr("td",E,I)))}return"<tr>"+w.join("")+"</tr>"}var Jp='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Hs="</body></html>";function lm(o,A,d){return[].join("")+"<table"+(d&&d.id?' id="'+d.id+'"':"")+">"}function cx(o,x){var d=x||{},h=d.header!=null?d.header:Jp,x=d.footer!=null?d.footer:Hs,w=[h],v=vi(o["!ref"]);d.dense=Array.isArray(o),w.push(lm(0,0,d));for(var N=v.s.r;N<=v.e.r;++N)w.push(Xp(o,v,N,d));return w.push("</table>"+x),w.join("")}function Zp(o,A,d){var h=d||{},x=0,w=0;h.origin!=null&&(typeof h.origin=="number"?x=h.origin:(x=(d=typeof h.origin=="string"?Es(h.origin):h.origin).r,w=d.c));var v=A.getElementsByTagName("tr"),N=Math.min(h.sheetRows||1e7,v.length),S={s:{r:0,c:0},e:{r:x,c:w}};o["!ref"]&&(A=vi(o["!ref"]),S.s.r=Math.min(S.s.r,A.s.r),S.s.c=Math.min(S.s.c,A.s.c),S.e.r=Math.max(S.e.r,A.e.r),S.e.c=Math.max(S.e.c,A.e.c),x==-1&&(S.e.r=x=A.e.r+1));var E,I,P=[],K=0,W=o["!rows"]||(o["!rows"]=[]),me=0,re=0,De=0,be=0;for(o["!cols"]||(o["!cols"]=[]);me<v.length&&re<N;++me){var ce=v[me];if(dx(ce)){if(h.display)continue;W[re]={hidden:!0}}for(var Ee=ce.children,De=be=0;De<Ee.length;++De){var Ue=Ee[De];if(!h.display||!dx(Ue)){for(var Ie=Ue.hasAttribute("data-v")?Ue.getAttribute("data-v"):Ue.hasAttribute("v")?Ue.getAttribute("v"):mu(Ue.innerHTML),$e=Ue.getAttribute("data-z")||Ue.getAttribute("z"),K=0;K<P.length;++K){var st=P[K];st.s.c==be+w&&st.s.r<re+x&&re+x<=st.e.r&&(be=st.e.c+1-w,K=-1)}I=+Ue.getAttribute("colspan")||1,(1<(E=+Ue.getAttribute("rowspan")||1)||1<I)&&P.push({s:{r:re+x,c:be+w},e:{r:re+x+(E||1)-1,c:be+w+(I||1)-1}});var rt={t:"s",v:Ie},mt=Ue.getAttribute("data-t")||Ue.getAttribute("t")||"";Ie!=null&&(Ie.length==0?rt.t=mt||"z":h.raw||Ie.trim().length==0||mt=="s"||(Ie==="TRUE"?rt={t:"b",v:!0}:Ie==="FALSE"?rt={t:"b",v:!1}:isNaN(gi(Ie))?isNaN(Fi(Ie).getDate())||(rt={t:"d",v:ba(Ie)},(rt=h.cellDates?rt:{t:"n",v:ms(rt.v)}).z=h.dateNF||X[14]):rt={t:"n",v:gi(Ie)})),rt.z===void 0&&$e!=null&&(rt.z=$e);var Mt="",Qt=Ue.getElementsByTagName("A");if(Qt&&Qt.length)for(var vt=0;vt<Qt.length&&(!Qt[vt].hasAttribute("href")||(Mt=Qt[vt].getAttribute("href")).charAt(0)=="#");++vt);Mt&&Mt.charAt(0)!="#"&&(rt.l={Target:Mt}),h.dense?(o[re+x]||(o[re+x]=[]),o[re+x][be+w]=rt):o[ha({c:be+w,r:re+x})]=rt,S.e.c<be+w&&(S.e.c=be+w),be+=I}}++re}return P.length&&(o["!merges"]=(o["!merges"]||[]).concat(P)),S.e.r=Math.max(S.e.r,re-1+x),o["!ref"]=fa(S),N<=re&&(o["!fullref"]=fa((S.e.r=v.length-me+re-1+x,S))),o}function Ax(o,A){return Zp((A||{}).dense?[]:{},o,A)}function dx(o){var d,A="",d=(d=o).ownerDocument.defaultView&&typeof d.ownerDocument.defaultView.getComputedStyle=="function"?d.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null;return(A=(A=d?d(o).getPropertyValue("display"):A)||o.style&&o.style.display)==="none"}var ux={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function $0(o,A){var d=A||{},h,x,w,v,N,S=Mc(o),E=[],I={name:""},P="",K=0,W={},me=[],re=d.dense?[]:{},De={value:""},be="",ce=0,Ee=[],Ue=-1,Ie=-1,$e={s:{r:1e6,c:1e7},e:{r:0,c:0}},st=0,rt={},mt=[],Mt={},Qt=[],vt=1,Zt=1,Br=[],wr={Names:[]},cr={},ur=["",""],nr=[],Vt={},kr="",Rr=0,na=!1,Ga=!1,Sr=0;for(Zo.lastIndex=0,S=S.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=Zo.exec(S);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?($e.e.c>=$e.s.c&&$e.e.r>=$e.s.r?re["!ref"]=fa($e):re["!ref"]="A1:A1",0<d.sheetRows&&d.sheetRows<=$e.e.r&&(re["!fullref"]=re["!ref"],$e.e.r=d.sheetRows-1,re["!ref"]=fa($e)),mt.length&&(re["!merges"]=mt),Qt.length&&(re["!rows"]=Qt),w.name=w.||w.name,typeof JSON<"u"&&JSON.stringify(w),me.push(w.name),W[w.name]=re,Ga=!1):v[0].charAt(v[0].length-2)!=="/"&&(w=Cr(v[0],!1),Ue=Ie=-1,$e.s.r=$e.s.c=1e7,$e.e.r=$e.e.c=0,re=d.dense?[]:{},mt=[],Qt=[],Ga=!0);break;case"table-row-group":v[1]==="/"?--st:++st;break;case"table-row":case"":if(v[1]==="/"){Ue+=vt,vt=1;break}if((er=Cr(v[0],!1)).?Ue=er.-1:Ue==-1&&(Ue=0),(vt=+er["number-rows-repeated"]||1)<10)for(Sr=0;Sr<vt;++Sr)0<st&&(Qt[Ue+Sr]={level:st});Ie=-1;break;case"covered-table-cell":v[1]!=="/"&&++Ie,d.sheetStubs&&(d.dense?(re[Ue]||(re[Ue]=[]),re[Ue][Ie]={t:"z"}):re[ha({r:Ue,c:Ie})]={t:"z"}),be="",Ee=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++Ie,De=Cr(v[0],!1),Zt=parseInt(De["number-columns-repeated"]||"1",10),N={t:"z",v:null},De.formula&&d.cellFormula!=0&&(N.f=kf(ma(De.formula))),(De.||De["value-type"])=="string"&&(N.t="s",N.v=ma(De["string-value"]||""),d.dense?(re[Ue]||(re[Ue]=[]),re[Ue][Ie]=N):re[ha({r:Ue,c:Ie})]=N),Ie+=Zt-1;else if(v[1]!=="/"){be="",ce=0,Ee=[],Zt=1;var er=vt?Ue+vt-1:Ue;if(++Ie>$e.e.c&&($e.e.c=Ie),Ie<$e.s.c&&($e.s.c=Ie),Ue<$e.s.r&&($e.s.r=Ue),er>$e.e.r&&($e.e.r=er),nr=[],Vt={},N={t:(De=Cr(v[0],!1)).||De["value-type"],v:null},d.cellFormula)if(De.formula&&(De.formula=ma(De.formula)),De["number-matrix-columns-spanned"]&&De["number-matrix-rows-spanned"]&&(Mt={s:{r:Ue,c:Ie},e:{r:Ue+(parseInt(De["number-matrix-rows-spanned"],10)||0)-1,c:Ie+(parseInt(De["number-matrix-columns-spanned"],10)||0)-1}},N.F=fa(Mt),Br.push([Mt,N.F])),De.formula)N.f=kf(De.formula);else for(Sr=0;Sr<Br.length;++Sr)Ue>=Br[Sr][0].s.r&&Ue<=Br[Sr][0].e.r&&Ie>=Br[Sr][0].s.c&&Ie<=Br[Sr][0].e.c&&(N.F=Br[Sr][1]);switch((De["number-columns-spanned"]||De["number-rows-spanned"])&&(Mt={s:{r:Ue,c:Ie},e:{r:Ue+(parseInt(De["number-rows-spanned"],10)||0)-1,c:Ie+(parseInt(De["number-columns-spanned"],10)||0)-1}},mt.push(Mt)),De["number-columns-repeated"]&&(Zt=parseInt(De["number-columns-repeated"],10)),N.t){case"boolean":N.t="b",N.v=Ps(De["boolean-value"]);break;case"float":case"percentage":case"currency":N.t="n",N.v=parseFloat(De.value);break;case"date":N.t="d",N.v=ba(De["date-value"]),d.cellDates||(N.t="n",N.v=ms(N.v)),N.z="m/d/yy";break;case"time":N.t="n",N.v=(function(Ja){var Ls=0,Zn=0,Je=!1,Us=Ja.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!Us)throw new Error("|"+Ja+"| is not an ISO8601 Duration");for(var bs=1;bs!=Us.length;++bs)if(Us[bs]){switch(Zn=1,3<bs&&(Je=!0),Us[bs].slice(Us[bs].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+Us[bs].slice(Us[bs].length-1));case"D":Zn*=24;case"H":Zn*=60;case"M":if(!Je)throw new Error("Unsupported ISO Duration Field: M");Zn*=60}Ls+=Zn*parseInt(Us[bs],10)}return Ls})(De["time-value"])/86400,d.cellDates&&(N.t="d",N.v=_n(N.v)),N.z="HH:MM:SS";break;case"number":N.t="n",N.v=parseFloat(De.);break;default:if(N.t!=="string"&&N.t!=="text"&&N.t)throw new Error("Unsupported value type "+N.t);N.t="s",De["string-value"]!=null&&(be=ma(De["string-value"]),Ee=[])}}else{if(na=!1,N.t==="s"&&(N.v=be||"",Ee.length&&(N.R=Ee),na=ce==0),cr.Target&&(N.l=cr),0<nr.length&&(N.c=nr,nr=[]),be&&d.cellText!==!1&&(N.w=be),na&&(N.t="z",delete N.v),(!na||d.sheetStubs)&&!(d.sheetRows&&d.sheetRows<=Ue))for(var Na=0;Na<vt;++Na){if(Zt=parseInt(De["number-columns-repeated"]||"1",10),d.dense)for(re[Ue+Na]||(re[Ue+Na]=[]),re[Ue+Na][Ie]=Na==0?N:Oa(N);0<--Zt;)re[Ue+Na][Ie+Zt]=Oa(N);else for(re[ha({r:Ue+Na,c:Ie})]=N;0<--Zt;)re[ha({r:Ue+Na,c:Ie+Zt})]=Oa(N);$e.e.c<=Ie&&($e.e.c=Ie)}Ie+=(Zt=parseInt(De["number-columns-repeated"]||"1",10))-1,Zt=0,N={},be="",Ee=[]}cr={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((h=E.pop())[0]!==v[3])throw"Bad state: "+h}else v[0].charAt(v[0].length-2)!=="/"&&E.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((h=E.pop())[0]!==v[3])throw"Bad state: "+h;Vt.t=be,Ee.length&&(Vt.R=Ee),Vt.a=kr,nr.push(Vt)}else v[0].charAt(v[0].length-2)!=="/"&&E.push([v[3],!1]);be=kr="",ce=Rr=0,Ee=[];break;case"creator":v[1]==="/"?kr=S.slice(Rr,v.index):Rr=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((h=E.pop())[0]!==v[3])throw"Bad state: "+h}else v[0].charAt(v[0].length-2)!=="/"&&E.push([v[3],!1]);be="",ce=0,Ee=[];break;case"scientific-number":case"currency-symbol":case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(rt[I.name]=P,(h=E.pop())[0]!==v[3])throw"Bad state: "+h}else v[0].charAt(v[0].length-2)!=="/"&&(P="",I=Cr(v[0],!1),E.push([v[3],!0]));break;case"script":case"libraries":case"automatic-styles":break;case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":break;case"number":switch(E[E.length-1][0]){case"time-style":case"date-style":x=Cr(v[0],!1),P+=ux[v[3]][x.style==="long"?1:0]}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(E[E.length-1][0]){case"time-style":case"date-style":x=Cr(v[0],!1),P+=ux[v[3]][x.style==="long"?1:0]}break;case"boolean-style":case"boolean":case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(E[E.length-1][0]){case"number-style":case"date-style":case"time-style":P+=S.slice(K,v.index)}else K=v.index+v[0].length;break;case"named-range":ur=Bc((x=Cr(v[0],!1))["cell-range-address"]);var is={Name:x.name,Ref:ur[0]+"!"+ur[1]};Ga&&(is.Sheet=me.length),wr.Names.push(is);break;case"text-content":case"text-properties":case"embedded-text":break;case"body":case"":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":break;case"p":case"":if(-1<["master-styles"].indexOf(E[E.length-1][0]))break;v[1]!=="/"||De&&De["string-value"]?(Cr(v[0],!1),ce=v.index+v[0].length):(is=(is=S.slice(ce,v.index)).replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(Ja,Ls){return Array(parseInt(Ls,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),is=[ma(is.replace(/<[^>]*>/g,""))],be=(0<be.length?be+`
`:"")+is[0]);break;case"s":break;case"database-range":if(v[1]==="/")break;try{W[(ur=Bc(Cr(v[0])["target-range-address"]))[0]]["!autofilter"]={ref:ur[1]}}catch{}break;case"date":case"object":break;case"title":case"":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":break;case"a":if(v[1]!=="/"){if(!(cr=Cr(v[0],!1)).href)break;cr.Target=ma(cr.href),delete cr.href,cr.Target.charAt(0)=="#"&&-1<cr.Target.indexOf(".")?(ur=Bc(cr.Target.slice(1)),cr.Target="#"+ur[0]+"!"+ur[1]):cr.Target.match(/^\.\.[\\\/]/)&&(cr.Target=cr.Target.slice(3))}break;case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(d.WTF)throw new Error(v)}}return o={Sheets:W,SheetNames:me,Workbook:wr},d.bookSheets&&delete o.Sheets,o}function Ou(o,A){A=A||{},Ln(o,"META-INF/manifest.xml")&&(function(h,x){for(var w,v,N=Mc(h);w=Zo.exec(N);)switch(w[3]){case"manifest":break;case"file-entry":if((v=Cr(w[0],!1)).path=="/"&&v.type!==ho)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(x&&x.WTF)throw w}})(tt(o,"META-INF/manifest.xml"),A);var d=zt(o,"content.xml");if(!d)throw new Error("Missing content.xml in ODS / UOF file");return A=$0(cs(d),A),Ln(o,"meta.xml")&&(A.Props=rl(tt(o,"meta.xml"))),A}function cm(o,A){return $0(o,A)}var Am=(function(){var o=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),A="<office:document-styles "+Yi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+o+"</office:document-styles>";return function(){return Ba+A}})(),dm=(function(){function o(d,h,x){var w=[];w.push('      <table:table table:name="'+Va(h.SheetNames[x])+`" table:style-name="ta1">
`);var v=0,N=0,S=vi(d["!ref"]||"A1"),E=d["!merges"]||[],I=0,P=Array.isArray(d);if(d["!cols"])for(N=0;N<=S.e.c;++N)w.push("        <table:table-column"+(d["!cols"][N]?' table:style-name="co'+d["!cols"][N].ods+'"':"")+`></table:table-column>
`);for(var K="",W=d["!rows"]||[],v=0;v<S.s.r;++v)K=W[v]?' table:style-name="ro'+W[v].ods+'"':"",w.push("        <table:table-row"+K+`></table:table-row>
`);for(;v<=S.e.r;++v){for(K=W[v]?' table:style-name="ro'+W[v].ods+'"':"",w.push("        <table:table-row"+K+`>
`),N=0;N<S.s.c;++N)w.push(A);for(;N<=S.e.c;++N){for(var me=!1,re={},De="",I=0;I!=E.length;++I)if(!(E[I].s.c>N||E[I].s.r>v||E[I].e.c<N||E[I].e.r<v)){E[I].s.c==N&&E[I].s.r==v||(me=!0),re["table:number-columns-spanned"]=E[I].e.c-E[I].s.c+1,re["table:number-rows-spanned"]=E[I].e.r-E[I].s.r+1;break}if(me)w.push(`          <table:covered-table-cell/>
`);else{var be=ha({r:v,c:N}),ce=P?(d[v]||[])[N]:d[be];if(ce&&ce.f&&(re["table:formula"]=Va(("of:="+ce.f.replace(_u,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")),ce.F&&ce.F.slice(0,be.length)==be&&(Ee=vi(ce.F),re["table:number-matrix-columns-spanned"]=Ee.e.c-Ee.s.c+1,re["table:number-matrix-rows-spanned"]=Ee.e.r-Ee.s.r+1)),ce){switch(ce.t){case"b":De=ce.v?"TRUE":"FALSE",re["office:value-type"]="boolean",re["office:boolean-value"]=ce.v?"true":"false";break;case"n":De=ce.w||String(ce.v||0),re["office:value-type"]="float",re["office:value"]=ce.v||0;break;case"s":case"str":De=ce.v==null?"":ce.v,re["office:value-type"]="string";break;case"d":De=ce.w||ba(ce.v).toISOString(),re["office:value-type"]="date",re["office:date-value"]=ba(ce.v).toISOString(),re["table:style-name"]="ce1";break;default:w.push(A);continue}var Ee,be=Va(De).replace(/  +/g,function(Ie){return'<text:s text:c="'+Ie.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>");ce.l&&ce.l.Target&&(be=lr("text:a",be,{"xlink:href":(Ee=(Ee=(Ee=ce.l.Target).charAt(0)=="#"?"#"+Ee.slice(1).replace(/\./,"!"):Ee).charAt(0)!="#"&&!Ee.match(/^\w+:/)?"../"+Ee:Ee).replace(/&/g,"&amp;")})),w.push("          "+lr("table:table-cell",lr("text:p",be,{}),re)+`
`)}else w.push(A)}}w.push(`        </table:table-row>
`)}return w.push(`      </table:table>
`),w.join("")}var A=`          <table:table-cell />
`;return function(d,h){var x=[Ba],w=Yi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),v=Yi({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});h.bookType=="fods"?(x.push("<office:document"+w+v+`>
`),x.push(bu().replace(/office:document-meta/g,"office:meta"))):x.push("<office:document-content"+w+`>
`),(function(S,E){S.push(` <office:automatic-styles>
`),S.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),S.push(`   <number:month number:style="long"/>
`),S.push(`   <number:text>/</number:text>
`),S.push(`   <number:day number:style="long"/>
`),S.push(`   <number:text>/</number:text>
`),S.push(`   <number:year/>
`),S.push(`  </number:date-style>
`);var I=0;E.SheetNames.map(function(K){return E.Sheets[K]}).forEach(function(K){if(K&&K["!cols"]){for(var W=0;W<K["!cols"].length;++W)if(K["!cols"][W]){var me=K["!cols"][W];if(me.width==null&&me.wpx==null&&me.wch==null)continue;Rd(me),me.ods=I,me=K["!cols"][W].wpx+"px",S.push('  <style:style style:name="co'+I+`" style:family="table-column">
`),S.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+me+`"/>
`),S.push(`  </style:style>
`),++I}}});var P=0;E.SheetNames.map(function(K){return E.Sheets[K]}).forEach(function(K){if(K&&K["!rows"])for(var W,me=0;me<K["!rows"].length;++me)K["!rows"][me]&&(K["!rows"][me].ods=P,W=K["!rows"][me].hpx+"px",S.push('  <style:style style:name="ro'+P+`" style:family="table-row">
`),S.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+W+`"/>
`),S.push(`  </style:style>
`),++P)}),S.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),S.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),S.push(`  </style:style>
`),S.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),S.push(` </office:automatic-styles>
`)})(x,d),x.push(`  <office:body>
`),x.push(`    <office:spreadsheet>
`);for(var N=0;N!=d.SheetNames.length;++N)x.push(o(d.Sheets[d.SheetNames[N]],d,N));return x.push(`    </office:spreadsheet>
`),x.push(`  </office:body>
`),h.bookType=="fods"?x.push("</office:document>"):x.push("</office:document-content>"),x.join("")}})();function cd(o,A){if(A.bookType=="fods")return dm(o,A);var d=Ar(),h=[],x=[];return Ct(d,"mimetype","application/vnd.oasis.opendocument.spreadsheet"),Ct(d,"content.xml",dm(o,A)),h.push(["content.xml","text/xml"]),x.push(["content.xml","ContentFile"]),Ct(d,"styles.xml",Am(o,A)),h.push(["styles.xml","text/xml"]),x.push(["styles.xml","StylesFile"]),Ct(d,"meta.xml",Ba+bu()),h.push(["meta.xml","text/xml"]),x.push(["meta.xml","MetadataFile"]),Ct(d,"manifest.rdf",(function(w){var v=[Ba];v.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var N=0;N!=w.length;++N)v.push(Di(w[N][0],w[N][1])),v.push([`  <rdf:Description rdf:about="">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+w[N][0]+`"/>
`,`  </rdf:Description>
`].join(""));return v.push(Di("","Document","pkg")),v.push("</rdf:RDF>"),v.join("")})(x)),h.push(["manifest.rdf","application/rdf+xml"]),Ct(d,"META-INF/manifest.xml",(function(w){var v=[Ba];v.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),v.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var N=0;N<w.length;++N)v.push('  <manifest:file-entry manifest:full-path="'+w[N][0]+'" manifest:media-type="'+w[N][1]+`"/>
`);return v.push("</manifest:manifest>"),v.join("")})(h)),d}function bo(o){return new DataView(o.buffer,o.byteOffset,o.byteLength)}function Qu(o){return typeof TextDecoder<"u"?new TextDecoder().decode(o):cs(z(o))}function fx(o){return typeof TextEncoder<"u"?new TextEncoder().encode(o):ae(aa(o))}function Ad(o){var A=o.reduce(function(x,w){return x+w.length},0),d=new Uint8Array(A),h=0;return o.forEach(function(x){d.set(x,h),h+=x.length}),d}function e1(o){return 16843009*((o=(858993459&(o-=o>>1&1431655765))+(o>>2&858993459))+(o>>4)&252645135)>>>24}function Pf(o,A){var d=A?A[0]:0,h=127&o[d];return 128<=o[d++]&&(h|=(127&o[d])<<7,o[d++]<128||(h|=(127&o[d])<<14,o[d++]<128||(h|=(127&o[d])<<21,o[d++]<128||(h+=(127&o[d])*Math.pow(2,28),++d,o[d++]<128||(h+=(127&o[d])*Math.pow(2,35),++d,o[d++]<128||(h+=(127&o[d])*Math.pow(2,42),++d,o[d++])))))),A&&(A[0]=d),h}function ws(o){var A=new Uint8Array(7);A[0]=127&o;var d=1;return 127<o&&(A[d-1]|=128,A[d]=o>>7&127,++d,o<=16383||(A[d-1]|=128,A[d]=o>>14&127,++d,o<=2097151||(A[d-1]|=128,A[d]=o>>21&127,++d,o<=268435455||(A[d-1]|=128,A[d]=o/256>>>21&127,++d,o<=34359738367||(A[d-1]|=128,A[d]=o/65536>>>21&127,++d,o<=4398046511103||(A[d-1]|=128,A[d]=o/16777216>>>21&127,++d)))))),A.slice(0,d)}function Xn(o){var A=0,d=127&o[0];return 128<=o[A++]&&(d|=(127&o[1])<<7,o[A++]<128||(d|=(127&o[2])<<14,o[A++]<128||(d|=(127&o[3])<<21,o[+A]<128||(d|=(127&o[4])<<28)))),d}function rs(o){for(var A=[],d=[0];d[0]<o.length;){var h,x=d[0],w=Pf(o,d),v=7&w,N=0;if((w=Math.floor(w/8))==0)break;switch(v){case 0:for(var S=d[0];128<=o[d[0]++];);h=o.slice(S,d[0]);break;case 5:N=4,h=o.slice(d[0],d[0]+N),d[0]+=N;break;case 1:N=8,h=o.slice(d[0],d[0]+N),d[0]+=N;break;case 2:N=Pf(o,d),h=o.slice(d[0],d[0]+N),d[0]+=N;break;case 3:case 4:default:throw new Error("PB Type ".concat(v," for Field ").concat(w," at offset ").concat(x))}var E={data:h,type:v};A[w]==null?A[w]=[E]:A[w].push(E)}return A}function Jn(o){var A=[];return o.forEach(function(d,h){h!=0&&d.forEach(function(x){x.data&&(A.push(ws(8*h+x.type)),x.type==2&&A.push(ws(x.data.length)),A.push(x.data))})}),Ad(A)}function um(o,A){return o?.map(function(d){return A(d.data)})||[]}function Ec(o){for(var A=[],d=[0];d[0]<o.length;){var h=Pf(o,d),x=rs(o.slice(d[0],d[0]+h));d[0]+=h;var w={id:Xn(x[1][0].data),messages:[]};x[2].forEach(function(S){var N=rs(S.data),S=Xn(N[3][0].data);w.messages.push({meta:N,data:o.slice(d[0],d[0]+S)}),d[0]+=S}),(h=x[3])!=null&&h[0]&&(w.merge=0<Xn(x[3][0].data)>>>0),A.push(w)}return A}function dd(o){var A=[];return o.forEach(function(d){var h=[[],[{data:ws(d.id),type:0}],[]];d.merge!=null&&(h[3]=[{data:ws(+!!d.merge),type:0}]);var x=[];d.messages.forEach(function(w){x.push(w.data),w.meta[3]=[{type:0,data:ws(w.data.length)}],h[2].push({data:Jn(w.meta),type:2})}),d=Jn(h),A.push(ws(d.length)),A.push(d),x.forEach(function(w){return A.push(w)})}),Ad(A)}function Dl(o){for(var A=[],d=0;d<o.length;){var h=o[d++],x=o[d]|o[d+1]<<8|o[d+2]<<16;d+=3,A.push((function(w,v){if(w!=0)throw new Error("Unexpected Snappy chunk type ".concat(w));for(var N=[0],S=Pf(v,N),E=[];N[0]<v.length;){var I=3&v[N[0]];if(I!=0){var P=0,K=0;if(I==1?(K=4+(v[N[0]]>>2&7),P=(224&v[N[0]++])<<3,P|=v[N[0]++]):(K=1+(v[N[0]++]>>2),I==2?(P=v[N[0]]|v[N[0]+1]<<8,N[0]+=2):(P=(v[N[0]]|v[N[0]+1]<<8|v[N[0]+2]<<16|v[N[0]+3]<<24)>>>0,N[0]+=4)),E=[Ad(E)],P==0)throw new Error("Invalid offset 0");if(P>E[0].length)throw new Error("Invalid offset beyond length");if(P<=K)for(E.push(E[0].slice(-P)),K-=P;K>=E[E.length-1].length;)E.push(E[E.length-1]),K-=E[E.length-1].length;E.push(E[0].slice(-P,-P+K))}else I=v[N[0]++]>>2,I<60?++I:(P=I-59,I=v[N[0]],1<P&&(I|=v[N[0]+1]<<8),2<P&&(I|=v[N[0]+2]<<16),3<P&&(I|=v[N[0]+3]<<24),I>>>=0,I++,N[0]+=P),E.push(v.slice(N[0],N[0]+I)),N[0]+=I}if((w=Ad(E)).length!=S)throw new Error("Unexpected length: ".concat(w.length," != ").concat(S));return w})(h,o.slice(d,d+x))),d+=x}if(d!==o.length)throw new Error("data is not a valid framed stream!");return Ad(A)}function Ru(o){for(var A=[],d=0;d<o.length;){var h=Math.min(o.length-d,268435455),x=new Uint8Array(4);A.push(x);var w=ws(h),v=w.length;A.push(w),h<=60?(v++,A.push(new Uint8Array([h-1<<2]))):h<=256?(v+=2,A.push(new Uint8Array([240,h-1&255]))):h<=65536?(v+=3,A.push(new Uint8Array([244,h-1&255,h-1>>8&255]))):h<=16777216?(v+=4,A.push(new Uint8Array([248,h-1&255,h-1>>8&255,h-1>>16&255]))):h<=4294967296&&(v+=5,A.push(new Uint8Array([252,h-1&255,h-1>>8&255,h-1>>16&255,h-1>>>24&255]))),A.push(o.slice(d,d+h)),v+=h,x[0]=0,x[1]=255&v,x[2]=v>>8&255,x[3]=v>>16&255,d+=h}return Ad(A)}function dy(o,A,d){var h,x=bo(o),w=x.getUint32(8,!0),v=12,N=-1,S=-1,E=NaN,I=NaN,P=new Date(2001,0,1);switch(1&w&&(E=(function(K,W){for(var me=(127&K[W+15])<<7|K[W+14]>>1,re=1&K[W+14],De=W+13;W<=De;--De)re=256*re+K[De];return(128&K[W+15]?-re:re)*Math.pow(10,me-6176)})(o,v),v+=16),2&w&&(I=x.getFloat64(v,!0),v+=8),4&w&&(P.setTime(P.getTime()+1e3*x.getFloat64(v,!0)),v+=8),8&w&&(S=x.getUint32(v,!0),v+=4),16&w&&(N=x.getUint32(v,!0),v+=4),o[1]){case 0:break;case 2:h={t:"n",v:E};break;case 3:h={t:"s",v:A[S]};break;case 5:h={t:"d",v:P};break;case 6:h={t:"b",v:0<I};break;case 7:h={t:"n",v:I/86400};break;case 8:h={t:"e",v:0};break;case 9:if(!(-1<N))throw new Error("Unsupported cell type ".concat(o[1]," : ").concat(31&w," : ").concat(o.slice(0,4)));h={t:"s",v:d[N]};break;case 10:h={t:"n",v:E};break;default:throw new Error("Unsupported cell type ".concat(o[1]," : ").concat(31&w," : ").concat(o.slice(0,4)))}return h}function Pu(o,A){var d=new Uint8Array(32),h=bo(d),x=12,w=0;switch(d[0]=5,o.t){case"n":d[1]=2,(function(v,N,S){var E=Math.floor(S==0?0:Math.LOG10E*Math.log(Math.abs(S)))+6176-16,I=S/Math.pow(10,E-6176);v[N+15]|=E>>7,v[N+14]|=(127&E)<<1;for(var P=0;1<=I;++P,I/=256)v[N+P]=255&I;v[N+15]|=0<=S?0:128})(d,x,o.v),w|=1,x+=16;break;case"b":d[1]=6,h.setFloat64(x,o.v?1:0,!0),w|=2,x+=8;break;case"s":if(A.indexOf(o.v)==-1)throw new Error("Value ".concat(o.v," missing from SST!"));d[1]=3,h.setUint32(x,A.indexOf(o.v),!0),w|=8,x+=4;break;default:throw"unsupported cell type "+o.t}return h.setUint32(8,w,!0),d.slice(0,x)}function t1(o,A){var d=new Uint8Array(32),h=bo(d),x=12,w=0;switch(d[0]=3,o.t){case"n":d[2]=2,h.setFloat64(x,o.v,!0),w|=32,x+=8;break;case"b":d[2]=6,h.setFloat64(x,o.v?1:0,!0),w|=32,x+=8;break;case"s":if(A.indexOf(o.v)==-1)throw new Error("Value ".concat(o.v," missing from SST!"));d[2]=3,h.setUint32(x,A.indexOf(o.v),!0),w|=16,x+=4;break;default:throw"unsupported cell type "+o.t}return h.setUint32(4,w,!0),d.slice(0,x)}function hx(o,A,d){switch(o[0]){case 0:case 1:case 2:case 3:return(function(h,x,w,v){var N,S=bo(h),E=S.getUint32(4,!0),I=(1<v?12:8)+4*e1(E&(1<v?3470:398)),P=-1,K=-1,W=NaN,me=new Date(2001,0,1);switch(512&E&&(P=S.getUint32(I,!0),I+=4),I+=4*e1(E&(1<v?12288:4096)),16&E&&(K=S.getUint32(I,!0),I+=4),32&E&&(W=S.getFloat64(I,!0),I+=8),64&E&&(me.setTime(me.getTime()+1e3*S.getFloat64(I,!0)),I+=8),h[2]){case 0:break;case 2:N={t:"n",v:W};break;case 3:N={t:"s",v:x[K]};break;case 5:N={t:"d",v:me};break;case 6:N={t:"b",v:0<W};break;case 7:N={t:"n",v:W/86400};break;case 8:N={t:"e",v:0};break;case 9:if(-1<P)N={t:"s",v:w[P]};else if(-1<K)N={t:"s",v:x[K]};else{if(isNaN(W))throw new Error("Unsupported cell type ".concat(h.slice(0,4)));N={t:"n",v:W}}break;default:throw new Error("Unsupported cell type ".concat(h.slice(0,4)))}return N})(o,A,d,o[0]);case 5:return dy(o,A,d);default:throw new Error("Unsupported payload version ".concat(o[0]))}}function ga(o){return Pf(rs(o)[1][0].data)}function fm(o,h){var h=rs(h.data),d=Xn(h[1][0].data),h=h[3],x=[];return(h||[]).forEach(function(w){var v=rs(w.data),N=Xn(v[1][0].data)>>>0;switch(d){case 1:x[N]=Qu(v[3][0].data);break;case 8:var E=rs(o[ga(v[9][0].data)][0].data),S=o[ga(E[1][0].data)][0],E=Xn(S.meta[1][0].data);if(E!=2001)throw new Error("2000 unexpected reference to ".concat(E));S=rs(S.data),x[N]=S[3].map(function(I){return Qu(I.data)}).join("")}}),x}function hm(o,x){var d=rs(x.data),h=(x=d?.[7])!=null&&x[0]?0<Xn(d[7][0].data)>>>0?1:0:-1,x=um(d[5],function(w){return(function(v,N){var S,E,I,P=rs(v),K=Xn(P[1][0].data)>>>0,W=Xn(P[2][0].data)>>>0,me=((v=(me=P[8])==null?void 0:me[0])==null?void 0:v.data)&&0<Xn(P[8][0].data)||!1;if((v=(v=P[7])==null?void 0:v[0])!=null&&v.data&&N!=0)E=(S=(S=P[7])==null?void 0:S[0])==null?void 0:S.data,I=(S=(S=P[6])==null?void 0:S[0])==null?void 0:S.data;else{if((S=(S=P[4])==null?void 0:S[0])==null||!S.data||N==1)throw"NUMBERS Tile missing ".concat(N," cell storage");E=(N=(N=P[4])==null?void 0:N[0])==null?void 0:N.data,I=(P=(P=P[3])==null?void 0:P[0])==null?void 0:P.data}for(var re=me?4:1,De=bo(E),be=[],ce=0;ce<E.length/2;++ce){var Ee=De.getUint16(2*ce,!0);Ee<65535&&be.push([ce,Ee])}if(be.length!=W)throw"Expected ".concat(W," cells, found ").concat(be.length);for(var Ue=[],ce=0;ce<be.length-1;++ce)Ue[be[ce][0]]=I.subarray(be[ce][1]*re,be[ce+1][1]*re);return 1<=be.length&&(Ue[be[be.length-1][0]]=I.subarray(be[be.length-1][1]*re)),{R:K,cells:Ue}})(w,h)});return{nrows:Xn(d[4][0].data)>>>0,data:x.reduce(function(w,v){return w[v.R]||(w[v.R]=[]),v.cells.forEach(function(N,S){if(w[v.R][S])throw new Error("Duplicate cell r=".concat(v.R," c=").concat(S));w[v.R][S]=N}),w},[])}}function r1(o,x){var d={"!ref":"A1"},h=o[ga(rs(x.data)[2][0].data)],x=Xn(h[0].meta[1][0].data);if(x!=6001)throw new Error("6000 unexpected reference to ".concat(x));return(function(w,S,N){var P=rs(S.data);if((S={s:{r:0,c:0},e:{r:0,c:0}}).e.r=(Xn(P[6][0].data)>>>0)-1,S.e.r<0)throw new Error("Invalid row varint ".concat(P[6][0].data));if(S.e.c=(Xn(P[7][0].data)>>>0)-1,S.e.c<0)throw new Error("Invalid col varint ".concat(P[7][0].data));N["!ref"]=fa(S);var S=rs(P[4][0].data),E=fm(w,w[ga(S[4][0].data)][0]),I=(P=S[17])!=null&&P[0]?fm(w,w[ga(S[17][0].data)][0]):[],P=rs(S[3][0].data),K=0;if(P[1].forEach(function(me){var re=rs(me.data),me=w[ga(re[2][0].data)][0],re=Xn(me.meta[1][0].data);if(re!=6002)throw new Error("6001 unexpected reference to ".concat(re));me=hm(0,me),me.data.forEach(function(De,be){De.forEach(function(ce,Ee){Ee=ha({r:K+be,c:Ee}),ce=hx(ce,E,I),ce&&(N[Ee]=ce)})}),K+=me.nrows}),(P=S[13])!=null&&P[0]){if(P=w[ga(S[13][0].data)][0],S=Xn(P.meta[1][0].data),S!=6144)throw new Error("Expected merge type 6144, found ".concat(S));N["!merges"]=(P=rs(P.data))==null?void 0:P[1].map(function(me){var re=rs(me.data),me=bo(rs(re[1][0].data)[1][0].data),re=bo(rs(re[2][0].data)[1][0].data);return{s:{r:me.getUint16(0,!0),c:me.getUint16(2,!0)},e:{r:me.getUint16(0,!0)+re.getUint16(0,!0)-1,c:me.getUint16(2,!0)+re.getUint16(2,!0)-1}}})}})(o,h[0],d),d}function mx(o,A){var d=u1(),h=rs(A.data);if((A=h[2])!=null&&A[0])throw new Error("Keynote presentations are not supported");if(um(h[1],ga).forEach(function(x){o[x].forEach(function(w){var v,N,S,E;Xn(w.meta[1][0].data)==2&&(N=o,w=rs((S=w).data),E={name:(S=w[1])!=null&&S[0]?Qu(w[1][0].data):"",sheets:[]},um(w[2],ga).forEach(function(I){N[I].forEach(function(P){Xn(P.meta[1][0].data)==6e3&&E.sheets.push(r1(N,P))})}),(v=E).sheets.forEach(function(I,P){Cm(d,I,P==0?v.name:v.name+"_"+P,!0)}))})}),d.SheetNames.length==0)throw new Error("Empty NUMBERS file");return d}function mm(o){var A={},d=[];if(o.FullPaths.forEach(function(x){if(x.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),o.FileIndex.forEach(function(x){if(x.name.match(/\.iwa$/)){var w,v;try{w=Dl(x.content)}catch(N){return console.log("?? "+x.content.length+" "+(N.message||N))}try{v=Ec(w)}catch(N){return console.log("## "+(N.message||N))}v.forEach(function(N){A[N.id]=N.messages,d.push(N.id)})}}),!d.length)throw new Error("File has no messages");if((o=(o=(o=(o=A?.[1])==null?void 0:o[0])==null?void 0:o.meta)==null?void 0:o[1])!=null&&o[0].data&&Xn(A[1][0].meta[1][0].data)==1e4)throw new Error("Pages documents are not supported");var h=((o=(o=(o=(o=A?.[1])==null?void 0:o[0])==null?void 0:o.meta)==null?void 0:o[1])==null?void 0:o[0].data)&&Xn(A[1][0].meta[1][0].data)==1&&A[1][0];if(h||d.forEach(function(x){A[x].forEach(function(w){if(Xn(w.meta[1][0].data)>>>0==1){if(h)throw new Error("Document has multiple roots");h=w}})}),!h)throw new Error("Cannot find Document root");return mx(A,h)}function q0(o,A){if(!A||!A.numbers)throw new Error("Must pass a `numbers` option -- check the README");var d=o.Sheets[o.SheetNames[0]];1<o.SheetNames.length&&console.error("The Numbers writer currently writes only the first table");var h=vi(d["!ref"]);h.s.r=h.s.c=0;var x=!1;9<h.e.c&&(x=!0,h.e.c=9),49<h.e.r&&(x=!0,h.e.r=49),x&&console.error("The Numbers writer is currently limited to ".concat(fa(h)));var w=ym(d,{range:h,header:1}),v=["~Sh33tJ5~"];w.forEach(function(cr){return cr.forEach(function(ur){typeof ur=="string"&&v.push(ur)})});var N={},S=[],E=$t.read(A.numbers,{type:"base64"});E.FileIndex.map(function(cr,ur){return[cr,E.FullPaths[ur]]}).forEach(function(cr){var ur=cr[0],nr=cr[1];ur.type==2&&ur.name.match(/\.iwa/)&&Ec(Dl(ur.content)).forEach(function(Vt){S.push(Vt.id),N[Vt.id]={deps:[],location:nr,type:Xn(Vt.messages[0].meta[1][0].data)}})}),S.sort(function(cr,ur){return cr-ur});var I=S.filter(function(cr){return 1<cr}).map(function(cr){return[cr,ws(cr)]});E.FileIndex.map(function(cr,ur){return[cr,E.FullPaths[ur]]}).forEach(function(cr){var ur=cr[0];cr[1],ur.name.match(/\.iwa/)&&Ec(Dl(ur.content)).forEach(function(nr){nr.messages.forEach(function(Vt){I.forEach(function(kr){nr.messages.some(function(Rr){return Xn(Rr.meta[1][0].data)!=11006&&(function(na,Ga){e:for(var Sr=0;Sr<=na.length-Ga.length;++Sr){for(var er=0;er<Ga.length;++er)if(na[Sr+er]!=Ga[er])continue e;return!0}return!1})(Rr.data,kr[1])})&&N[kr[0]].deps.push(nr.id)})})})});for(var P,K=$t.find(E,N[1].location),W=Ec(Dl(K.content)),me=0;me<W.length;++me){var re=W[me];re.id==1&&(P=re)}for(var De=ga(rs(P.messages[0].data)[1][0].data),W=Ec(Dl((K=$t.find(E,N[De].location)).content)),me=0;me<W.length;++me)(re=W[me]).id==De&&(P=re);var Mt=rs(P.messages[0].data);for(Mt[1]=[{type:2,data:fx(o.SheetNames[0])}],P.messages[0].data=Jn(Mt),K.content=Ru(dd(W)),K.size=K.content.length,De=ga(Mt[2][0].data),W=Ec(Dl((K=$t.find(E,N[De].location)).content)),me=0;me<W.length;++me)(re=W[me]).id==De&&(P=re);for(De=ga(rs(P.messages[0].data)[2][0].data),W=Ec(Dl((K=$t.find(E,N[De].location)).content)),me=0;me<W.length;++me)(re=W[me]).id==De&&(P=re);x=rs(P.messages[0].data),x[6][0].data=ws(h.e.r+1),x[7][0].data=ws(h.e.c+1);for(var be=ga(x[46][0].data),A=$t.find(E,N[be].location),ce=Ec(Dl(A.content)),Ee=0;Ee<ce.length&&ce[Ee].id!=be;++Ee);if(ce[Ee].id!=be)throw"Bad ColumnRowUIDMapArchive";var Ue=rs(ce[Ee].messages[0].data);Ue[1]=[],Ue[2]=[],Ue[3]=[];for(var Ie=0;Ie<=h.e.c;++Ie)Ue[1].push({type:2,data:Jn([[],[{type:0,data:ws(Ie+420690)}],[{type:0,data:ws(Ie+420690)}]])}),Ue[2].push({type:0,data:ws(Ie)}),Ue[3].push({type:0,data:ws(Ie)});Ue[4]=[],Ue[5]=[],Ue[6]=[];for(var $e=0;$e<=h.e.r;++$e)Ue[4].push({type:2,data:Jn([[],[{type:0,data:ws($e+726270)}],[{type:0,data:ws($e+726270)}]])}),Ue[5].push({type:0,data:ws($e)}),Ue[6].push({type:0,data:ws($e)});if(ce[Ee].messages[0].data=Jn(Ue),A.content=Ru(dd(ce)),A.size=A.content.length,delete x[46],o=rs(x[4][0].data),o[7][0].data=ws(h.e.r+1),Mt=ga(rs(o[1][0].data)[2][0].data),(ce=Ec(Dl((A=$t.find(E,N[Mt].location)).content)))[0].id!=Mt)throw"Bad HeaderStorageBucket";for(var st=rs(ce[0].messages[0].data),$e=0;$e<w.length;++$e){var rt=rs(st[2][0].data);rt[1][0].data=ws($e),rt[4][0].data=ws(w[$e].length),st[2][$e]={type:st[2][0].type,data:Jn(rt)}}ce[0].messages[0].data=Jn(st),A.content=Ru(dd(ce)),A.size=A.content.length;var mt,Mt=ga(o[2][0].data);if((ce=Ec(Dl((A=$t.find(E,N[Mt].location)).content)))[0].id!=Mt)throw"Bad HeaderStorageBucket";for(st=rs(ce[0].messages[0].data),Ie=0;Ie<=h.e.c;++Ie)(rt=rs(st[2][0].data))[1][0].data=ws(Ie),rt[4][0].data=ws(h.e.r+1),st[2][Ie]={type:st[2][0].type,data:Jn(rt)};ce[0].messages[0].data=Jn(st),A.content=Ru(dd(ce)),A.size=A.content.length,d["!merges"]&&(Br=(function(cr){for(var ur=927262;ur<2e6;++ur)if(!N[ur])return N[ur]=cr,ur;throw new Error("Too many messages")})({type:6144,deps:[De],location:N[De].location}),mt=[[],[]],d["!merges"].forEach(function(cr){mt[1].push({type:2,data:Jn([[],[{type:2,data:Jn([[],[{type:5,data:new Uint8Array(new Uint16Array([cr.s.r,cr.s.c]).buffer)}]])}],[{type:2,data:Jn([[],[{type:5,data:new Uint8Array(new Uint16Array([cr.e.r-cr.s.r+1,cr.e.c-cr.s.c+1]).buffer)}]])}]])})}),o[13]=[{type:2,data:Jn([[],[{type:0,data:ws(Br)}]])}],W.push({id:Br,messages:[(Zt=6144,Br=Jn(mt),{meta:[[],[{type:0,data:ws(Zt)}]],data:Br})]}));var Qt=ga(o[4][0].data);(function(){for(var cr,ur=$t.find(E,N[Qt].location),nr=Ec(Dl(ur.content)),Vt=0;Vt<nr.length;++Vt){var kr=nr[Vt];kr.id==Qt&&(cr=kr)}var Rr=rs(cr.messages[0].data);Rr[3]=[],v.forEach(function(na,Ga){Rr[3].push({type:2,data:Jn([[],[{type:0,data:ws(Ga)}],[{type:0,data:ws(1)}],[{type:2,data:fx(na)}]])})}),cr.messages[0].data=Jn(Rr),ur.content=Ru(dd(nr)),ur.size=ur.content.length})();var vt=rs(o[3][0].data),Zt=vt[1][0];delete vt[2];var Zt,Br,Br=rs(Zt.data),wr=ga(Br[2][0].data);return(function(){for(var cr,ur=$t.find(E,N[wr].location),nr=Ec(Dl(ur.content)),Vt=0;Vt<nr.length;++Vt){var kr=nr[Vt];kr.id==wr&&(cr=kr)}var Rr=rs(cr.messages[0].data);delete Rr[6],delete vt[7];var na=new Uint8Array(Rr[5][0].data);Rr[5]=[];for(var Ga=0,Sr=0;Sr<=h.e.r;++Sr){var er=rs(na);Ga+=(function(Na,is,Ja){var Ls,Zn;if((Ls=Na[6])==null||!Ls[0]||(Zn=Na[7])==null||!Zn[0])throw"Mutation only works on post-BNC storages!";if((Zn=(Zn=Na[8])==null?void 0:Zn[0])!=null&&Zn.data&&0<Xn(Na[8][0].data))throw"Math only works with normal offsets";for(var Je,Us,bs=0,eo=bo(Na[7][0].data),kc=0,Pe=[],wt=bo(Na[4][0].data),qe=0,yt=[],We=0;We<is.length;++We)if(is[We]!=null){switch(eo.setUint16(2*We,kc,!0),wt.setUint16(2*We,qe,!0),typeof is[We]){case"string":Je=Pu({t:"s",v:is[We]},Ja),Us=t1({t:"s",v:is[We]},Ja);break;case"number":Je=Pu({t:"n",v:is[We]},Ja),Us=t1({t:"n",v:is[We]},Ja);break;case"boolean":Je=Pu({t:"b",v:is[We]},Ja),Us=t1({t:"b",v:is[We]},Ja);break;default:throw new Error("Unsupported value "+is[We])}Pe.push(Je),kc+=Je.length,yt.push(Us),qe+=Us.length,++bs}else eo.setUint16(2*We,65535,!0),wt.setUint16(2*We,65535);for(Na[2][0].data=ws(bs);We<Na[7][0].data.length/2;++We)eo.setUint16(2*We,65535,!0),wt.setUint16(2*We,65535,!0);return Na[6][0].data=Ad(Pe),Na[3][0].data=Ad(yt),bs})(er,w[Sr],v),er[1][0].data=ws(Sr),Rr[5].push({data:Jn(er),type:2})}Rr[1]=[{type:0,data:ws(h.e.c+1)}],Rr[2]=[{type:0,data:ws(h.e.r+1)}],Rr[3]=[{type:0,data:ws(Ga)}],Rr[4]=[{type:0,data:ws(h.e.r+1)}],cr.messages[0].data=Jn(Rr),ur.content=Ru(dd(nr)),ur.size=ur.content.length})(),Zt.data=Jn(Br),o[3][0].data=Jn(vt),x[4][0].data=Jn(o),P.messages[0].data=Jn(x),K.content=Ru(dd(W)),K.size=K.content.length,E}function X0(o){return function(A){for(var d=0;d!=o.length;++d){var h=o[d];A[h[0]]===void 0&&(A[h[0]]=h[1]),h[2]==="n"&&(A[h[0]]=Number(A[h[0]]))}}}function a1(o){X0([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(o)}function pm(o){X0([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(o)}function uy(o,A){if(!o)return 0;try{o=A.map(function(d){return d.id||(d.id=d.strRelID),[d.name,o["!id"][d.id].Target,(d=o["!id"][d.id].Type,-1<Ta.WS.indexOf(d)?"sheet":Ta.CS&&d==Ta.CS?"chart":Ta.DS&&d==Ta.DS?"dialog":Ta.MS&&d==Ta.MS?"macro":d&&d.length?d:"sheet")]})}catch{return null}return o&&o.length!==0?o:null}function fy(o,A,d,h,x,w,v,N,S,E,I,P){try{w[h]=bA(zt(o,d,!0),A);var K=tt(o,A);switch(N){case"sheet":re=em(K,A,x,S,w[h],E,I,P);break;case"chart":if(!(re=Xg(K,A,x,S,w[h],E))||!re["!drawel"])break;var me=Ra(re["!drawel"].Target,A),W=Vc(me),ce=Ra((ce=zt(o,me,!0),W=bA(zt(o,W,!0),me),ce?(ce=(ce.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1],W["!id"][ce].Target):"??"),me),me=Vc(ce),re=yn(zt(o,ce,!0),0,0,bA(zt(o,me,!0),ce),0,re);break;case"macro":be=A,w[h],be.slice(-4),re={"!type":"macro"};break;case"dialog":be=A,w[h],be.slice(-4),re={"!type":"dialog"};break;default:throw new Error("Unrecognized sheet type "+N)}v[h]=re;var De=[];w&&w[h]&&hs(w[h]).forEach(function(Ee){var Ue,Ie,$e,st,rt,mt,Mt="";if(w[h][Ee].Type==Ta.CMNT){Mt=Ra(w[h][Ee].Target,A);var Qt=Vd(tt(o,Mt,!0),Mt,S);if(!Qt||!Qt.length)return;Dp(re,Qt,!1)}w[h][Ee].Type==Ta.TCMNT&&(Mt=Ra(w[h][Ee].Target,A),De=De.concat((Ue=tt(o,Mt,!0),Ie=S,st=!($e=[]),rt={},mt=0,Ue.replace(ns,function(vt,Zt){var Br=Cr(vt);switch(rn(Br[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":break;case"<threadedComment":rt={author:Br.personId,guid:Br.id,ref:Br.ref,T:1};break;case"</threadedComment>":rt.t!=null&&$e.push(rt);break;case"<text>":case"<text":mt=Zt+vt.length;break;case"</text>":rt.t=Ue.slice(mt,Zt).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":st=!0;break;case"</mentions>":st=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":st=!0;break;case"</ext>":st=!1;break;default:if(!st&&Ie.WTF)throw new Error("unrecognized "+Br[0]+" in threaded comments")}return vt}),$e)))}),De&&De.length&&Dp(re,De,!0,S.people||[])}catch(Ee){if(S.WTF)throw Ee}var be,ce}function ec(o){return o.charAt(0)=="/"?o.slice(1):o}function s1(o,A){if(wa(),a1(A=A||{}),Ln(o,"META-INF/manifest.xml")||Ln(o,"objectdata.xml"))return Ou(o,A);if(Ln(o,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(o.FileIndex)return mm(o);var d=$t.utils.cfb_new();return qt(o).forEach(function(nr){Ct(d,nr,(function(kr,Rr,na){return zl(hn(kr,Rr))})(o,nr))}),mm(d)}if(!Ln(o,"[Content_Types].xml"))throw Ln(o,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ln(o,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var h,x,w=qt(o),v=(function(nr){var Vt=Gc();if(!nr||!nr.match)return Vt;var kr={};if((nr.match(ns)||[]).forEach(function(Rr){var na=Cr(Rr);switch(na[0].replace(Pa,"<")){case"<?xml":break;case"<Types":Vt.xmlns=na["xmlns"+(na[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":kr[na.Extension]=na.ContentType;break;case"<Override":Vt[VA[na.ContentType]]!==void 0&&Vt[VA[na.ContentType]].push(na.PartName)}}),Vt.xmlns!==Bn.CT)throw new Error("Unknown Namespace: "+Vt.xmlns);return Vt.calcchain=0<Vt.calcchains.length?Vt.calcchains[0]:"",Vt.sst=0<Vt.strs.length?Vt.strs[0]:"",Vt.style=0<Vt.styles.length?Vt.styles[0]:"",Vt.defaults=kr,delete Vt.calcchains,Vt})(zt(o,"[Content_Types].xml")),rt=!1;if(v.workbooks.length===0&&tt(o,x="xl/workbook.xml",!0)&&v.workbooks.push(x),v.workbooks.length===0){if(!tt(o,x="xl/workbook.bin",!0))throw new Error("Could not find workbook");v.workbooks.push(x),rt=!0}v.workbooks[0].slice(-3)=="bin"&&(rt=!0);var N={},S={};if(!A.bookSheets&&!A.bookProps){if(Df=[],v.sst)try{Df=rm(tt(o,ec(v.sst)),v.sst,A)}catch(nr){if(A.WTF)throw nr}A.cellStyles&&v.themes.length&&(me=zt(o,v.themes[0].replace(/^\//,""),!0)||"",v.themes[0],N=Pd(me,A)),v.style&&(S=tm(tt(o,ec(v.style)),v.style,N,A))}v.links.map(function(nr){try{return bA(zt(o,Vc(ec(nr))),nr),Yd(tt(o,ec(nr)),0,nr,A)}catch{}});var E,I,P,K=Yp(tt(o,ec(v.workbooks[0])),v.workbooks[0],A),W={},me="";v.coreprops.length&&((me=tt(o,ec(v.coreprops[0]),!0))&&(W=rl(me)),v.extprops.length!==0&&(me=tt(o,ec(v.extprops[0]),!0))&&(re=A,P={},I=(I=W)||{},E=cs(E=me),Io.forEach(function(nr){var Vt=(E.match(vl(nr[0]))||[])[1];switch(nr[2]){case"string":Vt&&(I[nr[1]]=ma(Vt));break;case"bool":I[nr[1]]=Vt==="true";break;case"raw":var kr=E.match(new RegExp("<"+nr[0]+"[^>]*>([\\s\\S]*?)</"+nr[0]+">"));kr&&0<kr.length&&(P[nr[1]]=kr[1])}}),P.HeadingPairs&&P.TitlesOfParts&&yu(P.HeadingPairs,P.TitlesOfParts,I,re)));var re={};A.bookSheets&&!A.bookProps||v.custprops.length!==0&&(me=zt(o,ec(v.custprops[0]),!0))&&(re=(function(nr,Vt){var kr={},Rr="",na=nr.match(mf);if(na)for(var Ga=0;Ga!=na.length;++Ga){var Sr=na[Ga],er=Cr(Sr);switch(er[0]){case"<?xml":case"<Properties":break;case"<property":Rr=ma(er.name);break;case"</property>":Rr=null;break;default:if(Sr.indexOf("<vt:")===0){var Na=Sr.split(">"),is=Na[0].slice(4),Ja=Na[1];switch(is){case"lpstr":case"bstr":case"lpwstr":kr[Rr]=ma(Ja);break;case"bool":kr[Rr]=Ps(Ja);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":kr[Rr]=parseInt(Ja,10);break;case"r4":case"r8":case"decimal":kr[Rr]=parseFloat(Ja);break;case"filetime":case"date":kr[Rr]=ba(Ja);break;case"cy":case"error":kr[Rr]=ma(Ja);break;default:if(is.slice(-1)=="/")break;Vt.WTF&&typeof console<"u"&&console.warn("Unexpected",Sr,is,Na)}}else if(Sr.slice(0,2)!=="</"&&Vt.WTF)throw new Error(Sr)}}return kr})(me,A));var De={};if((A.bookSheets||A.bookProps)&&(K.Sheets?h=K.Sheets.map(function(nr){return nr.name}):W.Worksheets&&0<W.SheetNames.length&&(h=W.SheetNames),A.bookProps&&(De.Props=W,De.Custprops=re),A.bookSheets&&h!==void 0&&(De.SheetNames=h),A.bookSheets?De.SheetNames:A.bookProps))return De;h={},me={},A.bookDeps&&v.calcchain&&(me=Zi(tt(o,ec(v.calcchain)),v.calcchain));var be,ce,Ee=0,Ue={},Ie=K.Sheets;W.Worksheets=Ie.length,W.SheetNames=[];for(var $e=0;$e!=Ie.length;++$e)W.SheetNames[$e]=Ie[$e].name;var st=rt?"bin":"xml",rt=v.workbooks[0].lastIndexOf("/"),mt=(v.workbooks[0].slice(0,rt+1)+"_rels/"+v.workbooks[0].slice(rt+1)+".rels").replace(/^\//,"");Ln(o,mt)||(mt="xl/_rels/workbook."+st+".rels");var Mt,Qt,vt,Zt=bA(zt(o,mt,!0),mt.replace(/_rels.*/,"s5s"));1<=(v.metadata||[]).length&&(A.xlmeta=Of(tt(o,ec(v.metadata[0])),v.metadata[0],A)),1<=(v.people||[]).length&&(A.people=(rt=tt(o,ec(v.people[0])),Mt=A,vt=!(Qt=[]),rt.replace(ns,function(nr){var Vt=Cr(nr);switch(rn(Vt[0])){case"<?xml":case"<personList":case"</personList>":break;case"<person":Qt.push({name:Vt.displayname,id:Vt.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":vt=!0;break;case"</ext>":vt=!1;break;default:if(!vt&&Mt.WTF)throw new Error("unrecognized "+Vt[0]+" in threaded comments")}return nr}),Qt)),Zt=Zt&&uy(Zt,K.Sheets);var Br=tt(o,"xl/worksheets/sheet.xml",!0)?1:0;e:for(Ee=0;Ee!=W.Worksheets;++Ee){var wr="sheet";if(Zt&&Zt[Ee]?(be="xl/"+Zt[Ee][1].replace(/[\/]?xl\//,""),Ln(o,be)||(be=Zt[Ee][1]),Ln(o,be)||(be=mt.replace(/_rels\/.*$/,"")+Zt[Ee][1]),wr=Zt[Ee][2]):be=(be="xl/worksheets/sheet"+(Ee+1-Br)+"."+st).replace(/sheet0\./,"sheet."),ce=be.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),A&&A.sheets!=null)switch(typeof A.sheets){case"number":if(Ee!=A.sheets)continue e;break;case"string":if(W.SheetNames[Ee].toLowerCase()!=A.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(A.sheets)){for(var cr=!1,ur=0;ur!=A.sheets.length;++ur)typeof A.sheets[ur]=="number"&&A.sheets[ur]==Ee&&(cr=1),typeof A.sheets[ur]=="string"&&A.sheets[ur].toLowerCase()==W.SheetNames[Ee].toLowerCase()&&(cr=1);if(!cr)continue e}}fy(o,be,ce,W.SheetNames[Ee],Ee,Ue,h,wr,A,K,N,S)}return De={Directory:v,Workbook:K,Props:W,Custprops:re,Deps:me,Sheets:h,SheetNames:W.SheetNames,Strings:Df,Styles:S,Themes:N,SSF:Oa(X)},A&&A.bookFiles&&(o.files?(De.keys=w,De.files=o.files):(De.keys=[],De.files={},o.FullPaths.forEach(function(nr,Vt){nr=nr.replace(/^Root Entry[\/]/,""),De.keys.push(nr),De.files[nr]=o.FileIndex[Vt]}))),A&&A.bookVBA&&(0<v.vba.length?De.vbaraw=tt(o,ec(v.vba[0]),!0):v.defaults&&v.defaults.bin===Ii&&(De.vbaraw=tt(o,"xl/vbaProject.bin",!0))),De}function An(o,A){var d,h=A||{},x="Workbook",w=$t.find(o,x);try{if(x="/!DataSpaces/Version",!(w=$t.find(o,x))||!w.content)throw new Error("ECMA-376 Encrypted file missing "+x);if(v=w.content,(d={}).id=v.read_shift(0,"lpp4"),d.R=Ro(v,4),d.U=Ro(v,4),d.W=Ro(v,4),x="/!DataSpaces/DataSpaceMap",!(w=$t.find(o,x))||!w.content)throw new Error("ECMA-376 Encrypted file missing "+x);var v=bf(w.content);if(v.length!==1||v[0].comps.length!==1||v[0].comps[0].t!==0||v[0].name!=="StrongEncryptionDataSpace"||v[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+x);if(x="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(w=$t.find(o,x))||!w.content)throw new Error("ECMA-376 Encrypted file missing "+x);if(v=(function(N){var S=[];N.l+=4;for(var E=N.read_shift(4);0<E--;)S.push(N.read_shift(0,"lpp4"));return S})(w.content),v.length!=1||v[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+x);if(x="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(w=$t.find(o,x))||!w.content)throw new Error("ECMA-376 Encrypted file missing "+x);yf(w.content)}catch{}if(x="/EncryptionInfo",!(w=$t.find(o,x))||!w.content)throw new Error("ECMA-376 Encrypted file missing "+x);if(A=C0(w.content),x="/EncryptedPackage",!(w=$t.find(o,x))||!w.content)throw new Error("ECMA-376 Encrypted file missing "+x);if(A[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(A[1],w.content,h.password||"",h);if(A[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(A[1],w.content,h.password||"",h);throw new Error("File is password-protected")}function n1(o,A){return(A.bookType=="ods"?cd:A.bookType=="numbers"?q0:A.bookType=="xlsb"?function(d,h){Hd=1024,d&&!d.SSF&&(d.SSF=Oa(X)),d&&d.SSF&&(wa(),Pr(d.SSF),h.revssf=ko(d.SSF),h.revssf[d.SSF[65535]]=0,h.ssf=d.SSF),h.rels={},h.wbrels={},h.Strings=[],h.Strings.Count=0,h.Strings.Unique=0,Tf?h.revStrings=new Map:(h.revStrings={},h.revStrings.foo=[],delete h.revStrings.foo);var x=h.bookType=="xlsb"?"bin":"xml",w=-1<go.indexOf(h.bookType),v=Gc();pm(h=h||{});var N=Ar(),S="",E=0;if(h.cellXfs=[],ad(h.cellXfs,{},{revssf:{General:0}}),d.Props||(d.Props={}),Ct(N,S="docProps/core.xml",WA(d.Props,h)),v.coreprops.push(S),ps(h.rels,2,S,Ta.CORE_PROPS),S="docProps/app.xml",!d.Props||!d.Props.SheetNames)if(d.Workbook&&d.Workbook.Sheets){for(var I=[],P=0;P<d.SheetNames.length;++P)(d.Workbook.Sheets[P]||{}).Hidden!=2&&I.push(d.SheetNames[P]);d.Props.SheetNames=I}else d.Props.SheetNames=d.SheetNames;for(d.Props.Worksheets=d.Props.SheetNames.length,Ct(N,S,$A(d.Props)),v.extprops.push(S),ps(h.rels,3,S,Ta.EXT_PROPS),d.Custprops!==d.Props&&0<hs(d.Custprops||{}).length&&(Ct(N,S="docProps/custom.xml",al(d.Custprops)),v.custprops.push(S),ps(h.rels,4,S,Ta.CUST_PROPS)),E=1;E<=d.SheetNames.length;++E){var K,W,me,re={"!id":{}},De=d.Sheets[d.SheetNames[E-1]];Ct(N,S="xl/worksheets/sheet"+E+"."+x,(function(be,ce,Ee,Ue,Ie){return(ce.slice(-4)===".bin"?Qs:qh)(be,Ee,Ue,Ie)})(E-1,S,h,d,re)),v.sheets.push(S),ps(h.wbrels,-1,"worksheets/sheet"+E+"."+x,Ta.WS[0]),De&&(K=De["!comments"],W=!1,me="",K&&0<K.length&&(Ct(N,me="xl/comments"+E+"."+x,(function(be,ce,Ee){return(ce.slice(-4)===".bin"?Tp:Mg)(be)})(K,me)),v.comments.push(me),ps(re,-1,"../comments"+E+"."+x,Ta.CMNT),W=!0),De["!legacy"]&&W&&Ct(N,"xl/drawings/vmlDrawing"+E+".vml",kp(E,De["!comments"])),delete De["!comments"],delete De["!legacy"]),re["!id"].rId1&&Ct(N,Vc(S),Mo(re))}return h.Strings!=null&&0<h.Strings.length&&(Ct(N,S="xl/sharedStrings."+x,(function(be,ce,Ee){return(ce.slice(-4)===".bin"?wc:ZA)(be,Ee)})(h.Strings,S,h)),v.strs.push(S),ps(h.wbrels,-1,"sharedStrings."+x,Ta.SST)),Ct(N,S="xl/workbook."+x,(function(be,ce,Ee){return(ce.slice(-4)===".bin"?kl:Zh)(be)})(d,S)),v.workbooks.push(S),ps(h.rels,1,S,Ta.WB),Ct(N,S="xl/theme/theme1.xml",Qh(d.Themes,h)),v.themes.push(S),ps(h.wbrels,-1,"theme/theme1.xml",Ta.THEME),Ct(N,S="xl/styles."+x,(function(be,ce,Ee){return(ce.slice(-4)===".bin"?Eg:Cp)(be,Ee)})(d,S,h)),v.styles.push(S),ps(h.wbrels,-1,"styles."+x,Ta.STY),d.vbaraw&&w&&(Ct(N,S="xl/vbaProject.bin",d.vbaraw),v.vba.push(S),ps(h.wbrels,-1,"vbaProject.bin",Ta.VBA)),Ct(N,S="xl/metadata."+x,(function(be){return(be.slice(-4)===".bin"?Rh:Ep)()})(S)),v.metadata.push(S),ps(h.wbrels,-1,"metadata."+x,Ta.XLMETA),Ct(N,"[Content_Types].xml",xu(v,h)),Ct(N,"_rels/.rels",Mo(h.rels)),Ct(N,"xl/_rels/workbook."+x+".rels",Mo(h.wbrels)),delete h.revssf,delete h.ssf,N}:yo)(o,A)}function yo(o,A){Hd=1024,o&&!o.SSF&&(o.SSF=Oa(X)),o&&o.SSF&&(wa(),Pr(o.SSF),A.revssf=ko(o.SSF),A.revssf[o.SSF[65535]]=0,A.ssf=o.SSF),A.rels={},A.wbrels={},A.Strings=[],A.Strings.Count=0,A.Strings.Unique=0,Tf?A.revStrings=new Map:(A.revStrings={},A.revStrings.foo=[],delete A.revStrings.foo);var d="xml",h=-1<go.indexOf(A.bookType),x=Gc();pm(A=A||{});var w=Ar(),v="",N=0;if(A.cellXfs=[],ad(A.cellXfs,{},{revssf:{General:0}}),o.Props||(o.Props={}),v="docProps/core.xml",Ct(w,v,WA(o.Props,A)),x.coreprops.push(v),ps(A.rels,2,v,Ta.CORE_PROPS),v="docProps/app.xml",!o.Props||!o.Props.SheetNames)if(o.Workbook&&o.Workbook.Sheets){for(var S=[],E=0;E<o.SheetNames.length;++E)(o.Workbook.Sheets[E]||{}).Hidden!=2&&S.push(o.SheetNames[E]);o.Props.SheetNames=S}else o.Props.SheetNames=o.SheetNames;o.Props.Worksheets=o.Props.SheetNames.length,Ct(w,v,$A(o.Props)),x.extprops.push(v),ps(A.rels,3,v,Ta.EXT_PROPS),o.Custprops!==o.Props&&0<hs(o.Custprops||{}).length&&(Ct(w,v="docProps/custom.xml",al(o.Custprops)),x.custprops.push(v),ps(A.rels,4,v,Ta.CUST_PROPS));var I,P=["SheetJ5"];for(A.tcid=0,N=1;N<=o.SheetNames.length;++N){var K,W,me,re,De={"!id":{}},be=o.Sheets[o.SheetNames[N-1]];Ct(w,v="xl/worksheets/sheet"+N+"."+d,qh(N-1,A,o,De)),x.sheets.push(v),ps(A.wbrels,-1,"worksheets/sheet"+N+"."+d,Ta.WS[0]),be&&(W=!1,me="",(K=be["!comments"])&&0<K.length&&(re=!1,K.forEach(function(ce){ce[1].forEach(function(Ee){Ee.T==1&&(re=!0)})}),re&&(Ct(w,me="xl/threadedComments/threadedComment"+N+"."+d,(function(ce,Ee,Ue){var Ie=[Ba,lr("ThreadedComments",null,{xmlns:Bn.TCMNT}).replace(/[\/]>/,">")];return ce.forEach(function($e){var st="";($e[1]||[]).forEach(function(rt,mt){var Mt;rt.T?(rt.a&&Ee.indexOf(rt.a)==-1&&Ee.push(rt.a),Mt={ref:$e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+Ue.tcid++).slice(-12)+"}"},mt==0?st=Mt.id:Mt.parentId=st,rt.ID=Mt.id,rt.a&&(Mt.personId="{54EE7950-7262-4200-6969-"+("000000000000"+Ee.indexOf(rt.a)).slice(-12)+"}"),Ie.push(lr("threadedComment",Un("text",rt.t||""),Mt))):delete rt.ID})}),Ie.push("</ThreadedComments>"),Ie.join("")})(K,P,A)),x.threadedcomments.push(me),ps(De,-1,"../threadedComments/threadedComment"+N+"."+d,Ta.TCMNT)),Ct(w,me="xl/comments"+N+"."+d,Mg(K)),x.comments.push(me),ps(De,-1,"../comments"+N+"."+d,Ta.CMNT),W=!0),be["!legacy"]&&W&&Ct(w,"xl/drawings/vmlDrawing"+N+".vml",kp(N,be["!comments"])),delete be["!comments"],delete be["!legacy"]),De["!id"].rId1&&Ct(w,Vc(v),Mo(De))}return A.Strings!=null&&0<A.Strings.length&&(Ct(w,v="xl/sharedStrings.xml",ZA(A.Strings,A)),x.strs.push(v),ps(A.wbrels,-1,"sharedStrings.xml",Ta.SST)),Ct(w,v="xl/workbook.xml",Zh(o)),x.workbooks.push(v),ps(A.rels,1,v,Ta.WB),Ct(w,v="xl/theme/theme1.xml",Qh(o.Themes,A)),x.themes.push(v),ps(A.wbrels,-1,"theme/theme1.xml",Ta.THEME),Ct(w,v="xl/styles.xml",Cp(o,A)),x.styles.push(v),ps(A.wbrels,-1,"styles.xml",Ta.STY),o.vbaraw&&h&&(Ct(w,v="xl/vbaProject.bin",o.vbaraw),x.vba.push(v),ps(A.wbrels,-1,"vbaProject.bin",Ta.VBA)),Ct(w,v="xl/metadata.xml",Ep()),x.metadata.push(v),ps(A.wbrels,-1,"metadata.xml",Ta.XLMETA),1<P.length&&(Ct(w,v="xl/persons/person.xml",(h=P,I=[Ba,lr("personList",null,{xmlns:Bn.TCMNT,"xmlns:x":Nl[0]}).replace(/[\/]>/,">")],h.forEach(function(ce,Ee){I.push(lr("person",null,{displayName:ce,id:"{54EE7950-7262-4200-6969-"+("000000000000"+Ee).slice(-12)+"}",userId:ce,providerId:"None"}))}),I.push("</personList>"),I.join(""))),x.people.push(v),ps(A.wbrels,-1,"persons/person.xml",Ta.PEOPLE)),Ct(w,"[Content_Types].xml",xu(x,A)),Ct(w,"_rels/.rels",Mo(A.rels)),Ct(w,"xl/_rels/workbook.xml.rels",Mo(A.wbrels)),delete A.revssf,delete A.ssf,w}function i1(o,A){var d="";switch((A||{}).type||"base64"){case"buffer":return[o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7]];case"base64":d=Q(o.slice(0,12));break;case"binary":d=o;break;case"array":return[o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7]];default:throw new Error("Unrecognized type "+(A&&A.type||"undefined"))}return[d.charCodeAt(0),d.charCodeAt(1),d.charCodeAt(2),d.charCodeAt(3),d.charCodeAt(4),d.charCodeAt(5),d.charCodeAt(6),d.charCodeAt(7)]}function o1(o,A){var d=0;e:for(;d<o.length;)switch(o.charCodeAt(d)){case 10:case 13:case 32:++d;break;case 60:return dl(o.slice(d),A);default:break e}return qa.to_workbook(o,A)}function l1(o,A,d,h){return h?(d.type="string",qa.to_workbook(o,d)):qa.to_workbook(A,d)}function Hf(o,A){F();var d=A||{};if(typeof ArrayBuffer<"u"&&o instanceof ArrayBuffer)return Hf(new Uint8Array(o),((d=Oa(d)).type="array",d));typeof Uint8Array<"u"&&o instanceof Uint8Array&&!d.type&&(d.type=typeof Deno<"u"?"buffer":"array");var h,x,w,v,N,S=o,E=!1;if(d.cellStyles&&(d.cellNF=!0,d.sheetStubs=!0),Kd={},d.dateNF&&(Kd.dateNF=d.dateNF),d.type||(d.type=Z&&Buffer.isBuffer(o)?"buffer":"base64"),d.type=="file"&&(d.type=Z?"buffer":"binary",S=(function(P){if(or!==void 0)return or.readFileSync(P);if(typeof Deno<"u")return Deno.readFileSync(P);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var K=File(P);K.open("r"),K.encoding="binary";var W=K.read();return K.close(),W}catch(me){if(!me.message||!me.message.match(/onstruct/))throw me}throw new Error("Cannot access file "+P)})(o),typeof Uint8Array>"u"||Z||(d.type="array")),d.type=="string"&&(E=!0,d.type="binary",d.codepage=65001,S=(I=o).match(/[^\x00-\x7F]/)?aa(I):I),d.type=="array"&&typeof Uint8Array<"u"&&o instanceof Uint8Array&&typeof ArrayBuffer<"u"){var I=new ArrayBuffer(3),I=new Uint8Array(I);if(I.foo="bar",!I.foo)return(d=Oa(d)).type="array",Hf(J(S),d)}switch((h=i1(S,d))[0]){case 208:if(h[1]===207&&h[2]===17&&h[3]===224&&h[4]===161&&h[5]===177&&h[6]===26&&h[7]===225)return v=$t.read(S,d),N=d,($t.find(v,"EncryptedPackage")?An:V0)(v,N);break;case 9:if(h[1]<=8)return V0(S,d);break;case 60:return dl(S,d);case 73:if(h[1]===73&&h[2]===42&&h[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(h[1]===68)return(function(P,K){var W=K||{},me=!!W.WTF;W.WTF=!0;try{var re=zr.to_workbook(P,W);return W.WTF=me,re}catch(De){if(W.WTF=me,!De.message.match(/SYLK bad record ID/)&&me)throw De;return qa.to_workbook(P,K)}})(S,d);break;case 84:if(h[1]===65&&h[2]===66&&h[3]===76)return La.to_workbook(S,d);break;case 80:return h[1]===75&&h[2]<9&&h[3]<9?(w=N=S,(x=(x=d)||{}).type||(x.type=Z&&Buffer.isBuffer(N)?"buffer":"base64"),s1($r(w,x),x)):l1(o,S,d,E);case 239:return h[3]===60?dl(S,d):l1(o,S,d,E);case 255:if(h[1]===254)return w=S,(x=d).type=="base64"&&(w=Q(w)),w=e.utils.decode(1200,w.slice(2),"str"),x.type="binary",o1(w,x);if(h[1]===0&&h[2]===2&&h[3]===0)return xs.to_workbook(S,d);break;case 0:if(h[1]===0&&(2<=h[2]&&h[3]===0||h[2]===0&&(h[3]===8||h[3]===9)))return xs.to_workbook(S,d);break;case 3:case 131:case 139:case 140:return Ut.to_workbook(S,d);case 123:if(h[1]===92&&h[2]===114&&h[3]===116)return wA.to_workbook(S,d);break;case 10:case 13:case 32:return(function(P,K){var W="",me=i1(P,K);switch(K.type){case"base64":W=Q(P);break;case"binary":W=P;break;case"buffer":W=P.toString("binary");break;case"array":W=Cn(P);break;default:throw new Error("Unrecognized type "+K.type)}return me[0]==239&&me[1]==187&&me[2]==191&&(W=cs(W)),K.type="binary",o1(W,K)})(S,d);case 137:if(h[1]===80&&h[2]===78&&h[3]===71)throw new Error("PNG Image File is not a spreadsheet")}return-1<Et.indexOf(h[0])&&h[2]<=12&&h[3]<=31?Ut.to_workbook(S,d):l1(o,S,d,E)}function gm(o,A){return A=A||{},A.type="file",Hf(o,A)}function J0(o,A){switch(A.type){case"base64":case"binary":break;case"buffer":case"array":A.type="";break;case"file":return Hn(A.file,$t.write(o,{type:Z?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+A.bookType+"' files");default:throw new Error("Unrecognized type "+A.type)}return $t.write(o,A)}function c1(o,A){var d={},h=Z?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(A.compression&&(d.compression="DEFLATE"),A.password)d.type=h;else switch(A.type){case"base64":d.type="base64";break;case"binary":d.type="string";break;case"string":throw new Error("'string' output type invalid for '"+A.bookType+"' files");case"buffer":case"file":d.type=h;break;default:throw new Error("Unrecognized type "+A.type)}if(o=o.FullPaths?$t.write(o,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[d.type]||d.type,compression:!!A.compression}):o.generate(d),typeof Deno<"u"&&typeof o=="string"){if(A.type=="binary"||A.type=="base64")return o;o=new Uint8Array(pe(o))}return A.password&&typeof encrypt_agile<"u"?J0(encrypt_agile(o,A.password),A):A.type==="file"?Hn(A.file,o):A.type=="string"?cs(o):o}function iA(o,A,d){var h=(d=d||"")+o;switch(A.type){case"base64":return O(aa(h));case"binary":return aa(h);case"string":return o;case"file":return Hn(A.file,h,"utf8");case"buffer":return Z?ee(h,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(h):iA(h,{type:"binary"}).split("").map(function(x){return x.charCodeAt(0)})}throw new Error("Unrecognized type "+A.type)}function zf(o,A){switch(A.type){case"string":case"base64":case"binary":for(var d="",h=0;h<o.length;++h)d+=String.fromCharCode(o[h]);return A.type=="base64"?O(d):A.type=="string"?cs(d):d;case"file":return Hn(A.file,o);case"buffer":return o;default:throw new Error("Unrecognized type "+A.type)}}function Z0(o,A){F(),ld(o);var d,h=Oa(A||{});return h.cellStyles&&(h.cellNF=!0,h.sheetStubs=!0),h.type!="array"?(d=o,A=Oa((A=h)||{}),c1(yo(d,A),A)):(h.type="binary",o=Z0(o,h),h.type="array",pe(o))}function xm(o,A){F(),ld(o);var d=Oa(A||{});if(d.cellStyles&&(d.cellNF=!0,d.sheetStubs=!0),d.type=="array")return d.type="binary",A=xm(o,d),d.type="array",pe(A);var h,x,w,v=0;if(d.sheet&&(v=typeof d.sheet=="number"?d.sheet:o.SheetNames.indexOf(d.sheet),!o.SheetNames[v]))throw new Error("Sheet not found: "+d.sheet+" : "+typeof d.sheet);switch(d.bookType||"xlsb"){case"xml":case"xlml":return iA(Wd(o,d),d);case"slk":case"sylk":return iA(zr.from_sheet(o.Sheets[o.SheetNames[v]],d),d);case"htm":case"html":return iA(cx(o.Sheets[o.SheetNames[v]],d),d);case"txt":return(function(N,S){switch(S.type){case"base64":return O(N);case"binary":case"string":return N;case"file":return Hn(S.file,N,"binary");case"buffer":return Z?ee(N,"binary"):N.split("").map(function(E){return E.charCodeAt(0)})}throw new Error("Unrecognized type "+S.type)})(d1(o.Sheets[o.SheetNames[v]],d),d);case"csv":return iA(vm(o.Sheets[o.SheetNames[v]],d),d,"\uFEFF");case"dif":return iA(La.from_sheet(o.Sheets[o.SheetNames[v]],d),d);case"dbf":return zf(Ut.from_sheet(o.Sheets[o.SheetNames[v]],d),d);case"prn":return iA(qa.from_sheet(o.Sheets[o.SheetNames[v]],d),d);case"rtf":return iA(wA.from_sheet(o.Sheets[o.SheetNames[v]],d),d);case"eth":return iA(qs.from_sheet(o.Sheets[o.SheetNames[v]],d),d);case"fods":return iA(cd(o,d),d);case"wk1":return zf(xs.sheet_to_wk1(o.Sheets[o.SheetNames[v]],d),d);case"wk3":return zf(xs.book_to_wk3(o,d),d);case"biff2":d.biff||(d.biff=2);case"biff3":d.biff||(d.biff=3);case"biff4":return d.biff||(d.biff=4),zf(qp(o,d),d);case"biff5":d.biff||(d.biff=5);case"biff8":case"xla":case"xls":return d.biff||(d.biff=8),J0(im(o,w=(w=d)||{}),w);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return h=o,w=Oa((x=d)||{}),k0=new xx(x),c1(n1(h,w),w);default:throw new Error("Unrecognized bookType |"+d.bookType+"|")}}function bm(o){var A;o.bookType||((A=o.file.slice(o.file.lastIndexOf(".")).toLowerCase()).match(/^\.[a-z]+$/)&&(o.bookType=A.slice(1)),o.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[o.bookType]||o.bookType)}function px(o,A,d){return d=d||{},d.type="file",d.file=A,bm(d),xm(o,d)}function A1(o,A,d,h,x,w,v,N){var S=Vs(d),E=N.defval,I=N.raw||!Object.prototype.hasOwnProperty.call(N,"raw"),P=!0,K=x===1?[]:{};if(x!==1)if(Object.defineProperty)try{Object.defineProperty(K,"__rowNum__",{value:d,enumerable:!1})}catch{K.__rowNum__=d}else K.__rowNum__=d;if(!v||o[d])for(var W=A.s.c;W<=A.e.c;++W){var me=v?o[d][W]:o[h[W]+S];if(me!==void 0&&me.t!==void 0){var re=me.v;switch(me.t){case"z":if(re==null)break;continue;case"e":re=re==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+me.t)}if(w[W]!=null){if(re==null)if(me.t=="e"&&re===null)K[w[W]]=null;else if(E!==void 0)K[w[W]]=E;else{if(!I||re!==null)continue;K[w[W]]=null}else K[w[W]]=I&&(me.t!=="n"||me.t==="n"&&N.rawNumbers!==!1)?re:Lo(me,re,N);re!=null&&(P=!1)}}else E!==void 0&&w[W]!=null&&(K[w[W]]=E)}return{row:K,isempty:P}}function ym(o,A){if(o==null||o["!ref"]==null)return[];var d,h={t:"n",v:0},x=0,w=1,v=[],N="",S={s:{r:0,c:0},e:{r:0,c:0}},E=A||{},I=E.range!=null?E.range:o["!ref"];switch(E.header===1?x=1:E.header==="A"?x=2:Array.isArray(E.header)?x=3:E.header==null&&(x=0),typeof I){case"string":S=Fa(I);break;case"number":(S=Fa(o["!ref"])).s.r=I;break;default:S=I}0<x&&(w=0);var P=Vs(S.s.r),K=[],W=[],me=0,re=0,De=Array.isArray(o),be=S.s.r,ce=0,Ee={};De&&!o[be]&&(o[be]=[]);for(var Ue,Ie=E.skipHidden&&o["!cols"]||[],$e=E.skipHidden&&o["!rows"]||[],ce=S.s.c;ce<=S.e.c;++ce)if(!(Ie[ce]||{}).hidden)switch(K[ce]=Sa(ce),h=De?o[be][ce]:o[K[ce]+P],x){case 1:v[ce]=ce-S.s.c;break;case 2:v[ce]=K[ce];break;case 3:v[ce]=E.header[ce-S.s.c];break;default:if(N=d=Lo(h=h??{w:"__EMPTY",t:"s"},null,E),re=Ee[d]||0){for(;N=d+"_"+re++,Ee[N];);Ee[d]=re,Ee[N]=1}else Ee[d]=1;v[ce]=N}for(be=S.s.r+w;be<=S.e.r;++be)($e[be]||{}).hidden||(Ue=A1(o,S,be,K,x,v,De,E)).isempty!==!1&&(x===1?E.blankrows===!1:!E.blankrows)||(W[me++]=Ue.row);return W.length=me,W}var gx=/"/g;function ud(o,A,d,h,x,w,v,N){for(var S=!0,E=[],I="",P=Vs(d),K=A.s.c;K<=A.e.c;++K)if(h[K]){var W=N.dense?(o[d]||[])[K]:o[h[K]+P];if(W==null)I="";else if(W.v!=null){S=!1,I=""+(N.rawNumbers&&W.t=="n"?W.v:Lo(W,null,N));for(var me,re=0;re!==I.length;++re)if((me=I.charCodeAt(re))===x||me===w||me===34||N.forceQuotes){I='"'+I.replace(gx,'""')+'"';break}I=="ID"&&(I='"ID"')}else W.f==null||W.F?I="":(S=!1,0<=(I="="+W.f).indexOf(",")&&(I='"'+I.replace(gx,'""')+'"'));E.push(I)}return N.blankrows===!1&&S?null:E.join(v)}function vm(o,A){var d=[],h=A??{};if(o==null||o["!ref"]==null)return"";var x=Fa(o["!ref"]),w=h.FS!==void 0?h.FS:",",v=w.charCodeAt(0),N=h.RS!==void 0?h.RS:`
`,S=N.charCodeAt(0),E=new RegExp((w=="|"?"\\|":w)+"+$"),I="",P=[];h.dense=Array.isArray(o);for(var K=h.skipHidden&&o["!cols"]||[],W=h.skipHidden&&o["!rows"]||[],me=x.s.c;me<=x.e.c;++me)(K[me]||{}).hidden||(P[me]=Sa(me));for(var re=0,De=x.s.r;De<=x.e.r;++De)(W[De]||{}).hidden||(I=ud(o,x,De,P,v,S,w,h))!=null&&(!(I=h.strip?I.replace(E,""):I)&&h.blankrows===!1||d.push((re++?N:"")+I));return delete h.dense,d.join("")}function d1(o,A){return(A=A||{}).FS="	",A.RS=`
`,o=vm(o,A),e===void 0||A.type=="string"?o:(o=e.utils.encode(1200,o,"str"),""+o)}function wm(I,A,d){var h,x=d||{},w=+!x.skipHeader,v=I||{},N=0,S=0;v&&x.origin!=null&&(typeof x.origin=="number"?N=x.origin:(E=typeof x.origin=="string"?Es(x.origin):x.origin,N=E.r,S=E.c));var E,I={s:{c:0,r:0},e:{c:S,r:N+A.length-1+w}};v["!ref"]?(E=Fa(v["!ref"]),I.e.c=Math.max(I.e.c,E.e.c),I.e.r=Math.max(I.e.r,E.e.r),N==-1&&(N=E.e.r+1,I.e.r=N+A.length-1+w)):N==-1&&(N=0,I.e.r=A.length-1+w);var P=x.header||[],K=0;A.forEach(function(me,re){hs(me).forEach(function(Ue){(K=P.indexOf(Ue))==-1&&(P[K=P.length]=Ue);var be=me[Ue],ce="z",Ee="",Ue=ha({c:S+K,r:N+re+w});h=Nm(v,Ue),!be||typeof be!="object"||be instanceof Date?(typeof be=="number"?ce="n":typeof be=="boolean"?ce="b":typeof be=="string"?ce="s":be instanceof Date?(ce="d",x.cellDates||(ce="n",be=ms(be)),Ee=x.dateNF||X[14]):be===null&&x.nullError&&(ce="e",be=0),h?(h.t=ce,h.v=be,delete h.w,delete h.R,Ee&&(h.z=Ee)):v[Ue]=h={t:ce,v:be},Ee&&(h.z=Ee)):v[Ue]=be})}),I.e.c=Math.max(I.e.c,S+P.length-1);var W=Vs(N);if(w)for(K=0;K<P.length;++K)v[Sa(K+S)+W]={t:"s",v:P[K]};return v["!ref"]=fa(I),v}function Nm(o,A,d){return typeof A!="string"?Nm(o,ha(typeof A!="number"?A:{r:A,c:d||0})):Array.isArray(o)?(d=Es(A),o[d.r]||(o[d.r]=[]),o[d.r][d.c]||(o[d.r][d.c]={t:"z"})):o[A]||(o[A]={t:"z"})}function u1(){return{SheetNames:[],Sheets:{}}}function Cm(o,A,d,h){var x=1;if(!d)for(;x<=65535&&o.SheetNames.indexOf(d="Sheet"+x)!=-1;++x,d=void 0);if(!d||65535<=o.SheetNames.length)throw new Error("Too many worksheets");if(h&&0<=o.SheetNames.indexOf(d)){var h=d.match(/(^.*?)(\d+)$/),x=h&&+h[2]||0,w=h&&h[1]||d;for(++x;x<=65535&&o.SheetNames.indexOf(d=w+x)!=-1;++x);}if(ni(d),0<=o.SheetNames.indexOf(d))throw new Error("Worksheet with name |"+d+"| already exists!");return o.SheetNames.push(d),o.Sheets[d]=A,d}function jm(o,A,d){return A?(o.l={Target:A},d&&(o.l.Tooltip=d)):delete o.l,o}var Kf,f1={encode_col:Sa,encode_row:Vs,encode_cell:ha,encode_range:fa,decode_col:Cl,decode_row:fc,split_cell:function(o){return o.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Es,decode_range:vi,format_cell:Lo,sheet_add_aoa:Pc,sheet_add_json:wm,sheet_add_dom:Zp,aoa_to_sheet:wi,json_to_sheet:function(o,A){return wm(null,o,A)},table_to_sheet:Ax,table_to_book:function(o,A){return ki(Ax(o,A),A)},sheet_to_csv:vm,sheet_to_txt:d1,sheet_to_json:ym,sheet_to_html:cx,sheet_to_formulae:function(o){var A,d="",h="";if(o==null||o["!ref"]==null)return[];for(var x,w=Fa(o["!ref"]),v=[],N=[],S=Array.isArray(o),E=w.s.c;E<=w.e.c;++E)v[E]=Sa(E);for(var I=w.s.r;I<=w.e.r;++I)for(x=Vs(I),E=w.s.c;E<=w.e.c;++E)if(d=v[E]+x,h="",(A=S?(o[I]||[])[E]:o[d])!==void 0){if(A.F!=null){if(d=A.F,!A.f)continue;h=A.f,d.indexOf(":")==-1&&(d=d+":"+d)}if(A.f!=null)h=A.f;else{if(A.t=="z")continue;if(A.t=="n"&&A.v!=null)h=""+A.v;else if(A.t=="b")h=A.v?"TRUE":"FALSE";else if(A.w!==void 0)h="'"+A.w;else{if(A.v===void 0)continue;h=A.t=="s"?"'"+A.v:""+A.v}}N[N.length]=d+"="+h}return N},sheet_to_row_object_array:ym,sheet_get_cell:Nm,book_new:u1,book_append_sheet:Cm,book_set_sheet_visibility:function(o,A,d){switch(o.Workbook||(o.Workbook={}),o.Workbook.Sheets||(o.Workbook.Sheets=[]),A=(function(h,x){if(typeof x=="number"){if(0<=x&&h.SheetNames.length>x)return x;throw new Error("Cannot find sheet # "+x)}if(typeof x!="string")throw new Error("Cannot find sheet |"+x+"|");if(-1<(h=h.SheetNames.indexOf(x)))return h;throw new Error("Cannot find sheet name |"+x+"|")})(o,A),o.Workbook.Sheets[A]||(o.Workbook.Sheets[A]={}),d){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+d)}o.Workbook.Sheets[A].Hidden=d},cell_set_number_format:function(o,A){return o.z=A,o},cell_set_hyperlink:jm,cell_set_internal_link:function(o,A,d){return jm(o,"#"+A,d)},cell_add_comment:function(o,A,d){o.c||(o.c=[]),o.c.push({t:A,a:d||"SheetJS"})},sheet_set_array_formula:function(o,A,d,h){for(var x=typeof A!="string"?A:Fa(A),w=typeof A=="string"?A:fa(A),v=x.s.r;v<=x.e.r;++v)for(var N=x.s.c;N<=x.e.c;++N){var S=Nm(o,v,N);S.t="n",S.F=w,delete S.v,v==x.s.r&&N==x.s.c&&(S.f=d,h&&(S.D=!0))}return o},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function tc(o){Kf=o}var $d={to_json:function(o,A){var d=Kf({objectMode:!0});if(o==null||o["!ref"]==null)return d.push(null),d;var h,x={t:"n",v:0},w=0,v=1,N=[],S="",E={s:{r:0,c:0},e:{r:0,c:0}},I=A||{},P=I.range!=null?I.range:o["!ref"];switch(I.header===1?w=1:I.header==="A"?w=2:Array.isArray(I.header)&&(w=3),typeof P){case"string":E=Fa(P);break;case"number":(E=Fa(o["!ref"])).s.r=P;break;default:E=P}0<w&&(v=0);var K=Vs(E.s.r),W=[],me=0,re=Array.isArray(o),De=E.s.r,be=0,ce={};re&&!o[De]&&(o[De]=[]);for(var Ee=I.skipHidden&&o["!cols"]||[],Ue=I.skipHidden&&o["!rows"]||[],be=E.s.c;be<=E.e.c;++be)if(!(Ee[be]||{}).hidden)switch(W[be]=Sa(be),x=re?o[De][be]:o[W[be]+K],w){case 1:N[be]=be-E.s.c;break;case 2:N[be]=W[be];break;case 3:N[be]=I.header[be-E.s.c];break;default:if(S=h=Lo(x=x??{w:"__EMPTY",t:"s"},null,I),me=ce[h]||0){for(;S=h+"_"+me++,ce[S];);ce[h]=me,ce[S]=1}else ce[h]=1;N[be]=S}return De=E.s.r+v,d._read=function(){for(;De<=E.e.r;)if(!(Ue[De-1]||{}).hidden){var Ie=A1(o,E,De,W,w,N,re,I);if(++De,Ie.isempty===!1||(w===1?I.blankrows!==!1:I.blankrows))return void d.push(Ie.row)}return d.push(null)},d},to_html:function(o,x){var d=Kf(),h=x||{},x=h.header!=null?h.header:Jp,w=h.footer!=null?h.footer:Hs;d.push(x);var v=vi(o["!ref"]);h.dense=Array.isArray(o),d.push(lm(0,0,h));var N=v.s.r,S=!1;return d._read=function(){if(N>v.e.r)return S||(S=!0,d.push("</table>"+w)),d.push(null);for(;N<=v.e.r;){d.push(Xp(o,v,N,h)),++N;break}},d},to_csv:function(o,A){var d=Kf(),h=A??{};if(o==null||o["!ref"]==null)return d.push(null),d;var x=Fa(o["!ref"]),w=h.FS!==void 0?h.FS:",",v=w.charCodeAt(0),N=h.RS!==void 0?h.RS:`
`,S=N.charCodeAt(0),E=new RegExp((w=="|"?"\\|":w)+"+$"),I="",P=[];h.dense=Array.isArray(o);for(var K=h.skipHidden&&o["!cols"]||[],W=h.skipHidden&&o["!rows"]||[],me=x.s.c;me<=x.e.c;++me)(K[me]||{}).hidden||(P[me]=Sa(me));var re=x.s.r,De=!1,be=0;return d._read=function(){if(!De)return De=!0,d.push("\uFEFF");for(;re<=x.e.r;)if(++re,!(W[re-1]||{}).hidden&&(I=ud(o,x,re-1,P,v,S,w,h),I!=null&&((I=h.strip?I.replace(E,""):I)||h.blankrows!==!1)))return d.push((be++?N:"")+I);return d.push(null)},d},set_readable:tc},us=(function(){function o(A,d,h){return this instanceof o?(this.tagName=A,this._attributes=d||{},this._children=h||[],this._prefix="",this):new o(A,d,h)}return o.prototype.createElement=function(){return new o(arguments)},o.prototype.children=function(){return this._children},o.prototype.append=function(A){return this._children.push(A),this},o.prototype.prefix=function(A){return arguments.length==0?this._prefix:(this._prefix=A,this)},o.prototype.attr=function(A,d){if(d==null)return delete this._attributes[A],this;if(arguments.length==0)return this._attributes;if(typeof A=="string"&&arguments.length==1)return this._attributes.attr[A];if(typeof A=="object"&&arguments.length==1)for(var h in A)this._attributes[h]=A[h];else arguments.length==2&&typeof A=="string"&&(this._attributes[A]=d);return this},o.prototype.escapeAttributeValue=function(A){return'"'+A.replace(/\"/g,"&quot;")+'"'},o.prototype.toXml=function(A){var d=(A=A||this)._prefix;if(d+="<"+A.tagName,A._attributes)for(var h in A._attributes)d+=" "+h+"="+this.escapeAttributeValue(""+A._attributes[h]);if(A._children&&0<A._children.length){d+=">";for(var x=0;x<A._children.length;x++)d+=this.toXml(A._children[x]);d+="</"+A.tagName+">"}else d+="/>";return d},o})(),xx=function(o){var A,d=164,h={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},x={};for(A in h)x[h[A]]=A;var w={};return{initialize:function(v){this.$fonts=us("fonts").attr("count",0).attr("x14ac:knownFonts","1"),this.$fills=us("fills").attr("count",0),this.$borders=us("borders").attr("count",0),this.$numFmts=us("numFmts").attr("count",0),this.$cellStyleXfs=us("cellStyleXfs"),this.$xf=us("xf").attr("numFmtId",0).attr("fontId",0).attr("fillId",0).attr("borderId",0),this.$cellXfs=us("cellXfs").attr("count",0),this.$cellStyles=us("cellStyles").append(us("cellStyle").attr("name","Normal").attr("xfId",0).attr("builtinId",0)),this.$dxfs=us("dxfs").attr("count","0"),this.$tableStyles=us("tableStyles").attr("count","0").attr("defaultTableStyle","TableStyleMedium9").attr("defaultPivotStyle","PivotStyleMedium4"),this.$styles=us("styleSheet").attr("xmlns:mc","http://schemas.openxmlformats.org/markup-compatibility/2006").attr("xmlns:x14ac","http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac").attr("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main").attr("mc:Ignorable","x14ac").prefix('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>').append(this.$numFmts).append(this.$fonts).append(this.$fills).append(this.$borders).append(this.$cellStyleXfs.append(this.$xf)).append(this.$cellXfs).append(this.$cellStyles).append(this.$dxfs).append(this.$tableStyles);var N=v.defaultCellStyle||{};return N.font||(N.font={name:"Calibri",sz:"11"}),N.font.name||(N.font.name="Calibri"),N.font.sz||(N.font.sz=11),N.fill||(N.fill={patternType:"none",fgColor:{}}),N.border||(N.border={}),N.numFmt||(N.numFmt=0),this.defaultStyle=N,v=JSON.parse(JSON.stringify(N)),v.fill={patternType:"gray125",fgColor:{}},this.addStyles([N,v]),this},addStyle:function(v){var N=JSON.stringify(v),S=w[N];return S==null?(S=this._addXf(v),w[N]=S):S=w[N],S},addStyles:function(v){var N=this;return v.map(function(S){return N.addStyle(S)})},_duckTypeStyle:function(v){return typeof v=="object"&&(v.patternFill||v.fgColor)?{fill:v}:v.font||v.numFmt||v.border||v.fill?v:this._getStyleCSS(v)},_getStyleCSS:function(v){return v},_addXf:function(v){var N=this._addFont(v.font),S=this._addFill(v.fill),E=this._addBorder(v.border),I=this._addNumFmt(v.numFmt),P=us("xf").attr("numFmtId",I).attr("fontId",N).attr("fillId",S).attr("borderId",E).attr("xfId","0");return 0<N&&P.attr("applyFont","1"),0<S&&P.attr("applyFill","1"),0<E&&P.attr("applyBorder","1"),0<I&&P.attr("applyNumberFormat","1"),v.alignment&&(I=us("alignment"),v.alignment.horizontal&&I.attr("horizontal",v.alignment.horizontal),v.alignment.vertical&&I.attr("vertical",v.alignment.vertical),v.alignment.indent&&I.attr("indent",v.alignment.indent),v.alignment.readingOrder&&I.attr("readingOrder",v.alignment.readingOrder),v.alignment.wrapText&&I.attr("wrapText",v.alignment.wrapText),v.alignment.textRotation!=null&&I.attr("textRotation",v.alignment.textRotation),P.append(I).attr("applyAlignment",1)),this.$cellXfs.append(P),P=+this.$cellXfs.children().length,this.$cellXfs.attr("count",P),P-1},_addFont:function(v){if(!v)return 0;var N=us("font").append(us("sz").attr("val",v.sz||this.defaultStyle.font.sz)).append(us("name").attr("val",v.name||this.defaultStyle.font.name));return v.bold&&N.append(us("b")),v.underline&&N.append(us("u")),v.italic&&N.append(us("i")),v.strike&&N.append(us("strike")),v.outline&&N.append(us("outline")),v.shadow&&N.append(us("shadow")),v.vertAlign&&N.append(us("vertAlign").attr("val",v.vertAlign)),v.color&&(v.color.theme?(N.append(us("color").attr("theme",v.color.theme)),v.color.tint&&N.append(us("tint").attr("theme",v.color.tint))):v.color.rgb&&N.append(us("color").attr("rgb",v.color.rgb))),this.$fonts.append(N),N=this.$fonts.children().length,this.$fonts.attr("count",N),N-1},_addNumFmt:function(v){if(!v)return 0;if(typeof v=="string"){var N=x[v];if(0<=N)return N}return/^[0-9]+$/.exec(v)?v:(v=v.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),v=us("numFmt").attr("numFmtId",++d).attr("formatCode",v),this.$numFmts.append(v),v=this.$numFmts.children().length,this.$numFmts.attr("count",v),d)},_addFill:function(v){if(!v)return 0;var N,S=us("patternFill").attr("patternType",v.patternType||"solid");return v.fgColor&&(N=us("fgColor"),v.fgColor.rgb?(v.fgColor.rgb.length==6&&(v.fgColor.rgb="FF"+v.fgColor.rgb),N.attr("rgb",v.fgColor.rgb),S.append(N)):v.fgColor.theme&&(N.attr("theme",v.fgColor.theme),v.fgColor.tint&&N.attr("tint",v.fgColor.tint),S.append(N)),v.bgColor||(v.bgColor={indexed:"64"})),v.bgColor&&(v=us("bgColor").attr(v.bgColor),S.append(v)),S=us("fill").append(S),this.$fills.append(S),S=this.$fills.children().length,this.$fills.attr("count",S),S-1},_getSubBorder:function(v,N){var S=us(v);return N&&(S.attr("style",N.style||"medium"),N.color&&(v=us("color"),N.color.auto?v.attr("auto",N.color.auto):N.color.rgb?v.attr("rgb",N.color.rgb):(N.color.theme||N.color.tint)&&(v.attr("theme",N.color.theme||"1"),v.attr("tint",N.color.tint||"0")),S.append(v))),S},_addBorder:function(v){if(!v)return 0;var N=this,S=us("border").attr("diagonalUp",v.diagonalUp).attr("diagonalDown",v.diagonalDown);["left","right","top","bottom","diagonal"].forEach(function(I){S.append(N._getSubBorder(I,v[I]))}),this.$borders.append(S);var E=this.$borders.children().length;return this.$borders.attr("count",E),E-1},toXml:function(){return this.$styles.toXml()}}.initialize(o||{})};V0!==void 0&&(s.parse_xlscfb=V0),s.parse_zip=s1,s.read=Hf,s.readFile=gm,s.readFileSync=gm,s.write=xm,s.writeFile=px,s.writeFileSync=px,s.writeFileAsync=function(o,A,d,h){var x=d||{};return x.type="file",x.file=o,bm(x),x.type="buffer",h instanceof Function||(h=d),or.writeFile(o,xm(A,x),h)},s.utils=f1,s.writeXLSX=Z0,s.writeFileXLSX=function(o,A,d){return(d=d||{}).type="file",d.file=A,bm(d),Z0(o,d)},s.SSF=jr,$d!==void 0&&(s.stream=$d),$t!==void 0&&(s.CFB=$t),typeof v2>"u"||(($d=Uy)||{}).Readable&&tc($d.Readable)}if(r(a),typeof window<"u"&&!window.XLSX)try{window.XLSX=t}catch{}})(Bx,Bx.exports)),Bx.exports}var Da=dD();const lj=({activeTab:n,onFilterChange:a,parentSearchTerm:t,parentSelectedClass:r,parentSelectedSection:s,students:e,isCompletedBatch:u})=>{const f=Pn(),m=Cd(),{students:g}=rr(Se=>Se.students),b=e||g,[j,F]=ne.useState(t||""),[C,M]=ne.useState(r||""),[_,L]=ne.useState(s||""),[T,H]=ne.useState("available"),[O,Q]=ne.useState(1),[Z,ee]=ne.useState(!1),[se,ue]=ne.useState(!1),[ae,pe]=ne.useState(!1),z=30,J=n??T;ne.useEffect(()=>{t!==void 0&&F(t),r!==void 0&&M(r),s!==void 0&&L(s)},[t,r,s]);const ge=[...new Set(b.map(Se=>Se.class))],fe=C?[...new Set(b.filter(Se=>Se.class===C).map(Se=>Se.section))]:[],ke=()=>b.reduce((Se,ft)=>(u&&ft.status==="passed_out"?Se.available.push(ft):ft.status==="passed_out"?Se.unavailable.push(ft):ft.status==="left"?Se.left.push(ft):Se.available.push(ft),Se),{available:[],unavailable:[],left:[]}),{available:he,unavailable:Ne,left:xe}=ke(),we=Se=>Se.filter(ft=>{const jt=`${ft.firstName} ${ft.lastName}`.toLowerCase().includes(j.toLowerCase())||ft.grNo&&ft.grNo.toLowerCase().includes(j.toLowerCase())||ft.class.toLowerCase().includes(j.toLowerCase()),It=!C||ft.class===C,ut=!_||ft.section===_;return jt&&It&&ut}),ye=we(he),te=we(Ne),V=we(xe),de=(()=>{switch(J){case"available":return ye;case"unavailable":return te;case"left":return V;default:return ye}})(),ie=(()=>{const Se=(O-1)*z,ft=Se+z;return de.slice(Se,ft)})(),G=Math.ceil(de.length/z),q=Se=>{m("/students/admission",{state:{studentData:Se}})},ve=()=>{const Se=[["GR No","First Name","Last Name","Father Name","Religion","Address","Date of Birth","Place of Birth","Parent Contact","Date of Admission","Class","Section","Last School Attended","Date of Leaving","Class in Which Left","Reason of Leaving","Remarks","Status"],...de.map(ut=>[ut.grNo||"",ut.firstName||"",ut.lastName||"",ut.fatherName||"",ut.religion||"",ut.address||"",ut.dateOfBirth||"",ut.birthPlace||"",ut.parentContact||"",ut.dateOfAdmission||"",ut.class||"",ut.section||"",ut.lastSchoolAttended||"",ut.dateOfLeaving||"",ut.classInWhichLeft||"",ut.reasonOfLeaving||"",ut.remarks||"",ut.status&&ut.status!=="studying"?ut.status:""])].map(ut=>ut.join(",")).join(`
`),ft=new Blob([Se],{type:"text/csv;charset=utf-8;"}),jt=URL.createObjectURL(ft),It=document.createElement("a");It.setAttribute("href",jt),It.setAttribute("download",`students_${J}_report.csv`),It.style.visibility="hidden",document.body.appendChild(It),It.click(),document.body.removeChild(It)},Fe=()=>{const ft=[["GR No","First Name","Last Name","Father Name","Religion","Address","Date of Birth","Place of Birth","Parent Contact","Date of Admission","Class","Section","Last School Attended","Last School Leaving Date","Last School Class","Reason for Leaving Last School","Last School Remarks","Status"],...de.map(Rt=>[Rt.grNo||"",Rt.firstName||"",Rt.lastName||"",Rt.fatherName||"",Rt.religion||"",Rt.address||"",Rt.dateOfBirth||"",Rt.birthPlace||"",Rt.parentContact||"",Rt.dateOfAdmission||"",Rt.class||"",Rt.section||"",Rt.lastSchoolAttended||"",Rt.dateOfLeaving||"",Rt.classInWhichLeft||"",Rt.reasonOfLeaving||"",Rt.remarks||"",Rt.status&&Rt.status!=="studying"?Rt.status:""])],jt=Da.utils.book_new(),It=Da.utils.aoa_to_sheet(ft),ut=Da.utils.decode_range(It["!ref"]);for(let Rt=ut.s.c;Rt<=ut.e.c;Rt++){const Ye=Da.utils.encode_cell({r:0,c:Rt});It[Ye]&&(It[Ye].s={font:{bold:!0,sz:12,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"3b82f6"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}})}It["!cols"]=[{wch:10},{wch:15},{wch:15},{wch:20},{wch:12},{wch:40},{wch:15},{wch:20},{wch:15},{wch:18},{wch:10},{wch:10},{wch:35},{wch:25},{wch:20},{wch:30},{wch:30},{wch:12}],Da.utils.book_append_sheet(jt,It,"Students"),Da.writeFile(jt,`students_${J}_report.xlsx`)},Qe=()=>{window.print()},Ge=()=>{const ft=[["First Name","Last Name","Father Name","Religion","Address","Date of Birth","Place of Birth","Parent Contact","Last School Attended","Date of Admission","Class","Section","GR No","Monthly Fees","Admission Fees"],["Ahmed","Khan","Muhammad Khan","Islam","123 Main Street","2005-05-15","Aga Khan Hospital","03001234567","Karachi Grammar School","2023-09-01","Class 5","A","GR001",3e3,4e3],["Fatima","Ahmed","Ali Ahmed","Islam","456 Oak Avenue","2006-08-22","Shalamar Hospital","03007654321","Lahore Grammar School","2023-09-01","Class 4","B","GR002",2800,3500]],jt=Da.utils.book_new(),It=Da.utils.aoa_to_sheet(ft),ut=Da.utils.decode_range(It["!ref"]);for(let Rt=ut.s.c;Rt<=ut.e.c;Rt++){const Ye=Da.utils.encode_cell({r:0,c:Rt});It[Ye]&&(It[Ye].s={font:{bold:!0,sz:12,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"3b82f6"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}})}It["!cols"]=[{wch:15},{wch:15},{wch:20},{wch:12},{wch:30},{wch:15},{wch:20},{wch:15},{wch:25},{wch:18},{wch:10},{wch:10},{wch:10},{wch:15},{wch:15}],Da.utils.book_append_sheet(jt,It,"Student_Template"),Da.writeFile(jt,"student_import_template.xlsx")},je=async Se=>{const ft=Se.target.files[0];if(ft){if(!ft.name.match(/\.(xlsx|xls)$/)){alert("Please select a valid Excel file (.xlsx or .xls)"),Se.target.value="";return}if(!window.confirm("This will import student data from the Excel file. Do you want to continue?")){Se.target.value="";return}try{ee(!0);const jt=new FileReader;jt.onload=async It=>{try{const ut=new Uint8Array(It.target.result),Rt=Da.read(ut,{type:"array"}),Ye=Rt.SheetNames[0],St=Rt.Sheets[Ye],Jt=Da.utils.sheet_to_json(St);let mr=0,ar=0;const bt=[],Yt=await fetch(gl("batches"));let vr=null;Yt.ok&&(vr=(await Yt.json()).find(ja=>ja.status==="active"));let gr;if(vr)gr=vr.name;else{const Ot=new Date().getFullYear(),ja=Ot+1;gr=`${Ot}-${ja}`}for(const Ot of Jt)try{const ja=pr=>{if(!pr)return"";if(typeof pr=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(pr))return pr;if(typeof pr=="string"&&/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(pr)){const Gr=pr.split("/"),Pr=Gr[0].padStart(2,"0"),wa=Gr[1].padStart(2,"0");return`${Gr[2]}-${Pr}-${wa}`}if(pr instanceof Date&&!isNaN(pr))return pr.toISOString().split("T")[0];if(typeof pr=="number"){const Gr=new Date(1900,0,1);return new Date(Gr.getTime()+(pr-2)*24*60*60*1e3).toISOString().split("T")[0]}try{const Gr=new Date(pr);if(Gr instanceof Date&&!isNaN(Gr))return Gr.toISOString().split("T")[0]}catch{}return""},oa={firstName:Ot["First Name"]||Ot.firstName||Ot.FirstName||"",lastName:Ot["Last Name"]||Ot.lastName||Ot.LastName||"",fatherName:Ot["Father Name"]||Ot.fatherName||Ot.FatherName||"",religion:Ot.Religion||Ot.religion||"",address:Ot.Address||Ot.address||"",dateOfBirth:ja(Ot["Date of Birth"]||Ot.dateOfBirth||Ot.DateOfBirth),birthPlace:Ot["Place of Birth"]||Ot.birthPlace||Ot.BirthPlace||"",parentContact:Ot["Parent Contact"]||Ot.parentContact||Ot.ParentContact||"",lastSchoolAttended:Ot["Last School Attended"]||Ot.lastSchoolAttended||Ot.LastSchoolAttended||"",dateOfAdmission:ja(Ot["Date of Admission"]||Ot.dateOfAdmission||Ot.DateOfAdmission)||new Date().toISOString().split("T")[0],class:Ot.Class||Ot.class||"",section:Ot.Section||Ot.section||"A",grNo:Ot["GR No"]||Ot.grNo||Ot.GRNo||"",monthlyFees:parseFloat(Ot["Monthly Fees"]||Ot.monthlyFees||Ot.MonthlyFees||0),admissionFees:parseFloat(Ot["Admission Fees"]||Ot.admissionFees||Ot.AdmissionFees||0),status:"studying",totalFees:parseFloat(Ot["Monthly Fees"]||Ot.monthlyFees||Ot.MonthlyFees||0)+parseFloat(Ot["Admission Fees"]||Ot.admissionFees||Ot.AdmissionFees||0),feesPaid:0,familyId:`family-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,relationship:"self",academicYear:gr};if(!oa.firstName||!oa.lastName||!oa.class){bt.push(`Row missing required fields (First Name, Last Name, Class): ${JSON.stringify(Ot)}`),ar++;continue}oa.dateOfBirth&&isNaN(Date.parse(oa.dateOfBirth))&&(oa.dateOfBirth=""),oa.dateOfAdmission&&isNaN(Date.parse(oa.dateOfAdmission))&&(oa.dateOfAdmission=new Date().toISOString().split("T")[0]);const hr=await fetch(gl("students"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(oa)});if(hr.ok)mr++;else{const pr=await hr.json();bt.push(`Failed to import student ${oa.firstName} ${oa.lastName}: ${pr.error||"Unknown error"}`),ar++}}catch(ja){bt.push(`Error processing row: ${ja.message}`),ar++}let Mr=`Import completed!

Successfully imported: ${mr} students`;ar>0&&(Mr+=`
Errors: ${ar}

Check console for details.`,console.error("Import errors:",bt)),alert(Mr),mr>0&&f(Lc())}catch(ut){console.error("Error parsing Excel file:",ut),alert("Error parsing Excel file. Please check the file format and try again.")}finally{ee(!1)}},jt.readAsArrayBuffer(ft)}catch(jt){console.error("Error importing Excel file:",jt),alert("Error importing file. Please try again."),ee(!1)}Se.target.value=""}},Me=()=>{if(a){const Se=we(b),ft=Se.filter(Ye=>Ye.status!=="passed_out"&&Ye.status!=="left"),jt=Se.filter(Ye=>Ye.status==="passed_out"),It=Se.filter(Ye=>Ye.status==="left"),ut={};Se.forEach(Ye=>{const St=Ye.familyId||`unknown-${Ye.id}`;ut[St]||(ut[St]=[]),ut[St].push(Ye)});const Rt=Object.keys(ut).length;a({stats:{available:ft.length,unavailable:jt.length,left:It.length,families:Rt},searchTerm:j,selectedClass:C,selectedSection:_})}};return ne.useEffect(()=>{Me(),Q(1)},[j,C,_]),i.jsx(i.Fragment,{children:i.jsxs("div",{className:"bg-white shadow p-4",children:[i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3",children:[i.jsxs("div",{className:"relative flex-grow max-w-md",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Bi,{className:"h-4 w-4 text-gray-400"})}),i.jsx("input",{type:"text",placeholder:"Search by student name, GR No, or class...",value:j,onChange:Se=>F(Se.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(io,{className:"text-gray-400 h-4 w-4"}),i.jsxs("select",{value:C,onChange:Se=>M(Se.target.value),className:"block w-full pl-3 pr-10 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"All Classes"}),ge.map(Se=>i.jsx("option",{value:Se,children:Se},Se))]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(io,{className:"text-gray-400 h-4 w-4"}),i.jsxs("select",{value:_,onChange:Se=>L(Se.target.value),disabled:!C,className:"block w-full pl-3 pr-10 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"All Sections"}),fe.map(Se=>i.jsx("option",{value:Se,children:Se},Se))]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsxs("div",{className:"relative",children:[i.jsxs("button",{className:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",onMouseEnter:()=>pe(!0),onMouseLeave:()=>pe(!1),children:[i.jsx(lu,{className:"mr-1"})," Export"]}),ae&&i.jsx("div",{className:"absolute right-0 mt-0 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-10",onMouseEnter:()=>pe(!0),onMouseLeave:()=>pe(!1),children:i.jsxs("div",{className:"py-1",children:[i.jsx("button",{onClick:ve,className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Export as CSV"}),i.jsx("button",{onClick:Fe,className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Export as Excel"})]})})]}),i.jsxs("div",{className:"relative",children:[i.jsxs("button",{className:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",onMouseEnter:()=>ue(!0),onMouseLeave:()=>ue(!1),disabled:Z,children:[i.jsx(lu,{className:"mr-1"})," ",Z?"Importing...":"Import"]}),se&&i.jsx("div",{className:"absolute right-0 mt-0 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-10",onMouseEnter:()=>ue(!0),onMouseLeave:()=>ue(!1),children:i.jsxs("div",{className:"py-1",children:[i.jsx("button",{onClick:()=>document.getElementById("import-excel-file").click(),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",disabled:Z,children:"Import from Excel"}),i.jsx("button",{onClick:Ge,className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Download Sample Template"})]})})]}),i.jsx("input",{id:"import-excel-file",type:"file",accept:".xlsx, .xls",className:"hidden",onChange:je}),i.jsxs("button",{onClick:Qe,className:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[i.jsx(mi,{className:"mr-1"})," Print"]}),i.jsx("button",{onClick:()=>{F(""),M(""),L("")},className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Clear"})]})]})]}),i.jsxs("div",{className:"mt-3 flex items-center text-sm text-gray-600",children:[i.jsxs("span",{children:["Showing ",de.length," of ",J==="available"?he.length:J==="unavailable"?Ne.length:xe.length," ",J==="unavailable"?"passed out":J==="left"?"left in middle":J," students"]}),(C||_||j)&&i.jsx("button",{onClick:()=>{F(""),M(""),L("")},className:"ml-2 text-blue-600 hover:text-blue-800",children:"(Clear filters)"})]})]}),i.jsxs("div",{className:"overflow-hidden rounded-md border border-gray-200",children:[i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Photo"}),i.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"GR No"}),i.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),i.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Father's Name"}),i.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class & Section"}),i.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Religion"}),i.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ie.map(Se=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsx("div",{className:"flex items-center",children:i.jsx("div",{className:"bg-gray-200 border-2 border-dashed rounded-xl w-10 h-10 flex items-center justify-center",children:i.jsx("img",{src:Se.photo,alt:Se.firstName,className:"w-10 h-10 rounded-xl"})})})}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsx("div",{className:"text-sm text-gray-900",children:Se.grNo})}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[Se.firstName," ",Se.lastName]})}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsx("div",{className:"text-sm text-gray-900",children:Se.fatherName})}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsxs("div",{className:"flex flex-col",children:[i.jsx("div",{className:"text-sm text-gray-900",children:Se.class}),i.jsxs("div",{className:"text-sm text-gray-500",children:["Section ",Se.section]})]})}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsx("div",{className:"text-sm text-gray-900",children:Se.religion})}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:i.jsx("div",{className:"flex space-x-2",children:i.jsxs("button",{onClick:()=>q(Se),className:"inline-flex items-center px-3 py-1 border border-gray-300 text-xs font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50",children:[i.jsx(IA,{className:"mr-1"})," Edit Details"]})})})]},Se.id))})]}),de.length===0&&i.jsxs("div",{className:"text-center py-8",children:[i.jsx("div",{className:"flex justify-center",children:J==="available"?i.jsx(cA,{className:"mx-auto h-8 w-8 text-gray-400"}):J==="unavailable"?i.jsx(Tc,{className:"mx-auto h-8 w-8 text-gray-400"}):i.jsx(Tc,{className:"mx-auto h-8 w-8 text-gray-400"})}),i.jsxs("h3",{className:"mt-2 text-lg font-medium text-gray-900",children:["No ",J==="unavailable"?"passed out":J==="left"?"left in middle":J," students found"]}),i.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Try adjusting your search or filter criteria"})]})]}),de.length>z&&i.jsx("div",{className:"mt-4",children:i.jsx(Bd,{currentPage:O,totalPages:G,totalItems:de.length,itemsPerPage:z,paginate:Se=>Q(Se)})})]})})},uD=({students:n})=>{const{students:a}=rr(pe=>pe.students),t=n||a,[r,s]=ne.useState(""),[e,u]=ne.useState(""),[f,m]=ne.useState(""),[g,b]=ne.useState(""),[j,F]=ne.useState(1),C=3,M=[...new Set(t.map(pe=>pe.class))],_=e?[...new Set(t.filter(pe=>pe.class===e).map(pe=>pe.section))]:[],L=[...new Set(t.filter(pe=>pe.fatherName).map(pe=>pe.fatherName))].map(pe=>{const z=t.filter(J=>J.fatherName===pe);return{id:pe.toLowerCase().replace(/\s+/g,"_"),name:`${pe}'s Family`,memberCount:z.length}}),H=(()=>{const pe={};return t.forEach(z=>{const J=z.fatherName?z.fatherName.toLowerCase().replace(/\s+/g,"_"):`unknown-${z.id}`;pe[J]||(pe[J]={familyInfo:{id:J,name:z.fatherName?`${z.fatherName}'s Family`:"Unknown Family",fatherName:z.fatherName||"Unknown"},members:[]}),pe[J].members.push(z)}),Object.values(pe).forEach(z=>{z.members.sort((ge,fe)=>ge.dateOfBirth&&fe.dateOfBirth?new Date(ge.dateOfBirth)-new Date(fe.dateOfBirth):0);const J=z.members[0];z.familyInfo.head=J}),pe})(),Q=(()=>{const pe={};return Object.entries(H).forEach(([z,J])=>{const ge=J.members.filter(fe=>{const ke=`${fe.firstName} ${fe.lastName}`.toLowerCase().includes(r.toLowerCase())||fe.email.toLowerCase().includes(r.toLowerCase())||fe.class.toLowerCase().includes(r.toLowerCase()),he=!e||fe.class===e,Ne=!f||fe.section===f;return ke&&he&&Ne&&(!g||z===g)});ge.length>0&&(pe[z]={...J,members:ge})}),pe})(),Z=j*C,ee=Z-C,se=Object.entries(Q).slice(ee,Z),ue=Object.entries(Q).length,ae=Math.ceil(ue/C);return i.jsx(i.Fragment,{children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 mb-6",children:[i.jsx("div",{className:"mb-6",children:i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[i.jsxs("div",{className:"relative flex-grow max-w-md",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Bi,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"text",placeholder:"Search by student name, email, or class...",value:r,onChange:pe=>s(pe.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(io,{className:"text-gray-400"}),i.jsxs("select",{value:g,onChange:pe=>b(pe.target.value),className:"block w-full pl-3 pr-10 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"All Families"}),L.map(pe=>i.jsxs("option",{value:pe.id,children:[pe.name," (",pe.memberCount,")"]},pe.id))]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(io,{className:"text-gray-400"}),i.jsxs("select",{value:e,onChange:pe=>{u(pe.target.value),m("")},className:"block w-full pl-3 pr-10 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"All Classes"}),M.map(pe=>i.jsx("option",{value:pe,children:pe},pe))]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(io,{className:"text-gray-400"}),i.jsxs("select",{value:f,onChange:pe=>m(pe.target.value),disabled:!e,className:"block w-full pl-3 pr-10 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"All Sections"}),_.map(pe=>i.jsx("option",{value:pe,children:pe},pe))]})]}),i.jsx("button",{onClick:()=>{s(""),u(""),m(""),b("")},className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Clear"})]})]})}),i.jsx("div",{className:"space-y-6",children:Object.entries(Q).length>0?se.map(([pe,z])=>i.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[i.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx(_c,{className:"text-gray-600 text-lg mr-3"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:z.familyInfo.name})]}),i.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[z.members.length," ",z.members.length===1?"Member":"Members"]})]}),z.familyInfo.head&&i.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Head: ",z.familyInfo.head.firstName," ",z.familyInfo.head.lastName]})]}),i.jsx("div",{className:"p-6",children:i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:z.members.map(J=>i.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx("div",{className:"bg-gray-200 border-2 border-dashed rounded-xl w-12 h-12 flex-shrink-0"}),i.jsxs("div",{className:"ml-4 flex-1",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsxs("h4",{className:"text-sm font-medium text-gray-900",children:[J.firstName," ",J.lastName]}),i.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:J.relationship||"Family Member"})]}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["ID: ",J.id]}),i.jsxs("div",{className:"mt-2",children:[i.jsxs("p",{className:"text-xs text-gray-600",children:[i.jsx("span",{className:"font-medium",children:"Class:"})," ",J.class," - Section ",J.section]}),i.jsxs("p",{className:"text-xs text-gray-600",children:[i.jsx("span",{className:"font-medium",children:"Contact:"})," ",J.phone]})]})]})]})},J.id))})})]},pe)):i.jsxs("div",{className:"text-center py-12",children:[i.jsx(_c,{className:"mx-auto h-12 w-12 text-gray-400"}),i.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No family groups found"}),i.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Try adjusting your search or filter criteria"})]})}),ue>C&&i.jsx(Bd,{currentPage:j,totalPages:ae,totalItems:ue,itemsPerPage:C,onPageChange:F})]})})},cj=({students:n,value:a,onChange:t,placeholder:r="Select a student...",required:s=!1,disabled:e=!1})=>{const[u,f]=ne.useState(!1),[m,g]=ne.useState(""),[b,j]=ne.useState(-1),F=ne.useRef(null),C=ne.useRef(null),M=n.filter(Q=>{const Z=`${Q.firstName} ${Q.lastName}`.toLowerCase(),ee=`${Q.class} ${Q.section}`.toLowerCase(),se=(Q.grNo||"").toLowerCase();return Z.includes(m.toLowerCase())||ee.includes(m.toLowerCase())||se.includes(m.toLowerCase())});ne.useEffect(()=>{const Q=Z=>{F.current&&!F.current.contains(Z.target)&&(f(!1),j(-1))};return document.addEventListener("mousedown",Q),()=>{document.removeEventListener("mousedown",Q)}},[]),ne.useEffect(()=>{u&&C.current&&C.current.focus()},[u]);const _=Q=>{if(!u){(Q.key==="Enter"||Q.key===" ")&&(Q.preventDefault(),f(!0));return}switch(Q.key){case"ArrowDown":Q.preventDefault(),j(Z=>Z<M.length-1?Z+1:Z);break;case"ArrowUp":Q.preventDefault(),j(Z=>Z>0?Z-1:-1);break;case"Enter":Q.preventDefault(),b>=0&&M[b]&&L(M[b]);break;case"Escape":f(!1),j(-1);break}},L=Q=>{t(Q.id),f(!1),j(-1),g("")},T=()=>{e||(f(!u),u||g(""))},O=n.find(Q=>Q.id===a);return i.jsxs("div",{className:"relative",ref:F,children:[i.jsxs("div",{className:`flex items-center justify-between px-3 py-2 border rounded-md cursor-pointer ${e?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white hover:bg-gray-50 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"} ${u?"ring-2 ring-blue-500 border-blue-500":"border-gray-300"}`,onClick:T,onKeyDown:_,tabIndex:e?-1:0,children:[i.jsx("div",{className:"flex-1 truncate",children:O?i.jsxs("div",{className:"flex items-center",children:[i.jsxs("span",{className:"font-medium",children:[O.firstName," ",O.lastName]}),i.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["(",O.class," - ",O.section,")"]})]}):i.jsx("span",{className:"text-gray-500",children:r})}),i.jsxs("div",{className:"flex items-center ml-2",children:[O&&!e&&i.jsx("button",{type:"button",className:"text-gray-400 hover:text-gray-600 mr-1",onClick:Q=>{Q.stopPropagation(),t("")},children:i.jsx(vd,{size:12})}),i.jsx(Lb,{className:`text-gray-400 transition-transform ${u?"rotate-180":""}`,size:14})]})]}),u&&i.jsxs("div",{className:"absolute z-10 mt-1 w-full bg-white shadow-lg rounded-md border border-gray-200 max-h-60 overflow-hidden",children:[i.jsx("div",{className:"p-2 border-b border-gray-200",children:i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Bi,{className:"text-gray-400",size:14})}),i.jsx("input",{ref:C,type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"Search students...",value:m,onChange:Q=>g(Q.target.value),onKeyDown:_})]})}),i.jsx("div",{className:"overflow-y-auto max-h-48",children:M.length>0?M.map((Q,Z)=>i.jsx("div",{className:`px-4 py-2 cursor-pointer flex items-center ${Z===b?"bg-blue-100":Z%2===0?"bg-white hover:bg-gray-50":"bg-gray-50 hover:bg-gray-100"}`,onClick:()=>L(Q),onMouseEnter:()=>j(Z),children:i.jsxs("div",{children:[i.jsxs("div",{className:"font-medium text-sm",children:[Q.firstName," ",Q.lastName]}),i.jsxs("div",{className:"text-xs text-gray-500",children:["Class: ",Q.class," - Section: ",Q.section," | GR No: ",Q.grNo||"N/A"]})]})},Q.id)):i.jsxs("div",{className:"px-4 py-6 text-center text-sm text-gray-500",children:['No students found matching "',m,'"']})})]})]})},_4=({students:n,values:a=[],onChange:t,placeholder:r="Select students...",required:s=!1,disabled:e=!1})=>{const[u,f]=ne.useState(!1),[m,g]=ne.useState(""),[b,j]=ne.useState(-1),F=ne.useRef(null),C=ne.useRef(null),M=n.filter(Z=>{const ee=`${Z.firstName} ${Z.lastName}`.toLowerCase(),se=`${Z.class} ${Z.section}`.toLowerCase(),ue=(Z.grNo||"").toLowerCase();return!a.includes(Z.id)&&(ee.includes(m.toLowerCase())||se.includes(m.toLowerCase())||ue.includes(m.toLowerCase())||m==="")}),L=n.filter(Z=>a.includes(Z.id));ne.useEffect(()=>{const Z=ee=>{F.current&&!F.current.contains(ee.target)&&(f(!1),j(-1))};return document.addEventListener("mousedown",Z),()=>{document.removeEventListener("mousedown",Z)}},[]),ne.useEffect(()=>{u&&C.current&&C.current.focus()},[u]);const T=Z=>{if(!u){(Z.key==="Enter"||Z.key===" ")&&(Z.preventDefault(),f(!0));return}switch(Z.key){case"ArrowDown":Z.preventDefault(),j(ee=>ee<M.length-1?ee+1:ee);break;case"ArrowUp":Z.preventDefault(),j(ee=>ee>0?ee-1:-1);break;case"Enter":Z.preventDefault(),b>=0&&M[b]&&H(M[b]);break;case"Escape":f(!1),j(-1);break}},H=Z=>{const ee=[...a,Z.id];t(ee),g("")},O=(Z,ee)=>{ee.stopPropagation();const se=a.filter(ue=>ue!==Z);t(se)},Q=()=>{e||(f(!u),u||g(""))};return i.jsxs("div",{className:"relative",ref:F,children:[i.jsxs("div",{className:`flex flex-wrap items-center px-3 py-2 border rounded-md cursor-pointer ${e?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white hover:bg-gray-50 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"} ${u?"ring-2 ring-blue-500 border-blue-500":"border-gray-300"}`,onClick:Q,onKeyDown:T,tabIndex:e?-1:0,children:[i.jsx("div",{className:"flex flex-wrap gap-1 mr-2",children:L.map(Z=>i.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[Z.firstName," ",Z.lastName,!e&&i.jsx("button",{type:"button",className:"ml-1 text-blue-600 hover:text-blue-800",onClick:ee=>O(Z.id,ee),children:i.jsx(vd,{size:10})})]},Z.id))}),u?i.jsx("input",{ref:C,type:"text",className:"flex-1 min-w-[100px] border-0 focus:ring-0 p-0 text-sm",placeholder:L.length===0?r:"",value:m,onChange:Z=>g(Z.target.value),onKeyDown:T}):L.length===0?i.jsx("span",{className:"text-gray-500 text-sm flex-1",children:r}):null,i.jsx(Lb,{className:`text-gray-400 transition-transform ml-2 ${u?"rotate-180":""}`,size:14})]}),u&&i.jsxs("div",{className:"absolute z-10 mt-1 w-full bg-white shadow-lg rounded-md border border-gray-200 max-h-60 overflow-hidden",children:[i.jsx("div",{className:"p-2 border-b border-gray-200",children:i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Bi,{className:"text-gray-400",size:14})}),i.jsx("input",{ref:C,type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"Search students...",value:m,onChange:Z=>g(Z.target.value),onKeyDown:T})]})}),i.jsx("div",{className:"overflow-y-auto max-h-48",children:M.length>0?M.map((Z,ee)=>i.jsx("div",{className:`px-4 py-2 cursor-pointer flex items-center ${ee===b?"bg-blue-100":ee%2===0?"bg-white hover:bg-gray-50":"bg-gray-50 hover:bg-gray-100"}`,onClick:()=>H(Z),onMouseEnter:()=>j(ee),children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(xl,{className:"text-gray-400 mr-2",size:12}),i.jsxs("div",{children:[i.jsxs("div",{className:"font-medium text-sm",children:[Z.firstName," ",Z.lastName]}),i.jsxs("div",{className:"text-xs text-gray-500",children:["Class: ",Z.class," - Section: ",Z.section," | GR No: ",Z.grNo||"N/A"]})]})]})},Z.id)):i.jsxs("div",{className:"px-4 py-6 text-center text-sm text-gray-500",children:['No students found matching "',m,'"']})})]})]})},fD=()=>{const n=Pn(),{students:a}=rr(ke=>ke.students),{parents:t}=rr(ke=>ke.parents),[r,s]=ne.useState("view"),[e,u]=ne.useState(""),[f,m]=ne.useState(""),[g,b]=ne.useState(!1),[j,F]=ne.useState(!1),[C,M]=ne.useState(null),[_,L]=ne.useState({parentId:"",parentName:"",studentIds:[]}),[T,H]=ne.useState(1),O=3,Z=(()=>{const ke={};return t.forEach(he=>{ke[he.id]={familyInfo:{id:he.id,name:`${he.firstName} ${he.lastName} Family`,head:he},members:[],totalFees:0,feesPaid:0,feesPending:0}}),a.forEach(he=>{const Ne=t.find(xe=>xe.studentIds.includes(he.id));if(Ne&&ke[Ne.id])ke[Ne.id].members.push(he);else{const xe=`unknown-${he.id}`;ke[xe]||(ke[xe]={familyInfo:{id:xe,name:"Unknown Family",head:null},members:[],totalFees:0,feesPaid:0,feesPending:0}),ke[xe].members.push(he)}}),ke})(),ee=Object.values(Z).map(ke=>({id:ke.familyInfo.id,name:ke.familyInfo.name,memberCount:ke.members.length})),ue=(()=>{const ke={};return Object.entries(Z).forEach(([he,Ne])=>{const xe=Ne.members.filter(we=>(`${we.firstName||""} ${we.lastName||""}`.toLowerCase().includes(e.toLowerCase())||(we.email||"").toLowerCase().includes(e.toLowerCase())||(we.class||"").toLowerCase().includes(e.toLowerCase()))&&(!f||he===f));xe.length>0&&(ke[he]={...Ne,members:xe})}),ke})(),ae=()=>{const ke=Object.entries(ue),he=ke.length,Ne=Math.ceil(he/O);if(T>Ne&&Ne>0)return H(Ne),{families:[],totalFamilies:he,totalPages:Ne};const xe=(T-1)*O,we=xe+O,ye=ke.slice(xe,we),te={};return ye.forEach(([V,le])=>{te[V]=le}),{families:te,totalFamilies:he,totalPages:Ne}},{families:pe,totalFamilies:z,totalPages:J}=ae(),ge=ke=>{ke.preventDefault();const he=`parent-${Date.now()}`,[Ne,...xe]=_.parentName.trim().split(" "),we=xe.join(" ")||"",ye={id:he,firstName:Ne,lastName:we,email:"",phone:"",address:"",relationship:"father",studentIds:_.studentIds};n(UE(ye)),_.studentIds.forEach(te=>{const V=a.find(le=>le.id===te);V&&n(a0({id:V.id,parentId:he,familyId:he}))}),b(!1),L({parentId:"",parentName:"",studentIds:[]}),H(1)},fe=ke=>{if(ke.preventDefault(),C){const he={...C,studentIds:_.studentIds};n(ME(he)),a.forEach(Ne=>{Ne.familyId===C.id&&!_.studentIds.includes(Ne.id)?n(a0({id:Ne.id,parentId:null,familyId:null})):_.studentIds.includes(Ne.id)&&n(a0({id:Ne.id,parentId:C.id,familyId:C.id}))}),F(!1),M(null),L({parentId:"",parentName:"",studentIds:[]})}};return i.jsxs("div",{className:"bg-white shadow p-4",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Family Management"}),i.jsxs("button",{onClick:()=>b(!0),className:"inline-flex items-center px-3 py-1.5 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(xl,{className:"mr-1 h-4 w-4"}),"Add Family"]})]}),i.jsx("div",{className:"border-b border-gray-200 mb-4",children:i.jsxs("nav",{className:"-mb-px flex space-x-6",children:[i.jsxs("button",{onClick:()=>s("view"),className:`py-2 px-1 border-b-2 font-medium text-sm ${r==="view"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[i.jsx(_c,{className:"mr-1 inline"}),"View Families"]}),i.jsxs("button",{onClick:()=>s("manage"),className:`py-2 px-1 border-b-2 font-medium text-sm ${r==="manage"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[i.jsx(IA,{className:"mr-1 inline"}),"Manage Families"]})]})}),r==="view"?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"mb-4",children:i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[i.jsxs("div",{className:"relative flex-grow max-w-md",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Bi,{className:"h-4 w-4 text-gray-400"})}),i.jsx("input",{type:"text",placeholder:"Search by student name, email, or class...",value:e,onChange:ke=>u(ke.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(io,{className:"text-gray-400 h-4 w-4"}),i.jsxs("select",{value:f,onChange:ke=>m(ke.target.value),className:"block w-full pl-3 pr-10 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm",children:[i.jsx("option",{value:"",children:"All Families"}),ee.map(ke=>i.jsxs("option",{value:ke.id,children:[ke.name," (",ke.memberCount,")"]},ke.id))]})]}),i.jsx("button",{onClick:()=>{u(""),m("")},className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Clear"})]})]})}),i.jsx("div",{className:"space-y-4",children:Object.entries(pe).length>0?Object.entries(pe).map(([ke,he])=>i.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[i.jsxs("div",{className:"bg-gray-50 px-4 py-3 border-b border-gray-200",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx(_c,{className:"text-gray-600 text-lg mr-2"}),i.jsx("h3",{className:"text-base font-medium text-gray-900",children:he.familyInfo.name})]}),i.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[he.members.length," ",he.members.length===1?"Member":"Members"]})]}),he.familyInfo.head&&i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Head: ",he.familyInfo.head.firstName," ",he.familyInfo.head.lastName]})]}),i.jsx("div",{className:"p-4",children:i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:he.members.map(Ne=>i.jsx("div",{className:"border border-gray-200 rounded-lg p-3 hover:bg-gray-50 transition-colors",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx("div",{className:"bg-gray-200 border-2 border-dashed rounded-xl w-10 h-10 flex items-center justify-center flex-shrink-0",children:i.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})}),i.jsxs("div",{className:"ml-3 flex-1",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsxs("h4",{className:"text-sm font-medium text-gray-900",children:[Ne.firstName," ",Ne.lastName]}),i.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:Ne.relationship||"Family Member"})]}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["ID: ",Ne.id]}),i.jsxs("div",{className:"mt-1",children:[i.jsxs("p",{className:"text-xs text-gray-600",children:[i.jsx("span",{className:"font-medium",children:"Class:"})," ",Ne.class," - Section ",Ne.section]}),i.jsxs("p",{className:"text-xs text-gray-600",children:[i.jsx("span",{className:"font-medium",children:"Contact:"})," ",Ne.phone]})]})]})]})},Ne.id))})})]},ke)):i.jsxs("div",{className:"text-center py-8",children:[i.jsx(_c,{className:"mx-auto h-8 w-8 text-gray-400"}),i.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No family groups found"}),i.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Try adjusting your search or filter criteria"})]})}),z>O&&i.jsx("div",{className:"mt-6",children:i.jsx(Bd,{currentPage:T,totalPages:J,totalItems:z,itemsPerPage:O,paginate:ke=>H(ke)})})]}):i.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 rounded",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx(_c,{className:"h-5 w-5 text-blue-400"})}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"How to Manage Families"}),i.jsxs("div",{className:"mt-2 text-sm text-blue-700",children:[i.jsx("p",{children:"Families in this system are managed through parents who are the head of each family."}),i.jsx("p",{className:"mt-2",children:"To create a new family:"}),i.jsxs("ol",{className:"list-decimal list-inside mt-2 space-y-1",children:[i.jsx("li",{children:'Click the "Add New Family" button above'}),i.jsx("li",{children:"Enter the parent's full name (this will be the family head)"}),i.jsx("li",{children:"Select students to be part of this family"})]}),i.jsx("p",{className:"mt-2",children:"To add a student to an existing family:"}),i.jsxs("ol",{className:"list-decimal list-inside mt-2 space-y-1",children:[i.jsx("li",{children:'Click the "Edit" button for the family'}),i.jsx("li",{children:"Select additional students to add to the family"})]})]})]})]})}),g&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-4 w-full max-w-md",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Add New Family"}),i.jsxs("form",{onSubmit:ge,className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Parent Name"}),i.jsx("input",{type:"text",value:_.parentName,onChange:ke=>L({..._,parentName:ke.target.value}),className:"block w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"Enter parent's full name",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Students"}),i.jsx(_4,{students:a,values:_.studentIds,onChange:ke=>L({..._,studentIds:ke}),placeholder:"Search and select students..."})]}),i.jsxs("div",{className:"flex justify-end space-x-2 pt-3",children:[i.jsx("button",{type:"button",onClick:()=>b(!1),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),i.jsxs("button",{type:"submit",className:"inline-flex items-center px-3 py-1.5 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[i.jsx(xl,{className:"mr-1"})," Create Family"]})]})]})]})}),j&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-4 w-full max-w-md",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Edit Family"}),i.jsxs("form",{onSubmit:fe,className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Parent Name"}),i.jsx("input",{type:"text",value:_.parentName,onChange:ke=>L({..._,parentName:ke.target.value}),className:"block w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-sm",readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Students"}),i.jsx(_4,{students:a,values:_.studentIds,onChange:ke=>L({..._,studentIds:ke}),placeholder:"Search and select students..."})]}),i.jsxs("div",{className:"flex justify-end space-x-2 pt-3",children:[i.jsx("button",{type:"button",onClick:()=>F(!1),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),i.jsxs("button",{type:"submit",className:"inline-flex items-center px-3 py-1.5 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[i.jsx(IA,{className:"mr-1"})," Update Family"]})]})]})]})})]})},hD=({onAddStudent:n})=>{const{students:a}=rr(_=>_.students);console.log("Students in state:",a);const[t,r]=ne.useState("available"),[s,e]=ne.useState(""),[u,f]=ne.useState(""),[m,g]=ne.useState(""),[b,j]=ne.useState(null);[...new Set(a.map(_=>_.class))],u&&[...new Set(a.filter(_=>_.class===u).map(_=>_.section))];const C=b||(()=>{const _=a.filter(O=>O.status!=="left"&&O.status!=="passed_out"),L=a.filter(O=>O.status==="left"),T={};a.forEach(O=>{const Q=O.familyId||`unknown-${O.id}`;T[Q]||(T[Q]=[]),T[Q].push(O)});const H=Object.keys(T).length;return{available:_.length,left:L.length,families:H}})(),M=_=>{j(_.stats),_.searchTerm!==void 0&&e(_.searchTerm),_.selectedClass!==void 0&&f(_.selectedClass),_.selectedSection!==void 0&&g(_.selectedSection)};return i.jsxs(i.Fragment,{children:[i.jsx(jd,{title:"Student Management",subtitle:"Manage and view students by availability and family relationships",actionButton:i.jsxs("button",{onClick:n,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(tD,{className:"mr-2 h-4 w-4"}),"Add Student"]})}),i.jsx("div",{className:"bg-white shadow p-4",children:i.jsx("div",{className:"border-b border-gray-200",children:i.jsxs("nav",{className:"-mb-px flex flex-wrap space-x-6",children:[i.jsx("button",{onClick:()=>r("available"),className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${t==="available"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(cA,{className:"mr-2"}),"Available",i.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:C.available})]})}),i.jsx("button",{onClick:()=>r("left"),className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${t==="left"?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(Tc,{className:"mr-2"}),"Left in Middle",i.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:C.left})]})}),i.jsx("button",{onClick:()=>r("family"),className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${t==="family"?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(_c,{className:"mr-2"}),"Families",i.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:C.families})]})})]})})}),i.jsx("div",{children:t==="available"||t==="left"?i.jsx(lj,{activeTab:t,onFilterChange:M,parentSearchTerm:s,parentSelectedClass:u,parentSelectedSection:m}):i.jsx(fD,{})}),i.jsxs("div",{className:"mt-3 flex items-center text-sm text-gray-600",children:[i.jsx("span",{children:"Showing students filtered by search and class/section criteria"}),(u||m||s)&&i.jsx("button",{onClick:()=>{e(""),f(""),g("")},className:"ml-2 text-blue-600 hover:text-blue-800",children:"(Clear filters)"})]})]})},mD=()=>{const n=Pn(),a=Cd(),{students:t,loading:r,error:s}=rr(u=>u.students),{classes:e}=rr(u=>u.classes);return ne.useEffect(()=>{console.log("StudentsSection mounted, current students count:",t.length),t.length===0&&(console.log("Fetching students and classes for initial load"),n(Lc())),n(gd())},[n,t.length]),r&&t.length===0?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):s&&t.length===0?i.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),i.jsx("div",{className:"ml-3",children:i.jsxs("p",{className:"text-sm text-red-700",children:["Error: ",s]})})]})}):i.jsx(i.Fragment,{children:i.jsx(hD,{onAddStudent:()=>a("/students/admission")})})},pD=({onClose:n,onSubmit:a,expenseData:t,categories:r})=>{const[s,e]=ne.useState({description:"",amount:"",date:"",category:""}),u=!!t;ne.useEffect(()=>{t&&e(t)},[t]);const f=g=>{e({...s,[g.target.name]:g.target.value})},m=g=>{g.preventDefault(),a(s)};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-2xl w-full max-h-screen overflow-y-auto",children:[i.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:u?"Edit Expense":"Add New Expense"}),i.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-700",children:i.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"py-6 px-6",children:i.jsxs("form",{onSubmit:m,className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(f5,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"text",name:"description",value:s.description,onChange:f,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Office supplies purchase",required:!0})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(bd,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"number",name:"amount",value:s.amount,onChange:f,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"150.00",step:"0.01",required:!0})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(xd,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"date",name:"date",value:s.date,onChange:f,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(tp,{className:"h-5 w-5 text-gray-400"})}),i.jsxs("select",{name:"category",value:s.category,onChange:f,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0,children:[i.jsx("option",{value:"",children:"Select Category"}),r.map(g=>i.jsx("option",{value:g,children:g},g))]})]})]}),i.jsxs("div",{className:"md:col-span-2 flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:n,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),i.jsx("button",{type:"submit",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:u?"Update Expense":"Add Expense"})]})]})})]})})},gD=({onClose:n,onSubmit:a})=>{const[t,r]=ne.useState(""),s=e=>{e.preventDefault(),t.trim()&&a(t.trim())};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full",children:[i.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Add New Expense Category"}),i.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-700",children:i.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"py-6 px-6",children:i.jsxs("form",{onSubmit:s,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category Name"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(tp,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"text",value:t,onChange:e=>r(e.target.value),placeholder:"Enter category name",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500",required:!0})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:n,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Cancel"}),i.jsx("button",{type:"submit",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Add Category"})]})]})})]})})},xD=()=>{const n=Pn(),{expenses:a,categories:t,loading:r,error:s}=rr(xe=>xe.expenses),[e,u]=ne.useState(""),[f,m]=ne.useState("all"),[g,b]=ne.useState(!1),[j,F]=ne.useState(!1),[C,M]=ne.useState(null),[_,L]=ne.useState(1),[T]=ne.useState(10);ne.useEffect(()=>{n(O1())},[n]);const H=xe=>{M(xe),b(!0)},O=xe=>{window.confirm("Are you sure you want to delete this expense?")&&n(NC(xe))},Q=xe=>{n(C?wC({...C,...xe}):vC(xe)),b(!1),M(null)},Z=xe=>{n(CC(xe)),F(!1)},ee=()=>{const xe=[["Description","Category","Date","Amount"],...ue.map(V=>[`"${V.description.replace(/"/g,'""')}"`,V.category,V.date,V.amount])].map(V=>V.join(",")).join(`
`),we=new Blob([xe],{type:"text/csv;charset=utf-8;"}),ye=URL.createObjectURL(we),te=document.createElement("a");te.setAttribute("href",ye),te.setAttribute("download","expenses_report.csv"),te.style.visibility="hidden",document.body.appendChild(te),te.click(),document.body.removeChild(te)},se=()=>{window.print()},ue=a.filter(xe=>{const we=xe.description.toLowerCase().includes(e.toLowerCase())||xe.category.toLowerCase().includes(e.toLowerCase()),ye=f==="all"||xe.category===f;return we&&ye}),ae=xe=>L(xe),pe=()=>L(xe=>Math.min(xe+1,Math.ceil(ue.length/T))),z=()=>L(xe=>Math.max(xe-1,1)),J=_*T,ge=J-T,fe=ue.slice(ge,J),ke=Math.ceil(ue.length/T);ne.useEffect(()=>{L(1)},[ue]);const he=ue.filter(xe=>xe.category!=="Salary").reduce((xe,we)=>xe+parseFloat(we.amount),0);ue.filter(xe=>xe.category!=="Salary").reduce((xe,we)=>(xe[we.category]||(xe[we.category]={total:0,count:0}),xe[we.category].total+=parseFloat(we.amount),xe[we.category].count+=1,xe),{});const Ne=new Set(ue.filter(xe=>xe.category!=="Salary").map(xe=>xe.category)).size;return r?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):s?i.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),i.jsx("div",{className:"ml-3",children:i.jsxs("p",{className:"text-sm text-red-700",children:["Error: ",s]})})]})}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Expenses Management"}),i.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Track and manage all school expenses"})]}),i.jsxs("div",{className:"mt-4 md:mt-0 flex space-x-2",children:[i.jsxs("button",{onClick:ee,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[i.jsx(lu,{className:"mr-2"})," Export CSV"]}),i.jsxs("button",{onClick:se,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[i.jsx(mi,{className:"mr-2"})," Print"]}),i.jsxs("button",{onClick:()=>{M(null),b(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700",children:[i.jsx(xl,{className:"mr-2"})," Add Expense"]}),i.jsxs("button",{onClick:()=>F(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700",children:[i.jsx(xl,{className:"mr-2"})," Add Category"]})]})]}),i.jsx("div",{className:"my-4",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl shadow p-4 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-blue-100 text-xs font-medium",children:"Total Expenses"}),i.jsxs("p",{className:"text-2xl font-bold mt-1",children:["Rs ",Math.round(he)]})]}),i.jsx("div",{className:"p-2 bg-blue-400 bg-opacity-30 rounded-full",children:i.jsx(bd,{size:20})})]})}),i.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-xl shadow p-4 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-green-100 text-xs font-medium",children:"Categories"}),i.jsx("p",{className:"text-2xl font-bold mt-1",children:Ne})]}),i.jsx("div",{className:"p-2 bg-green-400 bg-opacity-30 rounded-full",children:i.jsx(tp,{size:20})})]})}),i.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl shadow p-4 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-purple-100 text-xs font-medium",children:"Total Records"}),i.jsx("p",{className:"text-2xl font-bold mt-1",children:ue.length})]}),i.jsx("div",{className:"p-2 bg-purple-400 bg-opacity-30 rounded-full",children:i.jsx(wh,{size:20})})]})})]})}),i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Expense Records"}),i.jsx("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[i.jsxs("div",{className:"relative flex-grow max-w-md",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Bi,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"text",placeholder:"Search by description...",value:e,onChange:xe=>u(xe.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(tp,{className:"text-gray-400"}),i.jsxs("select",{value:f,onChange:xe=>m(xe.target.value),className:"block w-full pl-3 pr-10 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"all",children:"All Categories"}),t.map(xe=>i.jsx("option",{value:xe,children:xe},xe))]})]}),i.jsx("div",{className:"flex items-center space-x-2",children:i.jsx("button",{onClick:()=>{u(""),m("all")},className:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Clear Filters"})})]})]})}),i.jsxs("div",{className:"overflow-hidden rounded-lg border border-gray-200",children:[i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:fe.map(xe=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("div",{className:"text-sm font-medium text-gray-900",children:xe.description})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("div",{className:"text-sm text-gray-900",children:xe.category})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("div",{className:"text-sm text-gray-900",children:new Date(xe.date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["Rs ",Math.round(xe.amount)]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:i.jsxs("div",{className:"flex justify-end space-x-2",children:[i.jsxs("button",{onClick:()=>H(xe),className:"inline-flex items-center px-3 py-1 border border-transparent rounded-lg text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700",children:[i.jsx(IA,{className:"mr-1"})," Edit"]}),i.jsxs("button",{onClick:()=>O(xe.id),className:"inline-flex items-center px-3 py-1 border border-transparent rounded-lg text-sm font-medium text-white bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700",children:[i.jsx(cu,{className:"mr-1"})," Delete"]})]})})]},xe.id))})]}),ue.length===0&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(bd,{className:"mx-auto h-12 w-12 text-gray-400"}),i.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No expenses found"}),i.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Try adjusting your search or filter criteria"})]}),i.jsx(Bd,{currentPage:_,totalPages:ke,itemsPerPage:T,totalItems:ue.length,paginate:ae,nextPage:pe,prevPage:z})]})]})]}),g&&i.jsx(pD,{expenseData:C,categories:t,onSubmit:Q,onClose:()=>{b(!1),M(null)}}),j&&i.jsx(gD,{onSubmit:Z,onClose:()=>F(!1)})]})},bD=({onClose:n,onSubmit:a,staffData:t,classes:r})=>{const s=ne.useRef(null),[e,u]=ne.useState({firstName:"",lastName:"",contactNumber:"",position:"",salary:"",dateOfJoining:"",jobType:"Teaching",subject:"",photo:null}),[f,m]=ne.useState(null),[g,b]=ne.useState(null),j=!!t;ne.useEffect(()=>{if(t)u({...t,contactNumber:t.contactNumber||t.phone||"",jobType:t.position&&(t.position.toLowerCase().includes("teacher")||t.position.toLowerCase().includes("professor"))?"Teaching":"Non-Teaching",subject:t.subject||""}),t.photo&&m(t.photo);else{const H=new Date().toISOString().split("T")[0];u(O=>({...O,dateOfJoining:H}))}},[t]);const F=async H=>{const O=H.target.files[0];if(O){if(!O.type.startsWith("image/")){alert("Please select an image file (JPEG, PNG, etc.)");return}if(O.size>5*1024*1024){alert("File size exceeds 5MB limit");return}b(O);const Q=new FileReader;Q.onloadend=()=>{m(Q.result)},Q.readAsDataURL(O)}},C=()=>{m(null),b(null),s.current&&(s.current.value="")},M=async H=>{H.preventDefault();let O=f||"";if(g){const Z=new FormData;Z.append("photo",g);try{const ee=await fetch(`${dr}/photos`,{method:"POST",body:Z});if(!ee.ok)throw new Error(`HTTP error! status: ${ee.status}`);const se=await ee.json();if(se.success)O=se.url;else{console.error("Photo upload failed:",se.error),alert("Failed to upload photo: "+se.error);return}}catch(ee){console.error("Photo upload error:",ee),alert("Failed to upload photo. Please try again. Error: "+ee.message);return}}else f?f.startsWith("http")?O=f:f.startsWith("data:")&&(O=""):O="";const Q={...e,jobType:e.jobType,subject:e.jobType==="Teaching"?e.subject:null,position:e.jobType==="Teaching"?e.subject?`${e.subject} Teacher`:"Teacher":e.position,photo:O};a(Q)},_=H=>{const{name:O,value:Q}=H.target;u({...e,[O]:Q}),O==="jobType"&&Q==="Non-Teaching"&&u(Z=>({...Z,subject:""}))},T=(()=>{if(!r||!Array.isArray(r))return[];const H=new Set;return r.forEach(O=>{O.subjects&&Array.isArray(O.subjects)&&O.subjects.forEach(Q=>{Q.name&&H.add(Q.name)})}),Array.from(H).sort()})();return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-4 py-3 flex justify-between items-center",children:[i.jsx("h3",{className:"text-lg font-bold text-gray-900",children:j?"Edit Staff Member":"Add New Staff Member"}),i.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-700",children:i.jsx(vd,{className:"h-5 w-5"})})]}),i.jsx("div",{className:"p-4",children:i.jsxs("form",{onSubmit:M,className:"space-y-4",children:[i.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Staff Photo"}),i.jsxs("div",{className:"flex items-start space-x-4",children:[i.jsx("div",{className:"flex-shrink-0",children:f?i.jsx("img",{src:f,alt:"Staff Preview",className:"h-20 w-20 rounded-lg object-cover border border-gray-300"}):i.jsx("div",{className:"bg-gray-200 border border-dashed border-gray-300 rounded-lg w-20 h-20 flex items-center justify-center",children:i.jsx(ep,{className:"h-5 w-5 text-gray-400"})})}),i.jsxs("div",{className:"flex flex-col space-y-2",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("input",{type:"file",ref:s,onChange:F,accept:"image/*",className:"hidden",id:"photo-upload"}),i.jsxs("button",{type:"button",onClick:()=>s.current?.click(),className:"inline-flex items-center px-2.5 py-1 text-xs font-medium rounded-lg text-gray-700 bg-white border border-gray-300 hover:bg-gray-50 focus:outline-none focus:ring-1 focus:ring-offset-1 focus:ring-blue-500","aria-describedby":"photo-upload-help",children:[i.jsx(ep,{className:"mr-1 h-3 w-3"}),f?"Change Photo":"Upload Photo"]}),i.jsx("p",{id:"photo-upload-help",className:"text-xs text-gray-500 mt-1",children:"JPEG, PNG up to 5MB"})]}),f&&i.jsxs("button",{type:"button",onClick:C,className:"inline-flex items-center px-2.5 py-1 text-xs font-medium rounded-lg text-red-700 bg-white border border-gray-300 hover:bg-red-50 focus:outline-none focus:ring-1 focus:ring-offset-1 focus:ring-red-500",children:[i.jsx(cu,{className:"mr-1 h-3 w-3"}),"Remove Photo"]})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Full Name"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:i.jsx(Pi,{className:"h-4 w-4 text-gray-400"})}),i.jsx("input",{type:"text",name:"firstName",value:e.firstName,onChange:_,className:"block w-full pl-7 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"First Name",required:!0})]}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:i.jsx(Pi,{className:"h-4 w-4 text-gray-400"})}),i.jsx("input",{type:"text",name:"lastName",value:e.lastName,onChange:_,className:"block w-full pl-7 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Last Name",required:!0})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Phone"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:i.jsx(h5,{className:"h-4 w-4 text-gray-400"})}),i.jsx("input",{type:"tel",name:"contactNumber",value:e.contactNumber,onChange:_,className:"block w-full pl-7 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"+1 (555) 123-4567"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Salary"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:i.jsx(Co,{className:"h-4 w-4 text-gray-400"})}),i.jsx("input",{type:"number",name:"salary",value:e.salary,onChange:_,className:"block w-full pl-7 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"4000",required:!0})]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Job Type"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:i.jsx(tg,{className:"h-4 w-4 text-gray-400"})}),i.jsxs("select",{name:"jobType",value:e.jobType,onChange:_,className:"block w-full pl-7 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 appearance-none",required:!0,children:[i.jsx("option",{value:"Teaching",children:"Teaching"}),i.jsx("option",{value:"Non-Teaching",children:"Non-Teaching"})]})]})]}),e.jobType==="Teaching"&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Subject Name"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:i.jsx(up,{className:"h-4 w-4 text-gray-400"})}),i.jsxs("select",{name:"subject",value:e.subject,onChange:_,className:"block w-full pl-7 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 appearance-none",required:!0,children:[i.jsx("option",{value:"",children:"Select Subject"}),T.map(H=>i.jsx("option",{value:H,children:H},H))]})]})]}),e.jobType==="Non-Teaching"&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Position"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:i.jsx(tg,{className:"h-4 w-4 text-gray-400"})}),i.jsx("input",{type:"text",name:"position",value:e.position,onChange:_,className:"block w-full pl-7 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Accountant",required:!0})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Date of Joining"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:i.jsx(xd,{className:"h-4 w-4 text-gray-400"})}),i.jsx("input",{type:"date",name:"dateOfJoining",value:e.dateOfJoining,onChange:_,className:"block w-full pl-7 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0})]})]})]})]}),i.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[i.jsx("button",{type:"button",onClick:n,className:"inline-flex items-center px-3 py-1.5 text-xs font-medium rounded-lg text-gray-700 bg-white border border-gray-300 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-blue-500",children:"Cancel"}),i.jsx("button",{type:"submit",className:"inline-flex items-center px-3 py-1.5 text-xs font-medium rounded-lg text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-blue-500",children:j?"Update Staff":"Add Staff"})]})]})})]})})},yD=({staffMember:n,onClose:a,onAddAdvance:t,onPaySalary:r})=>{const[s,e]=ne.useState(""),[u,f]=ne.useState("advance"),[m,g]=ne.useState(""),[b,j]=ne.useState(new Date().toISOString().slice(0,7)),[F,C]=ne.useState("cash"),M=()=>{const L=parseFloat(n.salary||0),T=(n.allowances||[]).reduce((H,O)=>H+parseFloat(O.amount||0),0);return L+T},_=L=>{L.preventDefault(),u==="advance"?s&&m&&(t({staffId:n.id,advanceAmount:s,reason:m}),a()):b&&F&&(r({staffId:n.id,month:b,paymentMethod:F}),a())};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 w-full max-w-md",children:[i.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:["Add Payment - ",n.firstName," ",n.lastName]}),i.jsxs("form",{onSubmit:_,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount Type"}),i.jsxs("select",{value:u,onChange:L=>f(L.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"advance",children:"Advance"}),i.jsx("option",{value:"salary",children:"Salary"})]})]}),u==="advance"?i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Co,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"number",value:s,onChange:L=>e(L.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter advance amount",required:!0})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason"}),i.jsx("input",{type:"text",value:m,onChange:L=>g(L.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Reason for advance",required:!0})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Monthly Salary"}),i.jsxs("p",{className:"text-lg font-bold text-gray-900",children:["Rs ",M().toFixed(2)]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Salary Month"}),i.jsx("input",{type:"month",value:b,onChange:L=>j(L.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method"}),i.jsxs("select",{value:F,onChange:L=>C(L.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"bank",children:"Bank Transfer"}),i.jsx("option",{value:"cheque",children:"Cheque"})]})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:a,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),i.jsx("button",{type:"submit",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:u==="advance"?"Add Advance":"Pay Salary"})]})]})]})})},vD=({staffMember:n,onClose:a,classes:t})=>{const r=new Date(n.dateOfJoining);let f=(new Date().getTime()-r.getTime())/(1e3*3600*24)/30;f=Math.max(0,f);const m=f,g=(n.allowances||[]).reduce((T,H)=>T+parseFloat(H.amount||0),0),b=parseFloat(n.salary||0)+g,j=(n.salaryHistory||[]).reduce((T,H)=>T+(H.status==="advance"?Math.abs(parseFloat(H.netSalary||0)):0),0),F=(n.salaryHistory||[]).reduce((T,H)=>H.status==="paid"||H.status==="advance"?T+Math.abs(parseFloat(H.netSalary||0)):T,0),C=(()=>{const T=new Date(n.dateOfJoining);let Z=(new Date().getTime()-T.getTime())/(1e3*3600*24)/30;Z=Math.max(0,Z);const ee=(n.allowances||[]).reduce((ue,ae)=>ue+parseFloat(ae.amount||0),0),se=parseFloat(n.salary||0)+ee;return Z*se})(),M=C-F,L=(T=>{const H=[],O=T.split(" "),Q=O[0]||"",Z=O[O.length-1]||"";return t.forEach(ee=>{const se=ee.subjects.filter(ue=>{if(!ue.teacher)return!1;const ae=ue.teacher.toLowerCase(),pe=T.toLowerCase(),z=Q.toLowerCase(),J=Z.toLowerCase();return ae.includes(z)||ae.includes(J)||ae.includes(pe)});se.length>0&&H.push({className:ee.name,subjects:se.map(ue=>ue.name)})}),H})(`${n.firstName} ${n.lastName}`);return L.length===0&&n.subject&&t.forEach(T=>{T.subjects.find(O=>O.name.toLowerCase()===n.subject.toLowerCase())&&(L.some(Q=>Q.className===T.name)||L.push({className:T.name,subjects:[n.subject]}))}),i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-4 py-3 flex justify-between items-center",children:[i.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Staff Details"}),i.jsx("button",{onClick:a,className:"text-gray-500 hover:text-gray-700",children:i.jsx(vd,{className:"h-5 w-5"})})]}),i.jsx("div",{className:"p-4",children:i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"lg:col-span-1 bg-white rounded-lg shadow p-3",children:[i.jsxs("div",{className:"flex flex-col items-center mb-3",children:[n.photo?i.jsx("img",{src:n.photo,alt:`${n.firstName} ${n.lastName}`,className:"h-20 w-20 rounded-lg object-cover border border-gray-300 mb-2"}):i.jsx("div",{className:"bg-gray-200 border border-dashed rounded-lg w-20 h-20 mb-2 flex items-center justify-center",children:i.jsx(ep,{className:"h-8 w-8 text-gray-400"})}),i.jsxs("h3",{className:"text-base font-bold text-gray-900",children:[n.firstName," ",n.lastName]}),i.jsx("p",{className:"text-gray-600 text-sm",children:n.position}),n.subject&&i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Subject: ",n.subject]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center text-xs",children:[i.jsx(Pi,{className:"text-gray-400 mr-2"}),i.jsxs("span",{className:"text-gray-600",children:["ID: ",n.id]})]}),i.jsxs("div",{className:"flex items-center text-xs",children:[i.jsx(h5,{className:"text-gray-400 mr-2"}),i.jsx("span",{className:"text-gray-600",children:n.contactNumber||"N/A"})]}),i.jsxs("div",{className:"flex items-center text-xs",children:[i.jsx(xd,{className:"text-gray-400 mr-2"}),i.jsxs("span",{className:"text-gray-600",children:["Joined: ",new Date(n.dateOfJoining).toLocaleDateString()]})]}),i.jsxs("div",{className:"flex items-center text-xs",children:[i.jsx(Co,{className:"text-gray-400 mr-2"}),i.jsxs("span",{className:"text-gray-600",children:["Salary: Rs ",Math.round(n.salary||0)]})]}),i.jsxs("div",{className:"flex items-center text-xs",children:[i.jsx(tg,{className:"text-gray-400 mr-2"}),i.jsxs("span",{className:"text-gray-600",children:["Job Type: ",n.jobType||"Teaching"]})]})]}),i.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-200",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Classes Teaching"}),L.length>0?i.jsx("div",{className:"space-y-2",children:L.map((T,H)=>i.jsxs("div",{className:"border border-gray-200 rounded p-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx(up,{className:"text-gray-400 mr-1 text-xs"}),i.jsx("h5",{className:"font-medium text-gray-900 text-xs",children:T.className})]}),i.jsxs("div",{className:"mt-1",children:[i.jsx("p",{className:"text-xs text-gray-600",children:"Subjects:"}),i.jsx("p",{className:"text-xs text-gray-900",children:T.subjects.join(", ")})]})]},H))}):i.jsx("p",{className:"text-gray-500 text-xs",children:"No classes assigned"})]})]}),i.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[i.jsxs("div",{className:"bg-white rounded-lg shadow p-3",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Financial Summary"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{className:"bg-blue-50 rounded p-2",children:[i.jsx("p",{className:"text-xs text-gray-600",children:"Monthly Salary"}),i.jsxs("p",{className:"text-sm font-bold text-gray-900",children:["Rs ",Math.round(b)]})]}),i.jsxs("div",{className:"bg-yellow-50 rounded p-2",children:[i.jsx("p",{className:"text-xs text-gray-600",children:"Advances Taken"}),i.jsxs("p",{className:"text-sm font-bold text-gray-900",children:["Rs ",Math.round(j)]})]}),i.jsxs("div",{className:"bg-green-50 rounded p-2",children:[i.jsx("p",{className:"text-xs text-gray-600",children:"Total Paid"}),i.jsxs("p",{className:"text-sm font-bold text-gray-900",children:["Rs ",Math.round(F)]})]}),i.jsxs("div",{className:`rounded p-2 ${M>0?"bg-red-50":M<0?"bg-yellow-50":"bg-green-50"}`,children:[i.jsx("p",{className:"text-xs text-gray-600",children:M>0?"Amount Due":M<0?"Advance Balance":"Account Settled"}),i.jsxs("p",{className:`text-sm font-bold ${M>0?"text-red-600":M<0?"text-yellow-600":"text-green-600"}`,children:["Rs ",M!==0?Math.abs(Math.round(M)):"0",M>0?" (Due)":M<0?" (Advance)":""]})]})]}),i.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Payroll Details"}),i.jsx("div",{className:"grid grid-cols-1 gap-3",children:i.jsxs("div",{className:"flex justify-between items-center bg-gray-50 p-3 rounded-lg",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-gray-600 text-sm",children:"Worked Months"}),i.jsx("p",{className:"font-bold text-gray-900 text-lg",children:m.toFixed(1)})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-gray-600 text-sm",children:"Expected Earnings"}),i.jsxs("p",{className:"font-bold text-green-600 text-lg",children:["Rs ",Math.round(C)]})]})]})})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-3",children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Salary History"}),n.salaryHistory&&n.salaryHistory.length>0?i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-xs",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-2 py-1 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Month"}),i.jsx("th",{className:"px-2 py-1 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),i.jsx("th",{className:"px-2 py-1 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),i.jsx("th",{className:"px-2 py-1 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),i.jsx("th",{className:"px-2 py-1 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.salaryHistory.map((T,H)=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-2 py-1 whitespace-nowrap text-gray-900",children:T.month}),i.jsx("td",{className:"px-2 py-1 whitespace-nowrap text-gray-900",children:T.status==="advance"?"Advance":"Salary"}),i.jsxs("td",{className:"px-2 py-1 whitespace-nowrap text-gray-900",children:["Rs ",Math.round(Math.abs(T.netSalary))]}),i.jsx("td",{className:"px-2 py-1 whitespace-nowrap",children:i.jsx("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium ${T.status==="paid"?"bg-green-100 text-green-800":T.status==="advance"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:T.status.charAt(0).toUpperCase()+T.status.slice(1)})}),i.jsx("td",{className:"px-2 py-1 whitespace-nowrap text-gray-900",children:T.paymentDate?new Date(T.paymentDate).toLocaleDateString():"N/A"})]},H))})]})}):i.jsx("p",{className:"text-gray-500 text-xs",children:"No salary history available"})]})]})]})})]})})},wD=()=>{const n=Pn();Cd();const{staff:a,loading:t,error:r}=rr(G=>G.staff),{classes:s}=rr(G=>G.classes),[e,u]=ne.useState(""),[f,m]=ne.useState(!1),[g,b]=ne.useState(!1),[j,F]=ne.useState(!1),[C,M]=ne.useState(null),[_,L]=ne.useState(null),[T,H]=ne.useState(null),[O,Q]=ne.useState(1),[Z]=ne.useState(10);At.useEffect(()=>{n(uh()),n(gd())},[n]);const ee=G=>{M(G),m(!0)},se=G=>{window.confirm("Are you sure you want to delete this staff member?")&&n(FC(G))},ue=G=>{n(C?SC({...C,...G}):BC(G)),m(!1),M(null)},ae=G=>{L(G),b(!0)},pe=G=>{H(G),F(!0)},z=G=>{n(EC(G))},J=G=>{n(kC(G))},ge=G=>{u(G.target.value),Q(1)},fe=()=>{u(""),Q(1)},ke=()=>{const G=[["Name","Position","Subject","Salary","Allowances","Total Monthly","Date of Joining","Phone","Email"],...Ne.map(Qe=>{const Ge=(Qe.allowances||[]).reduce((Me,Se)=>Me+parseFloat(Se.amount||0),0),je=parseFloat(Qe.salary||0)+Ge;return[`"${Qe.firstName} ${Qe.lastName}"`,Qe.position,Qe.subject||"",Qe.salary||0,Ge,je,Qe.dateOfJoining,Qe.phone||"",Qe.email||""]})].map(Qe=>Qe.join(",")).join(`
`),q=new Blob([G],{type:"text/csv;charset=utf-8;"}),ve=URL.createObjectURL(q),Fe=document.createElement("a");Fe.setAttribute("href",ve),Fe.setAttribute("download","staff_report.csv"),Fe.style.visibility="hidden",document.body.appendChild(Fe),Fe.click(),document.body.removeChild(Fe)},he=()=>{window.print()},Ne=a.filter(G=>G.firstName&&G.firstName.toLowerCase().includes(e.toLowerCase())||G.lastName&&G.lastName.toLowerCase().includes(e.toLowerCase())||G.position&&G.position.toLowerCase().includes(e.toLowerCase())).sort((G,q)=>new Date(q.dateOfJoining)-new Date(G.dateOfJoining)),xe=a.reduce((G,q)=>{const ve=(q.allowances||[]).reduce((Fe,Qe)=>Fe+parseFloat(Qe.amount||0),0);return G+parseFloat(q.salary||0)+ve},0),we=a.reduce((G,q)=>{const Fe=(q.salaryHistory||[]).reduce((Qe,Ge)=>Qe+(Ge.status==="advance"?Math.abs(parseFloat(Ge.netSalary||0)):0),0);return G+Fe},0),ye=a.reduce((G,q)=>{const Fe=(q.salaryHistory||[]).reduce((Qe,Ge)=>Ge.status==="paid"||Ge.status==="advance"?Qe+Math.abs(parseFloat(Ge.netSalary||0)):Qe,0);return G+Fe},0),V=a.reduce((G,q)=>{const ve=new Date(q.dateOfJoining);let je=(new Date().getTime()-ve.getTime())/(1e3*3600*24)/30;je=Math.max(0,je);const Me=(q.allowances||[]).reduce((ft,jt)=>ft+parseFloat(jt.amount||0),0),Se=parseFloat(q.salary||0)+Me;return G+je*Se},0)-ye,le=O*Z,de=le-Z,X=Ne.slice(de,le),ie=Math.ceil(Ne.length/Z);return t?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):r?i.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),i.jsx("div",{className:"ml-3",children:i.jsxs("p",{className:"text-sm text-red-700",children:["Error: ",r]})})]})}):i.jsxs(i.Fragment,{children:[i.jsx(jd,{title:"Staff Management",subtitle:"Manage staff members, positions, and salaries",actionButton:i.jsxs("div",{className:"flex space-x-2",children:[i.jsxs("button",{onClick:ke,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[i.jsx(lu,{className:"mr-2"})," Export CSV"]}),i.jsxs("button",{onClick:he,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[i.jsx(mi,{className:"mr-2"})," Print"]}),i.jsxs("button",{onClick:()=>{M(null),m(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200",children:[i.jsx(xl,{className:"mr-2"})," Add Staff"]})]})}),i.jsx("div",{className:"my-4",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:[i.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl shadow p-4 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-blue-100 text-xs font-medium",children:"Total Staff"}),i.jsx("p",{className:"text-2xl font-bold mt-1",children:a.length})]}),i.jsx("div",{className:"p-2 bg-blue-400 bg-opacity-30 rounded-full",children:i.jsx(up,{size:20})})]})}),i.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-xl shadow p-4 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-green-100 text-xs font-medium",children:"Monthly Payroll"}),i.jsxs("p",{className:"text-2xl font-bold mt-1",children:["Rs ",Math.round(xe)]})]}),i.jsx("div",{className:"p-2 bg-green-400 bg-opacity-30 rounded-full",children:i.jsx(Co,{size:20})})]})}),i.jsx("div",{className:"bg-gradient-to-r from-yellow-500 to-yellow-600 rounded-xl shadow p-4 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-yellow-100 text-xs font-medium",children:"Advances Taken"}),i.jsxs("p",{className:"text-2xl font-bold mt-1",children:["Rs ",Math.round(we)]})]}),i.jsx("div",{className:"p-2 bg-yellow-400 bg-opacity-30 rounded-full",children:i.jsx(bd,{size:20})})]})}),i.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl shadow p-4 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-purple-100 text-xs font-medium",children:"Total Pending"}),i.jsxs("p",{className:"text-2xl font-bold mt-1",children:["Rs ",Math.round(V)]})]}),i.jsx("div",{className:"p-2 bg-purple-400 bg-opacity-30 rounded-full",children:i.jsx(tg,{size:20})})]})}),i.jsx("div",{className:"bg-gradient-to-r from-teal-500 to-teal-600 rounded-xl shadow p-4 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-teal-100 text-xs font-medium",children:"Total Paid Ever"}),i.jsxs("p",{className:"text-2xl font-bold mt-1",children:["Rs ",Math.round(ye)]})]}),i.jsx("div",{className:"p-2 bg-teal-400 bg-opacity-30 rounded-full",children:i.jsx(Co,{size:20})})]})})]})}),i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[i.jsx("div",{className:"p-6",children:i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:[i.jsxs("div",{className:"relative flex-grow max-w-md",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Bi,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"text",placeholder:"Search by name or position...",value:e,onChange:ge,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),i.jsx("div",{className:"flex items-center space-x-2",children:i.jsx("button",{onClick:fe,className:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Clear Filters"})})]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Staff"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Position"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Salary"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Joined"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:X.length>0?X.map(G=>{const q=(G.allowances||[]).reduce((Fe,Qe)=>Fe+parseFloat(Qe.amount||0),0),ve=parseFloat(G.salary||0)+q;return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center",children:[G.photo?i.jsx("img",{src:G.photo,alt:`${G.firstName} ${G.lastName}`,className:"h-10 w-10 rounded-lg object-cover border border-gray-300"}):i.jsx("div",{className:"bg-gray-200 border-2 border-dashed rounded-xl w-10 h-10 flex items-center justify-center",children:i.jsx(ep,{className:"h-5 w-5 text-gray-400"})}),i.jsxs("div",{className:"ml-4",children:[i.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[G.firstName," ",G.lastName]}),i.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",G.id]})]})]})}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[i.jsx("div",{className:"text-sm text-gray-900",children:G.position}),G.subject&&i.jsxs("div",{className:"text-sm text-gray-500",children:["Subject: ",G.subject]})]}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[i.jsxs("div",{className:"text-sm text-gray-900",children:["Rs ",Math.round(ve)]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:(()=>{const Fe=new Date(G.dateOfJoining);let Me=(new Date().getTime()-Fe.getTime())/(1e3*3600*24)/30;Me=Math.max(0,Me);const Se=G.salaryHistory?G.salaryHistory.filter(jt=>jt.status==="paid"||jt.status==="advance").length:0,ft=Me-Se;return i.jsxs("div",{className:"flex items-center",children:[i.jsxs("span",{children:[Me.toFixed(1)," worked"]}),i.jsx("span",{className:"mx-1",children:""}),i.jsxs("span",{children:[Se," paid"]}),ft>0&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"mx-1",children:""}),i.jsxs("span",{className:"text-red-600 font-medium",children:[ft.toFixed(1)," pending"]})]})]})})()})]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(G.dateOfJoining).toLocaleDateString()}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:i.jsxs("div",{className:"flex space-x-2",children:[i.jsxs("button",{onClick:()=>pe(G),className:"inline-flex items-center px-3 py-1 border border-gray-300 rounded-md text-sm font-medium text-blue-700 bg-white hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",title:"View Details",children:[i.jsx(Pi,{className:"mr-1"}),"View"]}),i.jsxs("button",{onClick:()=>ae(G),className:"inline-flex items-center px-3 py-1 border border-gray-300 rounded-md text-sm font-medium text-green-700 bg-white hover:bg-green-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",title:"Manage Finances",children:[i.jsx(Co,{className:"mr-1"}),"Finance"]}),i.jsxs("button",{onClick:()=>ee(G),className:"inline-flex items-center px-3 py-1 border border-gray-300 rounded-md text-sm font-medium text-indigo-700 bg-white hover:bg-indigo-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",title:"Edit",children:[i.jsx(IA,{className:"mr-1"}),"Edit"]}),i.jsxs("button",{onClick:()=>se(G.id),className:"inline-flex items-center px-3 py-1 border border-gray-300 rounded-md text-sm font-medium text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",title:"Delete",children:[i.jsx(cu,{className:"mr-1"}),"Delete"]})]})})]},G.id)}):i.jsx("tr",{children:i.jsx("td",{colSpan:"5",className:"px-6 py-4 text-center text-sm text-gray-500",children:"No staff members found"})})})]})}),Ne.length>Z&&i.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:i.jsx(Bd,{currentPage:O,totalPages:ie,totalItems:Ne.length,itemsPerPage:Z,paginate:G=>Q(G)})})]}),f&&i.jsx(bD,{onClose:()=>{m(!1),M(null)},onSubmit:ue,staffData:C,classes:s}),g&&_&&i.jsx(yD,{staffMember:_,onClose:()=>{b(!1),L(null)},onAddAdvance:z,onPaySalary:J}),j&&T&&i.jsx(vD,{staffMember:T,onClose:()=>{F(!1),H(null)},classes:s})]})},ND=()=>{const{id:n}=dk(),a=Cd(),{staff:t,loading:r,error:s}=rr(Q=>Q.staff),{classes:e}=rr(Q=>Q.classes),u=t.find(Q=>Q.id===n);if(r)return i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})});if(s)return i.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),i.jsx("div",{className:"ml-3",children:i.jsxs("p",{className:"text-sm text-red-700",children:["Error: ",s]})})]})});if(!u)return i.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-yellow-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),i.jsx("div",{className:"ml-3",children:i.jsx("p",{className:"text-sm text-yellow-700",children:"Staff member not found."})})]})});const f=new Date(u.dateOfJoining);let j=(new Date().getTime()-f.getTime())/(1e3*3600*24)/30;j=Math.max(0,j);const F=j,C=(u.allowances||[]).reduce((Q,Z)=>Q+parseFloat(Z.amount||0),0),M=parseFloat(u.salary||0)+C,_=(u.salaryHistory||[]).reduce((Q,Z)=>Q+(Z.status==="advance"?Math.abs(parseFloat(Z.netSalary||0)):0),0),L=(u.salaryHistory||[]).reduce((Q,Z)=>Z.status==="paid"||Z.status==="advance"?Q+Math.abs(parseFloat(Z.netSalary||0)):Q,0),T=F*M-L,O=(Q=>{const Z=[],ee=Q.split(" "),se=ee[0]||"",ue=ee[ee.length-1]||"";return e.forEach(ae=>{const pe=ae.subjects.filter(z=>{if(!z.teacher)return!1;const J=z.teacher.toLowerCase(),ge=Q.toLowerCase(),fe=se.toLowerCase(),ke=ue.toLowerCase();return J.includes(fe)||J.includes(ke)||J.includes(ge)});pe.length>0&&Z.push({className:ae.name,subjects:pe.map(z=>z.name)})}),Z})(`${u.firstName} ${u.lastName}`);return O.length===0&&u.subject&&e.forEach(Q=>{Q.subjects.find(ee=>ee.name.toLowerCase()===u.subject.toLowerCase())&&(O.some(se=>se.className===Q.name)||O.push({className:Q.name,subjects:[u.subject]}))}),t.reduce((Q,Z)=>{const ee=new Date(Z.dateOfJoining);let pe=(new Date().getTime()-ee.getTime())/(1e3*3600*24)/30;pe=Math.max(0,pe);const z=(Z.allowances||[]).reduce((ge,fe)=>ge+parseFloat(fe.amount||0),0),J=parseFloat(Z.salary||0)+z;return Q+pe*J},0),i.jsxs(i.Fragment,{children:[i.jsx(jd,{title:"Staff Details",subtitle:`Detailed information for ${u.firstName} ${u.lastName}`,actionButton:i.jsxs("button",{onClick:()=>a("/staff"),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200",children:[i.jsx(o5,{className:"mr-2"})," Back to Staff"]})}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[i.jsxs("div",{className:"lg:col-span-1 bg-white rounded-2xl shadow-lg p-6",children:[i.jsxs("div",{className:"flex flex-col items-center mb-6",children:[i.jsx("div",{className:"bg-gray-200 border-2 border-dashed rounded-xl w-24 h-24 mb-4"}),i.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:[u.firstName," ",u.lastName]}),i.jsx("p",{className:"text-gray-600",children:u.position}),u.subject&&i.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Subject: ",u.subject]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center text-sm",children:[i.jsx(Pi,{className:"text-gray-400 mr-3"}),i.jsxs("span",{className:"text-gray-600",children:["ID: ",u.id]})]}),i.jsxs("div",{className:"flex items-center text-sm",children:[i.jsx(h5,{className:"text-gray-400 mr-3"}),i.jsx("span",{className:"text-gray-600",children:u.contactNumber||"N/A"})]}),i.jsxs("div",{className:"flex items-center text-sm",children:[i.jsx(xd,{className:"text-gray-400 mr-3"}),i.jsxs("span",{className:"text-gray-600",children:["Joined: ",new Date(u.dateOfJoining).toLocaleDateString()]})]}),i.jsxs("div",{className:"flex items-center text-sm",children:[i.jsx(Co,{className:"text-gray-400 mr-3"}),i.jsxs("span",{className:"text-gray-600",children:["Salary: Rs ",Math.round(u.salary||0)]})]}),i.jsxs("div",{className:"flex items-center text-sm",children:[i.jsx(tg,{className:"text-gray-400 mr-3"}),i.jsxs("span",{className:"text-gray-600",children:["Job Type: ",u.jobType||"Teaching"]})]})]})]}),i.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[i.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Financial Summary"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Monthly Salary"}),i.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["Rs ",Math.round(M)]})]}),i.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Advances Taken"}),i.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["Rs ",Math.round(_)]})]}),i.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Total Paid"}),i.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["Rs ",Math.round(L)]})]}),i.jsxs("div",{className:`rounded-lg p-4 ${T>0?"bg-red-50":"bg-green-50"}`,children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Pending Amount"}),i.jsxs("p",{className:`text-xl font-bold ${T>0?"text-red-600":"text-green-600"}`,children:["Rs ",Math.round(Math.abs(T)),T>0?" (Due)":" (Paid)"]})]})]})]}),i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[i.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Classes Teaching"}),O.length>0?i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:O.map((Q,Z)=>i.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx(up,{className:"text-gray-400 mr-2"}),i.jsx("h5",{className:"font-medium text-gray-900",children:Q.className})]}),i.jsxs("div",{className:"mt-2",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Subjects:"}),i.jsx("p",{className:"text-sm text-gray-900",children:Q.subjects.join(", ")})]})]},Z))}):i.jsx("p",{className:"text-gray-500",children:"No classes assigned"})]}),i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[i.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Salary History"}),u.salaryHistory&&u.salaryHistory.length>0?i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Month"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.salaryHistory.map((Q,Z)=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:Q.month}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:Q.status==="advance"?"Advance":"Salary"}),i.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:["Rs ",Math.round(Math.abs(Q.netSalary))]}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Q.status==="paid"?"bg-green-100 text-green-800":Q.status==="advance"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:Q.status.charAt(0).toUpperCase()+Q.status.slice(1)})}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:Q.paymentDate?new Date(Q.paymentDate).toLocaleDateString():"N/A"})]},Z))})]})}):i.jsx("p",{className:"text-gray-500",children:"No salary history available"})]})]})]})]})},CD=({staff:n,value:a,onChange:t,placeholder:r="Select staff member...",disabled:s=!1})=>{const[e,u]=ne.useState(!1),[f,m]=ne.useState(""),g=ne.useRef(null);ne.useEffect(()=>{const C=M=>{g.current&&!g.current.contains(M.target)&&u(!1)};return document.addEventListener("mousedown",C),()=>{document.removeEventListener("mousedown",C)}},[]);const b=n.filter(C=>`${C.firstName} ${C.lastName}`.toLowerCase().includes(f.toLowerCase())||C.department.toLowerCase().includes(f.toLowerCase())||C.position.toLowerCase().includes(f.toLowerCase())),j=n.find(C=>C.id===a),F=C=>{t(C),u(!1),m("")};return i.jsxs("div",{className:"relative",ref:g,children:[i.jsxs("button",{type:"button",disabled:s,onClick:()=>u(!e),className:`w-full flex items-center justify-between px-3 py-2 text-left bg-white border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${s?"bg-gray-100 text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-50"}`,children:[i.jsx("div",{className:"flex items-center",children:j?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"bg-gray-200 border-2 border-dashed rounded-xl w-6 h-6 flex-shrink-0"}),i.jsx("div",{className:"ml-2",children:i.jsxs("div",{className:"text-sm font-medium truncate max-w-xs",children:[j.firstName," ",j.lastName]})})]}):i.jsx("span",{className:"text-gray-500",children:r})}),i.jsx(Lb,{className:"text-gray-400"})]}),e&&!s&&i.jsxs("div",{className:"absolute z-10 mt-1 w-full bg-white shadow-lg rounded-md overflow-hidden",children:[i.jsx("div",{className:"p-2 border-b border-gray-200",children:i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Bi,{className:"h-4 w-4 text-gray-400"})}),i.jsx("input",{type:"text",placeholder:"Search staff...",value:f,onChange:C=>m(C.target.value),className:"block w-full pl-9 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",autoFocus:!0})]})}),i.jsx("div",{className:"max-h-60 overflow-y-auto",children:b.length>0?b.map(C=>i.jsxs("button",{type:"button",onClick:()=>F(C.id),className:`w-full flex items-center px-4 py-2 text-left hover:bg-gray-100 focus:outline-none focus:bg-gray-100 ${C.id===a?"bg-blue-50 text-blue-700":"text-gray-700"}`,children:[i.jsx("div",{className:"bg-gray-200 border-2 border-dashed rounded-xl w-8 h-8 flex-shrink-0"}),i.jsxs("div",{className:"ml-3",children:[i.jsxs("div",{className:"text-sm font-medium",children:[C.firstName," ",C.lastName]}),i.jsxs("div",{className:"text-xs text-gray-500",children:[C.position," - ",C.department]})]})]},C.id)):i.jsxs("div",{className:"px-4 py-6 text-center text-gray-500",children:[i.jsx(Pi,{className:"mx-auto h-8 w-8 text-gray-300"}),i.jsx("p",{className:"mt-2",children:"No staff members found"})]})})]})]})},jD=()=>{const n=Pn(),{staff:a,loading:t,error:r}=rr(O=>O.staff),[s,e]=ne.useState({staffId:"",startDate:"",endDate:"",reportType:"monthly"}),[u,f]=ne.useState("summary"),[m,g]=ne.useState(null),[b,j]=ne.useState(!1);ne.useEffect(()=>{n(uh())},[n]);const F=O=>{const Q=new Date;let Z,ee;switch(O){case"weekly":Z=new Date(Q),Z.setDate(Q.getDate()-Q.getDay()),ee=new Date(Z),ee.setDate(Z.getDate()+6);break;case"monthly":Z=new Date(Q.getFullYear(),Q.getMonth(),1),ee=new Date(Q.getFullYear(),Q.getMonth()+1,0);break;case"quarterly":const se=Math.floor(Q.getMonth()/3);Z=new Date(Q.getFullYear(),se*3,1),ee=new Date(Q.getFullYear(),(se+1)*3,0);break;case"yearly":Z=new Date(Q.getFullYear(),0,1),ee=new Date(Q.getFullYear(),11,31);break;default:Z=new Date(Q.getFullYear(),Q.getMonth(),1),ee=new Date(Q.getFullYear(),Q.getMonth()+1,0)}return{startDate:Z.toISOString().split("T")[0],endDate:ee.toISOString().split("T")[0]}};ne.useEffect(()=>{const{startDate:O,endDate:Q}=F(s.reportType);e(Z=>({...Z,startDate:O,endDate:Q}))},[s.reportType]);const C=a,M=(O,Q)=>{e(Z=>({...Z,[O]:Q}))},_=async()=>{if(!s.staffId){alert("Please select a staff member");return}if(!s.startDate||!s.endDate){alert("Please select both start and end dates");return}const O=a.find(Q=>Q.id===s.staffId);if(!O){alert("Selected staff member not found");return}j(!0);try{const Q=await rE(s.staffId,s.startDate,s.endDate),Z=L(Q),ee={staffId:O.id,staffName:`${O.firstName} ${O.lastName}`,position:O.position,generatedDate:new Date().toISOString().split("T")[0],period:{startDate:s.startDate,endDate:s.endDate,type:s.reportType},attendance:Z,attendanceDetails:Q};g(ee)}catch(Q){console.error("Error generating report:",Q),alert(`Failed to generate report: ${Q.message||"Unknown error"}`)}finally{j(!1)}},L=O=>{if(!O||O.length===0)return{totalDays:0,present:0,absent:0,late:0,leave:0,percentage:0};let Q=0,Z=0,ee=0,se=0;O.forEach(pe=>{switch(pe.status){case"present":Q++;break;case"absent":Z++;break;case"late":ee++;break;case"leave":se++;break}});const ue=Q+Z+ee+se,ae=ue>0?Math.round(Q/ue*100):0;return{totalDays:ue,present:Q,absent:Z,late:ee,leave:se,percentage:ae}},T=()=>{if(!m){alert("Please generate a report first");return}const O=window.open("","_blank"),Q=`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Staff Attendance Report - ${m.staffName}</title>
          <meta charset="UTF-8">
          <style>
            body { 
              font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
              margin: 0;
              padding: 0.5in;
            }
            .header { 
              text-align: center; 
              border-bottom: 2px solid #333; 
              padding-bottom: 10px; 
              margin-bottom: 20px;
            }
            .section { 
              margin-bottom: 20px; 
            }
            .section-title { 
              font-size: 18px; 
              font-weight: bold; 
              margin-bottom: 10px; 
              color: #333;
            }
            table { 
              width: 100%; 
              border-collapse: collapse; 
              margin-bottom: 20px;
            }
            th, td { 
              border: 1px solid #ddd; 
              padding: 8px; 
              text-align: left;
            }
            th { 
              background-color: #f2f2f2; 
              font-weight: bold;
            }
            .stats-grid { 
              display: grid; 
              grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); 
              gap: 10px; 
              margin-bottom: 20px;
            }
            .stat-card { 
              border: 1px solid #ddd; 
              padding: 10px; 
              text-align: center;
            }
            .stat-value { 
              font-size: 24px; 
              font-weight: bold; 
              color: #333;
            }
            .stat-label { 
              font-size: 14px; 
              color: #666;
            }
          </style>
        </head>
        <body>
          <div class="header">
            <h1>Staff Attendance Report</h1>
            <p>Report for ${m.staffName} (${m.position})</p>
            <p>Period: ${m.period.startDate} to ${m.period.endDate}</p>
            <p>Generated on: ${m.generatedDate}</p>
          </div>
          
          <div class="section">
            <div class="section-title">Attendance Summary</div>
            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-value">${m.attendance.totalDays}</div>
                <div class="stat-label">Total Days</div>
              </div>
              <div class="stat-card">
                <div class="stat-value">${m.attendance.present}</div>
                <div class="stat-label">Present</div>
              </div>
              <div class="stat-card">
                <div class="stat-value">${m.attendance.absent}</div>
                <div class="stat-label">Absent</div>
              </div>
              <div class="stat-card">
                <div class="stat-value">${m.attendance.late}</div>
                <div class="stat-label">Late</div>
              </div>
              <div class="stat-card">
                <div class="stat-value">${m.attendance.leave}</div>
                <div class="stat-label">Leave</div>
              </div>
              <div class="stat-card">
                <div class="stat-value">${m.attendance.percentage}%</div>
                <div class="stat-label">Attendance %</div>
              </div>
            </div>
          </div>
          
          <div class="section">
            <div class="section-title">Attendance Details</div>
            <table>
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody>
                ${m.attendanceDetails.map(Z=>`
                  <tr>
                    <td>${Z.date}</td>
                    <td>${Z.status.charAt(0).toUpperCase()+Z.status.slice(1)}</td>
                  </tr>
                `).join("")}
              </tbody>
            </table>
          </div>
        </body>
      </html>
    `;O.document.write(Q),O.document.close(),setTimeout(()=>{O.print(),O.close()},500)},H=()=>{if(!m||!m.attendanceDetails)return[];const O={};return m.attendanceDetails.forEach(Q=>{const Z=new Date(Q.date),ee=new Date(Z);ee.setDate(Z.getDate()-Z.getDay());const se=ee.toISOString().split("T")[0];switch(O[se]||(O[se]={weekStart:se,present:0,absent:0,late:0,leave:0,total:0}),Q.status){case"present":O[se].present++;break;case"absent":O[se].absent++;break;case"late":O[se].late++;break;case"leave":O[se].leave++;break}O[se].total++}),Object.values(O)};return i.jsxs("div",{className:"mx-auto",children:[i.jsx(jd,{title:"Staff Attendance Report",subtitle:"Generate comprehensive attendance reports for staff members"}),r&&i.jsx("div",{className:"mb-6 bg-red-50 border-l-4 border-red-500 p-4 rounded",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),i.jsx("div",{className:"ml-3",children:i.jsx("p",{className:"text-sm text-red-700",children:r})})]})}),i.jsx("div",{className:"mb-6 bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[i.jsx(nc,{className:"inline mr-1"}),"Report Type"]}),i.jsxs("select",{value:s.reportType,onChange:O=>M("reportType",O.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"quarterly",children:"Quarterly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[i.jsx(Rl,{className:"inline mr-1"}),"Start Date"]}),i.jsx("input",{type:"date",value:s.startDate,onChange:O=>M("startDate",O.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[i.jsx(Rl,{className:"inline mr-1"}),"End Date"]}),i.jsx("input",{type:"date",value:s.endDate,onChange:O=>M("endDate",O.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[i.jsx(Pi,{className:"inline mr-1"}),"Staff Member"]}),i.jsx(CD,{staff:C,value:s.staffId,onChange:O=>M("staffId",O),placeholder:"Select Staff Member"})]}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{onClick:_,disabled:t||b,className:"w-full inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:t||b?i.jsxs(i.Fragment,{children:[i.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating..."]}):i.jsxs(i.Fragment,{children:[i.jsx(io,{className:"mr-2"}),"Generate Report"]})})})]})}),m&&i.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[i.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[i.jsxs("div",{className:"",children:[i.jsxs("h2",{className:"text-lg font-medium text-gray-900",children:["Report for ",m.staffName," (",m.position,")"]}),i.jsxs("p",{className:"text-gray-600",children:["Period: ",m.period.startDate," to ",m.period.endDate,"(",s.reportType.charAt(0).toUpperCase()+s.reportType.slice(1)," Report)"]})]}),i.jsx("div",{className:"flex space-x-2",children:i.jsxs("button",{onClick:T,className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(mi,{className:"mr-2"}),"Print"]})})]}),i.jsxs("div",{className:"p-6",children:[i.jsx("div",{children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:[i.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[i.jsx("div",{className:"text-sm font-medium text-blue-800",children:"Total Days"}),i.jsx("div",{className:"text-2xl font-semibold text-blue-900",children:m.attendance.totalDays})]}),i.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[i.jsx("div",{className:"text-sm font-medium text-green-800",children:"Present"}),i.jsx("div",{className:"text-2xl font-semibold text-green-900",children:m.attendance.present})]}),i.jsxs("div",{className:"bg-red-50 rounded-lg p-4",children:[i.jsx("div",{className:"text-sm font-medium text-red-800",children:"Absent"}),i.jsx("div",{className:"text-2xl font-semibold text-red-900",children:m.attendance.absent})]}),i.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4",children:[i.jsx("div",{className:"text-sm font-medium text-yellow-800",children:"Late"}),i.jsx("div",{className:"text-2xl font-semibold text-yellow-900",children:m.attendance.late})]}),i.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[i.jsx("div",{className:"text-sm font-medium text-purple-800",children:"Attendance %"}),i.jsxs("div",{className:"text-2xl font-semibold text-purple-900",children:[m.attendance.percentage,"%"]})]})]})}),i.jsxs("div",{children:[s.reportType==="weekly"&&i.jsxs("div",{className:"mb-6",children:[i.jsx("h5",{className:"text-md font-semibold text-gray-900 mb-3",children:"Weekly Attendance Tracking"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Week Starting"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Present"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Absent"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Late"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Leave"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Attendance %"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:H().map((O,Q)=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:new Date(O.weekStart).toLocaleDateString()}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:O.present}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:O.absent}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:O.late}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:O.leave}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[O.total>0?Math.round(O.present/O.total*100):0,"%"]})]},O.weekStart))})]})})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h5",{className:"text-md font-semibold text-gray-900 mb-3",children:"Detailed Attendance Records"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.attendanceDetails.map((O,Q)=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:O.date}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${O.status==="present"?"bg-green-100 text-green-800":O.status==="absent"?"bg-red-100 text-red-800":O.status==="late"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:O.status.charAt(0).toUpperCase()+O.status.slice(1)})})]},`${O.date}-${O.status}`))})]})})]})]})]})]})]})},BD=({onClose:n,onSubmit:a,classData:t,students:r})=>{const[s,e]=ne.useState({name:"",monthlyFees:"",sections:[]}),[u,f]=ne.useState({}),{schoolInfo:m}=rr(se=>se.settings),g=m?.fundingType==="ngo",b=m?.level||"primary",j=m?.hasPG||!1,F=m?.hasNursery||!1,C=m?.hasKG||!1,_=(()=>{if(!m)return{min:1,max:10};switch(b){case"primary":return{min:1,max:5};case"middle":return{min:1,max:8};case"high":return{min:1,max:10};default:return{min:1,max:5}}})(),L=!!t;ne.useEffect(()=>{e(t?{name:t.name,monthlyFees:t.monthlyFees?Math.round(t.monthlyFees):"",sections:t.sections&&t.sections.length>0?t.sections.map((se,ue)=>({id:se.id||`${t.id||Date.now()}-${ue}`,name:se.name})):[{id:`${t.id||Date.now()}-A`,name:"A"}]}:se=>({...se,sections:[{id:`${Date.now()}-A`,name:"A"}]}))},[t]);const T=se=>{e({...s,[se.target.name]:se.target.value}),u[se.target.name]&&f(ue=>({...ue,[se.target.name]:""}))},H=(se,ue,ae)=>{const pe=[...s.sections];pe[se][ue]=ae,e({...s,sections:pe})},O=()=>{const se="ABCDEFGHIJKLMNOPQRSTUVWXYZ";let ue="A";for(let ae=0;ae<se.length;ae++){const pe=se[ae];if(!s.sections.some(z=>z.name===pe)){ue=pe;break}}e({...s,sections:[...s.sections,{id:`${Date.now()}-${ue}`,name:ue}]})},Q=se=>{if(s.sections.length>1){const ue=[...s.sections];ue.splice(se,1),e({...s,sections:ue})}},Z=se=>{if(se==="PG"&&!j)return"Play Group (PG) is not enabled for this school";if(se==="Nursery"&&!F)return"Nursery is not enabled for this school";if(se==="KG"&&!C)return"Kindergarten (KG) is not enabled for this school";const ue=se.match(/^Class\s+(\d+)$/);if(ue){const pe=parseInt(ue[1]);if(pe<_.min||pe>_.max)return`For a ${b} school, classes must be between Class ${_.min} and Class ${_.max}`}const ae=se.match(/^(\d+)$/);if(ae){const pe=parseInt(ae[1]);if(pe<_.min||pe>_.max)return`For a ${b} school, classes must be between ${_.min} and ${_.max}`}return""},ee=se=>{se.preventDefault();const ue=Z(s.name);if(ue){f({name:ue});return}const ae={name:s.name,monthlyFees:s.monthlyFees||0,admissionFees:0};a({...ae,sections:s.sections})};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-2xl w-full max-h-screen overflow-y-auto",children:[i.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:L?"Edit Class":"Add New Class"}),i.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-700",children:i.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"py-6 px-6",children:i.jsxs("form",{onSubmit:ee,children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class Name"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(nc,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"text",name:"name",value:s.name,onChange:T,className:`block w-full pl-10 pr-3 py-2 border ${u.name?"border-red-300":"border-gray-300"} rounded-lg focus:ring-blue-500 focus:border-blue-500`,placeholder:"e.g., Class 10 or 10",required:!0})]}),u.name&&i.jsxs("div",{className:"mt-1 flex items-center text-sm text-red-600",children:[i.jsx(d5,{className:"mr-1"}),u.name]}),i.jsx("div",{className:"mt-1 text-xs text-gray-500",children:m?i.jsxs(i.Fragment,{children:[`For a ${b} school, valid classes are: `,j&&"PG, ",F&&"Nursery, ",C&&"KG, ",`Class ${_.min}-${_.max}`]}):"Loading school configuration..."})]}),!g&&i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monthly Fees"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Co,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"number",name:"monthlyFees",value:s.monthlyFees,onChange:T,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"4000"})]})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Sections"}),i.jsxs("button",{type:"button",onClick:O,className:"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[i.jsx(xl,{className:"mr-1"})," Add Section"]})]}),s.sections.map((se,ue)=>{const ae=r&&s.name?r.filter(pe=>pe.class===s.name&&pe.section===se.name).length:0;return i.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[i.jsx("div",{className:"flex-grow",children:i.jsx("input",{type:"text",value:se.name,onChange:pe=>H(ue,"name",pe.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Section name (e.g., A, B)",required:!0})}),i.jsx("div",{className:"w-24",children:i.jsxs("div",{className:"px-3 py-2 bg-gray-100 rounded-lg text-center text-sm",children:[ae," students"]})}),s.sections.length>1&&i.jsx("button",{type:"button",onClick:()=>Q(ue),className:"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:i.jsx(cu,{size:12})})]},ue)})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:n,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),i.jsx("button",{type:"submit",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:L?"Update Class":"Add Class"})]})]})})]})})},SD=()=>{const n=Pn(),{classes:a,loading:t,error:r}=rr(G=>G.classes),{students:s}=rr(G=>G.students),{staff:e}=rr(G=>G.staff),{schoolInfo:u}=rr(G=>G.settings),[f,m]=ne.useState(""),[g,b]=ne.useState("asc"),[j,F]=ne.useState(!1),[C,M]=ne.useState(!1),[_,L]=ne.useState(!1),[T,H]=ne.useState(null),[O,Q]=ne.useState(null),[Z,ee]=ne.useState(""),[se,ue]=ne.useState({name:"",teacherId:"",teacherName:"",maxMarks:100}),[ae,pe]=ne.useState(null);ne.useEffect(()=>{n(gd()),n(Lc()),n(uh())},[n]);const z=ne.useMemo(()=>a.map(G=>{const q=s.filter(Fe=>Fe.class===G.name).length,ve=(G.sections||[]).map(Fe=>{const Qe=s.filter(Ge=>Ge.class===G.name&&Ge.section===Fe.name).length;return{...Fe,studentCount:Qe}});return{...G,totalStudents:q,sections:ve}}),[a,s]),J=G=>{Q(G),F(!0)},ge=G=>{window.confirm("Are you sure you want to delete this class? This will remove all sections.")&&n(LC(G))},fe=G=>{H(G),ee(G.monthlyFees||""),M(!0)},ke=G=>{H(G),ue({name:"",teacherId:"",teacherName:"",maxMarks:100}),L(!0)},he=G=>{if(G.preventDefault(),T&&se.name){const q={id:`${T.id}-${Date.now()}`,name:se.name,code:se.code,teacherId:se.teacherId||"",maxMarks:se.maxMarks};n(MC({classId:T.id,subject:q})),ue({name:"",code:"",teacherId:"",teacherName:"",maxMarks:100})}},Ne=G=>{let q="this subject";if(T){const Fe=(a.find(Qe=>Qe.id===T.id)||T).subjects?.find(Qe=>Qe.id===G);Fe&&(q=Fe.name)}window.confirm(`Are you sure you want to remove "${q}" from this class?`)&&n(IC({classId:T.id,subjectId:G}))},xe=G=>{pe(G),ue({name:G.name,code:G.code,teacherId:G.teacher_id||"",teacherName:G.teacherFirstName?`${G.teacherFirstName} ${G.teacherLastName}`:"No teacher assigned",maxMarks:G.maxMarks||100})},we=G=>{if(G.preventDefault(),T&&ae&&se.name){const q={name:se.name,code:se.code,teacherId:se.teacherId||"",maxMarks:se.maxMarks};n(OC({classId:T.id,subjectId:ae.id,updatedSubjectData:q})),ue({name:"",code:"",teacherId:"",teacherName:"",maxMarks:100}),pe(null)}},ye=G=>{G.preventDefault(),T&&Z&&(n(UC({classId:T.id,monthlyFees:parseFloat(Z)})),M(!1),ee(""))},te=async G=>{try{let q;O?q=await n(_C({...O,...G})).unwrap():q=await n(TC(G)).unwrap(),q&&G.sections&&G.sections.length>0,F(!1),Q(null)}catch(q){console.error("Failed to save class:",q)}},V=z.filter(G=>G.name.toLowerCase().includes(f.toLowerCase())).sort((G,q)=>{const ve=Ge=>{const je=Ge.match(/\d+/);return je?parseInt(je[0]):0},Fe=ve(G.name),Qe=ve(q.name);return g==="asc"?Fe-Qe:Qe-Fe}),le=z.reduce((G,q)=>G+q.totalStudents,0),de=z.reduce((G,q)=>G+q.sections.length,0),X=e.filter(G=>G.jobType==="Teaching"),ie=u?.fundingType==="ngo";return t?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):r?i.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),i.jsx("div",{className:"ml-3",children:i.jsxs("p",{className:"text-sm text-red-700",children:["Error: ",r]})})]})}):i.jsxs(i.Fragment,{children:[i.jsx(jd,{title:"Classes Management",subtitle:"Manage classes, sections, subjects, and student distribution",actionButton:i.jsxs("button",{onClick:()=>{Q(null),F(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200",children:[i.jsx(xl,{className:"mr-2"})," Add Class"]})}),i.jsx("div",{className:"my-4",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl shadow p-4 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-blue-100 text-xs font-medium",children:"Total Classes"}),i.jsx("p",{className:"text-2xl font-bold mt-1",children:a.length})]}),i.jsx("div",{className:"p-2 bg-blue-400 bg-opacity-30 rounded-full",children:i.jsx(nc,{size:20})})]})}),i.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-xl shadow p-4 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-green-100 text-xs font-medium",children:"Total Students"}),i.jsx("p",{className:"text-2xl font-bold mt-1",children:le})]}),i.jsx("div",{className:"p-2 bg-green-400 bg-opacity-30 rounded-full",children:i.jsx(_c,{size:20})})]})}),i.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl shadow p-4 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-purple-100 text-xs font-medium",children:"Total Sections"}),i.jsx("p",{className:"text-2xl font-bold mt-1",children:de})]}),i.jsx("div",{className:"p-2 bg-purple-400 bg-opacity-30 rounded-full",children:i.jsx(fA,{size:20})})]})})]})}),i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[i.jsx("div",{className:"mb-6",children:i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:[i.jsxs("div",{className:"relative flex-grow max-w-md",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Bi,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"text",placeholder:"Search by class name...",value:f,onChange:G=>m(G.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{onClick:()=>b("asc"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${g==="asc"?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Low to High"}),i.jsx("button",{onClick:()=>b("desc"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${g==="desc"?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"High to Low"})]})]})}),i.jsxs("div",{className:"overflow-hidden rounded-lg border border-gray-200",children:[i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sections"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subjects"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Students"}),!ie&&i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Monthly Fees"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:V.map(G=>i.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("div",{className:"text-sm font-medium text-gray-900",children:G.name})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"flex flex-wrap gap-1",children:(G.sections||[]).map(q=>i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:q.name},q.id))})}),i.jsx("td",{className:"px-6 py-4",children:i.jsxs("div",{className:"flex flex-wrap gap-1",children:[G.subjects&&G.subjects.map(q=>i.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:[i.jsx(OA,{className:"mr-1"})," ",q.name," (",q.teacherFirstName?`${q.teacherFirstName} ${q.teacherLastName}`:"No teacher assigned",")"]},q.id)),(!G.subjects||G.subjects.length===0)&&i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"No subjects"})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:G.totalStudents}),!ie&&i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:G.monthlyFees?`Rs ${Math.round(G.monthlyFees)}`:"Not set"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:i.jsxs("div",{className:"flex justify-end space-x-2",children:[!ie&&i.jsxs("button",{onClick:()=>fe(G),className:"inline-flex items-center px-3 py-1 border border-gray-300 text-xs font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(Co,{className:"mr-1"})," Set Fees"]}),i.jsxs("button",{onClick:()=>ke(G),className:"inline-flex items-center px-3 py-1 border border-gray-300 text-xs font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(nc,{className:"mr-1"})," Subjects"]}),i.jsxs("button",{onClick:()=>J(G),className:"inline-flex items-center px-3 py-1 border border-gray-300 text-xs font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(IA,{className:"mr-1"})," Edit"]}),i.jsxs("button",{onClick:()=>ge(G.id),className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:[i.jsx(cu,{className:"mr-1"})," Delete"]})]})})]},G.id))})]}),V.length===0&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(nc,{className:"mx-auto h-12 w-12 text-gray-400"}),i.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No classes found"}),i.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Try adjusting your search criteria"})]})]})]}),j&&i.jsx(BD,{onClose:()=>{F(!1),Q(null)},onSubmit:te,classData:O,students:s}),!ie&&C&&T&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 w-full max-w-md",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Set Monthly Fees"}),i.jsx("div",{className:"mb-4 p-4 bg-blue-50 rounded-lg",children:i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"Class:"}),i.jsx("span",{className:"font-medium",children:T.name})]})}),i.jsxs("form",{onSubmit:ye,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monthly Fees"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Co,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"number",value:Z,onChange:G=>ee(G.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter amount",required:!0})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>M(!1),className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),i.jsx("button",{type:"submit",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Update Fees"})]})]})]})}),_&&T&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-4xl max-h-screen flex flex-col",children:[i.jsxs("div",{className:"flex justify-between items-center px-6 py-4 border-b border-gray-200",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Manage Subjects"}),i.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Class: ",a.find(G=>G.id===T.id)?.name||T.name]})]}),i.jsx("button",{type:"button",onClick:()=>L(!1),className:"text-gray-500 hover:text-gray-700",children:i.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-3",children:ae?"Edit Subject":"Add New Subject"}),i.jsxs("form",{onSubmit:ae?we:he,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject Name"}),i.jsx("input",{type:"text",value:se.name,onChange:G=>ue({...se,name:G.target.value}),className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Mathematics",required:!0,readOnly:!!ae})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teacher"}),i.jsxs("select",{value:se.teacherId||"",onChange:G=>{const q=G.target.value?X.find(ve=>ve.id===G.target.value):null;ue({...se,teacherId:G.target.value||"",teacherName:q?`${q.firstName} ${q.lastName}`:""})},className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"Select a teacher"}),X.map(G=>i.jsxs("option",{value:G.id,children:[G.firstName," ",G.lastName," ",G.subject?`(${G.subject})`:""]},G.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Maximum Marks"}),i.jsx("input",{type:"number",value:se.maxMarks,onChange:G=>ue({...se,maxMarks:parseInt(G.target.value)||100}),className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"100",min:"1",required:!0})]}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("button",{type:"submit",className:"flex-1 inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:ae?"Update Subject":"Add Subject"}),ae&&i.jsx("button",{type:"button",onClick:()=>{pe(null),ue({name:"",teacherId:"",teacherName:"",maxMarks:100})},className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"})]})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-3",children:"Existing Subjects"}),(()=>{const G=a.find(q=>q.id===T.id)||T;return G.subjects&&G.subjects.length>0?i.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:G.subjects.map(q=>i.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:q.name}),i.jsxs("div",{className:"text-xs text-gray-500 truncate",children:["Teacher: ",q.teacherFirstName?`${q.teacherFirstName} ${q.teacherLastName}`:"No teacher assigned"]}),i.jsxs("div",{className:"text-xs text-gray-500",children:["Max Marks: ",q.maxMarks||100]})]}),i.jsxs("div",{className:"ml-2 flex space-x-1",children:[i.jsx("button",{onClick:()=>xe(q),className:"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex-shrink-0",children:i.jsx(IA,{size:12})}),i.jsx("button",{onClick:()=>Ne(q.id),className:"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 flex-shrink-0",children:i.jsx(cu,{size:12})})]})]},q.id))}):i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx(nc,{className:"mx-auto h-8 w-8"}),i.jsx("p",{className:"mt-2",children:"No subjects added yet"})]})})()]})]})})]})})]})},FD=()=>{const n=Pn(),a=rr(_=>_.subsidies.subsidies),[t,r]=ne.useState(""),[s,e]=ne.useState("all"),[u,f]=ne.useState(!1),[m,g]=ne.useState({quarter:"",year:new Date().getFullYear(),amount:"",ngoName:"",description:"",receivedDate:"",expectedDate:"",status:"expected"}),b=_=>{_.preventDefault();const L={...m,status:m.receivedDate?"received":"expected",expectedDate:m.expectedDate||(m.receivedDate?"":j(m.quarter,m.year))};delete L.id,n(p2(L)),g({quarter:"",year:new Date().getFullYear(),amount:"",ngoName:"",description:"",receivedDate:"",expectedDate:"",status:"expected"}),f(!1)},j=(_,L)=>{if(!_||!L)return"";const H={Q1:3,Q2:6,Q3:9,Q4:12}[_];return H?`${L}-${String(H).padStart(2,"0")}-15`:""},F=a.filter(_=>{const L=_.ngoName.toLowerCase().includes(t.toLowerCase())||_.quarter.toLowerCase().includes(t.toLowerCase())||_.description.toLowerCase().includes(t.toLowerCase()),T=s==="all"||_.status===s;return L&&T}),C=a.filter(_=>_.status==="received").reduce((_,L)=>_+Number(L.amount),0),M=a.filter(_=>_.status==="expected").reduce((_,L)=>_+Number(L.amount),0);return i.jsx("div",{className:"min-h-screen bg-gray-50 py-6",children:i.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"NGO Subsidies"}),i.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Track quarterly subsidies received from NGOs for school operations"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[i.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-3 rounded-full bg-blue-100",children:i.jsx(Co,{className:"text-blue-600"})}),i.jsxs("div",{className:"ml-4",children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Received"}),i.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["Rs ",C.toLocaleString()]})]})]})}),i.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-3 rounded-full bg-purple-100",children:i.jsx(xd,{className:"text-purple-600"})}),i.jsxs("div",{className:"ml-4",children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Expected Subsidies"}),i.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["Rs ",M.toLocaleString()]})]})]})}),i.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-3 rounded-full bg-purple-100",children:i.jsx(Qk,{className:"text-purple-600"})}),i.jsxs("div",{className:"ml-4",children:[i.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active NGOs"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:[...new Set(a.map(_=>_.ngoName))].length})]})]})})]}),i.jsx("div",{className:"bg-white rounded-lg shadow mb-6",children:i.jsx("div",{className:"p-6",children:i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4",children:[i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Bi,{className:"text-gray-400"})}),i.jsx("input",{type:"text",placeholder:"Search subsidies...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",value:t,onChange:_=>r(_.target.value)})]}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(io,{className:"text-gray-400"})}),i.jsxs("select",{className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",value:s,onChange:_=>e(_.target.value),children:[i.jsx("option",{value:"all",children:"All Status"}),i.jsx("option",{value:"received",children:"Received"}),i.jsx("option",{value:"expected",children:"Expected"})]})]})]}),i.jsxs("button",{onClick:()=>f(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(xl,{className:"mr-2"}),"Add Subsidy"]})]})})}),i.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"NGO Name"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quarter & Year"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:F.map(_=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("div",{className:"text-sm font-medium text-gray-900",children:_.ngoName})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"text-sm text-gray-900",children:[_.quarter," ",_.year]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"text-sm text-gray-900",children:["Rs ",Number(_.amount).toLocaleString()]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("div",{className:"text-sm text-gray-900",children:_.receivedDate||_.expectedDate||"N/A"})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${_.status==="received"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:_.status==="received"?i.jsxs(i.Fragment,{children:[i.jsx(nf,{className:"mr-1"})," Received"]}):i.jsxs(i.Fragment,{children:[i.jsx(vd,{className:"mr-1"})," Expected"]})})}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:_.description})]},_.id))})]})})}),u&&i.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:i.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:i.jsxs("div",{className:"mt-3",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add NGO Subsidy"}),i.jsxs("form",{onSubmit:b,children:[i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"NGO Name"}),i.jsx("input",{type:"text",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",value:m.ngoName,onChange:_=>g({...m,ngoName:_.target.value})})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Quarter"}),i.jsxs("select",{required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",value:m.quarter,onChange:_=>g({...m,quarter:_.target.value}),children:[i.jsx("option",{value:"",children:"Select Quarter"}),i.jsx("option",{value:"Q1",children:"Q1"}),i.jsx("option",{value:"Q2",children:"Q2"}),i.jsx("option",{value:"Q3",children:"Q3"}),i.jsx("option",{value:"Q4",children:"Q4"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Year"}),i.jsx("input",{type:"number",required:!0,min:"2020",max:"2030",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",value:m.year,onChange:_=>g({...m,year:parseInt(_.target.value)})})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Amount (Rs)"}),i.jsx("input",{type:"number",required:!0,min:"0",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",value:m.amount,onChange:_=>g({...m,amount:parseFloat(_.target.value)||0})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Received Date (Optional)"}),i.jsx("input",{type:"date",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",value:m.receivedDate,onChange:_=>g({...m,receivedDate:_.target.value})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),i.jsx("textarea",{className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",rows:"3",value:m.description,onChange:_=>g({...m,description:_.target.value})})]})]}),i.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[i.jsx("button",{type:"button",onClick:()=>f(!1),className:"inline-flex justify-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),i.jsx("button",{type:"submit",className:"inline-flex justify-center px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Add Subsidy"})]})]})]})})})]})})},ED=({marksheetData:n,studentData:a,classData:t,onPrint:r,onDownload:s,schoolInfo:e})=>{if(!n)return null;const{examType:u,year:f,marks:m,totalObtained:g,totalMarks:b,percentage:j,overallGrade:F}=n,C=a?`${a.firstName} ${a.lastName}`:n.studentName||"N/A",M=n.class||"N/A",_=n.section||"N/A",L={schoolName:e?.schoolName||e?.name||"School Management System",schoolAddress:e?.schoolAddress||e?.address||"123 Education Street, Learning City",schoolPhone:e?.schoolPhone||e?.phone||"+1 (555) 123-4567"},T=new Date().toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return i.jsxs("div",{className:"w-full mx-auto bg-white font-sans",children:[i.jsxs("div",{className:"text-center border-b border-gray-300 pb-2 mb-3 print:hidden",children:[i.jsxs("div",{className:"flex items-center justify-center mb-1",children:[i.jsx(fA,{className:"text-blue-600 text-lg mr-2"}),i.jsx("h1",{className:"text-lg font-bold text-gray-800",children:L.schoolName})]}),i.jsx("p",{className:"text-gray-600 text-xs mb-1",children:L.schoolAddress}),i.jsxs("p",{className:"text-gray-600 text-xs",children:["Phone: ",L.schoolPhone]})]}),i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-base font-bold text-gray-800",children:"Student Marksheet"}),i.jsxs("p",{className:"text-gray-600 text-xs",children:["ID: ",n.id||"N/A"]})]}),i.jsxs("div",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium",children:[u," ",f]})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("h3",{className:"font-bold text-gray-800 mb-2 text-xs flex items-center",children:[i.jsx(Pi,{className:"mr-2 text-blue-600 text-xs"})," Student Information"]}),i.jsx("div",{className:"bg-gray-50 p-2 rounded",children:i.jsxs("div",{className:"grid grid-cols-3 gap-1 text-xs",children:[i.jsx("span",{className:"font-medium col-span-1",children:"Name:"}),i.jsx("span",{className:"col-span-2",children:C}),i.jsx("span",{className:"font-medium col-span-1",children:"Class:"}),i.jsxs("span",{className:"col-span-2",children:[M," - Section ",_]}),i.jsx("span",{className:"font-medium col-span-1",children:"Student ID:"}),i.jsx("span",{className:"col-span-2",children:n.studentId||"N/A"})]})})]}),i.jsxs("div",{className:"mb-3",children:[i.jsx("h3",{className:"font-bold text-gray-800 mb-2 text-xs",children:"Subject Marks"}),i.jsxs("div",{className:"border rounded",children:[i.jsxs("div",{className:"grid grid-cols-4 gap-1 p-2 bg-gray-50 border-b text-xs font-medium",children:[i.jsx("span",{className:"col-span-1",children:"Subject"}),i.jsx("span",{className:"text-center",children:"Obtained"}),i.jsx("span",{className:"text-center",children:"Total"}),i.jsx("span",{className:"text-center",children:"Grade"})]}),i.jsx("div",{className:"divide-y divide-gray-200",children:m&&m.map((H,O)=>i.jsxs("div",{className:"grid grid-cols-4 gap-1 p-2 text-xs",children:[i.jsx("span",{className:"col-span-1",children:H.subjectName}),i.jsx("span",{className:"text-center",children:H.marksObtained}),i.jsx("span",{className:"text-center",children:H.totalMarks}),i.jsx("span",{className:"text-center",children:i.jsx("span",{className:"bg-blue-100 text-blue-800 px-1 py-0.5 rounded text-xs",children:H.grade})})]},O))})]})]}),i.jsxs("div",{className:"grid grid-cols-4 gap-2 mb-3",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-xs font-medium text-gray-700 mb-1",children:"Total Obtained"}),i.jsx("div",{className:"bg-gray-50 p-2 rounded border text-xs text-center font-bold",children:g})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-xs font-medium text-gray-700 mb-1",children:"Total Marks"}),i.jsx("div",{className:"bg-gray-50 p-2 rounded border text-xs text-center font-bold",children:b})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-xs font-medium text-gray-700 mb-1",children:"Percentage"}),i.jsxs("div",{className:"bg-gray-50 p-2 rounded border text-xs text-center font-bold",children:[j,"%"]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-xs font-medium text-gray-700 mb-1",children:"Grade"}),i.jsx("div",{className:"bg-gray-50 p-2 rounded border text-xs text-center font-bold",children:i.jsx("span",{className:"bg-green-100 text-green-800 px-1 py-0.5 rounded text-xs",children:F})})]})]}),i.jsxs("div",{className:"flex justify-center space-x-3 mt-4 mb-3 print:hidden",children:[i.jsxs("button",{onClick:r,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded text-xs hover:bg-blue-700 transition-colors",children:[i.jsx(mi,{className:"mr-2"})," Print"]}),i.jsxs("button",{onClick:s,className:"flex items-center px-4 py-2 bg-green-600 text-white rounded text-xs hover:bg-green-700 transition-colors",children:[i.jsx(lu,{className:"mr-2"})," Save PDF"]})]}),i.jsxs("div",{className:"text-center text-xs text-gray-500 mt-3 pt-2 border-t border-gray-200",children:[i.jsxs("p",{children:["Generated on ",T]}),i.jsx("p",{className:"mt-1",children:"Official School Document"})]}),i.jsx("style",{children:`
        @media print {
          body {
            margin: 0;
            padding: 0;
          }
          
          .print-container {
            padding: 10px;
            max-width: 100%;
          }
          
          .print-hidden {
            display: none !important;
          }
          
          @page {
            size: A4;
            margin: 0.5in;
          }
          
          .marksheet-print-view {
            font-family: Arial, Helvetica, sans-serif;
          }
        }
      `})]})},R1=()=>{const n=new Date().getFullYear(),a=n+1;return`${n}-${a}`},L4=({classes:n,students:a,exams:t,onSubmit:r,onCancel:s,currentMarks:e})=>{const[u,f]=ne.useState(1),[m,g]=ne.useState(""),[b,j]=ne.useState(""),[F,C]=ne.useState(""),[M,_]=ne.useState(""),[L,T]=ne.useState(null),[H,O]=ne.useState(new Date().getFullYear().toString()),[Q,Z]=ne.useState([]),[ee,se]=ne.useState(!1),[ue,ae]=ne.useState(null),pe=R1();ne.useMemo(()=>a.filter(ye=>ye.academicYear===pe&&ye.status!=="passed_out"&&ye.status!=="left"),[a,pe]);const z=ne.useMemo(()=>a.filter(ye=>ye.class===m&&ye.section===b),[a,m,b]),J=m?n.find(ye=>ye.name===m)?.sections||[]:[];m&&n.find(ye=>ye.name===m)?.subjects;const ge=ne.useMemo(()=>t&&t.filter(ye=>!m||ye.class===m||ye.classes&&ye.classes.includes(m)).map(ye=>{const te=ye.scheduledSubjects?.find(V=>V.className===m)?.subjects;return{...ye,effectiveSubjects:te||ye.subjects||[]}})||[],[t,m]);ne.useEffect(()=>{if(m&&!e){const V=(ge.find(le=>le.examType===M)?.effectiveSubjects||n.find(le=>le.name===m)?.subjects||[]).map(le=>({subjectId:le.id,subjectName:le.name,marksObtained:"",totalMarks:le.maxMarks||100,grade:""}));Z(V)}},[m,M,e]),ne.useEffect(()=>{},[a,F]),ne.useEffect(()=>{e&&(g(e.class||""),j(e.section||""),C(e.studentId||""),_(e.examType||""),O(e.year||new Date().getFullYear().toString()),e.marks&&Array.isArray(e.marks)&&Z(e.marks.map(ye=>({subjectId:ye.subjectId||ye.id,subjectName:ye.subjectName||ye.name,marksObtained:ye.marksObtained!==void 0?ye.marksObtained:"",totalMarks:ye.totalMarks||100,grade:ye.grade||""}))))},[e]);const fe=(ye,te,V)=>{const le=[...Q];{const de=parseInt(V)||0,X=le[ye].totalMarks;if(de>X){alert(`Obtained marks cannot exceed total marks (${X})`);return}const ie=X>0?de/X*100:0;let G="F";ie>=90?G="A+":ie>=80?G="A":ie>=70?G="B+":ie>=60?G="B":ie>=50&&(G="C"),le[ye].marksObtained=V,le[ye].grade=G}Z(le)},ke=()=>{const ye=Q.reduce((de,X)=>de+(parseInt(X.marksObtained)||0),0),te=Q.reduce((de,X)=>de+(parseInt(X.totalMarks)||0),0),V=te>0?(ye/te*100).toFixed(2):0;let le="F";return V>=90?le="A+":V>=80?le="A":V>=70?le="B+":V>=60?le="B":V>=50&&(le="C"),{totalObtained:ye,totalMarks:te,percentage:V,overallGrade:le}},he=ye=>{if(ye.preventDefault(),!m||!b||!F||!M){alert("Please fill in all required fields");return}if(!Q.every(X=>X.marksObtained!==""&&X.marksObtained!==null)){alert("Please enter marks for all subjects");return}if(!Q.every(X=>{const ie=parseInt(X.marksObtained)||0,G=parseInt(X.totalMarks)||0;return ie<=G})){alert("Obtained marks cannot exceed total marks for any subject");return}const le=ke(),de={id:e?.id||Date.now().toString(),studentId:F,class:m,section:b,examType:M,year:H,marks:Q,...le};ae(de),se(!0)},Ne=ye=>{r(ye),se(!1),ae(null),f(1),g(""),j(""),C(""),_(""),T(null),O(new Date().getFullYear().toString()),Z([])},xe=()=>{window.print()},we=()=>{alert("In a full implementation, this would download the marksheet as a PDF")};if(ee&&ue){const ye=a.find(V=>V.id===ue.studentId),te=n.find(V=>V.name===ue.class);return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-screen overflow-y-auto",children:[i.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Print Preview"}),i.jsx("button",{onClick:()=>se(!1),className:"text-gray-500 hover:text-gray-700",children:i.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("div",{className:"py-4 px-6",children:[i.jsx(ED,{marksheetData:ue,studentData:ye,classData:te,onPrint:xe,onDownload:we}),i.jsxs("div",{className:"flex justify-center space-x-4 mt-6",children:[i.jsx("button",{onClick:()=>se(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Back to Edit"}),i.jsx("button",{onClick:()=>Ne(ue),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Save Marksheet"})]})]})]})})}return i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:e?"Edit Student Marksheet":"Add Student Marksheet"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class *"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(nc,{className:"h-5 w-5 text-gray-400"})}),i.jsxs("select",{value:m,onChange:ye=>{g(ye.target.value),j(""),C("")},className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0,children:[i.jsx("option",{value:"",children:"Select Class"}),n.map(ye=>i.jsx("option",{value:ye.name,children:ye.name},ye.id))]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Section *"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(OA,{className:"h-5 w-5 text-gray-400"})}),i.jsxs("select",{value:b,onChange:ye=>{j(ye.target.value),C("")},className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:!m,children:[i.jsx("option",{value:"",children:"Select Section"}),J.map(ye=>i.jsx("option",{value:ye.name,children:ye.name},ye.id))]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student *"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(OA,{className:"h-5 w-5 text-gray-400"})}),i.jsxs("select",{value:F,onChange:ye=>C(ye.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:!m||!b,children:[i.jsx("option",{value:"",children:"Select Student"}),z.map(ye=>i.jsxs("option",{value:ye.id,children:[ye.firstName," ",ye.lastName," (ID: ",ye.id,")"]},ye.id))]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Exam Type *"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(A5,{className:"h-5 w-5 text-gray-400"})}),i.jsxs("select",{value:M,onChange:ye=>{const te=ge.find(V=>V.examType===ye.target.value);_(ye.target.value),T(te),te&&O(te.year||new Date().getFullYear().toString())},className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0,children:[i.jsx("option",{value:"",children:"Select Exam Type"}),ge.map(ye=>i.jsxs("option",{value:ye.examType,children:[ye.examType," - ",ye.class," (",ye.startDate," to ",ye.endDate,")"]},ye.id))]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year"}),i.jsx("input",{type:"text",value:H,readOnly:!0,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100"})]})]}),m&&b&&F&&M&&H&&i.jsxs("div",{className:"mb-6",children:[i.jsx("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"Enter Marks"}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Q.map((ye,te)=>i.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsx("h5",{className:"font-medium text-gray-900",children:ye.subjectName}),i.jsxs("span",{className:"text-sm text-gray-500",children:["Total: ",ye.totalMarks]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Obtained Marks"}),i.jsx("input",{type:"number",min:"0",max:ye.totalMarks,value:ye.marksObtained,onChange:V=>fe(te,"marksObtained",V.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Grade"}),i.jsx("input",{type:"text",value:ye.grade,readOnly:!0,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-sm"})]})]})]},te))}),i.jsx("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:i.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Total Obtained"}),i.jsx("p",{className:"font-bold",children:ke().totalObtained})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Total Marks"}),i.jsx("p",{className:"font-bold",children:ke().totalMarks})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Percentage"}),i.jsxs("p",{className:"font-bold",children:[ke().percentage,"%"]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-gray-500",children:"Grade"}),i.jsx("p",{className:"font-bold",children:ke().overallGrade})]})]})})]}),i.jsxs("div",{className:"flex justify-end space-x-3",children:[i.jsx("button",{type:"button",onClick:s,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),i.jsxs("button",{type:"button",onClick:he,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[i.jsx(nf,{className:"mr-2"})," ",e?"Update Marksheet":"Save and Preview"]})]})]})},kD="modulepreload",DD=function(n){return"/dawn-school/"+n},U4={},My=function(a,t,r){let s=Promise.resolve();if(t&&t.length>0){let m=function(g){return Promise.all(g.map(b=>Promise.resolve(b).then(j=>({status:"fulfilled",value:j}),j=>({status:"rejected",reason:j}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),f=u?.nonce||u?.getAttribute("nonce");s=m(t.map(g=>{if(g=DD(g),g in U4)return;U4[g]=!0;const b=g.endsWith(".css"),j=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${j}`))return;const F=document.createElement("link");if(F.rel=b?"stylesheet":kD,b||(F.as="script"),F.crossOrigin="",F.href=g,f&&F.setAttribute("nonce",f),document.head.appendChild(F),b)return new Promise((C,M)=>{F.addEventListener("load",C),F.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${g}`)))})}))}function e(u){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=u,window.dispatchEvent(f),!f.defaultPrevented)throw u}return s.then(u=>{for(const f of u||[])f.status==="rejected"&&e(f.reason);return a().catch(e)})};function wn(n){"@babel/helpers - typeof";return wn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},wn(n)}var wd=Uint8Array,AA=Uint16Array,g5=Int32Array,x5=new wd([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),b5=new wd([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),M4=new wd([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Aj=function(n,a){for(var t=new AA(31),r=0;r<31;++r)t[r]=a+=1<<n[r-1];for(var s=new g5(t[30]),r=1;r<30;++r)for(var e=t[r];e<t[r+1];++e)s[e]=e-t[r]<<5|r;return{b:t,r:s}},dj=Aj(x5,2),TD=dj.b,iw=dj.r;TD[28]=258,iw[258]=28;var _D=Aj(b5,0),I4=_D.r,ow=new AA(32768);for(var ii=0;ii<32768;++ii){var Vf=(ii&43690)>>1|(ii&21845)<<1;Vf=(Vf&52428)>>2|(Vf&13107)<<2,Vf=(Vf&61680)>>4|(Vf&3855)<<4,ow[ii]=((Vf&65280)>>8|(Vf&255)<<8)>>1}var P1=(function(n,a,t){for(var r=n.length,s=0,e=new AA(a);s<r;++s)n[s]&&++e[n[s]-1];var u=new AA(a);for(s=1;s<a;++s)u[s]=u[s-1]+e[s-1]<<1;var f;if(t){f=new AA(1<<a);var m=15-a;for(s=0;s<r;++s)if(n[s])for(var g=s<<4|n[s],b=a-n[s],j=u[n[s]-1]++<<b,F=j|(1<<b)-1;j<=F;++j)f[ow[j]>>m]=g}else for(f=new AA(r),s=0;s<r;++s)n[s]&&(f[s]=ow[u[n[s]-1]++]>>15-n[s]);return f}),Nh=new wd(288);for(var ii=0;ii<144;++ii)Nh[ii]=8;for(var ii=144;ii<256;++ii)Nh[ii]=9;for(var ii=256;ii<280;++ii)Nh[ii]=7;for(var ii=280;ii<288;++ii)Nh[ii]=8;var q2=new wd(32);for(var ii=0;ii<32;++ii)q2[ii]=5;var LD=P1(Nh,9,0),UD=P1(q2,5,0),uj=function(n){return(n+7)/8|0},MD=function(n,a,t){return(t==null||t>n.length)&&(t=n.length),new wd(n.subarray(a,t))},Hu=function(n,a,t){t<<=a&7;var r=a/8|0;n[r]|=t,n[r+1]|=t>>8},g1=function(n,a,t){t<<=a&7;var r=a/8|0;n[r]|=t,n[r+1]|=t>>8,n[r+2]|=t>>16},Iy=function(n,a){for(var t=[],r=0;r<n.length;++r)n[r]&&t.push({s:r,f:n[r]});var s=t.length,e=t.slice();if(!s)return{t:hj,l:0};if(s==1){var u=new wd(t[0].s+1);return u[t[0].s]=1,{t:u,l:1}}t.sort(function(Z,ee){return Z.f-ee.f}),t.push({s:-1,f:25001});var f=t[0],m=t[1],g=0,b=1,j=2;for(t[0]={s:-1,f:f.f+m.f,l:f,r:m};b!=s-1;)f=t[t[g].f<t[j].f?g++:j++],m=t[g!=b&&t[g].f<t[j].f?g++:j++],t[b++]={s:-1,f:f.f+m.f,l:f,r:m};for(var F=e[0].s,r=1;r<s;++r)e[r].s>F&&(F=e[r].s);var C=new AA(F+1),M=lw(t[b-1],C,0);if(M>a){var r=0,_=0,L=M-a,T=1<<L;for(e.sort(function(ee,se){return C[se.s]-C[ee.s]||ee.f-se.f});r<s;++r){var H=e[r].s;if(C[H]>a)_+=T-(1<<M-C[H]),C[H]=a;else break}for(_>>=L;_>0;){var O=e[r].s;C[O]<a?_-=1<<a-C[O]++-1:++r}for(;r>=0&&_;--r){var Q=e[r].s;C[Q]==a&&(--C[Q],++_)}M=a}return{t:new wd(C),l:M}},lw=function(n,a,t){return n.s==-1?Math.max(lw(n.l,a,t+1),lw(n.r,a,t+1)):a[n.s]=t},O4=function(n){for(var a=n.length;a&&!n[--a];);for(var t=new AA(++a),r=0,s=n[0],e=1,u=function(m){t[r++]=m},f=1;f<=a;++f)if(n[f]==s&&f!=a)++e;else{if(!s&&e>2){for(;e>138;e-=138)u(32754);e>2&&(u(e>10?e-11<<5|28690:e-3<<5|12305),e=0)}else if(e>3){for(u(s),--e;e>6;e-=6)u(8304);e>2&&(u(e-3<<5|8208),e=0)}for(;e--;)u(s);e=1,s=n[f]}return{c:t.subarray(0,r),n:a}},x1=function(n,a){for(var t=0,r=0;r<a.length;++r)t+=n[r]*a[r];return t},fj=function(n,a,t){var r=t.length,s=uj(a+2);n[s]=r&255,n[s+1]=r>>8,n[s+2]=n[s]^255,n[s+3]=n[s+1]^255;for(var e=0;e<r;++e)n[s+e+4]=t[e];return(s+4+r)*8},Q4=function(n,a,t,r,s,e,u,f,m,g,b){Hu(a,b++,t),++s[256];for(var j=Iy(s,15),F=j.t,C=j.l,M=Iy(e,15),_=M.t,L=M.l,T=O4(F),H=T.c,O=T.n,Q=O4(_),Z=Q.c,ee=Q.n,se=new AA(19),ue=0;ue<H.length;++ue)++se[H[ue]&31];for(var ue=0;ue<Z.length;++ue)++se[Z[ue]&31];for(var ae=Iy(se,7),pe=ae.t,z=ae.l,J=19;J>4&&!pe[M4[J-1]];--J);var ge=g+5<<3,fe=x1(s,Nh)+x1(e,q2)+u,ke=x1(s,F)+x1(e,_)+u+14+3*J+x1(se,pe)+2*se[16]+3*se[17]+7*se[18];if(m>=0&&ge<=fe&&ge<=ke)return fj(a,b,n.subarray(m,m+g));var he,Ne,xe,we;if(Hu(a,b,1+(ke<fe)),b+=2,ke<fe){he=P1(F,C,0),Ne=F,xe=P1(_,L,0),we=_;var ye=P1(pe,z,0);Hu(a,b,O-257),Hu(a,b+5,ee-1),Hu(a,b+10,J-4),b+=14;for(var ue=0;ue<J;++ue)Hu(a,b+3*ue,pe[M4[ue]]);b+=3*J;for(var te=[H,Z],V=0;V<2;++V)for(var le=te[V],ue=0;ue<le.length;++ue){var de=le[ue]&31;Hu(a,b,ye[de]),b+=pe[de],de>15&&(Hu(a,b,le[ue]>>5&127),b+=le[ue]>>12)}}else he=LD,Ne=Nh,xe=UD,we=q2;for(var ue=0;ue<f;++ue){var X=r[ue];if(X>255){var de=X>>18&31;g1(a,b,he[de+257]),b+=Ne[de+257],de>7&&(Hu(a,b,X>>23&31),b+=x5[de]);var ie=X&31;g1(a,b,xe[ie]),b+=we[ie],ie>3&&(g1(a,b,X>>5&8191),b+=b5[ie])}else g1(a,b,he[X]),b+=Ne[X]}return g1(a,b,he[256]),b+Ne[256]},ID=new g5([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),hj=new wd(0),OD=function(n,a,t,r,s,e){var u=e.z||n.length,f=new wd(r+u+5*(1+Math.ceil(u/7e3))+s),m=f.subarray(r,f.length-s),g=e.l,b=(e.r||0)&7;if(a){b&&(m[0]=e.r>>3);for(var j=ID[a-1],F=j>>13,C=j&8191,M=(1<<t)-1,_=e.p||new AA(32768),L=e.h||new AA(M+1),T=Math.ceil(t/3),H=2*T,O=function(Me){return(n[Me]^n[Me+1]<<T^n[Me+2]<<H)&M},Q=new g5(25e3),Z=new AA(288),ee=new AA(32),se=0,ue=0,ae=e.i||0,pe=0,z=e.w||0,J=0;ae+2<u;++ae){var ge=O(ae),fe=ae&32767,ke=L[ge];if(_[fe]=ke,L[ge]=fe,z<=ae){var he=u-ae;if((se>7e3||pe>24576)&&(he>423||!g)){b=Q4(n,m,0,Q,Z,ee,ue,pe,J,ae-J,b),pe=se=ue=0,J=ae;for(var Ne=0;Ne<286;++Ne)Z[Ne]=0;for(var Ne=0;Ne<30;++Ne)ee[Ne]=0}var xe=2,we=0,ye=C,te=fe-ke&32767;if(he>2&&ge==O(ae-te))for(var V=Math.min(F,he)-1,le=Math.min(32767,ae),de=Math.min(258,he);te<=le&&--ye&&fe!=ke;){if(n[ae+xe]==n[ae+xe-te]){for(var X=0;X<de&&n[ae+X]==n[ae+X-te];++X);if(X>xe){if(xe=X,we=te,X>V)break;for(var ie=Math.min(te,X-2),G=0,Ne=0;Ne<ie;++Ne){var q=ae-te+Ne&32767,ve=_[q],Fe=q-ve&32767;Fe>G&&(G=Fe,ke=q)}}}fe=ke,ke=_[fe],te+=fe-ke&32767}if(we){Q[pe++]=268435456|iw[xe]<<18|I4[we];var Qe=iw[xe]&31,Ge=I4[we]&31;ue+=x5[Qe]+b5[Ge],++Z[257+Qe],++ee[Ge],z=ae+xe,++se}else Q[pe++]=n[ae],++Z[n[ae]]}}for(ae=Math.max(ae,z);ae<u;++ae)Q[pe++]=n[ae],++Z[n[ae]];b=Q4(n,m,g,Q,Z,ee,ue,pe,J,ae-J,b),g||(e.r=b&7|m[b/8|0]<<3,b-=7,e.h=L,e.p=_,e.i=ae,e.w=z)}else{for(var ae=e.w||0;ae<u+g;ae+=65535){var je=ae+65535;je>=u&&(m[b/8|0]=g,je=u),b=fj(m,b+1,n.subarray(ae,je))}e.i=u}return MD(f,0,r+uj(b)+s)},mj=function(){var n=1,a=0;return{p:function(t){for(var r=n,s=a,e=t.length|0,u=0;u!=e;){for(var f=Math.min(u+2655,e);u<f;++u)s+=r+=t[u];r=(r&65535)+15*(r>>16),s=(s&65535)+15*(s>>16)}n=r,a=s},d:function(){return n%=65521,a%=65521,(n&255)<<24|(n&65280)<<8|(a&255)<<8|a>>8}}},QD=function(n,a,t,r,s){if(!s&&(s={l:1},a.dictionary)){var e=a.dictionary.subarray(-32768),u=new wd(e.length+n.length);u.set(e),u.set(n,e.length),n=u,s.w=e.length}return OD(n,a.level==null?6:a.level,a.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(n.length)))*1.5):20:12+a.mem,t,r,s)},pj=function(n,a,t){for(;t;++a)n[a]=t,t>>>=8},RD=function(n,a){var t=a.level,r=t==0?0:t<6?1:t==9?3:2;if(n[0]=120,n[1]=r<<6|(a.dictionary&&32),n[1]|=31-(n[0]<<8|n[1])%31,a.dictionary){var s=mj();s.p(a.dictionary),pj(n,2,s.d())}};function cw(n,a){a||(a={});var t=mj();t.p(n);var r=QD(n,a,a.dictionary?6:2,4);return RD(r,a),pj(r,r.length-4,t.d()),r}var PD=typeof TextDecoder<"u"&&new TextDecoder,HD=0;try{PD.decode(hj,{stream:!0}),HD=1}catch{}function zD(n){if(Array.isArray(n))return n}function KD(n,a){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,s,e,u,f=[],m=!0,g=!1;try{if(e=(t=t.call(n)).next,a!==0)for(;!(m=(r=e.call(t)).done)&&(f.push(r.value),f.length!==a);m=!0);}catch(b){g=!0,s=b}finally{try{if(!m&&t.return!=null&&(u=t.return(),Object(u)!==u))return}finally{if(g)throw s}}return f}}function R4(n,a){(a==null||a>n.length)&&(a=n.length);for(var t=0,r=Array(a);t<a;t++)r[t]=n[t];return r}function GD(n,a){if(n){if(typeof n=="string")return R4(n,a);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?R4(n,a):void 0}}function VD(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function P4(n,a){return zD(n)||KD(n,a)||GD(n,a)||VD()}function H4(n,a="utf8"){return new TextDecoder(a).decode(n)}const YD=new TextEncoder;function WD(n){return YD.encode(n)}const $D=1024*8,qD=(()=>{const n=new Uint8Array(4),a=new Uint32Array(n.buffer);return!((a[0]=1)&n[0])})(),Oy={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class y5{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(a=$D,t={}){let r=!1;typeof a=="number"?a=new ArrayBuffer(a):(r=!0,this.lastWrittenByte=a.byteLength);const s=t.offset?t.offset>>>0:0,e=a.byteLength-s;let u=s;(ArrayBuffer.isView(a)||a instanceof y5)&&(a.byteLength!==a.buffer.byteLength&&(u=a.byteOffset+s),a=a.buffer),r?this.lastWrittenByte=e:this.lastWrittenByte=0,this.buffer=a,this.length=e,this.byteLength=e,this.byteOffset=u,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,u,e),this._mark=0,this._marks=[]}available(a=1){return this.offset+a<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(a=1){return this.offset+=a,this}back(a=1){return this.offset-=a,this}seek(a){return this.offset=a,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const a=this._marks.pop();if(a===void 0)throw new Error("Mark stack empty");return this.seek(a),this}rewind(){return this.offset=0,this}ensureAvailable(a=1){if(!this.available(a)){const r=(this.offset+a)*2,s=new Uint8Array(r);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=r,this.byteLength=r,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(a=1){return this.readArray(a,"uint8")}readArray(a,t){const r=Oy[t].BYTES_PER_ELEMENT*a,s=this.byteOffset+this.offset,e=this.buffer.slice(s,s+r);if(this.littleEndian===qD&&t!=="uint8"&&t!=="int8"){const f=new Uint8Array(this.buffer.slice(s,s+r));f.reverse();const m=new Oy[t](f.buffer);return this.offset+=r,m.reverse(),m}const u=new Oy[t](e);return this.offset+=r,u}readInt16(){const a=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,a}readUint16(){const a=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,a}readInt32(){const a=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,a}readUint32(){const a=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,a}readFloat32(){const a=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,a}readFloat64(){const a=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,a}readBigInt64(){const a=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,a}readBigUint64(){const a=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,a}readChar(){return String.fromCharCode(this.readInt8())}readChars(a=1){let t="";for(let r=0;r<a;r++)t+=this.readChar();return t}readUtf8(a=1){return H4(this.readBytes(a))}decodeText(a=1,t="utf8"){return H4(this.readBytes(a),t)}writeBoolean(a){return this.writeUint8(a?255:0),this}writeInt8(a){return this.ensureAvailable(1),this._data.setInt8(this.offset++,a),this._updateLastWrittenByte(),this}writeUint8(a){return this.ensureAvailable(1),this._data.setUint8(this.offset++,a),this._updateLastWrittenByte(),this}writeByte(a){return this.writeUint8(a)}writeBytes(a){this.ensureAvailable(a.length);for(let t=0;t<a.length;t++)this._data.setUint8(this.offset++,a[t]);return this._updateLastWrittenByte(),this}writeInt16(a){return this.ensureAvailable(2),this._data.setInt16(this.offset,a,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(a){return this.ensureAvailable(2),this._data.setUint16(this.offset,a,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(a){return this.ensureAvailable(4),this._data.setInt32(this.offset,a,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(a){return this.ensureAvailable(4),this._data.setUint32(this.offset,a,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(a){return this.ensureAvailable(4),this._data.setFloat32(this.offset,a,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(a){return this.ensureAvailable(8),this._data.setFloat64(this.offset,a,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(a){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,a,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(a){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,a,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(a){return this.writeUint8(a.charCodeAt(0))}writeChars(a){for(let t=0;t<a.length;t++)this.writeUint8(a.charCodeAt(t));return this}writeUtf8(a){return this.writeBytes(WD(a))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function fp(n){let a=n.length;for(;--a>=0;)n[a]=0}const XD=3,JD=258,gj=29,ZD=256,eT=ZD+1+gj,xj=30,tT=512,rT=new Array((eT+2)*2);fp(rT);const aT=new Array(xj*2);fp(aT);const sT=new Array(tT);fp(sT);const nT=new Array(JD-XD+1);fp(nT);const iT=new Array(gj);fp(iT);const oT=new Array(xj);fp(oT);const lT=(n,a,t,r)=>{let s=n&65535|0,e=n>>>16&65535|0,u=0;for(;t!==0;){u=t>2e3?2e3:t,t-=u;do s=s+a[r++]|0,e=e+s|0;while(--u);s%=65521,e%=65521}return s|e<<16|0};var Aw=lT;const cT=()=>{let n,a=[];for(var t=0;t<256;t++){n=t;for(var r=0;r<8;r++)n=n&1?3988292384^n>>>1:n>>>1;a[t]=n}return a},AT=new Uint32Array(cT()),dT=(n,a,t,r)=>{const s=AT,e=r+t;n^=-1;for(let u=r;u<e;u++)n=n>>>8^s[(n^a[u])&255];return n^-1};var qd=dT,dw={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},bj={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const uT=(n,a)=>Object.prototype.hasOwnProperty.call(n,a);var fT=function(n){const a=Array.prototype.slice.call(arguments,1);for(;a.length;){const t=a.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const r in t)uT(t,r)&&(n[r]=t[r])}}return n},hT=n=>{let a=0;for(let r=0,s=n.length;r<s;r++)a+=n[r].length;const t=new Uint8Array(a);for(let r=0,s=0,e=n.length;r<e;r++){let u=n[r];t.set(u,s),s+=u.length}return t},yj={assign:fT,flattenChunks:hT};let vj=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{vj=!1}const sg=new Uint8Array(256);for(let n=0;n<256;n++)sg[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;sg[254]=sg[254]=1;var mT=n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let a,t,r,s,e,u=n.length,f=0;for(s=0;s<u;s++)t=n.charCodeAt(s),(t&64512)===55296&&s+1<u&&(r=n.charCodeAt(s+1),(r&64512)===56320&&(t=65536+(t-55296<<10)+(r-56320),s++)),f+=t<128?1:t<2048?2:t<65536?3:4;for(a=new Uint8Array(f),e=0,s=0;e<f;s++)t=n.charCodeAt(s),(t&64512)===55296&&s+1<u&&(r=n.charCodeAt(s+1),(r&64512)===56320&&(t=65536+(t-55296<<10)+(r-56320),s++)),t<128?a[e++]=t:t<2048?(a[e++]=192|t>>>6,a[e++]=128|t&63):t<65536?(a[e++]=224|t>>>12,a[e++]=128|t>>>6&63,a[e++]=128|t&63):(a[e++]=240|t>>>18,a[e++]=128|t>>>12&63,a[e++]=128|t>>>6&63,a[e++]=128|t&63);return a};const pT=(n,a)=>{if(a<65534&&n.subarray&&vj)return String.fromCharCode.apply(null,n.length===a?n:n.subarray(0,a));let t="";for(let r=0;r<a;r++)t+=String.fromCharCode(n[r]);return t};var gT=(n,a)=>{const t=a||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,a));let r,s;const e=new Array(t*2);for(s=0,r=0;r<t;){let u=n[r++];if(u<128){e[s++]=u;continue}let f=sg[u];if(f>4){e[s++]=65533,r+=f-1;continue}for(u&=f===2?31:f===3?15:7;f>1&&r<t;)u=u<<6|n[r++]&63,f--;if(f>1){e[s++]=65533;continue}u<65536?e[s++]=u:(u-=65536,e[s++]=55296|u>>10&1023,e[s++]=56320|u&1023)}return pT(e,s)},xT=(n,a)=>{a=a||n.length,a>n.length&&(a=n.length);let t=a-1;for(;t>=0&&(n[t]&192)===128;)t--;return t<0||t===0?a:t+sg[n[t]]>a?t:a},uw={string2buf:mT,buf2string:gT,utf8border:xT};function bT(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var yT=bT;const Sx=16209,vT=16191;var wT=function(a,t){let r,s,e,u,f,m,g,b,j,F,C,M,_,L,T,H,O,Q,Z,ee,se,ue,ae,pe;const z=a.state;r=a.next_in,ae=a.input,s=r+(a.avail_in-5),e=a.next_out,pe=a.output,u=e-(t-a.avail_out),f=e+(a.avail_out-257),m=z.dmax,g=z.wsize,b=z.whave,j=z.wnext,F=z.window,C=z.hold,M=z.bits,_=z.lencode,L=z.distcode,T=(1<<z.lenbits)-1,H=(1<<z.distbits)-1;e:do{M<15&&(C+=ae[r++]<<M,M+=8,C+=ae[r++]<<M,M+=8),O=_[C&T];t:for(;;){if(Q=O>>>24,C>>>=Q,M-=Q,Q=O>>>16&255,Q===0)pe[e++]=O&65535;else if(Q&16){Z=O&65535,Q&=15,Q&&(M<Q&&(C+=ae[r++]<<M,M+=8),Z+=C&(1<<Q)-1,C>>>=Q,M-=Q),M<15&&(C+=ae[r++]<<M,M+=8,C+=ae[r++]<<M,M+=8),O=L[C&H];r:for(;;){if(Q=O>>>24,C>>>=Q,M-=Q,Q=O>>>16&255,Q&16){if(ee=O&65535,Q&=15,M<Q&&(C+=ae[r++]<<M,M+=8,M<Q&&(C+=ae[r++]<<M,M+=8)),ee+=C&(1<<Q)-1,ee>m){a.msg="invalid distance too far back",z.mode=Sx;break e}if(C>>>=Q,M-=Q,Q=e-u,ee>Q){if(Q=ee-Q,Q>b&&z.sane){a.msg="invalid distance too far back",z.mode=Sx;break e}if(se=0,ue=F,j===0){if(se+=g-Q,Q<Z){Z-=Q;do pe[e++]=F[se++];while(--Q);se=e-ee,ue=pe}}else if(j<Q){if(se+=g+j-Q,Q-=j,Q<Z){Z-=Q;do pe[e++]=F[se++];while(--Q);if(se=0,j<Z){Q=j,Z-=Q;do pe[e++]=F[se++];while(--Q);se=e-ee,ue=pe}}}else if(se+=j-Q,Q<Z){Z-=Q;do pe[e++]=F[se++];while(--Q);se=e-ee,ue=pe}for(;Z>2;)pe[e++]=ue[se++],pe[e++]=ue[se++],pe[e++]=ue[se++],Z-=3;Z&&(pe[e++]=ue[se++],Z>1&&(pe[e++]=ue[se++]))}else{se=e-ee;do pe[e++]=pe[se++],pe[e++]=pe[se++],pe[e++]=pe[se++],Z-=3;while(Z>2);Z&&(pe[e++]=pe[se++],Z>1&&(pe[e++]=pe[se++]))}}else if((Q&64)===0){O=L[(O&65535)+(C&(1<<Q)-1)];continue r}else{a.msg="invalid distance code",z.mode=Sx;break e}break}}else if((Q&64)===0){O=_[(O&65535)+(C&(1<<Q)-1)];continue t}else if(Q&32){z.mode=vT;break e}else{a.msg="invalid literal/length code",z.mode=Sx;break e}break}}while(r<s&&e<f);Z=M>>3,r-=Z,M-=Z<<3,C&=(1<<M)-1,a.next_in=r,a.next_out=e,a.avail_in=r<s?5+(s-r):5-(r-s),a.avail_out=e<f?257+(f-e):257-(e-f),z.hold=C,z.bits=M};const Bm=15,z4=852,K4=592,G4=0,Qy=1,V4=2,NT=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),CT=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),jT=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),BT=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),ST=(n,a,t,r,s,e,u,f)=>{const m=f.bits;let g=0,b=0,j=0,F=0,C=0,M=0,_=0,L=0,T=0,H=0,O,Q,Z,ee,se,ue=null,ae;const pe=new Uint16Array(Bm+1),z=new Uint16Array(Bm+1);let J=null,ge,fe,ke;for(g=0;g<=Bm;g++)pe[g]=0;for(b=0;b<r;b++)pe[a[t+b]]++;for(C=m,F=Bm;F>=1&&pe[F]===0;F--);if(C>F&&(C=F),F===0)return s[e++]=1<<24|64<<16|0,s[e++]=1<<24|64<<16|0,f.bits=1,0;for(j=1;j<F&&pe[j]===0;j++);for(C<j&&(C=j),L=1,g=1;g<=Bm;g++)if(L<<=1,L-=pe[g],L<0)return-1;if(L>0&&(n===G4||F!==1))return-1;for(z[1]=0,g=1;g<Bm;g++)z[g+1]=z[g]+pe[g];for(b=0;b<r;b++)a[t+b]!==0&&(u[z[a[t+b]]++]=b);if(n===G4?(ue=J=u,ae=20):n===Qy?(ue=NT,J=CT,ae=257):(ue=jT,J=BT,ae=0),H=0,b=0,g=j,se=e,M=C,_=0,Z=-1,T=1<<C,ee=T-1,n===Qy&&T>z4||n===V4&&T>K4)return 1;for(;;){ge=g-_,u[b]+1<ae?(fe=0,ke=u[b]):u[b]>=ae?(fe=J[u[b]-ae],ke=ue[u[b]-ae]):(fe=96,ke=0),O=1<<g-_,Q=1<<M,j=Q;do Q-=O,s[se+(H>>_)+Q]=ge<<24|fe<<16|ke|0;while(Q!==0);for(O=1<<g-1;H&O;)O>>=1;if(O!==0?(H&=O-1,H+=O):H=0,b++,--pe[g]===0){if(g===F)break;g=a[t+u[b]]}if(g>C&&(H&ee)!==Z){for(_===0&&(_=C),se+=j,M=g-_,L=1<<M;M+_<F&&(L-=pe[M+_],!(L<=0));)M++,L<<=1;if(T+=1<<M,n===Qy&&T>z4||n===V4&&T>K4)return 1;Z=H&ee,s[Z]=C<<24|M<<16|se-e|0}}return H!==0&&(s[se+H]=g-_<<24|64<<16|0),f.bits=C,0};var H1=ST;const FT=0,wj=1,Nj=2,{Z_FINISH:Y4,Z_BLOCK:ET,Z_TREES:Fx,Z_OK:Ch,Z_STREAM_END:kT,Z_NEED_DICT:DT,Z_STREAM_ERROR:QA,Z_DATA_ERROR:Cj,Z_MEM_ERROR:jj,Z_BUF_ERROR:TT,Z_DEFLATED:W4}=bj,Mb=16180,$4=16181,q4=16182,X4=16183,J4=16184,Z4=16185,e3=16186,t3=16187,r3=16188,a3=16189,X2=16190,zu=16191,Ry=16192,s3=16193,Py=16194,n3=16195,i3=16196,o3=16197,l3=16198,Ex=16199,kx=16200,c3=16201,A3=16202,d3=16203,u3=16204,f3=16205,Hy=16206,h3=16207,m3=16208,ui=16209,Bj=16210,Sj=16211,_T=852,LT=592,UT=15,MT=UT,p3=n=>(n>>>24&255)+(n>>>8&65280)+((n&65280)<<8)+((n&255)<<24);function IT(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const kh=n=>{if(!n)return 1;const a=n.state;return!a||a.strm!==n||a.mode<Mb||a.mode>Sj?1:0},Fj=n=>{if(kh(n))return QA;const a=n.state;return n.total_in=n.total_out=a.total=0,n.msg="",a.wrap&&(n.adler=a.wrap&1),a.mode=Mb,a.last=0,a.havedict=0,a.flags=-1,a.dmax=32768,a.head=null,a.hold=0,a.bits=0,a.lencode=a.lendyn=new Int32Array(_T),a.distcode=a.distdyn=new Int32Array(LT),a.sane=1,a.back=-1,Ch},Ej=n=>{if(kh(n))return QA;const a=n.state;return a.wsize=0,a.whave=0,a.wnext=0,Fj(n)},kj=(n,a)=>{let t;if(kh(n))return QA;const r=n.state;return a<0?(t=0,a=-a):(t=(a>>4)+5,a<48&&(a&=15)),a&&(a<8||a>15)?QA:(r.window!==null&&r.wbits!==a&&(r.window=null),r.wrap=t,r.wbits=a,Ej(n))},Dj=(n,a)=>{if(!n)return QA;const t=new IT;n.state=t,t.strm=n,t.window=null,t.mode=Mb;const r=kj(n,a);return r!==Ch&&(n.state=null),r},OT=n=>Dj(n,MT);let g3=!0,zy,Ky;const QT=n=>{if(g3){zy=new Int32Array(512),Ky=new Int32Array(32);let a=0;for(;a<144;)n.lens[a++]=8;for(;a<256;)n.lens[a++]=9;for(;a<280;)n.lens[a++]=7;for(;a<288;)n.lens[a++]=8;for(H1(wj,n.lens,0,288,zy,0,n.work,{bits:9}),a=0;a<32;)n.lens[a++]=5;H1(Nj,n.lens,0,32,Ky,0,n.work,{bits:5}),g3=!1}n.lencode=zy,n.lenbits=9,n.distcode=Ky,n.distbits=5},Tj=(n,a,t,r)=>{let s;const e=n.state;return e.window===null&&(e.wsize=1<<e.wbits,e.wnext=0,e.whave=0,e.window=new Uint8Array(e.wsize)),r>=e.wsize?(e.window.set(a.subarray(t-e.wsize,t),0),e.wnext=0,e.whave=e.wsize):(s=e.wsize-e.wnext,s>r&&(s=r),e.window.set(a.subarray(t-r,t-r+s),e.wnext),r-=s,r?(e.window.set(a.subarray(t-r,t),0),e.wnext=r,e.whave=e.wsize):(e.wnext+=s,e.wnext===e.wsize&&(e.wnext=0),e.whave<e.wsize&&(e.whave+=s))),0},RT=(n,a)=>{let t,r,s,e,u,f,m,g,b,j,F,C,M,_,L=0,T,H,O,Q,Z,ee,se,ue;const ae=new Uint8Array(4);let pe,z;const J=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(kh(n)||!n.output||!n.input&&n.avail_in!==0)return QA;t=n.state,t.mode===zu&&(t.mode=Ry),u=n.next_out,s=n.output,m=n.avail_out,e=n.next_in,r=n.input,f=n.avail_in,g=t.hold,b=t.bits,j=f,F=m,ue=Ch;e:for(;;)switch(t.mode){case Mb:if(t.wrap===0){t.mode=Ry;break}for(;b<16;){if(f===0)break e;f--,g+=r[e++]<<b,b+=8}if(t.wrap&2&&g===35615){t.wbits===0&&(t.wbits=15),t.check=0,ae[0]=g&255,ae[1]=g>>>8&255,t.check=qd(t.check,ae,2,0),g=0,b=0,t.mode=$4;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((g&255)<<8)+(g>>8))%31){n.msg="incorrect header check",t.mode=ui;break}if((g&15)!==W4){n.msg="unknown compression method",t.mode=ui;break}if(g>>>=4,b-=4,se=(g&15)+8,t.wbits===0&&(t.wbits=se),se>15||se>t.wbits){n.msg="invalid window size",t.mode=ui;break}t.dmax=1<<t.wbits,t.flags=0,n.adler=t.check=1,t.mode=g&512?a3:zu,g=0,b=0;break;case $4:for(;b<16;){if(f===0)break e;f--,g+=r[e++]<<b,b+=8}if(t.flags=g,(t.flags&255)!==W4){n.msg="unknown compression method",t.mode=ui;break}if(t.flags&57344){n.msg="unknown header flags set",t.mode=ui;break}t.head&&(t.head.text=g>>8&1),t.flags&512&&t.wrap&4&&(ae[0]=g&255,ae[1]=g>>>8&255,t.check=qd(t.check,ae,2,0)),g=0,b=0,t.mode=q4;case q4:for(;b<32;){if(f===0)break e;f--,g+=r[e++]<<b,b+=8}t.head&&(t.head.time=g),t.flags&512&&t.wrap&4&&(ae[0]=g&255,ae[1]=g>>>8&255,ae[2]=g>>>16&255,ae[3]=g>>>24&255,t.check=qd(t.check,ae,4,0)),g=0,b=0,t.mode=X4;case X4:for(;b<16;){if(f===0)break e;f--,g+=r[e++]<<b,b+=8}t.head&&(t.head.xflags=g&255,t.head.os=g>>8),t.flags&512&&t.wrap&4&&(ae[0]=g&255,ae[1]=g>>>8&255,t.check=qd(t.check,ae,2,0)),g=0,b=0,t.mode=J4;case J4:if(t.flags&1024){for(;b<16;){if(f===0)break e;f--,g+=r[e++]<<b,b+=8}t.length=g,t.head&&(t.head.extra_len=g),t.flags&512&&t.wrap&4&&(ae[0]=g&255,ae[1]=g>>>8&255,t.check=qd(t.check,ae,2,0)),g=0,b=0}else t.head&&(t.head.extra=null);t.mode=Z4;case Z4:if(t.flags&1024&&(C=t.length,C>f&&(C=f),C&&(t.head&&(se=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(r.subarray(e,e+C),se)),t.flags&512&&t.wrap&4&&(t.check=qd(t.check,r,C,e)),f-=C,e+=C,t.length-=C),t.length))break e;t.length=0,t.mode=e3;case e3:if(t.flags&2048){if(f===0)break e;C=0;do se=r[e+C++],t.head&&se&&t.length<65536&&(t.head.name+=String.fromCharCode(se));while(se&&C<f);if(t.flags&512&&t.wrap&4&&(t.check=qd(t.check,r,C,e)),f-=C,e+=C,se)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=t3;case t3:if(t.flags&4096){if(f===0)break e;C=0;do se=r[e+C++],t.head&&se&&t.length<65536&&(t.head.comment+=String.fromCharCode(se));while(se&&C<f);if(t.flags&512&&t.wrap&4&&(t.check=qd(t.check,r,C,e)),f-=C,e+=C,se)break e}else t.head&&(t.head.comment=null);t.mode=r3;case r3:if(t.flags&512){for(;b<16;){if(f===0)break e;f--,g+=r[e++]<<b,b+=8}if(t.wrap&4&&g!==(t.check&65535)){n.msg="header crc mismatch",t.mode=ui;break}g=0,b=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),n.adler=t.check=0,t.mode=zu;break;case a3:for(;b<32;){if(f===0)break e;f--,g+=r[e++]<<b,b+=8}n.adler=t.check=p3(g),g=0,b=0,t.mode=X2;case X2:if(t.havedict===0)return n.next_out=u,n.avail_out=m,n.next_in=e,n.avail_in=f,t.hold=g,t.bits=b,DT;n.adler=t.check=1,t.mode=zu;case zu:if(a===ET||a===Fx)break e;case Ry:if(t.last){g>>>=b&7,b-=b&7,t.mode=Hy;break}for(;b<3;){if(f===0)break e;f--,g+=r[e++]<<b,b+=8}switch(t.last=g&1,g>>>=1,b-=1,g&3){case 0:t.mode=s3;break;case 1:if(QT(t),t.mode=Ex,a===Fx){g>>>=2,b-=2;break e}break;case 2:t.mode=i3;break;case 3:n.msg="invalid block type",t.mode=ui}g>>>=2,b-=2;break;case s3:for(g>>>=b&7,b-=b&7;b<32;){if(f===0)break e;f--,g+=r[e++]<<b,b+=8}if((g&65535)!==(g>>>16^65535)){n.msg="invalid stored block lengths",t.mode=ui;break}if(t.length=g&65535,g=0,b=0,t.mode=Py,a===Fx)break e;case Py:t.mode=n3;case n3:if(C=t.length,C){if(C>f&&(C=f),C>m&&(C=m),C===0)break e;s.set(r.subarray(e,e+C),u),f-=C,e+=C,m-=C,u+=C,t.length-=C;break}t.mode=zu;break;case i3:for(;b<14;){if(f===0)break e;f--,g+=r[e++]<<b,b+=8}if(t.nlen=(g&31)+257,g>>>=5,b-=5,t.ndist=(g&31)+1,g>>>=5,b-=5,t.ncode=(g&15)+4,g>>>=4,b-=4,t.nlen>286||t.ndist>30){n.msg="too many length or distance symbols",t.mode=ui;break}t.have=0,t.mode=o3;case o3:for(;t.have<t.ncode;){for(;b<3;){if(f===0)break e;f--,g+=r[e++]<<b,b+=8}t.lens[J[t.have++]]=g&7,g>>>=3,b-=3}for(;t.have<19;)t.lens[J[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,pe={bits:t.lenbits},ue=H1(FT,t.lens,0,19,t.lencode,0,t.work,pe),t.lenbits=pe.bits,ue){n.msg="invalid code lengths set",t.mode=ui;break}t.have=0,t.mode=l3;case l3:for(;t.have<t.nlen+t.ndist;){for(;L=t.lencode[g&(1<<t.lenbits)-1],T=L>>>24,H=L>>>16&255,O=L&65535,!(T<=b);){if(f===0)break e;f--,g+=r[e++]<<b,b+=8}if(O<16)g>>>=T,b-=T,t.lens[t.have++]=O;else{if(O===16){for(z=T+2;b<z;){if(f===0)break e;f--,g+=r[e++]<<b,b+=8}if(g>>>=T,b-=T,t.have===0){n.msg="invalid bit length repeat",t.mode=ui;break}se=t.lens[t.have-1],C=3+(g&3),g>>>=2,b-=2}else if(O===17){for(z=T+3;b<z;){if(f===0)break e;f--,g+=r[e++]<<b,b+=8}g>>>=T,b-=T,se=0,C=3+(g&7),g>>>=3,b-=3}else{for(z=T+7;b<z;){if(f===0)break e;f--,g+=r[e++]<<b,b+=8}g>>>=T,b-=T,se=0,C=11+(g&127),g>>>=7,b-=7}if(t.have+C>t.nlen+t.ndist){n.msg="invalid bit length repeat",t.mode=ui;break}for(;C--;)t.lens[t.have++]=se}}if(t.mode===ui)break;if(t.lens[256]===0){n.msg="invalid code -- missing end-of-block",t.mode=ui;break}if(t.lenbits=9,pe={bits:t.lenbits},ue=H1(wj,t.lens,0,t.nlen,t.lencode,0,t.work,pe),t.lenbits=pe.bits,ue){n.msg="invalid literal/lengths set",t.mode=ui;break}if(t.distbits=6,t.distcode=t.distdyn,pe={bits:t.distbits},ue=H1(Nj,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,pe),t.distbits=pe.bits,ue){n.msg="invalid distances set",t.mode=ui;break}if(t.mode=Ex,a===Fx)break e;case Ex:t.mode=kx;case kx:if(f>=6&&m>=258){n.next_out=u,n.avail_out=m,n.next_in=e,n.avail_in=f,t.hold=g,t.bits=b,wT(n,F),u=n.next_out,s=n.output,m=n.avail_out,e=n.next_in,r=n.input,f=n.avail_in,g=t.hold,b=t.bits,t.mode===zu&&(t.back=-1);break}for(t.back=0;L=t.lencode[g&(1<<t.lenbits)-1],T=L>>>24,H=L>>>16&255,O=L&65535,!(T<=b);){if(f===0)break e;f--,g+=r[e++]<<b,b+=8}if(H&&(H&240)===0){for(Q=T,Z=H,ee=O;L=t.lencode[ee+((g&(1<<Q+Z)-1)>>Q)],T=L>>>24,H=L>>>16&255,O=L&65535,!(Q+T<=b);){if(f===0)break e;f--,g+=r[e++]<<b,b+=8}g>>>=Q,b-=Q,t.back+=Q}if(g>>>=T,b-=T,t.back+=T,t.length=O,H===0){t.mode=f3;break}if(H&32){t.back=-1,t.mode=zu;break}if(H&64){n.msg="invalid literal/length code",t.mode=ui;break}t.extra=H&15,t.mode=c3;case c3:if(t.extra){for(z=t.extra;b<z;){if(f===0)break e;f--,g+=r[e++]<<b,b+=8}t.length+=g&(1<<t.extra)-1,g>>>=t.extra,b-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=A3;case A3:for(;L=t.distcode[g&(1<<t.distbits)-1],T=L>>>24,H=L>>>16&255,O=L&65535,!(T<=b);){if(f===0)break e;f--,g+=r[e++]<<b,b+=8}if((H&240)===0){for(Q=T,Z=H,ee=O;L=t.distcode[ee+((g&(1<<Q+Z)-1)>>Q)],T=L>>>24,H=L>>>16&255,O=L&65535,!(Q+T<=b);){if(f===0)break e;f--,g+=r[e++]<<b,b+=8}g>>>=Q,b-=Q,t.back+=Q}if(g>>>=T,b-=T,t.back+=T,H&64){n.msg="invalid distance code",t.mode=ui;break}t.offset=O,t.extra=H&15,t.mode=d3;case d3:if(t.extra){for(z=t.extra;b<z;){if(f===0)break e;f--,g+=r[e++]<<b,b+=8}t.offset+=g&(1<<t.extra)-1,g>>>=t.extra,b-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){n.msg="invalid distance too far back",t.mode=ui;break}t.mode=u3;case u3:if(m===0)break e;if(C=F-m,t.offset>C){if(C=t.offset-C,C>t.whave&&t.sane){n.msg="invalid distance too far back",t.mode=ui;break}C>t.wnext?(C-=t.wnext,M=t.wsize-C):M=t.wnext-C,C>t.length&&(C=t.length),_=t.window}else _=s,M=u-t.offset,C=t.length;C>m&&(C=m),m-=C,t.length-=C;do s[u++]=_[M++];while(--C);t.length===0&&(t.mode=kx);break;case f3:if(m===0)break e;s[u++]=t.length,m--,t.mode=kx;break;case Hy:if(t.wrap){for(;b<32;){if(f===0)break e;f--,g|=r[e++]<<b,b+=8}if(F-=m,n.total_out+=F,t.total+=F,t.wrap&4&&F&&(n.adler=t.check=t.flags?qd(t.check,s,F,u-F):Aw(t.check,s,F,u-F)),F=m,t.wrap&4&&(t.flags?g:p3(g))!==t.check){n.msg="incorrect data check",t.mode=ui;break}g=0,b=0}t.mode=h3;case h3:if(t.wrap&&t.flags){for(;b<32;){if(f===0)break e;f--,g+=r[e++]<<b,b+=8}if(t.wrap&4&&g!==(t.total&4294967295)){n.msg="incorrect length check",t.mode=ui;break}g=0,b=0}t.mode=m3;case m3:ue=kT;break e;case ui:ue=Cj;break e;case Bj:return jj;case Sj:default:return QA}return n.next_out=u,n.avail_out=m,n.next_in=e,n.avail_in=f,t.hold=g,t.bits=b,(t.wsize||F!==n.avail_out&&t.mode<ui&&(t.mode<Hy||a!==Y4))&&Tj(n,n.output,n.next_out,F-n.avail_out),j-=n.avail_in,F-=n.avail_out,n.total_in+=j,n.total_out+=F,t.total+=F,t.wrap&4&&F&&(n.adler=t.check=t.flags?qd(t.check,s,F,n.next_out-F):Aw(t.check,s,F,n.next_out-F)),n.data_type=t.bits+(t.last?64:0)+(t.mode===zu?128:0)+(t.mode===Ex||t.mode===Py?256:0),(j===0&&F===0||a===Y4)&&ue===Ch&&(ue=TT),ue},PT=n=>{if(kh(n))return QA;let a=n.state;return a.window&&(a.window=null),n.state=null,Ch},HT=(n,a)=>{if(kh(n))return QA;const t=n.state;return(t.wrap&2)===0?QA:(t.head=a,a.done=!1,Ch)},zT=(n,a)=>{const t=a.length;let r,s,e;return kh(n)||(r=n.state,r.wrap!==0&&r.mode!==X2)?QA:r.mode===X2&&(s=1,s=Aw(s,a,t,0),s!==r.check)?Cj:(e=Tj(n,a,t,t),e?(r.mode=Bj,jj):(r.havedict=1,Ch))};var KT=Ej,GT=kj,VT=Fj,YT=OT,WT=Dj,$T=RT,qT=PT,XT=HT,JT=zT,ZT="pako inflate (from Nodeca project)",Vu={inflateReset:KT,inflateReset2:GT,inflateResetKeep:VT,inflateInit:YT,inflateInit2:WT,inflate:$T,inflateEnd:qT,inflateGetHeader:XT,inflateSetDictionary:JT,inflateInfo:ZT};function e9(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var t9=e9;const _j=Object.prototype.toString,{Z_NO_FLUSH:r9,Z_FINISH:a9,Z_OK:ng,Z_STREAM_END:Gy,Z_NEED_DICT:Vy,Z_STREAM_ERROR:s9,Z_DATA_ERROR:x3,Z_MEM_ERROR:n9}=bj;function mg(n){this.options=yj.assign({chunkSize:1024*64,windowBits:15,to:""},n||{});const a=this.options;a.raw&&a.windowBits>=0&&a.windowBits<16&&(a.windowBits=-a.windowBits,a.windowBits===0&&(a.windowBits=-15)),a.windowBits>=0&&a.windowBits<16&&!(n&&n.windowBits)&&(a.windowBits+=32),a.windowBits>15&&a.windowBits<48&&(a.windowBits&15)===0&&(a.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new yT,this.strm.avail_out=0;let t=Vu.inflateInit2(this.strm,a.windowBits);if(t!==ng)throw new Error(dw[t]);if(this.header=new t9,Vu.inflateGetHeader(this.strm,this.header),a.dictionary&&(typeof a.dictionary=="string"?a.dictionary=uw.string2buf(a.dictionary):_j.call(a.dictionary)==="[object ArrayBuffer]"&&(a.dictionary=new Uint8Array(a.dictionary)),a.raw&&(t=Vu.inflateSetDictionary(this.strm,a.dictionary),t!==ng)))throw new Error(dw[t])}mg.prototype.push=function(n,a){const t=this.strm,r=this.options.chunkSize,s=this.options.dictionary;let e,u,f;if(this.ended)return!1;for(a===~~a?u=a:u=a===!0?a9:r9,_j.call(n)==="[object ArrayBuffer]"?t.input=new Uint8Array(n):t.input=n,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(r),t.next_out=0,t.avail_out=r),e=Vu.inflate(t,u),e===Vy&&s&&(e=Vu.inflateSetDictionary(t,s),e===ng?e=Vu.inflate(t,u):e===x3&&(e=Vy));t.avail_in>0&&e===Gy&&t.state.wrap>0&&n[t.next_in]!==0;)Vu.inflateReset(t),e=Vu.inflate(t,u);switch(e){case s9:case x3:case Vy:case n9:return this.onEnd(e),this.ended=!0,!1}if(f=t.avail_out,t.next_out&&(t.avail_out===0||e===Gy))if(this.options.to==="string"){let m=uw.utf8border(t.output,t.next_out),g=t.next_out-m,b=uw.buf2string(t.output,m);t.next_out=g,t.avail_out=r-g,g&&t.output.set(t.output.subarray(m,m+g),0),this.onData(b)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(e===ng&&f===0)){if(e===Gy)return e=Vu.inflateEnd(this.strm),this.onEnd(e),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};mg.prototype.onData=function(n){this.chunks.push(n)};mg.prototype.onEnd=function(n){n===ng&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=yj.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function i9(n,a){const t=new mg(a);if(t.push(n),t.err)throw t.msg||dw[t.err];return t.result}var o9=mg,l9=i9,c9={Inflate:o9,inflate:l9};const{Inflate:A9,inflate:d9}=c9;var b3=A9,u9=d9;const Lj=[];for(let n=0;n<256;n++){let a=n;for(let t=0;t<8;t++)a&1?a=3988292384^a>>>1:a=a>>>1;Lj[n]=a}const y3=4294967295;function f9(n,a,t){let r=n;for(let s=0;s<t;s++)r=Lj[(r^a[s])&255]^r>>>8;return r}function h9(n,a){return(f9(y3,n,a)^y3)>>>0}function v3(n,a,t){const r=n.readUint32(),s=h9(new Uint8Array(n.buffer,n.byteOffset+n.offset-a-4,a),a);if(s!==r)throw new Error(`CRC mismatch for chunk ${t}. Expected ${r}, found ${s}`)}function Uj(n,a,t){for(let r=0;r<t;r++)a[r]=n[r]}function Mj(n,a,t,r){let s=0;for(;s<r;s++)a[s]=n[s];for(;s<t;s++)a[s]=n[s]+a[s-r]&255}function Ij(n,a,t,r){let s=0;if(t.length===0)for(;s<r;s++)a[s]=n[s];else for(;s<r;s++)a[s]=n[s]+t[s]&255}function Oj(n,a,t,r,s){let e=0;if(t.length===0){for(;e<s;e++)a[e]=n[e];for(;e<r;e++)a[e]=n[e]+(a[e-s]>>1)&255}else{for(;e<s;e++)a[e]=n[e]+(t[e]>>1)&255;for(;e<r;e++)a[e]=n[e]+(a[e-s]+t[e]>>1)&255}}function Qj(n,a,t,r,s){let e=0;if(t.length===0){for(;e<s;e++)a[e]=n[e];for(;e<r;e++)a[e]=n[e]+a[e-s]&255}else{for(;e<s;e++)a[e]=n[e]+t[e]&255;for(;e<r;e++)a[e]=n[e]+m9(a[e-s],t[e],t[e-s])&255}}function m9(n,a,t){const r=n+a-t,s=Math.abs(r-n),e=Math.abs(r-a),u=Math.abs(r-t);return s<=e&&s<=u?n:e<=u?a:t}function p9(n,a,t,r,s,e){switch(n){case 0:Uj(a,t,s);break;case 1:Mj(a,t,s,e);break;case 2:Ij(a,t,r,s);break;case 3:Oj(a,t,r,s,e);break;case 4:Qj(a,t,r,s,e);break;default:throw new Error(`Unsupported filter: ${n}`)}}const g9=new Uint16Array([255]),x9=new Uint8Array(g9.buffer),b9=x9[0]===255;function y9(n){const{data:a,width:t,height:r,channels:s,depth:e}=n,u=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],f=Math.ceil(e/8)*s,m=new Uint8Array(r*t*f);let g=0;for(let b=0;b<7;b++){const j=u[b],F=Math.ceil((t-j.x)/j.xStep),C=Math.ceil((r-j.y)/j.yStep);if(F<=0||C<=0)continue;const M=F*f,_=new Uint8Array(M);for(let L=0;L<C;L++){const T=a[g++],H=a.subarray(g,g+M);g+=M;const O=new Uint8Array(M);p9(T,H,O,_,M,f),_.set(O);for(let Q=0;Q<F;Q++){const Z=j.x+Q*j.xStep,ee=j.y+L*j.yStep;if(!(Z>=t||ee>=r))for(let se=0;se<f;se++)m[(ee*t+Z)*f+se]=O[Q*f+se]}}}if(e===16){const b=new Uint16Array(m.buffer);if(b9)for(let j=0;j<b.length;j++)b[j]=v9(b[j]);return b}else return m}function v9(n){return(n&255)<<8|n>>8&255}const w9=new Uint16Array([255]),N9=new Uint8Array(w9.buffer),C9=N9[0]===255,j9=new Uint8Array(0);function w3(n){const{data:a,width:t,height:r,channels:s,depth:e}=n,u=Math.ceil(e/8)*s,f=Math.ceil(e/8*s*t),m=new Uint8Array(r*f);let g=j9,b=0,j,F;for(let C=0;C<r;C++){switch(j=a.subarray(b+1,b+1+f),F=m.subarray(C*f,(C+1)*f),a[b]){case 0:Uj(j,F,f);break;case 1:Mj(j,F,f,u);break;case 2:Ij(j,F,g,f);break;case 3:Oj(j,F,g,f,u);break;case 4:Qj(j,F,g,f,u);break;default:throw new Error(`Unsupported filter: ${a[b]}`)}g=F,b+=f+1}if(e===16){const C=new Uint16Array(m.buffer);if(C9)for(let M=0;M<C.length;M++)C[M]=B9(C[M]);return C}else return m}function B9(n){return(n&255)<<8|n>>8&255}const N2=Uint8Array.of(137,80,78,71,13,10,26,10);function N3(n){if(!S9(n.readBytes(N2.length)))throw new Error("wrong PNG signature")}function S9(n){if(n.length<N2.length)return!1;for(let a=0;a<N2.length;a++)if(n[a]!==N2[a])return!1;return!0}const F9="tEXt",E9=0,Rj=new TextDecoder("latin1");function k9(n){if(T9(n),n.length===0||n.length>79)throw new Error("keyword length must be between 1 and 79")}const D9=/^[\u0000-\u00FF]*$/;function T9(n){if(!D9.test(n))throw new Error("invalid latin1 text")}function _9(n,a,t){const r=Pj(a);n[r]=L9(a,t-r.length-1)}function Pj(n){for(n.mark();n.readByte()!==E9;);const a=n.offset;n.reset();const t=Rj.decode(n.readBytes(a-n.offset-1));return n.skip(1),k9(t),t}function L9(n,a){return Rj.decode(n.readBytes(a))}const oA={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Yy={UNKNOWN:-1,DEFLATE:0},C3={UNKNOWN:-1,ADAPTIVE:0},Wy={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Dx={NONE:0,BACKGROUND:1,PREVIOUS:2},$y={SOURCE:0,OVER:1};class U9 extends y5{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(a,t={}){super(a);const{checkCrc:r=!1}=t;this._checkCrc=r,this._inflator=new b3,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Yy.UNKNOWN,this._filterMethod=C3.UNKNOWN,this._interlaceMethod=Wy.UNKNOWN,this._colorType=oA.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(N3(this);!this._end;){const a=this.readUint32(),t=this.readChars(4);this.decodeChunk(a,t)}return this.decodeImage(),this._png}decodeApng(){for(N3(this);!this._end;){const a=this.readUint32(),t=this.readChars(4);this.decodeApngChunk(a,t)}return this.decodeApngImage(),this._apng}decodeChunk(a,t){const r=this.offset;switch(t){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(a);break;case"IDAT":this.decodeIDAT(a);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(a);break;case"iCCP":this.decodeiCCP(a);break;case F9:_9(this._png.text,this,a);break;case"pHYs":this.decodepHYs();break;default:this.skip(a);break}if(this.offset-r!==a)throw new Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?v3(this,a+4,t):this.skip(4)}decodeApngChunk(a,t){const r=this.offset;switch(t!=="fdAT"&&t!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),t){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(a);break;default:this.decodeChunk(a,t),this.offset=r+a;break}if(this.offset-r!==a)throw new Error(`Length mismatch while decoding chunk ${t}`);this._checkCrc?v3(this,a+4,t):this.skip(4)}decodeIHDR(){const a=this._png;a.width=this.readUint32(),a.height=this.readUint32(),a.depth=M9(this.readUint8());const t=this.readUint8();this._colorType=t;let r;switch(t){case oA.GREYSCALE:r=1;break;case oA.TRUECOLOUR:r=3;break;case oA.INDEXED_COLOUR:r=1;break;case oA.GREYSCALE_ALPHA:r=2;break;case oA.TRUECOLOUR_ALPHA:r=4;break;case oA.UNKNOWN:default:throw new Error(`Unknown color type: ${t}`)}if(this._png.channels=r,this._compressionMethod=this.readUint8(),this._compressionMethod!==Yy.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const a={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(a)}decodePLTE(a){if(a%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${a}`);const t=a/3;this._hasPalette=!0;const r=[];this._palette=r;for(let s=0;s<t;s++)r.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(a){this._writingDataChunks=!0;const t=a,r=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,r,t)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(a)}decodeFDAT(a){this._writingDataChunks=!0;let t=a,r=this.offset+this.byteOffset;if(r+=4,t-=4,this._inflator.push(new Uint8Array(this.buffer,r,t)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(a)}decodetRNS(a){switch(this._colorType){case oA.GREYSCALE:case oA.TRUECOLOUR:{if(a%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${a}`);if(a/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${a/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(a/2);for(let t=0;t<a/2;t++)this._transparency[t]=this.readUint16();break}case oA.INDEXED_COLOUR:{if(a>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${a} vs ${this._palette.length})`);let t=0;for(;t<a;t++){const r=this.readByte();this._palette[t].push(r)}for(;t<this._palette.length;t++)this._palette[t].push(255);break}case oA.UNKNOWN:case oA.GREYSCALE_ALPHA:case oA.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(a){const t=Pj(this),r=this.readUint8();if(r!==Yy.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${r}`);const s=this.readBytes(a-t.length-2);this._png.iccEmbeddedProfile={name:t,profile:u9(s)}}decodepHYs(){const a=this.readUint32(),t=this.readUint32(),r=this.readByte();this._png.resolution={x:a,y:t,unit:r}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let a=0;a<this._numberOfFrames;a++){const t={sequenceNumber:this._frames[a].sequenceNumber,delayNumber:this._frames[a].delayNumber,delayDenominator:this._frames[a].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},r=this._frames.at(a);if(r){if(r.data=w3({data:r.data,width:r.width,height:r.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),a===0||r.xOffset===0&&r.yOffset===0&&r.width===this._png.width&&r.height===this._png.height)t.data=r.data;else{const s=this._apng.frames.at(a-1);this.disposeFrame(r,s,t),this.addFrameDataToCanvas(t,r)}this._apng.frames.push(t)}}return this._apng}disposeFrame(a,t,r){switch(a.disposeOp){case Dx.NONE:break;case Dx.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let e=0;e<this._png.width;e++){const u=(s*a.width+e)*this._png.channels;for(let f=0;f<this._png.channels;f++)r.data[u+f]=0}break;case Dx.PREVIOUS:r.data.set(t.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(a,t){const r=1<<this._png.depth,s=(e,u)=>{const f=((e+t.yOffset)*this._png.width+t.xOffset+u)*this._png.channels,m=(e*t.width+u)*this._png.channels;return{index:f,frameIndex:m}};switch(t.blendOp){case $y.SOURCE:for(let e=0;e<t.height;e++)for(let u=0;u<t.width;u++){const{index:f,frameIndex:m}=s(e,u);for(let g=0;g<this._png.channels;g++)a.data[f+g]=t.data[m+g]}break;case $y.OVER:for(let e=0;e<t.height;e++)for(let u=0;u<t.width;u++){const{index:f,frameIndex:m}=s(e,u);for(let g=0;g<this._png.channels;g++){const b=t.data[m+this._png.channels-1]/r,j=g%(this._png.channels-1)===0?1:t.data[m+g],F=Math.floor(b*j+(1-b)*a.data[f+g]);a.data[f+g]+=F}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const a=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==C3.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Wy.NO_INTERLACE)this._png.data=w3({data:a,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Wy.ADAM7)this._png.data=y9({data:a,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const a=this._inflator.result,t=this._frames.at(-1);t?t.data=a:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Dx.NONE,blendOp:$y.SOURCE,data:a}),this._inflator=new b3,this._writingDataChunks=!1}}function M9(n){if(n!==1&&n!==2&&n!==4&&n!==8&&n!==16)throw new Error(`invalid bit depth: ${n}`);return n}var j3;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.METRE=1]="METRE"})(j3||(j3={}));function I9(n,a){return new U9(n,a).decode()}var Ua=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function qy(){Ua.console&&typeof Ua.console.log=="function"&&Ua.console.log.apply(Ua.console,arguments)}var Rn={log:qy,warn:function(n){Ua.console&&(typeof Ua.console.warn=="function"?Ua.console.warn.apply(Ua.console,arguments):qy.call(null,arguments))},error:function(n){Ua.console&&(typeof Ua.console.error=="function"?Ua.console.error.apply(Ua.console,arguments):qy(n))}};function Xy(n,a,t){var r=new XMLHttpRequest;r.open("GET",n),r.responseType="blob",r.onload=function(){ah(r.response,a,t)},r.onerror=function(){Rn.error("could not download file")},r.send()}function B3(n){var a=new XMLHttpRequest;a.open("HEAD",n,!1);try{a.send()}catch{}return a.status>=200&&a.status<=299}function Tx(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(a)}}var ah=Ua.saveAs||((typeof window>"u"?"undefined":wn(window))!=="object"||window!==Ua?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(n,a,t){var r=Ua.URL||Ua.webkitURL,s=document.createElement("a");a=a||n.name||"download",s.download=a,s.rel="noopener",typeof n=="string"?(s.href=n,s.origin!==location.origin?B3(s.href)?Xy(n,a,t):Tx(s,s.target="_blank"):Tx(s)):(s.href=r.createObjectURL(n),setTimeout(function(){r.revokeObjectURL(s.href)},4e4),setTimeout(function(){Tx(s)},0))}:"msSaveOrOpenBlob"in navigator?function(n,a,t){if(a=a||n.name||"download",typeof n=="string")if(B3(n))Xy(n,a,t);else{var r=document.createElement("a");r.href=n,r.target="_blank",setTimeout(function(){Tx(r)})}else navigator.msSaveOrOpenBlob((function(s,e){return e===void 0?e={autoBom:!1}:wn(e)!=="object"&&(Rn.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s})(n,t),a)}:function(n,a,t,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof n=="string")return Xy(n,a,t);var s=n.type==="application/octet-stream",e=/constructor/i.test(Ua.HTMLElement)||Ua.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||s&&e)&&(typeof FileReader>"u"?"undefined":wn(FileReader))==="object"){var f=new FileReader;f.onloadend=function(){var b=f.result;b=u?b:b.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=b:location=b,r=null},f.readAsDataURL(n)}else{var m=Ua.URL||Ua.webkitURL,g=m.createObjectURL(n);r?r.location=g:location.href=g,r=null,setTimeout(function(){m.revokeObjectURL(g)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Hj(n){var a;n=n||"",this.ok=!1,n.charAt(0)=="#"&&(n=n.substr(1,6)),n={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[n=(n=n.replace(/ /g,"")).toLowerCase()]||n;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(f){return[parseInt(f[1]),parseInt(f[2]),parseInt(f[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(f){return[parseInt(f[1],16),parseInt(f[2],16),parseInt(f[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(f){return[parseInt(f[1]+f[1],16),parseInt(f[2]+f[2],16),parseInt(f[3]+f[3],16)]}}],r=0;r<t.length;r++){var s=t[r].re,e=t[r].process,u=s.exec(n);u&&(a=e(u),this.r=a[0],this.g=a[1],this.b=a[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var f=this.r.toString(16),m=this.g.toString(16),g=this.b.toString(16);return f.length==1&&(f="0"+f),m.length==1&&(m="0"+m),g.length==1&&(g="0"+g),"#"+f+m+g}}var C2=Ua.atob.bind(Ua),S3=Ua.btoa.bind(Ua);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Jy(n,a){var t=n[0],r=n[1],s=n[2],e=n[3];t=_l(t,r,s,e,a[0],7,-680876936),e=_l(e,t,r,s,a[1],12,-389564586),s=_l(s,e,t,r,a[2],17,606105819),r=_l(r,s,e,t,a[3],22,-1044525330),t=_l(t,r,s,e,a[4],7,-176418897),e=_l(e,t,r,s,a[5],12,1200080426),s=_l(s,e,t,r,a[6],17,-1473231341),r=_l(r,s,e,t,a[7],22,-45705983),t=_l(t,r,s,e,a[8],7,1770035416),e=_l(e,t,r,s,a[9],12,-1958414417),s=_l(s,e,t,r,a[10],17,-42063),r=_l(r,s,e,t,a[11],22,-1990404162),t=_l(t,r,s,e,a[12],7,1804603682),e=_l(e,t,r,s,a[13],12,-40341101),s=_l(s,e,t,r,a[14],17,-1502002290),t=Ll(t,r=_l(r,s,e,t,a[15],22,1236535329),s,e,a[1],5,-165796510),e=Ll(e,t,r,s,a[6],9,-1069501632),s=Ll(s,e,t,r,a[11],14,643717713),r=Ll(r,s,e,t,a[0],20,-373897302),t=Ll(t,r,s,e,a[5],5,-701558691),e=Ll(e,t,r,s,a[10],9,38016083),s=Ll(s,e,t,r,a[15],14,-660478335),r=Ll(r,s,e,t,a[4],20,-405537848),t=Ll(t,r,s,e,a[9],5,568446438),e=Ll(e,t,r,s,a[14],9,-1019803690),s=Ll(s,e,t,r,a[3],14,-187363961),r=Ll(r,s,e,t,a[8],20,1163531501),t=Ll(t,r,s,e,a[13],5,-1444681467),e=Ll(e,t,r,s,a[2],9,-51403784),s=Ll(s,e,t,r,a[7],14,1735328473),t=Ul(t,r=Ll(r,s,e,t,a[12],20,-1926607734),s,e,a[5],4,-378558),e=Ul(e,t,r,s,a[8],11,-2022574463),s=Ul(s,e,t,r,a[11],16,1839030562),r=Ul(r,s,e,t,a[14],23,-35309556),t=Ul(t,r,s,e,a[1],4,-1530992060),e=Ul(e,t,r,s,a[4],11,1272893353),s=Ul(s,e,t,r,a[7],16,-155497632),r=Ul(r,s,e,t,a[10],23,-1094730640),t=Ul(t,r,s,e,a[13],4,681279174),e=Ul(e,t,r,s,a[0],11,-358537222),s=Ul(s,e,t,r,a[3],16,-722521979),r=Ul(r,s,e,t,a[6],23,76029189),t=Ul(t,r,s,e,a[9],4,-640364487),e=Ul(e,t,r,s,a[12],11,-421815835),s=Ul(s,e,t,r,a[15],16,530742520),t=Ml(t,r=Ul(r,s,e,t,a[2],23,-995338651),s,e,a[0],6,-198630844),e=Ml(e,t,r,s,a[7],10,1126891415),s=Ml(s,e,t,r,a[14],15,-1416354905),r=Ml(r,s,e,t,a[5],21,-57434055),t=Ml(t,r,s,e,a[12],6,1700485571),e=Ml(e,t,r,s,a[3],10,-1894986606),s=Ml(s,e,t,r,a[10],15,-1051523),r=Ml(r,s,e,t,a[1],21,-2054922799),t=Ml(t,r,s,e,a[8],6,1873313359),e=Ml(e,t,r,s,a[15],10,-30611744),s=Ml(s,e,t,r,a[6],15,-1560198380),r=Ml(r,s,e,t,a[13],21,1309151649),t=Ml(t,r,s,e,a[4],6,-145523070),e=Ml(e,t,r,s,a[11],10,-1120210379),s=Ml(s,e,t,r,a[2],15,718787259),r=Ml(r,s,e,t,a[9],21,-343485551),n[0]=Zf(t,n[0]),n[1]=Zf(r,n[1]),n[2]=Zf(s,n[2]),n[3]=Zf(e,n[3])}function Ib(n,a,t,r,s,e){return a=Zf(Zf(a,n),Zf(r,e)),Zf(a<<s|a>>>32-s,t)}function _l(n,a,t,r,s,e,u){return Ib(a&t|~a&r,n,a,s,e,u)}function Ll(n,a,t,r,s,e,u){return Ib(a&r|t&~r,n,a,s,e,u)}function Ul(n,a,t,r,s,e,u){return Ib(a^t^r,n,a,s,e,u)}function Ml(n,a,t,r,s,e,u){return Ib(t^(a|~r),n,a,s,e,u)}function zj(n){var a,t=n.length,r=[1732584193,-271733879,-1732584194,271733878];for(a=64;a<=n.length;a+=64)Jy(r,O9(n.substring(a-64,a)));n=n.substring(a-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(a=0;a<n.length;a++)s[a>>2]|=n.charCodeAt(a)<<(a%4<<3);if(s[a>>2]|=128<<(a%4<<3),a>55)for(Jy(r,s),a=0;a<16;a++)s[a]=0;return s[14]=8*t,Jy(r,s),r}function O9(n){var a,t=[];for(a=0;a<64;a+=4)t[a>>2]=n.charCodeAt(a)+(n.charCodeAt(a+1)<<8)+(n.charCodeAt(a+2)<<16)+(n.charCodeAt(a+3)<<24);return t}var F3="0123456789abcdef".split("");function Q9(n){for(var a="",t=0;t<4;t++)a+=F3[n>>8*t+4&15]+F3[n>>8*t&15];return a}function R9(n){return String.fromCharCode(255&n,(65280&n)>>8,(16711680&n)>>16,(4278190080&n)>>24)}function fw(n){return zj(n).map(R9).join("")}var P9=(function(n){for(var a=0;a<n.length;a++)n[a]=Q9(n[a]);return n.join("")})(zj("hello"))!="5d41402abc4b2a76b9719d911017c592";function Zf(n,a){if(P9){var t=(65535&n)+(65535&a);return(n>>16)+(a>>16)+(t>>16)<<16|65535&t}return n+a&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function hw(n,a){var t,r,s,e;if(n!==t){for(var u=(s=n,e=1+(256/n.length|0),new Array(e+1).join(s)),f=[],m=0;m<256;m++)f[m]=m;var g=0;for(m=0;m<256;m++){var b=f[m];g=(g+b+u.charCodeAt(m))%256,f[m]=f[g],f[g]=b}t=n,r=f}else f=r;var j=a.length,F=0,C=0,M="";for(m=0;m<j;m++)C=(C+(b=f[F=(F+1)%256]))%256,f[F]=f[C],f[C]=b,u=f[(f[F]+f[C])%256],M+=String.fromCharCode(a.charCodeAt(m)^u);return M}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var E3={print:4,modify:8,copy:16,"annot-forms":32};function Mm(n,a,t,r){this.v=1,this.r=2;var s=192;n.forEach(function(f){if(E3.perm!==void 0)throw new Error("Invalid permission: "+f);s+=E3[f]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var e=(a+this.padding).substr(0,32),u=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(e,u),this.P=-(1+(255^s)),this.encryptionKey=fw(e+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=hw(this.encryptionKey,this.padding)}function Im(n){if(/[^\u0000-\u00ff]/.test(n))throw new Error("Invalid PDF Name Object: "+n+", Only accept ASCII characters.");for(var a="",t=n.length,r=0;r<t;r++){var s=n.charCodeAt(r);a+=s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?"#"+("0"+s.toString(16)).slice(-2):n[r]}return a}function k3(n){if(wn(n)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var a={};this.subscribe=function(t,r,s){if(s=s||!1,typeof t!="string"||typeof r!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");a.hasOwnProperty(t)||(a[t]={});var e=Math.random().toString(35);return a[t][e]=[r,!!s],e},this.unsubscribe=function(t){for(var r in a)if(a[r][t])return delete a[r][t],Object.keys(a[r]).length===0&&delete a[r],!0;return!1},this.publish=function(t){if(a.hasOwnProperty(t)){var r=Array.prototype.slice.call(arguments,1),s=[];for(var e in a[t]){var u=a[t][e];try{u[0].apply(n,r)}catch(f){Ua.console&&Rn.error("jsPDF PubSub Error",f.message,f)}u[1]&&s.push(e)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return a}}function J2(n){if(!(this instanceof J2))return new J2(n);var a="opacity,stroke-opacity".split(",");for(var t in n)n.hasOwnProperty(t)&&a.indexOf(t)>=0&&(this[t]=n[t]);this.id="",this.objectNumber=-1}function Kj(n,a){this.gState=n,this.matrix=a,this.id="",this.objectNumber=-1}function ih(n,a,t,r,s){if(!(this instanceof ih))return new ih(n,a,t,r,s);this.type=n==="axial"?2:3,this.coords=a,this.colors=t,Kj.call(this,r,s)}function Hm(n,a,t,r,s){if(!(this instanceof Hm))return new Hm(n,a,t,r,s);this.boundingBox=n,this.xStep=a,this.yStep=t,this.stream="",this.cloneIndex=0,Kj.call(this,r,s)}function ua(n){var a,t=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],s=arguments[2],e=arguments[3],u=[],f=1,m=16,g="S",b=null;wn(n=n||{})==="object"&&(t=n.orientation,r=n.unit||r,s=n.format||s,e=n.compress||n.compressPdf||e,(b=n.encryption||null)!==null&&(b.userPassword=b.userPassword||"",b.ownerPassword=b.ownerPassword||"",b.userPermissions=b.userPermissions||[]),f=typeof n.userUnit=="number"?Math.abs(n.userUnit):1,n.precision!==void 0&&(a=n.precision),n.floatPrecision!==void 0&&(m=n.floatPrecision),g=n.defaultPathOperation||"S"),u=n.filters||(e===!0?["FlateEncode"]:u),r=r||"mm",t=(""+(t||"P")).toLowerCase();var j=n.putOnlyUsedFonts||!1,F={},C={internal:{},__private__:{}};C.__private__.PubSub=k3;var M="1.3",_=C.__private__.getPdfVersion=function(){return M};C.__private__.setPdfVersion=function(R){M=R};var L={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};C.__private__.getPageFormats=function(){return L};var T=C.__private__.getPageFormat=function(R){return L[R]};s=s||"a4";var H="compat",O="advanced",Q=H;function Z(){this.saveGraphicsState(),Se(new ra(Mr,0,0,-Mr,0,dc()*Mr).toString()+" cm"),this.setFontSize(this.getFontSize()/Mr),g="n",Q=O}function ee(){this.restoreGraphicsState(),g="S",Q=H}var se=C.__private__.combineFontStyleAndFontWeight=function(R,Ce){if(R=="bold"&&Ce=="normal"||R=="bold"&&Ce==400||R=="normal"&&Ce=="italic"||R=="bold"&&Ce=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Ce&&(R=Ce==400||Ce==="normal"?R==="italic"?"italic":"normal":Ce!=700&&Ce!=="bold"||R!=="normal"?(Ce==700?"bold":Ce)+""+R:"bold"),R};C.advancedAPI=function(R){var Ce=Q===H;return Ce&&Z.call(this),typeof R!="function"||(R(this),Ce&&ee.call(this)),this},C.compatAPI=function(R){var Ce=Q===O;return Ce&&ee.call(this),typeof R!="function"||(R(this),Ce&&Z.call(this)),this},C.isAdvancedAPI=function(){return Q===O};var ue,ae=function(R){if(Q!==O)throw new Error(R+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},pe=C.roundToPrecision=C.__private__.roundToPrecision=function(R,Ce){var Ke=a||Ce;if(isNaN(R)||isNaN(Ke))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return R.toFixed(Ke).replace(/0+$/,"")};ue=C.hpf=C.__private__.hpf=typeof m=="number"?function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.hpf");return pe(R,m)}:m==="smart"?function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.hpf");return pe(R,R>-1&&R<1?16:5)}:function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.hpf");return pe(R,16)};var z=C.f2=C.__private__.f2=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.f2");return pe(R,2)},J=C.__private__.f3=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.f3");return pe(R,3)},ge=C.scale=C.__private__.scale=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.scale");return Q===H?R*Mr:Q===O?R:void 0},fe=function(R){return ge((function(Ce){return Q===H?dc()-Ce:Q===O?Ce:void 0})(R))};C.__private__.setPrecision=C.setPrecision=function(R){typeof parseInt(R,10)=="number"&&(a=parseInt(R,10))};var ke,he="00000000000000000000000000000000",Ne=C.__private__.getFileId=function(){return he},xe=C.__private__.setFileId=function(R){return he=R!==void 0&&/^[a-fA-F0-9]{32}$/.test(R)?R.toUpperCase():he.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),b!==null&&(Gs=new Mm(b.userPermissions,b.userPassword,b.ownerPassword,he)),he};C.setFileId=function(R){return xe(R),this},C.getFileId=function(){return Ne()};var we=C.__private__.convertDateToPDFDate=function(R){var Ce=R.getTimezoneOffset(),Ke=Ce<0?"+":"-",Xe=Math.floor(Math.abs(Ce/60)),nt=Math.abs(Ce%60),Lt=[Ke,de(Xe),"'",de(nt),"'"].join("");return["D:",R.getFullYear(),de(R.getMonth()+1),de(R.getDate()),de(R.getHours()),de(R.getMinutes()),de(R.getSeconds()),Lt].join("")},ye=C.__private__.convertPDFDateToDate=function(R){var Ce=parseInt(R.substr(2,4),10),Ke=parseInt(R.substr(6,2),10)-1,Xe=parseInt(R.substr(8,2),10),nt=parseInt(R.substr(10,2),10),Lt=parseInt(R.substr(12,2),10),Gt=parseInt(R.substr(14,2),10);return new Date(Ce,Ke,Xe,nt,Lt,Gt,0)},te=C.__private__.setCreationDate=function(R){var Ce;if(R===void 0&&(R=new Date),R instanceof Date)Ce=we(R);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(R))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Ce=R}return ke=Ce},V=C.__private__.getCreationDate=function(R){var Ce=ke;return R==="jsDate"&&(Ce=ye(ke)),Ce};C.setCreationDate=function(R){return te(R),this},C.getCreationDate=function(R){return V(R)};var le,de=C.__private__.padd2=function(R){return("0"+parseInt(R)).slice(-2)},X=C.__private__.padd2Hex=function(R){return("00"+(R=R.toString())).substr(R.length)},ie=0,G=[],q=[],ve=0,Fe=[],Qe=[],Ge=!1,je=q;C.__private__.setCustomOutputDestination=function(R){Ge=!0,je=R};var Me=function(R){Ge||(je=R)};C.__private__.resetCustomOutputDestination=function(){Ge=!1,je=q};var Se=C.__private__.out=function(R){return R=R.toString(),ve+=R.length+1,je.push(R),je},ft=C.__private__.write=function(R){return Se(arguments.length===1?R.toString():Array.prototype.join.call(arguments," "))},jt=C.__private__.getArrayBuffer=function(R){for(var Ce=R.length,Ke=new ArrayBuffer(Ce),Xe=new Uint8Array(Ke);Ce--;)Xe[Ce]=R.charCodeAt(Ce);return Ke},It=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];C.__private__.getStandardFonts=function(){return It};var ut=n.fontSize||16;C.__private__.setFontSize=C.setFontSize=function(R){return ut=Q===O?R/Mr:R,this};var Rt,Ye=C.__private__.getFontSize=C.getFontSize=function(){return Q===H?ut:ut*Mr},St=n.R2L||!1;C.__private__.setR2L=C.setR2L=function(R){return St=R,this},C.__private__.getR2L=C.getR2L=function(){return St};var Jt,mr=C.__private__.setZoomMode=function(R){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(R))Rt=R;else if(isNaN(R)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(R)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+R+'" is not recognized.');Rt=R}else Rt=parseInt(R,10)};C.__private__.getZoomMode=function(){return Rt};var ar,bt=C.__private__.setPageMode=function(R){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(R)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+R+'" is not recognized.');Jt=R};C.__private__.getPageMode=function(){return Jt};var Yt=C.__private__.setLayoutMode=function(R){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(R)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+R+'" is not recognized.');ar=R};C.__private__.getLayoutMode=function(){return ar},C.__private__.setDisplayMode=C.setDisplayMode=function(R,Ce,Ke){return mr(R),Yt(Ce),bt(Ke),this};var vr={title:"",subject:"",author:"",keywords:"",creator:""};C.__private__.getDocumentProperty=function(R){if(Object.keys(vr).indexOf(R)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return vr[R]},C.__private__.getDocumentProperties=function(){return vr},C.__private__.setDocumentProperties=C.setProperties=C.setDocumentProperties=function(R){for(var Ce in vr)vr.hasOwnProperty(Ce)&&R[Ce]&&(vr[Ce]=R[Ce]);return this},C.__private__.setDocumentProperty=function(R,Ce){if(Object.keys(vr).indexOf(R)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return vr[R]=Ce};var gr,Mr,Ot,ja,oa,hr={},pr={},Gr=[],Pr={},wa={},jr={},Ms={},Rs=null,or=0,Nr=[],$t=new k3(C),Vo=n.hotfixes||[],Hn={},hs={},co=[],ra=function R(Ce,Ke,Xe,nt,Lt,Gt){if(!(this instanceof R))return new R(Ce,Ke,Xe,nt,Lt,Gt);isNaN(Ce)&&(Ce=1),isNaN(Ke)&&(Ke=0),isNaN(Xe)&&(Xe=0),isNaN(nt)&&(nt=1),isNaN(Lt)&&(Lt=0),isNaN(Gt)&&(Gt=0),this._matrix=[Ce,Ke,Xe,nt,Lt,Gt]};Object.defineProperty(ra.prototype,"sx",{get:function(){return this._matrix[0]},set:function(R){this._matrix[0]=R}}),Object.defineProperty(ra.prototype,"shy",{get:function(){return this._matrix[1]},set:function(R){this._matrix[1]=R}}),Object.defineProperty(ra.prototype,"shx",{get:function(){return this._matrix[2]},set:function(R){this._matrix[2]=R}}),Object.defineProperty(ra.prototype,"sy",{get:function(){return this._matrix[3]},set:function(R){this._matrix[3]=R}}),Object.defineProperty(ra.prototype,"tx",{get:function(){return this._matrix[4]},set:function(R){this._matrix[4]=R}}),Object.defineProperty(ra.prototype,"ty",{get:function(){return this._matrix[5]},set:function(R){this._matrix[5]=R}}),Object.defineProperty(ra.prototype,"a",{get:function(){return this._matrix[0]},set:function(R){this._matrix[0]=R}}),Object.defineProperty(ra.prototype,"b",{get:function(){return this._matrix[1]},set:function(R){this._matrix[1]=R}}),Object.defineProperty(ra.prototype,"c",{get:function(){return this._matrix[2]},set:function(R){this._matrix[2]=R}}),Object.defineProperty(ra.prototype,"d",{get:function(){return this._matrix[3]},set:function(R){this._matrix[3]=R}}),Object.defineProperty(ra.prototype,"e",{get:function(){return this._matrix[4]},set:function(R){this._matrix[4]=R}}),Object.defineProperty(ra.prototype,"f",{get:function(){return this._matrix[5]},set:function(R){this._matrix[5]=R}}),Object.defineProperty(ra.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(ra.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(ra.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(ra.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),ra.prototype.join=function(R){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(ue).join(R)},ra.prototype.multiply=function(R){var Ce=R.sx*this.sx+R.shy*this.shx,Ke=R.sx*this.shy+R.shy*this.sy,Xe=R.shx*this.sx+R.sy*this.shx,nt=R.shx*this.shy+R.sy*this.sy,Lt=R.tx*this.sx+R.ty*this.shx+this.tx,Gt=R.tx*this.shy+R.ty*this.sy+this.ty;return new ra(Ce,Ke,Xe,nt,Lt,Gt)},ra.prototype.decompose=function(){var R=this.sx,Ce=this.shy,Ke=this.shx,Xe=this.sy,nt=this.tx,Lt=this.ty,Gt=Math.sqrt(R*R+Ce*Ce),Ir=(R/=Gt)*Ke+(Ce/=Gt)*Xe;Ke-=R*Ir,Xe-=Ce*Ir;var Qr=Math.sqrt(Ke*Ke+Xe*Xe);return Ir/=Qr,R*(Xe/=Qr)<Ce*(Ke/=Qr)&&(R=-R,Ce=-Ce,Ir=-Ir,Gt=-Gt),{scale:new ra(Gt,0,0,Qr,0,0),translate:new ra(1,0,0,1,nt,Lt),rotate:new ra(R,Ce,-Ce,R,0,0),skew:new ra(1,0,Ir,1,0,0)}},ra.prototype.toString=function(R){return this.join(" ")},ra.prototype.inversed=function(){var R=this.sx,Ce=this.shy,Ke=this.shx,Xe=this.sy,nt=this.tx,Lt=this.ty,Gt=1/(R*Xe-Ce*Ke),Ir=Xe*Gt,Qr=-Ce*Gt,va=-Ke*Gt,Xr=R*Gt;return new ra(Ir,Qr,va,Xr,-Ir*nt-va*Lt,-Qr*nt-Xr*Lt)},ra.prototype.applyToPoint=function(R){var Ce=R.x*this.sx+R.y*this.shx+this.tx,Ke=R.x*this.shy+R.y*this.sy+this.ty;return new Kl(Ce,Ke)},ra.prototype.applyToRectangle=function(R){var Ce=this.applyToPoint(R),Ke=this.applyToPoint(new Kl(R.x+R.w,R.y+R.h));return new lc(Ce.x,Ce.y,Ke.x-Ce.x,Ke.y-Ce.y)},ra.prototype.clone=function(){var R=this.sx,Ce=this.shy,Ke=this.shx,Xe=this.sy,nt=this.tx,Lt=this.ty;return new ra(R,Ce,Ke,Xe,nt,Lt)},C.Matrix=ra;var ko=C.matrixMult=function(R,Ce){return Ce.multiply(R)},zi=new ra(1,0,0,1,0,0);C.unitMatrix=C.identityMatrix=zi;var ms=function(R,Ce){if(!wa[R]){var Ke=(Ce instanceof ih?"Sh":"P")+(Object.keys(Pr).length+1).toString(10);Ce.id=Ke,wa[R]=Ke,Pr[Ke]=Ce,$t.publish("addPattern",Ce)}};C.ShadingPattern=ih,C.TilingPattern=Hm,C.addShadingPattern=function(R,Ce){return ae("addShadingPattern()"),ms(R,Ce),this},C.beginTilingPattern=function(R){ae("beginTilingPattern()"),mA(R.boundingBox[0],R.boundingBox[1],R.boundingBox[2]-R.boundingBox[0],R.boundingBox[3]-R.boundingBox[1],R.matrix)},C.endTilingPattern=function(R,Ce){ae("endTilingPattern()"),Ce.stream=Qe[le].join(`
`),ms(R,Ce),$t.publish("endTilingPattern",Ce),co.pop().restore()};var pi,en=C.__private__.newObject=function(){var R=Tn();return _n(R,!0),R},Tn=C.__private__.newObjectDeferred=function(){return ie++,G[ie]=function(){return ve},ie},_n=function(R,Ce){return Ce=typeof Ce=="boolean"&&Ce,G[R]=ve,Ce&&Se(R+" 0 obj"),R},Yo=C.__private__.newAdditionalObject=function(){var R={objId:Tn(),content:""};return Fe.push(R),R},Si=Tn(),Is=Tn(),ba=C.__private__.decodeColorString=function(R){var Ce=R.split(" ");if(Ce.length!==2||Ce[1]!=="g"&&Ce[1]!=="G")Ce.length!==5||Ce[4]!=="k"&&Ce[4]!=="K"||(Ce=[(1-Ce[0])*(1-Ce[3]),(1-Ce[1])*(1-Ce[3]),(1-Ce[2])*(1-Ce[3]),"r"]);else{var Ke=parseFloat(Ce[0]);Ce=[Ke,Ke,Ke,"r"]}for(var Xe="#",nt=0;nt<3;nt++)Xe+=("0"+Math.floor(255*parseFloat(Ce[nt])).toString(16)).slice(-2);return Xe},Cn=C.__private__.encodeColorString=function(R){var Ce;typeof R=="string"&&(R={ch1:R});var Ke=R.ch1,Xe=R.ch2,nt=R.ch3,Lt=R.ch4,Gt=R.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Ke=="string"&&Ke.charAt(0)!=="#"){var Ir=new Hj(Ke);if(Ir.ok)Ke=Ir.toHex();else if(!/^\d*\.?\d*$/.test(Ke))throw new Error('Invalid color "'+Ke+'" passed to jsPDF.encodeColorString.')}if(typeof Ke=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Ke)&&(Ke="#"+Ke[1]+Ke[1]+Ke[2]+Ke[2]+Ke[3]+Ke[3]),typeof Ke=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Ke)){var Qr=parseInt(Ke.substr(1),16);Ke=Qr>>16&255,Xe=Qr>>8&255,nt=255&Qr}if(Xe===void 0||Lt===void 0&&Ke===Xe&&Xe===nt)Ce=typeof Ke=="string"?Ke+" "+Gt[0]:R.precision===2?z(Ke/255)+" "+Gt[0]:J(Ke/255)+" "+Gt[0];else if(Lt===void 0||wn(Lt)==="object"){if(Lt&&!isNaN(Lt.a)&&Lt.a===0)return["1.","1.","1.",Gt[1]].join(" ");Ce=typeof Ke=="string"?[Ke,Xe,nt,Gt[1]].join(" "):R.precision===2?[z(Ke/255),z(Xe/255),z(nt/255),Gt[1]].join(" "):[J(Ke/255),J(Xe/255),J(nt/255),Gt[1]].join(" ")}else Ce=typeof Ke=="string"?[Ke,Xe,nt,Lt,Gt[2]].join(" "):R.precision===2?[z(Ke),z(Xe),z(nt),z(Lt),Gt[2]].join(" "):[J(Ke),J(Xe),J(nt),J(Lt),Gt[2]].join(" ");return Ce},Oa=C.__private__.getFilters=function(){return u},ss=C.__private__.putStream=function(R){var Ce=(R=R||{}).data||"",Ke=R.filters||Oa(),Xe=R.alreadyAppliedFilters||[],nt=R.addLength1||!1,Lt=Ce.length,Gt=R.objectId,Ir=function(bi){return bi};if(b!==null&&Gt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");b!==null&&(Ir=Gs.encryptor(Gt,0));var Qr={};Ke===!0&&(Ke=["FlateEncode"]);var va=R.additionalKeyValues||[],Xr=(Qr=ua.API.processDataByFilters!==void 0?ua.API.processDataByFilters(Ce,Ke):{data:Ce,reverseChain:[]}).reverseChain+(Array.isArray(Xe)?Xe.join(" "):Xe.toString());if(Qr.data.length!==0&&(va.push({key:"Length",value:Qr.data.length}),nt===!0&&va.push({key:"Length1",value:Lt})),Xr.length!=0)if(Xr.split("/").length-1==1)va.push({key:"Filter",value:Xr});else{va.push({key:"Filter",value:"["+Xr+"]"});for(var $a=0;$a<va.length;$a+=1)if(va[$a].key==="DecodeParms"){for(var Mn=[],mn=0;mn<Qr.reverseChain.split("/").length-1;mn+=1)Mn.push("null");Mn.push(va[$a].value),va[$a].value="["+Mn.join(" ")+"]"}}Se("<<");for(var an=0;an<va.length;an++)Se("/"+va[an].key+" "+va[an].value);Se(">>"),Qr.data.length!==0&&(Se("stream"),Se(Ir(Qr.data)),Se("endstream"))},gi=C.__private__.putPage=function(R){var Ce=R.number,Ke=R.data,Xe=R.objId,nt=R.contentsObjId;_n(Xe,!0),Se("<</Type /Page"),Se("/Parent "+R.rootDictionaryObjId+" 0 R"),Se("/Resources "+R.resourceDictionaryObjId+" 0 R"),Se("/MediaBox ["+parseFloat(ue(R.mediaBox.bottomLeftX))+" "+parseFloat(ue(R.mediaBox.bottomLeftY))+" "+ue(R.mediaBox.topRightX)+" "+ue(R.mediaBox.topRightY)+"]"),R.cropBox!==null&&Se("/CropBox ["+ue(R.cropBox.bottomLeftX)+" "+ue(R.cropBox.bottomLeftY)+" "+ue(R.cropBox.topRightX)+" "+ue(R.cropBox.topRightY)+"]"),R.bleedBox!==null&&Se("/BleedBox ["+ue(R.bleedBox.bottomLeftX)+" "+ue(R.bleedBox.bottomLeftY)+" "+ue(R.bleedBox.topRightX)+" "+ue(R.bleedBox.topRightY)+"]"),R.trimBox!==null&&Se("/TrimBox ["+ue(R.trimBox.bottomLeftX)+" "+ue(R.trimBox.bottomLeftY)+" "+ue(R.trimBox.topRightX)+" "+ue(R.trimBox.topRightY)+"]"),R.artBox!==null&&Se("/ArtBox ["+ue(R.artBox.bottomLeftX)+" "+ue(R.artBox.bottomLeftY)+" "+ue(R.artBox.topRightX)+" "+ue(R.artBox.topRightY)+"]"),typeof R.userUnit=="number"&&R.userUnit!==1&&Se("/UserUnit "+R.userUnit),$t.publish("putPage",{objId:Xe,pageContext:Nr[Ce],pageNumber:Ce,page:Ke}),Se("/Contents "+nt+" 0 R"),Se(">>"),Se("endobj");var Lt=Ke.join(`
`);return Q===O&&(Lt+=`
Q`),_n(nt,!0),ss({data:Lt,filters:Oa(),objectId:nt}),Se("endobj"),Xe},Wo=C.__private__.putPages=function(){var R,Ce,Ke=[];for(R=1;R<=or;R++)Nr[R].objId=Tn(),Nr[R].contentsObjId=Tn();for(R=1;R<=or;R++)Ke.push(gi({number:R,data:Qe[R],objId:Nr[R].objId,contentsObjId:Nr[R].contentsObjId,mediaBox:Nr[R].mediaBox,cropBox:Nr[R].cropBox,bleedBox:Nr[R].bleedBox,trimBox:Nr[R].trimBox,artBox:Nr[R].artBox,userUnit:Nr[R].userUnit,rootDictionaryObjId:Si,resourceDictionaryObjId:Is}));_n(Si,!0),Se("<</Type /Pages");var Xe="/Kids [";for(Ce=0;Ce<or;Ce++)Xe+=Ke[Ce]+" 0 R ";Se(Xe+"]"),Se("/Count "+or),Se(">>"),Se("endobj"),$t.publish("postPutPages")},Fi=function(R){$t.publish("putFont",{font:R,out:Se,newObject:en,putStream:ss}),R.isAlreadyPutted!==!0&&(R.objectNumber=en(),Se("<<"),Se("/Type /Font"),Se("/BaseFont /"+Im(R.postScriptName)),Se("/Subtype /Type1"),typeof R.encoding=="string"&&Se("/Encoding /"+R.encoding),Se("/FirstChar 32"),Se("/LastChar 255"),Se(">>"),Se("endobj"))},Hl=function(R){R.objectNumber=en();var Ce=[];Ce.push({key:"Type",value:"/XObject"}),Ce.push({key:"Subtype",value:"/Form"}),Ce.push({key:"BBox",value:"["+[ue(R.x),ue(R.y),ue(R.x+R.width),ue(R.y+R.height)].join(" ")+"]"}),Ce.push({key:"Matrix",value:"["+R.matrix.toString()+"]"});var Ke=R.pages[1].join(`
`);ss({data:Ke,additionalKeyValues:Ce,objectId:R.objectNumber}),Se("endobj")},$o=function(R,Ce){Ce||(Ce=21);var Ke=en(),Xe=(function(Gt,Ir){var Qr,va=[],Xr=1/(Ir-1);for(Qr=0;Qr<1;Qr+=Xr)va.push(Qr);if(va.push(1),Gt[0].offset!=0){var $a={offset:0,color:Gt[0].color};Gt.unshift($a)}if(Gt[Gt.length-1].offset!=1){var Mn={offset:1,color:Gt[Gt.length-1].color};Gt.push(Mn)}for(var mn="",an=0,bi=0;bi<va.length;bi++){for(Qr=va[bi];Qr>Gt[an+1].offset;)an++;var ci=Gt[an].offset,Wi=(Qr-ci)/(Gt[an+1].offset-ci),el=Gt[an].color,_s=Gt[an+1].color;mn+=X(Math.round((1-Wi)*el[0]+Wi*_s[0]).toString(16))+X(Math.round((1-Wi)*el[1]+Wi*_s[1]).toString(16))+X(Math.round((1-Wi)*el[2]+Wi*_s[2]).toString(16))}return mn.trim()})(R.colors,Ce),nt=[];nt.push({key:"FunctionType",value:"0"}),nt.push({key:"Domain",value:"[0.0 1.0]"}),nt.push({key:"Size",value:"["+Ce+"]"}),nt.push({key:"BitsPerSample",value:"8"}),nt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),nt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ss({data:Xe,additionalKeyValues:nt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Ke}),Se("endobj"),R.objectNumber=en(),Se("<< /ShadingType "+R.type),Se("/ColorSpace /DeviceRGB");var Lt="/Coords ["+ue(parseFloat(R.coords[0]))+" "+ue(parseFloat(R.coords[1]))+" ";R.type===2?Lt+=ue(parseFloat(R.coords[2]))+" "+ue(parseFloat(R.coords[3])):Lt+=ue(parseFloat(R.coords[2]))+" "+ue(parseFloat(R.coords[3]))+" "+ue(parseFloat(R.coords[4]))+" "+ue(parseFloat(R.coords[5])),Se(Lt+="]"),R.matrix&&Se("/Matrix ["+R.matrix.toString()+"]"),Se("/Function "+Ke+" 0 R"),Se("/Extend [true true]"),Se(">>"),Se("endobj")},Do=function(R,Ce){var Ke=Tn(),Xe=en();Ce.push({resourcesOid:Ke,objectOid:Xe}),R.objectNumber=Xe;var nt=[];nt.push({key:"Type",value:"/Pattern"}),nt.push({key:"PatternType",value:"1"}),nt.push({key:"PaintType",value:"1"}),nt.push({key:"TilingType",value:"1"}),nt.push({key:"BBox",value:"["+R.boundingBox.map(ue).join(" ")+"]"}),nt.push({key:"XStep",value:ue(R.xStep)}),nt.push({key:"YStep",value:ue(R.yStep)}),nt.push({key:"Resources",value:Ke+" 0 R"}),R.matrix&&nt.push({key:"Matrix",value:"["+R.matrix.toString()+"]"}),ss({data:R.stream,additionalKeyValues:nt,objectId:R.objectNumber}),Se("endobj")},zl=function(R){for(var Ce in R.objectNumber=en(),Se("<<"),R)switch(Ce){case"opacity":Se("/ca "+z(R[Ce]));break;case"stroke-opacity":Se("/CA "+z(R[Ce]))}Se(">>"),Se("endobj")},Ln=function(R){_n(R.resourcesOid,!0),Se("<<"),Se("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var Ce in Se("/Font <<"),hr)hr.hasOwnProperty(Ce)&&(j===!1||j===!0&&F.hasOwnProperty(Ce))&&Se("/"+Ce+" "+hr[Ce].objectNumber+" 0 R");Se(">>")})(),(function(){if(Object.keys(Pr).length>0){for(var Ce in Se("/Shading <<"),Pr)Pr.hasOwnProperty(Ce)&&Pr[Ce]instanceof ih&&Pr[Ce].objectNumber>=0&&Se("/"+Ce+" "+Pr[Ce].objectNumber+" 0 R");$t.publish("putShadingPatternDict"),Se(">>")}})(),(function(Ce){if(Object.keys(Pr).length>0){for(var Ke in Se("/Pattern <<"),Pr)Pr.hasOwnProperty(Ke)&&Pr[Ke]instanceof C.TilingPattern&&Pr[Ke].objectNumber>=0&&Pr[Ke].objectNumber<Ce&&Se("/"+Ke+" "+Pr[Ke].objectNumber+" 0 R");$t.publish("putTilingPatternDict"),Se(">>")}})(R.objectOid),(function(){if(Object.keys(jr).length>0){var Ce;for(Ce in Se("/ExtGState <<"),jr)jr.hasOwnProperty(Ce)&&jr[Ce].objectNumber>=0&&Se("/"+Ce+" "+jr[Ce].objectNumber+" 0 R");$t.publish("putGStateDict"),Se(">>")}})(),(function(){for(var Ce in Se("/XObject <<"),Hn)Hn.hasOwnProperty(Ce)&&Hn[Ce].objectNumber>=0&&Se("/"+Ce+" "+Hn[Ce].objectNumber+" 0 R");$t.publish("putXobjectDict"),Se(">>")})(),Se(">>"),Se("endobj")},hn=function(R){pr[R.fontName]=pr[R.fontName]||{},pr[R.fontName][R.fontStyle]=R.id},tt=function(R,Ce,Ke,Xe,nt){var Lt={id:"F"+(Object.keys(hr).length+1).toString(10),postScriptName:R,fontName:Ce,fontStyle:Ke,encoding:Xe,isStandardFont:nt||!1,metadata:{}};return $t.publish("addFont",{font:Lt,instance:this}),hr[Lt.id]=Lt,hn(Lt),Lt.id},zt=C.__private__.pdfEscape=C.pdfEscape=function(R,Ce){return(function(Ke,Xe){var nt,Lt,Gt,Ir,Qr,va,Xr,$a,Mn;if(Gt=(Xe=Xe||{}).sourceEncoding||"Unicode",Qr=Xe.outputEncoding,(Xe.autoencode||Qr)&&hr[gr].metadata&&hr[gr].metadata[Gt]&&hr[gr].metadata[Gt].encoding&&(Ir=hr[gr].metadata[Gt].encoding,!Qr&&hr[gr].encoding&&(Qr=hr[gr].encoding),!Qr&&Ir.codePages&&(Qr=Ir.codePages[0]),typeof Qr=="string"&&(Qr=Ir[Qr]),Qr)){for(Xr=!1,va=[],nt=0,Lt=Ke.length;nt<Lt;nt++)($a=Qr[Ke.charCodeAt(nt)])?va.push(String.fromCharCode($a)):va.push(Ke[nt]),va[nt].charCodeAt(0)>>8&&(Xr=!0);Ke=va.join("")}for(nt=Ke.length;Xr===void 0&&nt!==0;)Ke.charCodeAt(nt-1)>>8&&(Xr=!0),nt--;if(!Xr)return Ke;for(va=Xe.noBOM?[]:[254,255],nt=0,Lt=Ke.length;nt<Lt;nt++){if((Mn=($a=Ke.charCodeAt(nt))>>8)>>8)throw new Error("Character at position "+nt+" of string '"+Ke+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");va.push(Mn),va.push($a-(Mn<<8))}return String.fromCharCode.apply(void 0,va)})(R,Ce).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},qt=C.__private__.beginPage=function(R){Qe[++or]=[],Nr[or]={objId:0,contentsObjId:0,userUnit:Number(f),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(R[0]),topRightY:Number(R[1])}},$r(or),Me(Qe[le])},Ct=function(R,Ce){var Ke,Xe,nt;switch(t=Ce||t,typeof R=="string"&&(Ke=T(R.toLowerCase()),Array.isArray(Ke)&&(Xe=Ke[0],nt=Ke[1])),Array.isArray(R)&&(Xe=R[0]*Mr,nt=R[1]*Mr),isNaN(Xe)&&(Xe=s[0],nt=s[1]),(Xe>14400||nt>14400)&&(Rn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Xe=Math.min(14400,Xe),nt=Math.min(14400,nt)),s=[Xe,nt],t.substr(0,1)){case"l":nt>Xe&&(s=[nt,Xe]);break;case"p":Xe>nt&&(s=[nt,Xe])}qt(s),vl(cs),Se(Yi),Nl!==0&&Se(Nl+" J"),Ts!==0&&Se(Ts+" j"),$t.publish("addPage",{pageNumber:or})},Ar=function(R){R>0&&R<=or&&(Qe.splice(R,1),Nr.splice(R,1),or--,le>or&&(le=or),this.setPage(le))},$r=function(R){R>0&&R<=or&&(le=R)},Ra=C.__private__.getNumberOfPages=C.getNumberOfPages=function(){return Qe.length-1},Ba=function(R,Ce,Ke){var Xe,nt=void 0;return Ke=Ke||{},R=R!==void 0?R:hr[gr].fontName,Ce=Ce!==void 0?Ce:hr[gr].fontStyle,Xe=R.toLowerCase(),pr[Xe]!==void 0&&pr[Xe][Ce]!==void 0?nt=pr[Xe][Ce]:pr[R]!==void 0&&pr[R][Ce]!==void 0?nt=pr[R][Ce]:Ke.disableWarning===!1&&Rn.warn("Unable to look up font label for font '"+R+"', '"+Ce+"'. Refer to getFontList() for available fonts."),nt||Ke.noFallback||(nt=pr.times[Ce])==null&&(nt=pr.times.normal),nt},tn=C.__private__.putInfo=function(){var R=en(),Ce=function(Xe){return Xe};for(var Ke in b!==null&&(Ce=Gs.encryptor(R,0)),Se("<<"),Se("/Producer ("+zt(Ce("jsPDF "+ua.version))+")"),vr)vr.hasOwnProperty(Ke)&&vr[Ke]&&Se("/"+Ke.substr(0,1).toUpperCase()+Ke.substr(1)+" ("+zt(Ce(vr[Ke]))+")");Se("/CreationDate ("+zt(Ce(ke))+")"),Se(">>"),Se("endobj")},ns=C.__private__.putCatalog=function(R){var Ce=(R=R||{}).rootDictionaryObjId||Si;switch(en(),Se("<<"),Se("/Type /Catalog"),Se("/Pages "+Ce+" 0 R"),Rt||(Rt="fullwidth"),Rt){case"fullwidth":Se("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Se("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Se("/OpenAction [3 0 R /Fit]");break;case"original":Se("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Ke=""+Rt;Ke.substr(Ke.length-1)==="%"&&(Rt=parseInt(Rt)/100),typeof Rt=="number"&&Se("/OpenAction [3 0 R /XYZ null null "+z(Rt)+"]")}switch(ar||(ar="continuous"),ar){case"continuous":Se("/PageLayout /OneColumn");break;case"single":Se("/PageLayout /SinglePage");break;case"two":case"twoleft":Se("/PageLayout /TwoColumnLeft");break;case"tworight":Se("/PageLayout /TwoColumnRight")}Jt&&Se("/PageMode /"+Jt),$t.publish("putCatalog"),Se(">>"),Se("endobj")},Pa=C.__private__.putTrailer=function(){Se("trailer"),Se("<<"),Se("/Size "+(ie+1)),Se("/Root "+ie+" 0 R"),Se("/Info "+(ie-1)+" 0 R"),b!==null&&Se("/Encrypt "+Gs.oid+" 0 R"),Se("/ID [ <"+he+"> <"+he+"> ]"),Se(">>")},ya=C.__private__.putHeader=function(){Se("%PDF-"+M),Se("%")},Cr=C.__private__.putXRef=function(){var R="0000000000";Se("xref"),Se("0 "+(ie+1)),Se("0000000000 65535 f ");for(var Ce=1;Ce<=ie;Ce++)typeof G[Ce]=="function"?Se((R+G[Ce]()).slice(-10)+" 00000 n "):G[Ce]!==void 0?Se((R+G[Ce]).slice(-10)+" 00000 n "):Se("0000000000 00000 n ")},rn=C.__private__.buildDocument=function(){var R;ie=0,ve=0,q=[],G=[],Fe=[],Si=Tn(),Is=Tn(),Me(q),$t.publish("buildDocument"),ya(),Wo(),(function(){$t.publish("putAdditionalObjects");for(var Ke=0;Ke<Fe.length;Ke++){var Xe=Fe[Ke];_n(Xe.objId,!0),Se(Xe.content),Se("endobj")}$t.publish("postPutAdditionalObjects")})(),R=[],(function(){for(var Ke in hr)hr.hasOwnProperty(Ke)&&(j===!1||j===!0&&F.hasOwnProperty(Ke))&&Fi(hr[Ke])})(),(function(){var Ke;for(Ke in jr)jr.hasOwnProperty(Ke)&&zl(jr[Ke])})(),(function(){for(var Ke in Hn)Hn.hasOwnProperty(Ke)&&Hl(Hn[Ke])})(),(function(Ke){var Xe;for(Xe in Pr)Pr.hasOwnProperty(Xe)&&(Pr[Xe]instanceof ih?$o(Pr[Xe]):Pr[Xe]instanceof Hm&&Do(Pr[Xe],Ke))})(R),$t.publish("putResources"),R.forEach(Ln),Ln({resourcesOid:Is,objectOid:Number.MAX_SAFE_INTEGER}),$t.publish("postPutResources"),b!==null&&(Gs.oid=en(),Se("<<"),Se("/Filter /Standard"),Se("/V "+Gs.v),Se("/R "+Gs.r),Se("/U <"+Gs.toHexString(Gs.U)+">"),Se("/O <"+Gs.toHexString(Gs.O)+">"),Se("/P "+Gs.P),Se(">>"),Se("endobj")),tn(),ns();var Ce=ve;return Cr(),Pa(),Se("startxref"),Se(""+Ce),Se("%%EOF"),Me(Qe[le]),q.join(`
`)},jo=C.__private__.getBlob=function(R){return new Blob([jt(R)],{type:"application/pdf"})},xi=C.output=C.__private__.output=(pi=function(R,Ce){switch(typeof(Ce=Ce||{})=="string"?Ce={filename:Ce}:Ce.filename=Ce.filename||"generated.pdf",R){case void 0:return rn();case"save":C.save(Ce.filename);break;case"arraybuffer":return jt(rn());case"blob":return jo(rn());case"bloburi":case"bloburl":if(Ua.URL!==void 0&&typeof Ua.URL.createObjectURL=="function")return Ua.URL&&Ua.URL.createObjectURL(jo(rn()))||void 0;Rn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Ke="",Xe=rn();try{Ke=S3(Xe)}catch{Ke=S3(unescape(encodeURIComponent(Xe)))}return"data:application/pdf;filename="+Ce.filename+";base64,"+Ke;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Ua)==="[object Window]"){var nt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Lt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Ce.pdfObjectUrl&&(nt=Ce.pdfObjectUrl,Lt="");var Gt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+nt+'"'+Lt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Ce)+");<\/script></body></html>",Ir=Ua.open();return Ir!==null&&Ir.document.write(Gt),Ir}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Ua)==="[object Window]"){var Qr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Ce.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Ce.filename+'" width="500px" height="400px" /></body></html>',va=Ua.open();if(va!==null){va.document.write(Qr);var Xr=this;va.document.documentElement.querySelector("#pdfViewer").onload=function(){va.document.title=Ce.filename,va.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Xr.output("bloburl"))}}return va}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Ua)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var $a='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Ce)+'"></iframe></body></html>',Mn=Ua.open();if(Mn!==null&&(Mn.document.write($a),Mn.document.title=Ce.filename),Mn||typeof safari>"u")return Mn;break;case"datauri":case"dataurl":return Ua.document.location.href=this.output("datauristring",Ce);default:return null}},pi.foo=function(){try{return pi.apply(this,arguments)}catch(Ke){var R=Ke.stack||"";~R.indexOf(" at ")&&(R=R.split(" at ")[1]);var Ce="Error in function "+R.split(`
`)[0].split("<")[0]+": "+Ke.message;if(!Ua.console)throw new Error(Ce);Ua.console.error(Ce,Ke),Ua.alert&&alert(Ce)}},pi.foo.bar=pi,pi.foo),Ki=function(R){return Array.isArray(Vo)===!0&&Vo.indexOf(R)>-1};switch(r){case"pt":Mr=1;break;case"mm":Mr=72/25.4;break;case"cm":Mr=72/2.54;break;case"in":Mr=72;break;case"px":Mr=Ki("px_scaling")==1?.75:96/72;break;case"pc":case"em":Mr=12;break;case"ex":Mr=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);Mr=r}var Gs=null;te(),xe();var ma=C.__private__.getPageInfo=C.getPageInfo=function(R){if(isNaN(R)||R%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Nr[R].objId,pageNumber:R,pageContext:Nr[R]}},qo=C.__private__.getPageInfoByObjId=function(R){if(isNaN(R)||R%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Ce in Nr)if(Nr[Ce].objId===R)break;return ma(Ce)},oc=C.__private__.getCurrentPageInfo=C.getCurrentPageInfo=function(){return{objId:Nr[le].objId,pageNumber:le,pageContext:Nr[le]}};C.addPage=function(){return Ct.apply(this,arguments),this},C.setPage=function(){return $r.apply(this,arguments),Me.call(this,Qe[le]),this},C.insertPage=function(R){return this.addPage(),this.movePage(le,R),this},C.movePage=function(R,Ce){var Ke,Xe;if(R>Ce){Ke=Qe[R],Xe=Nr[R];for(var nt=R;nt>Ce;nt--)Qe[nt]=Qe[nt-1],Nr[nt]=Nr[nt-1];Qe[Ce]=Ke,Nr[Ce]=Xe,this.setPage(Ce)}else if(R<Ce){Ke=Qe[R],Xe=Nr[R];for(var Lt=R;Lt<Ce;Lt++)Qe[Lt]=Qe[Lt+1],Nr[Lt]=Nr[Lt+1];Qe[Ce]=Ke,Nr[Ce]=Xe,this.setPage(Ce)}return this},C.deletePage=function(){return Ar.apply(this,arguments),this},C.__private__.text=C.text=function(R,Ce,Ke,Xe,nt){var Lt,Gt,Ir,Qr,va,Xr,$a,Mn,mn,an=(Xe=Xe||{}).scope||this;if(typeof R=="number"&&typeof Ce=="number"&&(typeof Ke=="string"||Array.isArray(Ke))){var bi=Ke;Ke=Ce,Ce=R,R=bi}if(arguments[3]instanceof ra==0?(Ir=arguments[4],Qr=arguments[5],wn($a=arguments[3])==="object"&&$a!==null||(typeof Ir=="string"&&(Qr=Ir,Ir=null),typeof $a=="string"&&(Qr=$a,$a=null),typeof $a=="number"&&(Ir=$a,$a=null),Xe={flags:$a,angle:Ir,align:Qr})):(ae("The transform parameter of text() with a Matrix value"),mn=nt),isNaN(Ce)||isNaN(Ke)||R==null)throw new Error("Invalid arguments passed to jsPDF.text");if(R.length===0)return an;var ci,Wi="",el=typeof Xe.lineHeightFactor=="number"?Xe.lineHeightFactor:yl,_s=an.internal.scaleFactor;function yi(Ea){return Ea=Ea.split("	").join(Array(Xe.TabLen||9).join(" ")),zt(Ea,$a)}function Ft(Ea){for(var Ya,Os=Ea.concat(),Kn=[],Bl=Os.length;Bl--;)typeof(Ya=Os.shift())=="string"?Kn.push(Ya):Array.isArray(Ea)&&(Ya.length===1||Ya[1]===void 0&&Ya[2]===void 0)?Kn.push(Ya[0]):Kn.push([Ya[0],Ya[1],Ya[2]]);return Kn}function Bo(Ea,Ya){var Os;if(typeof Ea=="string")Os=Ya(Ea)[0];else if(Array.isArray(Ea)){for(var Kn,Bl,Sn=Ea.concat(),xA=[],Ld=Sn.length;Ld--;)typeof(Kn=Sn.shift())=="string"?xA.push(Ya(Kn)[0]):Array.isArray(Kn)&&typeof Kn[0]=="string"&&(Bl=Ya(Kn[0],Kn[1],Kn[2]),xA.push([Bl[0],Bl[1],Bl[2]]));Os=xA}return Os}var In=!1,Pt=!0;if(typeof R=="string")In=!0;else if(Array.isArray(R)){var Vl=R.concat();Gt=[];for(var Qc,ti=Vl.length;ti--;)(typeof(Qc=Vl.shift())!="string"||Array.isArray(Qc)&&typeof Qc[0]!="string")&&(Pt=!1);In=Pt}if(In===!1)throw new Error('Type of text must be string or Array. "'+R+'" is not recognized.');typeof R=="string"&&(R=R.match(/[\r?\n]/)?R.split(/\r\n|\r|\n/g):[R]);var uc=ut/an.internal.scaleFactor,fc=uc*(el-1);switch(Xe.baseline){case"bottom":Ke-=fc;break;case"top":Ke+=uc-fc;break;case"hanging":Ke+=uc-2*fc;break;case"middle":Ke+=uc/2-fc}if((Xr=Xe.maxWidth||0)>0&&(typeof R=="string"?R=an.splitTextToSize(R,Xr):Object.prototype.toString.call(R)==="[object Array]"&&(R=R.reduce(function(Ea,Ya){return Ea.concat(an.splitTextToSize(Ya,Xr))},[]))),Lt={text:R,x:Ce,y:Ke,options:Xe,mutex:{pdfEscape:zt,activeFontKey:gr,fonts:hr,activeFontSize:ut}},$t.publish("preProcessText",Lt),R=Lt.text,Ir=(Xe=Lt.options).angle,mn instanceof ra==0&&Ir&&typeof Ir=="number"){Ir*=Math.PI/180,Xe.rotationDirection===0&&(Ir=-Ir),Q===O&&(Ir=-Ir);var Vs=Math.cos(Ir),Cl=Math.sin(Ir);mn=new ra(Vs,Cl,-Cl,Vs,0,0)}else Ir&&Ir instanceof ra&&(mn=Ir);Q!==O||mn||(mn=zi),(va=Xe.charSpace||Zo)!==void 0&&(Wi+=ue(ge(va))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Mn=Xe.horizontalScale)!==void 0&&(Wi+=ue(100*Mn)+` Tz
`),Xe.lang;var Sa=-1,Es=Xe.renderingMode!==void 0?Xe.renderingMode:Xe.stroke,ha=an.internal.getCurrentPageInfo().pageContext;switch(Es){case 0:case!1:case"fill":Sa=0;break;case 1:case!0:case"stroke":Sa=1;break;case 2:case"fillThenStroke":Sa=2;break;case 3:case"invisible":Sa=3;break;case 4:case"fillAndAddForClipping":Sa=4;break;case 5:case"strokeAndAddPathForClipping":Sa=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Sa=6;break;case 7:case"addToPathForClipping":Sa=7}var vi=ha.usedRenderingMode!==void 0?ha.usedRenderingMode:-1;Sa!==-1?Wi+=Sa+` Tr
`:vi!==-1&&(Wi+=`0 Tr
`),Sa!==-1&&(ha.usedRenderingMode=Sa),Qr=Xe.align||"left";var fa,Fa=ut*el,Rc=an.internal.pageSize.getWidth(),Lo=hr[gr];va=Xe.charSpace||Zo,Xr=Xe.maxWidth||0,$a=Object.assign({autoencode:!0,noBOM:!0},Xe.flags);var ki=[],Pc=function(Ea){return an.getStringUnitWidth(Ea,{font:Lo,charSpace:va,fontSize:ut,doKerning:!1})*ut/_s};if(Object.prototype.toString.call(R)==="[object Array]"){var wi;Gt=Ft(R),Qr!=="left"&&(fa=Gt.map(Pc));var pn,gn=0;if(Qr==="right"){Ce-=fa[0],R=[],ti=Gt.length;for(var Ys=0;Ys<ti;Ys++)Ys===0?(pn=Jo(Ce),wi=Ei(Ke)):(pn=ge(gn-fa[Ys]),wi=-Fa),R.push([Gt[Ys],pn,wi]),gn=fa[Ys]}else if(Qr==="center"){Ce-=fa[0]/2,R=[],ti=Gt.length;for(var Yl=0;Yl<ti;Yl++)Yl===0?(pn=Jo(Ce),wi=Ei(Ke)):(pn=ge((gn-fa[Yl])/2),wi=-Fa),R.push([Gt[Yl],pn,wi]),gn=fa[Yl]}else if(Qr==="left"){R=[],ti=Gt.length;for(var Td=0;Td<ti;Td++)R.push(Gt[Td])}else if(Qr==="justify"&&Lo.encoding==="Identity-H"){R=[],ti=Gt.length,Xr=Xr!==0?Xr:Rc;for(var _d=0,ys=0;ys<ti;ys++)if(wi=ys===0?Ei(Ke):-Fa,pn=ys===0?Jo(Ce):_d,ys<ti-1){var hc=ge((Xr-fa[ys])/(Gt[ys].split(" ").length-1)),Ao=Gt[ys].split(" ");R.push([Ao[0]+" ",pn,wi]),_d=0;for(var uo=1;uo<Ao.length;uo++){var $i=(Pc(Ao[uo-1]+" "+Ao[uo])-Pc(Ao[uo]))*_s+hc;uo==Ao.length-1?R.push([Ao[uo],$i,0]):R.push([Ao[uo]+" ",$i,0]),_d-=$i}}else R.push([Gt[ys],pn,wi]);R.push(["",_d,0])}else{if(Qr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(R=[],ti=Gt.length,Xr=Xr!==0?Xr:Rc,ys=0;ys<ti;ys++){wi=ys===0?Ei(Ke):-Fa,pn=ys===0?Jo(Ce):0;var mc=Gt[ys].split(" ").length-1,gA=mc>0?(Xr-fa[ys])/mc:0;ys<ti-1?ki.push(ue(ge(gA))):ki.push(0),R.push([Gt[ys],pn,wi])}}}(typeof Xe.R2L=="boolean"?Xe.R2L:St)===!0&&(R=Bo(R,function(Ea,Ya,Os){return[Ea.split("").reverse().join(""),Ya,Os]})),Lt={text:R,x:Ce,y:Ke,options:Xe,mutex:{pdfEscape:zt,activeFontKey:gr,fonts:hr,activeFontSize:ut}},$t.publish("postProcessText",Lt),R=Lt.text,ci=Lt.mutex.isHex||!1;var Hc=hr[gr].encoding;Hc!=="WinAnsiEncoding"&&Hc!=="StandardEncoding"||(R=Bo(R,function(Ea,Ya,Os){return[yi(Ea),Ya,Os]})),Gt=Ft(R),R=[];for(var zc,Wl,jl,Kc=Array.isArray(Gt[0])?1:0,Uo="",pc=function(Ea,Ya,Os){var Kn="";return Os instanceof ra?(Os=typeof Xe.angle=="number"?ko(Os,new ra(1,0,0,1,Ea,Ya)):ko(new ra(1,0,0,1,Ea,Ya),Os),Q===O&&(Os=ko(new ra(1,0,0,-1,0,0),Os)),Kn=Os.join(" ")+` Tm
`):Kn=ue(Ea)+" "+ue(Ya)+` Td
`,Kn},zn=0;zn<Gt.length;zn++){switch(Uo="",Kc){case 1:jl=(ci?"<":"(")+Gt[zn][0]+(ci?">":")"),zc=parseFloat(Gt[zn][1]),Wl=parseFloat(Gt[zn][2]);break;case 0:jl=(ci?"<":"(")+Gt[zn]+(ci?">":")"),zc=Jo(Ce),Wl=Ei(Ke)}ki!==void 0&&ki[zn]!==void 0&&(Uo=ki[zn]+` Tw
`),zn===0?R.push(Uo+pc(zc,Wl,mn)+jl):Kc===0?R.push(Uo+jl):Kc===1&&R.push(Uo+pc(zc,Wl,mn)+jl)}R=Kc===0?R.join(` Tj
T* `):R.join(` Tj
`),R+=` Tj
`;var qi=`BT
/`;return qi+=gr+" "+ut+` Tf
`,qi+=ue(ut*el)+` TL
`,qi+=wl+`
`,qi+=Wi,qi+=R,Se(qi+="ET"),F[gr]=!0,an};var Va=C.__private__.clip=C.clip=function(R){return Se(R==="evenodd"?"W*":"W"),this};C.clipEvenOdd=function(){return Va("evenodd")},C.__private__.discardPath=C.discardPath=function(){return Se("n"),this};var li=C.__private__.isValidStyle=function(R){var Ce=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(R)!==-1&&(Ce=!0),Ce};C.__private__.setDefaultPathOperation=C.setDefaultPathOperation=function(R){return li(R)&&(g=R),this};var Fs=C.__private__.getStyle=C.getStyle=function(R){var Ce=g;switch(R){case"D":case"S":Ce="S";break;case"F":Ce="f";break;case"FD":case"DF":Ce="B";break;case"f":case"f*":case"B":case"B*":Ce=R}return Ce},Gi=C.close=function(){return Se("h"),this};C.stroke=function(){return Se("S"),this},C.fill=function(R){return Vi("f",R),this},C.fillEvenOdd=function(R){return Vi("f*",R),this},C.fillStroke=function(R){return Vi("B",R),this},C.fillStrokeEvenOdd=function(R){return Vi("B*",R),this};var Vi=function(R,Ce){wn(Ce)==="object"?Ps(Ce,R):Se(R)},ls=function(R){R===null||Q===O&&R===void 0||(R=Fs(R),Se(R))};function jn(R,Ce,Ke,Xe,nt){var Lt=new Hm(Ce||this.boundingBox,Ke||this.xStep,Xe||this.yStep,this.gState,nt||this.matrix);Lt.stream=this.stream;var Gt=R+"$$"+this.cloneIndex+++"$$";return ms(Gt,Lt),Lt}var Ps=function(R,Ce){var Ke=wa[R.key],Xe=Pr[Ke];if(Xe instanceof ih)Se("q"),Se(HA(Ce)),Xe.gState&&C.setGState(Xe.gState),Se(R.matrix.toString()+" cm"),Se("/"+Ke+" sh"),Se("Q");else if(Xe instanceof Hm){var nt=new ra(1,0,0,-1,0,dc());R.matrix&&(nt=nt.multiply(R.matrix||zi),Ke=jn.call(Xe,R.key,R.boundingBox,R.xStep,R.yStep,nt).id),Se("q"),Se("/Pattern cs"),Se("/"+Ke+" scn"),Xe.gState&&C.setGState(Xe.gState),Se(Ce),Se("Q")}},HA=function(R){switch(R){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},kd=C.moveTo=function(R,Ce){return Se(ue(ge(R))+" "+ue(fe(Ce))+" m"),this},hA=C.lineTo=function(R,Ce){return Se(ue(ge(R))+" "+ue(fe(Ce))+" l"),this},Xo=C.curveTo=function(R,Ce,Ke,Xe,nt,Lt){return Se([ue(ge(R)),ue(fe(Ce)),ue(ge(Ke)),ue(fe(Xe)),ue(ge(nt)),ue(fe(Lt)),"c"].join(" ")),this};C.__private__.line=C.line=function(R,Ce,Ke,Xe,nt){if(isNaN(R)||isNaN(Ce)||isNaN(Ke)||isNaN(Xe)||!li(nt))throw new Error("Invalid arguments passed to jsPDF.line");return Q===H?this.lines([[Ke-R,Xe-Ce]],R,Ce,[1,1],nt||"S"):this.lines([[Ke-R,Xe-Ce]],R,Ce,[1,1]).stroke()},C.__private__.lines=C.lines=function(R,Ce,Ke,Xe,nt,Lt){var Gt,Ir,Qr,va,Xr,$a,Mn,mn,an,bi,ci,Wi;if(typeof R=="number"&&(Wi=Ke,Ke=Ce,Ce=R,R=Wi),Xe=Xe||[1,1],Lt=Lt||!1,isNaN(Ce)||isNaN(Ke)||!Array.isArray(R)||!Array.isArray(Xe)||!li(nt)||typeof Lt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(kd(Ce,Ke),Gt=Xe[0],Ir=Xe[1],va=R.length,bi=Ce,ci=Ke,Qr=0;Qr<va;Qr++)(Xr=R[Qr]).length===2?(bi=Xr[0]*Gt+bi,ci=Xr[1]*Ir+ci,hA(bi,ci)):($a=Xr[0]*Gt+bi,Mn=Xr[1]*Ir+ci,mn=Xr[2]*Gt+bi,an=Xr[3]*Ir+ci,bi=Xr[4]*Gt+bi,ci=Xr[5]*Ir+ci,Xo($a,Mn,mn,an,bi,ci));return Lt&&Gi(),ls(nt),this},C.path=function(R){for(var Ce=0;Ce<R.length;Ce++){var Ke=R[Ce],Xe=Ke.c;switch(Ke.op){case"m":kd(Xe[0],Xe[1]);break;case"l":hA(Xe[0],Xe[1]);break;case"c":Xo.apply(this,Xe);break;case"h":Gi()}}return this},C.__private__.rect=C.rect=function(R,Ce,Ke,Xe,nt){if(isNaN(R)||isNaN(Ce)||isNaN(Ke)||isNaN(Xe)||!li(nt))throw new Error("Invalid arguments passed to jsPDF.rect");return Q===H&&(Xe=-Xe),Se([ue(ge(R)),ue(fe(Ce)),ue(ge(Ke)),ue(ge(Xe)),"re"].join(" ")),ls(nt),this},C.__private__.triangle=C.triangle=function(R,Ce,Ke,Xe,nt,Lt,Gt){if(isNaN(R)||isNaN(Ce)||isNaN(Ke)||isNaN(Xe)||isNaN(nt)||isNaN(Lt)||!li(Gt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Ke-R,Xe-Ce],[nt-Ke,Lt-Xe],[R-nt,Ce-Lt]],R,Ce,[1,1],Gt,!0),this},C.__private__.roundedRect=C.roundedRect=function(R,Ce,Ke,Xe,nt,Lt,Gt){if(isNaN(R)||isNaN(Ce)||isNaN(Ke)||isNaN(Xe)||isNaN(nt)||isNaN(Lt)||!li(Gt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Ir=4/3*(Math.SQRT2-1);return nt=Math.min(nt,.5*Ke),Lt=Math.min(Lt,.5*Xe),this.lines([[Ke-2*nt,0],[nt*Ir,0,nt,Lt-Lt*Ir,nt,Lt],[0,Xe-2*Lt],[0,Lt*Ir,-nt*Ir,Lt,-nt,Lt],[2*nt-Ke,0],[-nt*Ir,0,-nt,-Lt*Ir,-nt,-Lt],[0,2*Lt-Xe],[0,-Lt*Ir,nt*Ir,-Lt,nt,-Lt]],R+nt,Ce,[1,1],Gt,!0),this},C.__private__.ellipse=C.ellipse=function(R,Ce,Ke,Xe,nt){if(isNaN(R)||isNaN(Ce)||isNaN(Ke)||isNaN(Xe)||!li(nt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Lt=4/3*(Math.SQRT2-1)*Ke,Gt=4/3*(Math.SQRT2-1)*Xe;return kd(R+Ke,Ce),Xo(R+Ke,Ce-Gt,R+Lt,Ce-Xe,R,Ce-Xe),Xo(R-Lt,Ce-Xe,R-Ke,Ce-Gt,R-Ke,Ce),Xo(R-Ke,Ce+Gt,R-Lt,Ce+Xe,R,Ce+Xe),Xo(R+Lt,Ce+Xe,R+Ke,Ce+Gt,R+Ke,Ce),ls(nt),this},C.__private__.circle=C.circle=function(R,Ce,Ke,Xe){if(isNaN(R)||isNaN(Ce)||isNaN(Ke)||!li(Xe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(R,Ce,Ke,Ke,Xe)},C.setFont=function(R,Ce,Ke){return Ke&&(Ce=se(Ce,Ke)),gr=Ba(R,Ce,{disableWarning:!1}),this};var To=C.__private__.getFont=C.getFont=function(){return hr[Ba.apply(C,arguments)]};C.__private__.getFontList=C.getFontList=function(){var R,Ce,Ke={};for(R in pr)if(pr.hasOwnProperty(R))for(Ce in Ke[R]=[],pr[R])pr[R].hasOwnProperty(Ce)&&Ke[R].push(Ce);return Ke},C.addFont=function(R,Ce,Ke,Xe,nt){var Lt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Lt.indexOf(arguments[3])!==-1?nt=arguments[3]:arguments[3]&&Lt.indexOf(arguments[3])==-1&&(Ke=se(Ke,Xe)),tt.call(this,R,Ce,Ke,nt=nt||"Identity-H")};var yl,cs=n.lineWidth||.200025,aa=C.__private__.getLineWidth=C.getLineWidth=function(){return cs},vl=C.__private__.setLineWidth=C.setLineWidth=function(R){return cs=R,Se(ue(ge(R))+" w"),this};C.__private__.setLineDash=ua.API.setLineDash=ua.API.setLineDashPattern=function(R,Ce){if(R=R||[],Ce=Ce||0,isNaN(Ce)||!Array.isArray(R))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return R=R.map(function(Ke){return ue(ge(Ke))}).join(" "),Ce=ue(ge(Ce)),Se("["+R+"] "+Ce+" d"),this};var mu=C.__private__.getLineHeight=C.getLineHeight=function(){return ut*yl};C.__private__.getLineHeight=C.getLineHeight=function(){return ut*yl};var pu=C.__private__.setLineHeightFactor=C.setLineHeightFactor=function(R){return typeof(R=R||1.15)=="number"&&(yl=R),this},df=C.__private__.getLineHeightFactor=C.getLineHeightFactor=function(){return yl};pu(n.lineHeight);var Jo=C.__private__.getHorizontalCoordinate=function(R){return ge(R)},Ei=C.__private__.getVerticalCoordinate=function(R){return Q===O?R:Nr[le].mediaBox.topRightY-Nr[le].mediaBox.bottomLeftY-ge(R)},Dd=C.__private__.getHorizontalCoordinateString=C.getHorizontalCoordinateString=function(R){return ue(Jo(R))},Un=C.__private__.getVerticalCoordinateString=C.getVerticalCoordinateString=function(R){return ue(Ei(R))},Yi=n.strokeColor||"0 G";C.__private__.getStrokeColor=C.getDrawColor=function(){return ba(Yi)},C.__private__.setStrokeColor=C.setDrawColor=function(R,Ce,Ke,Xe){return Yi=Cn({ch1:R,ch2:Ce,ch3:Ke,ch4:Xe,pdfColorType:"draw",precision:2}),Se(Yi),this};var lr=n.fillColor||"0 g";C.__private__.getFillColor=C.getFillColor=function(){return ba(lr)},C.__private__.setFillColor=C.setFillColor=function(R,Ce,Ke,Xe){return lr=Cn({ch1:R,ch2:Ce,ch3:Ke,ch4:Xe,pdfColorType:"fill",precision:2}),Se(lr),this};var wl=n.textColor||"0 g",Mc=C.__private__.getTextColor=C.getTextColor=function(){return ba(wl)};C.__private__.setTextColor=C.setTextColor=function(R,Ce,Ke,Xe){return wl=Cn({ch1:R,ch2:Ce,ch3:Ke,ch4:Xe,pdfColorType:"text",precision:3}),this};var Zo=n.charSpace,Bn=C.__private__.getCharSpace=C.getCharSpace=function(){return parseFloat(Zo||0)};C.__private__.setCharSpace=C.setCharSpace=function(R){if(isNaN(R))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Zo=R,this};var Nl=0;C.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},C.__private__.setLineCap=C.setLineCap=function(R){var Ce=C.CapJoinStyles[R];if(Ce===void 0)throw new Error("Line cap style of '"+R+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Nl=Ce,Se(Ce+" J"),this};var Ts=0;C.__private__.setLineJoin=C.setLineJoin=function(R){var Ce=C.CapJoinStyles[R];if(Ce===void 0)throw new Error("Line join style of '"+R+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ts=Ce,Se(Ce+" j"),this},C.__private__.setLineMiterLimit=C.__private__.setMiterLimit=C.setLineMiterLimit=C.setMiterLimit=function(R){if(R=R||0,isNaN(R))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Se(ue(ge(R))+" M"),this},C.GState=J2,C.setGState=function(R){(R=typeof R=="string"?jr[Ms[R]]:_o(null,R)).equals(Rs)||(Se("/"+R.id+" gs"),Rs=R)};var _o=function(R,Ce){if(!R||!Ms[R]){var Ke=!1;for(var Xe in jr)if(jr.hasOwnProperty(Xe)&&jr[Xe].equals(Ce)){Ke=!0;break}if(Ke)Ce=jr[Xe];else{var nt="GS"+(Object.keys(jr).length+1).toString(10);jr[nt]=Ce,Ce.id=nt}return R&&(Ms[R]=Ce.id),$t.publish("addGState",Ce),Ce}};C.addGState=function(R,Ce){return _o(R,Ce),this},C.saveGraphicsState=function(){return Se("q"),Gr.push({key:gr,size:ut,color:wl}),this},C.restoreGraphicsState=function(){Se("Q");var R=Gr.pop();return gr=R.key,ut=R.size,wl=R.color,Rs=null,this},C.setCurrentTransformationMatrix=function(R){return Se(R.toString()+" cm"),this},C.comment=function(R){return Se("#"+R),this};var Kl=function(R,Ce){var Ke=R||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Ke},set:function(Lt){isNaN(Lt)||(Ke=parseFloat(Lt))}});var Xe=Ce||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Xe},set:function(Lt){isNaN(Lt)||(Xe=parseFloat(Lt))}});var nt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return nt},set:function(Lt){nt=Lt.toString()}}),this},lc=function(R,Ce,Ke,Xe){Kl.call(this,R,Ce),this.type="rect";var nt=Ke||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return nt},set:function(Gt){isNaN(Gt)||(nt=parseFloat(Gt))}});var Lt=Xe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Lt},set:function(Gt){isNaN(Gt)||(Lt=parseFloat(Gt))}}),this},zA=function(){this.page=or,this.currentPage=le,this.pages=Qe.slice(0),this.pagesContext=Nr.slice(0),this.x=Ot,this.y=ja,this.matrix=oa,this.width=Ic(le),this.height=Gl(le),this.outputDestination=je,this.id="",this.objectNumber=-1};zA.prototype.restore=function(){or=this.page,le=this.currentPage,Nr=this.pagesContext,Qe=this.pages,Ot=this.x,ja=this.y,oa=this.matrix,pA(le,this.width),Ac(le,this.height),je=this.outputDestination};var mA=function(R,Ce,Ke,Xe,nt){co.push(new zA),or=le=0,Qe=[],Ot=R,ja=Ce,oa=nt,qt([Ke,Xe])};for(var cc in C.beginFormObject=function(R,Ce,Ke,Xe,nt){return mA(R,Ce,Ke,Xe,nt),this},C.endFormObject=function(R){return(function(Ce){if(hs[Ce])co.pop().restore();else{var Ke=new zA,Xe="Xo"+(Object.keys(Hn).length+1).toString(10);Ke.id=Xe,hs[Ce]=Xe,Hn[Xe]=Ke,$t.publish("addFormObject",Ke),co.pop().restore()}})(R),this},C.doFormObject=function(R,Ce){var Ke=Hn[hs[R]];return Se("q"),Se(Ce.toString()+" cm"),Se("/"+Ke.id+" Do"),Se("Q"),this},C.getFormObject=function(R){var Ce=Hn[hs[R]];return{x:Ce.x,y:Ce.y,width:Ce.width,height:Ce.height,matrix:Ce.matrix}},C.save=function(R,Ce){return R=R||"generated.pdf",(Ce=Ce||{}).returnPromise=Ce.returnPromise||!1,Ce.returnPromise===!1?(ah(jo(rn()),R),typeof ah.unload=="function"&&Ua.setTimeout&&setTimeout(ah.unload,911),this):new Promise(function(Ke,Xe){try{var nt=ah(jo(rn()),R);typeof ah.unload=="function"&&Ua.setTimeout&&setTimeout(ah.unload,911),Ke(nt)}catch(Lt){Xe(Lt.message)}})},ua.API)ua.API.hasOwnProperty(cc)&&(cc==="events"&&ua.API.events.length?(function(R,Ce){var Ke,Xe,nt;for(nt=Ce.length-1;nt!==-1;nt--)Ke=Ce[nt][0],Xe=Ce[nt][1],R.subscribe.apply(R,[Ke].concat(typeof Xe=="function"?[Xe]:Xe))})($t,ua.API.events):C[cc]=ua.API[cc]);function Ic(R){return Nr[R].mediaBox.topRightX-Nr[R].mediaBox.bottomLeftX}function pA(R,Ce){Nr[R].mediaBox.topRightX=Ce+Nr[R].mediaBox.bottomLeftX}function Gl(R){return Nr[R].mediaBox.topRightY-Nr[R].mediaBox.bottomLeftY}function Ac(R,Ce){Nr[R].mediaBox.topRightY=Ce+Nr[R].mediaBox.bottomLeftY}var gu=C.getPageWidth=function(R){return Ic(R=R||le)/Mr},KA=C.setPageWidth=function(R,Ce){pA(R,Ce*Mr)},dc=C.getPageHeight=function(R){return Gl(R=R||le)/Mr},Oc=C.setPageHeight=function(R,Ce){Ac(R,Ce*Mr)};return C.internal={pdfEscape:zt,getStyle:Fs,getFont:To,getFontSize:Ye,getCharSpace:Bn,getTextColor:Mc,getLineHeight:mu,getLineHeightFactor:df,getLineWidth:aa,write:ft,getHorizontalCoordinate:Jo,getVerticalCoordinate:Ei,getCoordinateString:Dd,getVerticalCoordinateString:Un,collections:{},newObject:en,newAdditionalObject:Yo,newObjectDeferred:Tn,newObjectDeferredBegin:_n,getFilters:Oa,putStream:ss,events:$t,scaleFactor:Mr,pageSize:{getWidth:function(){return gu(le)},setWidth:function(R){KA(le,R)},getHeight:function(){return dc(le)},setHeight:function(R){Oc(le,R)}},encryptionOptions:b,encryption:Gs,getEncryptor:function(R){return b!==null?Gs.encryptor(R,0):function(Ce){return Ce}},output:xi,getNumberOfPages:Ra,pages:Qe,out:Se,f2:z,f3:J,getPageInfo:ma,getPageInfoByObjId:qo,getCurrentPageInfo:oc,getPDFVersion:_,Point:Kl,Rectangle:lc,Matrix:ra,hasHotfix:Ki},Object.defineProperty(C.internal.pageSize,"width",{get:function(){return gu(le)},set:function(R){KA(le,R)},enumerable:!0,configurable:!0}),Object.defineProperty(C.internal.pageSize,"height",{get:function(){return dc(le)},set:function(R){Oc(le,R)},enumerable:!0,configurable:!0}),(function(R){for(var Ce=0,Ke=It.length;Ce<Ke;Ce++){var Xe=tt.call(this,R[Ce][0],R[Ce][1],R[Ce][2],It[Ce][3],!0);j===!1&&(F[Xe]=!0);var nt=R[Ce][0].split("-");hn({id:Xe,fontName:nt[0],fontStyle:nt[1]||""})}$t.publish("addFonts",{fonts:hr,dictionary:pr})}).call(C,It),gr="F1",Ct(s,t),$t.publish("initialized"),C}Mm.prototype.lsbFirstWord=function(n){return String.fromCharCode(255&n,n>>8&255,n>>16&255,n>>24&255)},Mm.prototype.toHexString=function(n){return n.split("").map(function(a){return("0"+(255&a.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Mm.prototype.hexToBytes=function(n){for(var a=[],t=0;t<n.length;t+=2)a.push(String.fromCharCode(parseInt(n.substr(t,2),16)));return a.join("")},Mm.prototype.processOwnerPassword=function(n,a){return hw(fw(a).substr(0,5),n)},Mm.prototype.encryptor=function(n,a){var t=fw(this.encryptionKey+String.fromCharCode(255&n,n>>8&255,n>>16&255,255&a,a>>8&255)).substr(0,10);return function(r){return hw(t,r)}},J2.prototype.equals=function(n){var a,t="id,objectNumber,equals";if(!n||wn(n)!==wn(this))return!1;var r=0;for(a in this)if(!(t.indexOf(a)>=0)){if(this.hasOwnProperty(a)&&!n.hasOwnProperty(a)||this[a]!==n[a])return!1;r++}for(a in n)n.hasOwnProperty(a)&&t.indexOf(a)<0&&r--;return r===0},ua.API={events:[]},ua.version="3.0.3";var Ri=ua.API,v5=1,Dh=function(n){return n.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Sm=function(n){return n.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},za=function(n){return n.toFixed(2)},Yf=function(n){return n.toFixed(5)};Ri.__acroform__={};var Uc=function(n,a){n.prototype=Object.create(a.prototype),n.prototype.constructor=n},D3=function(n){return n*v5},Jd=function(n){var a=new Vj,t=ta.internal.getHeight(n)||0,r=ta.internal.getWidth(n)||0;return a.BBox=[0,0,Number(za(r)),Number(za(t))],a},H9=Ri.__acroform__.setBit=function(n,a){if(n=n||0,a=a||0,isNaN(n)||isNaN(a))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return n|1<<a},z9=Ri.__acroform__.clearBit=function(n,a){if(n=n||0,a=a||0,isNaN(n)||isNaN(a))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return n&~(1<<a)},K9=Ri.__acroform__.getBit=function(n,a){if(isNaN(n)||isNaN(a))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return n&1<<a?1:0},ao=Ri.__acroform__.getBitForPdf=function(n,a){if(isNaN(n)||isNaN(a))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return K9(n,a-1)},so=Ri.__acroform__.setBitForPdf=function(n,a){if(isNaN(n)||isNaN(a))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return H9(n,a-1)},no=Ri.__acroform__.clearBitForPdf=function(n,a){if(isNaN(n)||isNaN(a))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return z9(n,a-1)},G9=Ri.__acroform__.calculateCoordinates=function(n,a){var t=a.internal.getHorizontalCoordinate,r=a.internal.getVerticalCoordinate,s=n[0],e=n[1],u=n[2],f=n[3],m={};return m.lowerLeft_X=t(s)||0,m.lowerLeft_Y=r(e+f)||0,m.upperRight_X=t(s+u)||0,m.upperRight_Y=r(e)||0,[Number(za(m.lowerLeft_X)),Number(za(m.lowerLeft_Y)),Number(za(m.upperRight_X)),Number(za(m.upperRight_Y))]},V9=function(n){if(n.appearanceStreamContent)return n.appearanceStreamContent;if(n.V||n.DV){var a=[],t=n._V||n.DV,r=mw(n,t),s=n.scope.internal.getFont(n.fontName,n.fontStyle).id;a.push("/Tx BMC"),a.push("q"),a.push("BT"),a.push(n.scope.__private__.encodeColorString(n.color)),a.push("/"+s+" "+za(r.fontSize)+" Tf"),a.push("1 0 0 1 0 0 Tm"),a.push(r.text),a.push("ET"),a.push("Q"),a.push("EMC");var e=Jd(n);return e.scope=n.scope,e.stream=a.join(`
`),e}},mw=function(n,a){var t=n.fontSize===0?n.maxFontSize:n.fontSize,r={text:"",fontSize:""},s=(a=(a=a.substr(0,1)=="("?a.substr(1):a).substr(a.length-1)==")"?a.substr(0,a.length-1):a).split(" ");s=n.multiline?s.map(function(z){return z.split(`
`)}):s.map(function(z){return[z]});var e=t,u=ta.internal.getHeight(n)||0;u=u<0?-u:u;var f=ta.internal.getWidth(n)||0;f=f<0?-f:f;var m=function(z,J,ge){if(z+1<s.length){var fe=J+" "+s[z+1][0];return _x(fe,n,ge).width<=f-4}return!1};e++;e:for(;e>0;){a="",e--;var g,b,j=_x("3",n,e).height,F=n.multiline?u-e:(u-j)/2,C=F+=2,M=0,_=0,L=0;if(e<=0){a=`(...) Tj
`,a+="% Width of Text: "+_x(a,n,e=12).width+", FieldWidth:"+f+`
`;break}for(var T="",H=0,O=0;O<s.length;O++)if(s.hasOwnProperty(O)){var Q=!1;if(s[O].length!==1&&L!==s[O].length-1){if((j+2)*(H+2)+2>u)continue e;T+=s[O][L],Q=!0,_=O,O--}else{T=(T+=s[O][L]+" ").substr(T.length-1)==" "?T.substr(0,T.length-1):T;var Z=parseInt(O),ee=m(Z,T,e),se=O>=s.length-1;if(ee&&!se){T+=" ",L=0;continue}if(ee||se){if(se)_=Z;else if(n.multiline&&(j+2)*(H+2)+2>u)continue e}else{if(!n.multiline||(j+2)*(H+2)+2>u)continue e;_=Z}}for(var ue="",ae=M;ae<=_;ae++){var pe=s[ae];if(n.multiline){if(ae===_){ue+=pe[L]+" ",L=(L+1)%pe.length;continue}if(ae===M){ue+=pe[pe.length-1]+" ";continue}}ue+=pe[0]+" "}switch(ue=ue.substr(ue.length-1)==" "?ue.substr(0,ue.length-1):ue,b=_x(ue,n,e).width,n.textAlign){case"right":g=f-b-2;break;case"center":g=(f-b)/2;break;default:g=2}a+=za(g)+" "+za(C)+` Td
`,a+="("+Dh(ue)+`) Tj
`,a+=-za(g)+` 0 Td
`,C=-(e+2),b=0,M=Q?_:_+1,H++,T=""}break}return r.text=a,r.fontSize=e,r},_x=function(n,a,t){var r=a.scope.internal.getFont(a.fontName,a.fontStyle),s=a.scope.getStringUnitWidth(n,{font:r,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:a.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:s}},Y9={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},W9=function(n,a){var t={type:"reference",object:n};a.internal.getPageInfo(n.page).pageContext.annotations.find(function(r){return r.type===t.type&&r.object===t.object})===void 0&&a.internal.getPageInfo(n.page).pageContext.annotations.push(t)},$9=function(n,a){if(a.scope=n,n.internal!==void 0&&(n.internal.acroformPlugin===void 0||n.internal.acroformPlugin.isInitialized===!1)){if(Sd.FieldNum=0,n.internal.acroformPlugin=JSON.parse(JSON.stringify(Y9)),n.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");v5=n.internal.scaleFactor,n.internal.acroformPlugin.acroFormDictionaryRoot=new Yj,n.internal.acroformPlugin.acroFormDictionaryRoot.scope=n,n.internal.acroformPlugin.acroFormDictionaryRoot._eventID=n.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(n)}),n.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in r)if(r.hasOwnProperty(s)){var e=r[s];e.objId=void 0,e.hasAnnotation&&W9(e,t)}})(n)}),n.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(n)}),n.internal.events.subscribe("postPutPages",function(t){(function(r,s){var e=!r;for(var u in r||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(u)){var f=r[u],m=[],g=f.Rect;if(f.Rect&&(f.Rect=G9(f.Rect,s)),s.internal.newObjectDeferredBegin(f.objId,!0),f.DA=ta.createDefaultAppearanceStream(f),wn(f)==="object"&&typeof f.getKeyValueListForStream=="function"&&(m=f.getKeyValueListForStream()),f.Rect=g,f.hasAppearanceStream&&!f.appearanceStreamContent){var b=V9(f);m.push({key:"AP",value:"<</N "+b+">>"}),s.internal.acroformPlugin.xForms.push(b)}if(f.appearanceStreamContent){var j="";for(var F in f.appearanceStreamContent)if(f.appearanceStreamContent.hasOwnProperty(F)){var C=f.appearanceStreamContent[F];if(j+="/"+F+" ",j+="<<",Object.keys(C).length>=1||Array.isArray(C)){for(var u in C)if(C.hasOwnProperty(u)){var M=C[u];typeof M=="function"&&(M=M.call(s,f)),j+="/"+u+" "+M+" ",s.internal.acroformPlugin.xForms.indexOf(M)>=0||s.internal.acroformPlugin.xForms.push(M)}}else typeof(M=C)=="function"&&(M=M.call(s,f)),j+="/"+u+" "+M,s.internal.acroformPlugin.xForms.indexOf(M)>=0||s.internal.acroformPlugin.xForms.push(M);j+=">>"}m.push({key:"AP",value:`<<
`+j+">>"})}s.internal.putStream({additionalKeyValues:m,objectId:f.objId}),s.internal.out("endobj")}e&&(function(_,L){for(var T in _)if(_.hasOwnProperty(T)){var H=T,O=_[T];L.internal.newObjectDeferredBegin(O.objId,!0),wn(O)==="object"&&typeof O.putStream=="function"&&O.putStream(),delete _[H]}})(s.internal.acroformPlugin.xForms,s)})(t,n)}),n.internal.acroformPlugin.isInitialized=!0}},Gj=Ri.__acroform__.arrayToPdfArray=function(n,a,t){var r=function(u){return u};if(Array.isArray(n)){for(var s="[",e=0;e<n.length;e++)switch(e!==0&&(s+=" "),wn(n[e])){case"boolean":case"number":case"object":s+=n[e].toString();break;case"string":n[e].substr(0,1)!=="/"?(a!==void 0&&t&&(r=t.internal.getEncryptor(a)),s+="("+Dh(r(n[e].toString()))+")"):s+=n[e].toString()}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Zy=function(n,a,t){var r=function(s){return s};return a!==void 0&&t&&(r=t.internal.getEncryptor(a)),(n=n||"").toString(),"("+Dh(r(n))+")"},su=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(n){this._objId=n}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};su.prototype.toString=function(){return this.objId+" 0 R"},su.prototype.putStream=function(){var n=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:n,objectId:this.objId}),this.scope.internal.out("endobj")},su.prototype.getKeyValueListForStream=function(){var n=[],a=Object.getOwnPropertyNames(this).filter(function(e){return e!="content"&&e!="appearanceStreamContent"&&e!="scope"&&e!="objId"&&e.substring(0,1)!="_"});for(var t in a)if(Object.getOwnPropertyDescriptor(this,a[t]).configurable===!1){var r=a[t],s=this[r];s&&(Array.isArray(s)?n.push({key:r,value:Gj(s,this.objId,this.scope)}):s instanceof su?(s.scope=this.scope,n.push({key:r,value:s.objId+" 0 R"})):typeof s!="function"&&n.push({key:r,value:s}))}return n};var Vj=function(){su.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var n,a=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return a},set:function(t){a=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){n=t.trim()},get:function(){return n||null}})};Uc(Vj,su);var Yj=function(){su.call(this);var n,a=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return a.length>0?a:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return a}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(n){var t=function(r){return r};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Dh(t(n))+")"}},set:function(t){n=t}})};Uc(Yj,su);var Sd=function n(){su.call(this);var a=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return a},set:function(T){if(isNaN(T))throw new Error('Invalid value "'+T+'" for attribute F supplied.');a=T}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!ao(a,3)},set:function(T){T?this.F=so(a,3):this.F=no(a,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(T){if(isNaN(T))throw new Error('Invalid value "'+T+'" for attribute Ff supplied.');t=T}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(T){r=T!==void 0?T:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(T){r[0]=T}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(T){r[1]=T}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(T){r[2]=T}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(T){r[3]=T}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(T){switch(T){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=T;break;default:throw new Error('Invalid value "'+T+'" for attribute FT supplied.')}}});var e=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!e||e.length<1){if(this instanceof Z2)return;e="FieldObject"+n.FieldNum++}var T=function(H){return H};return this.scope&&(T=this.scope.internal.getEncryptor(this.objId)),"("+Dh(T(e))+")"},set:function(T){e=T.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return e},set:function(T){e=T}});var u="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return u},set:function(T){u=T}});var f="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return f},set:function(T){f=T}});var m=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return m},set:function(T){m=T}});var g=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return g===void 0?50/v5:g},set:function(T){g=T}});var b="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return b},set:function(T){b=T}});var j="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!j||this instanceof Z2||this instanceof fh))return Zy(j,this.objId,this.scope)},set:function(T){T=T.toString(),j=T}});var F=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(F)return this instanceof Go==0?Zy(F,this.objId,this.scope):F},set:function(T){T=T.toString(),F=this instanceof Go==0?T.substr(0,1)==="("?Sm(T.substr(1,T.length-2)):Sm(T):T}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Go==1?Sm(F.substr(1,F.length-1)):F},set:function(T){T=T.toString(),F=this instanceof Go==1?"/"+T:T}});var C=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(C)return C},set:function(T){this.V=T}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(C)return this instanceof Go==0?Zy(C,this.objId,this.scope):C},set:function(T){T=T.toString(),C=this instanceof Go==0?T.substr(0,1)==="("?Sm(T.substr(1,T.length-2)):Sm(T):T}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Go==1?Sm(C.substr(1,C.length-1)):C},set:function(T){T=T.toString(),C=this instanceof Go==1?"/"+T:T}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var M,_=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return _},set:function(T){T=!!T,_=T}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(M)return M},set:function(T){M=T}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!ao(this.Ff,1)},set:function(T){T?this.Ff=so(this.Ff,1):this.Ff=no(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!ao(this.Ff,2)},set:function(T){T?this.Ff=so(this.Ff,2):this.Ff=no(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!ao(this.Ff,3)},set:function(T){T?this.Ff=so(this.Ff,3):this.Ff=no(this.Ff,3)}});var L=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(L!==null)return L},set:function(T){if([0,1,2].indexOf(T)===-1)throw new Error('Invalid value "'+T+'" for attribute Q supplied.');L=T}}),Object.defineProperty(this,"textAlign",{get:function(){var T;switch(L){case 0:default:T="left";break;case 1:T="center";break;case 2:T="right"}return T},configurable:!0,enumerable:!0,set:function(T){switch(T){case"right":case 2:L=2;break;case"center":case 1:L=1;break;default:L=0}}})};Uc(Sd,su);var Gm=function(){Sd.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var n=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return n},set:function(t){n=t}});var a=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Gj(a,this.objId,this.scope)},set:function(t){var r,s;s=[],typeof(r=t)=="string"&&(s=(function(e,u,f){f||(f=1);for(var m,g=[];m=u.exec(e);)g.push(m[f]);return g})(r,/\((.*?)\)/g)),a=s}}),this.getOptions=function(){return a},this.setOptions=function(t){a=t,this.sort&&a.sort()},this.addOption=function(t){t=(t=t||"").toString(),a.push(t),this.sort&&a.sort()},this.removeOption=function(t,r){for(r=r||!1,t=(t=t||"").toString();a.indexOf(t)!==-1&&(a.splice(a.indexOf(t),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!ao(this.Ff,18)},set:function(t){t?this.Ff=so(this.Ff,18):this.Ff=no(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!ao(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=so(this.Ff,19):this.Ff=no(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!ao(this.Ff,20)},set:function(t){t?(this.Ff=so(this.Ff,20),a.sort()):this.Ff=no(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!ao(this.Ff,22)},set:function(t){t?this.Ff=so(this.Ff,22):this.Ff=no(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ao(this.Ff,23)},set:function(t){t?this.Ff=so(this.Ff,23):this.Ff=no(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!ao(this.Ff,27)},set:function(t){t?this.Ff=so(this.Ff,27):this.Ff=no(this.Ff,27)}}),this.hasAppearanceStream=!1};Uc(Gm,Sd);var Vm=function(){Gm.call(this),this.fontName="helvetica",this.combo=!1};Uc(Vm,Gm);var Ym=function(){Vm.call(this),this.combo=!0};Uc(Ym,Vm);var j2=function(){Ym.call(this),this.edit=!0};Uc(j2,Ym);var Go=function(){Sd.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!ao(this.Ff,15)},set:function(t){t?this.Ff=so(this.Ff,15):this.Ff=no(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!ao(this.Ff,16)},set:function(t){t?this.Ff=so(this.Ff,16):this.Ff=no(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!ao(this.Ff,17)},set:function(t){t?this.Ff=so(this.Ff,17):this.Ff=no(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!ao(this.Ff,26)},set:function(t){t?this.Ff=so(this.Ff,26):this.Ff=no(this.Ff,26)}});var n,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(e){return e};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(a).length!==0){var r,s=[];for(r in s.push("<<"),a)s.push("/"+r+" ("+Dh(t(a[r]))+")");return s.push(">>"),s.join(`
`)}},set:function(t){wn(t)==="object"&&(a=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(t){typeof t=="string"&&(a.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(t){n="/"+t}})};Uc(Go,Sd);var B2=function(){Go.call(this),this.pushButton=!0};Uc(B2,Go);var Wm=function(){Go.call(this),this.radio=!0,this.pushButton=!1;var n=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return n},set:function(a){n=a!==void 0?a:[]}})};Uc(Wm,Go);var Z2=function(){var n,a;Sd.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return n},set:function(s){n=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return a},set:function(s){a=s}});var t,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(f){return f};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var e,u=[];for(e in u.push("<<"),r)u.push("/"+e+" ("+Dh(s(r[e]))+")");return u.push(">>"),u.join(`
`)},set:function(s){wn(s)==="object"&&(r=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(s){typeof s=="string"&&(r.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(s){t=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(s){t="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=ta.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Uc(Z2,Sd),Wm.prototype.setAppearance=function(n){if(!("createAppearanceStream"in n)||!("getCA"in n))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var a in this.Kids)if(this.Kids.hasOwnProperty(a)){var t=this.Kids[a];t.appearanceStreamContent=n.createAppearanceStream(t.optionName),t.caption=n.getCA()}},Wm.prototype.createOption=function(n){var a=new Z2;return a.Parent=this,a.optionName=n,this.Kids.push(a),q9.call(this.scope,a),a};var S2=function(){Go.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=ta.CheckBox.createAppearanceStream()};Uc(S2,Go);var fh=function(){Sd.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!ao(this.Ff,13)},set:function(a){a?this.Ff=so(this.Ff,13):this.Ff=no(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!ao(this.Ff,21)},set:function(a){a?this.Ff=so(this.Ff,21):this.Ff=no(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!ao(this.Ff,23)},set:function(a){a?this.Ff=so(this.Ff,23):this.Ff=no(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!ao(this.Ff,24)},set:function(a){a?this.Ff=so(this.Ff,24):this.Ff=no(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!ao(this.Ff,25)},set:function(a){a?this.Ff=so(this.Ff,25):this.Ff=no(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!ao(this.Ff,26)},set:function(a){a?this.Ff=so(this.Ff,26):this.Ff=no(this.Ff,26)}});var n=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return n},set:function(a){n=a}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return n},set:function(a){Number.isInteger(a)&&(n=a)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Uc(fh,Sd);var F2=function(){fh.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!ao(this.Ff,14)},set:function(n){n?this.Ff=so(this.Ff,14):this.Ff=no(this.Ff,14)}}),this.password=!0};Uc(F2,fh);var ta={CheckBox:{createAppearanceStream:function(){return{N:{On:ta.CheckBox.YesNormal},D:{On:ta.CheckBox.YesPushDown,Off:ta.CheckBox.OffPushDown}}},YesPushDown:function(n){var a=Jd(n);a.scope=n.scope;var t=[],r=n.scope.internal.getFont(n.fontName,n.fontStyle).id,s=n.scope.__private__.encodeColorString(n.color),e=mw(n,n.caption);return t.push("0.749023 g"),t.push("0 0 "+za(ta.internal.getWidth(n))+" "+za(ta.internal.getHeight(n))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+r+" "+za(e.fontSize)+" Tf "+s),t.push("BT"),t.push(e.text),t.push("ET"),t.push("Q"),t.push("EMC"),a.stream=t.join(`
`),a},YesNormal:function(n){var a=Jd(n);a.scope=n.scope;var t=n.scope.internal.getFont(n.fontName,n.fontStyle).id,r=n.scope.__private__.encodeColorString(n.color),s=[],e=ta.internal.getHeight(n),u=ta.internal.getWidth(n),f=mw(n,n.caption);return s.push("1 g"),s.push("0 0 "+za(u)+" "+za(e)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+za(u-1)+" "+za(e-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+t+" "+za(f.fontSize)+" Tf "+r),s.push(f.text),s.push("ET"),s.push("Q"),a.stream=s.join(`
`),a},OffPushDown:function(n){var a=Jd(n);a.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+za(ta.internal.getWidth(n))+" "+za(ta.internal.getHeight(n))+" re"),t.push("f"),a.stream=t.join(`
`),a}},RadioButton:{Circle:{createAppearanceStream:function(n){var a={D:{Off:ta.RadioButton.Circle.OffPushDown},N:{}};return a.N[n]=ta.RadioButton.Circle.YesNormal,a.D[n]=ta.RadioButton.Circle.YesPushDown,a},getCA:function(){return"l"},YesNormal:function(n){var a=Jd(n);a.scope=n.scope;var t=[],r=ta.internal.getWidth(n)<=ta.internal.getHeight(n)?ta.internal.getWidth(n)/4:ta.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var s=ta.internal.Bezier_C,e=Number((r*s).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+Yf(ta.internal.getWidth(n)/2)+" "+Yf(ta.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+e+" "+e+" "+r+" 0 "+r+" c"),t.push("-"+e+" "+r+" -"+r+" "+e+" -"+r+" 0 c"),t.push("-"+r+" -"+e+" -"+e+" -"+r+" 0 -"+r+" c"),t.push(e+" -"+r+" "+r+" -"+e+" "+r+" 0 c"),t.push("f"),t.push("Q"),a.stream=t.join(`
`),a},YesPushDown:function(n){var a=Jd(n);a.scope=n.scope;var t=[],r=ta.internal.getWidth(n)<=ta.internal.getHeight(n)?ta.internal.getWidth(n)/4:ta.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var s=Number((2*r).toFixed(5)),e=Number((s*ta.internal.Bezier_C).toFixed(5)),u=Number((r*ta.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Yf(ta.internal.getWidth(n)/2)+" "+Yf(ta.internal.getHeight(n)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+e+" "+e+" "+s+" 0 "+s+" c"),t.push("-"+e+" "+s+" -"+s+" "+e+" -"+s+" 0 c"),t.push("-"+s+" -"+e+" -"+e+" -"+s+" 0 -"+s+" c"),t.push(e+" -"+s+" "+s+" -"+e+" "+s+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+Yf(ta.internal.getWidth(n)/2)+" "+Yf(ta.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+u+" "+u+" "+r+" 0 "+r+" c"),t.push("-"+u+" "+r+" -"+r+" "+u+" -"+r+" 0 c"),t.push("-"+r+" -"+u+" -"+u+" -"+r+" 0 -"+r+" c"),t.push(u+" -"+r+" "+r+" -"+u+" "+r+" 0 c"),t.push("f"),t.push("Q"),a.stream=t.join(`
`),a},OffPushDown:function(n){var a=Jd(n);a.scope=n.scope;var t=[],r=ta.internal.getWidth(n)<=ta.internal.getHeight(n)?ta.internal.getWidth(n)/4:ta.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var s=Number((2*r).toFixed(5)),e=Number((s*ta.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Yf(ta.internal.getWidth(n)/2)+" "+Yf(ta.internal.getHeight(n)/2)+" cm"),t.push(s+" 0 m"),t.push(s+" "+e+" "+e+" "+s+" 0 "+s+" c"),t.push("-"+e+" "+s+" -"+s+" "+e+" -"+s+" 0 c"),t.push("-"+s+" -"+e+" -"+e+" -"+s+" 0 -"+s+" c"),t.push(e+" -"+s+" "+s+" -"+e+" "+s+" 0 c"),t.push("f"),t.push("Q"),a.stream=t.join(`
`),a}},Cross:{createAppearanceStream:function(n){var a={D:{Off:ta.RadioButton.Cross.OffPushDown},N:{}};return a.N[n]=ta.RadioButton.Cross.YesNormal,a.D[n]=ta.RadioButton.Cross.YesPushDown,a},getCA:function(){return"8"},YesNormal:function(n){var a=Jd(n);a.scope=n.scope;var t=[],r=ta.internal.calculateCross(n);return t.push("q"),t.push("1 1 "+za(ta.internal.getWidth(n)-2)+" "+za(ta.internal.getHeight(n)-2)+" re"),t.push("W"),t.push("n"),t.push(za(r.x1.x)+" "+za(r.x1.y)+" m"),t.push(za(r.x2.x)+" "+za(r.x2.y)+" l"),t.push(za(r.x4.x)+" "+za(r.x4.y)+" m"),t.push(za(r.x3.x)+" "+za(r.x3.y)+" l"),t.push("s"),t.push("Q"),a.stream=t.join(`
`),a},YesPushDown:function(n){var a=Jd(n);a.scope=n.scope;var t=ta.internal.calculateCross(n),r=[];return r.push("0.749023 g"),r.push("0 0 "+za(ta.internal.getWidth(n))+" "+za(ta.internal.getHeight(n))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+za(ta.internal.getWidth(n)-2)+" "+za(ta.internal.getHeight(n)-2)+" re"),r.push("W"),r.push("n"),r.push(za(t.x1.x)+" "+za(t.x1.y)+" m"),r.push(za(t.x2.x)+" "+za(t.x2.y)+" l"),r.push(za(t.x4.x)+" "+za(t.x4.y)+" m"),r.push(za(t.x3.x)+" "+za(t.x3.y)+" l"),r.push("s"),r.push("Q"),a.stream=r.join(`
`),a},OffPushDown:function(n){var a=Jd(n);a.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+za(ta.internal.getWidth(n))+" "+za(ta.internal.getHeight(n))+" re"),t.push("f"),a.stream=t.join(`
`),a}}},createDefaultAppearanceStream:function(n){var a=n.scope.internal.getFont(n.fontName,n.fontStyle).id,t=n.scope.__private__.encodeColorString(n.color);return"/"+a+" "+n.fontSize+" Tf "+t}};ta.internal={Bezier_C:.551915024494,calculateCross:function(n){var a=ta.internal.getWidth(n),t=ta.internal.getHeight(n),r=Math.min(a,t);return{x1:{x:(a-r)/2,y:(t-r)/2+r},x2:{x:(a-r)/2+r,y:(t-r)/2},x3:{x:(a-r)/2,y:(t-r)/2},x4:{x:(a-r)/2+r,y:(t-r)/2+r}}}},ta.internal.getWidth=function(n){var a=0;return wn(n)==="object"&&(a=D3(n.Rect[2])),a},ta.internal.getHeight=function(n){var a=0;return wn(n)==="object"&&(a=D3(n.Rect[3])),a};var q9=Ri.addField=function(n){if($9(this,n),!(n instanceof Sd))throw new Error("Invalid argument passed to jsPDF.addField.");var a;return(a=n).scope.internal.acroformPlugin.printedOut&&(a.scope.internal.acroformPlugin.printedOut=!1,a.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),a.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(a),n.page=n.scope.internal.getCurrentPageInfo().pageNumber,this};Ri.AcroFormChoiceField=Gm,Ri.AcroFormListBox=Vm,Ri.AcroFormComboBox=Ym,Ri.AcroFormEditBox=j2,Ri.AcroFormButton=Go,Ri.AcroFormPushButton=B2,Ri.AcroFormRadioButton=Wm,Ri.AcroFormCheckBox=S2,Ri.AcroFormTextField=fh,Ri.AcroFormPasswordField=F2,Ri.AcroFormAppearance=ta,Ri.AcroForm={ChoiceField:Gm,ListBox:Vm,ComboBox:Ym,EditBox:j2,Button:Go,PushButton:B2,RadioButton:Wm,CheckBox:S2,TextField:fh,PasswordField:F2,Appearance:ta},ua.AcroForm={ChoiceField:Gm,ListBox:Vm,ComboBox:Ym,EditBox:j2,Button:Go,PushButton:B2,RadioButton:Wm,CheckBox:S2,TextField:fh,PasswordField:F2,Appearance:ta};ua.AcroForm;function Wj(n){return n.reduce(function(a,t,r){return a[t]=r,a},{})}(function(n){var a="addImage_";n.__addimage__={};var t="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=n.__addimage__.getImageFileTypeByImageData=function(z,J){var ge,fe,ke,he,Ne,xe=t;if((J=J||t)==="RGBA"||z.data!==void 0&&z.data instanceof Uint8ClampedArray&&"height"in z&&"width"in z)return"RGBA";if(ee(z))for(Ne in r)for(ke=r[Ne],ge=0;ge<ke.length;ge+=1){for(he=!0,fe=0;fe<ke[ge].length;fe+=1)if(ke[ge][fe]!==void 0&&ke[ge][fe]!==z[fe]){he=!1;break}if(he===!0){xe=Ne;break}}else for(Ne in r)for(ke=r[Ne],ge=0;ge<ke.length;ge+=1){for(he=!0,fe=0;fe<ke[ge].length;fe+=1)if(ke[ge][fe]!==void 0&&ke[ge][fe]!==z.charCodeAt(fe)){he=!1;break}if(he===!0){xe=Ne;break}}return xe===t&&J!==t&&(xe=J),xe},e=function z(J){for(var ge=this.internal.write,fe=this.internal.putStream,ke=(0,this.internal.getFilters)();ke.indexOf("FlateEncode")!==-1;)ke.splice(ke.indexOf("FlateEncode"),1);J.objectId=this.internal.newObject();var he=[];if(he.push({key:"Type",value:"/XObject"}),he.push({key:"Subtype",value:"/Image"}),he.push({key:"Width",value:J.width}),he.push({key:"Height",value:J.height}),J.colorSpace===T.INDEXED?he.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(J.palette.length/3-1)+" "+("sMask"in J&&J.sMask!==void 0?J.objectId+2:J.objectId+1)+" 0 R]"}):(he.push({key:"ColorSpace",value:"/"+J.colorSpace}),J.colorSpace===T.DEVICE_CMYK&&he.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),he.push({key:"BitsPerComponent",value:J.bitsPerComponent}),"decodeParameters"in J&&J.decodeParameters!==void 0&&he.push({key:"DecodeParms",value:"<<"+J.decodeParameters+">>"}),"transparency"in J&&Array.isArray(J.transparency)&&J.transparency.length>0){for(var Ne="",xe=0,we=J.transparency.length;xe<we;xe++)Ne+=J.transparency[xe]+" "+J.transparency[xe]+" ";he.push({key:"Mask",value:"["+Ne+"]"})}J.sMask!==void 0&&he.push({key:"SMask",value:J.objectId+1+" 0 R"});var ye=J.filter!==void 0?["/"+J.filter]:void 0;if(fe({data:J.data,additionalKeyValues:he,alreadyAppliedFilters:ye,objectId:J.objectId}),ge("endobj"),"sMask"in J&&J.sMask!==void 0){var te,V=(te=J.sMaskBitsPerComponent)!==null&&te!==void 0?te:J.bitsPerComponent,le={width:J.width,height:J.height,colorSpace:"DeviceGray",bitsPerComponent:V,data:J.sMask};"filter"in J&&(le.decodeParameters="/Predictor ".concat(J.predictor," /Colors 1 /BitsPerComponent ").concat(V," /Columns ").concat(J.width),le.filter=J.filter),z.call(this,le)}if(J.colorSpace===T.INDEXED){var de=this.internal.newObject();fe({data:ue(new Uint8Array(J.palette)),objectId:de}),ge("endobj")}},u=function(){var z=this.internal.collections[a+"images"];for(var J in z)e.call(this,z[J])},f=function(){var z,J=this.internal.collections[a+"images"],ge=this.internal.write;for(var fe in J)ge("/I"+(z=J[fe]).index,z.objectId,"0","R")},m=function(){this.internal.collections[a+"images"]||(this.internal.collections[a+"images"]={},this.internal.events.subscribe("putResources",u),this.internal.events.subscribe("putXobjectDict",f))},g=function(){var z=this.internal.collections[a+"images"];return m.call(this),z},b=function(){return Object.keys(this.internal.collections[a+"images"]).length},j=function(z){return typeof n["process"+z.toUpperCase()]=="function"},F=function(z){return wn(z)==="object"&&z.nodeType===1},C=function(z,J){if(z.nodeName==="IMG"&&z.hasAttribute("src")){var ge=""+z.getAttribute("src");if(ge.indexOf("data:image/")===0)return C2(unescape(ge).split("base64,").pop());var fe=n.loadFile(ge,!0);if(fe!==void 0)return fe}if(z.nodeName==="CANVAS"){if(z.width===0||z.height===0)throw new Error("Given canvas must have data. Canvas width: "+z.width+", height: "+z.height);var ke;switch(J){case"PNG":ke="image/png";break;case"WEBP":ke="image/webp";break;default:ke="image/jpeg"}return C2(z.toDataURL(ke,1).split("base64,").pop())}},M=function(z){var J=this.internal.collections[a+"images"];if(J){for(var ge in J)if(z===J[ge].alias)return J[ge]}},_=function(z,J,ge){return z||J||(z=-96,J=-96),z<0&&(z=-1*ge.width*72/z/this.internal.scaleFactor),J<0&&(J=-1*ge.height*72/J/this.internal.scaleFactor),z===0&&(z=J*ge.width/ge.height),J===0&&(J=z*ge.height/ge.width),[z,J]},L=function(z,J,ge,fe,ke,he){var Ne=_.call(this,ge,fe,ke),xe=this.internal.getCoordinateString,we=this.internal.getVerticalCoordinateString,ye=g.call(this);if(ge=Ne[0],fe=Ne[1],ye[ke.index]=ke,he){he*=Math.PI/180;var te=Math.cos(he),V=Math.sin(he),le=function(X){return X.toFixed(4)},de=[le(te),le(V),le(-1*V),le(te),0,0,"cm"]}this.internal.write("q"),he?(this.internal.write([1,"0","0",1,xe(z),we(J+fe),"cm"].join(" ")),this.internal.write(de.join(" ")),this.internal.write([xe(ge),"0","0",xe(fe),"0","0","cm"].join(" "))):this.internal.write([xe(ge),"0","0",xe(fe),xe(z),we(J+fe),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ke.index+" Do"),this.internal.write("Q")},T=n.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};n.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var H=n.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},O=n.__addimage__.sHashCode=function(z){var J,ge,fe=0;if(typeof z=="string")for(ge=z.length,J=0;J<ge;J++)fe=(fe<<5)-fe+z.charCodeAt(J),fe|=0;else if(ee(z))for(ge=z.byteLength/2,J=0;J<ge;J++)fe=(fe<<5)-fe+z[J],fe|=0;return fe},Q=n.__addimage__.validateStringAsBase64=function(z){(z=z||"").toString().trim();var J=!0;return z.length===0&&(J=!1),z.length%4!=0&&(J=!1),/^[A-Za-z0-9+/]+$/.test(z.substr(0,z.length-2))===!1&&(J=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(z.substr(-2))===!1&&(J=!1),J},Z=n.__addimage__.extractImageFromDataUrl=function(z){if(z==null||!(z=z.trim()).startsWith("data:"))return null;var J=z.indexOf(",");return J<0?null:z.substring(0,J).trim().endsWith("base64")?z.substring(J+1):null};n.__addimage__.isArrayBuffer=function(z){return z instanceof ArrayBuffer};var ee=n.__addimage__.isArrayBufferView=function(z){return z instanceof Int8Array||z instanceof Uint8Array||z instanceof Uint8ClampedArray||z instanceof Int16Array||z instanceof Uint16Array||z instanceof Int32Array||z instanceof Uint32Array||z instanceof Float32Array||z instanceof Float64Array},se=n.__addimage__.binaryStringToUint8Array=function(z){for(var J=z.length,ge=new Uint8Array(J),fe=0;fe<J;fe++)ge[fe]=z.charCodeAt(fe);return ge},ue=n.__addimage__.arrayBufferToBinaryString=function(z){for(var J="",ge=ee(z)?z:new Uint8Array(z),fe=0;fe<ge.length;fe+=8192)J+=String.fromCharCode.apply(null,ge.subarray(fe,fe+8192));return J};n.addImage=function(){var z,J,ge,fe,ke,he,Ne,xe,we;if(typeof arguments[1]=="number"?(J=t,ge=arguments[1],fe=arguments[2],ke=arguments[3],he=arguments[4],Ne=arguments[5],xe=arguments[6],we=arguments[7]):(J=arguments[1],ge=arguments[2],fe=arguments[3],ke=arguments[4],he=arguments[5],Ne=arguments[6],xe=arguments[7],we=arguments[8]),wn(z=arguments[0])==="object"&&!F(z)&&"imageData"in z){var ye=z;z=ye.imageData,J=ye.format||J||t,ge=ye.x||ge||0,fe=ye.y||fe||0,ke=ye.w||ye.width||ke,he=ye.h||ye.height||he,Ne=ye.alias||Ne,xe=ye.compression||xe,we=ye.rotation||ye.angle||we}var te=this.internal.getFilters();if(xe===void 0&&te.indexOf("FlateEncode")!==-1&&(xe="SLOW"),isNaN(ge)||isNaN(fe))throw new Error("Invalid coordinates passed to jsPDF.addImage");m.call(this);var V=ae.call(this,z,J,Ne,xe);return L.call(this,ge,fe,ke,he,V,we),this};var ae=function(z,J,ge,fe){var ke,he,Ne;if(typeof z=="string"&&s(z)===t){z=unescape(z);var xe=pe(z,!1);(xe!==""||(xe=n.loadFile(z,!0))!==void 0)&&(z=xe)}if(F(z)&&(z=C(z,J)),J=s(z,J),!j(J))throw new Error("addImage does not support files of type '"+J+"', please ensure that a plugin for '"+J+"' support is added.");if(((Ne=ge)==null||Ne.length===0)&&(ge=(function(we){return typeof we=="string"||ee(we)?O(we):ee(we.data)?O(we.data):null})(z)),(ke=M.call(this,ge))||(z instanceof Uint8Array||J==="RGBA"||(he=z,z=se(z)),ke=this["process"+J.toUpperCase()](z,b.call(this),ge,(function(we){return we&&typeof we=="string"&&(we=we.toUpperCase()),we in n.image_compression?we:H.NONE})(fe),he)),!ke)throw new Error("An unknown error occurred whilst processing the image.");return ke},pe=n.__addimage__.convertBase64ToBinaryString=function(z,J){J=typeof J!="boolean"||J;var ge,fe="";if(typeof z=="string"){var ke;ge=(ke=Z(z))!==null&&ke!==void 0?ke:z;try{fe=C2(ge)}catch(he){if(J)throw Q(ge)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+he.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return fe};n.getImageProperties=function(z){var J,ge,fe="";if(F(z)&&(z=C(z)),typeof z=="string"&&s(z)===t&&((fe=pe(z,!1))===""&&(fe=n.loadFile(z)||""),z=fe),ge=s(z),!j(ge))throw new Error("addImage does not support files of type '"+ge+"', please ensure that a plugin for '"+ge+"' support is added.");if(z instanceof Uint8Array||(z=se(z)),!(J=this["process"+ge.toUpperCase()](z)))throw new Error("An unknown error occurred whilst processing the image");return J.fileType=ge,J}})(ua.API),(function(n){var a=function(t){if(t!==void 0&&t!="")return!0};ua.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),n.events.push(["putPage",function(t){for(var r,s,e,u=this.internal.getCoordinateString,f=this.internal.getVerticalCoordinateString,m=this.internal.getPageInfoByObjId(t.objId),g=t.pageContext.annotations,b=!1,j=0;j<g.length&&!b;j++)switch((r=g[j]).type){case"link":(a(r.options.url)||a(r.options.pageNumber))&&(b=!0);break;case"reference":case"text":case"freetext":b=!0}if(b!=0){this.internal.write("/Annots [");for(var F=0;F<g.length;F++){r=g[F];var C=this.internal.pdfEscape,M=this.internal.getEncryptor(t.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var _=this.internal.newAdditionalObject(),L=this.internal.newAdditionalObject(),T=this.internal.getEncryptor(_.objId),H=r.title||"Note";e="<</Type /Annot /Subtype /Text "+(s="/Rect ["+u(r.bounds.x)+" "+f(r.bounds.y+r.bounds.h)+" "+u(r.bounds.x+r.bounds.w)+" "+f(r.bounds.y)+"] ")+"/Contents ("+C(T(r.contents))+")",e+=" /Popup "+L.objId+" 0 R",e+=" /P "+m.objId+" 0 R",e+=" /T ("+C(T(H))+") >>",_.content=e;var O=_.objId+" 0 R";e="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+u(r.bounds.x+30)+" "+f(r.bounds.y+r.bounds.h)+" "+u(r.bounds.x+r.bounds.w+30)+" "+f(r.bounds.y)+"] ")+" /Parent "+O,r.open&&(e+=" /Open true"),e+=" >>",L.content=e,this.internal.write(_.objId,"0 R",L.objId,"0 R");break;case"freetext":s="/Rect ["+u(r.bounds.x)+" "+f(r.bounds.y)+" "+u(r.bounds.x+r.bounds.w)+" "+f(r.bounds.y+r.bounds.h)+"] ";var Q=r.color||"#000000";e="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+C(M(r.contents))+")",e+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+Q+")",e+=" /Border [0 0 0]",e+=" >>",this.internal.write(e);break;case"link":if(r.options.name){var Z=this.annotations._nameMap[r.options.name];r.options.pageNumber=Z.page,r.options.top=Z.y}else r.options.top||(r.options.top=0);if(s="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",e="",r.options.url)e="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+C(M(r.options.url))+") >>";else if(r.options.pageNumber)switch(e="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":e+=" /Fit]";break;case"FitH":e+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,e+=" /FitV "+r.options.left+"]";break;default:var ee=f(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),e+=" /XYZ "+r.options.left+" "+ee+" "+r.options.zoom+"]"}e!=""&&(e+=" >>",this.internal.write(e))}}this.internal.write("]")}}]),n.createAnnotation=function(t){var r=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":r.pageContext.annotations.push(t)}},n.link=function(t,r,s,e,u){var f=this.internal.getCurrentPageInfo(),m=this.internal.getCoordinateString,g=this.internal.getVerticalCoordinateString;f.pageContext.annotations.push({finalBounds:{x:m(t),y:g(r),w:m(t+s),h:g(r+e)},options:u,type:"link"})},n.textWithLink=function(t,r,s,e){var u,f,m=this.getTextWidth(t),g=this.internal.getLineHeight()/this.internal.scaleFactor;if(e.maxWidth!==void 0){f=e.maxWidth;var b=this.splitTextToSize(t,f).length;u=Math.ceil(g*b)}else f=m,u=g;return this.text(t,r,s,e),s+=.2*g,e.align==="center"&&(r-=m/2),e.align==="right"&&(r-=m),this.link(r,s-g,f,u,e),m},n.getTextWidth=function(t){var r=this.internal.getFontSize();return this.getStringUnitWidth(t)*r/this.internal.scaleFactor}})(ua.API),(function(n){var a={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];n.__arabicParser__={};var e=n.__arabicParser__.isInArabicSubstitutionA=function(_){return a[_.charCodeAt(0)]!==void 0},u=n.__arabicParser__.isArabicLetter=function(_){return typeof _=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(_)},f=n.__arabicParser__.isArabicEndLetter=function(_){return u(_)&&e(_)&&a[_.charCodeAt(0)].length<=2},m=n.__arabicParser__.isArabicAlfLetter=function(_){return u(_)&&s.indexOf(_.charCodeAt(0))>=0};n.__arabicParser__.arabicLetterHasIsolatedForm=function(_){return u(_)&&e(_)&&a[_.charCodeAt(0)].length>=1};var g=n.__arabicParser__.arabicLetterHasFinalForm=function(_){return u(_)&&e(_)&&a[_.charCodeAt(0)].length>=2};n.__arabicParser__.arabicLetterHasInitialForm=function(_){return u(_)&&e(_)&&a[_.charCodeAt(0)].length>=3};var b=n.__arabicParser__.arabicLetterHasMedialForm=function(_){return u(_)&&e(_)&&a[_.charCodeAt(0)].length==4},j=n.__arabicParser__.resolveLigatures=function(_){var L=0,T=t,H="",O=0;for(L=0;L<_.length;L+=1)T[_.charCodeAt(L)]!==void 0?(O++,typeof(T=T[_.charCodeAt(L)])=="number"&&(H+=String.fromCharCode(T),T=t,O=0),L===_.length-1&&(T=t,H+=_.charAt(L-(O-1)),L-=O-1,O=0)):(T=t,H+=_.charAt(L-O),L-=O,O=0);return H};n.__arabicParser__.isArabicDiacritic=function(_){return _!==void 0&&r[_.charCodeAt(0)]!==void 0};var F=n.__arabicParser__.getCorrectForm=function(_,L,T){return u(_)?e(_)===!1?-1:!g(_)||!u(L)&&!u(T)||!u(T)&&f(L)||f(_)&&!u(L)||f(_)&&m(L)||f(_)&&f(L)?0:b(_)&&u(L)&&!f(L)&&u(T)&&g(T)?3:f(_)||!u(T)?1:2:-1},C=function(_){var L=0,T=0,H=0,O="",Q="",Z="",ee=(_=_||"").split("\\s+"),se=[];for(L=0;L<ee.length;L+=1){for(se.push(""),T=0;T<ee[L].length;T+=1)O=ee[L][T],Q=ee[L][T-1],Z=ee[L][T+1],u(O)?(H=F(O,Q,Z),se[L]+=H!==-1?String.fromCharCode(a[O.charCodeAt(0)][H]):O):se[L]+=O;se[L]=j(se[L])}return se.join(" ")},M=n.__arabicParser__.processArabic=n.processArabic=function(){var _,L=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,T=[];if(Array.isArray(L)){var H=0;for(T=[],H=0;H<L.length;H+=1)Array.isArray(L[H])?T.push([C(L[H][0]),L[H][1],L[H][2]]):T.push([C(L[H])]);_=T}else _=C(L);return typeof arguments[0]=="string"?_:(arguments[0].text=_,arguments[0])};n.events.push(["preProcessText",M])})(ua.API),ua.API.autoPrint=function(n){var a;return(n=n||{}).variant=n.variant||"non-conform",n.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){a=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+a+" 0 R")})),this},(function(n){var a=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(f){t=f}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(f){r=isNaN(f)||Number.isInteger(f)===!1||f<0?150:f,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(f){s=isNaN(f)||Number.isInteger(f)===!1||f<0?300:f,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var e=[];Object.defineProperty(this,"childNodes",{get:function(){return e},set:function(f){e=f}});var u={};Object.defineProperty(this,"style",{get:function(){return u},set:function(f){u=f}}),Object.defineProperty(this,"parentNode",{})};a.prototype.getContext=function(t,r){var s;if((t=t||"2d")!=="2d")return null;for(s in r)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=r[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},a.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},n.events.push(["initialized",function(){this.canvas=new a,this.canvas.pdf=this}])})(ua.API),(function(n){var a={left:0,top:0,bottom:0,right:0},t=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},a),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new e,this.internal.__cell__.pages=1},e=function(){var m=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return m},set:function(_){m=_}});var g=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return g},set:function(_){g=_}});var b=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return b},set:function(_){b=_}});var j=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return j},set:function(_){j=_}});var F=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return F},set:function(_){F=_}});var C=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return C},set:function(_){C=_}});var M=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return M},set:function(_){M=_}}),this};e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},e.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},n.setHeaderFunction=function(m){return r.call(this),this.internal.__cell__.headerFunction=typeof m=="function"?m:void 0,this},n.getTextDimensions=function(m,g){r.call(this);var b=(g=g||{}).fontSize||this.getFontSize(),j=g.font||this.getFont(),F=g.scaleFactor||this.internal.scaleFactor,C=0,M=0,_=0,L=this;if(!Array.isArray(m)&&typeof m!="string"){if(typeof m!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");m=String(m)}var T=g.maxWidth;T>0?typeof m=="string"?m=this.splitTextToSize(m,T):Object.prototype.toString.call(m)==="[object Array]"&&(m=m.reduce(function(O,Q){return O.concat(L.splitTextToSize(Q,T))},[])):m=Array.isArray(m)?m:[m];for(var H=0;H<m.length;H++)C<(_=this.getStringUnitWidth(m[H],{font:j})*b)&&(C=_);return C!==0&&(M=m.length),{w:C/=F,h:Math.max((M*b*this.getLineHeightFactor()-b*(this.getLineHeightFactor()-1))/F,0)}},n.cellAddPage=function(){r.call(this),this.addPage();var m=this.internal.__cell__.margins||a;return this.internal.__cell__.lastCell=new e(m.left,m.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var u=n.cell=function(){var m;m=arguments[0]instanceof e?arguments[0]:new e(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var g=this.internal.__cell__.lastCell,b=this.internal.__cell__.padding,j=this.internal.__cell__.margins||a,F=this.internal.__cell__.tableHeaderRow,C=this.internal.__cell__.printHeaders;return g.lineNumber!==void 0&&(g.lineNumber===m.lineNumber?(m.x=(g.x||0)+(g.width||0),m.y=g.y||0):g.y+g.height+m.height+j.bottom>this.getPageHeight()?(this.cellAddPage(),m.y=j.top,C&&F&&(this.printHeaderRow(m.lineNumber,!0),m.y+=F[0].height)):m.y=g.y+g.height||m.y),m.text[0]!==void 0&&(this.rect(m.x,m.y,m.width,m.height,t===!0?"FD":void 0),m.align==="right"?this.text(m.text,m.x+m.width-b,m.y+b,{align:"right",baseline:"top"}):m.align==="center"?this.text(m.text,m.x+m.width/2,m.y+b,{align:"center",baseline:"top",maxWidth:m.width-b-b}):this.text(m.text,m.x+b,m.y+b,{align:"left",baseline:"top",maxWidth:m.width-b-b})),this.internal.__cell__.lastCell=m,this};n.table=function(m,g,b,j,F){if(r.call(this),!b)throw new Error("No data for PDF table.");var C,M,_,L,T=[],H=[],O=[],Q={},Z={},ee=[],se=[],ue=(F=F||{}).autoSize||!1,ae=F.printHeaders!==!1,pe=F.css&&F.css["font-size"]!==void 0?16*F.css["font-size"]:F.fontSize||12,z=F.margins||Object.assign({width:this.getPageWidth()},a),J=typeof F.padding=="number"?F.padding:3,ge=F.headerBackgroundColor||"#c8c8c8",fe=F.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=ae,this.internal.__cell__.margins=z,this.internal.__cell__.table_font_size=pe,this.internal.__cell__.padding=J,this.internal.__cell__.headerBackgroundColor=ge,this.internal.__cell__.headerTextColor=fe,this.setFontSize(pe),j==null)H=T=Object.keys(b[0]),O=T.map(function(){return"left"});else if(Array.isArray(j)&&wn(j[0])==="object")for(T=j.map(function(ye){return ye.name}),H=j.map(function(ye){return ye.prompt||ye.name||""}),O=j.map(function(ye){return ye.align||"left"}),C=0;C<j.length;C+=1)Z[j[C].name]=.7499990551181103*j[C].width;else Array.isArray(j)&&typeof j[0]=="string"&&(H=T=j,O=T.map(function(){return"left"}));if(ue||Array.isArray(j)&&typeof j[0]=="string")for(C=0;C<T.length;C+=1){for(Q[L=T[C]]=b.map(function(ye){return ye[L]}),this.setFont(void 0,"bold"),ee.push(this.getTextDimensions(H[C],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),M=Q[L],this.setFont(void 0,"normal"),_=0;_<M.length;_+=1)ee.push(this.getTextDimensions(M[_],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);Z[L]=Math.max.apply(null,ee)+J+J,ee=[]}if(ae){var ke={};for(C=0;C<T.length;C+=1)ke[T[C]]={},ke[T[C]].text=H[C],ke[T[C]].align=O[C];var he=f.call(this,ke,Z);se=T.map(function(ye){return new e(m,g,Z[ye],he,ke[ye].text,void 0,ke[ye].align)}),this.setTableHeaderRow(se),this.printHeaderRow(1,!1)}var Ne=j.reduce(function(ye,te){return ye[te.name]=te.align,ye},{});for(C=0;C<b.length;C+=1){"rowStart"in F&&F.rowStart instanceof Function&&F.rowStart({row:C,data:b[C]},this);var xe=f.call(this,b[C],Z);for(_=0;_<T.length;_+=1){var we=b[C][T[_]];"cellStart"in F&&F.cellStart instanceof Function&&F.cellStart({row:C,col:_,data:we},this),u.call(this,new e(m,g,Z[T[_]],xe,we,C+2,Ne[T[_]]))}}return this.internal.__cell__.table_x=m,this.internal.__cell__.table_y=g,this};var f=function(m,g){var b=this.internal.__cell__.padding,j=this.internal.__cell__.table_font_size,F=this.internal.scaleFactor;return Object.keys(m).map(function(C){var M=m[C];return this.splitTextToSize(M.hasOwnProperty("text")?M.text:M,g[C]-b-b)},this).map(function(C){return this.getLineHeightFactor()*C.length*j/F+b+b},this).reduce(function(C,M){return Math.max(C,M)},0)};n.setTableHeaderRow=function(m){r.call(this),this.internal.__cell__.tableHeaderRow=m},n.printHeaderRow=function(m,g){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var b;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var j=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new e(j[0],j[1],j[2],j[3],void 0,-1)}this.setFont(void 0,"bold");for(var F=[],C=0;C<this.internal.__cell__.tableHeaderRow.length;C+=1){b=this.internal.__cell__.tableHeaderRow[C].clone(),g&&(b.y=this.internal.__cell__.margins.top||0,F.push(b)),b.lineNumber=m;var M=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),u.call(this,b),this.setTextColor(M)}F.length>0&&this.setTableHeaderRow(F),this.setFont(void 0,"normal"),t=!1}})(ua.API);var $j={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},qj=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],pw=Wj(qj),Xj=[100,200,300,400,500,600,700,800,900],X9=Wj(Xj);function ev(n){var a=n.family.replace(/"|'/g,"").toLowerCase(),t=(function(e){return $j[e=e||"normal"]?e:"normal"})(n.style),r=(function(e){return e?typeof e=="number"?e>=100&&e<=900&&e%100==0?e:400:/^\d00$/.test(e)?parseInt(e):e==="bold"?700:400:400})(n.weight),s=(function(e){return typeof pw[e=e||"normal"]=="number"?e:"normal"})(n.stretch);return{family:a,style:t,weight:r,stretch:s,src:n.src||[],ref:n.ref||{name:a,style:[s,t,r].join(" ")}}}function T3(n,a,t,r){var s;for(s=t;s>=0&&s<a.length;s+=r)if(n[a[s]])return n[a[s]];for(s=t;s>=0&&s<a.length;s-=r)if(n[a[s]])return n[a[s]]}var J9={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},_3={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function L3(n){return[n.stretch,n.style,n.weight,n.family].join(" ")}function U3(n){return n.trimLeft()}function Z9(n,a){for(var t=0;t<n.length;){if(n.charAt(t)===a)return[n.substring(0,t),n.substring(t+1)];t+=1}return null}function e_(n){var a=n.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return a===null?null:[a[0],n.substring(a[0].length)]}var Lx,M3,I3,Fm,Ux,O3,Q3,R3,tv=["times"];function P3(n,a,t,r,s){var e=4,u=z3;switch(s){case ua.API.image_compression.FAST:e=1,u=H3;break;case ua.API.image_compression.MEDIUM:e=6,u=K3;break;case ua.API.image_compression.SLOW:e=9,u=G3}n=(function(m,g,b,j){for(var F,C=m.length/g,M=new Uint8Array(m.length+C),_=[t_,H3,z3,K3,G3],L=0;L<C;L+=1){var T=L*g,H=m.subarray(T,T+g);if(j)M.set(j(H,b,F),T+L);else{for(var O=_.length,Q=[],Z=0;Z<O;Z+=1)Q[Z]=_[Z](H,b,F);var ee=a_(Q.concat());M.set(Q[ee],T+L)}F=H}return M})(n,a,Math.ceil(t*r/8),u);var f=cw(n,{level:e});return ua.API.__addimage__.arrayBufferToBinaryString(f)}function t_(n){var a=Array.apply([],n);return a.unshift(0),a}function H3(n,a){var t=n.length,r=[];r[0]=1;for(var s=0;s<t;s+=1){var e=n[s-a]||0;r[s+1]=n[s]-e+256&255}return r}function z3(n,a,t){var r=n.length,s=[];s[0]=2;for(var e=0;e<r;e+=1){var u=t&&t[e]||0;s[e+1]=n[e]-u+256&255}return s}function K3(n,a,t){var r=n.length,s=[];s[0]=3;for(var e=0;e<r;e+=1){var u=n[e-a]||0,f=t&&t[e]||0;s[e+1]=n[e]+256-(u+f>>>1)&255}return s}function G3(n,a,t){var r=n.length,s=[];s[0]=4;for(var e=0;e<r;e+=1){var u=r_(n[e-a]||0,t&&t[e]||0,t&&t[e-a]||0);s[e+1]=n[e]-u+256&255}return s}function r_(n,a,t){if(n===a&&a===t)return n;var r=Math.abs(a-t),s=Math.abs(n-t),e=Math.abs(n+a-t-t);return r<=s&&r<=e?n:s<=e?a:t}function a_(n){var a=n.map(function(t){return t.reduce(function(r,s){return r+Math.abs(s)},0)});return a.indexOf(Math.min.apply(null,a))}function rv(n,a,t){var r=a*t,s=Math.floor(r/8),e=16-(r-8*s+t),u=(1<<t)-1;return Jj(n,s)>>e&u}function V3(n,a,t,r){var s=t*r,e=Math.floor(s/8),u=16-(s-8*e+r),f=(1<<r)-1,m=(a&f)<<u;(function(g,b,j){if(b+1<g.byteLength)g.setUint16(b,j,!1);else{var F=j>>8&255;g.setUint8(b,F)}})(n,e,Jj(n,e)&~(f<<u)&65535|m)}function Jj(n,a){return a+1<n.byteLength?n.getUint16(a,!1):n.getUint8(a)<<8}function s_(n){var a=0;if(n[a++]!==71||n[a++]!==73||n[a++]!==70||n[a++]!==56||(n[a++]+1&253)!=56||n[a++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=n[a++]|n[a++]<<8,r=n[a++]|n[a++]<<8,s=n[a++],e=s>>7,u=1<<1+(7&s);n[a++],n[a++];var f=null,m=null;e&&(f=a,m=u,a+=3*u);var g=!0,b=[],j=0,F=null,C=0,M=null;for(this.width=t,this.height=r;g&&a<n.length;)switch(n[a++]){case 33:switch(n[a++]){case 255:if(n[a]!==11||n[a+1]==78&&n[a+2]==69&&n[a+3]==84&&n[a+4]==83&&n[a+5]==67&&n[a+6]==65&&n[a+7]==80&&n[a+8]==69&&n[a+9]==50&&n[a+10]==46&&n[a+11]==48&&n[a+12]==3&&n[a+13]==1&&n[a+16]==0)a+=14,M=n[a++]|n[a++]<<8,a++;else for(a+=12;;){if(!((z=n[a++])>=0))throw Error("Invalid block size");if(z===0)break;a+=z}break;case 249:if(n[a++]!==4||n[a+4]!==0)throw new Error("Invalid graphics extension block.");var _=n[a++];j=n[a++]|n[a++]<<8,F=n[a++],1&_||(F=null),C=_>>2&7,a++;break;case 254:for(;;){if(!((z=n[a++])>=0))throw Error("Invalid block size");if(z===0)break;a+=z}break;default:throw new Error("Unknown graphic control label: 0x"+n[a-1].toString(16))}break;case 44:var L=n[a++]|n[a++]<<8,T=n[a++]|n[a++]<<8,H=n[a++]|n[a++]<<8,O=n[a++]|n[a++]<<8,Q=n[a++],Z=Q>>6&1,ee=1<<1+(7&Q),se=f,ue=m,ae=!1;Q>>7&&(ae=!0,se=a,ue=ee,a+=3*ee);var pe=a;for(a++;;){var z;if(!((z=n[a++])>=0))throw Error("Invalid block size");if(z===0)break;a+=z}b.push({x:L,y:T,width:H,height:O,has_local_palette:ae,palette_offset:se,palette_size:ue,data_offset:pe,data_length:a-pe,transparent_index:F,interlaced:!!Z,delay:j,disposal:C});break;case 59:g=!1;break;default:throw new Error("Unknown gif block: 0x"+n[a-1].toString(16))}this.numFrames=function(){return b.length},this.loopCount=function(){return M},this.frameInfo=function(J){if(J<0||J>=b.length)throw new Error("Frame index out of range.");return b[J]},this.decodeAndBlitFrameBGRA=function(J,ge){var fe=this.frameInfo(J),ke=fe.width*fe.height,he=new Uint8Array(ke);Y3(n,fe.data_offset,he,ke);var Ne=fe.palette_offset,xe=fe.transparent_index;xe===null&&(xe=256);var we=fe.width,ye=t-we,te=we,V=4*(fe.y*t+fe.x),le=4*((fe.y+fe.height)*t+fe.x),de=V,X=4*ye;fe.interlaced===!0&&(X+=4*t*7);for(var ie=8,G=0,q=he.length;G<q;++G){var ve=he[G];if(te===0&&(te=we,(de+=X)>=le&&(X=4*ye+4*t*(ie-1),de=V+(we+ye)*(ie<<1),ie>>=1)),ve===xe)de+=4;else{var Fe=n[Ne+3*ve],Qe=n[Ne+3*ve+1],Ge=n[Ne+3*ve+2];ge[de++]=Ge,ge[de++]=Qe,ge[de++]=Fe,ge[de++]=255}--te}},this.decodeAndBlitFrameRGBA=function(J,ge){var fe=this.frameInfo(J),ke=fe.width*fe.height,he=new Uint8Array(ke);Y3(n,fe.data_offset,he,ke);var Ne=fe.palette_offset,xe=fe.transparent_index;xe===null&&(xe=256);var we=fe.width,ye=t-we,te=we,V=4*(fe.y*t+fe.x),le=4*((fe.y+fe.height)*t+fe.x),de=V,X=4*ye;fe.interlaced===!0&&(X+=4*t*7);for(var ie=8,G=0,q=he.length;G<q;++G){var ve=he[G];if(te===0&&(te=we,(de+=X)>=le&&(X=4*ye+4*t*(ie-1),de=V+(we+ye)*(ie<<1),ie>>=1)),ve===xe)de+=4;else{var Fe=n[Ne+3*ve],Qe=n[Ne+3*ve+1],Ge=n[Ne+3*ve+2];ge[de++]=Fe,ge[de++]=Qe,ge[de++]=Ge,ge[de++]=255}--te}}}function Y3(n,a,t,r){for(var s=n[a++],e=1<<s,u=e+1,f=u+1,m=s+1,g=(1<<m)-1,b=0,j=0,F=0,C=n[a++],M=new Int32Array(4096),_=null;;){for(;b<16&&C!==0;)j|=n[a++]<<b,b+=8,C===1?C=n[a++]:--C;if(b<m)break;var L=j&g;if(j>>=m,b-=m,L!==e){if(L===u)break;for(var T=L<f?L:_,H=0,O=T;O>e;)O=M[O]>>8,++H;var Q=O;if(F+H+(T!==L?1:0)>r)return void Rn.log("Warning, gif stream longer than expected.");t[F++]=Q;var Z=F+=H;for(T!==L&&(t[F++]=Q),O=T;H--;)O=M[O],t[--Z]=255&O,O>>=8;_!==null&&f<4096&&(M[f++]=_<<8|Q,f>=g+1&&m<12&&(++m,g=g<<1|1)),_=L}else f=u+1,g=(1<<(m=s+1))-1,_=null}return F!==r&&Rn.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function av(n){var a,t,r,s,e,u=Math.floor,f=new Array(64),m=new Array(64),g=new Array(64),b=new Array(64),j=new Array(65535),F=new Array(65535),C=new Array(64),M=new Array(64),_=[],L=0,T=7,H=new Array(64),O=new Array(64),Q=new Array(64),Z=new Array(256),ee=new Array(2048),se=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],ue=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],ae=[0,1,2,3,4,5,6,7,8,9,10,11],pe=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],z=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],J=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],ge=[0,1,2,3,4,5,6,7,8,9,10,11],fe=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ke=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function he(V,le){for(var de=0,X=0,ie=new Array,G=1;G<=16;G++){for(var q=1;q<=V[G];q++)ie[le[X]]=[],ie[le[X]][0]=de,ie[le[X]][1]=G,X++,de++;de*=2}return ie}function Ne(V){for(var le=V[0],de=V[1]-1;de>=0;)le&1<<de&&(L|=1<<T),de--,--T<0&&(L==255?(xe(255),xe(0)):xe(L),T=7,L=0)}function xe(V){_.push(V)}function we(V){xe(V>>8&255),xe(255&V)}function ye(V,le,de,X,ie){for(var G,q=ie[0],ve=ie[240],Fe=(function(ut,Rt){var Ye,St,Jt,mr,ar,bt,Yt,vr,gr,Mr,Ot=0;for(gr=0;gr<8;++gr){Ye=ut[Ot],St=ut[Ot+1],Jt=ut[Ot+2],mr=ut[Ot+3],ar=ut[Ot+4],bt=ut[Ot+5],Yt=ut[Ot+6];var ja=Ye+(vr=ut[Ot+7]),oa=Ye-vr,hr=St+Yt,pr=St-Yt,Gr=Jt+bt,Pr=Jt-bt,wa=mr+ar,jr=mr-ar,Ms=ja+wa,Rs=ja-wa,or=hr+Gr,Nr=hr-Gr;ut[Ot]=Ms+or,ut[Ot+4]=Ms-or;var $t=.707106781*(Nr+Rs);ut[Ot+2]=Rs+$t,ut[Ot+6]=Rs-$t;var Vo=.382683433*((Ms=jr+Pr)-(Nr=pr+oa)),Hn=.5411961*Ms+Vo,hs=1.306562965*Nr+Vo,co=.707106781*(or=Pr+pr),ra=oa+co,ko=oa-co;ut[Ot+5]=ko+Hn,ut[Ot+3]=ko-Hn,ut[Ot+1]=ra+hs,ut[Ot+7]=ra-hs,Ot+=8}for(Ot=0,gr=0;gr<8;++gr){Ye=ut[Ot],St=ut[Ot+8],Jt=ut[Ot+16],mr=ut[Ot+24],ar=ut[Ot+32],bt=ut[Ot+40],Yt=ut[Ot+48];var zi=Ye+(vr=ut[Ot+56]),ms=Ye-vr,pi=St+Yt,en=St-Yt,Tn=Jt+bt,_n=Jt-bt,Yo=mr+ar,Si=mr-ar,Is=zi+Yo,ba=zi-Yo,Cn=pi+Tn,Oa=pi-Tn;ut[Ot]=Is+Cn,ut[Ot+32]=Is-Cn;var ss=.707106781*(Oa+ba);ut[Ot+16]=ba+ss,ut[Ot+48]=ba-ss;var gi=.382683433*((Is=Si+_n)-(Oa=en+ms)),Wo=.5411961*Is+gi,Fi=1.306562965*Oa+gi,Hl=.707106781*(Cn=_n+en),$o=ms+Hl,Do=ms-Hl;ut[Ot+40]=Do+Wo,ut[Ot+24]=Do-Wo,ut[Ot+8]=$o+Fi,ut[Ot+56]=$o-Fi,Ot++}for(gr=0;gr<64;++gr)Mr=ut[gr]*Rt[gr],C[gr]=Mr>0?Mr+.5|0:Mr-.5|0;return C})(V,le),Qe=0;Qe<64;++Qe)M[se[Qe]]=Fe[Qe];var Ge=M[0]-de;de=M[0],Ge==0?Ne(X[0]):(Ne(X[F[G=32767+Ge]]),Ne(j[G]));for(var je=63;je>0&&M[je]==0;)je--;if(je==0)return Ne(q),de;for(var Me,Se=1;Se<=je;){for(var ft=Se;M[Se]==0&&Se<=je;)++Se;var jt=Se-ft;if(jt>=16){Me=jt>>4;for(var It=1;It<=Me;++It)Ne(ve);jt&=15}G=32767+M[Se],Ne(ie[(jt<<4)+F[G]]),Ne(j[G]),Se++}return je!=63&&Ne(q),de}function te(V){V=Math.min(Math.max(V,1),100),e!=V&&((function(le){for(var de=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],X=0;X<64;X++){var ie=u((de[X]*le+50)/100);ie=Math.min(Math.max(ie,1),255),f[se[X]]=ie}for(var G=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],q=0;q<64;q++){var ve=u((G[q]*le+50)/100);ve=Math.min(Math.max(ve,1),255),m[se[q]]=ve}for(var Fe=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Qe=0,Ge=0;Ge<8;Ge++)for(var je=0;je<8;je++)g[Qe]=1/(f[se[Qe]]*Fe[Ge]*Fe[je]*8),b[Qe]=1/(m[se[Qe]]*Fe[Ge]*Fe[je]*8),Qe++})(V<50?Math.floor(5e3/V):Math.floor(200-2*V)),e=V)}this.encode=function(V,le){le&&te(le),_=new Array,L=0,T=7,we(65496),we(65504),we(16),xe(74),xe(70),xe(73),xe(70),xe(0),xe(1),xe(1),xe(0),we(1),we(1),xe(0),xe(0),(function(){we(65499),we(132),xe(0);for(var St=0;St<64;St++)xe(f[St]);xe(1);for(var Jt=0;Jt<64;Jt++)xe(m[Jt])})(),(function(St,Jt){we(65472),we(17),xe(8),we(Jt),we(St),xe(3),xe(1),xe(17),xe(0),xe(2),xe(17),xe(1),xe(3),xe(17),xe(1)})(V.width,V.height),(function(){we(65476),we(418),xe(0);for(var St=0;St<16;St++)xe(ue[St+1]);for(var Jt=0;Jt<=11;Jt++)xe(ae[Jt]);xe(16);for(var mr=0;mr<16;mr++)xe(pe[mr+1]);for(var ar=0;ar<=161;ar++)xe(z[ar]);xe(1);for(var bt=0;bt<16;bt++)xe(J[bt+1]);for(var Yt=0;Yt<=11;Yt++)xe(ge[Yt]);xe(17);for(var vr=0;vr<16;vr++)xe(fe[vr+1]);for(var gr=0;gr<=161;gr++)xe(ke[gr])})(),we(65498),we(12),xe(3),xe(1),xe(0),xe(2),xe(17),xe(3),xe(17),xe(0),xe(63),xe(0);var de=0,X=0,ie=0;L=0,T=7,this.encode.displayName="_encode_";for(var G,q,ve,Fe,Qe,Ge,je,Me,Se,ft=V.data,jt=V.width,It=V.height,ut=4*jt,Rt=0;Rt<It;){for(G=0;G<ut;){for(Qe=ut*Rt+G,je=-1,Me=0,Se=0;Se<64;Se++)Ge=Qe+(Me=Se>>3)*ut+(je=4*(7&Se)),Rt+Me>=It&&(Ge-=ut*(Rt+1+Me-It)),G+je>=ut&&(Ge-=G+je-ut+4),q=ft[Ge++],ve=ft[Ge++],Fe=ft[Ge++],H[Se]=(ee[q]+ee[ve+256|0]+ee[Fe+512|0]>>16)-128,O[Se]=(ee[q+768|0]+ee[ve+1024|0]+ee[Fe+1280|0]>>16)-128,Q[Se]=(ee[q+1280|0]+ee[ve+1536|0]+ee[Fe+1792|0]>>16)-128;de=ye(H,g,de,a,r),X=ye(O,b,X,t,s),ie=ye(Q,b,ie,t,s),G+=32}Rt+=8}if(T>=0){var Ye=[];Ye[1]=T+1,Ye[0]=(1<<T+1)-1,Ne(Ye)}return we(65497),new Uint8Array(_)},n=n||50,(function(){for(var V=String.fromCharCode,le=0;le<256;le++)Z[le]=V(le)})(),a=he(ue,ae),t=he(J,ge),r=he(pe,z),s=he(fe,ke),(function(){for(var V=1,le=2,de=1;de<=15;de++){for(var X=V;X<le;X++)F[32767+X]=de,j[32767+X]=[],j[32767+X][1]=de,j[32767+X][0]=X;for(var ie=-(le-1);ie<=-V;ie++)F[32767+ie]=de,j[32767+ie]=[],j[32767+ie][1]=de,j[32767+ie][0]=le-1+ie;V<<=1,le<<=1}})(),(function(){for(var V=0;V<256;V++)ee[V]=19595*V,ee[V+256|0]=38470*V,ee[V+512|0]=7471*V+32768,ee[V+768|0]=-11059*V,ee[V+1024|0]=-21709*V,ee[V+1280|0]=32768*V+8421375,ee[V+1536|0]=-27439*V,ee[V+1792|0]=-5329*V})(),te(n)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function fd(n,a){if(this.pos=0,this.buffer=n,this.datav=new DataView(n.buffer),this.is_with_alpha=!!a,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function W3(n){function a(ae){if(!ae)throw Error("assert :P")}function t(ae,pe,z){for(var J=0;4>J;J++)if(ae[pe+J]!=z.charCodeAt(J))return!0;return!1}function r(ae,pe,z,J,ge){for(var fe=0;fe<ge;fe++)ae[pe+fe]=z[J+fe]}function s(ae,pe,z,J){for(var ge=0;ge<J;ge++)ae[pe+ge]=z}function e(ae){return new Int32Array(ae)}function u(ae,pe){for(var z=[],J=0;J<ae;J++)z.push(new pe);return z}function f(ae,pe){var z=[];return(function J(ge,fe,ke){for(var he=ke[fe],Ne=0;Ne<he&&(ge.push(ke.length>fe+1?[]:new pe),!(ke.length<fe+1));Ne++)J(ge[Ne],fe+1,ke)})(z,0,ae),z}var m=function(){var ae=this;function pe(B,D){for(var Y=1<<D-1>>>0;B&Y;)Y>>>=1;return Y?(B&Y-1)+Y:B}function z(B,D,Y,oe,Be){a(!(oe%Y));do B[D+(oe-=Y)]=Be;while(0<oe)}function J(B,D,Y,oe,Be){if(a(2328>=Be),512>=Be)var Te=e(512);else if((Te=e(Be))==null)return 0;return(function(Le,Oe,Re,ze,Ze,ht){var He,at,ot=Oe,Dt=1<<Re,ct=e(16),Et=e(16);for(a(Ze!=0),a(ze!=null),a(Le!=null),a(0<Re),at=0;at<Ze;++at){if(15<ze[at])return 0;++ct[ze[at]]}if(ct[0]==Ze)return 0;for(Et[1]=0,He=1;15>He;++He){if(ct[He]>1<<He)return 0;Et[He+1]=Et[He]+ct[He]}for(at=0;at<Ze;++at)He=ze[at],0<ze[at]&&(ht[Et[He]++]=at);if(Et[15]==1)return(ze=new ge).g=0,ze.value=ht[0],z(Le,ot,1,Dt,ze),Dt;var Ut,Xt=-1,Kt=Dt-1,Vr=0,Tr=1,ka=1,zr=1<<Re;for(at=0,He=1,Ze=2;He<=Re;++He,Ze<<=1){if(Tr+=ka<<=1,0>(ka-=ct[He]))return 0;for(;0<ct[He];--ct[He])(ze=new ge).g=He,ze.value=ht[at++],z(Le,ot+Vr,Ze,zr,ze),Vr=pe(Vr,He)}for(He=Re+1,Ze=2;15>=He;++He,Ze<<=1){if(Tr+=ka<<=1,0>(ka-=ct[He]))return 0;for(;0<ct[He];--ct[He]){if(ze=new ge,(Vr&Kt)!=Xt){for(ot+=zr,Ut=1<<(Xt=He)-Re;15>Xt&&!(0>=(Ut-=ct[Xt]));)++Xt,Ut<<=1;Dt+=zr=1<<(Ut=Xt-Re),Le[Oe+(Xt=Vr&Kt)].g=Ut+Re,Le[Oe+Xt].value=ot-Oe-Xt}ze.g=He-Re,ze.value=ht[at++],z(Le,ot+(Vr>>Re),Ze,zr,ze),Vr=pe(Vr,He)}}return Tr!=2*Et[15]-1?0:Dt})(B,D,Y,oe,Be,Te)}function ge(){this.value=this.g=0}function fe(){this.value=this.g=0}function ke(){this.G=u(5,ge),this.H=e(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=u(Pc,fe)}function he(B,D,Y,oe){a(B!=null),a(D!=null),a(2147483648>oe),B.Ca=254,B.I=0,B.b=-8,B.Ka=0,B.oa=D,B.pa=Y,B.Jd=D,B.Yc=Y+oe,B.Zc=4<=oe?Y+oe-4+1:Y,q(B)}function Ne(B,D){for(var Y=0;0<D--;)Y|=Fe(B,128)<<D;return Y}function xe(B,D){var Y=Ne(B,D);return ve(B)?-Y:Y}function we(B,D,Y,oe){var Be,Te=0;for(a(B!=null),a(D!=null),a(4294967288>oe),B.Sb=oe,B.Ra=0,B.u=0,B.h=0,4<oe&&(oe=4),Be=0;Be<oe;++Be)Te+=D[Y+Be]<<8*Be;B.Ra=Te,B.bb=oe,B.oa=D,B.pa=Y}function ye(B){for(;8<=B.u&&B.bb<B.Sb;)B.Ra>>>=8,B.Ra+=B.oa[B.pa+B.bb]<<gn-8>>>0,++B.bb,B.u-=8;X(B)&&(B.h=1,B.u=0)}function te(B,D){if(a(0<=D),!B.h&&D<=pn){var Y=de(B)&wi[D];return B.u+=D,ye(B),Y}return B.h=1,B.u=0}function V(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function le(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function de(B){return B.Ra>>>(B.u&gn-1)>>>0}function X(B){return a(B.bb<=B.Sb),B.h||B.bb==B.Sb&&B.u>gn}function ie(B,D){B.u=D,B.h=X(B)}function G(B){B.u>=Ys&&(a(B.u>=Ys),ye(B))}function q(B){a(B!=null&&B.oa!=null),B.pa<B.Zc?(B.I=(B.oa[B.pa++]|B.I<<8)>>>0,B.b+=8):(a(B!=null&&B.oa!=null),B.pa<B.Yc?(B.b+=8,B.I=B.oa[B.pa++]|B.I<<8):B.Ka?B.b=0:(B.I<<=8,B.b+=8,B.Ka=1))}function ve(B){return Ne(B,1)}function Fe(B,D){var Y=B.Ca;0>B.b&&q(B);var oe=B.b,Be=Y*D>>>8,Te=(B.I>>>oe>Be)+0;for(Te?(Y-=Be,B.I-=Be+1<<oe>>>0):Y=Be+1,oe=Y,Be=0;256<=oe;)Be+=8,oe>>=8;return oe=7^Be+Yl[oe],B.b-=oe,B.Ca=(Y<<oe)-1,Te}function Qe(B,D,Y){B[D+0]=Y>>24&255,B[D+1]=Y>>16&255,B[D+2]=Y>>8&255,B[D+3]=255&Y}function Ge(B,D){return B[D+0]|B[D+1]<<8}function je(B,D){return Ge(B,D)|B[D+2]<<16}function Me(B,D){return Ge(B,D)|Ge(B,D+2)<<16}function Se(B,D){var Y=1<<D;return a(B!=null),a(0<D),B.X=e(Y),B.X==null?0:(B.Mb=32-D,B.Xa=D,1)}function ft(B,D){a(B!=null),a(D!=null),a(B.Xa==D.Xa),r(D.X,0,B.X,0,1<<D.Xa)}function jt(){this.X=[],this.Xa=this.Mb=0}function It(B,D,Y,oe){a(Y!=null),a(oe!=null);var Be=Y[0],Te=oe[0];return Be==0&&(Be=(B*Te+D/2)/D),Te==0&&(Te=(D*Be+B/2)/B),0>=Be||0>=Te?0:(Y[0]=Be,oe[0]=Te,1)}function ut(B,D){return B+(1<<D)-1>>>D}function Rt(B,D){return((4278255360&B)+(4278255360&D)>>>0&4278255360)+((16711935&B)+(16711935&D)>>>0&16711935)>>>0}function Ye(B,D){ae[D]=function(Y,oe,Be,Te,Le,Oe,Re){var ze;for(ze=0;ze<Le;++ze){var Ze=ae[B](Oe[Re+ze-1],Be,Te+ze);Oe[Re+ze]=Rt(Y[oe+ze],Ze)}}}function St(){this.ud=this.hd=this.jd=0}function Jt(B,D){return((4278124286&(B^D))>>>1)+(B&D)>>>0}function mr(B){return 0<=B&&256>B?B:0>B?0:255<B?255:void 0}function ar(B,D){return mr(B+(B-D+.5>>1))}function bt(B,D,Y){return Math.abs(D-Y)-Math.abs(B-Y)}function Yt(B,D,Y,oe,Be,Te,Le){for(oe=Te[Le-1],Y=0;Y<Be;++Y)Te[Le+Y]=oe=Rt(B[D+Y],oe)}function vr(B,D,Y,oe,Be){var Te;for(Te=0;Te<Y;++Te){var Le=B[D+Te],Oe=Le>>8&255,Re=16711935&(Re=(Re=16711935&Le)+((Oe<<16)+Oe));oe[Be+Te]=(4278255360&Le)+Re>>>0}}function gr(B,D){D.jd=255&B,D.hd=B>>8&255,D.ud=B>>16&255}function Mr(B,D,Y,oe,Be,Te){var Le;for(Le=0;Le<oe;++Le){var Oe=D[Y+Le],Re=Oe>>>8,ze=Oe,Ze=255&(Ze=(Ze=Oe>>>16)+((B.jd<<24>>24)*(Re<<24>>24)>>>5));ze=255&(ze=(ze+=(B.hd<<24>>24)*(Re<<24>>24)>>>5)+((B.ud<<24>>24)*(Ze<<24>>24)>>>5)),Be[Te+Le]=(4278255360&Oe)+(Ze<<16)+ze}}function Ot(B,D,Y,oe,Be){ae[D]=function(Te,Le,Oe,Re,ze,Ze,ht,He,at){for(Re=ht;Re<He;++Re)for(ht=0;ht<at;++ht)ze[Ze++]=Be(Oe[oe(Te[Le++])])},ae[B]=function(Te,Le,Oe,Re,ze,Ze,ht){var He=8>>Te.b,at=Te.Ea,ot=Te.K[0],Dt=Te.w;if(8>He)for(Te=(1<<Te.b)-1,Dt=(1<<He)-1;Le<Oe;++Le){var ct,Et=0;for(ct=0;ct<at;++ct)ct&Te||(Et=oe(Re[ze++])),Ze[ht++]=Be(ot[Et&Dt]),Et>>=He}else ae["VP8LMapColor"+Y](Re,ze,ot,Dt,Ze,ht,Le,Oe,at)}}function ja(B,D,Y,oe,Be){for(Y=D+Y;D<Y;){var Te=B[D++];oe[Be++]=Te>>16&255,oe[Be++]=Te>>8&255,oe[Be++]=255&Te}}function oa(B,D,Y,oe,Be){for(Y=D+Y;D<Y;){var Te=B[D++];oe[Be++]=Te>>16&255,oe[Be++]=Te>>8&255,oe[Be++]=255&Te,oe[Be++]=Te>>24&255}}function hr(B,D,Y,oe,Be){for(Y=D+Y;D<Y;){var Te=(Le=B[D++])>>16&240|Le>>12&15,Le=240&Le|Le>>28&15;oe[Be++]=Te,oe[Be++]=Le}}function pr(B,D,Y,oe,Be){for(Y=D+Y;D<Y;){var Te=(Le=B[D++])>>16&248|Le>>13&7,Le=Le>>5&224|Le>>3&31;oe[Be++]=Te,oe[Be++]=Le}}function Gr(B,D,Y,oe,Be){for(Y=D+Y;D<Y;){var Te=B[D++];oe[Be++]=255&Te,oe[Be++]=Te>>8&255,oe[Be++]=Te>>16&255}}function Pr(B,D,Y,oe,Be,Te){if(Te==0)for(Y=D+Y;D<Y;)Qe(oe,((Te=B[D++])[0]>>24|Te[1]>>8&65280|Te[2]<<8&16711680|Te[3]<<24)>>>0),Be+=32;else r(oe,Be,B,D,Y)}function wa(B,D){ae[D][0]=ae[B+"0"],ae[D][1]=ae[B+"1"],ae[D][2]=ae[B+"2"],ae[D][3]=ae[B+"3"],ae[D][4]=ae[B+"4"],ae[D][5]=ae[B+"5"],ae[D][6]=ae[B+"6"],ae[D][7]=ae[B+"7"],ae[D][8]=ae[B+"8"],ae[D][9]=ae[B+"9"],ae[D][10]=ae[B+"10"],ae[D][11]=ae[B+"11"],ae[D][12]=ae[B+"12"],ae[D][13]=ae[B+"13"],ae[D][14]=ae[B+"0"],ae[D][15]=ae[B+"0"]}function jr(B){return B==Ud||B==yu||B==$A||B==mf}function Ms(){this.eb=[],this.size=this.A=this.fb=0}function Rs(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function or(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Ms,this.f.kb=new Rs,this.sd=null}function Nr(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function $t(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Vo(B){return alert("todo:WebPSamplerProcessPlane"),B.T}function Hn(B,D){var Y=B.T,oe=D.ba.f.RGBA,Be=oe.eb,Te=oe.fb+B.ka*oe.A,Le=_i[D.ba.S],Oe=B.y,Re=B.O,ze=B.f,Ze=B.N,ht=B.ea,He=B.W,at=D.cc,ot=D.dc,Dt=D.Mc,ct=D.Nc,Et=B.ka,Ut=B.ka+B.T,Xt=B.U,Kt=Xt+1>>1;for(Et==0?Le(Oe,Re,null,null,ze,Ze,ht,He,ze,Ze,ht,He,Be,Te,null,null,Xt):(Le(D.ec,D.fc,Oe,Re,at,ot,Dt,ct,ze,Ze,ht,He,Be,Te-oe.A,Be,Te,Xt),++Y);Et+2<Ut;Et+=2)at=ze,ot=Ze,Dt=ht,ct=He,Ze+=B.Rc,He+=B.Rc,Te+=2*oe.A,Le(Oe,(Re+=2*B.fa)-B.fa,Oe,Re,at,ot,Dt,ct,ze,Ze,ht,He,Be,Te-oe.A,Be,Te,Xt);return Re+=B.fa,B.j+Ut<B.o?(r(D.ec,D.fc,Oe,Re,Xt),r(D.cc,D.dc,ze,Ze,Kt),r(D.Mc,D.Nc,ht,He,Kt),Y--):1&Ut||Le(Oe,Re,null,null,ze,Ze,ht,He,ze,Ze,ht,He,Be,Te+oe.A,null,null,Xt),Y}function hs(B,D,Y){var oe=B.F,Be=[B.J];if(oe!=null){var Te=B.U,Le=D.ba.S,Oe=Le==YA||Le==$A;D=D.ba.f.RGBA;var Re=[0],ze=B.ka;Re[0]=B.T,B.Kb&&(ze==0?--Re[0]:(--ze,Be[0]-=B.width),B.j+B.ka+B.T==B.o&&(Re[0]=B.o-B.j-ze));var Ze=D.eb;ze=D.fb+ze*D.A,B=VA(oe,Be[0],B.width,Te,Re,Ze,ze+(Oe?0:3),D.A),a(Y==Re),B&&jr(Le)&&So(Ze,ze,Oe,Te,Re,D.A)}return 0}function co(B){var D=B.ma,Y=D.ba.S,oe=11>Y,Be=Y==Ws||Y==rl||Y==YA||Y==WA||Y==12||jr(Y);if(D.memory=null,D.Ib=null,D.Jb=null,D.Nd=null,!Rc(D.Oa,B,Be?11:12))return 0;if(Be&&jr(Y)&&yi(),B.da)alert("todo:use_scaling");else{if(oe){if(D.Ib=Vo,B.Kb){if(Y=B.U+1>>1,D.memory=e(B.U+2*Y),D.memory==null)return 0;D.ec=D.memory,D.fc=0,D.cc=D.ec,D.dc=D.fc+B.U,D.Mc=D.cc,D.Nc=D.dc+Y,D.Ib=Hn,yi()}}else alert("todo:EmitYUV");Be&&(D.Jb=hs,oe&&el())}if(oe&&!Xc){for(B=0;256>B;++B)Ai[B]=89858*(B-128)+XA>>ol,pp[B]=-22014*(B-128)+XA,y0[B]=-45773*(B-128),Nu[B]=113618*(B-128)+XA>>ol;for(B=yA;B<Xi;++B)D=76283*(B-16)+XA>>ol,_h[B-yA]=Sa(D,255),mo[B-yA]=Sa(D+8>>4,15);Xc=1}return 1}function ra(B){var D=B.ma,Y=B.U,oe=B.T;return a(!(1&B.ka)),0>=Y||0>=oe?0:(Y=D.Ib(B,D),D.Jb!=null&&D.Jb(B,D,Y),D.Dc+=Y,1)}function ko(B){B.ma.memory=null}function zi(B,D,Y,oe){return te(B,8)!=47?0:(D[0]=te(B,14)+1,Y[0]=te(B,14)+1,oe[0]=te(B,1),te(B,3)!=0?0:!B.h)}function ms(B,D){if(4>B)return B+1;var Y=B-2>>1;return(2+(1&B)<<Y)+te(D,Y)+1}function pi(B,D){return 120<D?D-120:1<=(Y=((Y=sl[D-1])>>4)*B+(8-(15&Y)))?Y:1;var Y}function en(B,D,Y){var oe=de(Y),Be=B[D+=255&oe].g-8;return 0<Be&&(ie(Y,Y.u+8),oe=de(Y),D+=B[D].value,D+=oe&(1<<Be)-1),ie(Y,Y.u+B[D].g),B[D].value}function Tn(B,D,Y){return Y.g+=B.g,Y.value+=B.value<<D>>>0,a(8>=Y.g),B.g}function _n(B,D,Y){var oe=B.xc;return a((D=oe==0?0:B.vc[B.md*(Y>>oe)+(D>>oe)])<B.Wb),B.Ya[D]}function Yo(B,D,Y,oe){var Be=B.ab,Te=B.c*D,Le=B.C;D=Le+D;var Oe=Y,Re=oe;for(oe=B.Ta,Y=B.Ua;0<Be--;){var ze=B.gc[Be],Ze=Le,ht=D,He=Oe,at=Re,ot=(Re=oe,Oe=Y,ze.Ea);switch(a(Ze<ht),a(ht<=ze.nc),ze.hc){case 2:ys(He,at,(ht-Ze)*ot,Re,Oe);break;case 0:var Dt=Ze,ct=ht,Et=Re,Ut=Oe,Xt=(zr=ze).Ea;Dt==0&&(Td(He,at,null,null,1,Et,Ut),Yt(He,at+1,0,0,Xt-1,Et,Ut+1),at+=Xt,Ut+=Xt,++Dt);for(var Kt=1<<zr.b,Vr=Kt-1,Tr=ut(Xt,zr.b),ka=zr.K,zr=zr.w+(Dt>>zr.b)*Tr;Dt<ct;){var Ka=ka,nn=zr,La=1;for(_d(He,at,Et,Ut-Xt,1,Et,Ut);La<Xt;){var Er=(La&~Vr)+Kt;Er>Xt&&(Er=Xt),(0,mc[Ka[nn++]>>8&15])(He,at+ +La,Et,Ut+La-Xt,Er-La,Et,Ut+La),La=Er}at+=Xt,Ut+=Xt,++Dt&Vr||(zr+=Tr)}ht!=ze.nc&&r(Re,Oe-ot,Re,Oe+(ht-Ze-1)*ot,ot);break;case 1:for(ot=He,ct=at,Xt=(He=ze.Ea)-(Ut=He&~(Et=(at=1<<ze.b)-1)),Dt=ut(He,ze.b),Kt=ze.K,ze=ze.w+(Ze>>ze.b)*Dt;Ze<ht;){for(Vr=Kt,Tr=ze,ka=new St,zr=ct+Ut,Ka=ct+He;ct<zr;)gr(Vr[Tr++],ka),gA(ka,ot,ct,at,Re,Oe),ct+=at,Oe+=at;ct<Ka&&(gr(Vr[Tr++],ka),gA(ka,ot,ct,Xt,Re,Oe),ct+=Xt,Oe+=Xt),++Ze&Et||(ze+=Dt)}break;case 3:if(He==Re&&at==Oe&&0<ze.b){for(ct=Re,He=ot=Oe+(ht-Ze)*ot-(Ut=(ht-Ze)*ut(ze.Ea,ze.b)),at=Re,Et=Oe,Dt=[],Ut=(Xt=Ut)-1;0<=Ut;--Ut)Dt[Ut]=at[Et+Ut];for(Ut=Xt-1;0<=Ut;--Ut)ct[He+Ut]=Dt[Ut];hc(ze,Ze,ht,Re,ot,Re,Oe)}else hc(ze,Ze,ht,He,at,Re,Oe)}Oe=oe,Re=Y}Re!=Y&&r(oe,Y,Oe,Re,Te)}function Si(B,D){var Y=B.V,oe=B.Ba+B.c*B.C,Be=D-B.C;if(a(D<=B.l.o),a(16>=Be),0<Be){var Te=B.l,Le=B.Ta,Oe=B.Ua,Re=Te.width;if(Yo(B,Be,Y,oe),Be=Oe=[Oe],a((Y=B.C)<(oe=D)),a(Te.v<Te.va),oe>Te.o&&(oe=Te.o),Y<Te.j){var ze=Te.j-Y;Y=Te.j,Be[0]+=ze*Re}if(Y>=oe?Y=0:(Be[0]+=4*Te.v,Te.ka=Y-Te.j,Te.U=Te.va-Te.v,Te.T=oe-Y,Y=1),Y){if(Oe=Oe[0],11>(Y=B.ca).S){var Ze=Y.f.RGBA,ht=(oe=Y.S,Be=Te.U,Te=Te.T,ze=Ze.eb,Ze.A),He=Te;for(Ze=Ze.fb+B.Ma*Ze.A;0<He--;){var at=Le,ot=Oe,Dt=Be,ct=ze,Et=Ze;switch(oe){case bu:Hc(at,ot,Dt,ct,Et);break;case Ws:zc(at,ot,Dt,ct,Et);break;case Ud:zc(at,ot,Dt,ct,Et),So(ct,Et,0,Dt,1,0);break;case hf:Kc(at,ot,Dt,ct,Et);break;case rl:Pr(at,ot,Dt,ct,Et,1);break;case yu:Pr(at,ot,Dt,ct,Et,1),So(ct,Et,0,Dt,1,0);break;case YA:Pr(at,ot,Dt,ct,Et,0);break;case $A:Pr(at,ot,Dt,ct,Et,0),So(ct,Et,1,Dt,1,0);break;case WA:Wl(at,ot,Dt,ct,Et);break;case mf:Wl(at,ot,Dt,ct,Et),tl(ct,Et,Dt,1,0);break;case Io:jl(at,ot,Dt,ct,Et);break;default:a(0)}Oe+=Re,Ze+=ht}B.Ma+=Te}else alert("todo:EmitRescaledRowsYUVA");a(B.Ma<=Y.height)}}B.C=D,a(B.C<=B.i)}function Is(B){var D;if(0<B.ua)return 0;for(D=0;D<B.Wb;++D){var Y=B.Ya[D].G,oe=B.Ya[D].H;if(0<Y[1][oe[1]+0].g||0<Y[2][oe[2]+0].g||0<Y[3][oe[3]+0].g)return 0}return 1}function ba(B,D,Y,oe,Be,Te){if(B.Z!=0){var Le=B.qd,Oe=B.rd;for(a(gc[B.Z]!=null);D<Y;++D)gc[B.Z](Le,Oe,oe,Be,oe,Be,Te),Le=oe,Oe=Be,Be+=Te;B.qd=Le,B.rd=Oe}}function Cn(B,D){var Y=B.l.ma,oe=Y.Z==0||Y.Z==1?B.l.j:B.C;if(oe=B.C<oe?oe:B.C,a(D<=B.l.o),D>oe){var Be=B.l.width,Te=Y.ca,Le=Y.tb+Be*oe,Oe=B.V,Re=B.Ba+B.c*oe,ze=B.gc;a(B.ab==1),a(ze[0].hc==3),uo(ze[0],oe,D,Oe,Re,Te,Le),ba(Y,oe,D,Te,Le,Be)}B.C=B.Ma=D}function Oa(B,D,Y,oe,Be,Te,Le){var Oe=B.$/oe,Re=B.$%oe,ze=B.m,Ze=B.s,ht=Y+B.$,He=ht;Be=Y+oe*Be;var at=Y+oe*Te,ot=280+Ze.ua,Dt=B.Pb?Oe:16777216,ct=0<Ze.ua?Ze.Wa:null,Et=Ze.wc,Ut=ht<at?_n(Ze,Re,Oe):null;a(B.C<Te),a(at<=Be);var Xt=!1;e:for(;;){for(;Xt||ht<at;){var Kt=0;if(Oe>=Dt){var Vr=ht-Y;a((Dt=B).Pb),Dt.wd=Dt.m,Dt.xd=Vr,0<Dt.s.ua&&ft(Dt.s.Wa,Dt.s.vb),Dt=Oe+Wc}if(Re&Et||(Ut=_n(Ze,Re,Oe)),a(Ut!=null),Ut.Qb&&(D[ht]=Ut.qb,Xt=!0),!Xt)if(G(ze),Ut.jc){Kt=ze,Vr=D;var Tr=ht,ka=Ut.pd[de(Kt)&Pc-1];a(Ut.jc),256>ka.g?(ie(Kt,Kt.u+ka.g),Vr[Tr]=ka.value,Kt=0):(ie(Kt,Kt.u+ka.g-256),a(256<=ka.value),Kt=ka.value),Kt==0&&(Xt=!0)}else Kt=en(Ut.G[0],Ut.H[0],ze);if(ze.h)break;if(Xt||256>Kt){if(!Xt)if(Ut.nd)D[ht]=(Ut.qb|Kt<<8)>>>0;else{if(G(ze),Xt=en(Ut.G[1],Ut.H[1],ze),G(ze),Vr=en(Ut.G[2],Ut.H[2],ze),Tr=en(Ut.G[3],Ut.H[3],ze),ze.h)break;D[ht]=(Tr<<24|Xt<<16|Kt<<8|Vr)>>>0}if(Xt=!1,++ht,++Re>=oe&&(Re=0,++Oe,Le!=null&&Oe<=Te&&!(Oe%16)&&Le(B,Oe),ct!=null))for(;He<ht;)Kt=D[He++],ct.X[(506832829*Kt&4294967295)>>>ct.Mb]=Kt}else if(280>Kt){if(Kt=ms(Kt-256,ze),Vr=en(Ut.G[4],Ut.H[4],ze),G(ze),Vr=pi(oe,Vr=ms(Vr,ze)),ze.h)break;if(ht-Y<Vr||Be-ht<Kt)break e;for(Tr=0;Tr<Kt;++Tr)D[ht+Tr]=D[ht+Tr-Vr];for(ht+=Kt,Re+=Kt;Re>=oe;)Re-=oe,++Oe,Le!=null&&Oe<=Te&&!(Oe%16)&&Le(B,Oe);if(a(ht<=Be),Re&Et&&(Ut=_n(Ze,Re,Oe)),ct!=null)for(;He<ht;)Kt=D[He++],ct.X[(506832829*Kt&4294967295)>>>ct.Mb]=Kt}else{if(!(Kt<ot))break e;for(Xt=Kt-280,a(ct!=null);He<ht;)Kt=D[He++],ct.X[(506832829*Kt&4294967295)>>>ct.Mb]=Kt;Kt=ht,a(!(Xt>>>(Vr=ct).Xa)),D[Kt]=Vr.X[Xt],Xt=!0}Xt||a(ze.h==X(ze))}if(B.Pb&&ze.h&&ht<Be)a(B.m.h),B.a=5,B.m=B.wd,B.$=B.xd,0<B.s.ua&&ft(B.s.vb,B.s.Wa);else{if(ze.h)break e;Le?.(B,Oe>Te?Te:Oe),B.a=0,B.$=ht-Y}return 1}return B.a=3,0}function ss(B){a(B!=null),B.vc=null,B.yc=null,B.Ya=null;var D=B.Wa;D!=null&&(D.X=null),B.vb=null,a(B!=null)}function gi(){var B=new Qr;return B==null?null:(B.a=0,B.xb=Qo,wa("Predictor","VP8LPredictors"),wa("Predictor","VP8LPredictors_C"),wa("PredictorAdd","VP8LPredictorsAdd"),wa("PredictorAdd","VP8LPredictorsAdd_C"),ys=vr,gA=Mr,Hc=ja,zc=oa,Wl=hr,jl=pr,Kc=Gr,ae.VP8LMapColor32b=Ao,ae.VP8LMapColor8b=$i,B)}function Wo(B,D,Y,oe,Be){var Te=1,Le=[B],Oe=[D],Re=oe.m,ze=oe.s,Ze=null,ht=0;e:for(;;){if(Y)for(;Te&&te(Re,1);){var He=Le,at=Oe,ot=oe,Dt=1,ct=ot.m,Et=ot.gc[ot.ab],Ut=te(ct,2);if(ot.Oc&1<<Ut)Te=0;else{switch(ot.Oc|=1<<Ut,Et.hc=Ut,Et.Ea=He[0],Et.nc=at[0],Et.K=[null],++ot.ab,a(4>=ot.ab),Ut){case 0:case 1:Et.b=te(ct,3)+2,Dt=Wo(ut(Et.Ea,Et.b),ut(Et.nc,Et.b),0,ot,Et.K),Et.K=Et.K[0];break;case 3:var Xt,Kt=te(ct,8)+1,Vr=16<Kt?0:4<Kt?1:2<Kt?2:3;if(He[0]=ut(Et.Ea,Vr),Et.b=Vr,Xt=Dt=Wo(Kt,1,0,ot,Et.K)){var Tr,ka=Kt,zr=Et,Ka=1<<(8>>zr.b),nn=e(Ka);if(nn==null)Xt=0;else{var La=zr.K[0],Er=zr.w;for(nn[0]=zr.K[0][0],Tr=1;Tr<1*ka;++Tr)nn[Tr]=Rt(La[Er+Tr],nn[Tr-1]);for(;Tr<4*Ka;++Tr)nn[Tr]=0;zr.K[0]=null,zr.K[0]=nn,Xt=1}}Dt=Xt;break;case 2:break;default:a(0)}Te=Dt}}if(Le=Le[0],Oe=Oe[0],Te&&te(Re,1)&&!(Te=1<=(ht=te(Re,4))&&11>=ht)){oe.a=3;break e}var xr;if(xr=Te)t:{var on,sa,Ia,ks=oe,di=Le,Li=Oe,qs=ht,Vn=Y,Ji=ks.m,Yn=ks.s,Qa=[null],qa=1,Fn=0,vs=nl[qs];r:for(;;){if(Vn&&te(Ji,1)){var Ni=te(Ji,3)+2,On=ut(di,Ni),gs=ut(Li,Ni),En=On*gs;if(!Wo(On,gs,0,ks,Qa))break r;for(Qa=Qa[0],Yn.xc=Ni,on=0;on<En;++on){var Ds=Qa[on]>>8&65535;Qa[on]=Ds,Ds>=qa&&(qa=Ds+1)}}if(Ji.h)break r;for(sa=0;5>sa;++sa){var Wn=Yc[sa];!sa&&0<qs&&(Wn+=1<<qs),Fn<Wn&&(Fn=Wn)}var ai=u(qa*vs,ge),xs=qa,As=u(xs,ke);if(As==null)var Ui=null;else a(65536>=xs),Ui=As;var bn=e(Fn);if(Ui==null||bn==null||ai==null){ks.a=1;break r}var da=ai;for(on=Ia=0;on<qa;++on){var ia=Ui[on],ts=ia.G,Fo=ia.H,ll=0,po=1,si=0;for(sa=0;5>sa;++sa){Wn=Yc[sa],ts[sa]=da,Fo[sa]=Ia,!sa&&0<qs&&(Wn+=1<<qs);s:{var Zc,eA=Wn,Bu=ks,ln=bn,v0=da,gf=Ia,xf=0,tA=Bu.m,gp=te(tA,1);if(s(ln,0,0,eA),gp){var w0=te(tA,1)+1,N0=te(tA,1),Od=te(tA,N0==0?1:8);ln[Od]=1,w0==2&&(ln[Od=te(tA,8)]=1);var Mi=1}else{var $n=e(19),Su=te(tA,4)+4;if(19<Su){Bu.a=3;var vA=0;break s}for(Zc=0;Zc<Su;++Zc)$n[Id[Zc]]=te(tA,3);var ZA=void 0,ed=void 0,wc=Bu,Fu=$n,Ro=eA,bf=ln,yf=0,Nc=wc.m,vf=8,C0=u(128,ge);a:for(;J(C0,0,7,Fu,19);){if(te(Nc,1)){var wf=2+2*te(Nc,3);if((ZA=2+te(Nc,wf))>Ro)break a}else ZA=Ro;for(ed=0;ed<Ro&&ZA--;){G(Nc);var Eu=C0[0+(127&de(Nc))];ie(Nc,Nc.u+Eu.g);var rA=Eu.value;if(16>rA)bf[ed++]=rA,rA!=0&&(vf=rA);else{var j0=rA==16,B0=rA-16,td=qA[B0],S0=te(Nc,al[B0])+td;if(ed+S0>Ro)break a;for(var Lh=j0?vf:0;0<S0--;)bf[ed++]=Lh}}yf=1;break a}yf||(wc.a=3),Mi=yf}(Mi=Mi&&!tA.h)&&(xf=J(v0,gf,8,ln,eA)),Mi&&xf!=0?vA=xf:(Bu.a=3,vA=0)}if(vA==0)break r;if(po&&Md[sa]==1&&(po=da[Ia].g==0),ll+=da[Ia].g,Ia+=vA,3>=sa){var wA,ku=bn[0];for(wA=1;wA<Wn;++wA)bn[wA]>ku&&(ku=bn[wA]);si+=ku}}if(ia.nd=po,ia.Qb=0,po&&(ia.qb=(ts[3][Fo[3]+0].value<<24|ts[1][Fo[1]+0].value<<16|ts[2][Fo[2]+0].value)>>>0,ll==0&&256>ts[0][Fo[0]+0].value&&(ia.Qb=1,ia.qb+=ts[0][Fo[0]+0].value<<8)),ia.jc=!ia.Qb&&6>si,ia.jc){var NA,Po=ia;for(NA=0;NA<Pc;++NA){var Fl=NA,Cc=Po.pd[Fl],Nf=Po.G[0][Po.H[0]+Fl];256<=Nf.value?(Cc.g=Nf.g+256,Cc.value=Nf.value):(Cc.g=0,Cc.value=0,Fl>>=Tn(Nf,8,Cc),Fl>>=Tn(Po.G[1][Po.H[1]+Fl],16,Cc),Fl>>=Tn(Po.G[2][Po.H[2]+Fl],0,Cc),Tn(Po.G[3][Po.H[3]+Fl],24,Cc))}}}Yn.vc=Qa,Yn.Wb=qa,Yn.Ya=Ui,Yn.yc=ai,xr=1;break t}xr=0}if(!(Te=xr)){oe.a=3;break e}if(0<ht){if(ze.ua=1<<ht,!Se(ze.Wa,ht)){oe.a=1,Te=0;break e}}else ze.ua=0;var Cf=oe,qn=Le,Qd=Oe,jc=Cf.s,aA=jc.xc;if(Cf.c=qn,Cf.i=Qd,jc.md=ut(qn,aA),jc.wc=aA==0?-1:(1<<aA)-1,Y){oe.xb=$s;break e}if((Ze=e(Le*Oe))==null){oe.a=1,Te=0;break e}Te=(Te=Oa(oe,Ze,0,Le,Oe,Oe,null))&&!Re.h;break e}return Te?(Be!=null?Be[0]=Ze:(a(Ze==null),a(Y)),oe.$=0,Y||ss(ze)):ss(ze),Te}function Fi(B,D){var Y=B.c*B.i,oe=Y+D+16*D;return a(B.c<=D),B.V=e(oe),B.V==null?(B.Ta=null,B.Ua=0,B.a=1,0):(B.Ta=B.V,B.Ua=B.Ba+Y+D,1)}function Hl(B,D){var Y=B.C,oe=D-Y,Be=B.V,Te=B.Ba+B.c*Y;for(a(D<=B.l.o);0<oe;){var Le=16<oe?16:oe,Oe=B.l.ma,Re=B.l.width,ze=Re*Le,Ze=Oe.ca,ht=Oe.tb+Re*Y,He=B.Ta,at=B.Ua;Yo(B,Le,Be,Te),fo(He,at,Ze,ht,ze),ba(Oe,Y,Y+Le,Ze,ht,Re),oe-=Le,Be+=Le*B.c,Y+=Le}a(Y==D),B.C=B.Ma=D}function $o(){this.ub=this.yd=this.td=this.Rb=0}function Do(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function zl(){this.Fb=this.Bb=this.Cb=0,this.Zb=e(4),this.Lb=e(4)}function Ln(){this.Yb=(function(){var B=[];return(function D(Y,oe,Be){for(var Te=Be[oe],Le=0;Le<Te&&(Y.push(Be.length>oe+1?[]:0),!(Be.length<oe+1));Le++)D(Y[Le],oe+1,Be)})(B,0,[3,11]),B})()}function hn(){this.jb=e(3),this.Wc=f([4,8],Ln),this.Xc=f([4,17],Ln)}function tt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new e(4),this.od=new e(4)}function zt(){this.ld=this.La=this.dd=this.tc=0}function qt(){this.Na=this.la=0}function Ct(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ar(){this.ad=e(384),this.Za=0,this.Ob=e(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function $r(){this.uc=this.M=this.Nb=0,this.wa=Array(new zt),this.Y=0,this.ya=Array(new Ar),this.aa=0,this.l=new tn}function Ra(){this.y=e(16),this.f=e(8),this.ea=e(8)}function Ba(){this.cb=this.a=0,this.sc="",this.m=new V,this.Od=new $o,this.Kc=new Do,this.ed=new tt,this.Qa=new zl,this.Ic=this.$c=this.Aa=0,this.D=new $r,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=u(8,V),this.ia=0,this.pb=u(4,Ct),this.Pa=new hn,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ra),this.Hd=0,this.rb=Array(new qt),this.sb=0,this.wa=Array(new zt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ar),this.L=this.aa=0,this.gd=f([4,2],zt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function tn(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function ns(){var B=new Ba;return B!=null&&(B.a=0,B.sc="OK",B.cb=0,B.Xb=0,Oo||(Oo=rn)),B}function Pa(B,D,Y){return B.a==0&&(B.a=D,B.sc=Y,B.cb=0),0}function ya(B,D,Y){return 3<=Y&&B[D+0]==157&&B[D+1]==1&&B[D+2]==42}function Cr(B,D){if(B==null)return 0;if(B.a=0,B.sc="OK",D==null)return Pa(B,2,"null VP8Io passed to VP8GetHeaders()");var Y=D.data,oe=D.w,Be=D.ha;if(4>Be)return Pa(B,7,"Truncated header.");var Te=Y[oe+0]|Y[oe+1]<<8|Y[oe+2]<<16,Le=B.Od;if(Le.Rb=!(1&Te),Le.td=Te>>1&7,Le.yd=Te>>4&1,Le.ub=Te>>5,3<Le.td)return Pa(B,3,"Incorrect keyframe parameters.");if(!Le.yd)return Pa(B,4,"Frame not displayable.");oe+=3,Be-=3;var Oe=B.Kc;if(Le.Rb){if(7>Be)return Pa(B,7,"cannot parse picture header");if(!ya(Y,oe,Be))return Pa(B,3,"Bad code word");Oe.c=16383&(Y[oe+4]<<8|Y[oe+3]),Oe.Td=Y[oe+4]>>6,Oe.i=16383&(Y[oe+6]<<8|Y[oe+5]),Oe.Ud=Y[oe+6]>>6,oe+=7,Be-=7,B.za=Oe.c+15>>4,B.Ub=Oe.i+15>>4,D.width=Oe.c,D.height=Oe.i,D.Da=0,D.j=0,D.v=0,D.va=D.width,D.o=D.height,D.da=0,D.ib=D.width,D.hb=D.height,D.U=D.width,D.T=D.height,s((Te=B.Pa).jb,0,255,Te.jb.length),a((Te=B.Qa)!=null),Te.Cb=0,Te.Bb=0,Te.Fb=1,s(Te.Zb,0,0,Te.Zb.length),s(Te.Lb,0,0,Te.Lb)}if(Le.ub>Be)return Pa(B,7,"bad partition length");he(Te=B.m,Y,oe,Le.ub),oe+=Le.ub,Be-=Le.ub,Le.Rb&&(Oe.Ld=ve(Te),Oe.Kd=ve(Te)),Oe=B.Qa;var Re,ze=B.Pa;if(a(Te!=null),a(Oe!=null),Oe.Cb=ve(Te),Oe.Cb){if(Oe.Bb=ve(Te),ve(Te)){for(Oe.Fb=ve(Te),Re=0;4>Re;++Re)Oe.Zb[Re]=ve(Te)?xe(Te,7):0;for(Re=0;4>Re;++Re)Oe.Lb[Re]=ve(Te)?xe(Te,6):0}if(Oe.Bb)for(Re=0;3>Re;++Re)ze.jb[Re]=ve(Te)?Ne(Te,8):255}else Oe.Bb=0;if(Te.Ka)return Pa(B,3,"cannot parse segment header");if((Oe=B.ed).zd=ve(Te),Oe.Tb=Ne(Te,6),Oe.wb=Ne(Te,3),Oe.Pc=ve(Te),Oe.Pc&&ve(Te)){for(ze=0;4>ze;++ze)ve(Te)&&(Oe.vd[ze]=xe(Te,6));for(ze=0;4>ze;++ze)ve(Te)&&(Oe.od[ze]=xe(Te,6))}if(B.L=Oe.Tb==0?0:Oe.zd?1:2,Te.Ka)return Pa(B,3,"cannot parse filter header");var Ze=Be;if(Be=Re=oe,oe=Re+Ze,Oe=Ze,B.Xb=(1<<Ne(B.m,2))-1,Ze<3*(ze=B.Xb))Y=7;else{for(Re+=3*ze,Oe-=3*ze,Ze=0;Ze<ze;++Ze){var ht=Y[Be+0]|Y[Be+1]<<8|Y[Be+2]<<16;ht>Oe&&(ht=Oe),he(B.Jc[+Ze],Y,Re,ht),Re+=ht,Oe-=ht,Be+=3}he(B.Jc[+ze],Y,Re,Oe),Y=Re<oe?0:5}if(Y!=0)return Pa(B,Y,"cannot parse partitions");for(Y=Ne(Re=B.m,7),Be=ve(Re)?xe(Re,4):0,oe=ve(Re)?xe(Re,4):0,Oe=ve(Re)?xe(Re,4):0,ze=ve(Re)?xe(Re,4):0,Re=ve(Re)?xe(Re,4):0,Ze=B.Qa,ht=0;4>ht;++ht){if(Ze.Cb){var He=Ze.Zb[ht];Ze.Fb||(He+=Y)}else{if(0<ht){B.pb[ht]=B.pb[0];continue}He=Y}var at=B.pb[ht];at.Sc[0]=Sl[Sa(He+Be,127)],at.Sc[1]=il[Sa(He+0,127)],at.Eb[0]=2*Sl[Sa(He+oe,127)],at.Eb[1]=101581*il[Sa(He+Oe,127)]>>16,8>at.Eb[1]&&(at.Eb[1]=8),at.Qc[0]=Sl[Sa(He+ze,117)],at.Qc[1]=il[Sa(He+Re,127)],at.lc=He+Re}if(!Le.Rb)return Pa(B,4,"Not a key frame.");for(ve(Te),Le=B.Pa,Y=0;4>Y;++Y){for(Be=0;8>Be;++Be)for(oe=0;3>oe;++oe)for(Oe=0;11>Oe;++Oe)ze=Fe(Te,sn[Y][Be][oe][Oe])?Ne(Te,8):b0[Y][Be][oe][Oe],Le.Wc[Y][Be].Yb[oe][Oe]=ze;for(Be=0;17>Be;++Be)Le.Xc[Y][Be]=Le.Wc[Y][es[Be]]}return B.kc=ve(Te),B.kc&&(B.Bd=Ne(Te,8)),B.cb=1}function rn(B,D,Y,oe,Be,Te,Le){var Oe=D[Be].Yb[Y];for(Y=0;16>Be;++Be){if(!Fe(B,Oe[Y+0]))return Be;for(;!Fe(B,Oe[Y+1]);)if(Oe=D[++Be].Yb[0],Y=0,Be==16)return 16;var Re=D[Be+1].Yb;if(Fe(B,Oe[Y+2])){var ze=B,Ze=0;if(Fe(ze,(He=Oe)[(ht=Y)+3]))if(Fe(ze,He[ht+6])){for(Oe=0,ht=2*(Ze=Fe(ze,He[ht+8]))+(He=Fe(ze,He[ht+9+Ze])),Ze=0,He=vu[ht];He[Oe];++Oe)Ze+=Ze+Fe(ze,He[Oe]);Ze+=3+(8<<ht)}else Fe(ze,He[ht+7])?(Ze=7+2*Fe(ze,165),Ze+=Fe(ze,145)):Ze=5+Fe(ze,159);else Ze=Fe(ze,He[ht+4])?3+Fe(ze,He[ht+5]):2;Oe=Re[2]}else Ze=1,Oe=Re[1];Re=Le+pf[Be],0>(ze=B).b&&q(ze);var ht,He=ze.b,at=(ht=ze.Ca>>1)-(ze.I>>He)>>31;--ze.b,ze.Ca+=at,ze.Ca|=1,ze.I-=(ht+1&at)<<He,Te[Re]=((Ze^at)-at)*oe[(0<Be)+0]}return 16}function jo(B){var D=B.rb[B.sb-1];D.la=0,D.Na=0,s(B.zc,0,0,B.zc.length),B.ja=0}function xi(B,D,Y,oe,Be){Be=B[D+Y+32*oe]+(Be>>3),B[D+Y+32*oe]=-256&Be?0>Be?0:255:Be}function Ki(B,D,Y,oe,Be,Te){xi(B,D,0,Y,oe+Be),xi(B,D,1,Y,oe+Te),xi(B,D,2,Y,oe-Te),xi(B,D,3,Y,oe-Be)}function Gs(B){return(20091*B>>16)+B}function ma(B,D,Y,oe){var Be,Te=0,Le=e(16);for(Be=0;4>Be;++Be){var Oe=B[D+0]+B[D+8],Re=B[D+0]-B[D+8],ze=(35468*B[D+4]>>16)-Gs(B[D+12]),Ze=Gs(B[D+4])+(35468*B[D+12]>>16);Le[Te+0]=Oe+Ze,Le[Te+1]=Re+ze,Le[Te+2]=Re-ze,Le[Te+3]=Oe-Ze,Te+=4,D++}for(Be=Te=0;4>Be;++Be)Oe=(B=Le[Te+0]+4)+Le[Te+8],Re=B-Le[Te+8],ze=(35468*Le[Te+4]>>16)-Gs(Le[Te+12]),xi(Y,oe,0,0,Oe+(Ze=Gs(Le[Te+4])+(35468*Le[Te+12]>>16))),xi(Y,oe,1,0,Re+ze),xi(Y,oe,2,0,Re-ze),xi(Y,oe,3,0,Oe-Ze),Te++,oe+=32}function qo(B,D,Y,oe){var Be=B[D+0]+4,Te=35468*B[D+4]>>16,Le=Gs(B[D+4]),Oe=35468*B[D+1]>>16;Ki(Y,oe,0,Be+Le,B=Gs(B[D+1]),Oe),Ki(Y,oe,1,Be+Te,B,Oe),Ki(Y,oe,2,Be-Te,B,Oe),Ki(Y,oe,3,Be-Le,B,Oe)}function oc(B,D,Y,oe,Be){ma(B,D,Y,oe),Be&&ma(B,D+16,Y,oe+4)}function Va(B,D,Y,oe){pc(B,D+0,Y,oe,1),pc(B,D+32,Y,oe+128,1)}function li(B,D,Y,oe){var Be;for(B=B[D+0]+4,Be=0;4>Be;++Be)for(D=0;4>D;++D)xi(Y,oe,D,Be,B)}function Fs(B,D,Y,oe){B[D+0]&&Ea(B,D+0,Y,oe),B[D+16]&&Ea(B,D+16,Y,oe+4),B[D+32]&&Ea(B,D+32,Y,oe+128),B[D+48]&&Ea(B,D+48,Y,oe+128+4)}function Gi(B,D,Y,oe){var Be,Te=e(16);for(Be=0;4>Be;++Be){var Le=B[D+0+Be]+B[D+12+Be],Oe=B[D+4+Be]+B[D+8+Be],Re=B[D+4+Be]-B[D+8+Be],ze=B[D+0+Be]-B[D+12+Be];Te[0+Be]=Le+Oe,Te[8+Be]=Le-Oe,Te[4+Be]=ze+Re,Te[12+Be]=ze-Re}for(Be=0;4>Be;++Be)Le=(B=Te[0+4*Be]+3)+Te[3+4*Be],Oe=Te[1+4*Be]+Te[2+4*Be],Re=Te[1+4*Be]-Te[2+4*Be],ze=B-Te[3+4*Be],Y[oe+0]=Le+Oe>>3,Y[oe+16]=ze+Re>>3,Y[oe+32]=Le-Oe>>3,Y[oe+48]=ze-Re>>3,oe+=64}function Vi(B,D,Y){var oe,Be=D-32,Te=ho,Le=255-B[Be-1];for(oe=0;oe<Y;++oe){var Oe,Re=Te,ze=Le+B[D-1];for(Oe=0;Oe<Y;++Oe)B[D+Oe]=Re[ze+B[Be+Oe]];D+=32}}function ls(B,D){Vi(B,D,4)}function jn(B,D){Vi(B,D,8)}function Ps(B,D){Vi(B,D,16)}function HA(B,D){var Y;for(Y=0;16>Y;++Y)r(B,D+32*Y,B,D-32,16)}function kd(B,D){var Y;for(Y=16;0<Y;--Y)s(B,D,B[D-1],16),D+=32}function hA(B,D,Y){var oe;for(oe=0;16>oe;++oe)s(D,Y+32*oe,B,16)}function Xo(B,D){var Y,oe=16;for(Y=0;16>Y;++Y)oe+=B[D-1+32*Y]+B[D+Y-32];hA(oe>>5,B,D)}function To(B,D){var Y,oe=8;for(Y=0;16>Y;++Y)oe+=B[D-1+32*Y];hA(oe>>4,B,D)}function yl(B,D){var Y,oe=8;for(Y=0;16>Y;++Y)oe+=B[D+Y-32];hA(oe>>4,B,D)}function cs(B,D){hA(128,B,D)}function aa(B,D,Y){return B+2*D+Y+2>>2}function vl(B,D){var Y,oe=D-32;for(oe=new Uint8Array([aa(B[oe-1],B[oe+0],B[oe+1]),aa(B[oe+0],B[oe+1],B[oe+2]),aa(B[oe+1],B[oe+2],B[oe+3]),aa(B[oe+2],B[oe+3],B[oe+4])]),Y=0;4>Y;++Y)r(B,D+32*Y,oe,0,oe.length)}function mu(B,D){var Y=B[D-1],oe=B[D-1+32],Be=B[D-1+64],Te=B[D-1+96];Qe(B,D+0,16843009*aa(B[D-1-32],Y,oe)),Qe(B,D+32,16843009*aa(Y,oe,Be)),Qe(B,D+64,16843009*aa(oe,Be,Te)),Qe(B,D+96,16843009*aa(Be,Te,Te))}function pu(B,D){var Y,oe=4;for(Y=0;4>Y;++Y)oe+=B[D+Y-32]+B[D-1+32*Y];for(oe>>=3,Y=0;4>Y;++Y)s(B,D+32*Y,oe,4)}function df(B,D){var Y=B[D-1+0],oe=B[D-1+32],Be=B[D-1+64],Te=B[D-1-32],Le=B[D+0-32],Oe=B[D+1-32],Re=B[D+2-32],ze=B[D+3-32];B[D+0+96]=aa(oe,Be,B[D-1+96]),B[D+1+96]=B[D+0+64]=aa(Y,oe,Be),B[D+2+96]=B[D+1+64]=B[D+0+32]=aa(Te,Y,oe),B[D+3+96]=B[D+2+64]=B[D+1+32]=B[D+0+0]=aa(Le,Te,Y),B[D+3+64]=B[D+2+32]=B[D+1+0]=aa(Oe,Le,Te),B[D+3+32]=B[D+2+0]=aa(Re,Oe,Le),B[D+3+0]=aa(ze,Re,Oe)}function Jo(B,D){var Y=B[D+1-32],oe=B[D+2-32],Be=B[D+3-32],Te=B[D+4-32],Le=B[D+5-32],Oe=B[D+6-32],Re=B[D+7-32];B[D+0+0]=aa(B[D+0-32],Y,oe),B[D+1+0]=B[D+0+32]=aa(Y,oe,Be),B[D+2+0]=B[D+1+32]=B[D+0+64]=aa(oe,Be,Te),B[D+3+0]=B[D+2+32]=B[D+1+64]=B[D+0+96]=aa(Be,Te,Le),B[D+3+32]=B[D+2+64]=B[D+1+96]=aa(Te,Le,Oe),B[D+3+64]=B[D+2+96]=aa(Le,Oe,Re),B[D+3+96]=aa(Oe,Re,Re)}function Ei(B,D){var Y=B[D-1+0],oe=B[D-1+32],Be=B[D-1+64],Te=B[D-1-32],Le=B[D+0-32],Oe=B[D+1-32],Re=B[D+2-32],ze=B[D+3-32];B[D+0+0]=B[D+1+64]=Te+Le+1>>1,B[D+1+0]=B[D+2+64]=Le+Oe+1>>1,B[D+2+0]=B[D+3+64]=Oe+Re+1>>1,B[D+3+0]=Re+ze+1>>1,B[D+0+96]=aa(Be,oe,Y),B[D+0+64]=aa(oe,Y,Te),B[D+0+32]=B[D+1+96]=aa(Y,Te,Le),B[D+1+32]=B[D+2+96]=aa(Te,Le,Oe),B[D+2+32]=B[D+3+96]=aa(Le,Oe,Re),B[D+3+32]=aa(Oe,Re,ze)}function Dd(B,D){var Y=B[D+0-32],oe=B[D+1-32],Be=B[D+2-32],Te=B[D+3-32],Le=B[D+4-32],Oe=B[D+5-32],Re=B[D+6-32],ze=B[D+7-32];B[D+0+0]=Y+oe+1>>1,B[D+1+0]=B[D+0+64]=oe+Be+1>>1,B[D+2+0]=B[D+1+64]=Be+Te+1>>1,B[D+3+0]=B[D+2+64]=Te+Le+1>>1,B[D+0+32]=aa(Y,oe,Be),B[D+1+32]=B[D+0+96]=aa(oe,Be,Te),B[D+2+32]=B[D+1+96]=aa(Be,Te,Le),B[D+3+32]=B[D+2+96]=aa(Te,Le,Oe),B[D+3+64]=aa(Le,Oe,Re),B[D+3+96]=aa(Oe,Re,ze)}function Un(B,D){var Y=B[D-1+0],oe=B[D-1+32],Be=B[D-1+64],Te=B[D-1+96];B[D+0+0]=Y+oe+1>>1,B[D+2+0]=B[D+0+32]=oe+Be+1>>1,B[D+2+32]=B[D+0+64]=Be+Te+1>>1,B[D+1+0]=aa(Y,oe,Be),B[D+3+0]=B[D+1+32]=aa(oe,Be,Te),B[D+3+32]=B[D+1+64]=aa(Be,Te,Te),B[D+3+64]=B[D+2+64]=B[D+0+96]=B[D+1+96]=B[D+2+96]=B[D+3+96]=Te}function Yi(B,D){var Y=B[D-1+0],oe=B[D-1+32],Be=B[D-1+64],Te=B[D-1+96],Le=B[D-1-32],Oe=B[D+0-32],Re=B[D+1-32],ze=B[D+2-32];B[D+0+0]=B[D+2+32]=Y+Le+1>>1,B[D+0+32]=B[D+2+64]=oe+Y+1>>1,B[D+0+64]=B[D+2+96]=Be+oe+1>>1,B[D+0+96]=Te+Be+1>>1,B[D+3+0]=aa(Oe,Re,ze),B[D+2+0]=aa(Le,Oe,Re),B[D+1+0]=B[D+3+32]=aa(Y,Le,Oe),B[D+1+32]=B[D+3+64]=aa(oe,Y,Le),B[D+1+64]=B[D+3+96]=aa(Be,oe,Y),B[D+1+96]=aa(Te,Be,oe)}function lr(B,D){var Y;for(Y=0;8>Y;++Y)r(B,D+32*Y,B,D-32,8)}function wl(B,D){var Y;for(Y=0;8>Y;++Y)s(B,D,B[D-1],8),D+=32}function Mc(B,D,Y){var oe;for(oe=0;8>oe;++oe)s(D,Y+32*oe,B,8)}function Zo(B,D){var Y,oe=8;for(Y=0;8>Y;++Y)oe+=B[D+Y-32]+B[D-1+32*Y];Mc(oe>>4,B,D)}function Bn(B,D){var Y,oe=4;for(Y=0;8>Y;++Y)oe+=B[D+Y-32];Mc(oe>>3,B,D)}function Nl(B,D){var Y,oe=4;for(Y=0;8>Y;++Y)oe+=B[D-1+32*Y];Mc(oe>>3,B,D)}function Ts(B,D){Mc(128,B,D)}function _o(B,D,Y){var oe=B[D-Y],Be=B[D+0],Te=3*(Be-oe)+Mo[1020+B[D-2*Y]-B[D+Y]],Le=ps[112+(Te+4>>3)];B[D-Y]=ho[255+oe+ps[112+(Te+3>>3)]],B[D+0]=ho[255+Be-Le]}function Kl(B,D,Y,oe){var Be=B[D+0],Te=B[D+Y];return Di[255+B[D-2*Y]-B[D-Y]]>oe||Di[255+Te-Be]>oe}function lc(B,D,Y,oe){return 4*Di[255+B[D-Y]-B[D+0]]+Di[255+B[D-2*Y]-B[D+Y]]<=oe}function zA(B,D,Y,oe,Be){var Te=B[D-3*Y],Le=B[D-2*Y],Oe=B[D-Y],Re=B[D+0],ze=B[D+Y],Ze=B[D+2*Y],ht=B[D+3*Y];return 4*Di[255+Oe-Re]+Di[255+Le-ze]>oe?0:Di[255+B[D-4*Y]-Te]<=Be&&Di[255+Te-Le]<=Be&&Di[255+Le-Oe]<=Be&&Di[255+ht-Ze]<=Be&&Di[255+Ze-ze]<=Be&&Di[255+ze-Re]<=Be}function mA(B,D,Y,oe){var Be=2*oe+1;for(oe=0;16>oe;++oe)lc(B,D+oe,Y,Be)&&_o(B,D+oe,Y)}function cc(B,D,Y,oe){var Be=2*oe+1;for(oe=0;16>oe;++oe)lc(B,D+oe*Y,1,Be)&&_o(B,D+oe*Y,1)}function Ic(B,D,Y,oe){var Be;for(Be=3;0<Be;--Be)mA(B,D+=4*Y,Y,oe)}function pA(B,D,Y,oe){var Be;for(Be=3;0<Be;--Be)cc(B,D+=4,Y,oe)}function Gl(B,D,Y,oe,Be,Te,Le,Oe){for(Te=2*Te+1;0<Be--;){if(zA(B,D,Y,Te,Le))if(Kl(B,D,Y,Oe))_o(B,D,Y);else{var Re=B,ze=D,Ze=Y,ht=Re[ze-2*Ze],He=Re[ze-Ze],at=Re[ze+0],ot=Re[ze+Ze],Dt=Re[ze+2*Ze],ct=27*(Ut=Mo[1020+3*(at-He)+Mo[1020+ht-ot]])+63>>7,Et=18*Ut+63>>7,Ut=9*Ut+63>>7;Re[ze-3*Ze]=ho[255+Re[ze-3*Ze]+Ut],Re[ze-2*Ze]=ho[255+ht+Et],Re[ze-Ze]=ho[255+He+ct],Re[ze+0]=ho[255+at-ct],Re[ze+Ze]=ho[255+ot-Et],Re[ze+2*Ze]=ho[255+Dt-Ut]}D+=oe}}function Ac(B,D,Y,oe,Be,Te,Le,Oe){for(Te=2*Te+1;0<Be--;){if(zA(B,D,Y,Te,Le))if(Kl(B,D,Y,Oe))_o(B,D,Y);else{var Re=B,ze=D,Ze=Y,ht=Re[ze-Ze],He=Re[ze+0],at=Re[ze+Ze],ot=ps[112+(4+(Dt=3*(He-ht))>>3)],Dt=ps[112+(Dt+3>>3)],ct=ot+1>>1;Re[ze-2*Ze]=ho[255+Re[ze-2*Ze]+ct],Re[ze-Ze]=ho[255+ht+Dt],Re[ze+0]=ho[255+He-ot],Re[ze+Ze]=ho[255+at-ct]}D+=oe}}function gu(B,D,Y,oe,Be,Te){Gl(B,D,Y,1,16,oe,Be,Te)}function KA(B,D,Y,oe,Be,Te){Gl(B,D,1,Y,16,oe,Be,Te)}function dc(B,D,Y,oe,Be,Te){var Le;for(Le=3;0<Le;--Le)Ac(B,D+=4*Y,Y,1,16,oe,Be,Te)}function Oc(B,D,Y,oe,Be,Te){var Le;for(Le=3;0<Le;--Le)Ac(B,D+=4,1,Y,16,oe,Be,Te)}function R(B,D,Y,oe,Be,Te,Le,Oe){Gl(B,D,Be,1,8,Te,Le,Oe),Gl(Y,oe,Be,1,8,Te,Le,Oe)}function Ce(B,D,Y,oe,Be,Te,Le,Oe){Gl(B,D,1,Be,8,Te,Le,Oe),Gl(Y,oe,1,Be,8,Te,Le,Oe)}function Ke(B,D,Y,oe,Be,Te,Le,Oe){Ac(B,D+4*Be,Be,1,8,Te,Le,Oe),Ac(Y,oe+4*Be,Be,1,8,Te,Le,Oe)}function Xe(B,D,Y,oe,Be,Te,Le,Oe){Ac(B,D+4,1,Be,8,Te,Le,Oe),Ac(Y,oe+4,1,Be,8,Te,Le,Oe)}function nt(){this.ba=new or,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new $t,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Lt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Gt(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Ir(){this.ua=0,this.Wa=new jt,this.vb=new jt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ke,this.yc=new ge}function Qr(){this.xb=this.a=0,this.l=new tn,this.ca=new or,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new le,this.Pb=0,this.wd=new le,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Ir,this.ab=0,this.gc=u(4,Gt),this.Oc=0}function va(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new tn,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Xr(B,D,Y,oe,Be,Te,Le){for(B=B==null?0:B[D+0],D=0;D<Le;++D)Be[Te+D]=B+Y[oe+D]&255,B=Be[Te+D]}function $a(B,D,Y,oe,Be,Te,Le){var Oe;if(B==null)Xr(null,null,Y,oe,Be,Te,Le);else for(Oe=0;Oe<Le;++Oe)Be[Te+Oe]=B[D+Oe]+Y[oe+Oe]&255}function Mn(B,D,Y,oe,Be,Te,Le){if(B==null)Xr(null,null,Y,oe,Be,Te,Le);else{var Oe,Re=B[D+0],ze=Re,Ze=Re;for(Oe=0;Oe<Le;++Oe)ze=Ze+(Re=B[D+Oe])-ze,Ze=Y[oe+Oe]+(-256&ze?0>ze?0:255:ze)&255,ze=Re,Be[Te+Oe]=Ze}}function mn(B,D,Y,oe){var Be=D.width,Te=D.o;if(a(B!=null&&D!=null),0>Y||0>=oe||Y+oe>Te)return null;if(!B.Cc){if(B.ga==null){var Le;if(B.ga=new va,(Le=B.ga==null)||(Le=D.width*D.o,a(B.Gb.length==0),B.Gb=e(Le),B.Uc=0,B.Gb==null?Le=0:(B.mb=B.Gb,B.nb=B.Uc,B.rc=null,Le=1),Le=!Le),!Le){Le=B.ga;var Oe=B.Fa,Re=B.P,ze=B.qc,Ze=B.mb,ht=B.nb,He=Re+1,at=ze-1,ot=Le.l;if(a(Oe!=null&&Ze!=null&&D!=null),gc[0]=null,gc[1]=Xr,gc[2]=$a,gc[3]=Mn,Le.ca=Ze,Le.tb=ht,Le.c=D.width,Le.i=D.height,a(0<Le.c&&0<Le.i),1>=ze)D=0;else if(Le.$a=3&Oe[Re+0],Le.Z=Oe[Re+0]>>2&3,Le.Lc=Oe[Re+0]>>4&3,Re=Oe[Re+0]>>6&3,0>Le.$a||1<Le.$a||4<=Le.Z||1<Le.Lc||Re)D=0;else if(ot.put=ra,ot.ac=co,ot.bc=ko,ot.ma=Le,ot.width=D.width,ot.height=D.height,ot.Da=D.Da,ot.v=D.v,ot.va=D.va,ot.j=D.j,ot.o=D.o,Le.$a)e:{a(Le.$a==1),D=gi();t:for(;;){if(D==null){D=0;break e}if(a(Le!=null),Le.mc=D,D.c=Le.c,D.i=Le.i,D.l=Le.l,D.l.ma=Le,D.l.width=Le.c,D.l.height=Le.i,D.a=0,we(D.m,Oe,He,at),!Wo(Le.c,Le.i,1,D,null)||(D.ab==1&&D.gc[0].hc==3&&Is(D.s)?(Le.ic=1,Oe=D.c*D.i,D.Ta=null,D.Ua=0,D.V=e(Oe),D.Ba=0,D.V==null?(D.a=1,D=0):D=1):(Le.ic=0,D=Fi(D,Le.c)),!D))break t;D=1;break e}Le.mc=null,D=0}else D=at>=Le.c*Le.i;Le=!D}if(Le)return null;B.ga.Lc!=1?B.Ga=0:oe=Te-Y}a(B.ga!=null),a(Y+oe<=Te);e:{if(D=(Oe=B.ga).c,Te=Oe.l.o,Oe.$a==0){if(He=B.rc,at=B.Vc,ot=B.Fa,Re=B.P+1+Y*D,ze=B.mb,Ze=B.nb+Y*D,a(Re<=B.P+B.qc),Oe.Z!=0)for(a(gc[Oe.Z]!=null),Le=0;Le<oe;++Le)gc[Oe.Z](He,at,ot,Re,ze,Ze,D),He=ze,at=Ze,Ze+=D,Re+=D;else for(Le=0;Le<oe;++Le)r(ze,Ze,ot,Re,D),He=ze,at=Ze,Ze+=D,Re+=D;B.rc=He,B.Vc=at}else{if(a(Oe.mc!=null),D=Y+oe,a((Le=Oe.mc)!=null),a(D<=Le.i),Le.C>=D)D=1;else if(Oe.ic||el(),Oe.ic){Oe=Le.V,He=Le.Ba,at=Le.c;var Dt=Le.i,ct=(ot=1,Re=Le.$/at,ze=Le.$%at,Ze=Le.m,ht=Le.s,Le.$),Et=at*Dt,Ut=at*D,Xt=ht.wc,Kt=ct<Ut?_n(ht,ze,Re):null;a(ct<=Et),a(D<=Dt),a(Is(ht));t:for(;;){for(;!Ze.h&&ct<Ut;){if(ze&Xt||(Kt=_n(ht,ze,Re)),a(Kt!=null),G(Ze),256>(Dt=en(Kt.G[0],Kt.H[0],Ze)))Oe[He+ct]=Dt,++ct,++ze>=at&&(ze=0,++Re<=D&&!(Re%16)&&Cn(Le,Re));else{if(!(280>Dt)){ot=0;break t}Dt=ms(Dt-256,Ze);var Vr,Tr=en(Kt.G[4],Kt.H[4],Ze);if(G(Ze),!(ct>=(Tr=pi(at,Tr=ms(Tr,Ze)))&&Et-ct>=Dt)){ot=0;break t}for(Vr=0;Vr<Dt;++Vr)Oe[He+ct+Vr]=Oe[He+ct+Vr-Tr];for(ct+=Dt,ze+=Dt;ze>=at;)ze-=at,++Re<=D&&!(Re%16)&&Cn(Le,Re);ct<Ut&&ze&Xt&&(Kt=_n(ht,ze,Re))}a(Ze.h==X(Ze))}Cn(Le,Re>D?D:Re);break t}!ot||Ze.h&&ct<Et?(ot=0,Le.a=Ze.h?5:3):Le.$=ct,D=ot}else D=Oa(Le,Le.V,Le.Ba,Le.c,Le.i,D,Hl);if(!D){oe=0;break e}}Y+oe>=Te&&(B.Cc=1),oe=1}if(!oe)return null;if(B.Cc&&((oe=B.ga)!=null&&(oe.mc=null),B.ga=null,0<B.Ga))return alert("todo:WebPDequantizeLevels"),null}return B.nb+Y*Be}function an(B,D,Y,oe,Be,Te){for(;0<Be--;){var Le,Oe=B,Re=D+(Y?1:0),ze=B,Ze=D+(Y?0:3);for(Le=0;Le<oe;++Le){var ht=ze[Ze+4*Le];ht!=255&&(ht*=32897,Oe[Re+4*Le+0]=Oe[Re+4*Le+0]*ht>>23,Oe[Re+4*Le+1]=Oe[Re+4*Le+1]*ht>>23,Oe[Re+4*Le+2]=Oe[Re+4*Le+2]*ht>>23)}D+=Te}}function bi(B,D,Y,oe,Be){for(;0<oe--;){var Te;for(Te=0;Te<Y;++Te){var Le=B[D+2*Te+0],Oe=15&(ze=B[D+2*Te+1]),Re=4369*Oe,ze=(240&ze|ze>>4)*Re>>16;B[D+2*Te+0]=(240&Le|Le>>4)*Re>>16&240|(15&Le|Le<<4)*Re>>16>>4&15,B[D+2*Te+1]=240&ze|Oe}D+=Be}}function ci(B,D,Y,oe,Be,Te,Le,Oe){var Re,ze,Ze=255;for(ze=0;ze<Be;++ze){for(Re=0;Re<oe;++Re){var ht=B[D+Re];Te[Le+4*Re]=ht,Ze&=ht}D+=Y,Le+=Oe}return Ze!=255}function Wi(B,D,Y,oe,Be){var Te;for(Te=0;Te<Be;++Te)Y[oe+Te]=B[D+Te]>>8}function el(){So=an,tl=bi,VA=ci,fo=Wi}function _s(B,D,Y){ae[B]=function(oe,Be,Te,Le,Oe,Re,ze,Ze,ht,He,at,ot,Dt,ct,Et,Ut,Xt){var Kt,Vr=Xt-1>>1,Tr=Oe[Re+0]|ze[Ze+0]<<16,ka=ht[He+0]|at[ot+0]<<16;a(oe!=null);var zr=3*Tr+ka+131074>>2;for(D(oe[Be+0],255&zr,zr>>16,Dt,ct),Te!=null&&(zr=3*ka+Tr+131074>>2,D(Te[Le+0],255&zr,zr>>16,Et,Ut)),Kt=1;Kt<=Vr;++Kt){var Ka=Oe[Re+Kt]|ze[Ze+Kt]<<16,nn=ht[He+Kt]|at[ot+Kt]<<16,La=Tr+Ka+ka+nn+524296,Er=La+2*(Ka+ka)>>3;zr=Er+Tr>>1,Tr=(La=La+2*(Tr+nn)>>3)+Ka>>1,D(oe[Be+2*Kt-1],255&zr,zr>>16,Dt,ct+(2*Kt-1)*Y),D(oe[Be+2*Kt-0],255&Tr,Tr>>16,Dt,ct+(2*Kt-0)*Y),Te!=null&&(zr=La+ka>>1,Tr=Er+nn>>1,D(Te[Le+2*Kt-1],255&zr,zr>>16,Et,Ut+(2*Kt-1)*Y),D(Te[Le+2*Kt+0],255&Tr,Tr>>16,Et,Ut+(2*Kt+0)*Y)),Tr=Ka,ka=nn}1&Xt||(zr=3*Tr+ka+131074>>2,D(oe[Be+Xt-1],255&zr,zr>>16,Dt,ct+(Xt-1)*Y),Te!=null&&(zr=3*ka+Tr+131074>>2,D(Te[Le+Xt-1],255&zr,zr>>16,Et,Ut+(Xt-1)*Y)))}}function yi(){_i[bu]=$l,_i[Ws]=xc,_i[hf]=$c,_i[rl]=bc,_i[YA]=qc,_i[WA]=yc,_i[Io]=ql,_i[Ud]=xc,_i[yu]=bc,_i[$A]=qc,_i[mf]=yc}function Ft(B){return B&-16384?0>B?0:255:B>>vc}function Bo(B,D){return Ft((19077*B>>8)+(26149*D>>8)-14234)}function In(B,D,Y){return Ft((19077*B>>8)-(6419*D>>8)-(13320*Y>>8)+8708)}function Pt(B,D){return Ft((19077*B>>8)+(33050*D>>8)-17685)}function Vl(B,D,Y,oe,Be){oe[Be+0]=Bo(B,Y),oe[Be+1]=In(B,D,Y),oe[Be+2]=Pt(B,D)}function Qc(B,D,Y,oe,Be){oe[Be+0]=Pt(B,D),oe[Be+1]=In(B,D,Y),oe[Be+2]=Bo(B,Y)}function ti(B,D,Y,oe,Be){var Te=In(B,D,Y);D=Te<<3&224|Pt(B,D)>>3,oe[Be+0]=248&Bo(B,Y)|Te>>5,oe[Be+1]=D}function uc(B,D,Y,oe,Be){var Te=240&Pt(B,D)|15;oe[Be+0]=240&Bo(B,Y)|In(B,D,Y)>>4,oe[Be+1]=Te}function fc(B,D,Y,oe,Be){oe[Be+0]=255,Vl(B,D,Y,oe,Be+1)}function Vs(B,D,Y,oe,Be){Qc(B,D,Y,oe,Be),oe[Be+3]=255}function Cl(B,D,Y,oe,Be){Vl(B,D,Y,oe,Be),oe[Be+3]=255}function Sa(B,D){return 0>B?0:B>D?D:B}function Es(B,D,Y){ae[B]=function(oe,Be,Te,Le,Oe,Re,ze,Ze,ht){for(var He=Ze+(-2&ht)*Y;Ze!=He;)D(oe[Be+0],Te[Le+0],Oe[Re+0],ze,Ze),D(oe[Be+1],Te[Le+0],Oe[Re+0],ze,Ze+Y),Be+=2,++Le,++Re,Ze+=2*Y;1&ht&&D(oe[Be+0],Te[Le+0],Oe[Re+0],ze,Ze)}}function ha(B,D,Y){return Y==0?B==0?D==0?6:5:D==0?4:0:Y}function vi(B,D,Y,oe,Be){switch(B>>>30){case 3:pc(D,Y,oe,Be,0);break;case 2:zn(D,Y,oe,Be);break;case 1:Ea(D,Y,oe,Be)}}function fa(B,D){var Y,oe,Be=D.M,Te=D.Nb,Le=B.oc,Oe=B.pc+40,Re=B.oc,ze=B.pc+584,Ze=B.oc,ht=B.pc+600;for(Y=0;16>Y;++Y)Le[Oe+32*Y-1]=129;for(Y=0;8>Y;++Y)Re[ze+32*Y-1]=129,Ze[ht+32*Y-1]=129;for(0<Be?Le[Oe-1-32]=Re[ze-1-32]=Ze[ht-1-32]=129:(s(Le,Oe-32-1,127,21),s(Re,ze-32-1,127,9),s(Ze,ht-32-1,127,9)),oe=0;oe<B.za;++oe){var He=D.ya[D.aa+oe];if(0<oe){for(Y=-1;16>Y;++Y)r(Le,Oe+32*Y-4,Le,Oe+32*Y+12,4);for(Y=-1;8>Y;++Y)r(Re,ze+32*Y-4,Re,ze+32*Y+4,4),r(Ze,ht+32*Y-4,Ze,ht+32*Y+4,4)}var at=B.Gd,ot=B.Hd+oe,Dt=He.ad,ct=He.Hc;if(0<Be&&(r(Le,Oe-32,at[ot].y,0,16),r(Re,ze-32,at[ot].f,0,8),r(Ze,ht-32,at[ot].ea,0,8)),He.Za){var Et=Le,Ut=Oe-32+16;for(0<Be&&(oe>=B.za-1?s(Et,Ut,at[ot].y[15],4):r(Et,Ut,at[ot+1].y,0,4)),Y=0;4>Y;Y++)Et[Ut+128+Y]=Et[Ut+256+Y]=Et[Ut+384+Y]=Et[Ut+0+Y];for(Y=0;16>Y;++Y,ct<<=2)Et=Le,Ut=Oe+ri[Y],Ma[He.Ob[Y]](Et,Ut),vi(ct,Dt,16*+Y,Et,Ut)}else if(Et=ha(oe,Be,He.Ob[0]),Gn[Et](Le,Oe),ct!=0)for(Y=0;16>Y;++Y,ct<<=2)vi(ct,Dt,16*+Y,Le,Oe+ri[Y]);for(Y=He.Gc,Et=ha(oe,Be,He.Dd),xn[Et](Re,ze),xn[Et](Ze,ht),ct=Dt,Et=Re,Ut=ze,255&(He=0|Y)&&(170&He?qi(ct,256,Et,Ut):Ya(ct,256,Et,Ut)),He=Ze,ct=ht,255&(Y>>=8)&&(170&Y?qi(Dt,320,He,ct):Ya(Dt,320,He,ct)),Be<B.Ub-1&&(r(at[ot].y,0,Le,Oe+480,16),r(at[ot].f,0,Re,ze+224,8),r(at[ot].ea,0,Ze,ht+224,8)),Y=8*Te*B.B,at=B.sa,ot=B.ta+16*oe+16*Te*B.R,Dt=B.qa,He=B.ra+8*oe+Y,ct=B.Ha,Et=B.Ia+8*oe+Y,Y=0;16>Y;++Y)r(at,ot+Y*B.R,Le,Oe+32*Y,16);for(Y=0;8>Y;++Y)r(Dt,He+Y*B.B,Re,ze+32*Y,8),r(ct,Et+Y*B.B,Ze,ht+32*Y,8)}}function Fa(B,D,Y,oe,Be,Te,Le,Oe,Re){var ze=[0],Ze=[0],ht=0,He=Re!=null?Re.kd:0,at=Re??new Lt;if(B==null||12>Y)return 7;at.data=B,at.w=D,at.ha=Y,D=[D],Y=[Y],at.gb=[at.gb];e:{var ot=D,Dt=Y,ct=at.gb;if(a(B!=null),a(Dt!=null),a(ct!=null),ct[0]=0,12<=Dt[0]&&!t(B,ot[0],"RIFF")){if(t(B,ot[0]+8,"WEBP")){ct=3;break e}var Et=Me(B,ot[0]+4);if(12>Et||4294967286<Et){ct=3;break e}if(He&&Et>Dt[0]-8){ct=7;break e}ct[0]=Et,ot[0]+=12,Dt[0]-=12}ct=0}if(ct!=0)return ct;for(Et=0<at.gb[0],Y=Y[0];;){e:{var Ut=B;Dt=D,ct=Y;var Xt=ze,Kt=Ze,Vr=ot=[0];if((zr=ht=[ht])[0]=0,8>ct[0])ct=7;else{if(!t(Ut,Dt[0],"VP8X")){if(Me(Ut,Dt[0]+4)!=10){ct=3;break e}if(18>ct[0]){ct=7;break e}var Tr=Me(Ut,Dt[0]+8),ka=1+je(Ut,Dt[0]+12);if(2147483648<=ka*(Ut=1+je(Ut,Dt[0]+15))){ct=3;break e}Vr!=null&&(Vr[0]=Tr),Xt!=null&&(Xt[0]=ka),Kt!=null&&(Kt[0]=Ut),Dt[0]+=18,ct[0]-=18,zr[0]=1}ct=0}}if(ht=ht[0],ot=ot[0],ct!=0)return ct;if(Dt=!!(2&ot),!Et&&ht)return 3;if(Te!=null&&(Te[0]=!!(16&ot)),Le!=null&&(Le[0]=Dt),Oe!=null&&(Oe[0]=0),Le=ze[0],ot=Ze[0],ht&&Dt&&Re==null){ct=0;break}if(4>Y){ct=7;break}if(Et&&ht||!Et&&!ht&&!t(B,D[0],"ALPH")){Y=[Y],at.na=[at.na],at.P=[at.P],at.Sa=[at.Sa];e:{Tr=B,ct=D,Et=Y;var zr=at.gb;Xt=at.na,Kt=at.P,Vr=at.Sa,ka=22,a(Tr!=null),a(Et!=null),Ut=ct[0];var Ka=Et[0];for(a(Xt!=null),a(Vr!=null),Xt[0]=null,Kt[0]=null,Vr[0]=0;;){if(ct[0]=Ut,Et[0]=Ka,8>Ka){ct=7;break e}var nn=Me(Tr,Ut+4);if(4294967286<nn){ct=3;break e}var La=8+nn+1&-2;if(ka+=La,0<zr&&ka>zr){ct=3;break e}if(!t(Tr,Ut,"VP8 ")||!t(Tr,Ut,"VP8L")){ct=0;break e}if(Ka[0]<La){ct=7;break e}t(Tr,Ut,"ALPH")||(Xt[0]=Tr,Kt[0]=Ut+8,Vr[0]=nn),Ut+=La,Ka-=La}}if(Y=Y[0],at.na=at.na[0],at.P=at.P[0],at.Sa=at.Sa[0],ct!=0)break}Y=[Y],at.Ja=[at.Ja],at.xa=[at.xa];e:if(zr=B,ct=D,Et=Y,Xt=at.gb[0],Kt=at.Ja,Vr=at.xa,Tr=ct[0],Ut=!t(zr,Tr,"VP8 "),ka=!t(zr,Tr,"VP8L"),a(zr!=null),a(Et!=null),a(Kt!=null),a(Vr!=null),8>Et[0])ct=7;else{if(Ut||ka){if(zr=Me(zr,Tr+4),12<=Xt&&zr>Xt-12){ct=3;break e}if(He&&zr>Et[0]-8){ct=7;break e}Kt[0]=zr,ct[0]+=8,Et[0]-=8,Vr[0]=ka}else Vr[0]=5<=Et[0]&&zr[Tr+0]==47&&!(zr[Tr+4]>>5),Kt[0]=Et[0];ct=0}if(Y=Y[0],at.Ja=at.Ja[0],at.xa=at.xa[0],D=D[0],ct!=0)break;if(4294967286<at.Ja)return 3;if(Oe==null||Dt||(Oe[0]=at.xa?2:1),Le=[Le],ot=[ot],at.xa){if(5>Y){ct=7;break}Oe=Le,He=ot,Dt=Te,B==null||5>Y?B=0:5<=Y&&B[D+0]==47&&!(B[D+4]>>5)?(Et=[0],zr=[0],Xt=[0],we(Kt=new le,B,D,Y),zi(Kt,Et,zr,Xt)?(Oe!=null&&(Oe[0]=Et[0]),He!=null&&(He[0]=zr[0]),Dt!=null&&(Dt[0]=Xt[0]),B=1):B=0):B=0}else{if(10>Y){ct=7;break}Oe=ot,B==null||10>Y||!ya(B,D+3,Y-3)?B=0:(He=B[D+0]|B[D+1]<<8|B[D+2]<<16,Dt=16383&(B[D+7]<<8|B[D+6]),B=16383&(B[D+9]<<8|B[D+8]),1&He||3<(He>>1&7)||!(He>>4&1)||He>>5>=at.Ja||!Dt||!B?B=0:(Le&&(Le[0]=Dt),Oe&&(Oe[0]=B),B=1))}if(!B||(Le=Le[0],ot=ot[0],ht&&(ze[0]!=Le||Ze[0]!=ot)))return 3;Re!=null&&(Re[0]=at,Re.offset=D-Re.w,a(4294967286>D-Re.w),a(Re.offset==Re.ha-Y));break}return ct==0||ct==7&&ht&&Re==null?(Te!=null&&(Te[0]|=at.na!=null&&0<at.na.length),oe!=null&&(oe[0]=Le),Be!=null&&(Be[0]=ot),0):ct}function Rc(B,D,Y){var oe=D.width,Be=D.height,Te=0,Le=0,Oe=oe,Re=Be;if(D.Da=B!=null&&0<B.Da,D.Da&&(Oe=B.cd,Re=B.bd,Te=B.v,Le=B.j,11>Y||(Te&=-2,Le&=-2),0>Te||0>Le||0>=Oe||0>=Re||Te+Oe>oe||Le+Re>Be))return 0;if(D.v=Te,D.j=Le,D.va=Te+Oe,D.o=Le+Re,D.U=Oe,D.T=Re,D.da=B!=null&&0<B.da,D.da){if(!It(Oe,Re,Y=[B.ib],Te=[B.hb]))return 0;D.ib=Y[0],D.hb=Te[0]}return D.ob=B!=null&&B.ob,D.Kb=B==null||!B.Sd,D.da&&(D.ob=D.ib<3*oe/4&&D.hb<3*Be/4,D.Kb=0),1}function Lo(B){if(B==null)return 2;if(11>B.S){var D=B.f.RGBA;D.fb+=(B.height-1)*D.A,D.A=-D.A}else D=B.f.kb,B=B.height,D.O+=(B-1)*D.fa,D.fa=-D.fa,D.N+=(B-1>>1)*D.Ab,D.Ab=-D.Ab,D.W+=(B-1>>1)*D.Db,D.Db=-D.Db,D.F!=null&&(D.J+=(B-1)*D.lb,D.lb=-D.lb);return 0}function ki(B,D,Y,oe){if(oe==null||0>=B||0>=D)return 2;if(Y!=null){if(Y.Da){var Be=Y.cd,Te=Y.bd,Le=-2&Y.v,Oe=-2&Y.j;if(0>Le||0>Oe||0>=Be||0>=Te||Le+Be>B||Oe+Te>D)return 2;B=Be,D=Te}if(Y.da){if(!It(B,D,Be=[Y.ib],Te=[Y.hb]))return 2;B=Be[0],D=Te[0]}}oe.width=B,oe.height=D;e:{var Re=oe.width,ze=oe.height;if(B=oe.S,0>=Re||0>=ze||!(B>=bu&&13>B))B=2;else{if(0>=oe.Rd&&oe.sd==null){Le=Te=Be=D=0;var Ze=(Oe=Re*ju[B])*ze;if(11>B||(Te=(ze+1)/2*(D=(Re+1)/2),B==12&&(Le=(Be=Re)*ze)),(ze=e(Ze+2*Te+Le))==null){B=1;break e}oe.sd=ze,11>B?((Re=oe.f.RGBA).eb=ze,Re.fb=0,Re.A=Oe,Re.size=Ze):((Re=oe.f.kb).y=ze,Re.O=0,Re.fa=Oe,Re.Fd=Ze,Re.f=ze,Re.N=0+Ze,Re.Ab=D,Re.Cd=Te,Re.ea=ze,Re.W=0+Ze+Te,Re.Db=D,Re.Ed=Te,B==12&&(Re.F=ze,Re.J=0+Ze+2*Te),Re.Tc=Le,Re.lb=Be)}if(D=1,Be=oe.S,Te=oe.width,Le=oe.height,Be>=bu&&13>Be)if(11>Be)B=oe.f.RGBA,D&=(Oe=Math.abs(B.A))*(Le-1)+Te<=B.size,D&=Oe>=Te*ju[Be],D&=B.eb!=null;else{B=oe.f.kb,Oe=(Te+1)/2,Ze=(Le+1)/2,Re=Math.abs(B.fa),ze=Math.abs(B.Ab);var ht=Math.abs(B.Db),He=Math.abs(B.lb),at=He*(Le-1)+Te;D&=Re*(Le-1)+Te<=B.Fd,D&=ze*(Ze-1)+Oe<=B.Cd,D=(D&=ht*(Ze-1)+Oe<=B.Ed)&Re>=Te&ze>=Oe&ht>=Oe,D&=B.y!=null,D&=B.f!=null,D&=B.ea!=null,Be==12&&(D&=He>=Te,D&=at<=B.Tc,D&=B.F!=null)}else D=0;B=D?0:2}}return B!=0||Y!=null&&Y.fd&&(B=Lo(oe)),B}var Pc=64,wi=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],pn=24,gn=32,Ys=8,Yl=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ye("Predictor0","PredictorAdd0"),ae.Predictor0=function(){return 4278190080},ae.Predictor1=function(B){return B},ae.Predictor2=function(B,D,Y){return D[Y+0]},ae.Predictor3=function(B,D,Y){return D[Y+1]},ae.Predictor4=function(B,D,Y){return D[Y-1]},ae.Predictor5=function(B,D,Y){return Jt(Jt(B,D[Y+1]),D[Y+0])},ae.Predictor6=function(B,D,Y){return Jt(B,D[Y-1])},ae.Predictor7=function(B,D,Y){return Jt(B,D[Y+0])},ae.Predictor8=function(B,D,Y){return Jt(D[Y-1],D[Y+0])},ae.Predictor9=function(B,D,Y){return Jt(D[Y+0],D[Y+1])},ae.Predictor10=function(B,D,Y){return Jt(Jt(B,D[Y-1]),Jt(D[Y+0],D[Y+1]))},ae.Predictor11=function(B,D,Y){var oe=D[Y+0];return 0>=bt(oe>>24&255,B>>24&255,(D=D[Y-1])>>24&255)+bt(oe>>16&255,B>>16&255,D>>16&255)+bt(oe>>8&255,B>>8&255,D>>8&255)+bt(255&oe,255&B,255&D)?oe:B},ae.Predictor12=function(B,D,Y){var oe=D[Y+0];return(mr((B>>24&255)+(oe>>24&255)-((D=D[Y-1])>>24&255))<<24|mr((B>>16&255)+(oe>>16&255)-(D>>16&255))<<16|mr((B>>8&255)+(oe>>8&255)-(D>>8&255))<<8|mr((255&B)+(255&oe)-(255&D)))>>>0},ae.Predictor13=function(B,D,Y){var oe=D[Y-1];return(ar((B=Jt(B,D[Y+0]))>>24&255,oe>>24&255)<<24|ar(B>>16&255,oe>>16&255)<<16|ar(B>>8&255,oe>>8&255)<<8|ar(255&B,255&oe))>>>0};var Td=ae.PredictorAdd0;ae.PredictorAdd1=Yt,Ye("Predictor2","PredictorAdd2"),Ye("Predictor3","PredictorAdd3"),Ye("Predictor4","PredictorAdd4"),Ye("Predictor5","PredictorAdd5"),Ye("Predictor6","PredictorAdd6"),Ye("Predictor7","PredictorAdd7"),Ye("Predictor8","PredictorAdd8"),Ye("Predictor9","PredictorAdd9"),Ye("Predictor10","PredictorAdd10"),Ye("Predictor11","PredictorAdd11"),Ye("Predictor12","PredictorAdd12"),Ye("Predictor13","PredictorAdd13");var _d=ae.PredictorAdd2;Ot("ColorIndexInverseTransform","MapARGB","32b",function(B){return B>>8&255},function(B){return B}),Ot("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(B){return B},function(B){return B>>8&255});var ys,hc=ae.ColorIndexInverseTransform,Ao=ae.MapARGB,uo=ae.VP8LColorIndexInverseTransformAlpha,$i=ae.MapAlpha,mc=ae.VP8LPredictorsAdd=[];mc.length=16,(ae.VP8LPredictors=[]).length=16,(ae.VP8LPredictorsAdd_C=[]).length=16,(ae.VP8LPredictors_C=[]).length=16;var gA,Hc,zc,Wl,jl,Kc,Uo,pc,zn,qi,Ea,Ya,Os,Kn,Bl,Sn,xA,Ld,p0,uf,ff,g0,x0,GA,So,tl,VA,fo,Gc=e(511),xu=e(2041),Ta=e(225),Vc=e(767),bA=0,Mo=xu,ps=Ta,ho=Vc,Di=Gc,bu=0,Ws=1,hf=2,rl=3,YA=4,WA=5,Io=6,Ud=7,yu=8,$A=9,mf=10,al=[2,3,7],qA=[3,3,11],Yc=[280,256,256,256,40],Md=[0,1,1,1,0],Id=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],sl=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],nl=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Wc=8,Sl=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],il=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Oo=null,vu=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],pf=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],wu=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],b0=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Ti=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],sn=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],es=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Gn=[],Ma=[],xn=[],$s=1,Qo=2,gc=[],_i=[];_s("UpsampleRgbLinePair",Vl,3),_s("UpsampleBgrLinePair",Qc,3),_s("UpsampleRgbaLinePair",Cl,4),_s("UpsampleBgraLinePair",Vs,4),_s("UpsampleArgbLinePair",fc,4),_s("UpsampleRgba4444LinePair",uc,2),_s("UpsampleRgb565LinePair",ti,2);var $l=ae.UpsampleRgbLinePair,$c=ae.UpsampleBgrLinePair,xc=ae.UpsampleRgbaLinePair,bc=ae.UpsampleBgraLinePair,qc=ae.UpsampleArgbLinePair,yc=ae.UpsampleRgba4444LinePair,ql=ae.UpsampleRgb565LinePair,ol=16,XA=1<<ol-1,yA=-227,Xi=482,vc=6,Xc=0,Ai=e(256),Nu=e(256),y0=e(256),pp=e(256),_h=e(Xi-yA),mo=e(Xi-yA);Es("YuvToRgbRow",Vl,3),Es("YuvToBgrRow",Qc,3),Es("YuvToRgbaRow",Cl,4),Es("YuvToBgraRow",Vs,4),Es("YuvToArgbRow",fc,4),Es("YuvToRgba4444Row",uc,2),Es("YuvToRgb565Row",ti,2);var ri=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Jc=[0,2,8],JA=[8,7,6,4,4,2,2,2,1,1,1,1],Cu=1;this.WebPDecodeRGBA=function(B,D,Y,oe,Be){var Te=Ws,Le=new nt,Oe=new or;Le.ba=Oe,Oe.S=Te,Oe.width=[Oe.width],Oe.height=[Oe.height];var Re=Oe.width,ze=Oe.height,Ze=new Nr;if(Ze==null||B==null)var ht=2;else a(Ze!=null),ht=Fa(B,D,Y,Ze.width,Ze.height,Ze.Pd,Ze.Qd,Ze.format,null);if(ht!=0?Re=0:(Re!=null&&(Re[0]=Ze.width[0]),ze!=null&&(ze[0]=Ze.height[0]),Re=1),Re){Oe.width=Oe.width[0],Oe.height=Oe.height[0],oe!=null&&(oe[0]=Oe.width),Be!=null&&(Be[0]=Oe.height);e:{if(oe=new tn,(Be=new Lt).data=B,Be.w=D,Be.ha=Y,Be.kd=1,D=[0],a(Be!=null),((B=Fa(Be.data,Be.w,Be.ha,null,null,null,D,null,Be))==0||B==7)&&D[0]&&(B=4),(D=B)==0){if(a(Le!=null),oe.data=Be.data,oe.w=Be.w+Be.offset,oe.ha=Be.ha-Be.offset,oe.put=ra,oe.ac=co,oe.bc=ko,oe.ma=Le,Be.xa){if((B=gi())==null){Le=1;break e}if((function(He,at){var ot=[0],Dt=[0],ct=[0];t:for(;;){if(He==null)return 0;if(at==null)return He.a=2,0;if(He.l=at,He.a=0,we(He.m,at.data,at.w,at.ha),!zi(He.m,ot,Dt,ct)){He.a=3;break t}if(He.xb=Qo,at.width=ot[0],at.height=Dt[0],!Wo(ot[0],Dt[0],1,He,null))break t;return 1}return a(He.a!=0),0})(B,oe)){if(oe=(D=ki(oe.width,oe.height,Le.Oa,Le.ba))==0){t:{oe=B;r:for(;;){if(oe==null){oe=0;break t}if(a(oe.s.yc!=null),a(oe.s.Ya!=null),a(0<oe.s.Wb),a((Y=oe.l)!=null),a((Be=Y.ma)!=null),oe.xb!=0){if(oe.ca=Be.ba,oe.tb=Be.tb,a(oe.ca!=null),!Rc(Be.Oa,Y,rl)){oe.a=2;break r}if(!Fi(oe,Y.width)||Y.da)break r;if((Y.da||jr(oe.ca.S))&&el(),11>oe.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),oe.ca.f.kb.F!=null&&el()),oe.Pb&&0<oe.s.ua&&oe.s.vb.X==null&&!Se(oe.s.vb,oe.s.Wa.Xa)){oe.a=1;break r}oe.xb=0}if(!Oa(oe,oe.V,oe.Ba,oe.c,oe.i,Y.o,Si))break r;Be.Dc=oe.Ma,oe=1;break t}a(oe.a!=0),oe=0}oe=!oe}oe&&(D=B.a)}else D=B.a}else{if((B=new ns)==null){Le=1;break e}if(B.Fa=Be.na,B.P=Be.P,B.qc=Be.Sa,Cr(B,oe)){if((D=ki(oe.width,oe.height,Le.Oa,Le.ba))==0){if(B.Aa=0,Y=Le.Oa,a((Be=B)!=null),Y!=null){if(0<(Re=0>(Re=Y.Md)?0:100<Re?255:255*Re/100)){for(ze=Ze=0;4>ze;++ze)12>(ht=Be.pb[ze]).lc&&(ht.ia=Re*JA[0>ht.lc?0:ht.lc]>>3),Ze|=ht.ia;Ze&&(alert("todo:VP8InitRandom"),Be.ia=1)}Be.Ga=Y.Id,100<Be.Ga?Be.Ga=100:0>Be.Ga&&(Be.Ga=0)}(function(He,at){if(He==null)return 0;if(at==null)return Pa(He,2,"NULL VP8Io parameter in VP8Decode().");if(!He.cb&&!Cr(He,at))return 0;if(a(He.cb),at.ac==null||at.ac(at)){at.ob&&(He.L=0);var ot=Jc[He.L];if(He.L==2?(He.yb=0,He.zb=0):(He.yb=at.v-ot>>4,He.zb=at.j-ot>>4,0>He.yb&&(He.yb=0),0>He.zb&&(He.zb=0)),He.Va=at.o+15+ot>>4,He.Hb=at.va+15+ot>>4,He.Hb>He.za&&(He.Hb=He.za),He.Va>He.Ub&&(He.Va=He.Ub),0<He.L){var Dt=He.ed;for(ot=0;4>ot;++ot){var ct;if(He.Qa.Cb){var Et=He.Qa.Lb[ot];He.Qa.Fb||(Et+=Dt.Tb)}else Et=Dt.Tb;for(ct=0;1>=ct;++ct){var Ut=He.gd[ot][ct],Xt=Et;if(Dt.Pc&&(Xt+=Dt.vd[0],ct&&(Xt+=Dt.od[0])),0<(Xt=0>Xt?0:63<Xt?63:Xt)){var Kt=Xt;0<Dt.wb&&(Kt=4<Dt.wb?Kt>>2:Kt>>1)>9-Dt.wb&&(Kt=9-Dt.wb),1>Kt&&(Kt=1),Ut.dd=Kt,Ut.tc=2*Xt+Kt,Ut.ld=40<=Xt?2:15<=Xt?1:0}else Ut.tc=0;Ut.La=ct}}}ot=0}else Pa(He,6,"Frame setup failed"),ot=He.a;if(ot=ot==0){if(ot){He.$c=0,0<He.Aa||(He.Ic=Cu);t:{ot=He.Ic,Dt=4*(Kt=He.za);var Vr=32*Kt,Tr=Kt+1,ka=0<He.L?Kt*(0<He.Aa?2:1):0,zr=(He.Aa==2?2:1)*Kt;if((Ut=Dt+832+(ct=3*(16*ot+Jc[He.L])/2*Vr)+(Et=He.Fa!=null&&0<He.Fa.length?He.Kc.c*He.Kc.i:0))!=Ut)ot=0;else{if(Ut>He.Vb){if(He.Vb=0,He.Ec=e(Ut),He.Fc=0,He.Ec==null){ot=Pa(He,1,"no memory during frame initialization.");break t}He.Vb=Ut}Ut=He.Ec,Xt=He.Fc,He.Ac=Ut,He.Bc=Xt,Xt+=Dt,He.Gd=u(Vr,Ra),He.Hd=0,He.rb=u(Tr+1,qt),He.sb=1,He.wa=ka?u(ka,zt):null,He.Y=0,He.D.Nb=0,He.D.wa=He.wa,He.D.Y=He.Y,0<He.Aa&&(He.D.Y+=Kt),a(!0),He.oc=Ut,He.pc=Xt,Xt+=832,He.ya=u(zr,Ar),He.aa=0,He.D.ya=He.ya,He.D.aa=He.aa,He.Aa==2&&(He.D.aa+=Kt),He.R=16*Kt,He.B=8*Kt,Kt=(Vr=Jc[He.L])*He.R,Vr=Vr/2*He.B,He.sa=Ut,He.ta=Xt+Kt,He.qa=He.sa,He.ra=He.ta+16*ot*He.R+Vr,He.Ha=He.qa,He.Ia=He.ra+8*ot*He.B+Vr,He.$c=0,Xt+=ct,He.mb=Et?Ut:null,He.nb=Et?Xt:null,a(Xt+Et<=He.Fc+He.Vb),jo(He),s(He.Ac,He.Bc,0,Dt),ot=1}}if(ot){if(at.ka=0,at.y=He.sa,at.O=He.ta,at.f=He.qa,at.N=He.ra,at.ea=He.Ha,at.Vd=He.Ia,at.fa=He.R,at.Rc=He.B,at.F=null,at.J=0,!bA){for(ot=-255;255>=ot;++ot)Gc[255+ot]=0>ot?-ot:ot;for(ot=-1020;1020>=ot;++ot)xu[1020+ot]=-128>ot?-128:127<ot?127:ot;for(ot=-112;112>=ot;++ot)Ta[112+ot]=-16>ot?-16:15<ot?15:ot;for(ot=-255;510>=ot;++ot)Vc[255+ot]=0>ot?0:255<ot?255:ot;bA=1}Uo=Gi,pc=oc,qi=Va,Ea=li,Ya=Fs,zn=qo,Os=gu,Kn=KA,Bl=R,Sn=Ce,xA=dc,Ld=Oc,p0=Ke,uf=Xe,ff=mA,g0=cc,x0=Ic,GA=pA,Ma[0]=pu,Ma[1]=ls,Ma[2]=vl,Ma[3]=mu,Ma[4]=df,Ma[5]=Ei,Ma[6]=Jo,Ma[7]=Dd,Ma[8]=Yi,Ma[9]=Un,Gn[0]=Xo,Gn[1]=Ps,Gn[2]=HA,Gn[3]=kd,Gn[4]=To,Gn[5]=yl,Gn[6]=cs,xn[0]=Zo,xn[1]=jn,xn[2]=lr,xn[3]=wl,xn[4]=Nl,xn[5]=Bn,xn[6]=Ts,ot=1}else ot=0}ot&&(ot=(function(Ka,nn){for(Ka.M=0;Ka.M<Ka.Va;++Ka.M){var La,Er=Ka.Jc[Ka.M&Ka.Xb],xr=Ka.m,on=Ka;for(La=0;La<on.za;++La){var sa=xr,Ia=on,ks=Ia.Ac,di=Ia.Bc+4*La,Li=Ia.zc,qs=Ia.ya[Ia.aa+La];if(Ia.Qa.Bb?qs.$b=Fe(sa,Ia.Pa.jb[0])?2+Fe(sa,Ia.Pa.jb[2]):Fe(sa,Ia.Pa.jb[1]):qs.$b=0,Ia.kc&&(qs.Ad=Fe(sa,Ia.Bd)),qs.Za=!Fe(sa,145)+0,qs.Za){var Vn=qs.Ob,Ji=0;for(Ia=0;4>Ia;++Ia){var Yn,Qa=Li[0+Ia];for(Yn=0;4>Yn;++Yn){Qa=Ti[ks[di+Yn]][Qa];for(var qa=wu[Fe(sa,Qa[0])];0<qa;)qa=wu[2*qa+Fe(sa,Qa[qa])];Qa=-qa,ks[di+Yn]=Qa}r(Vn,Ji,ks,di,4),Ji+=4,Li[0+Ia]=Qa}}else Qa=Fe(sa,156)?Fe(sa,128)?1:3:Fe(sa,163)?2:0,qs.Ob[0]=Qa,s(ks,di,Qa,4),s(Li,0,Qa,4);qs.Dd=Fe(sa,142)?Fe(sa,114)?Fe(sa,183)?1:3:2:0}if(on.m.Ka)return Pa(Ka,7,"Premature end-of-partition0 encountered.");for(;Ka.ja<Ka.za;++Ka.ja){if(on=Er,sa=(xr=Ka).rb[xr.sb-1],ks=xr.rb[xr.sb+xr.ja],La=xr.ya[xr.aa+xr.ja],di=xr.kc?La.Ad:0)sa.la=ks.la=0,La.Za||(sa.Na=ks.Na=0),La.Hc=0,La.Gc=0,La.ia=0;else{var Fn,vs;if(sa=ks,ks=on,di=xr.Pa.Xc,Li=xr.ya[xr.aa+xr.ja],qs=xr.pb[Li.$b],Ia=Li.ad,Vn=0,Ji=xr.rb[xr.sb-1],Qa=Yn=0,s(Ia,Vn,0,384),Li.Za)var Ni=0,On=di[3];else{qa=e(16);var gs=sa.Na+Ji.Na;if(gs=Oo(ks,di[1],gs,qs.Eb,0,qa,0),sa.Na=Ji.Na=(0<gs)+0,1<gs)Uo(qa,0,Ia,Vn);else{var En=qa[0]+3>>3;for(qa=0;256>qa;qa+=16)Ia[Vn+qa]=En}Ni=1,On=di[0]}var Ds=15&sa.la,Wn=15&Ji.la;for(qa=0;4>qa;++qa){var ai=1&Wn;for(En=vs=0;4>En;++En)Ds=Ds>>1|(ai=(gs=Oo(ks,On,gs=ai+(1&Ds),qs.Sc,Ni,Ia,Vn))>Ni)<<7,vs=vs<<2|(3<gs?3:1<gs?2:Ia[Vn+0]!=0),Vn+=16;Ds>>=4,Wn=Wn>>1|ai<<7,Yn=(Yn<<8|vs)>>>0}for(On=Ds,Ni=Wn>>4,Fn=0;4>Fn;Fn+=2){for(vs=0,Ds=sa.la>>4+Fn,Wn=Ji.la>>4+Fn,qa=0;2>qa;++qa){for(ai=1&Wn,En=0;2>En;++En)gs=ai+(1&Ds),Ds=Ds>>1|(ai=0<(gs=Oo(ks,di[2],gs,qs.Qc,0,Ia,Vn)))<<3,vs=vs<<2|(3<gs?3:1<gs?2:Ia[Vn+0]!=0),Vn+=16;Ds>>=2,Wn=Wn>>1|ai<<5}Qa|=vs<<4*Fn,On|=Ds<<4<<Fn,Ni|=(240&Wn)<<Fn}sa.la=On,Ji.la=Ni,Li.Hc=Yn,Li.Gc=Qa,Li.ia=43690&Qa?0:qs.ia,di=!(Yn|Qa)}if(0<xr.L&&(xr.wa[xr.Y+xr.ja]=xr.gd[La.$b][La.Za],xr.wa[xr.Y+xr.ja].La|=!di),on.Ka)return Pa(Ka,7,"Premature end-of-file encountered.")}if(jo(Ka),xr=nn,on=1,La=(Er=Ka).D,sa=0<Er.L&&Er.M>=Er.zb&&Er.M<=Er.Va,Er.Aa==0)t:{if(La.M=Er.M,La.uc=sa,fa(Er,La),on=1,La=(vs=Er.D).Nb,sa=(Qa=Jc[Er.L])*Er.R,ks=Qa/2*Er.B,qa=16*La*Er.R,En=8*La*Er.B,di=Er.sa,Li=Er.ta-sa+qa,qs=Er.qa,Ia=Er.ra-ks+En,Vn=Er.Ha,Ji=Er.Ia-ks+En,Wn=(Ds=vs.M)==0,Yn=Ds>=Er.Va-1,Er.Aa==2&&fa(Er,vs),vs.uc)for(ai=(gs=Er).D.M,a(gs.D.uc),vs=gs.yb;vs<gs.Hb;++vs){Ni=vs,On=ai;var xs=(As=(si=gs).D).Nb;Fn=si.R;var As=As.wa[As.Y+Ni],Ui=si.sa,bn=si.ta+16*xs*Fn+16*Ni,da=As.dd,ia=As.tc;if(ia!=0)if(a(3<=ia),si.L==1)0<Ni&&g0(Ui,bn,Fn,ia+4),As.La&&GA(Ui,bn,Fn,ia),0<On&&ff(Ui,bn,Fn,ia+4),As.La&&x0(Ui,bn,Fn,ia);else{var ts=si.B,Fo=si.qa,ll=si.ra+8*xs*ts+8*Ni,po=si.Ha,si=si.Ia+8*xs*ts+8*Ni;xs=As.ld,0<Ni&&(Kn(Ui,bn,Fn,ia+4,da,xs),Sn(Fo,ll,po,si,ts,ia+4,da,xs)),As.La&&(Ld(Ui,bn,Fn,ia,da,xs),uf(Fo,ll,po,si,ts,ia,da,xs)),0<On&&(Os(Ui,bn,Fn,ia+4,da,xs),Bl(Fo,ll,po,si,ts,ia+4,da,xs)),As.La&&(xA(Ui,bn,Fn,ia,da,xs),p0(Fo,ll,po,si,ts,ia,da,xs))}}if(Er.ia&&alert("todo:DitherRow"),xr.put!=null){if(vs=16*Ds,Ds=16*(Ds+1),Wn?(xr.y=Er.sa,xr.O=Er.ta+qa,xr.f=Er.qa,xr.N=Er.ra+En,xr.ea=Er.Ha,xr.W=Er.Ia+En):(vs-=Qa,xr.y=di,xr.O=Li,xr.f=qs,xr.N=Ia,xr.ea=Vn,xr.W=Ji),Yn||(Ds-=Qa),Ds>xr.o&&(Ds=xr.o),xr.F=null,xr.J=null,Er.Fa!=null&&0<Er.Fa.length&&vs<Ds&&(xr.J=mn(Er,xr,vs,Ds-vs),xr.F=Er.mb,xr.F==null&&xr.F.length==0)){on=Pa(Er,3,"Could not decode alpha data.");break t}vs<xr.j&&(Qa=xr.j-vs,vs=xr.j,a(!(1&Qa)),xr.O+=Er.R*Qa,xr.N+=Er.B*(Qa>>1),xr.W+=Er.B*(Qa>>1),xr.F!=null&&(xr.J+=xr.width*Qa)),vs<Ds&&(xr.O+=xr.v,xr.N+=xr.v>>1,xr.W+=xr.v>>1,xr.F!=null&&(xr.J+=xr.v),xr.ka=vs-xr.j,xr.U=xr.va-xr.v,xr.T=Ds-vs,on=xr.put(xr))}La+1!=Er.Ic||Yn||(r(Er.sa,Er.ta-sa,di,Li+16*Er.R,sa),r(Er.qa,Er.ra-ks,qs,Ia+8*Er.B,ks),r(Er.Ha,Er.Ia-ks,Vn,Ji+8*Er.B,ks))}if(!on)return Pa(Ka,6,"Output aborted.")}return 1})(He,at)),at.bc!=null&&at.bc(at),ot&=1}return ot?(He.cb=0,ot):0})(B,oe)||(D=B.a)}}else D=B.a}D==0&&Le.Oa!=null&&Le.Oa.fd&&(D=Lo(Le.ba))}Le=D}Te=Le!=0?null:11>Te?Oe.f.RGBA.eb:Oe.f.kb.y}else Te=null;return Te};var ju=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function g(ae,pe){for(var z="",J=0;J<4;J++)z+=String.fromCharCode(ae[pe++]);return z}function b(ae,pe){return ae[pe+0]|ae[pe+1]<<8}function j(ae,pe){return(ae[pe+0]|ae[pe+1]<<8|ae[pe+2]<<16)>>>0}function F(ae,pe){return(ae[pe+0]|ae[pe+1]<<8|ae[pe+2]<<16|ae[pe+3]<<24)>>>0}new m;var C=[0],M=[0],_=[],L=new m,T=n,H=(function(ae,pe){var z={},J=0,ge=!1,fe=0,ke=0;if(z.frames=[],!(function(V,le){for(var de=0;de<4;de++)if(V[le+de]!="RIFF".charCodeAt(de))return!0;return!1})(ae,pe)){for(F(ae,pe+=4),pe+=8;pe<ae.length;){var he=g(ae,pe),Ne=F(ae,pe+=4);pe+=4;var xe=Ne+(1&Ne);switch(he){case"VP8 ":case"VP8L":z.frames[J]===void 0&&(z.frames[J]={}),(te=z.frames[J]).src_off=ge?ke:pe-8,te.src_size=fe+Ne+8,J++,ge&&(ge=!1,fe=0,ke=0);break;case"VP8X":(te=z.header={}).feature_flags=ae[pe];var we=pe+4;te.canvas_width=1+j(ae,we),we+=3,te.canvas_height=1+j(ae,we),we+=3;break;case"ALPH":ge=!0,fe=xe+8,ke=pe-8;break;case"ANIM":(te=z.header).bgcolor=F(ae,pe),we=pe+4,te.loop_count=b(ae,we),we+=2;break;case"ANMF":var ye,te;(te=z.frames[J]={}).offset_x=2*j(ae,pe),pe+=3,te.offset_y=2*j(ae,pe),pe+=3,te.width=1+j(ae,pe),pe+=3,te.height=1+j(ae,pe),pe+=3,te.duration=j(ae,pe),pe+=3,ye=ae[pe++],te.dispose=1&ye,te.blend=ye>>1&1}he!="ANMF"&&(pe+=xe)}return z}})(T,0);H.response=T,H.rgbaoutput=!0,H.dataurl=!1;var O=H.header?H.header:null,Q=H.frames?H.frames:null;if(O){O.loop_counter=O.loop_count,C=[O.canvas_height],M=[O.canvas_width];for(var Z=0;Z<Q.length&&Q[Z].blend!=0;Z++);}var ee=Q[0],se=L.WebPDecodeRGBA(T,ee.src_off,ee.src_size,M,C);ee.rgba=se,ee.imgwidth=M[0],ee.imgheight=C[0];for(var ue=0;ue<M[0]*C[0]*4;ue++)_[ue]=se[ue];return this.width=M,this.height=C,this.data=_,this}(function(n){var a,t,r,s,e,u,f,m,g,b=function(V){return V=V||{},this.isStrokeTransparent=V.isStrokeTransparent||!1,this.strokeOpacity=V.strokeOpacity||1,this.strokeStyle=V.strokeStyle||"#000000",this.fillStyle=V.fillStyle||"#000000",this.isFillTransparent=V.isFillTransparent||!1,this.fillOpacity=V.fillOpacity||1,this.font=V.font||"10px sans-serif",this.textBaseline=V.textBaseline||"alphabetic",this.textAlign=V.textAlign||"left",this.lineWidth=V.lineWidth||1,this.lineJoin=V.lineJoin||"miter",this.lineCap=V.lineCap||"butt",this.path=V.path||[],this.transform=V.transform!==void 0?V.transform.clone():new m,this.globalCompositeOperation=V.globalCompositeOperation||"normal",this.globalAlpha=V.globalAlpha||1,this.clip_path=V.clip_path||[],this.currentPoint=V.currentPoint||new u,this.miterLimit=V.miterLimit||10,this.lastPoint=V.lastPoint||new u,this.lineDashOffset=V.lineDashOffset||0,this.lineDash=V.lineDash||[],this.margin=V.margin||[0,0,0,0],this.prevPageLastElemOffset=V.prevPageLastElemOffset||0,this.ignoreClearRect=typeof V.ignoreClearRect!="boolean"||V.ignoreClearRect,this};n.events.push(["initialized",function(){this.context2d=new j(this),a=this.internal.f2,t=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,e=this.internal.getVerticalCoordinate,u=this.internal.Point,f=this.internal.Rectangle,m=this.internal.Matrix,g=new b}]);var j=function(V){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var le=V;Object.defineProperty(this,"pdf",{get:function(){return le}});var de=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return de},set:function(Me){de=!!Me}});var X=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return X},set:function(Me){X=!!Me}});var ie=0;Object.defineProperty(this,"posX",{get:function(){return ie},set:function(Me){isNaN(Me)||(ie=Me)}});var G=0;Object.defineProperty(this,"posY",{get:function(){return G},set:function(Me){isNaN(Me)||(G=Me)}}),Object.defineProperty(this,"margin",{get:function(){return g.margin},set:function(Me){var Se;typeof Me=="number"?Se=[Me,Me,Me,Me]:((Se=new Array(4))[0]=Me[0],Se[1]=Me.length>=2?Me[1]:Se[0],Se[2]=Me.length>=3?Me[2]:Se[0],Se[3]=Me.length>=4?Me[3]:Se[1]),g.margin=Se}});var q=!1;Object.defineProperty(this,"autoPaging",{get:function(){return q},set:function(Me){q=Me}});var ve=0;Object.defineProperty(this,"lastBreak",{get:function(){return ve},set:function(Me){ve=Me}});var Fe=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Fe},set:function(Me){Fe=Me}}),Object.defineProperty(this,"ctx",{get:function(){return g},set:function(Me){Me instanceof b&&(g=Me)}}),Object.defineProperty(this,"path",{get:function(){return g.path},set:function(Me){g.path=Me}});var Qe=[];Object.defineProperty(this,"ctxStack",{get:function(){return Qe},set:function(Me){Qe=Me}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Me){var Se;Se=F(Me),this.ctx.fillStyle=Se.style,this.ctx.isFillTransparent=Se.a===0,this.ctx.fillOpacity=Se.a,this.pdf.setFillColor(Se.r,Se.g,Se.b,{a:Se.a}),this.pdf.setTextColor(Se.r,Se.g,Se.b,{a:Se.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Me){var Se=F(Me);this.ctx.strokeStyle=Se.style,this.ctx.isStrokeTransparent=Se.a===0,this.ctx.strokeOpacity=Se.a,Se.a===0?this.pdf.setDrawColor(255,255,255):(Se.a,this.pdf.setDrawColor(Se.r,Se.g,Se.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Me){["butt","round","square"].indexOf(Me)!==-1&&(this.ctx.lineCap=Me,this.pdf.setLineCap(Me))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Me){isNaN(Me)||(this.ctx.lineWidth=Me,this.pdf.setLineWidth(Me))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Me){["bevel","round","miter"].indexOf(Me)!==-1&&(this.ctx.lineJoin=Me,this.pdf.setLineJoin(Me))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Me){isNaN(Me)||(this.ctx.miterLimit=Me,this.pdf.setMiterLimit(Me))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Me){this.ctx.textBaseline=Me}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Me){["right","end","center","left","start"].indexOf(Me)!==-1&&(this.ctx.textAlign=Me)}});var Ge=null,je=null;Object.defineProperty(this,"fontFaces",{get:function(){return je},set:function(Me){Ge=null,je=Me}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Me){var Se;if(this.ctx.font=Me,(Se=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Me))!==null){var ft=Se[1];Se[2];var jt=Se[3],It=Se[4];Se[5];var ut=Se[6],Rt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(It)[2];It=Math.floor(Rt==="px"?parseFloat(It)*this.pdf.internal.scaleFactor:Rt==="em"?parseFloat(It)*this.pdf.getFontSize():parseFloat(It)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(It);var Ye=(function(Mr){var Ot,ja,oa=[],hr=Mr.trim();if(hr==="")return tv;if(hr in _3)return[_3[hr]];for(;hr!=="";){switch(ja=null,Ot=(hr=U3(hr)).charAt(0)){case'"':case"'":ja=Z9(hr.substring(1),Ot);break;default:ja=e_(hr)}if(ja===null||(oa.push(ja[0]),(hr=U3(ja[1]))!==""&&hr.charAt(0)!==","))return tv;hr=hr.replace(/^,/,"")}return oa})(ut);if(this.fontFaces){var St=(function(Mr,Ot){if(Ge===null){var ja=(function(oa){var hr=[];return Object.keys(oa).forEach(function(pr){oa[pr].forEach(function(Gr){var Pr=null;switch(Gr){case"bold":Pr={family:pr,weight:"bold"};break;case"italic":Pr={family:pr,style:"italic"};break;case"bolditalic":Pr={family:pr,weight:"bold",style:"italic"};break;case"":case"normal":Pr={family:pr}}Pr!==null&&(Pr.ref={name:pr,style:Gr},hr.push(Pr))})}),hr})(Mr.getFontList());Ge=(function(oa){for(var hr={},pr=0;pr<oa.length;++pr){var Gr=ev(oa[pr]),Pr=Gr.family,wa=Gr.stretch,jr=Gr.style,Ms=Gr.weight;hr[Pr]=hr[Pr]||{},hr[Pr][wa]=hr[Pr][wa]||{},hr[Pr][wa][jr]=hr[Pr][wa][jr]||{},hr[Pr][wa][jr][Ms]=Gr}return hr})(ja.concat(Ot))}return Ge})(this.pdf,this.fontFaces),Jt=Ye.map(function(Mr){return{family:Mr,stretch:"normal",weight:jt,style:ft}}),mr=(function(Mr,Ot,ja){for(var oa=(ja=ja||{}).defaultFontFamily||"times",hr=Object.assign({},J9,ja.genericFontFamilies||{}),pr=null,Gr=null,Pr=0;Pr<Ot.length;++Pr)if(hr[(pr=ev(Ot[Pr])).family]&&(pr.family=hr[pr.family]),Mr.hasOwnProperty(pr.family)){Gr=Mr[pr.family];break}if(!(Gr=Gr||Mr[oa]))throw new Error("Could not find a font-family for the rule '"+L3(pr)+"' and default family '"+oa+"'.");if(Gr=(function(wa,jr){if(jr[wa])return jr[wa];var Ms=pw[wa],Rs=Ms<=pw.normal?-1:1,or=T3(jr,qj,Ms,Rs);if(!or)throw new Error("Could not find a matching font-stretch value for "+wa);return or})(pr.stretch,Gr),Gr=(function(wa,jr){if(jr[wa])return jr[wa];for(var Ms=$j[wa],Rs=0;Rs<Ms.length;++Rs)if(jr[Ms[Rs]])return jr[Ms[Rs]];throw new Error("Could not find a matching font-style for "+wa)})(pr.style,Gr),!(Gr=(function(wa,jr){if(jr[wa])return jr[wa];if(wa===400&&jr[500])return jr[500];if(wa===500&&jr[400])return jr[400];var Ms=X9[wa],Rs=T3(jr,Xj,Ms,wa<400?-1:1);if(!Rs)throw new Error("Could not find a matching font-weight for value "+wa);return Rs})(pr.weight,Gr)))throw new Error("Failed to resolve a font for the rule '"+L3(pr)+"'.");return Gr})(St,Jt);this.pdf.setFont(mr.ref.name,mr.ref.style)}else{var ar="";(jt==="bold"||parseInt(jt,10)>=700||ft==="bold")&&(ar="bold"),ft==="italic"&&(ar+="italic"),ar.length===0&&(ar="normal");for(var bt="",Yt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},vr=0;vr<Ye.length;vr++){if(this.pdf.internal.getFont(Ye[vr],ar,{noFallback:!0,disableWarning:!0})!==void 0){bt=Ye[vr];break}if(ar==="bolditalic"&&this.pdf.internal.getFont(Ye[vr],"bold",{noFallback:!0,disableWarning:!0})!==void 0)bt=Ye[vr],ar="bold";else if(this.pdf.internal.getFont(Ye[vr],"normal",{noFallback:!0,disableWarning:!0})!==void 0){bt=Ye[vr],ar="normal";break}}if(bt===""){for(var gr=0;gr<Ye.length;gr++)if(Yt[Ye[gr]]){bt=Yt[Ye[gr]];break}}bt=bt===""?"Times":bt,this.pdf.setFont(bt,ar)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Me){this.ctx.globalCompositeOperation=Me}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Me){this.ctx.globalAlpha=Me}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Me){this.ctx.lineDashOffset=Me,te.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Me){this.ctx.lineDash=Me,te.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Me){this.ctx.ignoreClearRect=!!Me}})};j.prototype.setLineDash=function(V){this.lineDash=V},j.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},j.prototype.fill=function(){Q.call(this,"fill",!1)},j.prototype.stroke=function(){Q.call(this,"stroke",!1)},j.prototype.beginPath=function(){this.path=[{type:"begin"}]},j.prototype.moveTo=function(V,le){if(isNaN(V)||isNaN(le))throw Rn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var de=this.ctx.transform.applyToPoint(new u(V,le));this.path.push({type:"mt",x:de.x,y:de.y}),this.ctx.lastPoint=new u(V,le)},j.prototype.closePath=function(){var V=new u(0,0),le=0;for(le=this.path.length-1;le!==-1;le--)if(this.path[le].type==="begin"&&wn(this.path[le+1])==="object"&&typeof this.path[le+1].x=="number"){V=new u(this.path[le+1].x,this.path[le+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new u(V.x,V.y)},j.prototype.lineTo=function(V,le){if(isNaN(V)||isNaN(le))throw Rn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var de=this.ctx.transform.applyToPoint(new u(V,le));this.path.push({type:"lt",x:de.x,y:de.y}),this.ctx.lastPoint=new u(de.x,de.y)},j.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),Q.call(this,null,!0)},j.prototype.quadraticCurveTo=function(V,le,de,X){if(isNaN(de)||isNaN(X)||isNaN(V)||isNaN(le))throw Rn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ie=this.ctx.transform.applyToPoint(new u(de,X)),G=this.ctx.transform.applyToPoint(new u(V,le));this.path.push({type:"qct",x1:G.x,y1:G.y,x:ie.x,y:ie.y}),this.ctx.lastPoint=new u(ie.x,ie.y)},j.prototype.bezierCurveTo=function(V,le,de,X,ie,G){if(isNaN(ie)||isNaN(G)||isNaN(V)||isNaN(le)||isNaN(de)||isNaN(X))throw Rn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var q=this.ctx.transform.applyToPoint(new u(ie,G)),ve=this.ctx.transform.applyToPoint(new u(V,le)),Fe=this.ctx.transform.applyToPoint(new u(de,X));this.path.push({type:"bct",x1:ve.x,y1:ve.y,x2:Fe.x,y2:Fe.y,x:q.x,y:q.y}),this.ctx.lastPoint=new u(q.x,q.y)},j.prototype.arc=function(V,le,de,X,ie,G){if(isNaN(V)||isNaN(le)||isNaN(de)||isNaN(X)||isNaN(ie))throw Rn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(G=!!G,!this.ctx.transform.isIdentity){var q=this.ctx.transform.applyToPoint(new u(V,le));V=q.x,le=q.y;var ve=this.ctx.transform.applyToPoint(new u(0,de)),Fe=this.ctx.transform.applyToPoint(new u(0,0));de=Math.sqrt(Math.pow(ve.x-Fe.x,2)+Math.pow(ve.y-Fe.y,2))}Math.abs(ie-X)>=2*Math.PI&&(X=0,ie=2*Math.PI),this.path.push({type:"arc",x:V,y:le,radius:de,startAngle:X,endAngle:ie,counterclockwise:G})},j.prototype.arcTo=function(V,le,de,X,ie){throw new Error("arcTo not implemented.")},j.prototype.rect=function(V,le,de,X){if(isNaN(V)||isNaN(le)||isNaN(de)||isNaN(X))throw Rn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(V,le),this.lineTo(V+de,le),this.lineTo(V+de,le+X),this.lineTo(V,le+X),this.lineTo(V,le),this.lineTo(V+de,le),this.lineTo(V,le)},j.prototype.fillRect=function(V,le,de,X){if(isNaN(V)||isNaN(le)||isNaN(de)||isNaN(X))throw Rn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!C.call(this)){var ie={};this.lineCap!=="butt"&&(ie.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ie.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(V,le,de,X),this.fill(),ie.hasOwnProperty("lineCap")&&(this.lineCap=ie.lineCap),ie.hasOwnProperty("lineJoin")&&(this.lineJoin=ie.lineJoin)}},j.prototype.strokeRect=function(V,le,de,X){if(isNaN(V)||isNaN(le)||isNaN(de)||isNaN(X))throw Rn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");M.call(this)||(this.beginPath(),this.rect(V,le,de,X),this.stroke())},j.prototype.clearRect=function(V,le,de,X){if(isNaN(V)||isNaN(le)||isNaN(de)||isNaN(X))throw Rn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(V,le,de,X))},j.prototype.save=function(V){V=typeof V!="boolean"||V;for(var le=this.pdf.internal.getCurrentPageInfo().pageNumber,de=0;de<this.pdf.internal.getNumberOfPages();de++)this.pdf.setPage(de+1),this.pdf.internal.out("q");if(this.pdf.setPage(le),V){this.ctx.fontSize=this.pdf.internal.getFontSize();var X=new b(this.ctx);this.ctxStack.push(this.ctx),this.ctx=X}},j.prototype.restore=function(V){V=typeof V!="boolean"||V;for(var le=this.pdf.internal.getCurrentPageInfo().pageNumber,de=0;de<this.pdf.internal.getNumberOfPages();de++)this.pdf.setPage(de+1),this.pdf.internal.out("Q");this.pdf.setPage(le),V&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},j.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var F=function(V){var le,de,X,ie;if(V.isCanvasGradient===!0&&(V=V.getColor()),!V)return{r:0,g:0,b:0,a:0,style:V};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(V))le=0,de=0,X=0,ie=0;else{var G=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(V);if(G!==null)le=parseInt(G[1]),de=parseInt(G[2]),X=parseInt(G[3]),ie=1;else if((G=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(V))!==null)le=parseInt(G[1]),de=parseInt(G[2]),X=parseInt(G[3]),ie=parseFloat(G[4]);else{if(ie=1,typeof V=="string"&&V.charAt(0)!=="#"){var q=new Hj(V);V=q.ok?q.toHex():"#000000"}V.length===4?(le=V.substring(1,2),le+=le,de=V.substring(2,3),de+=de,X=V.substring(3,4),X+=X):(le=V.substring(1,3),de=V.substring(3,5),X=V.substring(5,7)),le=parseInt(le,16),de=parseInt(de,16),X=parseInt(X,16)}}return{r:le,g:de,b:X,a:ie,style:V}},C=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},M=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};j.prototype.fillText=function(V,le,de,X){if(isNaN(le)||isNaN(de)||typeof V!="string")throw Rn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(X=isNaN(X)?void 0:X,!C.call(this)){var ie=xe(this.ctx.transform.rotation),G=this.ctx.transform.scaleX;J.call(this,{text:V,x:le,y:de,scale:G,angle:ie,align:this.textAlign,maxWidth:X})}},j.prototype.strokeText=function(V,le,de,X){if(isNaN(le)||isNaN(de)||typeof V!="string")throw Rn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!M.call(this)){X=isNaN(X)?void 0:X;var ie=xe(this.ctx.transform.rotation),G=this.ctx.transform.scaleX;J.call(this,{text:V,x:le,y:de,scale:G,renderingMode:"stroke",angle:ie,align:this.textAlign,maxWidth:X})}},j.prototype.measureText=function(V){if(typeof V!="string")throw Rn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var le=this.pdf,de=this.pdf.internal.scaleFactor,X=le.internal.getFontSize(),ie=le.getStringUnitWidth(V)*X/le.internal.scaleFactor;return new function(G){var q=(G=G||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return q}}),this}({width:ie*=Math.round(96*de/72*1e4)/1e4})},j.prototype.scale=function(V,le){if(isNaN(V)||isNaN(le))throw Rn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var de=new m(V,0,0,le,0,0);this.ctx.transform=this.ctx.transform.multiply(de)},j.prototype.rotate=function(V){if(isNaN(V))throw Rn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var le=new m(Math.cos(V),Math.sin(V),-Math.sin(V),Math.cos(V),0,0);this.ctx.transform=this.ctx.transform.multiply(le)},j.prototype.translate=function(V,le){if(isNaN(V)||isNaN(le))throw Rn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var de=new m(1,0,0,1,V,le);this.ctx.transform=this.ctx.transform.multiply(de)},j.prototype.transform=function(V,le,de,X,ie,G){if(isNaN(V)||isNaN(le)||isNaN(de)||isNaN(X)||isNaN(ie)||isNaN(G))throw Rn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var q=new m(V,le,de,X,ie,G);this.ctx.transform=this.ctx.transform.multiply(q)},j.prototype.setTransform=function(V,le,de,X,ie,G){V=isNaN(V)?1:V,le=isNaN(le)?0:le,de=isNaN(de)?0:de,X=isNaN(X)?1:X,ie=isNaN(ie)?0:ie,G=isNaN(G)?0:G,this.ctx.transform=new m(V,le,de,X,ie,G)};var _=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};j.prototype.drawImage=function(V,le,de,X,ie,G,q,ve,Fe){var Qe=this.pdf.getImageProperties(V),Ge=1,je=1,Me=1,Se=1;X!==void 0&&ve!==void 0&&(Me=ve/X,Se=Fe/ie,Ge=Qe.width/X*ve/X,je=Qe.height/ie*Fe/ie),G===void 0&&(G=le,q=de,le=0,de=0),X!==void 0&&ve===void 0&&(ve=X,Fe=ie),X===void 0&&ve===void 0&&(ve=Qe.width,Fe=Qe.height);for(var ft,jt=this.ctx.transform.decompose(),It=xe(jt.rotate.shx),ut=new m,Rt=(ut=(ut=(ut=ut.multiply(jt.translate)).multiply(jt.skew)).multiply(jt.scale)).applyToRectangle(new f(G-le*Me,q-de*Se,X*Ge,ie*je)),Ye=L.call(this,Rt),St=[],Jt=0;Jt<Ye.length;Jt+=1)St.indexOf(Ye[Jt])===-1&&St.push(Ye[Jt]);if(O(St),this.autoPaging)for(var mr=St[0],ar=St[St.length-1],bt=mr;bt<ar+1;bt++){this.pdf.setPage(bt);var Yt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],vr=bt===1?this.posY+this.margin[0]:this.margin[0],gr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Mr=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ot=bt===1?0:gr+(bt-2)*Mr;if(this.ctx.clip_path.length!==0){var ja=this.path;ft=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=H(ft,this.posX+this.margin[3],-Ot+vr+this.ctx.prevPageLastElemOffset),Z.call(this,"fill",!0),this.path=ja}var oa=JSON.parse(JSON.stringify(Rt));oa=H([oa],this.posX+this.margin[3],-Ot+vr+this.ctx.prevPageLastElemOffset)[0];var hr=(bt>mr||bt<ar)&&_.call(this);hr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Yt,Mr,null).clip().discardPath()),this.pdf.addImage(V,"JPEG",oa.x,oa.y,oa.w,oa.h,null,null,It),hr&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(V,"JPEG",Rt.x,Rt.y,Rt.w,Rt.h,null,null,It)};var L=function(V,le,de){var X=[];le=le||this.pdf.internal.pageSize.width,de=de||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ie=this.posY+this.ctx.prevPageLastElemOffset;switch(V.type){default:case"mt":case"lt":X.push(Math.floor((V.y+ie)/de)+1);break;case"arc":X.push(Math.floor((V.y+ie-V.radius)/de)+1),X.push(Math.floor((V.y+ie+V.radius)/de)+1);break;case"qct":var G=we(this.ctx.lastPoint.x,this.ctx.lastPoint.y,V.x1,V.y1,V.x,V.y);X.push(Math.floor((G.y+ie)/de)+1),X.push(Math.floor((G.y+G.h+ie)/de)+1);break;case"bct":var q=ye(this.ctx.lastPoint.x,this.ctx.lastPoint.y,V.x1,V.y1,V.x2,V.y2,V.x,V.y);X.push(Math.floor((q.y+ie)/de)+1),X.push(Math.floor((q.y+q.h+ie)/de)+1);break;case"rect":X.push(Math.floor((V.y+ie)/de)+1),X.push(Math.floor((V.y+V.h+ie)/de)+1)}for(var ve=0;ve<X.length;ve+=1)for(;this.pdf.internal.getNumberOfPages()<X[ve];)T.call(this);return X},T=function(){var V=this.fillStyle,le=this.strokeStyle,de=this.font,X=this.lineCap,ie=this.lineWidth,G=this.lineJoin;this.pdf.addPage(),this.fillStyle=V,this.strokeStyle=le,this.font=de,this.lineCap=X,this.lineWidth=ie,this.lineJoin=G},H=function(V,le,de){for(var X=0;X<V.length;X++)switch(V[X].type){case"bct":V[X].x2+=le,V[X].y2+=de;case"qct":V[X].x1+=le,V[X].y1+=de;default:V[X].x+=le,V[X].y+=de}return V},O=function(V){return V.sort(function(le,de){return le-de})},Q=function(V,le){for(var de,X,ie=this.fillStyle,G=this.strokeStyle,q=this.lineCap,ve=this.lineWidth,Fe=Math.abs(ve*this.ctx.transform.scaleX),Qe=this.lineJoin,Ge=JSON.parse(JSON.stringify(this.path)),je=JSON.parse(JSON.stringify(this.path)),Me=[],Se=0;Se<je.length;Se++)if(je[Se].x!==void 0)for(var ft=L.call(this,je[Se]),jt=0;jt<ft.length;jt+=1)Me.indexOf(ft[jt])===-1&&Me.push(ft[jt]);for(var It=0;It<Me.length;It++)for(;this.pdf.internal.getNumberOfPages()<Me[It];)T.call(this);if(O(Me),this.autoPaging)for(var ut=Me[0],Rt=Me[Me.length-1],Ye=ut;Ye<Rt+1;Ye++){this.pdf.setPage(Ye),this.fillStyle=ie,this.strokeStyle=G,this.lineCap=q,this.lineWidth=Fe,this.lineJoin=Qe;var St=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Jt=Ye===1?this.posY+this.margin[0]:this.margin[0],mr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ar=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],bt=Ye===1?0:mr+(Ye-2)*ar;if(this.ctx.clip_path.length!==0){var Yt=this.path;de=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=H(de,this.posX+this.margin[3],-bt+Jt+this.ctx.prevPageLastElemOffset),Z.call(this,V,!0),this.path=Yt}if(X=JSON.parse(JSON.stringify(Ge)),this.path=H(X,this.posX+this.margin[3],-bt+Jt+this.ctx.prevPageLastElemOffset),le===!1||Ye===0){var vr=(Ye>ut||Ye<Rt)&&_.call(this);vr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],St,ar,null).clip().discardPath()),Z.call(this,V,le),vr&&this.pdf.restoreGraphicsState()}this.lineWidth=ve}else this.lineWidth=Fe,Z.call(this,V,le),this.lineWidth=ve;this.path=Ge},Z=function(V,le){if((V!=="stroke"||le||!M.call(this))&&(V==="stroke"||le||!C.call(this))){for(var de,X,ie=[],G=this.path,q=0;q<G.length;q++){var ve=G[q];switch(ve.type){case"begin":ie.push({begin:!0});break;case"close":ie.push({close:!0});break;case"mt":ie.push({start:ve,deltas:[],abs:[]});break;case"lt":var Fe=ie.length;if(G[q-1]&&!isNaN(G[q-1].x)&&(de=[ve.x-G[q-1].x,ve.y-G[q-1].y],Fe>0)){for(;Fe>=0;Fe--)if(ie[Fe-1].close!==!0&&ie[Fe-1].begin!==!0){ie[Fe-1].deltas.push(de),ie[Fe-1].abs.push(ve);break}}break;case"bct":de=[ve.x1-G[q-1].x,ve.y1-G[q-1].y,ve.x2-G[q-1].x,ve.y2-G[q-1].y,ve.x-G[q-1].x,ve.y-G[q-1].y],ie[ie.length-1].deltas.push(de);break;case"qct":var Qe=G[q-1].x+2/3*(ve.x1-G[q-1].x),Ge=G[q-1].y+2/3*(ve.y1-G[q-1].y),je=ve.x+2/3*(ve.x1-ve.x),Me=ve.y+2/3*(ve.y1-ve.y),Se=ve.x,ft=ve.y;de=[Qe-G[q-1].x,Ge-G[q-1].y,je-G[q-1].x,Me-G[q-1].y,Se-G[q-1].x,ft-G[q-1].y],ie[ie.length-1].deltas.push(de);break;case"arc":ie.push({deltas:[],abs:[],arc:!0}),Array.isArray(ie[ie.length-1].abs)&&ie[ie.length-1].abs.push(ve)}}X=le?null:V==="stroke"?"stroke":"fill";for(var jt=!1,It=0;It<ie.length;It++)if(ie[It].arc)for(var ut=ie[It].abs,Rt=0;Rt<ut.length;Rt++){var Ye=ut[Rt];Ye.type==="arc"?ue.call(this,Ye.x,Ye.y,Ye.radius,Ye.startAngle,Ye.endAngle,Ye.counterclockwise,void 0,le,!jt):ge.call(this,Ye.x,Ye.y),jt=!0}else if(ie[It].close===!0)this.pdf.internal.out("h"),jt=!1;else if(ie[It].begin!==!0){var St=ie[It].start.x,Jt=ie[It].start.y;fe.call(this,ie[It].deltas,St,Jt),jt=!0}X&&ae.call(this,X),le&&pe.call(this)}},ee=function(V){var le=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,de=le*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return V-de;case"top":return V+le-de;case"hanging":return V+le-2*de;case"middle":return V+le/2-de;default:return V}},se=function(V){return V+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};j.prototype.createLinearGradient=function(){var V=function(){};return V.colorStops=[],V.addColorStop=function(le,de){this.colorStops.push([le,de])},V.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},V.isCanvasGradient=!0,V},j.prototype.createPattern=function(){return this.createLinearGradient()},j.prototype.createRadialGradient=function(){return this.createLinearGradient()};var ue=function(V,le,de,X,ie,G,q,ve,Fe){for(var Qe=he.call(this,de,X,ie,G),Ge=0;Ge<Qe.length;Ge++){var je=Qe[Ge];Ge===0&&(Fe?z.call(this,je.x1+V,je.y1+le):ge.call(this,je.x1+V,je.y1+le)),ke.call(this,V,le,je.x2,je.y2,je.x3,je.y3,je.x4,je.y4)}ve?pe.call(this):ae.call(this,q)},ae=function(V){switch(V){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},pe=function(){this.pdf.clip(),this.pdf.discardPath()},z=function(V,le){this.pdf.internal.out(t(V)+" "+r(le)+" m")},J=function(V){var le;switch(V.align){case"right":case"end":le="right";break;case"center":le="center";break;default:le="left"}var de=this.pdf.getTextDimensions(V.text),X=ee.call(this,V.y),ie=se.call(this,X)-de.h,G=this.ctx.transform.applyToPoint(new u(V.x,X)),q=this.ctx.transform.decompose(),ve=new m;ve=(ve=(ve=ve.multiply(q.translate)).multiply(q.skew)).multiply(q.scale);for(var Fe,Qe,Ge,je=this.ctx.transform.applyToRectangle(new f(V.x,X,de.w,de.h)),Me=ve.applyToRectangle(new f(V.x,ie,de.w,de.h)),Se=L.call(this,Me),ft=[],jt=0;jt<Se.length;jt+=1)ft.indexOf(Se[jt])===-1&&ft.push(Se[jt]);if(O(ft),this.autoPaging)for(var It=ft[0],ut=ft[ft.length-1],Rt=It;Rt<ut+1;Rt++){this.pdf.setPage(Rt);var Ye=Rt===1?this.posY+this.margin[0]:this.margin[0],St=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Jt=this.pdf.internal.pageSize.height-this.margin[2],mr=Jt-this.margin[0],ar=this.pdf.internal.pageSize.width-this.margin[1],bt=ar-this.margin[3],Yt=Rt===1?0:St+(Rt-2)*mr;if(this.ctx.clip_path.length!==0){var vr=this.path;Fe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=H(Fe,this.posX+this.margin[3],-1*Yt+Ye),Z.call(this,"fill",!0),this.path=vr}var gr=H([JSON.parse(JSON.stringify(Me))],this.posX+this.margin[3],-Yt+Ye+this.ctx.prevPageLastElemOffset)[0];V.scale>=.01&&(Qe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Qe*V.scale),Ge=this.lineWidth,this.lineWidth=Ge*V.scale);var Mr=this.autoPaging!=="text";if(Mr||gr.y+gr.h<=Jt){if(Mr||gr.y>=Ye&&gr.x<=ar){var Ot=Mr?V.text:this.pdf.splitTextToSize(V.text,V.maxWidth||ar-gr.x)[0],ja=H([JSON.parse(JSON.stringify(je))],this.posX+this.margin[3],-Yt+Ye+this.ctx.prevPageLastElemOffset)[0],oa=Mr&&(Rt>It||Rt<ut)&&_.call(this);oa&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],bt,mr,null).clip().discardPath()),this.pdf.text(Ot,ja.x,ja.y,{angle:V.angle,align:le,renderingMode:V.renderingMode}),oa&&this.pdf.restoreGraphicsState()}}else gr.y<Jt&&(this.ctx.prevPageLastElemOffset+=Jt-gr.y);V.scale>=.01&&(this.pdf.setFontSize(Qe),this.lineWidth=Ge)}else V.scale>=.01&&(Qe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Qe*V.scale),Ge=this.lineWidth,this.lineWidth=Ge*V.scale),this.pdf.text(V.text,G.x+this.posX,G.y+this.posY,{angle:V.angle,align:le,renderingMode:V.renderingMode,maxWidth:V.maxWidth}),V.scale>=.01&&(this.pdf.setFontSize(Qe),this.lineWidth=Ge)},ge=function(V,le,de,X){de=de||0,X=X||0,this.pdf.internal.out(t(V+de)+" "+r(le+X)+" l")},fe=function(V,le,de){return this.pdf.lines(V,le,de,null,null)},ke=function(V,le,de,X,ie,G,q,ve){this.pdf.internal.out([a(s(de+V)),a(e(X+le)),a(s(ie+V)),a(e(G+le)),a(s(q+V)),a(e(ve+le)),"c"].join(" "))},he=function(V,le,de,X){for(var ie=2*Math.PI,G=Math.PI/2;le>de;)le-=ie;var q=Math.abs(de-le);q<ie&&X&&(q=ie-q);for(var ve=[],Fe=X?-1:1,Qe=le;q>1e-5;){var Ge=Qe+Fe*Math.min(q,G);ve.push(Ne.call(this,V,Qe,Ge)),q-=Math.abs(Ge-Qe),Qe=Ge}return ve},Ne=function(V,le,de){var X=(de-le)/2,ie=V*Math.cos(X),G=V*Math.sin(X),q=ie,ve=-G,Fe=q*q+ve*ve,Qe=Fe+q*ie+ve*G,Ge=4/3*(Math.sqrt(2*Fe*Qe)-Qe)/(q*G-ve*ie),je=q-Ge*ve,Me=ve+Ge*q,Se=je,ft=-Me,jt=X+le,It=Math.cos(jt),ut=Math.sin(jt);return{x1:V*Math.cos(le),y1:V*Math.sin(le),x2:je*It-Me*ut,y2:je*ut+Me*It,x3:Se*It-ft*ut,y3:Se*ut+ft*It,x4:V*Math.cos(de),y4:V*Math.sin(de)}},xe=function(V){return 180*V/Math.PI},we=function(V,le,de,X,ie,G){var q=V+.5*(de-V),ve=le+.5*(X-le),Fe=ie+.5*(de-ie),Qe=G+.5*(X-G),Ge=Math.min(V,ie,q,Fe),je=Math.max(V,ie,q,Fe),Me=Math.min(le,G,ve,Qe),Se=Math.max(le,G,ve,Qe);return new f(Ge,Me,je-Ge,Se-Me)},ye=function(V,le,de,X,ie,G,q,ve){var Fe,Qe,Ge,je,Me,Se,ft,jt,It,ut,Rt,Ye,St,Jt,mr=de-V,ar=X-le,bt=ie-de,Yt=G-X,vr=q-ie,gr=ve-G;for(Qe=0;Qe<41;Qe++)It=(ft=(Ge=V+(Fe=Qe/40)*mr)+Fe*((Me=de+Fe*bt)-Ge))+Fe*(Me+Fe*(ie+Fe*vr-Me)-ft),ut=(jt=(je=le+Fe*ar)+Fe*((Se=X+Fe*Yt)-je))+Fe*(Se+Fe*(G+Fe*gr-Se)-jt),Qe==0?(Rt=It,Ye=ut,St=It,Jt=ut):(Rt=Math.min(Rt,It),Ye=Math.min(Ye,ut),St=Math.max(St,It),Jt=Math.max(Jt,ut));return new f(Math.round(Rt),Math.round(Ye),Math.round(St-Rt),Math.round(Jt-Ye))},te=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var V,le,de=(V=this.ctx.lineDash,le=this.ctx.lineDashOffset,JSON.stringify({lineDash:V,lineDashOffset:le}));this.prevLineDash!==de&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=de)}}})(ua.API),(function(n){var a=function(u){var f,m,g,b,j,F,C,M,_,L;for(m=[],g=0,b=(u+=f="\0\0\0\0".slice(u.length%4||4)).length;b>g;g+=4)(j=(u.charCodeAt(g)<<24)+(u.charCodeAt(g+1)<<16)+(u.charCodeAt(g+2)<<8)+u.charCodeAt(g+3))!==0?(F=(j=((j=((j=((j=(j-(L=j%85))/85)-(_=j%85))/85)-(M=j%85))/85)-(C=j%85))/85)%85,m.push(F+33,C+33,M+33,_+33,L+33)):m.push(122);return(function(T,H){for(var O=H;O>0;O--)T.pop()})(m,f.length),String.fromCharCode.apply(String,m)+"~>"},t=function(u){var f,m,g,b,j,F=String,C="length",M=255,_="charCodeAt",L="slice",T="replace";for(u[L](-2),u=u[L](0,-2)[T](/\s/g,"")[T]("z","!!!!!"),g=[],b=0,j=(u+=f="uuuuu"[L](u[C]%5||5))[C];j>b;b+=5)m=52200625*(u[_](b)-33)+614125*(u[_](b+1)-33)+7225*(u[_](b+2)-33)+85*(u[_](b+3)-33)+(u[_](b+4)-33),g.push(M&m>>24,M&m>>16,M&m>>8,M&m);return(function(H,O){for(var Q=O;Q>0;Q--)H.pop()})(g,f[C]),F.fromCharCode.apply(F,g)},r=function(u){return u.split("").map(function(f){return("0"+f.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(u){var f=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((u=u.replace(/\s/g,"")).indexOf(">")!==-1&&(u=u.substr(0,u.indexOf(">"))),u.length%2&&(u+="0"),f.test(u)===!1)return"";for(var m="",g=0;g<u.length;g+=2)m+=String.fromCharCode("0x"+(u[g]+u[g+1]));return m},e=function(u){for(var f=new Uint8Array(u.length),m=u.length;m--;)f[m]=u.charCodeAt(m);return(f=cw(f)).reduce(function(g,b){return g+String.fromCharCode(b)},"")};n.processDataByFilters=function(u,f){var m=0,g=u||"",b=[];for(typeof(f=f||[])=="string"&&(f=[f]),m=0;m<f.length;m+=1)switch(f[m]){case"ASCII85Decode":case"/ASCII85Decode":g=t(g),b.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":g=a(g),b.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":g=s(g),b.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":g=r(g),b.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":g=e(g),b.push("/FlateDecode");break;default:throw new Error('The filter: "'+f[m]+'" is not implemented')}return{data:g,reverseChain:b.reverse().join(" ")}}})(ua.API),(function(n){n.loadFile=function(a,t,r){return(function(s,e,u){e=e!==!1,u=typeof u=="function"?u:function(){};var f=void 0;try{f=(function(m,g,b){var j=new XMLHttpRequest,F=0,C=function(M){var _=M.length,L=[],T=String.fromCharCode;for(F=0;F<_;F+=1)L.push(T(255&M.charCodeAt(F)));return L.join("")};if(j.open("GET",m,!g),j.overrideMimeType("text/plain; charset=x-user-defined"),g===!1&&(j.onload=function(){j.status===200?b(C(this.responseText)):b(void 0)}),j.send(null),g&&j.status===200)return C(j.responseText)})(s,e,u)}catch{}return f})(a,t,r)},n.loadImageFile=n.loadFile})(ua.API),(function(n){function a(){return(Ua.html2canvas?Promise.resolve(Ua.html2canvas):My(()=>Promise.resolve().then(()=>CK),void 0)).catch(function(f){return Promise.reject(new Error("Could not load html2canvas: "+f))}).then(function(f){return f.default?f.default:f})}function t(){return(Ua.DOMPurify?Promise.resolve(Ua.DOMPurify):My(()=>import("./purify.es-aGzT-_H7.js"),[])).catch(function(f){return Promise.reject(new Error("Could not load dompurify: "+f))}).then(function(f){return f.default?f.default:f})}var r=function(f){var m=wn(f);return m==="undefined"?"undefined":m==="string"||f instanceof String?"string":m==="number"||f instanceof Number?"number":m==="function"||f instanceof Function?"function":f&&f.constructor===Array?"array":f&&f.nodeType===1?"element":m==="object"?"object":"unknown"},s=function(f,m){var g=document.createElement(f);for(var b in m.className&&(g.className=m.className),m.innerHTML&&m.dompurify&&(g.innerHTML=m.dompurify.sanitize(m.innerHTML)),m.style)g.style[b]=m.style[b];return g},e=function f(m,g){for(var b=m.nodeType===3?document.createTextNode(m.nodeValue):m.cloneNode(!1),j=m.firstChild;j;j=j.nextSibling)g!==!0&&j.nodeType===1&&j.nodeName==="SCRIPT"||b.appendChild(f(j,g));return m.nodeType===1&&(m.nodeName==="CANVAS"?(b.width=m.width,b.height=m.height,b.getContext("2d").drawImage(m,0,0)):m.nodeName!=="TEXTAREA"&&m.nodeName!=="SELECT"||(b.value=m.value),b.addEventListener("load",function(){b.scrollTop=m.scrollTop,b.scrollLeft=m.scrollLeft},!0)),b},u=function f(m){var g=Object.assign(f.convert(Promise.resolve()),JSON.parse(JSON.stringify(f.template))),b=f.convert(Promise.resolve(),g);return(b=b.setProgress(1,f,1,[f])).set(m)};(u.prototype=Object.create(Promise.prototype)).constructor=u,u.convert=function(f,m){return f.__proto__=m||u.prototype,f},u.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},u.prototype.from=function(f,m){return this.then(function(){switch(m=m||(function(g){switch(r(g)){case"string":return"string";case"element":return g.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(f),m){case"string":return this.then(t).then(function(g){return this.set({src:s("div",{innerHTML:f,dompurify:g})})});case"element":return this.set({src:f});case"canvas":return this.set({canvas:f});case"img":return this.set({img:f});default:return this.error("Unknown source type.")}})},u.prototype.to=function(f){switch(f){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},u.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var f={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},m=e(this.prop.src,this.opt.html2canvas.javascriptEnabled);m.tagName==="BODY"&&(f.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:f}),this.prop.container.appendChild(m),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},u.prototype.toCanvas=function(){var f=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(f).then(a).then(function(m){var g=Object.assign({},this.opt.html2canvas);return delete g.onrendered,m(this.prop.container,g)}).then(function(m){(this.opt.html2canvas.onrendered||function(){})(m),this.prop.canvas=m,document.body.removeChild(this.prop.overlay)})},u.prototype.toContext2d=function(){var f=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(f).then(a).then(function(m){var g=this.opt.jsPDF,b=this.opt.fontFaces,j=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,F=Object.assign({async:!0,allowTaint:!0,scale:j,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete F.onrendered,g.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,g.context2d.posX=this.opt.x,g.context2d.posY=this.opt.y,g.context2d.margin=this.opt.margin,g.context2d.fontFaces=b,b)for(var C=0;C<b.length;++C){var M=b[C],_=M.src.find(function(L){return L.format==="truetype"});_&&g.addFont(_.url,M.ref.name,M.ref.style)}return F.windowHeight=F.windowHeight||0,F.windowHeight=F.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):F.windowHeight,g.context2d.save(!0),m(this.prop.container,F)}).then(function(m){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(m),this.prop.canvas=m,document.body.removeChild(this.prop.overlay)})},u.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var f=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=f})},u.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},u.prototype.output=function(f,m,g){return(g=g||"pdf").toLowerCase()==="img"||g.toLowerCase()==="image"?this.outputImg(f,m):this.outputPdf(f,m)},u.prototype.outputPdf=function(f,m){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(f,m)})},u.prototype.outputImg=function(f){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(f){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+f+'" is not supported.'}})},u.prototype.save=function(f){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(f?{filename:f}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},u.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},u.prototype.set=function(f){if(r(f)!=="object")return this;var m=Object.keys(f||{}).map(function(g){if(g in u.template.prop)return function(){this.prop[g]=f[g]};switch(g){case"margin":return this.setMargin.bind(this,f.margin);case"jsPDF":return function(){return this.opt.jsPDF=f.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,f.pageSize);default:return function(){this.opt[g]=f[g]}}},this);return this.then(function(){return this.thenList(m)})},u.prototype.get=function(f,m){return this.then(function(){var g=f in u.template.prop?this.prop[f]:this.opt[f];return m?m(g):g})},u.prototype.setMargin=function(f){return this.then(function(){switch(r(f)){case"number":f=[f,f,f,f];case"array":if(f.length===2&&(f=[f[0],f[1],f[0],f[1]]),f.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=f}).then(this.setPageSize)},u.prototype.setPageSize=function(f){function m(g,b){return Math.floor(g*b/72*96)}return this.then(function(){(f=f||ua.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(f.inner={width:f.width-this.opt.margin[1]-this.opt.margin[3],height:f.height-this.opt.margin[0]-this.opt.margin[2]},f.inner.px={width:m(f.inner.width,f.k),height:m(f.inner.height,f.k)},f.inner.ratio=f.inner.height/f.inner.width),this.prop.pageSize=f})},u.prototype.setProgress=function(f,m,g,b){return f!=null&&(this.progress.val=f),m!=null&&(this.progress.state=m),g!=null&&(this.progress.n=g),b!=null&&(this.progress.stack=b),this.progress.ratio=this.progress.val/this.progress.state,this},u.prototype.updateProgress=function(f,m,g,b){return this.setProgress(f?this.progress.val+f:null,m||null,g?this.progress.n+g:null,b?this.progress.stack.concat(b):null)},u.prototype.then=function(f,m){var g=this;return this.thenCore(f,m,function(b,j){return g.updateProgress(null,null,1,[b]),Promise.prototype.then.call(this,function(F){return g.updateProgress(null,b),F}).then(b,j).then(function(F){return g.updateProgress(1),F})})},u.prototype.thenCore=function(f,m,g){g=g||Promise.prototype.then;var b=this;f&&(f=f.bind(b)),m&&(m=m.bind(b));var j=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?b:u.convert(Object.assign({},b),Promise.prototype),F=g.call(j,f,m);return u.convert(F,b.__proto__)},u.prototype.thenExternal=function(f,m){return Promise.prototype.then.call(this,f,m)},u.prototype.thenList=function(f){var m=this;return f.forEach(function(g){m=m.thenCore(g)}),m},u.prototype.catch=function(f){f&&(f=f.bind(this));var m=Promise.prototype.catch.call(this,f);return u.convert(m,this)},u.prototype.catchExternal=function(f){return Promise.prototype.catch.call(this,f)},u.prototype.error=function(f){return this.then(function(){throw new Error(f)})},u.prototype.using=u.prototype.set,u.prototype.saveAs=u.prototype.save,u.prototype.export=u.prototype.output,u.prototype.run=u.prototype.then,ua.getPageSize=function(f,m,g){if(wn(f)==="object"){var b=f;f=b.orientation,m=b.unit||m,g=b.format||g}m=m||"mm",g=g||"a4",f=(""+(f||"P")).toLowerCase();var j,F=(""+g).toLowerCase(),C={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(m){case"pt":j=1;break;case"mm":j=72/25.4;break;case"cm":j=72/2.54;break;case"in":j=72;break;case"px":j=.75;break;case"pc":case"em":j=12;break;case"ex":j=6;break;default:throw"Invalid unit: "+m}var M,_=0,L=0;if(C.hasOwnProperty(F))_=C[F][1]/j,L=C[F][0]/j;else try{_=g[1],L=g[0]}catch{throw new Error("Invalid format: "+g)}if(f==="p"||f==="portrait")f="p",L>_&&(M=L,L=_,_=M);else{if(f!=="l"&&f!=="landscape")throw"Invalid orientation: "+f;f="l",_>L&&(M=L,L=_,_=M)}return{width:L,height:_,unit:m,k:j,orientation:f}},n.html=function(f,m){(m=m||{}).callback=m.callback||function(){},m.html2canvas=m.html2canvas||{},m.html2canvas.canvas=m.html2canvas.canvas||this.canvas,m.jsPDF=m.jsPDF||this,m.fontFaces=m.fontFaces?m.fontFaces.map(ev):null;var g=new u(m);return m.worker?g:g.from(f).doCallback()}})(ua.API),ua.API.addJS=function(n){return I3=n,this.internal.events.subscribe("postPutResources",function(){Lx=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Lx+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),M3=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+I3+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Lx!==void 0&&M3!==void 0&&this.internal.out("/Names <</JavaScript "+Lx+" 0 R>>")}),this},(function(n){var a;n.events.push(["postPutResources",function(){var t=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=t.outline.render().split(/\r\n/),e=0;e<s.length;e++){var u=s[e],f=r.exec(u);if(f!=null){var m=f[1];t.internal.newObjectDeferredBegin(m,!1)}t.internal.write(u)}if(this.outline.createNamedDestinations){var g=this.internal.pages.length,b=[];for(e=0;e<g;e++){var j=t.internal.newObject();b.push(j);var F=t.internal.getPageInfo(e+1);t.internal.write("<< /D["+F.objId+" 0 R /XYZ null null null]>> endobj")}var C=t.internal.newObject();for(t.internal.write("<< /Names [ "),e=0;e<b.length;e++)t.internal.write("(page_"+(e+1)+")"+b[e]+" 0 R");t.internal.write(" ] >>","endobj"),a=t.internal.newObject(),t.internal.write("<< /Dests "+C+" 0 R"),t.internal.write(">>","endobj")}}]),n.events.push(["putCatalog",function(){var t=this;t.outline.root.children.length>0&&(t.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&t.internal.write("/Names "+a+" 0 R"))}]),n.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(r,s,e){var u={title:s,options:e,children:[]};return r==null&&(r=this.root),r.children.push(u),u},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(r){r.id=t.internal.newObjectDeferred();for(var s=0;s<r.children.length;s++)this.genIds_r(r.children[s])},t.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},t.outline.renderItems=function(r){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,e=0;e<r.children.length;e++){var u=r.children[e];this.objStart(u),this.line("/Title "+this.makeString(u.title)),this.line("/Parent "+this.makeRef(r)),e>0&&this.line("/Prev "+this.makeRef(r.children[e-1])),e<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[e+1])),u.children.length>0&&(this.line("/First "+this.makeRef(u.children[0])),this.line("/Last "+this.makeRef(u.children[u.children.length-1])));var f=this.count=this.count_r({count:0},u);if(f>0&&this.line("/Count "+f),u.options&&u.options.pageNumber){var m=t.internal.getPageInfo(u.options.pageNumber);this.line("/Dest ["+m.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var g=0;g<r.children.length;g++)this.renderItems(r.children[g])},t.outline.line=function(r){this.ctx.val+=r+`\r
`},t.outline.makeRef=function(r){return r.id+" 0 R"},t.outline.makeString=function(r){return"("+t.internal.pdfEscape(r)+")"},t.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(r,s){for(var e=0;e<s.children.length;e++)r.count++,this.count_r(r,s.children[e]);return r.count}}])})(ua.API),(function(n){var a=[192,193,194,195,196,197,198,199];n.processJPEG=function(t,r,s,e,u,f){var m,g=this.decode.DCT_DECODE,b=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=u||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,m=(function(j){for(var F,C=256*j.charCodeAt(4)+j.charCodeAt(5),M=j.length,_={width:0,height:0,numcomponents:1},L=4;L<M;L+=2){if(L+=C,a.indexOf(j.charCodeAt(L+1))!==-1){F=256*j.charCodeAt(L+5)+j.charCodeAt(L+6),_={width:256*j.charCodeAt(L+7)+j.charCodeAt(L+8),height:F,numcomponents:j.charCodeAt(L+9)};break}C=256*j.charCodeAt(L+2)+j.charCodeAt(L+3)}return _})(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t),m.numcomponents){case 1:f=this.color_spaces.DEVICE_GRAY;break;case 4:f=this.color_spaces.DEVICE_CMYK;break;case 3:f=this.color_spaces.DEVICE_RGB}b={data:t,width:m.width,height:m.height,colorSpace:f,bitsPerComponent:8,filter:g,index:r,alias:s}}return b}})(ua.API),ua.API.processPNG=function(n,a,t,r){if(this.__addimage__.isArrayBuffer(n)&&(n=new Uint8Array(n)),this.__addimage__.isArrayBufferView(n)){var s,e=I9(n,{checkCrc:!0}),u=e.width,f=e.height,m=e.channels,g=e.palette,b=e.depth;s=g&&m===1?(function(ue){for(var ae=ue.width,pe=ue.height,z=ue.data,J=ue.palette,ge=ue.depth,fe=!1,ke=[],he=[],Ne=void 0,xe=!1,we=0,ye=0;ye<J.length;ye++){var te=P4(J[ye],4),V=te[0],le=te[1],de=te[2],X=te[3];ke.push(V,le,de),X!=null&&(X===0?(we++,he.length<1&&he.push(ye)):X<255&&(xe=!0))}if(xe||we>1){fe=!0,he=void 0;var ie=ae*pe;Ne=new Uint8Array(ie);for(var G=new DataView(z.buffer),q=0;q<ie;q++){var ve=rv(G,q,ge),Fe=P4(J[ve],4)[3];Ne[q]=Fe}}else we===0&&(he=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:fe?8:void 0,colorBytes:z,alphaBytes:Ne,needSMask:fe,palette:ke,mask:he}})(e):m===2||m===4?(function(ue){for(var ae=ue.data,pe=ue.width,z=ue.height,J=ue.channels,ge=ue.depth,fe=J===2?"DeviceGray":"DeviceRGB",ke=J-1,he=pe*z,Ne=ke,xe=he*Ne,we=1*he,ye=Math.ceil(xe*ge/8),te=Math.ceil(we*ge/8),V=new Uint8Array(ye),le=new Uint8Array(te),de=new DataView(ae.buffer),X=new DataView(V.buffer),ie=new DataView(le.buffer),G=!1,q=0;q<he;q++){for(var ve=q*J,Fe=0;Fe<Ne;Fe++)V3(X,rv(de,ve+Fe,ge),q*Ne+Fe,ge);var Qe=rv(de,ve+Ne,ge);Qe<(1<<ge)-1&&(G=!0),V3(ie,Qe,1*q,ge)}return{colorSpace:fe,colorsPerPixel:ke,sMaskBitsPerComponent:G?ge:void 0,colorBytes:V,alphaBytes:le,needSMask:G}})(e):(function(ue){var ae=ue.data,pe=ue.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:pe,colorsPerPixel:pe==="DeviceGray"?1:3,colorBytes:ae instanceof Uint16Array?(function(z){for(var J=z.length,ge=new Uint8Array(2*J),fe=new DataView(ge.buffer,ge.byteOffset,ge.byteLength),ke=0;ke<J;ke++)fe.setUint16(2*ke,z[ke],!1);return ge})(ae):ae,needSMask:!1}})(e);var j,F,C,M=s,_=M.colorSpace,L=M.colorsPerPixel,T=M.sMaskBitsPerComponent,H=M.colorBytes,O=M.alphaBytes,Q=M.needSMask,Z=M.palette,ee=M.mask,se=null;return r!==ua.API.image_compression.NONE&&typeof cw=="function"?(se=(function(ue){var ae;switch(ue){case ua.API.image_compression.FAST:ae=11;break;case ua.API.image_compression.MEDIUM:ae=13;break;case ua.API.image_compression.SLOW:ae=14;break;default:ae=12}return ae})(r),j=this.decode.FLATE_DECODE,F="/Predictor ".concat(se," /Colors ").concat(L," /BitsPerComponent ").concat(b," /Columns ").concat(u),n=P3(H,Math.ceil(u*L*b/8),L,b,r),Q&&(C=P3(O,Math.ceil(u*T/8),1,T,r))):(j=void 0,F=void 0,n=H,Q&&(C=O)),(this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n))&&(n=this.__addimage__.arrayBufferToBinaryString(n)),(C&&this.__addimage__.isArrayBuffer(C)||this.__addimage__.isArrayBufferView(C))&&(C=this.__addimage__.arrayBufferToBinaryString(C)),{alias:t,data:n,index:a,filter:j,decodeParameters:F,transparency:ee,palette:Z,sMask:C,predictor:se,width:u,height:f,bitsPerComponent:b,sMaskBitsPerComponent:T,colorSpace:_}}},(function(n){n.processGIF89A=function(a,t,r,s){var e=new s_(a),u=e.width,f=e.height,m=[];e.decodeAndBlitFrameRGBA(0,m);var g={data:m,width:u,height:f},b=new av(100).encode(g,100);return n.processJPEG.call(this,b,t,r,s)},n.processGIF87A=n.processGIF89A})(ua.API),fd.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var n=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(n);for(var a=0;a<n;a++){var t=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),e=this.datav.getUint8(this.pos++,!0);this.palette[a]={red:s,green:r,blue:t,quad:e}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},fd.prototype.parseBGR=function(){this.pos=this.offset;try{var n="bit"+this.bitPP,a=this.width*this.height*4;this.data=new Uint8Array(a),this[n]()}catch(t){Rn.log("bit decode error:"+t)}},fd.prototype.bit1=function(){var n,a=Math.ceil(this.width/8),t=a%4;for(n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,s=0;s<a;s++)for(var e=this.datav.getUint8(this.pos++,!0),u=r*this.width*4+8*s*4,f=0;f<8&&8*s+f<this.width;f++){var m=this.palette[e>>7-f&1];this.data[u+4*f]=m.blue,this.data[u+4*f+1]=m.green,this.data[u+4*f+2]=m.red,this.data[u+4*f+3]=255}t!==0&&(this.pos+=4-t)}},fd.prototype.bit4=function(){for(var n=Math.ceil(this.width/2),a=n%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,s=0;s<n;s++){var e=this.datav.getUint8(this.pos++,!0),u=r*this.width*4+2*s*4,f=e>>4,m=15&e,g=this.palette[f];if(this.data[u]=g.blue,this.data[u+1]=g.green,this.data[u+2]=g.red,this.data[u+3]=255,2*s+1>=this.width)break;g=this.palette[m],this.data[u+4]=g.blue,this.data[u+4+1]=g.green,this.data[u+4+2]=g.red,this.data[u+4+3]=255}a!==0&&(this.pos+=4-a)}},fd.prototype.bit8=function(){for(var n=this.width%4,a=this.height-1;a>=0;a--){for(var t=this.bottom_up?a:this.height-1-a,r=0;r<this.width;r++){var s=this.datav.getUint8(this.pos++,!0),e=t*this.width*4+4*r;if(s<this.palette.length){var u=this.palette[s];this.data[e]=u.red,this.data[e+1]=u.green,this.data[e+2]=u.blue,this.data[e+3]=255}else this.data[e]=255,this.data[e+1]=255,this.data[e+2]=255,this.data[e+3]=255}n!==0&&(this.pos+=4-n)}},fd.prototype.bit15=function(){for(var n=this.width%3,a=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,s=0;s<this.width;s++){var e=this.datav.getUint16(this.pos,!0);this.pos+=2;var u=(e&a)/a*255|0,f=(e>>5&a)/a*255|0,m=(e>>10&a)/a*255|0,g=e>>15?255:0,b=r*this.width*4+4*s;this.data[b]=m,this.data[b+1]=f,this.data[b+2]=u,this.data[b+3]=g}this.pos+=n}},fd.prototype.bit16=function(){for(var n=this.width%3,a=parseInt("11111",2),t=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var s=this.bottom_up?r:this.height-1-r,e=0;e<this.width;e++){var u=this.datav.getUint16(this.pos,!0);this.pos+=2;var f=(u&a)/a*255|0,m=(u>>5&t)/t*255|0,g=(u>>11)/a*255|0,b=s*this.width*4+4*e;this.data[b]=g,this.data[b+1]=m,this.data[b+2]=f,this.data[b+3]=255}this.pos+=n}},fd.prototype.bit24=function(){for(var n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),e=this.datav.getUint8(this.pos++,!0),u=a*this.width*4+4*t;this.data[u]=e,this.data[u+1]=s,this.data[u+2]=r,this.data[u+3]=255}this.pos+=this.width%4}},fd.prototype.bit32=function(){for(var n=this.height-1;n>=0;n--)for(var a=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),e=this.datav.getUint8(this.pos++,!0),u=this.datav.getUint8(this.pos++,!0),f=a*this.width*4+4*t;this.data[f]=e,this.data[f+1]=s,this.data[f+2]=r,this.data[f+3]=u}},fd.prototype.getData=function(){return this.data},(function(n){n.processBMP=function(a,t,r,s){var e=new fd(a,!1),u=e.width,f=e.height,m={data:e.getData(),width:u,height:f},g=new av(100).encode(m,100);return n.processJPEG.call(this,g,t,r,s)}})(ua.API),W3.prototype.getData=function(){return this.data},(function(n){n.processWEBP=function(a,t,r,s){var e=new W3(a),u=e.width,f=e.height,m={data:e.getData(),width:u,height:f},g=new av(100).encode(m,100);return n.processJPEG.call(this,g,t,r,s)}})(ua.API),ua.API.processRGBA=function(n,a,t){for(var r=n.data,s=r.length,e=new Uint8Array(s/4*3),u=new Uint8Array(s/4),f=0,m=0,g=0;g<s;g+=4){var b=r[g],j=r[g+1],F=r[g+2],C=r[g+3];e[f++]=b,e[f++]=j,e[f++]=F,u[m++]=C}var M=this.__addimage__.arrayBufferToBinaryString(e);return{alpha:this.__addimage__.arrayBufferToBinaryString(u),data:M,index:a,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:n.width,height:n.height}},ua.API.setLanguage=function(n){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[n]!==void 0&&(this.internal.languageSettings.languageCode=n,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Fm=ua.API,Ux=Fm.getCharWidthsArray=function(n,a){var t,r,s=(a=a||{}).font||this.internal.getFont(),e=a.fontSize||this.internal.getFontSize(),u=a.charSpace||this.internal.getCharSpace(),f=a.widths?a.widths:s.metadata.Unicode.widths,m=f.fof?f.fof:1,g=a.kerning?a.kerning:s.metadata.Unicode.kerning,b=g.fof?g.fof:1,j=a.doKerning!==!1,F=0,C=n.length,M=0,_=f[0]||m,L=[];for(t=0;t<C;t++)r=n.charCodeAt(t),typeof s.metadata.widthOfString=="function"?L.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(r))+u*(1e3/e)||0)/1e3):(F=j&&wn(g[r])==="object"&&!isNaN(parseInt(g[r][M],10))?g[r][M]/b:0,L.push((f[r]||_)/m+F)),M=r;return L},O3=Fm.getStringUnitWidth=function(n,a){var t=(a=a||{}).fontSize||this.internal.getFontSize(),r=a.font||this.internal.getFont(),s=a.charSpace||this.internal.getCharSpace();return Fm.processArabic&&(n=Fm.processArabic(n)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(n,t,s)/t:Ux.apply(this,arguments).reduce(function(e,u){return e+u},0)},Q3=function(n,a,t,r){for(var s=[],e=0,u=n.length,f=0;e!==u&&f+a[e]<t;)f+=a[e],e++;s.push(n.slice(0,e));var m=e;for(f=0;e!==u;)f+a[e]>r&&(s.push(n.slice(m,e)),f=0,m=e),f+=a[e],e++;return m!==e&&s.push(n.slice(m,e)),s},R3=function(n,a,t){t||(t={});var r,s,e,u,f,m,g,b=[],j=[b],F=t.textIndent||0,C=0,M=0,_=n.split(" "),L=Ux.apply(this,[" ",t])[0];if(m=t.lineIndent===-1?_[0].length+2:t.lineIndent||0){var T=Array(m).join(" "),H=[];_.map(function(Q){(Q=Q.split(/\s*\n/)).length>1?H=H.concat(Q.map(function(Z,ee){return(ee&&Z.length?`
`:"")+Z})):H.push(Q[0])}),_=H,m=O3.apply(this,[T,t])}for(e=0,u=_.length;e<u;e++){var O=0;if(r=_[e],m&&r[0]==`
`&&(r=r.substr(1),O=1),F+C+(M=(s=Ux.apply(this,[r,t])).reduce(function(Q,Z){return Q+Z},0))>a||O){if(M>a){for(f=Q3.apply(this,[r,s,a-(F+C),a]),b.push(f.shift()),b=[f.pop()];f.length;)j.push([f.shift()]);M=s.slice(r.length-(b[0]?b[0].length:0)).reduce(function(Q,Z){return Q+Z},0)}else b=[r];j.push(b),F=M+m,C=L}else b.push(r),F+=C+M,C=L}return g=m?function(Q,Z){return(Z?T:"")+Q.join(" ")}:function(Q){return Q.join(" ")},j.map(g)},Fm.splitTextToSize=function(n,a,t){var r,s=(t=t||{}).fontSize||this.internal.getFontSize(),e=(function(b){if(b.widths&&b.kerning)return{widths:b.widths,kerning:b.kerning};var j=this.internal.getFont(b.fontName,b.fontStyle),F="Unicode";return j.metadata[F]?{widths:j.metadata[F].widths||{0:1},kerning:j.metadata[F].kerning||{}}:{font:j.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);r=Array.isArray(n)?n:String(n).split(/\r?\n/);var u=1*this.internal.scaleFactor*a/s;e.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/s:0,e.lineIndent=t.lineIndent;var f,m,g=[];for(f=0,m=r.length;f<m;f++)g=g.concat(R3.apply(this,[r[f],u,e]));return g},(function(n){n.__fontmetrics__=n.__fontmetrics__||{};for(var a="0123456789abcdef",t="klmnopqrstuvwxyz",r={},s={},e=0;e<16;e++)r[t[e]]=a[e],s[a[e]]=t[e];var u=function(F){return"0x"+parseInt(F,10).toString(16)},f=n.__fontmetrics__.compress=function(F){var C,M,_,L,T=["{"];for(var H in F){if(C=F[H],isNaN(parseInt(H,10))?M="'"+H+"'":(H=parseInt(H,10),M=(M=u(H).slice(2)).slice(0,-1)+s[M.slice(-1)]),typeof C=="number")C<0?(_=u(C).slice(3),L="-"):(_=u(C).slice(2),L=""),_=L+_.slice(0,-1)+s[_.slice(-1)];else{if(wn(C)!=="object")throw new Error("Don't know what to do with value type "+wn(C)+".");_=f(C)}T.push(M+_)}return T.push("}"),T.join("")},m=n.__fontmetrics__.uncompress=function(F){if(typeof F!="string")throw new Error("Invalid argument passed to uncompress.");for(var C,M,_,L,T={},H=1,O=T,Q=[],Z="",ee="",se=F.length-1,ue=1;ue<se;ue+=1)(L=F[ue])=="'"?C?(_=C.join(""),C=void 0):C=[]:C?C.push(L):L=="{"?(Q.push([O,_]),O={},_=void 0):L=="}"?((M=Q.pop())[0][M[1]]=O,_=void 0,O=M[0]):L=="-"?H=-1:_===void 0?r.hasOwnProperty(L)?(Z+=r[L],_=parseInt(Z,16)*H,H=1,Z=""):Z+=L:r.hasOwnProperty(L)?(ee+=r[L],O[_]=parseInt(ee,16)*H,H=1,_=void 0,ee=""):ee+=L;return T},g={codePages:["WinAnsiEncoding"],WinAnsiEncoding:m("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},b={Unicode:{Courier:g,"Courier-Bold":g,"Courier-BoldOblique":g,"Courier-Oblique":g,Helvetica:g,"Helvetica-Bold":g,"Helvetica-BoldOblique":g,"Helvetica-Oblique":g,"Times-Roman":g,"Times-Bold":g,"Times-BoldItalic":g,"Times-Italic":g}},j={Unicode:{"Courier-Oblique":m("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":m("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":m("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:m("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":m("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":m("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:m("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:m("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":m("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:m("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":m("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":m("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":m("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":m("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};n.events.push(["addFont",function(F){var C=F.font,M=j.Unicode[C.postScriptName];M&&(C.metadata.Unicode={},C.metadata.Unicode.widths=M.widths,C.metadata.Unicode.kerning=M.kerning);var _=b.Unicode[C.postScriptName];_&&(C.metadata.Unicode.encoding=_,C.encoding=_.codePages[0])}])})(ua.API),(function(n){var a=function(t){for(var r=t.length,s=new Uint8Array(r),e=0;e<r;e++)s[e]=t.charCodeAt(e);return s};n.API.events.push(["addFont",function(t){var r=void 0,s=t.font,e=t.instance;if(!s.isStandardFont){if(e===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(r=e.existsFileInVFS(s.postScriptName)===!1?e.loadFile(s.postScriptName):e.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(u,f){f=/^\x00\x01\x00\x00/.test(f)?a(f):a(C2(f)),u.metadata=n.API.TTFFont.open(f),u.metadata.Unicode=u.metadata.Unicode||{encoding:{},kerning:{},widths:[]},u.metadata.glyIdsUsed=[0]})(s,r)}}])})(ua),ua.API.addSvgAsImage=function(n,a,t,r,s,e,u,f){if(isNaN(a)||isNaN(t))throw Rn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(r)||isNaN(s))throw Rn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var m=document.createElement("canvas");m.width=r,m.height=s;var g=m.getContext("2d");g.fillStyle="#fff",g.fillRect(0,0,m.width,m.height);var b={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},j=this;return(Ua.canvg?Promise.resolve(Ua.canvg):My(()=>import("./index.es-BSKe2ZS6.js"),[])).catch(function(F){return Promise.reject(new Error("Could not load canvg: "+F))}).then(function(F){return F.default?F.default:F}).then(function(F){return F.fromString(g,n,b)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(F){return F.render(b)}).then(function(){j.addImage(m.toDataURL("image/jpeg",1),a,t,r,s,u,f)})},ua.API.putTotalPages=function(n){var a,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(a=new RegExp(n,"g"),t=this.internal.getNumberOfPages()):(a=new RegExp(this.pdfEscape16(n,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var s=0;s<this.internal.pages[r].length;s++)this.internal.pages[r][s]=this.internal.pages[r][s].replace(a,t);return this},ua.API.viewerPreferences=function(n,a){var t;n=n||{},a=a||!1;var r,s,e,u={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},f=Object.keys(u),m=[],g=0,b=0,j=0;function F(M,_){var L,T=!1;for(L=0;L<M.length;L+=1)M[L]===_&&(T=!0);return T}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(u)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,n==="reset"||a===!0){var C=f.length;for(j=0;j<C;j+=1)t[f[j]].value=t[f[j]].defaultValue,t[f[j]].explicitSet=!1}if(wn(n)==="object"){for(s in n)if(e=n[s],F(f,s)&&e!==void 0){if(t[s].type==="boolean"&&typeof e=="boolean")t[s].value=e;else if(t[s].type==="name"&&F(t[s].valueSet,e))t[s].value=e;else if(t[s].type==="integer"&&Number.isInteger(e))t[s].value=e;else if(t[s].type==="array"){for(g=0;g<e.length;g+=1)if(r=!0,e[g].length===1&&typeof e[g][0]=="number")m.push(String(e[g]-1));else if(e[g].length>1){for(b=0;b<e[g].length;b+=1)typeof e[g][b]!="number"&&(r=!1);r===!0&&m.push([e[g][0]-1,e[g][1]-1].join(" "))}t[s].value="["+m.join(" ")+"]"}else t[s].value=t[s].defaultValue;t[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var M,_=[];for(M in t)t[M].explicitSet===!0&&(t[M].type==="name"?_.push("/"+M+" /"+t[M].value):_.push("/"+M+" "+t[M].value));_.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+_.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},(function(n){var a=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),e=unescape(encodeURIComponent(r)),u=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),f=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),m=unescape(encodeURIComponent("</x:xmpmeta>")),g=e.length+u.length+f.length+s.length+m.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+g+" >>"),this.internal.write("stream"),this.internal.write(s+e+u+f+m),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};n.addMetadata=function(r,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",a)),this}})(ua.API),(function(n){var a=n.API,t=a.pdfEscape16=function(e,u){for(var f,m=u.metadata.Unicode.widths,g=["","0","00","000","0000"],b=[""],j=0,F=e.length;j<F;++j){if(f=u.metadata.characterToGlyph(e.charCodeAt(j)),u.metadata.glyIdsUsed.push(f),u.metadata.toUnicode[f]=e.charCodeAt(j),m.indexOf(f)==-1&&(m.push(f),m.push([parseInt(u.metadata.widthOfGlyph(f),10)])),f=="0")return b.join("");f=f.toString(16),b.push(g[4-f.length],f)}return b.join("")},r=function(e){var u,f,m,g,b,j,F;for(b=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,m=[],j=0,F=(f=Object.keys(e).sort(function(C,M){return C-M})).length;j<F;j++)u=f[j],m.length>=100&&(b+=`
`+m.length+` beginbfchar
`+m.join(`
`)+`
endbfchar`,m=[]),e[u]!==void 0&&e[u]!==null&&typeof e[u].toString=="function"&&(g=("0000"+e[u].toString(16)).slice(-4),u=("0000"+(+u).toString(16)).slice(-4),m.push("<"+u+"><"+g+">"));return m.length&&(b+=`
`+m.length+` beginbfchar
`+m.join(`
`)+`
endbfchar
`),b+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};a.events.push(["putFont",function(e){(function(u){var f=u.font,m=u.out,g=u.newObject,b=u.putStream;if(f.metadata instanceof n.API.TTFFont&&f.encoding==="Identity-H"){for(var j=f.metadata.Unicode.widths,F=f.metadata.subset.encode(f.metadata.glyIdsUsed,1),C="",M=0;M<F.length;M++)C+=String.fromCharCode(F[M]);var _=g();b({data:C,addLength1:!0,objectId:_}),m("endobj");var L=g();b({data:r(f.metadata.toUnicode),addLength1:!0,objectId:L}),m("endobj");var T=g();m("<<"),m("/Type /FontDescriptor"),m("/FontName /"+Im(f.fontName)),m("/FontFile2 "+_+" 0 R"),m("/FontBBox "+n.API.PDFObject.convert(f.metadata.bbox)),m("/Flags "+f.metadata.flags),m("/StemV "+f.metadata.stemV),m("/ItalicAngle "+f.metadata.italicAngle),m("/Ascent "+f.metadata.ascender),m("/Descent "+f.metadata.decender),m("/CapHeight "+f.metadata.capHeight),m(">>"),m("endobj");var H=g();m("<<"),m("/Type /Font"),m("/BaseFont /"+Im(f.fontName)),m("/FontDescriptor "+T+" 0 R"),m("/W "+n.API.PDFObject.convert(j)),m("/CIDToGIDMap /Identity"),m("/DW 1000"),m("/Subtype /CIDFontType2"),m("/CIDSystemInfo"),m("<<"),m("/Supplement 0"),m("/Registry (Adobe)"),m("/Ordering ("+f.encoding+")"),m(">>"),m(">>"),m("endobj"),f.objectNumber=g(),m("<<"),m("/Type /Font"),m("/Subtype /Type0"),m("/ToUnicode "+L+" 0 R"),m("/BaseFont /"+Im(f.fontName)),m("/Encoding /"+f.encoding),m("/DescendantFonts ["+H+" 0 R]"),m(">>"),m("endobj"),f.isAlreadyPutted=!0}})(e)}]),a.events.push(["putFont",function(e){(function(u){var f=u.font,m=u.out,g=u.newObject,b=u.putStream;if(f.metadata instanceof n.API.TTFFont&&f.encoding==="WinAnsiEncoding"){for(var j=f.metadata.rawData,F="",C=0;C<j.length;C++)F+=String.fromCharCode(j[C]);var M=g();b({data:F,addLength1:!0,objectId:M}),m("endobj");var _=g();b({data:r(f.metadata.toUnicode),addLength1:!0,objectId:_}),m("endobj");var L=g();m("<<"),m("/Descent "+f.metadata.decender),m("/CapHeight "+f.metadata.capHeight),m("/StemV "+f.metadata.stemV),m("/Type /FontDescriptor"),m("/FontFile2 "+M+" 0 R"),m("/Flags 96"),m("/FontBBox "+n.API.PDFObject.convert(f.metadata.bbox)),m("/FontName /"+Im(f.fontName)),m("/ItalicAngle "+f.metadata.italicAngle),m("/Ascent "+f.metadata.ascender),m(">>"),m("endobj"),f.objectNumber=g();for(var T=0;T<f.metadata.hmtx.widths.length;T++)f.metadata.hmtx.widths[T]=parseInt(f.metadata.hmtx.widths[T]*(1e3/f.metadata.head.unitsPerEm));m("<</Subtype/TrueType/Type/Font/ToUnicode "+_+" 0 R/BaseFont/"+Im(f.fontName)+"/FontDescriptor "+L+" 0 R/Encoding/"+f.encoding+" /FirstChar 29 /LastChar 255 /Widths "+n.API.PDFObject.convert(f.metadata.hmtx.widths)+">>"),m("endobj"),f.isAlreadyPutted=!0}})(e)}]);var s=function(e){var u,f=e.text||"",m=e.x,g=e.y,b=e.options||{},j=e.mutex||{},F=j.pdfEscape,C=j.activeFontKey,M=j.fonts,_=C,L="",T=0,H="",O=M[_].encoding;if(M[_].encoding!=="Identity-H")return{text:f,x:m,y:g,options:b,mutex:j};for(H=f,_=C,Array.isArray(f)&&(H=f[0]),T=0;T<H.length;T+=1)M[_].metadata.hasOwnProperty("cmap")&&(u=M[_].metadata.cmap.unicode.codeMap[H[T].charCodeAt(0)]),u||H[T].charCodeAt(0)<256&&M[_].metadata.hasOwnProperty("Unicode")?L+=H[T]:L+="";var Q="";return parseInt(_.slice(1))<14||O==="WinAnsiEncoding"?Q=F(L,_).split("").map(function(Z){return Z.charCodeAt(0).toString(16)}).join(""):O==="Identity-H"&&(Q=t(L,M[_])),j.isHex=!0,{text:Q,x:m,y:g,options:b,mutex:j}};a.events.push(["postProcessText",function(e){var u=e.text||"",f=[],m={text:u,x:e.x,y:e.y,options:e.options,mutex:e.mutex};if(Array.isArray(u)){var g=0;for(g=0;g<u.length;g+=1)Array.isArray(u[g])&&u[g].length===3?f.push([s(Object.assign({},m,{text:u[g][0]})).text,u[g][1],u[g][2]]):f.push(s(Object.assign({},m,{text:u[g]})).text);e.text=f}else e.text=s(Object.assign({},m,{text:u})).text}])})(ua),(function(n){var a=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};n.existsFileInVFS=function(t){return a.call(this),this.internal.vFS[t]!==void 0},n.addFileToVFS=function(t,r){return a.call(this),this.internal.vFS[t]=r,this},n.getFileFromVFS=function(t){return a.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}})(ua.API),(function(n){n.__bidiEngine__=n.prototype.__bidiEngine__=function(r){var s,e,u,f,m,g,b,j=a,F=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],C=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],M={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},_={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},L=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],T=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),H=!1,O=0;this.__bidiEngine__={};var Q=function(z){var J=z.charCodeAt(),ge=J>>8,fe=_[ge];return fe!==void 0?j[256*fe+(255&J)]:ge===252||ge===253?"AL":T.test(ge)?"L":ge===8?"R":"N"},Z=function(z){for(var J,ge=0;ge<z.length;ge++){if((J=Q(z.charAt(ge)))==="L")return!1;if(J==="R")return!0}return!1},ee=function(z,J,ge,fe){var ke,he,Ne,xe,we=J[fe];switch(we){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":H=!1;break;case"N":case"AN":break;case"EN":H&&(we="AN");break;case"AL":H=!0,we="R";break;case"WS":case"BN":we="N";break;case"CS":fe<1||fe+1>=J.length||(ke=ge[fe-1])!=="EN"&&ke!=="AN"||(he=J[fe+1])!=="EN"&&he!=="AN"?we="N":H&&(he="AN"),we=he===ke?he:"N";break;case"ES":we=(ke=fe>0?ge[fe-1]:"B")==="EN"&&fe+1<J.length&&J[fe+1]==="EN"?"EN":"N";break;case"ET":if(fe>0&&ge[fe-1]==="EN"){we="EN";break}if(H){we="N";break}for(Ne=fe+1,xe=J.length;Ne<xe&&J[Ne]==="ET";)Ne++;we=Ne<xe&&J[Ne]==="EN"?"EN":"N";break;case"NSM":if(u&&!f){for(xe=J.length,Ne=fe+1;Ne<xe&&J[Ne]==="NSM";)Ne++;if(Ne<xe){var ye=z[fe],te=ye>=1425&&ye<=2303||ye===64286;if(ke=J[Ne],te&&(ke==="R"||ke==="AL")){we="R";break}}}we=fe<1||(ke=J[fe-1])==="B"?"N":ge[fe-1];break;case"B":H=!1,s=!0,we=O;break;case"S":e=!0,we="N"}return we},se=function(z,J,ge){var fe=z.split("");return ge&&ue(fe,ge,{hiLevel:O}),fe.reverse(),J&&J.reverse(),fe.join("")},ue=function(z,J,ge){var fe,ke,he,Ne,xe,we=-1,ye=z.length,te=0,V=[],le=O?C:F,de=[];for(H=!1,s=!1,e=!1,ke=0;ke<ye;ke++)de[ke]=Q(z[ke]);for(he=0;he<ye;he++){if(xe=te,V[he]=ee(z,de,V,he),fe=240&(te=le[xe][M[V[he]]]),te&=15,J[he]=Ne=le[te][5],fe>0)if(fe===16){for(ke=we;ke<he;ke++)J[ke]=1;we=-1}else we=-1;if(le[te][6])we===-1&&(we=he);else if(we>-1){for(ke=we;ke<he;ke++)J[ke]=Ne;we=-1}de[he]==="B"&&(J[he]=0),ge.hiLevel|=Ne}e&&(function(X,ie,G){for(var q=0;q<G;q++)if(X[q]==="S"){ie[q]=O;for(var ve=q-1;ve>=0&&X[ve]==="WS";ve--)ie[ve]=O}})(de,J,ye)},ae=function(z,J,ge,fe,ke){if(!(ke.hiLevel<z)){if(z===1&&O===1&&!s)return J.reverse(),void(ge&&ge.reverse());for(var he,Ne,xe,we,ye=J.length,te=0;te<ye;){if(fe[te]>=z){for(xe=te+1;xe<ye&&fe[xe]>=z;)xe++;for(we=te,Ne=xe-1;we<Ne;we++,Ne--)he=J[we],J[we]=J[Ne],J[Ne]=he,ge&&(he=ge[we],ge[we]=ge[Ne],ge[Ne]=he);te=xe}te++}}},pe=function(z,J,ge){var fe=z.split(""),ke={hiLevel:O};return ge||(ge=[]),ue(fe,ge,ke),(function(he,Ne,xe){if(xe.hiLevel!==0&&b)for(var we,ye=0;ye<he.length;ye++)Ne[ye]===1&&(we=L.indexOf(he[ye]))>=0&&(he[ye]=L[we+1])})(fe,ge,ke),ae(2,fe,J,ge,ke),ae(1,fe,J,ge,ke),fe.join("")};return this.__bidiEngine__.doBidiReorder=function(z,J,ge){if((function(ke,he){if(he)for(var Ne=0;Ne<ke.length;Ne++)he[Ne]=Ne;f===void 0&&(f=Z(ke)),g===void 0&&(g=Z(ke))})(z,J),u||!m||g)if(u&&m&&f^g)O=f?1:0,z=se(z,J,ge);else if(!u&&m&&g)O=f?1:0,z=pe(z,J,ge),z=se(z,J);else if(!u||f||m||g){if(u&&!m&&f^g)z=se(z,J),f?(O=0,z=pe(z,J,ge)):(O=1,z=pe(z,J,ge),z=se(z,J));else if(u&&f&&!m&&g)O=1,z=pe(z,J,ge),z=se(z,J);else if(!u&&!m&&f^g){var fe=b;f?(O=1,z=pe(z,J,ge),O=0,b=!1,z=pe(z,J,ge),b=fe):(O=0,z=pe(z,J,ge),z=se(z,J),O=1,b=!1,z=pe(z,J,ge),b=fe,z=se(z,J))}}else O=0,z=pe(z,J,ge);else O=f?1:0,z=pe(z,J,ge);return z},this.__bidiEngine__.setOptions=function(z){z&&(u=z.isInputVisual,m=z.isOutputVisual,f=z.isInputRtl,g=z.isOutputRtl,b=z.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var a=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new n.__bidiEngine__({isInputVisual:!0});n.API.events.push(["postProcessText",function(r){var s=r.text;r.x,r.y;var e=r.options||{};r.mutex,e.lang;var u=[];if(e.isInputVisual=typeof e.isInputVisual!="boolean"||e.isInputVisual,t.setOptions(e),Object.prototype.toString.call(s)==="[object Array]"){var f=0;for(u=[],f=0;f<s.length;f+=1)Object.prototype.toString.call(s[f])==="[object Array]"?u.push([t.doBidiReorder(s[f][0]),s[f][1],s[f][2]]):u.push([t.doBidiReorder(s[f])]);r.text=u}else r.text=t.doBidiReorder(s);t.setOptions({isInputVisual:!0})}])})(ua),ua.API.TTFFont=(function(){function n(a){var t;if(this.rawData=a,t=this.contents=new u0(a),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new b_(this),this.registerTTF()}return n.open=function(a){return new n(a)},n.prototype.parse=function(){return this.directory=new n_(this.contents),this.head=new o_(this),this.name=new u_(this),this.cmap=new Zj(this),this.toUnicode={},this.hhea=new l_(this),this.maxp=new f_(this),this.hmtx=new h_(this),this.post=new A_(this),this.os2=new c_(this),this.loca=new x_(this),this.glyf=new m_(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},n.prototype.registerTTF=function(){var a,t,r,s,e;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var u,f,m,g;for(g=[],u=0,f=(m=this.bbox).length;u<f;u++)a=m[u],g.push(Math.round(a*this.scaleFactor));return g}).call(this),this.stemV=0,this.post.exists?(r=255&(s=this.post.italic_angle),32768&(t=s>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(e=this.familyClass)===1||e===2||e===3||e===4||e===5||e===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},n.prototype.characterToGlyph=function(a){var t;return((t=this.cmap.unicode)!=null?t.codeMap[a]:void 0)||0},n.prototype.widthOfGlyph=function(a){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(a).advance*t},n.prototype.widthOfString=function(a,t,r){var s,e,u,f;for(u=0,e=0,f=(a=""+a).length;0<=f?e<f:e>f;e=0<=f?++e:--e)s=a.charCodeAt(e),u+=this.widthOfGlyph(this.characterToGlyph(s))+r*(1e3/t)||0;return u*(t/1e3)},n.prototype.lineHeight=function(a,t){var r;return t==null&&(t=!1),r=t?this.lineGap:0,(this.ascender+r-this.decender)/1e3*a},n})();var Fd,u0=(function(){function n(a){this.data=a??[],this.pos=0,this.length=this.data.length}return n.prototype.readByte=function(){return this.data[this.pos++]},n.prototype.writeByte=function(a){return this.data[this.pos++]=a},n.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},n.prototype.writeUInt32=function(a){return this.writeByte(a>>>24&255),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a)},n.prototype.readInt32=function(){var a;return(a=this.readUInt32())>=2147483648?a-4294967296:a},n.prototype.writeInt32=function(a){return a<0&&(a+=4294967296),this.writeUInt32(a)},n.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},n.prototype.writeUInt16=function(a){return this.writeByte(a>>8&255),this.writeByte(255&a)},n.prototype.readInt16=function(){var a;return(a=this.readUInt16())>=32768?a-65536:a},n.prototype.writeInt16=function(a){return a<0&&(a+=65536),this.writeUInt16(a)},n.prototype.readString=function(a){var t,r;for(r=[],t=0;0<=a?t<a:t>a;t=0<=a?++t:--t)r[t]=String.fromCharCode(this.readByte());return r.join("")},n.prototype.writeString=function(a){var t,r,s;for(s=[],t=0,r=a.length;0<=r?t<r:t>r;t=0<=r?++t:--t)s.push(this.writeByte(a.charCodeAt(t)));return s},n.prototype.readShort=function(){return this.readInt16()},n.prototype.writeShort=function(a){return this.writeInt16(a)},n.prototype.readLongLong=function(){var a,t,r,s,e,u,f,m;return a=this.readByte(),t=this.readByte(),r=this.readByte(),s=this.readByte(),e=this.readByte(),u=this.readByte(),f=this.readByte(),m=this.readByte(),128&a?-1*(72057594037927940*(255^a)+281474976710656*(255^t)+1099511627776*(255^r)+4294967296*(255^s)+16777216*(255^e)+65536*(255^u)+256*(255^f)+(255^m)+1):72057594037927940*a+281474976710656*t+1099511627776*r+4294967296*s+16777216*e+65536*u+256*f+m},n.prototype.writeLongLong=function(a){var t,r;return t=Math.floor(a/4294967296),r=4294967295&a,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},n.prototype.readInt=function(){return this.readInt32()},n.prototype.writeInt=function(a){return this.writeInt32(a)},n.prototype.read=function(a){var t,r;for(t=[],r=0;0<=a?r<a:r>a;r=0<=a?++r:--r)t.push(this.readByte());return t},n.prototype.write=function(a){var t,r,s,e;for(e=[],r=0,s=a.length;r<s;r++)t=a[r],e.push(this.writeByte(t));return e},n})(),n_=(function(){var n;function a(t){var r,s,e;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},s=0,e=this.tableCount;0<=e?s<e:s>e;s=0<=e?++s:--s)r={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[r.tag]=r}return a.prototype.encode=function(t){var r,s,e,u,f,m,g,b,j,F,C,M,_;for(_ in C=Object.keys(t).length,m=Math.log(2),j=16*Math.floor(Math.log(C)/m),u=Math.floor(j/m),b=16*C-j,(s=new u0).writeInt(this.scalarType),s.writeShort(C),s.writeShort(j),s.writeShort(u),s.writeShort(b),e=16*C,g=s.pos+e,f=null,M=[],t)for(F=t[_],s.writeString(_),s.writeInt(n(F)),s.writeInt(g),s.writeInt(F.length),M=M.concat(F),_==="head"&&(f=g),g+=F.length;g%4;)M.push(0),g++;return s.write(M),r=2981146554-n(s.data),s.pos=f+8,s.writeUInt32(r),s.data},n=function(t){var r,s,e,u;for(t=e8.call(t);t.length%4;)t.push(0);for(e=new u0(t),s=0,r=0,u=t.length;r<u;r=r+=4)s+=e.readUInt32();return 4294967295&s},a})(),i_={}.hasOwnProperty,du=function(n,a){for(var t in a)i_.call(a,t)&&(n[t]=a[t]);function r(){this.constructor=n}return r.prototype=a.prototype,n.prototype=new r,n.__super__=a.prototype,n};Fd=(function(){function n(a){var t;this.file=a,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return n.prototype.parse=function(){},n.prototype.encode=function(){},n.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},n})();var o_=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return du(n,Fd),n.prototype.tag="head",n.prototype.parse=function(a){return a.pos=this.offset,this.version=a.readInt(),this.revision=a.readInt(),this.checkSumAdjustment=a.readInt(),this.magicNumber=a.readInt(),this.flags=a.readShort(),this.unitsPerEm=a.readShort(),this.created=a.readLongLong(),this.modified=a.readLongLong(),this.xMin=a.readShort(),this.yMin=a.readShort(),this.xMax=a.readShort(),this.yMax=a.readShort(),this.macStyle=a.readShort(),this.lowestRecPPEM=a.readShort(),this.fontDirectionHint=a.readShort(),this.indexToLocFormat=a.readShort(),this.glyphDataFormat=a.readShort()},n.prototype.encode=function(a){var t;return(t=new u0).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(a),t.writeShort(this.glyphDataFormat),t.data},n})(),$3=(function(){function n(a,t){var r,s,e,u,f,m,g,b,j,F,C,M,_,L,T,H,O;switch(this.platformID=a.readUInt16(),this.encodingID=a.readShort(),this.offset=t+a.readInt(),j=a.pos,a.pos=this.offset,this.format=a.readUInt16(),this.length=a.readUInt16(),this.language=a.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(m=0;m<256;++m)this.codeMap[m]=a.readByte();break;case 4:for(C=a.readUInt16(),F=C/2,a.pos+=6,e=(function(){var Q,Z;for(Z=[],m=Q=0;0<=F?Q<F:Q>F;m=0<=F?++Q:--Q)Z.push(a.readUInt16());return Z})(),a.pos+=2,_=(function(){var Q,Z;for(Z=[],m=Q=0;0<=F?Q<F:Q>F;m=0<=F?++Q:--Q)Z.push(a.readUInt16());return Z})(),g=(function(){var Q,Z;for(Z=[],m=Q=0;0<=F?Q<F:Q>F;m=0<=F?++Q:--Q)Z.push(a.readUInt16());return Z})(),b=(function(){var Q,Z;for(Z=[],m=Q=0;0<=F?Q<F:Q>F;m=0<=F?++Q:--Q)Z.push(a.readUInt16());return Z})(),s=(this.length-a.pos+this.offset)/2,f=(function(){var Q,Z;for(Z=[],m=Q=0;0<=s?Q<s:Q>s;m=0<=s?++Q:--Q)Z.push(a.readUInt16());return Z})(),m=T=0,O=e.length;T<O;m=++T)for(L=e[m],r=H=M=_[m];M<=L?H<=L:H>=L;r=M<=L?++H:--H)b[m]===0?u=r+g[m]:(u=f[b[m]/2+(r-M)-(F-m)]||0)!==0&&(u+=g[m]),this.codeMap[r]=65535&u}a.pos=j}return n.encode=function(a,t){var r,s,e,u,f,m,g,b,j,F,C,M,_,L,T,H,O,Q,Z,ee,se,ue,ae,pe,z,J,ge,fe,ke,he,Ne,xe,we,ye,te,V,le,de,X,ie,G,q,ve,Fe,Qe,Ge;switch(fe=new u0,u=Object.keys(a).sort(function(je,Me){return je-Me}),t){case"macroman":for(_=0,L=(function(){var je=[];for(M=0;M<256;++M)je.push(0);return je})(),H={0:0},e={},ke=0,we=u.length;ke<we;ke++)H[ve=a[s=u[ke]]]==null&&(H[ve]=++_),e[s]={old:a[s],new:H[a[s]]},L[s]=H[a[s]];return fe.writeUInt16(1),fe.writeUInt16(0),fe.writeUInt32(12),fe.writeUInt16(0),fe.writeUInt16(262),fe.writeUInt16(0),fe.write(L),{charMap:e,subtable:fe.data,maxGlyphID:_+1};case"unicode":for(J=[],j=[],O=0,H={},r={},T=g=null,he=0,ye=u.length;he<ye;he++)H[Z=a[s=u[he]]]==null&&(H[Z]=++O),r[s]={old:Z,new:H[Z]},f=H[Z]-s,T!=null&&f===g||(T&&j.push(T),J.push(s),g=f),T=s;for(T&&j.push(T),j.push(65535),J.push(65535),pe=2*(ae=J.length),ue=2*Math.pow(Math.log(ae)/Math.LN2,2),F=Math.log(ue/2)/Math.LN2,se=2*ae-ue,m=[],ee=[],C=[],M=Ne=0,te=J.length;Ne<te;M=++Ne){if(z=J[M],b=j[M],z===65535){m.push(0),ee.push(0);break}if(z-(ge=r[z].new)>=32768)for(m.push(0),ee.push(2*(C.length+ae-M)),s=xe=z;z<=b?xe<=b:xe>=b;s=z<=b?++xe:--xe)C.push(r[s].new);else m.push(ge-z),ee.push(0)}for(fe.writeUInt16(3),fe.writeUInt16(1),fe.writeUInt32(12),fe.writeUInt16(4),fe.writeUInt16(16+8*ae+2*C.length),fe.writeUInt16(0),fe.writeUInt16(pe),fe.writeUInt16(ue),fe.writeUInt16(F),fe.writeUInt16(se),G=0,V=j.length;G<V;G++)s=j[G],fe.writeUInt16(s);for(fe.writeUInt16(0),q=0,le=J.length;q<le;q++)s=J[q],fe.writeUInt16(s);for(Fe=0,de=m.length;Fe<de;Fe++)f=m[Fe],fe.writeUInt16(f);for(Qe=0,X=ee.length;Qe<X;Qe++)Q=ee[Qe],fe.writeUInt16(Q);for(Ge=0,ie=C.length;Ge<ie;Ge++)_=C[Ge],fe.writeUInt16(_);return{charMap:r,subtable:fe.data,maxGlyphID:O+1}}},n})(),Zj=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return du(n,Fd),n.prototype.tag="cmap",n.prototype.parse=function(a){var t,r,s;for(a.pos=this.offset,this.version=a.readUInt16(),s=a.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=s?r<s:r>s;r=0<=s?++r:--r)t=new $3(a,this.offset),this.tables.push(t),t.isUnicode&&this.unicode==null&&(this.unicode=t);return!0},n.encode=function(a,t){var r,s;return t==null&&(t="macroman"),r=$3.encode(a,t),(s=new u0).writeUInt16(0),s.writeUInt16(1),r.table=s.data.concat(r.subtable),r},n})(),l_=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return du(n,Fd),n.prototype.tag="hhea",n.prototype.parse=function(a){return a.pos=this.offset,this.version=a.readInt(),this.ascender=a.readShort(),this.decender=a.readShort(),this.lineGap=a.readShort(),this.advanceWidthMax=a.readShort(),this.minLeftSideBearing=a.readShort(),this.minRightSideBearing=a.readShort(),this.xMaxExtent=a.readShort(),this.caretSlopeRise=a.readShort(),this.caretSlopeRun=a.readShort(),this.caretOffset=a.readShort(),a.pos+=8,this.metricDataFormat=a.readShort(),this.numberOfMetrics=a.readUInt16()},n})(),c_=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return du(n,Fd),n.prototype.tag="OS/2",n.prototype.parse=function(a){if(a.pos=this.offset,this.version=a.readUInt16(),this.averageCharWidth=a.readShort(),this.weightClass=a.readUInt16(),this.widthClass=a.readUInt16(),this.type=a.readShort(),this.ySubscriptXSize=a.readShort(),this.ySubscriptYSize=a.readShort(),this.ySubscriptXOffset=a.readShort(),this.ySubscriptYOffset=a.readShort(),this.ySuperscriptXSize=a.readShort(),this.ySuperscriptYSize=a.readShort(),this.ySuperscriptXOffset=a.readShort(),this.ySuperscriptYOffset=a.readShort(),this.yStrikeoutSize=a.readShort(),this.yStrikeoutPosition=a.readShort(),this.familyClass=a.readShort(),this.panose=(function(){var t,r;for(r=[],t=0;t<10;++t)r.push(a.readByte());return r})(),this.charRange=(function(){var t,r;for(r=[],t=0;t<4;++t)r.push(a.readInt());return r})(),this.vendorID=a.readString(4),this.selection=a.readShort(),this.firstCharIndex=a.readShort(),this.lastCharIndex=a.readShort(),this.version>0&&(this.ascent=a.readShort(),this.descent=a.readShort(),this.lineGap=a.readShort(),this.winAscent=a.readShort(),this.winDescent=a.readShort(),this.codePageRange=(function(){var t,r;for(r=[],t=0;t<2;t=++t)r.push(a.readInt());return r})(),this.version>1))return this.xHeight=a.readShort(),this.capHeight=a.readShort(),this.defaultChar=a.readShort(),this.breakChar=a.readShort(),this.maxContext=a.readShort()},n})(),A_=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return du(n,Fd),n.prototype.tag="post",n.prototype.parse=function(a){var t,r,s;switch(a.pos=this.offset,this.format=a.readInt(),this.italicAngle=a.readInt(),this.underlinePosition=a.readShort(),this.underlineThickness=a.readShort(),this.isFixedPitch=a.readInt(),this.minMemType42=a.readInt(),this.maxMemType42=a.readInt(),this.minMemType1=a.readInt(),this.maxMemType1=a.readInt(),this.format){case 65536:case 196608:break;case 131072:var e;for(r=a.readUInt16(),this.glyphNameIndex=[],e=0;0<=r?e<r:e>r;e=0<=r?++e:--e)this.glyphNameIndex.push(a.readUInt16());for(this.names=[],s=[];a.pos<this.offset+this.length;)t=a.readByte(),s.push(this.names.push(a.readString(t)));return s;case 151552:return r=a.readUInt16(),this.offsets=a.read(r);case 262144:return this.map=(function(){var u,f,m;for(m=[],e=u=0,f=this.file.maxp.numGlyphs;0<=f?u<f:u>f;e=0<=f?++u:--u)m.push(a.readUInt32());return m}).call(this)}},n})(),d_=function(n,a){this.raw=n,this.length=n.length,this.platformID=a.platformID,this.encodingID=a.encodingID,this.languageID=a.languageID},u_=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return du(n,Fd),n.prototype.tag="name",n.prototype.parse=function(a){var t,r,s,e,u,f,m,g,b,j,F;for(a.pos=this.offset,a.readShort(),t=a.readShort(),f=a.readShort(),r=[],e=0;0<=t?e<t:e>t;e=0<=t?++e:--e)r.push({platformID:a.readShort(),encodingID:a.readShort(),languageID:a.readShort(),nameID:a.readShort(),length:a.readShort(),offset:this.offset+f+a.readShort()});for(m={},e=b=0,j=r.length;b<j;e=++b)s=r[e],a.pos=s.offset,g=a.readString(s.length),u=new d_(g,s),m[F=s.nameID]==null&&(m[F]=[]),m[s.nameID].push(u);this.strings=m,this.copyright=m[0],this.fontFamily=m[1],this.fontSubfamily=m[2],this.uniqueSubfamily=m[3],this.fontName=m[4],this.version=m[5];try{this.postscriptName=m[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=m[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=m[7],this.manufacturer=m[8],this.designer=m[9],this.description=m[10],this.vendorUrl=m[11],this.designerUrl=m[12],this.license=m[13],this.licenseUrl=m[14],this.preferredFamily=m[15],this.preferredSubfamily=m[17],this.compatibleFull=m[18],this.sampleText=m[19]},n})(),f_=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return du(n,Fd),n.prototype.tag="maxp",n.prototype.parse=function(a){return a.pos=this.offset,this.version=a.readInt(),this.numGlyphs=a.readUInt16(),this.maxPoints=a.readUInt16(),this.maxContours=a.readUInt16(),this.maxCompositePoints=a.readUInt16(),this.maxComponentContours=a.readUInt16(),this.maxZones=a.readUInt16(),this.maxTwilightPoints=a.readUInt16(),this.maxStorage=a.readUInt16(),this.maxFunctionDefs=a.readUInt16(),this.maxInstructionDefs=a.readUInt16(),this.maxStackElements=a.readUInt16(),this.maxSizeOfInstructions=a.readUInt16(),this.maxComponentElements=a.readUInt16(),this.maxComponentDepth=a.readUInt16()},n})(),h_=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return du(n,Fd),n.prototype.tag="hmtx",n.prototype.parse=function(a){var t,r,s,e,u,f,m;for(a.pos=this.offset,this.metrics=[],t=0,f=this.file.hhea.numberOfMetrics;0<=f?t<f:t>f;t=0<=f?++t:--t)this.metrics.push({advance:a.readUInt16(),lsb:a.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var g,b;for(b=[],t=g=0;0<=s?g<s:g>s;t=0<=s?++g:--g)b.push(a.readInt16());return b})(),this.widths=(function(){var g,b,j,F;for(F=[],g=0,b=(j=this.metrics).length;g<b;g++)e=j[g],F.push(e.advance);return F}).call(this),r=this.widths[this.widths.length-1],m=[],t=u=0;0<=s?u<s:u>s;t=0<=s?++u:--u)m.push(this.widths.push(r));return m},n.prototype.forGlyph=function(a){return a in this.metrics?this.metrics[a]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[a-this.metrics.length]}},n})(),e8=[].slice,m_=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return du(n,Fd),n.prototype.tag="glyf",n.prototype.parse=function(){return this.cache={}},n.prototype.glyphFor=function(a){var t,r,s,e,u,f,m,g,b,j;return a in this.cache?this.cache[a]:(e=this.file.loca,t=this.file.contents,r=e.indexOf(a),(s=e.lengthOf(a))===0?this.cache[a]=null:(t.pos=this.offset+r,u=(f=new u0(t.read(s))).readShort(),g=f.readShort(),j=f.readShort(),m=f.readShort(),b=f.readShort(),this.cache[a]=u===-1?new g_(f,g,j,m,b):new p_(f,u,g,j,m,b),this.cache[a]))},n.prototype.encode=function(a,t,r){var s,e,u,f,m;for(u=[],e=[],f=0,m=t.length;f<m;f++)s=a[t[f]],e.push(u.length),s&&(u=u.concat(s.encode(r)));return e.push(u.length),{table:u,offsets:e}},n})(),p_=(function(){function n(a,t,r,s,e,u){this.raw=a,this.numberOfContours=t,this.xMin=r,this.yMin=s,this.xMax=e,this.yMax=u,this.compound=!1}return n.prototype.encode=function(){return this.raw.data},n})(),g_=(function(){function n(a,t,r,s,e){var u,f;for(this.raw=a,this.xMin=t,this.yMin=r,this.xMax=s,this.yMax=e,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],u=this.raw;f=u.readShort(),this.glyphOffsets.push(u.pos),this.glyphIDs.push(u.readUInt16()),32&f;)u.pos+=1&f?4:2,128&f?u.pos+=8:64&f?u.pos+=4:8&f&&(u.pos+=2)}return n.prototype.encode=function(){var a,t,r;for(t=new u0(e8.call(this.raw.data)),a=0,r=this.glyphIDs.length;a<r;++a)t.pos=this.glyphOffsets[a];return t.data},n})(),x_=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return du(n,Fd),n.prototype.tag="loca",n.prototype.parse=function(a){var t,r;return a.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=t===0?(function(){var s,e;for(e=[],r=0,s=this.length;r<s;r+=2)e.push(2*a.readUInt16());return e}).call(this):(function(){var s,e;for(e=[],r=0,s=this.length;r<s;r+=4)e.push(a.readUInt32());return e}).call(this)},n.prototype.indexOf=function(a){return this.offsets[a]},n.prototype.lengthOf=function(a){return this.offsets[a+1]-this.offsets[a]},n.prototype.encode=function(a,t){for(var r=new Uint32Array(this.offsets.length),s=0,e=0,u=0;u<r.length;++u)if(r[u]=s,e<t.length&&t[e]==u){++e,r[u]=s;var f=this.offsets[u],m=this.offsets[u+1]-f;m>0&&(s+=m)}for(var g=new Array(4*r.length),b=0;b<r.length;++b)g[4*b+3]=255&r[b],g[4*b+2]=(65280&r[b])>>8,g[4*b+1]=(16711680&r[b])>>16,g[4*b]=(4278190080&r[b])>>24;return g},n})(),b_=(function(){function n(a){this.font=a,this.subset={},this.unicodes={},this.next=33}return n.prototype.generateCmap=function(){var a,t,r,s,e;for(t in s=this.font.cmap.tables[0].codeMap,a={},e=this.subset)r=e[t],a[t]=s[r];return a},n.prototype.glyphsFor=function(a){var t,r,s,e,u,f,m;for(s={},u=0,f=a.length;u<f;u++)s[e=a[u]]=this.font.glyf.glyphFor(e);for(e in t=[],s)(r=s[e])!=null&&r.compound&&t.push.apply(t,r.glyphIDs);if(t.length>0)for(e in m=this.glyphsFor(t))r=m[e],s[e]=r;return s},n.prototype.encode=function(a,t){var r,s,e,u,f,m,g,b,j,F,C,M,_,L,T;for(s in r=Zj.encode(this.generateCmap(),"unicode"),u=this.glyphsFor(a),C={0:0},T=r.charMap)C[(m=T[s]).old]=m.new;for(M in F=r.maxGlyphID,u)M in C||(C[M]=F++);return b=(function(H){var O,Q;for(O in Q={},H)Q[H[O]]=O;return Q})(C),j=Object.keys(b).sort(function(H,O){return H-O}),_=(function(){var H,O,Q;for(Q=[],H=0,O=j.length;H<O;H++)f=j[H],Q.push(b[f]);return Q})(),e=this.font.glyf.encode(u,_,C),g=this.font.loca.encode(e.offsets,_),L={cmap:this.font.cmap.raw(),glyf:e.table,loca:g,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(L["OS/2"]=this.font.os2.raw()),this.font.directory.encode(L)},n})();ua.API.PDFObject=(function(){var n;function a(){}return n=function(t,r){return(Array(r+1).join("0")+t).slice(-r)},a.convert=function(t){var r,s,e,u;if(Array.isArray(t))return"["+(function(){var f,m,g;for(g=[],f=0,m=t.length;f<m;f++)r=t[f],g.push(a.convert(r));return g})().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t?.isString)return"("+t+")";if(t instanceof Date)return"(D:"+n(t.getUTCFullYear(),4)+n(t.getUTCMonth(),2)+n(t.getUTCDate(),2)+n(t.getUTCHours(),2)+n(t.getUTCMinutes(),2)+n(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(s in e=["<<"],t)u=t[s],e.push("/"+s+" "+a.convert(u));return e.push(">>"),e.join(`
`)}return""+t},a})();const t8=({marksheetsData:n,studentsData:a,classesData:t,schoolInfo:r})=>{if(!n||n.length===0)return null;const s={schoolName:r?.schoolName||r?.name||"School Management System",schoolAddress:r?.schoolAddress||r?.address||"123 Education Street, Learning City",schoolPhone:r?.schoolPhone||r?.phone||"+1 (555) 123-4567"},e=n.reduce((u,f)=>{const m=f.studentId;return u[m]||(u[m]=[]),u[m].push(f),u},{});return i.jsxs("div",{className:"w-full mx-auto bg-white font-sans bulk-marksheet-print-view",children:[i.jsx("div",{className:"print-container",children:Object.entries(e).map(([u,f],m)=>{const g=a?.find(C=>C.id===u),b=g?`${g.firstName} ${g.lastName}`:f[0]?.studentName||"N/A",j=f[0]?.class||"N/A",F=f[0]?.section||"N/A";return i.jsxs("div",{className:"student-marksheets",children:[i.jsxs("div",{className:"text-center border-b border-gray-300 pb-2 mb-3",children:[i.jsxs("div",{className:"flex items-center justify-center mb-1",children:[i.jsx(fA,{className:"text-blue-600 text-lg mr-2"}),i.jsx("h1",{className:"text-lg font-bold text-gray-800",children:s.schoolName})]}),i.jsx("p",{className:"text-gray-600 text-xs mb-1",children:s.schoolAddress}),i.jsxs("p",{className:"text-gray-600 text-xs",children:["Phone: ",s.schoolPhone]})]}),i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("div",{className:"mr-4",children:g?.photo?i.jsx("img",{src:g.photo,alt:"Student",className:"w-20 h-20 rounded object-cover border border-gray-300"}):i.jsx("div",{className:"w-20 h-20 rounded bg-gray-200 border border-gray-300 flex items-center justify-center",children:i.jsx(Pi,{className:"text-gray-500 text-2xl"})})}),i.jsxs("div",{children:[i.jsx("div",{className:"font-bold text-gray-800 text-xl",children:b}),i.jsxs("div",{className:"text-gray-600",children:["ID: ",u||"N/A"]}),i.jsxs("div",{className:"text-gray-600",children:["Class: ",j," - ",F]}),i.jsxs("div",{className:"text-gray-600",children:["Total Exams: ",f.length]})]})]}),i.jsx("div",{className:"space-y-4",children:f.map((C,M)=>i.jsxs("div",{className:"marksheets-section border rounded p-3",children:[i.jsxs("div",{className:"font-bold text-gray-800 text-sm mb-3 border-b border-gray-300 pb-2 flex justify-between items-center",children:[i.jsxs("span",{children:[C.examType," - ",C.year]}),i.jsxs("span",{className:"text-xs text-gray-500",children:["Generated: ",new Date().toLocaleDateString()]})]}),i.jsx("div",{className:"mb-3",children:i.jsxs("div",{className:"border rounded",children:[i.jsxs("div",{className:"grid grid-cols-4 gap-0 bg-gray-100 border-b text-sm font-medium p-3",children:[i.jsx("span",{children:"Subject"}),i.jsx("span",{className:"text-center",children:"Obtained"}),i.jsx("span",{className:"text-center",children:"Total"}),i.jsx("span",{className:"text-center",children:"Grade"})]}),i.jsx("div",{className:"divide-y divide-gray-200",children:C.marks&&C.marks.map((_,L)=>i.jsxs("div",{className:"grid grid-cols-4 gap-0 p-3",children:[i.jsx("span",{children:_.subjectName}),i.jsx("span",{className:"text-center",children:_.marksObtained}),i.jsx("span",{className:"text-center",children:_.totalMarks}),i.jsx("span",{className:"text-center",children:i.jsx("span",{className:"bg-blue-100 text-blue-800 px-1 py-0.5 rounded text-xs",children:_.grade})})]},L))})]})}),i.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[i.jsxs("div",{className:"bg-gray-50 p-2 rounded text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Obtained"}),i.jsx("div",{className:"font-bold",children:C.totalObtained})]}),i.jsxs("div",{className:"bg-gray-50 p-2 rounded text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total"}),i.jsx("div",{className:"font-bold",children:C.totalMarks})]}),i.jsxs("div",{className:"bg-gray-50 p-2 rounded text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"%"}),i.jsxs("div",{className:"font-bold",children:[C.percentage,"%"]})]}),i.jsxs("div",{className:"bg-gray-50 p-2 rounded text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Grade"}),i.jsx("div",{className:"font-bold",children:i.jsx("span",{className:"bg-green-100 text-green-800 px-1 py-0.5 rounded text-xs",children:C.overallGrade})})]})]})]},`${u}-${M}`))})]},u)})}),i.jsx("style",{children:`
        @media print {
          body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          }
          
          .print-container {
            padding: 10px;
            max-width: 100%;
          }
          
          .student-marksheets {
            break-inside: avoid;
            padding: 20px;
            box-sizing: border-box;
            page-break-inside: avoid;
            margin-bottom: 0;
            /* Fit 2 student marksheets per page - top and bottom */
            height: 45vh;
          }
          
          .marksheets-section {
            break-inside: avoid;
            page-break-inside: avoid;
          }
          
          @page {
            size: A4;
            margin: 0.3in;
          }
          
          .bulk-marksheet-print-view {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: visible;
          }
          
          /* Enhanced print styling */
          .flex { display: flex; }
          .items-center { align-items: center; }
          .font-bold { font-weight: 700; }
          .text-gray-800 { color: #1f2937; }
          .text-gray-600 { color: #4b5563; }
          .text-xl { font-size: 1.25rem; }
          .text-lg { font-size: 1.125rem; }
          .text-sm { font-size: 0.875rem; }
          .text-xs { font-size: 0.75rem; }
          .mb-4 { margin-bottom: 1rem; }
          .mb-3 { margin-bottom: 0.75rem; }
          .mr-4 { margin-right: 1rem; }
          .w-20 { width: 5rem; }
          .h-20 { height: 5rem; }
          .rounded { border-radius: 0.25rem; }
          .object-cover { object-fit: cover; }
          .border { border: 1px solid #d1d5db; }
          .border-b { border-bottom: 1px solid #d1d5db; }
          .border-gray-300 { border-color: #d1d5db; }
          .bg-gray-200 { background-color: #e5e7eb; }
          .bg-gray-100 { background-color: #f3f4f6; }
          .bg-gray-50 { background-color: #f9fafb; }
          .p-2 { padding: 0.5rem; }
          .p-3 { padding: 0.75rem; }
          .grid { display: grid; }
          .grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
          .gap-0 { gap: 0; }
          .gap-2 { gap: 0.5rem; }
          .divide-y > :not([hidden]) ~ :not([hidden]) { border-top: 1px solid #e5e7eb; }
          .divide-gray-200 > :not([hidden]) ~ :not([hidden]) { border-color: #e5e7eb; }
          .text-center { text-align: center; }
          .space-y-4 > :not([hidden]) ~ :not([hidden]) { margin-top: 1rem; }
          .pb-2 { padding-bottom: 0.5rem; }
        }
        
        /* Screen styles */
        .student-marksheets {
          margin-bottom: 2rem;
          box-shadow: 0 2px 4px rgba(0,0,0,0.1);
          padding: 2rem;
          border-radius: 0.5rem;
        }
      `})]})},y_=({marksheetData:n,studentData:a,classData:t,positionData:r,schoolInfo:s})=>{if(!n)return null;const e={schoolName:s?.schoolName||s?.name||"School Management System",schoolAddress:s?.schoolAddress||s?.address||"123 Education Street, Learning City",schoolPhone:s?.schoolPhone||s?.phone||"+1 (555) 123-4567"};return i.jsxs("div",{className:"w-full mx-auto bg-white font-sans",children:[i.jsxs("div",{className:"marksheets-section",children:[i.jsxs("div",{className:"text-center border-b border-gray-300 pb-2 mb-3",children:[i.jsxs("div",{className:"flex items-center justify-center mb-1",children:[i.jsx(fA,{className:"text-blue-600 text-lg mr-2"}),i.jsx("h1",{className:"text-lg font-bold text-gray-800",children:e.schoolName})]}),i.jsx("p",{className:"text-gray-600 text-xs mb-1",children:e.schoolAddress}),i.jsxs("p",{className:"text-gray-600 text-xs",children:["Phone: ",e.schoolPhone]})]}),i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("div",{className:"mr-4",children:a?.photo?i.jsx("img",{src:a.photo,alt:"Student",className:"w-20 h-20 rounded object-cover border border-gray-300"}):i.jsx("div",{className:"w-20 h-20 rounded bg-gray-200 border border-gray-300 flex items-center justify-center",children:i.jsx(Pi,{className:"text-gray-500 text-2xl"})})}),i.jsxs("div",{children:[i.jsx("div",{className:"font-bold text-gray-800 text-xl",children:a?`${a.firstName} ${a.lastName}`:n.studentName}),i.jsxs("div",{className:"text-gray-600",children:["ID: ",n.studentId]}),i.jsxs("div",{className:"text-gray-600",children:["Class: ",n.class," - ",n.section]}),i.jsxs("div",{className:"text-gray-600",children:["Exam: ",n.examType," ",n.year]})]})]}),i.jsxs("div",{className:"grid grid-cols-4 gap-2 mb-4",children:[i.jsxs("div",{className:"bg-gray-50 p-3 rounded text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Obtained"}),i.jsx("div",{className:"font-bold text-lg",children:n.totalObtained})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Total"}),i.jsx("div",{className:"font-bold text-lg",children:n.totalMarks})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Percentage"}),i.jsxs("div",{className:"font-bold text-lg",children:[n.percentage,"%"]})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded text-center",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Grade"}),i.jsx("div",{className:"font-bold text-lg",children:i.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded text-sm",children:n.overallGrade})})]})]}),i.jsx("div",{className:"mb-4",children:i.jsxs("div",{className:"border rounded",children:[i.jsxs("div",{className:"grid grid-cols-4 gap-0 bg-gray-100 border-b text-sm font-medium p-3",children:[i.jsx("span",{children:"Subject"}),i.jsx("span",{className:"text-center",children:"Obtained"}),i.jsx("span",{className:"text-center",children:"Total"}),i.jsx("span",{className:"text-center",children:"Grade"})]}),i.jsx("div",{className:"divide-y divide-gray-200",children:n.marks&&n.marks.map((u,f)=>i.jsxs("div",{className:"grid grid-cols-4 gap-0 p-3",children:[i.jsx("span",{children:u.subjectName}),i.jsx("span",{className:"text-center",children:u.marksObtained}),i.jsx("span",{className:"text-center",children:u.totalMarks}),i.jsx("span",{className:"text-center",children:i.jsx("span",{className:"bg-blue-100 text-blue-800 px-1 py-0.5 rounded text-xs",children:u.grade})})]},f))})]})})]}),i.jsx("style",{children:`
        @media print {
          body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          }
          
          .marksheets-section {
            padding: 20px;
            max-width: 100%;
            page-break-inside: avoid;
            /* Fit 2 marksheets per page - top and bottom */
            height: 45vh;
            box-sizing: border-box;
            break-inside: avoid;
            margin-bottom: 0;
          }
          
          /* Remove page break after the last marksheet */
          .marksheets-section:last-child {
            page-break-after: avoid;
          }
          
          @page {
            size: A4;
            margin: 0.3in;
          }
          
          .text-center { text-align: center; }
          .flex { display: flex; }
          .items-center { align-items: center; }
          .font-bold { font-weight: 700; }
          .text-gray-800 { color: #1f2937; }
          .text-gray-600 { color: #4b5563; }
          .text-xl { font-size: 1.25rem; }
          .text-lg { font-size: 1.125rem; }
          .text-sm { font-size: 0.875rem; }
          .text-xs { font-size: 0.75rem; }
          .mb-4 { margin-bottom: 1rem; }
          .mr-4 { margin-right: 1rem; }
          .w-20 { width: 5rem; }
          .h-20 { height: 5rem; }
          .rounded { border-radius: 0.25rem; }
          .object-cover { object-fit: cover; }
          .border { border: 1px solid #d1d5db; }
          .border-b { border-bottom: 1px solid #d1d5db; }
          .border-gray-300 { border-color: #d1d5db; }
          .bg-gray-200 { background-color: #e5e7eb; }
          .bg-gray-100 { background-color: #f3f4f6; }
          .bg-gray-50 { background-color: #f9fafb; }
          .p-3 { padding: 0.75rem; }
          .grid { display: grid; }
          .grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
          .gap-0 { gap: 0; }
          .gap-2 { gap: 0.5rem; }
          .divide-y > :not([hidden]) ~ :not([hidden]) { border-top: 1px solid #e5e7eb; }
          .divide-gray-200 > :not([hidden]) ~ :not([hidden]) { border-color: #e5e7eb; }
        }
        
        /* Screen styles */
        .marksheets-section {
          margin-bottom: 2rem;
          box-shadow: 0 2px 4px rgba(0,0,0,0.1);
          padding: 2rem;
          border-radius: 0.5rem;
        }
      `})]})},v_=({classes:n,students:a,exams:t,onSubmit:r,onCancel:s})=>{const[e,u]=ne.useState(1),[f,m]=ne.useState(""),[g,b]=ne.useState(""),[j,F]=ne.useState(""),[C,M]=ne.useState(null),[_,L]=ne.useState(new Date().getFullYear().toString()),[T,H]=ne.useState([]),[O,Q]=ne.useState([]),[Z,ee]=ne.useState(!1),[se,ue]=ne.useState(null),[ae,pe]=ne.useState([{minPercentage:90,grade:"A+",description:"Excellent"},{minPercentage:80,grade:"A",description:"Very Good"},{minPercentage:70,grade:"B+",description:"Good"},{minPercentage:60,grade:"B",description:"Satisfactory"},{minPercentage:50,grade:"C",description:"Average"},{minPercentage:0,grade:"F",description:"Fail"}]),[z,J]=ne.useState(!1),ge=ne.useMemo(()=>a,[a]),fe=ne.useMemo(()=>ge.filter(ve=>ve.class!==f?!1:g?ve.section===g:!0),[ge,f,g]);f&&n.find(q=>q.name===f)?.subjects;const ke=f?n.find(q=>q.name===f)?.sections||[]:[],he=ne.useMemo(()=>t&&t.filter(q=>!f||q.class===f||q.classes&&q.classes.includes(f)).map(q=>{const ve=q.scheduledSubjects?.find(Fe=>Fe.className===f)?.subjects;return{...q,effectiveSubjects:ve||q.subjects||[]}})||[],[t,f]);ne.useEffect(()=>{if(f&&j){const Fe=(he.find(je=>je.examType===j)?.effectiveSubjects||n.find(je=>je.name===f)?.subjects||[]).map(je=>({subjectId:je.id,subjectName:je.name,totalMarks:je.maxMarks||100}));H(Fe);const Ge=ge.filter(je=>je.class!==f?!1:g?je.section===g:!0).map(je=>{const Me=je.marks?.find(ft=>ft.examType===j)||null,Se=Fe.map(ft=>{const jt=Me?.marks?.find(It=>It.subjectName===ft.subjectName);return{id:jt?jt.id:null,subjectId:ft.subjectId,subjectName:ft.subjectName,marksObtained:jt?jt.marksObtained:"33",totalMarks:ft.totalMarks,grade:jt?jt.grade:""}});return{studentId:je.id,studentName:`${je.firstName} ${je.lastName}`,marks:Se,existingMarksId:Me?Me.id:null}});Q(Ge)}},[f,g,j,ge,n,he]);const Ne=(q,ve,Fe)=>{const Qe=[...O],Ge=parseInt(Fe)||0,je=Qe[q].marks[ve].totalMarks,Me=je>0?Ge/je*100:0,Se=xe(Me);Qe[q].marks[ve].marksObtained=Fe,Qe[q].marks[ve].grade=Se,Q(Qe)},xe=q=>{const ve=[...ae].sort((Fe,Qe)=>Qe.minPercentage-Fe.minPercentage);for(let Fe=0;Fe<ve.length;Fe++)if(q>=ve[Fe].minPercentage)return ve[Fe].grade;return"F"},we=q=>{const ve=q.reduce((je,Me)=>je+(parseInt(Me.marksObtained)||0),0),Fe=q.reduce((je,Me)=>je+(parseInt(Me.totalMarks)||0),0),Qe=Fe>0?(ve/Fe*100).toFixed(2):0,Ge=xe(parseFloat(Qe));return{totalObtained:ve,totalMarks:Fe,percentage:Qe,overallGrade:Ge}},ye=q=>[...q].sort((Fe,Qe)=>parseFloat(Qe.percentage)-parseFloat(Fe.percentage)).map((Fe,Qe)=>({...Fe,position:Qe+1,totalStudents:q.length})),te=q=>{if(q.preventDefault(),!f||!j){alert("Please select class and exam type");return}if(!O.every(Qe=>Qe.marks.every(Ge=>Ge.marksObtained!==""&&Ge.marksObtained!==null))){alert("Please enter marks for all students and subjects");return}const Fe=O.map(Qe=>{const Ge=we(Qe.marks);return{id:Qe.existingMarksId||`${Qe.studentId}_${j}_${Date.now()}`,studentId:Qe.studentId,studentName:Qe.studentName,class:f,section:g||"",examType:j,year:_,marks:Qe.marks,...Ge}});ue(Fe),ee(!0)},V=q=>{r(q),ee(!1),ue(null),u(1),m(""),b(""),F(""),M(null),L(new Date().getFullYear().toString()),H([]),Q([])},le=()=>{window.print()},de=()=>{se.forEach((q,ve)=>{setTimeout(()=>{const Fe=new ua;Fe.setFontSize(16),Fe.text("School Management System",105,20,null,null,"center"),Fe.setFontSize(12),Fe.text("Student Marksheet",105,30,null,null,"center");const Qe=a.find(ft=>ft.id===q.studentId),Ge=Qe?`${Qe.firstName} ${Qe.lastName}`:q.studentName;Fe.setFontSize(11),Fe.text(`Student Name: ${Ge}`,20,45),Fe.text(`Student ID: ${q.studentId}`,20,55),Fe.text(`Class: ${q.class} - Section ${q.section}`,20,65),Fe.text(`Exam: ${q.examType} ${q.year}`,20,75);const je=85;Fe.setFontSize(10),Fe.setFillColor(240,240,240),Fe.rect(20,je,170,10,"F"),Fe.text("Subject",25,je+7),Fe.text("Obtained",85,je+7),Fe.text("Total",115,je+7),Fe.text("Grade",145,je+7);let Me=je+10;q.marks.forEach(ft=>{Fe.text(ft.subjectName,25,Me+7),Fe.text(ft.marksObtained.toString(),85,Me+7),Fe.text(ft.totalMarks.toString(),115,Me+7),Fe.text(ft.grade,145,Me+7),Me+=10}),Me+=10,Fe.text(`Total Obtained: ${q.totalObtained}`,20,Me),Fe.text(`Total Marks: ${q.totalMarks}`,80,Me),Fe.text(`Percentage: ${q.percentage}%`,140,Me),Me+=10,Fe.text(`Overall Grade: ${q.overallGrade}`,20,Me);const Se=`${Ge.replace(/\s+/g,"_")}_${q.examType}_${q.year}_Marksheet.pdf`;Fe.save(Se)},ve*1e3)})},X=(q,ve,Fe)=>{const Qe=[...ae];Qe[q][ve]=ve==="minPercentage"?parseFloat(Fe):Fe,pe(Qe)},ie=()=>{pe([...ae,{minPercentage:0,grade:"",description:""}])},G=q=>{if(ae.length>1){const ve=[...ae];ve.splice(q,1),pe(ve)}};return Z&&se?(ye(se),i.jsxs("div",{className:"w-full mx-auto bg-white p-6 max-h-screen flex flex-col",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6 flex-shrink-0",children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900 print:hidden",children:"Print Preview - Bulk Marksheets"}),i.jsxs("div",{className:"flex space-x-3",children:[i.jsxs("button",{onClick:le,className:"print:hidden inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700",children:[i.jsx("svg",{className:"h-5 w-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Print Marksheets"]}),i.jsxs("button",{onClick:de,className:"print:hidden inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[i.jsx("svg",{className:"h-5 w-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Download PDFs"]}),i.jsxs("button",{onClick:()=>ee(!1),className:"print:hidden inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[i.jsx("svg",{className:"h-5 w-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Edit"]})]})]}),i.jsx("div",{className:"flex-grow overflow-y-auto mb-6",children:i.jsx(t8,{marksheetsData:se,studentsData:a,classesData:n})}),i.jsxs("div",{className:"flex justify-center space-x-4 pt-6 border-t border-gray-200 flex-shrink-0",children:[i.jsx("button",{onClick:()=>ee(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Back to Edit"}),i.jsx("button",{onClick:()=>V(se),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Save All Marksheets"})]})]})):i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Class Exam Marksheet Entry"}),e===1&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class *"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(nc,{className:"h-5 w-5 text-gray-400"})}),i.jsxs("select",{value:f,onChange:q=>{m(q.target.value),b("")},className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0,children:[i.jsx("option",{value:"",children:"Select Class"}),n.map(q=>i.jsx("option",{value:q.name,children:q.name},q.id))]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Section"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(OA,{className:"h-5 w-5 text-gray-400"})}),i.jsxs("select",{value:g,onChange:q=>b(q.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"All Sections"}),ke.map(q=>i.jsx("option",{value:q.name,children:q.name},q.id))]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Exam Type *"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(A5,{className:"h-5 w-5 text-gray-400"})}),i.jsxs("select",{value:j,onChange:q=>{const ve=he.find(Fe=>Fe.examType===q.target.value);F(q.target.value),M(ve),ve&&L(ve.year||new Date().getFullYear().toString())},className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0,children:[i.jsx("option",{value:"",children:"Select Exam Type"}),he.map(q=>i.jsxs("option",{value:q.examType,children:[q.examType," - ",q.class," (",q.startDate," to ",q.endDate,")"]},q.id))]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year"}),i.jsx("input",{type:"text",value:_,readOnly:!0,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100"})]})]}),f&&i.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[i.jsxs("h4",{className:"text-md font-medium text-gray-900 mb-2",children:["Students in ",f,g?` - Section ${g}`:" - All Sections"]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:fe.map(q=>i.jsx("div",{className:"border border-gray-200 rounded-lg p-3",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"bg-gray-200 border-2 border-dashed rounded-xl w-8 h-8"}),i.jsxs("div",{className:"ml-2",children:[i.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[q.firstName," ",q.lastName]}),i.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",q.id]}),!g&&i.jsxs("div",{className:"text-xs text-gray-500",children:["Section: ",q.section]})]})]})},q.id))}),fe.length===0&&i.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["No students found in this class",g?` and section ${g}`:""]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:s,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),i.jsx("button",{type:"button",onClick:()=>{f&&j&&_?u(2):alert("Please fill in all required fields")},className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",disabled:!f||!j||!_,children:"Next: Enter Marks"})]})]}),e===2&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:"text-lg font-medium text-gray-900",children:["Enter Marks for ",f,g?` - Section ${g}`:" - All Sections"]}),i.jsxs("p",{className:"text-sm text-gray-600",children:[j," ",_," - ",fe.length," students"]})]}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsxs("button",{onClick:()=>J(!z),className:"inline-flex items-center px-3 py-1 border border-gray-300 text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50",children:[i.jsx(Hk,{className:"mr-1"})," Grade Settings"]}),i.jsxs("button",{onClick:()=>u(1),className:"inline-flex items-center px-3 py-1 border border-gray-300 text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50",children:[i.jsx("svg",{className:"h-4 w-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]})]})]}),z&&i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[i.jsx("h5",{className:"text-md font-medium text-gray-900 mb-3",children:"Grade Configuration"}),i.jsxs("div",{className:"space-y-3",children:[ae.map((q,ve)=>i.jsxs("div",{className:"grid grid-cols-12 gap-2 items-center",children:[i.jsxs("div",{className:"col-span-3",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Min Percentage"}),i.jsx("input",{type:"number",min:"0",max:"100",value:q.minPercentage,onChange:Fe=>X(ve,"minPercentage",Fe.target.value),className:"block w-full px-2 py-1 border border-gray-300 rounded text-sm"})]}),i.jsxs("div",{className:"col-span-3",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Grade"}),i.jsx("input",{type:"text",value:q.grade,onChange:Fe=>X(ve,"grade",Fe.target.value),className:"block w-full px-2 py-1 border border-gray-300 rounded text-sm"})]}),i.jsxs("div",{className:"col-span-5",children:[i.jsx("label",{className:"text-xs text-gray-600",children:"Description"}),i.jsx("input",{type:"text",value:q.description,onChange:Fe=>X(ve,"description",Fe.target.value),className:"block w-full px-2 py-1 border border-gray-300 rounded text-sm"})]}),i.jsx("div",{className:"col-span-1 flex items-end",children:i.jsx("button",{onClick:()=>G(ve),className:"text-red-500 hover:text-red-700 text-sm",disabled:ae.length<=1,children:"Remove"})})]},ve)),i.jsx("button",{onClick:ie,className:"text-blue-600 hover:text-blue-800 text-sm",children:"+ Add Grade Configuration"})]})]}),O.length>0&&i.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sticky left-0 bg-gray-50",children:"Student"}),T.map((q,ve)=>i.jsxs("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:[i.jsx("div",{children:q.subjectName}),i.jsxs("div",{className:"text-xs font-normal text-gray-500",children:["(",q.totalMarks," marks)"]})]},q.subjectId)),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Grade"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:O.map((q,ve)=>{const Fe=we(q.marks);return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap sticky left-0 bg-white",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:q.studentName}),i.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",q.studentId]}),!g&&i.jsxs("div",{className:"text-xs text-gray-500",children:["Section: ",q.section]})]}),q.marks.map((Qe,Ge)=>i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("input",{type:"number",min:"0",max:Qe.totalMarks,value:Qe.marksObtained,onChange:je=>Ne(ve,Ge,je.target.value),className:"block w-20 px-2 py-1 border border-gray-300 rounded focus:ring-blue-500 focus:border-blue-500"})},Qe.subjectId)),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[i.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[Fe.totalObtained,"/",Fe.totalMarks]}),i.jsxs("div",{className:"text-xs text-gray-500",children:[Fe.percentage,"%"]})]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Fe.overallGrade==="A+"?"bg-yellow-100 text-yellow-800":Fe.overallGrade==="A"?"bg-green-100 text-green-800":Fe.overallGrade==="B+"?"bg-blue-100 text-blue-800":Fe.overallGrade==="B"?"bg-indigo-100 text-indigo-800":Fe.overallGrade==="C"?"bg-purple-100 text-purple-800":"bg-red-100 text-red-800"}`,children:Fe.overallGrade})})]},q.studentId)})})]})})}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>u(1),className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Back"}),i.jsx("button",{type:"button",onClick:()=>u(3),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Next: Configure Grades"})]})]}),e===3&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Review and Configure Grades"}),i.jsxs("p",{className:"text-sm text-gray-600",children:[j," ",_," - ",f,g?` - Section ${g}`:" - All Sections"]})]}),i.jsxs("button",{onClick:()=>u(2),className:"inline-flex items-center px-3 py-1 border border-gray-300 text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50",children:[i.jsx("svg",{className:"h-4 w-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[i.jsx("h5",{className:"text-md font-medium text-gray-900 mb-3",children:"Current Grade Configuration"}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:ae.map((q,ve)=>i.jsxs("div",{className:"bg-white p-3 rounded border",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"font-bold text-gray-900",children:q.grade}),i.jsxs("span",{className:"text-sm text-gray-600",children:[q.minPercentage,"%+"]})]}),i.jsx("div",{className:"text-xs text-gray-500 mt-1",children:q.description})]},ve))})]}),i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[i.jsx("h5",{className:"text-md font-medium text-gray-900 mb-4",children:"Student Rankings Preview"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Position"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Obtained"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Percentage"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Grade"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:O.map(q=>{const ve=we(q.marks);return{...q,...ve}}).sort((q,ve)=>parseFloat(ve.percentage)-parseFloat(q.percentage)).map((q,ve)=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center",children:[ve===0&&i.jsx(nw,{className:"text-yellow-500 mr-2"}),ve===1&&i.jsx($2,{className:"text-gray-400 mr-2"}),ve===2&&i.jsx($2,{className:"text-amber-700 mr-2"}),i.jsx("span",{className:"font-medium",children:ve+1})]})}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:q.studentName}),i.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",q.studentId]})]}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[q.totalObtained,"/",q.totalMarks]}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[q.percentage,"%"]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${q.overallGrade==="A+"?"bg-yellow-100 text-yellow-800":q.overallGrade==="A"?"bg-green-100 text-green-800":q.overallGrade==="B+"?"bg-blue-100 text-blue-800":q.overallGrade==="B"?"bg-indigo-100 text-indigo-800":q.overallGrade==="C"?"bg-purple-100 text-purple-800":"bg-red-100 text-red-800"}`,children:q.overallGrade})})]},q.studentId))})]})})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>u(2),className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Back"}),i.jsxs("button",{type:"button",onClick:te,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[i.jsx(nf,{className:"mr-2"})," Save and Preview Marksheets"]})]})]})]})},w_=()=>{const n=Pn(),{students:a}=rr(Ye=>Ye.students),{classes:t}=rr(Ye=>Ye.classes),{marks:r,loading:s,error:e}=rr(Ye=>Ye.marks),{exams:u}=rr(Ye=>Ye.exams),f=rr(Ye=>Ye.settings.schoolInfo),m=ne.useMemo(()=>{if(Array.isArray(r))return r;if(r&&typeof r=="object"&&r.marks&&Array.isArray(r.marks))return r.marks;if(r&&typeof r=="object"){const Ye=[];return Object.keys(r).forEach(St=>{St==="marks"&&Array.isArray(r[St])?Ye.push(...r[St]):typeof r[St]=="object"&&r[St]!==null&&(Array.isArray(r[St])?Ye.push(...r[St]):r[St].marks&&Array.isArray(r[St].marks)?Ye.push(...r[St].marks):r[St].examType&&Ye.push(r[St]))}),Ye}return[]},[r]),[g,b]=ne.useState("list"),[j,F]=ne.useState(!1),[C,M]=ne.useState(!1),[_,L]=ne.useState(null),[T,H]=ne.useState(null),[O,Q]=ne.useState(""),[Z,ee]=ne.useState(""),[se,ue]=ne.useState(""),[ae,pe]=ne.useState(R1()),[z,J]=ne.useState(""),[ge,fe]=ne.useState(1),[ke,he]=ne.useState({studentId:"",studentName:"",class:"",section:"",examType:"",year:new Date().getFullYear().toString(),marks:[]}),[Ne,xe]=ne.useState(!1),[we,ye]=ne.useState([]),[te,V]=ne.useState([]),le=10;ne.useEffect(()=>{n(qu()),n(Q1())},[n]);const de=ne.useMemo(()=>{if(!a||!Array.isArray(a)||!m||!Array.isArray(m))return[];const Ye={};return m.forEach(St=>{St&&St.studentId&&(Ye[St.studentId]||(Ye[St.studentId]=[]),Ye[St.studentId].push(St))}),a.map(St=>({...St,marksCount:Ye[St.id]?Ye[St.id].length:0,marks:Ye[St.id]||[]}))},[a,m]),X=ne.useMemo(()=>{if(!m||!Array.isArray(m))return[R1()];const Ye=new Set;return m.forEach(St=>{St&&St.academicYear?Ye.add(St.academicYear):St&&St.year&&Ye.add(St.year)}),Array.from(Ye).sort().reverse()},[m]),ie=ne.useMemo(()=>{if(!m||!Array.isArray(m))return[];const Ye=new Set;return m.forEach(St=>{St&&St.examType&&Ye.add(St.examType)}),Array.from(Ye).sort()},[m]),G=ne.useMemo(()=>de.filter(Ye=>{const St=!O||`${Ye.firstName} ${Ye.lastName}`.toLowerCase().includes(O.toLowerCase())||Ye.id.toLowerCase().includes(O.toLowerCase())||Ye.class.toLowerCase().includes(O.toLowerCase())||Ye.section.toLowerCase().includes(O.toLowerCase()),Jt=!Z||Ye.class===Z,mr=!se||Ye.section===se,ar=!ae||Ye.academicYear===ae,bt=!z||Ye.marks&&Ye.marks.some(Yt=>Yt.examType===z);return St&&Jt&&mr&&ar&&bt}),[de,O,Z,se,ae,z]),q=ne.useMemo(()=>{const Ye=(ge-1)*le;return G.slice(Ye,Ye+le)},[G,ge]),ve=ne.useMemo(()=>{const Ye=new Date().getFullYear().toString();return u.filter(St=>St.academicYear?St.academicYear.startsWith(Ye):St.year===Ye)},[u]),Fe=Math.ceil(G.length/le),Qe=Ye=>{L({...Ye,marks:Ye.marks||[]}),b("detail")},Ge=()=>{b("list"),L(null),H(null)},je=Ye=>{H(Ye),b("marksheet-view")},Me=Ye=>{H(Ye),b("marksheet-edit")},Se=Ye=>{window.confirm("Are you sure you want to delete this marksheet?")&&n(QC(Ye))},ft=Ye=>{Array.isArray(Ye)?(Ye.forEach(St=>{St.id&&m.find(Jt=>Jt.id===St.id)?n(Zv(St)):n(Jv(St))}),setTimeout(()=>{n(qu())},1e3)):(Ye.id&&m.find(St=>St.id===Ye.id)?n(Zv(Ye)):n(Jv(Ye)),setTimeout(()=>{n(qu())},1e3))},jt=()=>{F(!1),M(!1),H(null)},It=()=>{alert("In a full implementation, this would download the marksheet as a PDF")},ut=()=>{Q(""),ee(""),ue(""),pe(R1()),J(""),fe(1)},Rt=()=>{const Ye=de.filter(St=>{const mr=!Z||St.class===Z,ar=!se||St.section===se,bt=!ae||St.academicYear===ae,Yt=!z||St.marks&&St.marks.some(vr=>vr.examType===z);return mr&&ar&&bt&&Yt});if(Ye.length>0){const St=[];Ye.forEach(Jt=>{if(Jt.marks&&Jt.marks.length>0)if(z){const mr=Jt.marks.filter(ar=>ar.examType===z);St.push(...mr)}else St.push(...Jt.marks)}),St.length>0?(ye(St),V(Ye),xe(!0)):alert("No marksheets found for the selected students")}else alert("No students match the selected filters")};return i.jsxs("div",{className:"",children:[Ne&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[i.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Print Preview"}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsxs("button",{onClick:()=>window.print(),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(mi,{className:"mr-2"})," Print"]}),i.jsx("button",{onClick:()=>xe(!1),className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Close"})]})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:i.jsx(t8,{marksheetsData:we,studentsData:te,classesData:t,schoolInfo:f})})]})}),i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900 print:hidden",children:"Marksheets Management"}),i.jsx("p",{className:"mt-1 text-sm text-gray-600 print:hidden",children:g==="list"?"Manage student marks and generate report cards":g==="detail"?`Marksheets for ${_?.name}`:"Student Marksheet"})]}),i.jsx("div",{className:"mt-4 md:mt-0",children:g==="list"?i.jsxs("div",{className:"flex space-x-2",children:[i.jsxs("button",{onClick:()=>{M(!1),F(!j),j||(he({studentId:"",studentName:"",class:"",section:"",examType:"",year:new Date().getFullYear().toString(),marks:[]}),H(null))},className:`print:hidden inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${C?"bg-gray-500 hover:bg-gray-600":"bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700"}`,children:[i.jsx(xl,{className:"mr-2"})," ",j&&!C?"Cancel":"Add Marksheet"]}),i.jsxs("button",{onClick:()=>{M(!0),F(!0)},className:`print:hidden inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 ${C?"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700":"bg-gray-500 hover:bg-gray-600"}`,children:[i.jsx(Pk,{className:"mr-2"})," Bulk Entry"]})]}):i.jsxs("button",{onClick:Ge,className:"print:hidden inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx("svg",{className:"h-5 w-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to List"]})})]}),g==="detail"&&_&&i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[i.jsxs("div",{className:"flex items-start justify-between mb-6",children:[i.jsxs("div",{className:"flex-grow",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900",children:_.name}),i.jsxs("p",{className:"text-gray-600",children:[_.class," - Section ",_.section]})]}),i.jsxs("div",{className:"flex items-start space-x-4",children:[i.jsxs("div",{className:"text-right",children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Total Marksheets"}),i.jsx("p",{className:"text-2xl font-bold text-gray-900",children:_.marksCount})]}),i.jsx("div",{className:"ml-2",children:i.jsx("div",{className:"bg-gray-200 border-2 border-dashed rounded-xl w-16 h-16"})})]})]}),i.jsxs("div",{className:"overflow-hidden rounded-lg border border-gray-200",children:[i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Exam"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Year"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subjects"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:_.marks&&_.marks.map(Ye=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("div",{className:"text-sm font-medium text-gray-900",children:Ye.examType})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Ye.year}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"text-sm text-gray-900",children:[Ye.marks.length," subjects"]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:i.jsxs("div",{className:"flex justify-end space-x-2",children:[i.jsxs("button",{onClick:()=>je(Ye),className:"inline-flex items-center px-3 py-1 border border-gray-300 text-xs font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50",children:[i.jsx(rg,{className:"mr-1"})," View"]}),i.jsxs("button",{onClick:()=>Me(Ye),className:"inline-flex items-center px-3 py-1 border border-gray-300 text-xs font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50",children:[i.jsx(IA,{className:"mr-1"})," Edit"]}),i.jsxs("button",{onClick:()=>Se(Ye.id),className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700",children:[i.jsx(cu,{className:"mr-1"})," Delete"]})]})})]},Ye.id))})]}),(!_.marks||_.marks.length===0)&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(OA,{className:"mx-auto h-12 w-12 text-gray-400"}),i.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No marksheets found"}),i.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"This student has no marksheets yet"})]})]})]}),g==="marksheet-view"&&T&&i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 max-h-[calc(100vh-100px)] overflow-y-auto",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6 sticky top-0 bg-white py-2 z-10",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"View Student Marksheet"}),i.jsxs("button",{onClick:Ge,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx("svg",{className:"h-5 w-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to List"]})]}),i.jsx("div",{className:"mb-6",children:i.jsx(y_,{marksheetData:T,studentData:a.find(Ye=>Ye.id===T.studentId),classData:t.find(Ye=>Ye.name===T.class),positionData:{position:T.position,totalStudents:T.totalStudents}})}),i.jsxs("div",{className:"flex justify-center mt-6 space-x-4 sticky bottom-0 bg-white py-2 z-10",children:[i.jsxs("button",{onClick:()=>window.print(),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx("svg",{className:"h-5 w-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Print Marksheet"]}),i.jsxs("button",{onClick:It,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx("svg",{className:"h-5 w-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Download PDF"]}),i.jsxs("button",{onClick:()=>Me(T),className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(IA,{className:"mr-2"})," Edit Marksheet"]})]})]}),g==="marksheet-edit"&&T&&i.jsx(L4,{classes:t,students:de,exams:ve,currentMarks:T,onSubmit:Ye=>{ft(Ye),b("detail"),alert("Marksheet updated successfully!")},onCancel:()=>b("detail")}),g==="list"&&i.jsxs(i.Fragment,{children:[j&&!C&&i.jsx(L4,{classes:t,students:de,exams:ve,currentMarks:T,onSubmit:Ye=>{ft(Ye),jt(),alert("Marksheet saved successfully!")},onCancel:jt}),j&&C&&i.jsx(v_,{classes:t,students:de,exams:ve,onSubmit:Ye=>{ft(Ye),jt(),alert(`Successfully saved marksheets for ${Ye.length} students!`)},onCancel:jt}),!j&&i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Student Marksheets"}),i.jsx("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[i.jsxs("div",{className:"relative flex-grow max-w-md",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Bi,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"text",placeholder:"Search by student name, class, or section...",value:O,onChange:Ye=>Q(Ye.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("div",{className:"flex items-center space-x-2",children:i.jsxs("select",{value:Z,onChange:Ye=>ee(Ye.target.value),className:"block w-full pl-3 pr-10 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"All Classes"}),t&&t.map(Ye=>i.jsx("option",{value:Ye.name,children:Ye.name},Ye.id))]})}),i.jsx("div",{className:"flex items-center space-x-2",children:i.jsxs("select",{value:se,onChange:Ye=>ue(Ye.target.value),className:"block w-full pl-3 pr-10 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"All Sections"}),i.jsx("option",{value:"A",children:"A"}),i.jsx("option",{value:"B",children:"B"}),i.jsx("option",{value:"C",children:"C"})]})}),i.jsx("div",{className:"flex items-center space-x-2",children:i.jsxs("select",{value:ae,onChange:Ye=>pe(Ye.target.value),className:"block w-full pl-3 pr-10 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"All Batches"}),X.map(Ye=>i.jsx("option",{value:Ye,children:Ye},Ye))]})}),i.jsx("div",{className:"flex items-center space-x-2",children:i.jsxs("select",{value:z,onChange:Ye=>J(Ye.target.value),className:"block w-full pl-3 pr-10 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"All Exam Types"}),ie.map(Ye=>i.jsx("option",{value:Ye,children:Ye},Ye))]})}),i.jsxs("button",{onClick:ut,className:"inline-flex items-center px-3 py-1 border border-gray-300 text-xs font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50",children:[i.jsx(io,{className:"mr-1"})," Clear Filters"]}),(Z||se||ae||z)&&i.jsxs("button",{onClick:Rt,className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700",children:[i.jsx(mi,{className:"mr-1"})," Print Marksheets"]})]})]})}),i.jsxs("div",{className:"overflow-hidden rounded-lg border border-gray-200",children:[i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class/Section"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Marksheets"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:q.map(Ye=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"bg-gray-200 border-2 border-dashed rounded-xl w-10 h-10"}),i.jsxs("div",{className:"ml-4",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:Ye.name}),i.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",Ye.id]})]})]})}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[Ye.class," - ",Ye.section]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:[Ye.marksCount," marksheets"]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:i.jsxs("button",{onClick:()=>Qe(Ye),className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700",children:[i.jsx(rg,{className:"mr-1"})," View Details"]})})]},Ye.id))})]}),q.length===0&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Bi,{className:"mx-auto h-12 w-12 text-gray-400"}),i.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No students found"}),i.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Try adjusting your search or filter criteria."})]})]}),Fe>1&&i.jsx(Bd,{currentPage:ge,totalPages:Fe,onPageChange:fe})]})]})]})},N_=({student:n,certificateType:a,issueDate:t,reason:r="",characterDetails:s="",leavingCertificateData:e=null,schoolInfo:u,schoolName:f,schoolAddress:m,principalName:g="Principal",phoneNumber:b})=>{const j={schoolName:u?.schoolName||u?.name||"School Management System",schoolAddress:u?.schoolAddress||u?.address||"123 Education Street, Learning City",schoolPhone:u?.schoolPhone||u?.phone||"+1 (555) 123-4567"},F=f||j.schoolName,C=m||j.schoolAddress,M=b||j.schoolPhone,_=L=>{const T={year:"numeric",month:"long",day:"numeric"};return new Date(L).toLocaleDateString(void 0,T)};return a==="leaving"&&e?i.jsxs("div",{className:"min-h-screen bg-white p-8",children:[i.jsxs("div",{className:"max-w-4xl mx-auto border-4 border-blue-800 rounded-lg p-8 bg-white certificate-print-view",children:[i.jsxs("div",{className:"text-center border-b border-gray-300 pb-3 mb-4 print:hidden",children:[i.jsxs("div",{className:"flex items-center justify-center mb-2",children:[i.jsx(fA,{className:"text-blue-600 text-xl mr-3"}),i.jsx("h1",{className:"text-xl font-bold text-gray-800",children:F})]}),i.jsx("p",{className:"text-gray-600 text-sm mb-1",children:C}),i.jsxs("p",{className:"text-gray-600 text-sm",children:["Phone: ",M]})]}),i.jsx("div",{className:"text-center mb-6",children:i.jsx("h2",{className:"text-lg font-bold text-gray-800 border-b border-gray-200 pb-2",children:"SCHOOL LEAVING CERTIFICATE"})}),i.jsxs("div",{className:"mb-10",children:[i.jsx("p",{className:"text-lg text-gray-700 text-center mb-6",children:"This is to certify that"}),i.jsx("div",{className:"text-center mb-8",children:i.jsx("p",{className:"text-2xl font-bold text-gray-900 mb-2",children:e.studentName||`${n.firstName} ${n.lastName}`})}),i.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg border border-gray-300 mb-8",children:[i.jsx("h3",{className:"font-bold text-gray-800 mb-4 text-center text-lg",children:"Student Information"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-40",children:"Serial No:"}),i.jsx("span",{children:e.serialNo||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-40",children:"G.R No:"}),i.jsx("span",{children:e.grNo||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-40",children:"Student Name:"}),i.jsx("span",{children:e.studentName||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-40",children:"Father's Name:"}),i.jsx("span",{children:e.fatherName||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-40",children:"Caste:"}),i.jsx("span",{children:e.caste||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-40",children:"Place of Birth:"}),i.jsx("span",{children:e.placeOfBirth||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-40",children:"Date of Birth:"}),i.jsx("span",{children:e.dateOfBirth||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-40",children:"Date in Words:"}),i.jsx("span",{children:e.dateOfBirthWords||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-40",children:"Date of Admission:"}),i.jsx("span",{children:e.dateOfAdmission?_(e.dateOfAdmission):"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-40",children:"Last Class Attended:"}),i.jsx("span",{children:e.lastClassAttended||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-40",children:"Date of Leaving:"}),i.jsx("span",{children:e.dateOfLeaving?_(e.dateOfLeaving):"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-40",children:"Last School Attended:"}),i.jsx("span",{children:e.lastSchoolAttended||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-40",children:"Standard:"}),i.jsx("span",{children:e.standardStudying||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-40",children:"Reason for Leaving:"}),i.jsx("span",{children:e.reasonForLeaving||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-40",children:"Attendance:"}),i.jsx("span",{children:e.attendance||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-40",children:"Remarks:"}),i.jsx("span",{children:e.remarks||"N/A"})]})]})]}),i.jsxs("div",{className:"text-lg text-gray-700 mb-8 leading-relaxed text-center",children:[i.jsxs("p",{className:"mb-4",children:["was a bonafide student of this school and has left the institution on"," ",i.jsx("span",{className:"font-bold",children:e.dateOfLeaving?_(e.dateOfLeaving):"N/A"}),"."]}),e.reasonForLeaving&&i.jsxs("p",{className:"mb-4",children:["Reason for leaving: ",i.jsx("span",{className:"font-medium",children:e.reasonForLeaving})]}),i.jsxs("p",{children:["We wish ",e.studentName?e.studentName.split(" ")[0]:n.firstName," all the best in their future endeavors."]})]})]}),i.jsxs("div",{className:"border-t border-gray-300 pt-4 mt-6 text-center text-sm text-gray-600",children:[i.jsxs("p",{className:"mb-1",children:["This is an official document generated on ",new Date().toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})]}),i.jsx("p",{className:"text-xs",children:"Signature: _________________  Date: _________________"})]})]}),i.jsx("style",{children:`
          @media print {
            body {
              margin: 0;
              padding: 0;
              font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            }
            
            .certificate-print-view {
              padding: 15px;
              max-width: 100%;
              page-break-inside: avoid;
              page-break-after: always;
            }
            
            /* Remove page break after the last certificate */
            .certificate-print-view:last-child {
              page-break-after: avoid;
            }
            
            @page {
              size: A4;
              margin: 0.5in;
            }
            
            .certificate-print-view {
              font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            }
            
            /* Enhanced print styling - Match marksheet styles */
            .text-center { text-align: center; }
            .flex { display: flex; }
            .items-center { align-items: center; }
            .justify-center { justify-content: center; }
            .justify-between { justify-content: space-between; }
            .border-b { border-bottom: 1px solid #d1d5db; }
            .border-t { border-top: 1px solid #d1d5db; }
            .border-gray-300 { border-color: #d1d5db; }
            .pb-2 { padding-bottom: 0.5rem; }
            .pb-3 { padding-bottom: 0.75rem; }
            .mb-3 { margin-bottom: 0.75rem; }
            .mb-4 { margin-bottom: 1rem; }
            .mb-6 { margin-bottom: 1.5rem; }
            .mb-8 { margin-bottom: 2rem; }
            .mt-3 { margin-top: 0.75rem; }
            .mt-6 { margin-top: 1.5rem; }
            .pt-3 { padding-top: 0.75rem; }
            .pt-4 { padding-top: 1rem; }
            .text-lg { font-size: 1.125rem; }
            .text-base { font-size: 1rem; }
            .text-sm { font-size: 0.875rem; }
            .text-xs { font-size: 0.75rem; }
            .font-bold { font-weight: 700; }
            .font-medium { font-weight: 500; }
            .text-gray-800 { color: #1f2937; }
            .text-gray-600 { color: #4b5563; }
            .text-gray-700 { color: #374151; }
            .bg-gray-50 { background-color: #f9fafb; }
            .bg-yellow-100 { background-color: #fef3c7; }
            .bg-green-100 { background-color: #dcfce7; }
            .bg-blue-100 { background-color: #dbeafe; }
            .bg-indigo-100 { background-color: #e0e7ff; }
            .bg-purple-100 { background-color: #f3e8ff; }
            .bg-red-100 { background-color: #fee2e2; }
            .text-yellow-800 { color: #92400e; }
            .text-green-800 { color: #166534; }
            .text-blue-800 { color: #1e40af; }
            .text-indigo-800 { color: #3730a3; }
            .text-purple-800 { color: #6b21a8; }
            .text-red-800 { color: #991b1b; }
            .p-6 { padding: 1.5rem; }
            .px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
            .py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
            .px-1 { padding-left: 0.25rem; padding-right: 0.25rem; }
            .py-0.5 { padding-top: 0.125rem; padding-bottom: 0.125rem; }
            .rounded { border-radius: 0.25rem; }
            .grid { display: grid; }
            .grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
            .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
            .gap-1 { gap: 0.25rem; }
            .gap-2 { gap: 0.5rem; }
            .gap-3 { gap: 0.75rem; }
            .gap-4 { gap: 1rem; }
            .gap-6 { gap: 1.5rem; }
            .w-40 { width: 10rem; }
            .border { border: 1px solid #d1d5db; }
            .divide-y > :not([hidden]) ~ :not([hidden]) { border-top: 1px solid #e5e7eb; }
            .divide-gray-200 > :not([hidden]) ~ :not([hidden]) { border-color: #e5e7eb; }
          }
        `})]}):i.jsx("div",{className:"min-h-screen bg-white p-8",children:i.jsxs("div",{className:"max-w-4xl mx-auto border-4 border-blue-800 rounded-lg p-8 bg-white",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsx("div",{className:"flex justify-center mb-4",children:i.jsx(fA,{className:"text-4xl text-blue-800"})}),i.jsx("h1",{className:"text-3xl font-bold text-blue-800 uppercase tracking-wider",children:F}),i.jsx("p",{className:"text-gray-600 mt-2",children:C}),i.jsx("div",{className:"border-b-2 border-blue-800 mt-4 mx-auto w-32"})]}),i.jsx("div",{className:"text-center mb-10",children:i.jsx("h2",{className:"text-2xl font-bold text-gray-900 border-2 border-gray-900 inline-block px-6 py-2",children:a==="leaving"?"LEAVING CERTIFICATE":a==="pass"?"PASS CERTIFICATE":"CHARACTER CERTIFICATE"})}),i.jsxs("div",{className:"mb-10",children:[i.jsx("p",{className:"text-lg text-gray-700 text-center mb-6",children:"This is to certify that"}),i.jsxs("div",{className:"text-center mb-8",children:[i.jsxs("p",{className:"text-2xl font-bold text-gray-900 mb-2",children:[n.firstName," ",n.lastName]}),i.jsxs("p",{className:"text-gray-600",children:["Student ID: ",i.jsx("span",{className:"font-medium",children:n.id})]}),i.jsxs("p",{className:"text-gray-600",children:["Class: ",i.jsxs("span",{className:"font-medium",children:[n.class," - Section ",n.section]})]}),i.jsxs("p",{className:"text-gray-600",children:["Admission Date: ",i.jsx("span",{className:"font-medium",children:_(n.dateOfAdmission)})]})]}),a==="leaving"?i.jsxs("div",{className:"text-lg text-gray-700 mb-8 leading-relaxed",children:[i.jsxs("p",{className:"text-center mb-4",children:["was a bonafide student of this school and has left the institution on"," ",i.jsx("span",{className:"font-bold",children:_(t)}),"."]}),r&&i.jsxs("p",{className:"text-center",children:["Reason for leaving: ",i.jsx("span",{className:"font-medium",children:r})]}),i.jsxs("p",{className:"text-center mt-6",children:["We wish ",n.firstName," all the best in their future endeavors."]})]}):a==="pass"?i.jsxs("div",{className:"text-lg text-gray-700 mb-8 leading-relaxed",children:[i.jsxs("p",{className:"text-center mb-4",children:["has successfully completed all required coursework and passed the final examination on"," ",i.jsx("span",{className:"font-bold",children:_(t)}),"."]}),r&&i.jsxs("p",{className:"text-center mb-4",children:["Additional Details: ",i.jsx("span",{className:"font-medium",children:r})]}),i.jsxs("p",{className:"text-center",children:["We congratulate ",n.firstName," on this achievement and wish them success in their future endeavors."]})]}):i.jsxs("div",{className:"text-lg text-gray-700 mb-8 leading-relaxed",children:[i.jsx("p",{className:"text-center mb-4",children:"was a bonafide student of this school and during the period of study maintained good conduct and character."}),s&&i.jsx("p",{className:"text-center mb-4 font-medium",children:s}),i.jsxs("p",{className:"text-center",children:["We recommend ",n.firstName," as a student of good moral character."]})]})]}),i.jsxs("div",{className:"flex justify-between items-end mt-12",children:[i.jsx("div",{children:i.jsxs("p",{className:"text-gray-600",children:["Date: ",_(t)]})}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"mb-12",children:"_________________________"}),i.jsx("p",{className:"font-bold text-gray-900",children:g}),i.jsx("p",{className:"text-gray-600",children:"Principal"})]})]}),i.jsxs("div",{className:"flex justify-between items-end mt-8 pt-4 border-t border-gray-300",children:[i.jsxs("p",{className:"text-sm text-gray-500",children:["Certificate No: CERT-",n.id,"-",new Date().getFullYear()]}),i.jsxs("p",{className:"text-sm text-gray-500",children:["Issued on: ",_(t)]})]})]})})},C_=({student:n,certificateType:a,issueDate:t,reason:r,characterDetails:s,leavingCertificateData:e,onClose:u})=>{const f=ne.useRef(),m=rr(j=>j.settings.schoolInfo),g={schoolName:m?.schoolName||m?.name||"School Management System",schoolAddress:m?.schoolAddress||m?.address||"123 Education Street, Learning City",schoolPhone:m?.schoolPhone||m?.phone||"+1 (555) 123-4567"},b=()=>{let j="";if(a==="leaving"&&e){const C=M=>{const _={year:"numeric",month:"long",day:"numeric"};return new Date(M).toLocaleDateString(void 0,_)};j=`
        <div style="max-width: 800px; margin: 0 auto; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 20px;">
          <!-- Certificate Header -->
          <div style="text-align: center; border-bottom: 1px solid #d1d5db; padding-bottom: 15px; margin-bottom: 20px;">
            <h1 style="font-size: 24px; font-weight: bold; color: #1e40af; margin: 0 0 10px 0;">${g.schoolName}</h1>
            <p style="font-size: 14px; color: #4b5563; margin: 0 0 5px 0;">${g.schoolAddress}</p>
            <p style="font-size: 14px; color: #4b5563; margin: 0;">Phone: ${g.schoolPhone}</p>
          </div>

          <!-- Certificate Title -->
          <div style="text-align: center; margin-bottom: 30px;">
            <h2 style="font-size: 20px; font-weight: bold; color: #1f2937; border-bottom: 1px solid #e5e7eb; padding-bottom: 10px; display: inline-block;">
              SCHOOL LEAVING CERTIFICATE
            </h2>
          </div>

          <!-- Certificate Content -->
          <div style="margin-bottom: 30px;">
            <p style="font-size: 18px; color: #374151; text-align: center; margin: 0 0 20px 0;">
              This is to certify that
            </p>
            
            <div style="text-align: center; margin-bottom: 25px;">
              <p style="font-size: 24px; font-weight: bold; color: #1f2937; margin: 0 0 10px 0;">
                ${e.studentName||`${n.firstName} ${n.lastName}`}
              </p>
            </div>

            <!-- Student Information -->
            <div style="background-color: #f9fafb; padding: 20px; border-radius: 4px; border: 1px solid #d1d5db; margin-bottom: 30px;">
              <h3 style="font-size: 18px; font-weight: bold; color: #1f2937; text-align: center; margin: 0 0 15px 0;">Student Information</h3>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; font-size: 14px;">
                <div style="display: flex;">
                  <span style="font-weight: 500; width: 160px; color: #1f2937;">Serial No:</span>
                  <span style="color: #4b5563;">${e.serialNo||"N/A"}</span>
                </div>
                <div style="display: flex;">
                  <span style="font-weight: 500; width: 160px; color: #1f2937;">G.R No:</span>
                  <span style="color: #4b5563;">${e.grNo||"N/A"}</span>
                </div>
                <div style="display: flex;">
                  <span style="font-weight: 500; width: 160px; color: #1f2937;">Student Name:</span>
                  <span style="color: #4b5563;">${e.studentName||"N/A"}</span>
                </div>
                <div style="display: flex;">
                  <span style="font-weight: 500; width: 160px; color: #1f2937;">Father's Name:</span>
                  <span style="color: #4b5563;">${e.fatherName||"N/A"}</span>
                </div>
                <div style="display: flex;">
                  <span style="font-weight: 500; width: 160px; color: #1f2937;">Caste:</span>
                  <span style="color: #4b5563;">${e.caste||"N/A"}</span>
                </div>
                <div style="display: flex;">
                  <span style="font-weight: 500; width: 160px; color: #1f2937;">Place of Birth:</span>
                  <span style="color: #4b5563;">${e.placeOfBirth||"N/A"}</span>
                </div>
                <div style="display: flex;">
                  <span style="font-weight: 500; width: 160px; color: #1f2937;">Date of Birth:</span>
                  <span style="color: #4b5563;">${e.dateOfBirth||"N/A"}</span>
                </div>
                <div style="display: flex;">
                  <span style="font-weight: 500; width: 160px; color: #1f2937;">Date in Words:</span>
                  <span style="color: #4b5563;">${e.dateOfBirthWords||"N/A"}</span>
                </div>
                <div style="display: flex;">
                  <span style="font-weight: 500; width: 160px; color: #1f2937;">Date of Admission:</span>
                  <span style="color: #4b5563;">${e.dateOfAdmission?C(e.dateOfAdmission):"N/A"}</span>
                </div>
                <div style="display: flex;">
                  <span style="font-weight: 500; width: 160px; color: #1f2937;">Last Class Attended:</span>
                  <span style="color: #4b5563;">${e.lastClassAttended||"N/A"}</span>
                </div>
                <div style="display: flex;">
                  <span style="font-weight: 500; width: 160px; color: #1f2937;">Date of Leaving:</span>
                  <span style="color: #4b5563;">${e.dateOfLeaving?C(e.dateOfLeaving):"N/A"}</span>
                </div>
                <div style="display: flex;">
                  <span style="font-weight: 500; width: 160px; color: #1f2937;">Last School Attended:</span>
                  <span style="color: #4b5563;">${e.lastSchoolAttended||"N/A"}</span>
                </div>
                <div style="display: flex;">
                  <span style="font-weight: 500; width: 160px; color: #1f2937;">Standard:</span>
                  <span style="color: #4b5563;">${e.standardStudying||"N/A"}</span>
                </div>
                <div style="display: flex;">
                  <span style="font-weight: 500; width: 160px; color: #1f2937;">Reason for Leaving:</span>
                  <span style="color: #4b5563;">${e.reasonForLeaving||"N/A"}</span>
                </div>
                <div style="display: flex;">
                  <span style="font-weight: 500; width: 160px; color: #1f2937;">Attendance:</span>
                  <span style="color: #4b5563;">${e.attendance||"N/A"}</span>
                </div>
                <div style="display: flex;">
                  <span style="font-weight: 500; width: 160px; color: #1f2937;">Remarks:</span>
                  <span style="color: #4b5563;">${e.remarks||"N/A"}</span>
                </div>
              </div>
            </div>

            <!-- Certificate Statement -->
            <div style="font-size: 18px; color: #374151; text-align: center; margin-bottom: 30px; line-height: 1.6;">
              <p style="margin: 0 0 15px 0;">
                was a bonafide student of this school and has left the institution on
                <span style="font-weight: bold;">${e.dateOfLeaving?C(e.dateOfLeaving):"N/A"}</span>.
              </p>
              ${e.reasonForLeaving?`
              <p style="margin: 0 0 15px 0;">
                Reason for leaving: <span style="font-weight: 500;">${e.reasonForLeaving}</span>
              </p>
              `:""}
              <p style="margin: 0;">
                We wish ${e.studentName?e.studentName.split(" ")[0]:n.firstName} all the best in their future endeavors.
              </p>
            </div>
          </div>

          <!-- Footer -->
          <div style="border-top: 1px solid #d1d5db; padding-top: 15px; text-align: center; font-size: 14px; color: #4b5563;">
            <p style="margin: 0 0 5px 0;">This is an official document generated on ${new Date().toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}</p>
            <p style="font-size: 12px; margin: 0;">Signature: _________________ &nbsp;&nbsp;&nbsp;&nbsp; Date: _________________</p>
          </div>
        </div>
      `}else j=f.current.innerHTML;const F=window.open("","_blank");F.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Certificate</title>
          <style>
            @media print {
              body { 
                margin: 0; 
                padding: 0; 
                background: white;
              }
              
              @page {
                size: A4;
                margin: 0.5in;
              }
            }
            
            body { 
              font-family: Arial, sans-serif; 
              margin: 0; 
              padding: 20px;
              background: white;
            }
            .certificate-container {
              max-width: 100%;
              margin: 0 auto;
            }
          </style>
        </head>
        <body>
          <div class="certificate-container">
            ${j}
          </div>
          <script>
            window.onload = function() {
              window.print();
              window.onafterprint = function() {
                window.close();
              };
            };
          <\/script>
        </body>
      </html>
    `),F.document.close()};return ne.useEffect(()=>{},[]),i.jsxs("div",{className:"fixed inset-0 bg-white z-50 overflow-auto",children:[i.jsx("div",{ref:f,className:"p-8",children:i.jsx(N_,{student:n,certificateType:a,issueDate:t,reason:r,characterDetails:s,leavingCertificateData:e})}),i.jsxs("div",{className:"fixed bottom-4 right-4 space-x-2 print:hidden",children:[i.jsx("button",{onClick:b,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Print Certificate"}),i.jsx("button",{onClick:u,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:"Close"})]})]})},j_=({student:n,onClose:a})=>{const t=Pn(),[r,s]=ne.useState("leaving"),[e,u]=ne.useState(new Date().toISOString().split("T")[0]),[f,m]=ne.useState(""),[g,b]=ne.useState("is a student of good moral character and has shown consistent academic performance throughout their time at our institution."),[j,F]=ne.useState(!1),[C,M]=ne.useState({serialNo:"",grNo:n.grNo||"",studentName:`${n.firstName} ${n.lastName}`,fatherName:n.fatherName||"",caste:n.religion||"",placeOfBirth:n.birthPlace||"",dateOfBirth:n.dateOfBirth||"",dateOfBirthWords:"",dateOfAdmission:n.dateOfAdmission||"",lastClassAttended:n.class||"",dateOfLeaving:new Date().toISOString().split("T")[0],lastSchoolAttended:n.lastSchoolAttended||"",standardStudying:n.class||"",reasonForLeaving:"",attendance:"",remarks:n.remarks||""});ne.useEffect(()=>{const Q=`SL-${new Date().getFullYear()}-${n.id}`;if(M(Z=>({...Z,serialNo:Q})),n.dateOfBirth){const Z=T(n.dateOfBirth);M(ee=>({...ee,dateOfBirth:n.dateOfBirth,dateOfBirthWords:Z}))}},[n]);const _=()=>{if(r==="leaving"){const O={...n,leavingDate:e,leavingReason:f};t(pC(O))}if(r==="pass"){const O={...n,status:"passed_out",passDate:e,passDetails:f};t(a0(O))}F(!0)},L=O=>{const Q={year:"numeric",month:"long",day:"numeric"};return new Date(O).toLocaleDateString(void 0,Q)},T=O=>{if(!O)return"";const Q=new Date(O),Z=["January","February","March","April","May","June","July","August","September","October","November","December"],ee=Q.getDate(),se=Z[Q.getMonth()],ue=Q.getFullYear();let ae="th";return ee===1||ee===21||ee===31?ae="st":ee===2||ee===22?ae="nd":(ee===3||ee===23)&&(ae="rd"),`${ee}${ae} day of ${se}, ${ue}`},H=(O,Q)=>{M(Z=>({...Z,[O]:Q})),O==="dateOfBirth"&&M(Z=>({...Z,dateOfBirthWords:T(Q)}))};return j?i.jsx(C_,{student:n,certificateType:r,issueDate:e,reason:f,characterDetails:g,leavingCertificateData:C,onClose:()=>{F(!1),a()}}):i.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:i.jsx("div",{className:"relative top-10 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white max-h-[90vh] overflow-y-auto",children:i.jsxs("div",{className:"mt-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:[i.jsx(rh,{className:"inline mr-2 text-blue-600"}),"Generate Certificate"]}),i.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-500",children:i.jsx("span",{className:"text-2xl",children:""})})]}),i.jsxs("div",{className:"mt-4",children:[i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-4",children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"Student Information"}),i.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Name:"}),i.jsxs("span",{className:"ml-2 font-medium",children:[n.firstName," ",n.lastName]})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Student ID:"}),i.jsx("span",{className:"ml-2 font-medium",children:n.id})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Class:"}),i.jsxs("span",{className:"ml-2 font-medium",children:[n.class," - Section ",n.section]})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Admission Date:"}),i.jsx("span",{className:"ml-2 font-medium",children:L(n.dateOfAdmission)})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Certificate Type"}),i.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[i.jsx("button",{type:"button",onClick:()=>s("leaving"),className:`px-4 py-2 border rounded-md text-sm font-medium ${r==="leaving"?"bg-blue-100 border-blue-500 text-blue-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Leaving Certificate"}),i.jsx("button",{type:"button",onClick:()=>s("pass"),className:`px-4 py-2 border rounded-md text-sm font-medium ${r==="pass"?"bg-blue-100 border-blue-500 text-blue-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Pass Certificate"}),i.jsx("button",{type:"button",onClick:()=>s("character"),className:`px-4 py-2 border rounded-md text-sm font-medium ${r==="character"?"bg-blue-100 border-blue-500 text-blue-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Character Certificate"})]})]}),r==="leaving"&&i.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-blue-800 mb-3",children:"Leaving Certificate Details"}),i.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"serialNo",className:"block text-sm font-medium text-gray-700 mb-1",children:"Serial No"}),i.jsx("input",{type:"text",id:"serialNo",value:C.serialNo,onChange:O=>H("serialNo",O.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",readOnly:!0})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"grNo",className:"block text-sm font-medium text-gray-700 mb-1",children:"G.R No"}),i.jsx("input",{type:"text",id:"grNo",value:C.grNo,onChange:O=>H("grNo",O.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"studentName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Student Name"}),i.jsx("input",{type:"text",id:"studentName",value:C.studentName,onChange:O=>H("studentName",O.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"fatherName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Father's Name"}),i.jsx("input",{type:"text",id:"fatherName",value:C.fatherName,onChange:O=>H("fatherName",O.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"caste",className:"block text-sm font-medium text-gray-700 mb-1",children:"Caste"}),i.jsx("input",{type:"text",id:"caste",value:C.caste,onChange:O=>H("caste",O.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"placeOfBirth",className:"block text-sm font-medium text-gray-700 mb-1",children:"Place of Birth"}),i.jsx("input",{type:"text",id:"placeOfBirth",value:C.placeOfBirth,onChange:O=>H("placeOfBirth",O.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"dateOfBirth",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth (in Figure)"}),i.jsx("input",{type:"date",id:"dateOfBirth",value:C.dateOfBirth,onChange:O=>H("dateOfBirth",O.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"dateOfBirthWords",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth (in Words)"}),i.jsx("input",{type:"text",id:"dateOfBirthWords",value:C.dateOfBirthWords,onChange:O=>H("dateOfBirthWords",O.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"dateOfAdmission",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Admission"}),i.jsx("input",{type:"date",id:"dateOfAdmission",value:C.dateOfAdmission,onChange:O=>H("dateOfAdmission",O.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"lastClassAttended",className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Class Attended"}),i.jsx("input",{type:"text",id:"lastClassAttended",value:C.lastClassAttended,onChange:O=>H("lastClassAttended",O.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"dateOfLeaving",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Leaving School"}),i.jsx("input",{type:"date",id:"dateOfLeaving",value:C.dateOfLeaving,onChange:O=>H("dateOfLeaving",O.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"lastSchoolAttended",className:"block text-sm font-medium text-gray-700 mb-1",children:"Last School Attended"}),i.jsx("input",{type:"text",id:"lastSchoolAttended",value:C.lastSchoolAttended,onChange:O=>H("lastSchoolAttended",O.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"standardStudying",className:"block text-sm font-medium text-gray-700 mb-1",children:"Standard in which studying"}),i.jsx("input",{type:"text",id:"standardStudying",value:C.standardStudying,onChange:O=>H("standardStudying",O.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"reasonForLeaving",className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason for Leaving"}),i.jsx("input",{type:"text",id:"reasonForLeaving",value:C.reasonForLeaving,onChange:O=>H("reasonForLeaving",O.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"attendance",className:"block text-sm font-medium text-gray-700 mb-1",children:"Attendance"}),i.jsx("input",{type:"text",id:"attendance",value:C.attendance,onChange:O=>H("attendance",O.target.value),placeholder:"e.g., 95%",className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"remarks",className:"block text-sm font-medium text-gray-700 mb-1",children:"Remarks"}),i.jsx("input",{type:"text",id:"remarks",value:C.remarks,onChange:O=>H("remarks",O.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"issueDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Issue Date"}),i.jsx("input",{type:"date",id:"issueDate",value:e,onChange:O=>u(O.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),r==="leaving"?i.jsxs("div",{children:[i.jsx("label",{htmlFor:"reason",className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason for Leaving (Optional)"}),i.jsx("textarea",{id:"reason",rows:3,value:f,onChange:O=>m(O.target.value),placeholder:"Enter reason for leaving the school...",className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}):i.jsxs("div",{children:[i.jsx("label",{htmlFor:"characterDetails",className:"block text-sm font-medium text-gray-700 mb-1",children:"Character Details"}),i.jsx("textarea",{id:"characterDetails",rows:4,value:g,onChange:O=>b(O.target.value),placeholder:"Enter details about the student's character, conduct, and achievements...",className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]}),i.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[i.jsxs("h4",{className:"font-medium text-blue-800 mb-2 flex items-center",children:[i.jsx(A5,{className:"mr-2"})," Certificate Preview"]}),i.jsx("div",{className:"border-2 border-dashed border-blue-200 rounded-lg p-4",children:i.jsxs("div",{className:"text-center",children:[i.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:r==="leaving"?"SCHOOL LEAVING CERTIFICATE":r==="pass"?"PASS CERTIFICATE":"CHARACTER CERTIFICATE"}),i.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"This is to certify that"}),i.jsx("p",{className:"text-lg font-semibold text-gray-900",children:r==="leaving"&&C.studentName?C.studentName:`${n.firstName} ${n.lastName}`}),r==="leaving"?i.jsxs("div",{className:"mt-4",children:[i.jsxs("div",{className:"bg-gray-50 p-4 rounded border border-gray-300 mb-6 text-left",children:[i.jsx("h4",{className:"font-bold text-gray-800 mb-3 text-center",children:"Student Information"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-32",children:"Serial No:"}),i.jsx("span",{children:C.serialNo||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-32",children:"G.R No:"}),i.jsx("span",{children:C.grNo||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-32",children:"Student Name:"}),i.jsx("span",{children:C.studentName||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-32",children:"Father's Name:"}),i.jsx("span",{children:C.fatherName||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-32",children:"Caste:"}),i.jsx("span",{children:C.caste||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-32",children:"Place of Birth:"}),i.jsx("span",{children:C.placeOfBirth||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-32",children:"Date of Birth:"}),i.jsx("span",{children:C.dateOfBirth||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-32",children:"Date in Words:"}),i.jsx("span",{children:C.dateOfBirthWords||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-32",children:"Date of Admission:"}),i.jsx("span",{children:C.dateOfAdmission||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-32",children:"Last Class:"}),i.jsx("span",{children:C.lastClassAttended||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-32",children:"Date of Leaving:"}),i.jsx("span",{children:C.dateOfLeaving||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-32",children:"Last School:"}),i.jsx("span",{children:C.lastSchoolAttended||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-32",children:"Standard:"}),i.jsx("span",{children:C.standardStudying||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-32",children:"Reason:"}),i.jsx("span",{children:C.reasonForLeaving||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-32",children:"Attendance:"}),i.jsx("span",{children:C.attendance||"N/A"})]}),i.jsxs("div",{className:"flex",children:[i.jsx("span",{className:"font-medium w-32",children:"Remarks:"}),i.jsx("span",{children:C.remarks||"N/A"})]})]})]}),i.jsxs("div",{className:"text-sm text-gray-700",children:[i.jsxs("p",{className:"text-center mb-2",children:["was a bonafide student of this school and has left the institution on"," ",i.jsx("span",{className:"font-medium",children:C.dateOfLeaving?L(C.dateOfLeaving):L(e)}),"."]}),(C.reasonForLeaving||f)&&i.jsxs("p",{className:"text-center",children:["Reason: ",i.jsx("span",{className:"font-medium",children:C.reasonForLeaving||f})]})]})]}):r==="pass"?i.jsxs("div",{className:"mt-4 text-sm text-gray-700",children:[i.jsxs("p",{children:["has successfully passed the final examination and is awarded this certificate on"," ",i.jsx("span",{className:"font-medium",children:L(e)}),"."]}),f&&i.jsxs("p",{className:"mt-2",children:["Additional Details: ",i.jsx("span",{className:"font-medium",children:f})]})]}):i.jsx("div",{className:"mt-4 text-sm text-gray-700",children:g&&i.jsx("p",{className:"mt-2 font-medium",children:g})}),i.jsxs("div",{className:"mt-6 flex justify-between text-sm text-gray-600",children:[i.jsx("div",{children:i.jsxs("p",{children:["Date: ",L(e)]})}),i.jsxs("div",{children:[i.jsx("p",{children:"Principal's Signature"}),i.jsx("div",{className:"mt-8 border-t border-gray-400 pt-2",children:"Principal"})]})]})]})})]})]}),i.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[i.jsx("button",{type:"button",onClick:a,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),i.jsxs("button",{type:"button",onClick:_,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(mi,{className:"mr-2"}),"Generate & Print Certificate"]})]})]})]})})})},B_=()=>{Pn();const{students:n}=rr(fe=>fe.students),[a,t]=ne.useState(""),[r,s]=ne.useState(""),[e,u]=ne.useState(""),[f,m]=ne.useState("all"),[g,b]=ne.useState(!1),[j,F]=ne.useState(null),[C,M]=ne.useState(1),[_]=ne.useState(10),L=[...new Set(n.map(fe=>fe.class))],T=r?[...new Set(n.filter(fe=>fe.class===r).map(fe=>fe.section))]:[],O=n.filter(fe=>{const ke=`${fe.firstName} ${fe.lastName}`.toLowerCase().includes(a.toLowerCase())||fe.email.toLowerCase().includes(a.toLowerCase())||fe.class.toLowerCase().includes(a.toLowerCase())||fe.id.toLowerCase().includes(a.toLowerCase()),he=!r||fe.class===r,Ne=!e||fe.section===e,xe=f==="all"||f==="leaving"&&fe.status==="left"||f==="pass"&&fe.status==="passed_out"||f==="character"&&fe.status!=="left"&&fe.status!=="passed_out";return ke&&he&&Ne&&xe}),Q=Math.ceil(O.length/_),Z=C*_,ee=Z-_,se=O.slice(ee,Z);At.useEffect(()=>{M(1)},[a,r,e,f]);const ue=fe=>M(fe),ae=()=>M(fe=>Math.min(fe+1,Q)),pe=()=>M(fe=>Math.max(fe-1,1)),z=O.filter(fe=>fe.status==="left"||fe.status==="passed_out"),J=O.filter(fe=>fe.status!=="left"&&fe.status!=="passed_out"),ge=fe=>{F(fe),b(!0)};return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"",children:[i.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Certificates"}),i.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Generate and manage student certificates"})]})}),i.jsx("div",{className:"my-4",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl shadow p-4 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-blue-100 text-xs font-medium",children:"Total Students"}),i.jsx("p",{className:"text-2xl font-bold mt-1",children:n.length})]}),i.jsx("div",{className:"p-2 bg-blue-400 bg-opacity-30 rounded-full",children:i.jsx(_c,{size:20})})]})}),i.jsx("div",{className:"bg-gradient-to-r from-red-500 to-red-600 rounded-xl shadow p-4 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-red-100 text-xs font-medium",children:"Left Students"}),i.jsx("p",{className:"text-2xl font-bold mt-1",children:z.length})]}),i.jsx("div",{className:"p-2 bg-red-400 bg-opacity-30 rounded-full",children:i.jsx(Tc,{size:20})})]})}),i.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-xl shadow p-4 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-green-100 text-xs font-medium",children:"Studying Students"}),i.jsx("p",{className:"text-2xl font-bold mt-1",children:J.length})]}),i.jsx("div",{className:"p-2 bg-green-400 bg-opacity-30 rounded-full",children:i.jsx(cA,{size:20})})]})})]})}),i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Student Certificates"}),i.jsx("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[i.jsxs("div",{className:"relative flex-grow max-w-md",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Bi,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"text",placeholder:"Search students...",value:a,onChange:fe=>t(fe.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(io,{className:"text-gray-400"}),i.jsxs("select",{value:r,onChange:fe=>{s(fe.target.value),u("")},className:"block w-full pl-3 pr-10 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"All Classes"}),L.map(fe=>i.jsx("option",{value:fe,children:fe},fe))]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(io,{className:"text-gray-400"}),i.jsxs("select",{value:e,onChange:fe=>u(fe.target.value),disabled:!r,className:"block w-full pl-3 pr-10 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"All Sections"}),T.map(fe=>i.jsx("option",{value:fe,children:fe},fe))]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(rh,{className:"text-gray-400"}),i.jsxs("select",{value:f,onChange:fe=>m(fe.target.value),className:"block w-full pl-3 pr-10 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"all",children:"All Certificates"}),i.jsx("option",{value:"leaving",children:"Leaving Certificates"}),i.jsx("option",{value:"pass",children:"Pass Certificates"}),i.jsx("option",{value:"character",children:"Character Certificates"})]})]}),i.jsx("div",{className:"flex items-center space-x-2",children:i.jsx("button",{onClick:()=>{t(""),s(""),u(""),m("all")},className:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Clear Filters"})})]})]})}),i.jsx("div",{className:"overflow-hidden rounded-lg border border-gray-200",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class/Section"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Certificates"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:se.map(fe=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"bg-gray-200 border-2 border-dashed rounded-xl w-10 h-10 flex items-center justify-center",children:i.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})}),i.jsxs("div",{className:"ml-4",children:[i.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[fe.firstName," ",fe.lastName]}),i.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",fe.id]})]})]})}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[i.jsx("div",{className:"text-sm text-gray-900",children:fe.class}),i.jsxs("div",{className:"text-sm text-gray-500",children:["Section ",fe.section]})]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${fe.status==="left"||fe.status==="passed_out"?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:fe.status==="left"?"Left School":fe.status==="passed_out"?"Passed Out":"Studying"})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("div",{className:"flex flex-col space-y-1",children:fe.status==="left"?i.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[i.jsx(rh,{className:"mr-1"})," Leaving Certificate"]}):fe.status==="passed_out"?i.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[i.jsx(rh,{className:"mr-1"})," Pass Certificate"]}):i.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:[i.jsx(rh,{className:"mr-1"})," Character Certificate"]})})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:i.jsx("div",{className:"flex justify-end space-x-2",children:i.jsxs("button",{onClick:()=>ge(fe),className:"inline-flex items-center px-3 py-1 border border-transparent rounded-lg text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700",children:[i.jsx(rh,{className:"mr-1"})," Generate"]})})})]},fe.id))})]})}),O.length===0&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(rh,{className:"mx-auto h-12 w-12 text-gray-400"}),i.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No students found"}),i.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Try adjusting your search or filter criteria"})]}),O.length>_&&i.jsx("div",{className:"mt-4",children:i.jsx(Bd,{currentPage:C,totalPages:Q,itemsPerPage:_,totalItems:O.length,paginate:ue,nextPage:ae,prevPage:pe})})]})]}),g&&j&&i.jsx(j_,{student:j,onClose:()=>{b(!1),F(null)}})]})},S_=({examSlip:n,student:a,exam:t,onPrint:r,onDownload:s,schoolInfo:e})=>{const u=n||{},f=a||{},m=t||{},g={schoolName:e?.schoolName||e?.name||"School Management System",schoolAddress:e?.schoolAddress||e?.address||"123 Education Street, Learning City",schoolPhone:e?.schoolPhone||e?.phone||"+1 (555) 123-4567"};return i.jsxs("div",{className:"w-full mx-auto bg-white font-sans",children:[i.jsxs("div",{className:"text-center border-b border-gray-300 pb-2 mb-3 print:hidden",children:[i.jsxs("div",{className:"flex items-center justify-center mb-1",children:[i.jsx(fA,{className:"text-blue-600 text-lg mr-2"}),i.jsx("h1",{className:"text-lg font-bold text-gray-800",children:g.schoolName})]}),i.jsx("p",{className:"text-gray-600 text-xs mb-1",children:g.schoolAddress}),i.jsxs("p",{className:"text-gray-600 text-xs",children:["Phone: ",g.schoolPhone]})]}),i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-base font-bold text-gray-800",children:"Exam Slip"}),i.jsxs("p",{className:"text-gray-600 text-xs",children:["ID: ",u.id||"N/A"]})]}),i.jsxs("div",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium",children:[m.name||"N/A"," - ",m.examType||"N/A"]})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("h3",{className:"font-bold text-gray-800 mb-2 text-xs flex items-center",children:[i.jsx(Pi,{className:"mr-2 text-blue-600 text-xs"})," Student Information"]}),i.jsx("div",{className:"bg-gray-50 p-2 rounded",children:i.jsxs("div",{className:"grid grid-cols-3 gap-1 text-xs",children:[i.jsx("span",{className:"font-medium col-span-1",children:"Name:"}),i.jsxs("span",{className:"col-span-2",children:[f.firstName||""," ",f.lastName||""]}),i.jsx("span",{className:"font-medium col-span-1",children:"Class:"}),i.jsxs("span",{className:"col-span-2",children:[f.class||"N/A"," - Section ",f.section||"N/A"]}),i.jsx("span",{className:"font-medium col-span-1",children:"Roll No:"}),i.jsx("span",{className:"col-span-2",children:u.rollNumber||"N/A"})]})})]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("h3",{className:"font-bold text-gray-800 mb-2 text-xs flex items-center",children:[i.jsx(xd,{className:"mr-2 text-blue-600 text-xs"})," Exam Schedule"]}),i.jsxs("div",{className:"border rounded",children:[i.jsxs("div",{className:"grid grid-cols-4 gap-1 p-2 bg-gray-50 border-b text-xs font-medium",children:[i.jsx("span",{className:"col-span-1",children:"Subject"}),i.jsx("span",{className:"text-center",children:"Date"}),i.jsx("span",{className:"text-center",children:"Time"}),i.jsx("span",{className:"text-center",children:"Room"})]}),i.jsx("div",{className:"divide-y divide-gray-200",children:u.subjects&&u.subjects.map((b,j)=>i.jsxs("div",{className:"grid grid-cols-4 gap-1 p-2 text-xs",children:[i.jsx("span",{className:"col-span-1",children:b.name}),i.jsx("span",{className:"text-center",children:b.date||"N/A"}),i.jsx("span",{className:"text-center",children:b.time||"N/A"}),i.jsx("span",{className:"text-center",children:b.room||"N/A"})]},j))})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-xs font-medium text-gray-700 mb-1",children:"Exam Date"}),i.jsx("div",{className:"bg-gray-50 p-2 rounded border text-xs",children:m.startDate||"N/A"})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-xs font-medium text-gray-700 mb-1",children:"Reporting Time"}),i.jsx("div",{className:"bg-gray-50 p-2 rounded border text-xs",children:"30 minutes before exam"})]})]}),i.jsxs("div",{className:"mb-3",children:[i.jsx("h3",{className:"font-bold text-gray-800 mb-2 text-xs",children:"Important Instructions"}),i.jsx("div",{className:"bg-blue-50 p-2 rounded border border-blue-200 text-xs",children:i.jsxs("ul",{className:"list-disc pl-4 space-y-1",children:[i.jsx("li",{children:"Bring your admit card and valid ID to the examination hall"}),i.jsx("li",{children:"Arrive at least 30 minutes before the exam starts"}),i.jsx("li",{children:"No electronic devices are allowed in the examination hall"}),i.jsx("li",{children:"Follow all instructions given by the invigilators"})]})})]}),i.jsxs("div",{className:"flex justify-center space-x-3 mt-4 mb-3 print:hidden",children:[i.jsxs("button",{onClick:r,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded text-xs hover:bg-blue-700 transition-colors",children:[i.jsx("svg",{className:"h-4 w-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Print"]}),i.jsxs("button",{onClick:s,className:"flex items-center px-4 py-2 bg-green-600 text-white rounded text-xs hover:bg-green-700 transition-colors",children:[i.jsx("svg",{className:"h-4 w-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Save PDF"]})]}),i.jsxs("div",{className:"text-center text-xs text-gray-500 mt-3 pt-2 border-t border-gray-200 print:hidden",children:[i.jsxs("p",{children:["Generated on ",new Date().toLocaleDateString()]}),i.jsx("p",{className:"mt-1",children:"Official School Document"})]}),i.jsx("style",{children:`
        @media print {
          body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          }
          
          .print-container {
            padding: 15px;
            max-width: 100%;
          }
          
          .print-hidden {
            display: none !important;
          }
          
          @page {
            size: A4;
            margin: 0.5in;
          }
          
          .exam-slip-print-view {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: visible;
          }
          
          /* Enhanced print styling */
          .text-center { text-align: center; }
          .flex { display: flex; }
          .items-center { align-items: center; }
          .justify-center { justify-content: center; }
          .justify-between { justify-content: space-between; }
          .border-b { border-bottom: 1px solid #d1d5db; }
          .border-gray-300 { border-color: #d1d5db; }
          .pb-2 { padding-bottom: 0.5rem; }
          .mb-3 { margin-bottom: 0.75rem; }
          .text-lg { font-size: 1.125rem; }
          .text-base { font-size: 1rem; }
          .font-bold { font-weight: 700; }
          .text-gray-800 { color: #1f2937; }
          .text-gray-600 { color: #4b5563; }
          .text-xs { font-size: 0.75rem; }
          .bg-blue-100 { background-color: #dbeafe; }
          .text-blue-600 { color: #2563eb; }
          .text-blue-800 { color: #1e40af; }
          .px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
          .py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
          .rounded { border-radius: 0.25rem; }
          .font-medium { font-weight: 500; }
          .mb-2 { margin-bottom: 0.5rem; }
          .bg-gray-50 { background-color: #f9fafb; }
          .p-2 { padding: 0.5rem; }
          .grid { display: grid; }
          .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
          .grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
          .grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
          .gap-1 { gap: 0.25rem; }
          .gap-2 { gap: 0.5rem; }
          .col-span-1 { grid-column: span 1 / span 1; }
          .col-span-2 { grid-column: span 2 / span 2; }
          .border { border: 1px solid #d1d5db; }
          .divide-y > :not([hidden]) ~ :not([hidden]) { border-top: 1px solid #e5e7eb; }
          .divide-gray-200 > :not([hidden]) ~ :not([hidden]) { border-color: #e5e7eb; }
          .text-right { text-align: right; }
          .bg-blue-50 { background-color: #eff6ff; }
          .border-blue-200 { border-color: #bfdbfe; }
          .list-disc { list-style-type: disc; }
          .pl-4 { padding-left: 1rem; }
          .space-y-1 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.25rem; }
        }
      `})]})},F_=({examSlips:n,students:a,exams:t,schoolInfo:r})=>{if(!n||n.length===0)return null;const s={schoolName:r?.schoolName||r?.name||"School Management System"};return i.jsxs("div",{className:"w-full mx-auto bg-white font-sans bulk-exam-slip-print-view",children:[i.jsx("div",{className:"print-container",children:n.map((e,u)=>{const f=a?.find(F=>F.id===e.studentId)||{},m=t?.find(F=>F.id===e.examId)||{},g=f?`${f.firstName} ${f.lastName}`:e.studentName||"N/A",b=e.className||"N/A",j=e.sectionName||"N/A";return i.jsxs("div",{className:"exam-slip",children:[i.jsx("div",{className:"text-center mb-2",children:i.jsxs("div",{className:"flex items-center justify-center",children:[i.jsx("img",{src:Ub,alt:"School Logo",className:"h-8 mr-2"}),i.jsx("h1",{className:"text-base font-bold text-gray-800",children:s.schoolName})]})}),i.jsxs("div",{className:"flex items-start mb-2",children:[i.jsxs("div",{className:"flex-grow",children:[i.jsx("div",{className:"font-bold text-gray-800 text-base",children:g}),i.jsxs("div",{className:"text-gray-600 text-xs",children:["ID: ",e.id||"N/A"]}),i.jsxs("div",{className:"text-gray-600 text-xs",children:["Class: ",b," - ",j]}),i.jsxs("div",{className:"text-gray-600 text-xs",children:["Roll: ",e.rollNumber||"N/A"]})]}),i.jsx("div",{className:"ml-2",children:f?.photo?i.jsx("img",{src:f.photo,alt:"Student",className:"w-16 h-16 rounded object-cover border border-gray-300"}):i.jsx("div",{className:"w-16 h-16 rounded bg-gray-200 border border-gray-300 flex items-center justify-center",children:i.jsx(Pi,{className:"text-gray-500 text-xl"})})})]}),i.jsxs("div",{className:"mb-2",children:[i.jsx("div",{className:"font-bold text-gray-800 text-xs mb-1",children:"Exam Schedule"}),i.jsxs("div",{className:"border rounded",children:[i.jsxs("div",{className:"grid grid-cols-3 gap-0 bg-gray-100 border-b text-xs font-medium p-1",children:[i.jsx("span",{className:"p-1",children:"Subject"}),i.jsx("span",{className:"text-center p-1",children:"Date"}),i.jsx("span",{className:"text-center p-1",children:"Time"})]}),i.jsx("div",{children:e.subjects&&e.subjects.map((F,C)=>i.jsxs("div",{className:"grid grid-cols-3 gap-0 border-b border-gray-200 last:border-0",children:[i.jsx("span",{className:"p-1 text-xs",children:F.name}),i.jsx("span",{className:"text-center p-1 text-xs",children:F.date||"N/A"}),i.jsx("span",{className:"text-center p-1 text-xs",children:F.time||"N/A"})]},C))})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[i.jsxs("div",{className:"bg-gray-50 p-1 rounded",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Exam Date"}),i.jsx("div",{className:"text-xs font-medium",children:m.startDate||"N/A"})]}),i.jsxs("div",{className:"bg-gray-50 p-1 rounded",children:[i.jsx("div",{className:"text-xs text-gray-600",children:"Report Time"}),i.jsx("div",{className:"text-xs font-medium",children:"30 mins early"})]})]})]},e.id)})}),i.jsx("style",{children:`
        @media print {
          body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          }
          
          .print-container {
            padding: 5px;
            max-width: 100%;
          }
          
          .exam-slip {
            break-inside: avoid;
            padding: 10px;
            box-sizing: border-box;
            page-break-inside: avoid;
            margin-bottom: 0;
            /* Fit 2 exam slips per page - top and bottom */
            height: 45vh;
          }
          
          @page {
            size: A4;
            margin: 0.2in;
          }
          
          .bulk-exam-slip-print-view {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: visible;
          }
          
          /* Enhanced print styling */
          .flex { display: flex; }
          .items-center { align-items: center; }
          .items-start { align-items: flex-start; }
          .flex-grow { flex-grow: 1; }
          .font-bold { font-weight: 700; }
          .text-gray-800 { color: #1f2937; }
          .text-gray-600 { color: #4b5563; }
          .text-base { font-size: 1rem; }
          .text-xs { font-size: 0.75rem; }
          .mb-2 { margin-bottom: 0.5rem; }
          .mb-1 { margin-bottom: 0.25rem; }
          .ml-2 { margin-left: 0.5rem; }
          .w-16 { width: 4rem; }
          .h-16 { height: 4rem; }
          .h-8 { height: 2rem; }
          .rounded { border-radius: 0.25rem; }
          .object-cover { object-fit: cover; }
          .border { border: 1px solid #d1d5db; }
          .border-b { border-bottom: 1px solid #d1d5db; }
          .last\\:border-0:last-child { border-bottom: 0; }
          .border-gray-300 { border-color: #d1d5db; }
          .border-gray-200 { border-color: #e5e7eb; }
          .bg-gray-200 { background-color: #e5e7eb; }
          .bg-gray-100 { background-color: #f3f4f6; }
          .bg-gray-50 { background-color: #f9fafb; }
          .p-1 { padding: 0.25rem; }
          .grid { display: grid; }
          .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
          .grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
          .gap-0 { gap: 0; }
          .gap-1 { gap: 0.25rem; }
          .text-center { text-align: center; }
          .justify-center { justify-content: center; }
        }
        
        /* Screen styles */
        .exam-slip {
          margin-bottom: 1rem;
          box-shadow: 0 1px 3px rgba(0,0,0,0.1);
          padding: 1rem;
          border-radius: 0.25rem;
        }
        
        .bulk-exam-slip-print-view {
          overflow: auto;
        }
      `})]})},E_=()=>{Pn();const{exams:n}=rr(z=>z.exams),{students:a}=rr(z=>z.students),t=rr(z=>z.settings.schoolInfo),[r,s]=ne.useState(""),[e,u]=ne.useState(""),[f,m]=ne.useState(""),[g,b]=ne.useState([]),[j,F]=ne.useState(!1),[C,M]=ne.useState(null),[_,L]=ne.useState(!1),T=[...new Set(n.map(z=>z.class))],H=[...new Set(a.map(z=>z.class))],O=T.length>0?T:H,Q=z=>n.find(ge=>ge.class===z)?[...new Set(n.filter(ge=>ge.class===z).map(ge=>ge.section))]:[],Z=(z,J)=>n.filter(ge=>ge.class===z&&(J?ge.section===J:!0)),ee=(z,J)=>a.filter(ge=>ge.class===z&&(J?ge.section===J:!0)),se=()=>{if(!r||!e)return;const z=n.find(fe=>fe.id===r),ge=ee(e,f).map(fe=>({id:`${z.id}-${fe.id}`,examId:z.id,studentId:fe.id,studentName:`${fe.firstName} ${fe.lastName}`,className:fe.class,sectionName:fe.section,examName:z.name,examType:z.examType,examDate:z.startDate,subjects:z.subjects,rollNumber:fe.id.padStart(3,"0")}));b(ge)},ue=()=>{L(!0)},ae=()=>{alert("PDF download functionality would be implemented here")},pe=z=>{const J=n.find(fe=>fe.id===z.examId),ge=a.find(fe=>fe.id===z.studentId);M({slip:z,exam:J,student:ge}),F(!0)};return j&&C?i.jsx("div",{className:"absolute inset-0 bg-white z-50 p-0 m-0 overflow-hidden",children:i.jsxs("div",{className:"print-container",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4 p-4 bg-white border-b print:hidden",children:[i.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Exam Slip Print Preview"}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsxs("button",{onClick:()=>window.print(),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700",children:[i.jsx(mi,{className:"mr-2"})," Print Slip"]}),i.jsx("button",{onClick:()=>F(!1),className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Back to Generator"})]})]}),i.jsx("div",{className:"pb-20",children:i.jsx(S_,{examSlip:C.slip,student:C.student,exam:C.exam,onPrint:()=>window.print(),onDownload:()=>alert("PDF download functionality would be implemented here"),schoolInfo:t})})]})}):_&&g.length>0?i.jsx("div",{className:"absolute inset-0 bg-white z-50 p-0 m-0",children:i.jsxs("div",{className:"print-container h-full flex flex-col",children:[i.jsxs("div",{className:"print:hidden flex justify-between items-center mb-4 p-4 bg-white border-b print:border-b-0 print:p-0 print:hidden sticky top-0 z-10",children:[i.jsx("h1",{className:"print:hidden text-xl font-bold text-gray-900",children:"Bulk Exam Slips Print Preview"}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsxs("button",{onClick:()=>window.print(),className:"print:hidden inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700",children:[i.jsx(mi,{className:"mr-2"})," Print All Slips"]}),i.jsx("button",{onClick:()=>L(!1),className:"print:hidden inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Back to Generator"})]})]}),i.jsx("div",{className:"flex-1 p-4 print:p-0 print:flex-none",children:i.jsx(F_,{examSlips:g,students:a,exams:n,schoolInfo:t})})]})}):i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Exam Slip Generator"}),i.jsx("div",{className:"flex space-x-2",children:g.length>0&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:ue,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(mi,{className:"mr-2"})," Print All"]}),i.jsxs("button",{onClick:ae,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(lu,{className:"mr-2"})," Download All PDF"]})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),i.jsxs("select",{value:e,onChange:z=>{u(z.target.value),m(""),s("")},className:"block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"Select Class"}),O.map((z,J)=>i.jsx("option",{value:z,children:z},J))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Section"}),i.jsxs("select",{value:f,onChange:z=>{m(z.target.value),s("")},disabled:!e,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",children:[i.jsx("option",{value:"",children:"Select Section"}),e&&Q(e).map((z,J)=>i.jsx("option",{value:z,children:z},J))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Examination"}),i.jsxs("select",{value:r,onChange:z=>s(z.target.value),disabled:!e,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",children:[i.jsx("option",{value:"",children:"Select Examination"}),e&&Z(e,f).map(z=>i.jsxs("option",{value:z.id,children:[z.name," (",z.examType,")"]},z.id))]})]}),i.jsx("div",{className:"flex items-end",children:i.jsxs("button",{onClick:se,disabled:!r,className:"w-full inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[i.jsx(Yk,{className:"mr-2"})," Generate Slips"]})})]}),g.length>0&&i.jsxs("div",{className:"print-area",children:[i.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Generated Exam Slips (",g.length," students)"]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map(z=>i.jsxs("div",{className:"border border-gray-300 rounded-lg p-6 print:border print:p-4",children:[i.jsxs("div",{className:"text-center mb-4",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"SCHOOL EXAMINATION SLIP"}),i.jsxs("p",{className:"text-gray-600",children:[z.examName," - ",z.examType]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Student Name"}),i.jsx("p",{className:"font-medium",children:z.studentName})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Roll Number"}),i.jsx("p",{className:"font-medium",children:z.rollNumber})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Class"}),i.jsxs("p",{className:"font-medium",children:[z.className," - ",z.sectionName]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-500",children:"Exam Date"}),i.jsx("p",{className:"font-medium",children:z.examDate})]})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Exam Schedule"}),i.jsxs("table",{className:"w-full text-sm",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b",children:[i.jsx("th",{className:"text-left py-1",children:"Subject"}),i.jsx("th",{className:"text-left py-1",children:"Date"}),i.jsx("th",{className:"text-left py-1",children:"Time"})]})}),i.jsx("tbody",{children:z.subjects.map((J,ge)=>i.jsxs("tr",{className:"border-b",children:[i.jsx("td",{className:"py-1",children:J.name}),i.jsx("td",{className:"py-1",children:J.date}),i.jsx("td",{className:"py-1",children:J.time})]},ge))})]})]}),i.jsx("div",{className:"flex justify-center mt-4",children:i.jsxs("button",{onClick:()=>pe(z),className:"inline-flex items-center px-3 py-1 border border-gray-300 text-xs font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(mi,{className:"mr-1"})," View Slip"]})}),i.jsxs("div",{className:"text-xs text-gray-500 mt-4",children:[i.jsx("p",{children:"Please bring your admit card and ID card to the examination hall."}),i.jsx("p",{children:"Reporting time is 30 minutes before the scheduled exam time."})]})]},z.id))})]})]})},k_=()=>{const n=Pn(),{exams:a}=rr(z=>z.exams),{students:t}=rr(z=>z.students),{marks:r}=rr(z=>z.marks),s=ne.useMemo(()=>{if(Array.isArray(r))return r;if(r&&typeof r=="object"&&r.marks&&Array.isArray(r.marks))return r.marks;if(r&&typeof r=="object"){const z=[];return Object.keys(r).forEach(J=>{J==="marks"&&Array.isArray(r[J])?z.push(...r[J]):typeof r[J]=="object"&&r[J]!==null&&(Array.isArray(r[J])?z.push(...r[J]):r[J].marks&&Array.isArray(r[J].marks)?z.push(...r[J].marks):r[J].examType&&z.push(r[J]))}),z}return[]},[r]),[e,u]=ne.useState(""),[f,m]=ne.useState(""),[g,b]=ne.useState(""),[j,F]=ne.useState(""),[C,M]=ne.useState("list"),_=[...new Set(a.map(z=>z.class))],L=[...new Set(t.map(z=>z.class))],T=_.length>0?_:L,H=z=>z?t.filter(ge=>ge.class===z&&ge.section).map(ge=>ge.section).filter((ge,fe,ke)=>ke.indexOf(ge)===fe).sort():[],O=(z,J)=>a.filter(ge=>ge.class===z&&(J?ge.section===J:!0)),Q=(z,J)=>t.filter(ge=>ge.class===z&&(J?ge.section===J:!0)),Z=z=>z?s.filter(J=>J.examId===z):[],se=(()=>{if(!e)return null;const z=Z(e);if(z.length===0)return null;const J=z.length,ge=z.map(Ne=>{const xe=parseFloat(Ne.totalObtained||0),we=parseFloat(Ne.totalMarks||1);return we>0?xe/we*100:0}),fe=ge.reduce((Ne,xe)=>Ne+xe,0)/J,ke={"A+":0,A:0,"B+":0,B:0,C:0,D:0,F:0};ge.forEach(Ne=>{let xe="F";Ne>=90?xe="A+":Ne>=80?xe="A":Ne>=70?xe="B+":Ne>=60?xe="B":Ne>=50?xe="C":Ne>=40&&(xe="D"),ke[xe]++});const he={};return z.forEach(Ne=>{Ne.marks&&Array.isArray(Ne.marks)&&Ne.marks.forEach(xe=>{const we=xe.subjectName||xe.subject||"Unknown";he[we]||(he[we]={total:0,count:0,average:0});const ye=parseFloat(xe.marksObtained||0),te=parseFloat(xe.totalMarks||1),V=te>0?ye/te*100:0;he[we].total+=V,he[we].count++})}),Object.keys(he).forEach(Ne=>{he[Ne].average=he[Ne].count>0?he[Ne].total/he[Ne].count:0}),{totalStudents:J,averagePercentage:fe.toFixed(2),gradeDistribution:ke,subjectPerformance:he}})(),ue=z=>{if(!e)return null;const J=String(z);return s.find(fe=>String(fe.studentId||"")===J&&fe.examId===e)},pe=(()=>{if(!e)return[];const J=Q(f,g).map(ge=>{const fe=ue(ge.id);return{...ge,marks:fe,percentage:fe?parseFloat(fe.percentage||0):0,totalObtained:fe?parseFloat(fe.totalObtained||0):0}});return J.sort((ge,fe)=>fe.percentage-ge.percentage),J.map((ge,fe)=>({...ge,rank:fe+1}))})().filter(z=>`${z.firstName} ${z.lastName}`.toLowerCase().includes(j.toLowerCase())||z.id.toString().includes(j));return ne.useEffect(()=>{f||(b(""),u(""))},[f]),ne.useEffect(()=>{u("")},[g]),ne.useEffect(()=>{n(qu())},[n,e]),i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Exam Results Tracker"}),i.jsx("p",{className:"text-gray-600",children:"Track and analyze student performance in examinations"})]}),i.jsxs("div",{className:"flex space-x-2 mt-4 md:mt-0",children:[i.jsx("button",{onClick:()=>n(qu()),className:"px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-800 hover:bg-gray-200",children:"Refresh"}),i.jsx("button",{onClick:()=>M("list"),className:`px-4 py-2 rounded-lg text-sm font-medium ${C==="list"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800 hover:bg-gray-200"}`,children:"List View"}),i.jsx("button",{onClick:()=>M("chart"),className:`px-4 py-2 rounded-lg text-sm font-medium ${C==="chart"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800 hover:bg-gray-200"}`,children:"Charts"}),i.jsx("button",{onClick:()=>M("summary"),className:`px-4 py-2 rounded-lg text-sm font-medium ${C==="summary"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800 hover:bg-gray-200"}`,children:"Summary"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),i.jsxs("select",{value:f,onChange:z=>{m(z.target.value),b(""),u("")},className:"block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"Select Class"}),T.map((z,J)=>i.jsx("option",{value:z,children:z},J))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Section"}),i.jsxs("select",{value:g,onChange:z=>{b(z.target.value),u("")},disabled:!f,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",children:[i.jsx("option",{value:"",children:"All Sections"}),f&&H(f).map((z,J)=>i.jsx("option",{value:z,children:z},J))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Examination"}),i.jsxs("select",{value:e,onChange:z=>u(z.target.value),disabled:!f,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100",children:[i.jsx("option",{value:"",children:"Select Examination"}),f&&O(f,g).map(z=>i.jsxs("option",{value:z.id,children:[z.name," (",z.examType,")"]},z.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Students"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Bi,{className:"text-gray-400"})}),i.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Search by name or ID...",value:j,onChange:z=>F(z.target.value),disabled:!e})]})]})]}),e?i.jsxs(i.Fragment,{children:[C==="summary"&&se&&i.jsxs("div",{className:"mb-8",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Exam Summary"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-blue-800",children:se.totalStudents}),i.jsx("div",{className:"text-sm text-blue-600",children:"Total Students"})]}),i.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[i.jsxs("div",{className:"text-2xl font-bold text-green-800",children:[se.averagePercentage,"%"]}),i.jsx("div",{className:"text-sm text-green-600",children:"Average Percentage"})]}),i.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-yellow-800",children:se.gradeDistribution["A+"]+se.gradeDistribution.A}),i.jsx("div",{className:"text-sm text-yellow-600",children:"A Grades"})]}),i.jsxs("div",{className:"bg-red-50 rounded-lg p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-red-800",children:se.gradeDistribution.F}),i.jsx("div",{className:"text-sm text-red-600",children:"Failed Students"})]})]}),i.jsxs("div",{className:"mb-8",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Performers"}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:pe.slice(0,3).map((z,J)=>i.jsx("div",{className:`rounded-lg p-4 ${J===0?"bg-yellow-50 border-2 border-yellow-200":J===1?"bg-gray-100 border-2 border-gray-200":"bg-orange-50 border-2 border-orange-200"}`,children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"text-2xl mr-3",children:J===0?"":J===1?"":""}),i.jsxs("div",{children:[i.jsxs("div",{className:"font-bold text-gray-900",children:[z.firstName," ",z.lastName]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Rank: ",z.rank," | ",z.percentage?z.percentage.toFixed(2):"0.00","%"]}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Grade: ",z.marks?.overallGrade||"N/A"]})]})]})},z.id))})]}),i.jsxs("div",{className:"mt-6",children:[i.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Grade Distribution"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(se.gradeDistribution).map(([z,J])=>i.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center min-w-[80px]",children:[i.jsx("div",{className:"text-lg font-bold text-gray-900",children:J}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Grade ",z]})]},z))})]}),i.jsxs("div",{className:"mt-6",children:[i.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Subject Performance"}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(se.subjectPerformance).map(([z,J])=>i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[i.jsx("div",{className:"font-medium text-gray-900",children:z}),i.jsxs("div",{className:"mt-2 text-2xl font-bold text-gray-900",children:[J.average.toFixed(1),"%"]}),i.jsx("div",{className:"text-sm text-gray-600",children:"Average Score"})]},z))})]})]}),C==="list"&&i.jsxs("div",{className:"overflow-hidden rounded-lg border border-gray-200",children:[i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rank"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Marks"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Percentage"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Grade"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:pe.map(z=>{const J=ue(z.id);return i.jsxs("tr",{className:`hover:bg-gray-50 ${z.rank===1?"bg-yellow-50":z.rank===2?"bg-gray-100":z.rank===3?"bg-orange-50":""}`,children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:z.rank===1?i.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[" ",z.rank]}):z.rank===2?i.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-200 text-gray-800",children:[" ",z.rank]}):z.rank===3?i.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:[" ",z.rank]}):i.jsx("span",{className:"text-sm font-medium text-gray-900",children:z.rank})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"bg-gray-200 border-2 border-dashed rounded-xl w-10 h-10"}),i.jsxs("div",{className:"ml-4",children:[i.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[z.firstName," ",z.lastName]}),i.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",z.id]})]})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:J?`${J.totalObtained||0}/${J.totalMarks||0}`:"N/A"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:z.percentage?`${z.percentage.toFixed(2)}%`:"Pending"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:J?i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${J.overallGrade==="A+"?"bg-yellow-100 text-yellow-800":J.overallGrade==="A"?"bg-green-100 text-green-800":J.overallGrade==="B+"?"bg-blue-100 text-blue-800":J.overallGrade==="B"?"bg-indigo-100 text-indigo-800":J.overallGrade==="C"?"bg-purple-100 text-purple-800":J.overallGrade==="D"?"bg-pink-100 text-pink-800":"bg-red-100 text-red-800"}`,children:J.overallGrade||"F"}):i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"Pending"})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:J?i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Completed"}):i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Pending"})})]},z.id)})})]}),pe.length===0&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Bi,{className:"mx-auto h-12 w-12 text-gray-400"}),i.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No students found"}),i.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Try adjusting your search or filter criteria."})]})]}),C==="chart"&&se&&i.jsxs("div",{className:"mb-8",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Grade Distribution Chart"}),i.jsx("div",{className:"bg-gray-50 rounded-lg p-6",children:i.jsx("div",{className:"flex items-end justify-center h-64 space-x-2",children:Object.entries(se.gradeDistribution).map(([z,J])=>{const fe=se.totalStudents>0?J/se.totalStudents*200:0;return i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"w-12 bg-blue-500 rounded-t transition-all duration-300",style:{height:`${fe}px`}}),i.jsx("div",{className:"mt-2 text-sm font-medium text-gray-900",children:J}),i.jsxs("div",{className:"text-xs text-gray-600",children:["Grade ",z]})]},z)})})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4 mt-8",children:"Subject Performance Chart"}),i.jsx("div",{className:"bg-gray-50 rounded-lg p-6",children:i.jsx("div",{className:"space-y-4",children:Object.entries(se.subjectPerformance).map(([z,J])=>i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-32 text-sm font-medium text-gray-900 truncate",children:z}),i.jsx("div",{className:"flex-1 ml-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"flex-1 h-4 bg-gray-200 rounded-full overflow-hidden",children:i.jsx("div",{className:"h-full bg-green-500 rounded-full transition-all duration-300",style:{width:`${J.average}%`}})}),i.jsxs("div",{className:"ml-4 text-sm font-medium text-gray-900 w-16",children:[J.average.toFixed(1),"%"]})]})})]},z))})})]})]}):i.jsxs("div",{className:"text-center py-12",children:[i.jsx(wh,{className:"mx-auto h-12 w-12 text-gray-400"}),i.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No examination selected"}),i.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Please select a class, section, and examination to view results."})]})]})},D_=({exams:n=[],students:a=[],studentsSearchTerm:t="",marks:r={}})=>{console.log("=== CLASS EXAM RESULTS VIEW DEBUG ==="),console.log("Exams received:",n),console.log("Students received:",a),console.log("Marks received:",r);const s=ne.useMemo(()=>{if(Array.isArray(r))return console.log("Marks is already an array, returning as is"),r;if(r&&typeof r=="object"&&r.marks&&Array.isArray(r.marks))return console.log("Marks is Redux state object, extracting marks array"),r.marks;if(r&&typeof r=="object"){console.log("Marks is object, attempting to flatten");const T=[];return Object.keys(r).forEach(H=>{H==="marks"&&Array.isArray(r[H])?T.push(...r[H]):typeof r[H]=="object"&&r[H]!==null&&(Array.isArray(r[H])?T.push(...r[H]):r[H].marks&&Array.isArray(r[H].marks)?T.push(...r[H].marks):r[H].examType&&T.push(r[H]))}),console.log("Flattened marks result:",T),T}return console.log("No valid marks data found, returning empty array"),[]},[r]);console.log("Marks array after extraction:",s),console.log("Marks array length:",s.length),console.log("Marks array type:",typeof s),console.log("Is marks array:",Array.isArray(s));const[e,u]=ne.useState("Midterm"),[f,m]=ne.useState(""),[g,b]=ne.useState("");ne.useMemo(()=>n,[n]);const j=ne.useMemo(()=>{if(!s||!Array.isArray(s)||s.length===0)return[];const T=new Set;return s.forEach(H=>{H&&typeof H=="object"&&(H.class&&T.add(H.class),Object.keys(H).forEach(O=>{O!=="id"&&H[O]&&typeof H[O]=="object"&&H[O].class&&T.add(H[O].class)}))}),Array.from(T).sort()},[s]),F=ne.useMemo(()=>{if(console.log("=== PROCESSING MARKS ==="),console.log("Raw marks data:",s),console.log("Selected exam type:",e),console.log("Selected class:",f),!s||!Array.isArray(s)||s.length===0)return console.log("No marks data available"),[];const T=[];s.forEach((Q,Z)=>{console.log(`Processing item ${Z}:`,Q),Q&&typeof Q=="object"&&Q.examType?(console.log("Found direct marksheet object with examType:",Q.examType),Q.examType===e?(console.log("Adding marksheet object (matches filter):",Q),T.push(Q)):console.log("Skipping marksheet object (does not match filter):",Q)):Q&&typeof Q=="object"&&(console.log("Processing as nested object"),Object.keys(Q).forEach(ee=>{if(console.log(`Checking key: ${ee}`,Q[ee]),ee==="id"){console.log("Skipping id key");return}const se=Q[ee];console.log(`Value for key ${ee}:`,se),se&&typeof se=="object"&&se.examType&&(console.log("Found nested marksheet object with examType:",se.examType),se.examType===e?(console.log("Adding nested marksheet object (matches filter):",se),T.push(se)):console.log("Skipping nested marksheet object (does not match filter):",se))}))});const H=[],O=new Set;return T.forEach(Q=>{Q&&Q.studentId&&!O.has(Q.studentId)&&(O.add(Q.studentId),H.push(Q))}),console.log("Final flattened and filtered marks result (duplicates removed):",H),console.log("=== END PROCESSING MARKS ==="),H},[s,e]),C=ne.useMemo(()=>!F||!Array.isArray(F)||F.length===0?[]:f?F.filter(T=>T.class===f):F,[F,f]),M=ne.useMemo(()=>{if(console.log("=== CALCULATING RESULTS ==="),console.log("Filtered marks for results:",C),!C||!Array.isArray(C)||C.length===0)return console.log("No filtered marks for results calculation"),[];const T={};C.forEach((O,Q)=>{if(console.log(`Processing mark ${Q}:`,O),!O){console.log("Skipping null mark");return}if(!O.class||!O.section||!O.studentId){console.log("Skipping mark with missing required fields:",O);return}const Z=`${O.class}-${O.section}`;console.log(`Grouping key: ${Z}`),T[Z]||(T[Z]={class:O.class,section:O.section,students:[]},console.log(`Created new group for ${Z}`));const ee=a.find(se=>se&&se.id===O.studentId);console.log("Found student for mark:",ee),ee?(T[Z].students.push({...O,studentName:`${ee.firstName||""} ${ee.lastName||""}`.trim()||O.studentName||"Unknown Student",studentId:ee.id,status:ee.status}),console.log(`Added student to group ${Z}`)):(T[Z].students.push({...O,studentName:O.studentName||"Unknown Student",studentId:O.studentId,status:"unknown"}),console.log(`Added student to group ${Z} (student not found in students list)`))}),console.log("Grouped results before ranking:",T),Object.values(T).forEach(O=>{console.log(`Sorting group: ${O.class}-${O.section}`),O.students.sort((Q,Z)=>{const ee=parseFloat(Q.percentage||0),se=parseFloat(Z.percentage||0);return console.log(`Comparing ${Q.studentName} (${ee}) with ${Z.studentName} (${se})`),se-ee}),O.students=O.students.map((Q,Z)=>({...Q,position:Z+1,totalStudents:O.students.length})),console.log(`Ranked students in group ${O.class}-${O.section}:`,O.students)});const H=Object.values(T);return console.log("Final class results:",H),console.log("=== END CALCULATING RESULTS ==="),H},[C,a]),_=T=>{switch(T){case 1:return i.jsx(nw,{className:"text-yellow-500"});case 2:return i.jsx($2,{className:"text-gray-400"});case 3:return i.jsx($2,{className:"text-amber-700"});default:return null}},L=T=>{switch(T){case 1:return"1st";case 2:return"2nd";case 3:return"3rd";default:return`${T}th`}};return i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Class Exam Results"}),i.jsx("p",{className:"text-gray-600",children:"View and analyze student performance by class and section"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Exam Type"}),i.jsxs("select",{value:e,onChange:T=>u(T.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"Select Exam Type"}),n&&[...new Set(n.map(T=>T.examType))].map(T=>i.jsx("option",{value:T,children:T},T))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),i.jsxs("select",{value:f,onChange:T=>m(T.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500",disabled:!e,children:[i.jsx("option",{value:"",children:"All Classes"}),j.map(T=>i.jsx("option",{value:T,children:T},T))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Students"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Bi,{className:"text-gray-400"})}),i.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Search by name...",value:g,onChange:T=>b(T.target.value),disabled:!e})]})]})]}),e?M.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx(nw,{className:"mx-auto h-12 w-12 text-gray-400"}),i.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No results found"}),i.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"No marks have been entered for the selected exam type yet."})]}):i.jsx("div",{className:"space-y-8",children:M.map((T,H)=>i.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[i.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[T.class," - Section ",T.section]}),i.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[T.students.length," students"]})]}),i.jsxs("div",{className:"overflow-x-auto",children:[i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Position"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Marks"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Percentage"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Grade"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:T.students.filter(O=>O.studentName.toLowerCase().includes(g.toLowerCase())).map(O=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center",children:[_(O.position),i.jsx("span",{className:"ml-2 font-medium",children:L(O.position)})]})}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:O.studentName}),i.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",O.studentId]})]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:O.totalObtained||O.totalMarks?`${O.totalObtained||0}/${O.totalMarks||0}`:"N/A"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:O.percentage?`${parseFloat(O.percentage).toFixed(2)}%`:"N/A"}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${O.overallGrade==="A+"?"bg-yellow-100 text-yellow-800":O.overallGrade==="A"?"bg-green-100 text-green-800":O.overallGrade==="B+"?"bg-blue-100 text-blue-800":O.overallGrade==="B"?"bg-indigo-100 text-indigo-800":O.overallGrade==="C"?"bg-purple-100 text-purple-800":O.overallGrade==="D"?"bg-pink-100 text-pink-800":"bg-red-100 text-red-800"}`,children:O.overallGrade||"N/A"})})]},O.studentId))})]}),T.students.filter(O=>O.studentName.toLowerCase().includes(g.toLowerCase())).length===0&&g&&i.jsxs("div",{className:"text-center py-8",children:[i.jsx(Bi,{className:"mx-auto h-8 w-8 text-gray-400"}),i.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No matching students"}),i.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:['No students found matching "',g,'"']})]})]})]},`${T.class}-${T.section}`))}):i.jsxs("div",{className:"text-center py-12",children:[i.jsx(io,{className:"mx-auto h-12 w-12 text-gray-400"}),i.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No exam type selected"}),i.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Please select an exam type to view results."})]})]})},T_=()=>{const n=Pn(),{exams:a,loading:t,error:r}=rr(J=>J.exams),{classes:s}=rr(J=>J.classes),{students:e}=rr(J=>J.students),{marks:u}=rr(J=>J.marks),[f,m]=ne.useState(""),[g,b]=ne.useState(!1),[j,F]=ne.useState(null),[C,M]=ne.useState("list"),[_,L]=ne.useState(null),T=new Date().toISOString().split("T")[0],[H,O]=ne.useState({name:"",classes:[],section:"",examType:"",startDate:T,endDate:T,subjects:[],maxMarks:100});ne.useEffect(()=>{n(Q1()),n(gd()),n(Lc()),n(qu())},[n]),ne.useEffect(()=>{console.log("=== MARKS STATE CHANGED ==="),console.log("Marks state:",u),console.log("Marks data:",u.marks),console.log("Marks loading:",u.loading),console.log("Marks error:",u.error)},[u]);const Q=J=>{F(J),O({...J,classes:[J.class]}),b(!0)},Z=J=>{window.confirm("Are you sure you want to delete this examination?")&&n(zC(J))},ee=J=>{j?n(HC(J)):J.classes.forEach(ge=>{const fe=e.some(he=>he.class===ge&&he.academicYear===ae&&he.status!=="passed_out"&&he.status!=="left"),ke=s.some(he=>he.name===ge);if(fe||ke){const he=s.find(ye=>ye.name===ge)?.subjects||[],Ne=J.scheduledSubjects?.find(ye=>ye.className===ge)?.subjects||[],xe=he.map(ye=>{const te=ye.id||ye.name,V=Ne.find(le=>(le.id||le.name)===te);return{...ye,date:V?.date||ye.date||"",time:V?.time||ye.time||"",duration:V?.duration||ye.duration||180}}),we={...J,class:ge,subjects:xe};delete we.classes,delete we.scheduledSubjects,n(PC(we))}}),se()},se=()=>{O({name:"",classes:[],section:"",examType:"",startDate:T,endDate:T,subjects:[],maxMarks:100}),F(null),b(!1)},ue=J=>{L(J),M("detail")},ae=R1();s.filter(J=>e.some(ge=>ge.class===J.name&&ge.academicYear===ae&&ge.status!=="passed_out"&&ge.status!=="left"));const pe=s,z=a.filter(J=>J.academicYear===ae&&(J.name.toLowerCase().includes(f.toLowerCase())||J.class.toLowerCase().includes(f.toLowerCase())||J.examType.toLowerCase().includes(f.toLowerCase())));return t?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):r?i.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),i.jsx("div",{className:"ml-3",children:i.jsxs("p",{className:"text-sm text-red-700",children:["Error: ",r]})})]})}):i.jsxs("div",{className:"",children:[i.jsxs("div",{className:"mb-4 p-2 bg-yellow-100 text-yellow-800 text-xs",children:[i.jsx("p",{children:"Debug Info - ExaminationSection:"}),i.jsxs("p",{children:["Exams: ",a.length]}),i.jsxs("p",{children:["Students: ",e.length]}),i.jsxs("p",{children:["Marks from Redux: ",u.marks?u.marks.length:"undefined"]}),i.jsxs("p",{children:["Marks type: ",u.marks?typeof u.marks:"undefined"]}),i.jsxs("p",{children:["Marks loading: ",u.loading?"true":"false"]}),i.jsxs("p",{children:["Marks error: ",u.error||"none"]})]}),i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Examinations Management"}),i.jsx("p",{className:"mt-1 text-sm text-gray-600",children:C==="list"?"Manage examinations and schedules":C==="slips"?"Generate examination slips":C==="results"?"Track examination results":C==="class-results"?"View class-wise examination results":"Examination details"})]}),i.jsxs("div",{className:"mt-4 md:mt-0 flex space-x-2",children:[C==="list"&&i.jsxs("button",{onClick:()=>b(!g),className:"print:hidden inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(xl,{className:"mr-2"})," ",g?"Cancel":"Create Exam"]}),C==="list"&&i.jsxs("div",{className:"flex space-x-2",children:[i.jsxs("button",{onClick:()=>M("slips"),className:"print:hidden inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(Gk,{className:"mr-2"})," Exam Slips"]}),i.jsxs("button",{onClick:()=>M("results"),className:"print:hidden inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(wh,{className:"mr-2"})," Results Tracker"]}),i.jsxs("button",{onClick:()=>M("class-results"),className:"print:hidden inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(wh,{className:"mr-2"})," Class Results"]})]})]})]}),C==="list"&&i.jsxs(i.Fragment,{children:[g&&i.jsx(__,{formData:H,setFormData:O,onSubmit:ee,onCancel:se,classes:pe}),i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[i.jsx("div",{className:"mb-4",children:i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Bi,{className:"text-gray-400"})}),i.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Search examinations...",value:f,onChange:J=>m(J.target.value)})]})}),i.jsx("div",{className:"overflow-hidden rounded-lg border border-gray-200",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Examination"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date Range"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Academic Year"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:z.map(J=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"flex-shrink-0 h-10 w-10 bg-blue-100 rounded-lg flex items-center justify-center",children:i.jsx(Rl,{className:"text-blue-600"})}),i.jsxs("div",{className:"ml-4",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:J.name}),i.jsx("div",{className:"text-sm text-gray-500",children:J.section?`${J.section}`:"All Sections"})]})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:J.class}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:J.examType})}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[J.startDate," to ",J.endDate]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:J.academicYear}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:J.status})}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[i.jsx("button",{onClick:()=>ue(J),className:"text-blue-600 hover:text-blue-900 mr-3",children:i.jsx(rg,{})}),i.jsx("button",{onClick:()=>Q(J),className:"text-indigo-600 hover:text-indigo-900 mr-3",children:i.jsx(IA,{})}),i.jsx("button",{onClick:()=>Z(J.id),className:"text-red-600 hover:text-red-900",children:i.jsx(cu,{})})]})]},J.id))})]})}),z.length===0&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Rl,{className:"mx-auto h-12 w-12 text-gray-400"}),i.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No examinations found"}),i.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by creating a new examination."})]})]})]}),C==="detail"&&_&&i.jsx(L_,{exam:_,classes:s}),C==="slips"&&i.jsx(E_,{}),C==="results"&&i.jsx(k_,{}),C==="class-results"&&(u.loading?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):u.error?i.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),i.jsx("div",{className:"ml-3",children:i.jsxs("p",{className:"text-sm text-red-700",children:["Error loading marks: ",u.error]})})]})}):i.jsx(D_,{exams:z,students:e,marks:u}))]})},__=({formData:n,setFormData:a,onSubmit:t,onCancel:r,classes:s})=>{const e=new Date().toISOString().split("T")[0],[u,f]=ne.useState({});ne.useEffect(()=>{const F={};n.id&&n.subjects?n.subjects.forEach(C=>{const M=C.id||C.name;F[M]={date:C.date||e,time:C.time||"10:00",duration:C.duration||180}}):n.classes.forEach(C=>{const M=s.find(_=>_.name===C);M&&M.subjects&&M.subjects.forEach(_=>{const L=_.id||_.name;F[L]||(F[L]={date:_.date||e,time:_.time||"10:00",duration:_.duration||180})})}),Object.keys(F).length>0&&f(C=>({...C,...F}))},[n.classes,s,n.id,n.subjects]);const m=F=>{const{name:C,value:M}=F.target;a(_=>({..._,[C]:M}))},g=F=>{a(C=>{const M=C.classes.includes(F)?C.classes.filter(_=>_!==F):[...C.classes,F];return{...C,classes:M}})},b=(F,C,M)=>{f(_=>({..._,[F]:{..._[F],[C]:M}}))},j=F=>{F.preventDefault();const C=n.classes.map(M=>{const _=s.find(T=>T.name===M);if(!_)return{className:M,subjects:[]};const L=_.subjects.map(T=>{const H=u[T.id]||u[T.name]||{};return{...T,date:H.date||e,time:H.time||"10:00",duration:H.duration||180}});return{className:M,subjects:L}});t({...n,scheduledSubjects:C})};return i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 mb-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:n.id?"Edit Examination":"Create New Examination"}),i.jsxs("form",{onSubmit:j,className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Examination Name *"}),i.jsx("input",{type:"text",name:"name",value:n.name,onChange:m,required:!0,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter examination name"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Examination Type *"}),i.jsxs("select",{name:"examType",value:n.examType,onChange:m,required:!0,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"Select examination type"}),i.jsx("option",{value:"Midterm",children:"Midterm"}),i.jsx("option",{value:"Final",children:"Final"}),i.jsx("option",{value:"Quiz",children:"Quiz"}),i.jsx("option",{value:"Assignment",children:"Assignment"}),i.jsx("option",{value:"Project",children:"Project"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date *"}),i.jsx("input",{type:"date",name:"startDate",value:n.startDate,onChange:m,required:!0,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date *"}),i.jsx("input",{type:"date",name:"endDate",value:n.endDate,onChange:m,required:!0,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Marks"}),i.jsx("input",{type:"number",name:"maxMarks",value:n.maxMarks,onChange:m,min:"1",className:"block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Classes *"}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:s.map(F=>i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",id:`class-${F.id}`,checked:n.classes.includes(F.name),onChange:()=>g(F.name),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),i.jsx("label",{htmlFor:`class-${F.id}`,className:"ml-2 block text-sm text-gray-900",children:F.name})]},F.id))})]}),n.classes.length>0&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject Schedule"}),i.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:i.jsx("div",{className:"space-y-4",children:n.classes.map((F,C)=>{const M=s.find(_=>_.name===F);return!M||!M.subjects?null:i.jsxs("div",{className:"border-b border-gray-200 pb-4 last:border-0 last:pb-0",children:[i.jsxs("h4",{className:"font-medium text-gray-900 mb-2",children:[F," Subjects"]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:M.subjects.map((_,L)=>{const T=_.id||_.name,H=u[T]||{};return i.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:[i.jsx("div",{className:"font-medium text-gray-900 mb-2",children:_.name}),i.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-500",children:"Date"}),i.jsx("input",{type:"date",value:H.date||"",onChange:O=>b(T,"date",O.target.value),className:"mt-1 block w-full px-2 py-1 border border-gray-300 rounded text-sm focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-500",children:"Time"}),i.jsx("input",{type:"time",value:H.time||"10:00",onChange:O=>b(T,"time",O.target.value),className:"mt-1 block w-full px-2 py-1 border border-gray-300 rounded text-sm focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-500",children:"Duration (mins)"}),i.jsx("input",{type:"number",min:"1",value:H.duration||180,onChange:O=>b(T,"duration",parseInt(O.target.value)),className:"mt-1 block w-full px-2 py-1 border border-gray-300 rounded text-sm focus:ring-blue-500 focus:border-blue-500"})]})]})]},L)})})]},C)})})})]}),i.jsxs("div",{className:"flex justify-end space-x-3",children:[i.jsx("button",{type:"button",onClick:r,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),i.jsxs("button",{type:"submit",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(nf,{className:"mr-2"})," ",n.id?"Update":"Create"," Examination"]})]})]})]})},L_=({exam:n,classes:a})=>(a.find(t=>t.name===n.class),i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[i.jsxs("div",{className:"flex justify-between items-start mb-6",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:n.name}),i.jsxs("p",{className:"text-gray-600 mt-1",children:[n.class," - ",n.examType]})]}),i.jsxs("button",{onClick:()=>window.history.back(),className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[i.jsx("svg",{className:"h-5 w-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Examination Details"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Start Date:"}),i.jsx("span",{className:"font-medium",children:n.startDate})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"End Date:"}),i.jsx("span",{className:"font-medium",children:n.endDate})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Academic Year:"}),i.jsx("span",{className:"font-medium",children:n.academicYear})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Status:"}),i.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:n.status})]})]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Schedule Information"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Section:"}),i.jsx("span",{className:"font-medium",children:n.section||"All Sections"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Max Marks:"}),i.jsx("span",{className:"font-medium",children:n.maxMarks})]})]})]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Subject Schedule"}),n.subjects&&n.subjects.length>0?i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.subjects.map((t,r)=>i.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[i.jsx("div",{className:"font-medium text-gray-900",children:t.name}),i.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[i.jsxs("div",{children:["Date: ",t.date||"Not scheduled"]}),i.jsxs("div",{children:["Time: ",t.time||"Not scheduled"]}),i.jsxs("div",{children:["Duration: ",t.duration||"Not set"," minutes"]})]})]},r))}):i.jsx("p",{className:"text-gray-600",children:"No subjects scheduled for this examination."})]})]})),r8=6048e5,U_=864e5,Ob=6e4,Qb=36e5,M_=1e3,q3=Symbol.for("constructDateFrom");function Nn(n,a){return typeof n=="function"?n(a):n&&typeof n=="object"&&q3 in n?n[q3](a):n instanceof Date?new n.constructor(a):new Date(a)}function Aa(n,a){return Nn(a||n,n)}function yd(n,a,t){const r=Aa(n,t?.in);return isNaN(a)?Nn(t?.in||n,NaN):(a&&r.setDate(r.getDate()+a),r)}function Nd(n,a,t){const r=Aa(n,t?.in);if(isNaN(a))return Nn(n,NaN);if(!a)return r;const s=r.getDate(),e=Nn(n,r.getTime());e.setMonth(r.getMonth()+a+1,0);const u=e.getDate();return s>=u?e:(r.setFullYear(e.getFullYear(),e.getMonth(),s),r)}function a8(n,a,t){return Nn(n,+Aa(n)+a)}function I_(n,a,t){return a8(n,a*Qb)}let O_={};function Th(){return O_}function of(n,a){const t=Th(),r=a?.weekStartsOn??a?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,s=Aa(n,a?.in),e=s.getDay(),u=(e<r?7:0)+e-r;return s.setDate(s.getDate()-u),s.setHours(0,0,0,0),s}function rp(n,a){return of(n,{...a,weekStartsOn:1})}function s8(n,a){const t=Aa(n,a?.in),r=t.getFullYear(),s=Nn(t,0);s.setFullYear(r+1,0,4),s.setHours(0,0,0,0);const e=rp(s),u=Nn(t,0);u.setFullYear(r,0,4),u.setHours(0,0,0,0);const f=rp(u);return t.getTime()>=e.getTime()?r+1:t.getTime()>=f.getTime()?r:r-1}function eb(n){const a=Aa(n),t=new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()));return t.setUTCFullYear(a.getFullYear()),+n-+t}function Af(n,...a){const t=Nn.bind(null,a.find(r=>typeof r=="object"));return a.map(t)}function jh(n,a){const t=Aa(n,a?.in);return t.setHours(0,0,0,0),t}function ap(n,a,t){const[r,s]=Af(t?.in,n,a),e=jh(r),u=jh(s),f=+e-eb(e),m=+u-eb(u);return Math.round((f-m)/U_)}function Q_(n,a){const t=s8(n,a),r=Nn(n,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),rp(r)}function gw(n,a,t){const r=Aa(n,t?.in);return r.setTime(r.getTime()+a*Ob),r}function w5(n,a,t){return Nd(n,a*3,t)}function R_(n,a,t){return a8(n,a*1e3)}function tb(n,a,t){return yd(n,a*7,t)}function Xu(n,a,t){return Nd(n,a*12,t)}function X3(n,a){let t,r=a?.in;return n.forEach(s=>{!r&&typeof s=="object"&&(r=Nn.bind(null,s));const e=Aa(s,r);(!t||t<e||isNaN(+e))&&(t=e)}),Nn(r,t||NaN)}function J3(n,a){let t,r=a?.in;return n.forEach(s=>{!r&&typeof s=="object"&&(r=Nn.bind(null,s));const e=Aa(s,r);(!t||t>e||isNaN(+e))&&(t=e)}),Nn(r,t||NaN)}function P_(n,a,t){const[r,s]=Af(t?.in,n,a);return+jh(r)==+jh(s)}function Ju(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function rb(n){return!(!Ju(n)&&typeof n!="number"||isNaN(+Aa(n)))}function ab(n,a,t){const[r,s]=Af(t?.in,n,a),e=r.getFullYear()-s.getFullYear(),u=r.getMonth()-s.getMonth();return e*12+u}function hh(n,a){const t=Aa(n,a?.in);return Math.trunc(t.getMonth()/3)+1}function sb(n,a,t){const[r,s]=Af(t?.in,n,a),e=r.getFullYear()-s.getFullYear(),u=hh(r)-hh(s);return e*4+u}function nb(n,a,t){const[r,s]=Af(t?.in,n,a);return r.getFullYear()-s.getFullYear()}function H_(n,a,t){const[r,s]=Af(t?.in,n,a),e=Z3(r,s),u=Math.abs(ap(r,s));r.setDate(r.getDate()-e*u);const f=+(Z3(r,s)===-e),m=e*(u-f);return m===0?0:m}function Z3(n,a){const t=n.getFullYear()-a.getFullYear()||n.getMonth()-a.getMonth()||n.getDate()-a.getDate()||n.getHours()-a.getHours()||n.getMinutes()-a.getMinutes()||n.getSeconds()-a.getSeconds()||n.getMilliseconds()-a.getMilliseconds();return t<0?-1:t>0?1:t}function n8(n,a){const t=Aa(n,a?.in);return t.setHours(23,59,59,999),t}function i8(n,a){const t=Aa(n,a?.in),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function xw(n,a){const t=Aa(n,a?.in),r=t.getMonth(),s=r-r%3;return t.setMonth(s,1),t.setHours(0,0,0,0),t}function o8(n,a){const t=Aa(n,a?.in);return t.setDate(1),t.setHours(0,0,0,0),t}function l8(n,a){const t=Aa(n,a?.in),r=t.getFullYear();return t.setFullYear(r+1,0,0),t.setHours(23,59,59,999),t}function Rb(n,a){const t=Aa(n,a?.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}function z_(n,a){const t=Th(),r=t.weekStartsOn??t.locale?.options?.weekStartsOn??0,s=Aa(n,a?.in),e=s.getDay(),u=(e<r?-7:0)+6-(e-r);return s.setDate(s.getDate()+u),s.setHours(23,59,59,999),s}const K_={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},G_=(n,a,t)=>{let r;const s=K_[n];return typeof s=="string"?r=s:a===1?r=s.one:r=s.other.replace("{{count}}",a.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function sv(n){return(a={})=>{const t=a.width?String(a.width):n.defaultWidth;return n.formats[t]||n.formats[n.defaultWidth]}}const V_={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Y_={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},W_={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},$_={date:sv({formats:V_,defaultWidth:"full"}),time:sv({formats:Y_,defaultWidth:"full"}),dateTime:sv({formats:W_,defaultWidth:"full"})},q_={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},X_=(n,a,t,r)=>q_[n];function b1(n){return(a,t)=>{const r=t?.context?String(t.context):"standalone";let s;if(r==="formatting"&&n.formattingValues){const u=n.defaultFormattingWidth||n.defaultWidth,f=t?.width?String(t.width):u;s=n.formattingValues[f]||n.formattingValues[u]}else{const u=n.defaultWidth,f=t?.width?String(t.width):n.defaultWidth;s=n.values[f]||n.values[u]}const e=n.argumentCallback?n.argumentCallback(a):a;return s[e]}}const J_={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Z_={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},eL={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},tL={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},rL={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},aL={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},sL=(n,a)=>{const t=Number(n),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},nL={ordinalNumber:sL,era:b1({values:J_,defaultWidth:"wide"}),quarter:b1({values:Z_,defaultWidth:"wide",argumentCallback:n=>n-1}),month:b1({values:eL,defaultWidth:"wide"}),day:b1({values:tL,defaultWidth:"wide"}),dayPeriod:b1({values:rL,defaultWidth:"wide",formattingValues:aL,defaultFormattingWidth:"wide"})};function y1(n){return(a,t={})=>{const r=t.width,s=r&&n.matchPatterns[r]||n.matchPatterns[n.defaultMatchWidth],e=a.match(s);if(!e)return null;const u=e[0],f=r&&n.parsePatterns[r]||n.parsePatterns[n.defaultParseWidth],m=Array.isArray(f)?oL(f,j=>j.test(u)):iL(f,j=>j.test(u));let g;g=n.valueCallback?n.valueCallback(m):m,g=t.valueCallback?t.valueCallback(g):g;const b=a.slice(u.length);return{value:g,rest:b}}}function iL(n,a){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&a(n[t]))return t}function oL(n,a){for(let t=0;t<n.length;t++)if(a(n[t]))return t}function lL(n){return(a,t={})=>{const r=a.match(n.matchPattern);if(!r)return null;const s=r[0],e=a.match(n.parsePattern);if(!e)return null;let u=n.valueCallback?n.valueCallback(e[0]):e[0];u=t.valueCallback?t.valueCallback(u):u;const f=a.slice(s.length);return{value:u,rest:f}}}const cL=/^(\d+)(th|st|nd|rd)?/i,AL=/\d+/i,dL={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},uL={any:[/^b/i,/^(a|c)/i]},fL={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},hL={any:[/1/i,/2/i,/3/i,/4/i]},mL={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},pL={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},gL={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},xL={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},bL={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},yL={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},vL={ordinalNumber:lL({matchPattern:cL,parsePattern:AL,valueCallback:n=>parseInt(n,10)}),era:y1({matchPatterns:dL,defaultMatchWidth:"wide",parsePatterns:uL,defaultParseWidth:"any"}),quarter:y1({matchPatterns:fL,defaultMatchWidth:"wide",parsePatterns:hL,defaultParseWidth:"any",valueCallback:n=>n+1}),month:y1({matchPatterns:mL,defaultMatchWidth:"wide",parsePatterns:pL,defaultParseWidth:"any"}),day:y1({matchPatterns:gL,defaultMatchWidth:"wide",parsePatterns:xL,defaultParseWidth:"any"}),dayPeriod:y1({matchPatterns:bL,defaultMatchWidth:"any",parsePatterns:yL,defaultParseWidth:"any"})},c8={code:"en-US",formatDistance:G_,formatLong:$_,formatRelative:X_,localize:nL,match:vL,options:{weekStartsOn:0,firstWeekContainsDate:1}};function wL(n,a){const t=Aa(n,a?.in);return ap(t,Rb(t))+1}function N5(n,a){const t=Aa(n,a?.in),r=+rp(t)-+Q_(t);return Math.round(r/r8)+1}function C5(n,a){const t=Aa(n,a?.in),r=t.getFullYear(),s=Th(),e=a?.firstWeekContainsDate??a?.locale?.options?.firstWeekContainsDate??s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,u=Nn(a?.in||n,0);u.setFullYear(r+1,0,e),u.setHours(0,0,0,0);const f=of(u,a),m=Nn(a?.in||n,0);m.setFullYear(r,0,e),m.setHours(0,0,0,0);const g=of(m,a);return+t>=+f?r+1:+t>=+g?r:r-1}function NL(n,a){const t=Th(),r=a?.firstWeekContainsDate??a?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,s=C5(n,a),e=Nn(a?.in||n,0);return e.setFullYear(s,0,r),e.setHours(0,0,0,0),of(e,a)}function A8(n,a){const t=Aa(n,a?.in),r=+of(t,a)-+NL(t,a);return Math.round(r/r8)+1}function vn(n,a){const t=n<0?"-":"",r=Math.abs(n).toString().padStart(a,"0");return t+r}const Wf={y(n,a){const t=n.getFullYear(),r=t>0?t:1-t;return vn(a==="yy"?r%100:r,a.length)},M(n,a){const t=n.getMonth();return a==="M"?String(t+1):vn(t+1,2)},d(n,a){return vn(n.getDate(),a.length)},a(n,a){const t=n.getHours()/12>=1?"pm":"am";switch(a){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(n,a){return vn(n.getHours()%12||12,a.length)},H(n,a){return vn(n.getHours(),a.length)},m(n,a){return vn(n.getMinutes(),a.length)},s(n,a){return vn(n.getSeconds(),a.length)},S(n,a){const t=a.length,r=n.getMilliseconds(),s=Math.trunc(r*Math.pow(10,t-3));return vn(s,a.length)}},Em={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},e6={G:function(n,a,t){const r=n.getFullYear()>0?1:0;switch(a){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(n,a,t){if(a==="yo"){const r=n.getFullYear(),s=r>0?r:1-r;return t.ordinalNumber(s,{unit:"year"})}return Wf.y(n,a)},Y:function(n,a,t,r){const s=C5(n,r),e=s>0?s:1-s;if(a==="YY"){const u=e%100;return vn(u,2)}return a==="Yo"?t.ordinalNumber(e,{unit:"year"}):vn(e,a.length)},R:function(n,a){const t=s8(n);return vn(t,a.length)},u:function(n,a){const t=n.getFullYear();return vn(t,a.length)},Q:function(n,a,t){const r=Math.ceil((n.getMonth()+1)/3);switch(a){case"Q":return String(r);case"QQ":return vn(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(n,a,t){const r=Math.ceil((n.getMonth()+1)/3);switch(a){case"q":return String(r);case"qq":return vn(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(n,a,t){const r=n.getMonth();switch(a){case"M":case"MM":return Wf.M(n,a);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(n,a,t){const r=n.getMonth();switch(a){case"L":return String(r+1);case"LL":return vn(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(n,a,t,r){const s=A8(n,r);return a==="wo"?t.ordinalNumber(s,{unit:"week"}):vn(s,a.length)},I:function(n,a,t){const r=N5(n);return a==="Io"?t.ordinalNumber(r,{unit:"week"}):vn(r,a.length)},d:function(n,a,t){return a==="do"?t.ordinalNumber(n.getDate(),{unit:"date"}):Wf.d(n,a)},D:function(n,a,t){const r=wL(n);return a==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):vn(r,a.length)},E:function(n,a,t){const r=n.getDay();switch(a){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(n,a,t,r){const s=n.getDay(),e=(s-r.weekStartsOn+8)%7||7;switch(a){case"e":return String(e);case"ee":return vn(e,2);case"eo":return t.ordinalNumber(e,{unit:"day"});case"eee":return t.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(s,{width:"short",context:"formatting"});case"eeee":default:return t.day(s,{width:"wide",context:"formatting"})}},c:function(n,a,t,r){const s=n.getDay(),e=(s-r.weekStartsOn+8)%7||7;switch(a){case"c":return String(e);case"cc":return vn(e,a.length);case"co":return t.ordinalNumber(e,{unit:"day"});case"ccc":return t.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(s,{width:"narrow",context:"standalone"});case"cccccc":return t.day(s,{width:"short",context:"standalone"});case"cccc":default:return t.day(s,{width:"wide",context:"standalone"})}},i:function(n,a,t){const r=n.getDay(),s=r===0?7:r;switch(a){case"i":return String(s);case"ii":return vn(s,a.length);case"io":return t.ordinalNumber(s,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(n,a,t){const s=n.getHours()/12>=1?"pm":"am";switch(a){case"a":case"aa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(n,a,t){const r=n.getHours();let s;switch(r===12?s=Em.noon:r===0?s=Em.midnight:s=r/12>=1?"pm":"am",a){case"b":case"bb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(n,a,t){const r=n.getHours();let s;switch(r>=17?s=Em.evening:r>=12?s=Em.afternoon:r>=4?s=Em.morning:s=Em.night,a){case"B":case"BB":case"BBB":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(n,a,t){if(a==="ho"){let r=n.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return Wf.h(n,a)},H:function(n,a,t){return a==="Ho"?t.ordinalNumber(n.getHours(),{unit:"hour"}):Wf.H(n,a)},K:function(n,a,t){const r=n.getHours()%12;return a==="Ko"?t.ordinalNumber(r,{unit:"hour"}):vn(r,a.length)},k:function(n,a,t){let r=n.getHours();return r===0&&(r=24),a==="ko"?t.ordinalNumber(r,{unit:"hour"}):vn(r,a.length)},m:function(n,a,t){return a==="mo"?t.ordinalNumber(n.getMinutes(),{unit:"minute"}):Wf.m(n,a)},s:function(n,a,t){return a==="so"?t.ordinalNumber(n.getSeconds(),{unit:"second"}):Wf.s(n,a)},S:function(n,a){return Wf.S(n,a)},X:function(n,a,t){const r=n.getTimezoneOffset();if(r===0)return"Z";switch(a){case"X":return r6(r);case"XXXX":case"XX":return sh(r);case"XXXXX":case"XXX":default:return sh(r,":")}},x:function(n,a,t){const r=n.getTimezoneOffset();switch(a){case"x":return r6(r);case"xxxx":case"xx":return sh(r);case"xxxxx":case"xxx":default:return sh(r,":")}},O:function(n,a,t){const r=n.getTimezoneOffset();switch(a){case"O":case"OO":case"OOO":return"GMT"+t6(r,":");case"OOOO":default:return"GMT"+sh(r,":")}},z:function(n,a,t){const r=n.getTimezoneOffset();switch(a){case"z":case"zz":case"zzz":return"GMT"+t6(r,":");case"zzzz":default:return"GMT"+sh(r,":")}},t:function(n,a,t){const r=Math.trunc(+n/1e3);return vn(r,a.length)},T:function(n,a,t){return vn(+n,a.length)}};function t6(n,a=""){const t=n>0?"-":"+",r=Math.abs(n),s=Math.trunc(r/60),e=r%60;return e===0?t+String(s):t+String(s)+a+vn(e,2)}function r6(n,a){return n%60===0?(n>0?"-":"+")+vn(Math.abs(n)/60,2):sh(n,a)}function sh(n,a=""){const t=n>0?"-":"+",r=Math.abs(n),s=vn(Math.trunc(r/60),2),e=vn(r%60,2);return t+s+a+e}const a6=(n,a)=>{switch(n){case"P":return a.date({width:"short"});case"PP":return a.date({width:"medium"});case"PPP":return a.date({width:"long"});case"PPPP":default:return a.date({width:"full"})}},d8=(n,a)=>{switch(n){case"p":return a.time({width:"short"});case"pp":return a.time({width:"medium"});case"ppp":return a.time({width:"long"});case"pppp":default:return a.time({width:"full"})}},CL=(n,a)=>{const t=n.match(/(P+)(p+)?/)||[],r=t[1],s=t[2];if(!s)return a6(n,a);let e;switch(r){case"P":e=a.dateTime({width:"short"});break;case"PP":e=a.dateTime({width:"medium"});break;case"PPP":e=a.dateTime({width:"long"});break;case"PPPP":default:e=a.dateTime({width:"full"});break}return e.replace("{{date}}",a6(r,a)).replace("{{time}}",d8(s,a))},bw={p:d8,P:CL},jL=/^D+$/,BL=/^Y+$/,SL=["D","DD","YY","YYYY"];function FL(n){return jL.test(n)}function EL(n){return BL.test(n)}function kL(n,a,t){const r=DL(n,a,t);if(console.warn(r),SL.includes(n))throw new RangeError(r)}function DL(n,a,t){const r=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${a}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const TL=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,_L=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,LL=/^'([^]*?)'?$/,UL=/''/g,ML=/[a-zA-Z]/;function s6(n,a,t){const r=Th(),s=t?.locale??r.locale??c8,e=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,u=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,f=Aa(n,t?.in);if(!rb(f))throw new RangeError("Invalid time value");let m=a.match(_L).map(b=>{const j=b[0];if(j==="p"||j==="P"){const F=bw[j];return F(b,s.formatLong)}return b}).join("").match(TL).map(b=>{if(b==="''")return{isToken:!1,value:"'"};const j=b[0];if(j==="'")return{isToken:!1,value:IL(b)};if(e6[j])return{isToken:!0,value:b};if(j.match(ML))throw new RangeError("Format string contains an unescaped latin alphabet character `"+j+"`");return{isToken:!1,value:b}});s.localize.preprocessor&&(m=s.localize.preprocessor(f,m));const g={firstWeekContainsDate:e,weekStartsOn:u,locale:s};return m.map(b=>{if(!b.isToken)return b.value;const j=b.value;(!t?.useAdditionalWeekYearTokens&&EL(j)||!t?.useAdditionalDayOfYearTokens&&FL(j))&&kL(j,a,String(n));const F=e6[j[0]];return F(f,j,s.localize,g)}).join("")}function IL(n){const a=n.match(LL);return a?a[1].replace(UL,"'"):n}function n6(n,a){return Aa(n,a?.in).getDate()}function OL(n,a){return Aa(n,a?.in).getDay()}function QL(n,a){const t=Aa(n,a?.in),r=t.getFullYear(),s=t.getMonth(),e=Nn(t,0);return e.setFullYear(r,s+1,0),e.setHours(0,0,0,0),e.getDate()}function RL(){return Object.assign({},Th())}function Zu(n,a){return Aa(n,a?.in).getHours()}function PL(n,a){const t=Aa(n,a?.in).getDay();return t===0?7:t}function ef(n,a){return Aa(n,a?.in).getMinutes()}function Ql(n,a){return Aa(n,a?.in).getMonth()}function o0(n){return Aa(n).getSeconds()}function yw(n){return+Aa(n)}function os(n,a){return Aa(n,a?.in).getFullYear()}function f0(n,a){return+Aa(n)>+Aa(a)}function nu(n,a){return+Aa(n)<+Aa(a)}function HL(n,a){return+Aa(n)==+Aa(a)}function zL(n,a){const t=KL(a)?new a(0):Nn(a,0);return t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),t.setHours(n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()),t}function KL(n){return typeof n=="function"&&n.prototype?.constructor===n}const GL=10;class u8{subPriority=0;validate(a,t){return!0}}class VL extends u8{constructor(a,t,r,s,e){super(),this.value=a,this.validateValue=t,this.setValue=r,this.priority=s,e&&(this.subPriority=e)}validate(a,t){return this.validateValue(a,this.value,t)}set(a,t,r){return this.setValue(a,t,this.value,r)}}class YL extends u8{priority=GL;subPriority=-1;constructor(a,t){super(),this.context=a||(r=>Nn(t,r))}set(a,t){return t.timestampIsSet?a:Nn(a,zL(a,this.context))}}let Zs=class{run(a,t,r,s){const e=this.parse(a,t,r,s);return e?{setter:new VL(e.value,this.validate,this.set,this.priority,this.subPriority),rest:e.rest}:null}validate(a,t,r){return!0}};class WL extends Zs{priority=140;parse(a,t,r){switch(t){case"G":case"GG":case"GGG":return r.era(a,{width:"abbreviated"})||r.era(a,{width:"narrow"});case"GGGGG":return r.era(a,{width:"narrow"});case"GGGG":default:return r.era(a,{width:"wide"})||r.era(a,{width:"abbreviated"})||r.era(a,{width:"narrow"})}}set(a,t,r){return t.era=r,a.setFullYear(r,0,1),a.setHours(0,0,0,0),a}incompatibleTokens=["R","u","t","T"]}const oo={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},ru={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function lo(n,a){return n&&{value:a(n.value),rest:n.rest}}function ji(n,a){const t=a.match(n);return t?{value:parseInt(t[0],10),rest:a.slice(t[0].length)}:null}function au(n,a){const t=a.match(n);if(!t)return null;if(t[0]==="Z")return{value:0,rest:a.slice(1)};const r=t[1]==="+"?1:-1,s=t[2]?parseInt(t[2],10):0,e=t[3]?parseInt(t[3],10):0,u=t[5]?parseInt(t[5],10):0;return{value:r*(s*Qb+e*Ob+u*M_),rest:a.slice(t[0].length)}}function f8(n){return ji(oo.anyDigitsSigned,n)}function Hi(n,a){switch(n){case 1:return ji(oo.singleDigit,a);case 2:return ji(oo.twoDigits,a);case 3:return ji(oo.threeDigits,a);case 4:return ji(oo.fourDigits,a);default:return ji(new RegExp("^\\d{1,"+n+"}"),a)}}function ib(n,a){switch(n){case 1:return ji(oo.singleDigitSigned,a);case 2:return ji(oo.twoDigitsSigned,a);case 3:return ji(oo.threeDigitsSigned,a);case 4:return ji(oo.fourDigitsSigned,a);default:return ji(new RegExp("^-?\\d{1,"+n+"}"),a)}}function j5(n){switch(n){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function h8(n,a){const t=a>0,r=t?a:1-a;let s;if(r<=50)s=n||100;else{const e=r+50,u=Math.trunc(e/100)*100,f=n>=e%100;s=n+u-(f?100:0)}return t?s:1-s}function m8(n){return n%400===0||n%4===0&&n%100!==0}class $L extends Zs{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(a,t,r){const s=e=>({year:e,isTwoDigitYear:t==="yy"});switch(t){case"y":return lo(Hi(4,a),s);case"yo":return lo(r.ordinalNumber(a,{unit:"year"}),s);default:return lo(Hi(t.length,a),s)}}validate(a,t){return t.isTwoDigitYear||t.year>0}set(a,t,r){const s=a.getFullYear();if(r.isTwoDigitYear){const u=h8(r.year,s);return a.setFullYear(u,0,1),a.setHours(0,0,0,0),a}const e=!("era"in t)||t.era===1?r.year:1-r.year;return a.setFullYear(e,0,1),a.setHours(0,0,0,0),a}}class qL extends Zs{priority=130;parse(a,t,r){const s=e=>({year:e,isTwoDigitYear:t==="YY"});switch(t){case"Y":return lo(Hi(4,a),s);case"Yo":return lo(r.ordinalNumber(a,{unit:"year"}),s);default:return lo(Hi(t.length,a),s)}}validate(a,t){return t.isTwoDigitYear||t.year>0}set(a,t,r,s){const e=C5(a,s);if(r.isTwoDigitYear){const f=h8(r.year,e);return a.setFullYear(f,0,s.firstWeekContainsDate),a.setHours(0,0,0,0),of(a,s)}const u=!("era"in t)||t.era===1?r.year:1-r.year;return a.setFullYear(u,0,s.firstWeekContainsDate),a.setHours(0,0,0,0),of(a,s)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]}class XL extends Zs{priority=130;parse(a,t){return ib(t==="R"?4:t.length,a)}set(a,t,r){const s=Nn(a,0);return s.setFullYear(r,0,4),s.setHours(0,0,0,0),rp(s)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]}class JL extends Zs{priority=130;parse(a,t){return ib(t==="u"?4:t.length,a)}set(a,t,r){return a.setFullYear(r,0,1),a.setHours(0,0,0,0),a}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]}class ZL extends Zs{priority=120;parse(a,t,r){switch(t){case"Q":case"QQ":return Hi(t.length,a);case"Qo":return r.ordinalNumber(a,{unit:"quarter"});case"QQQ":return r.quarter(a,{width:"abbreviated",context:"formatting"})||r.quarter(a,{width:"narrow",context:"formatting"});case"QQQQQ":return r.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(a,{width:"wide",context:"formatting"})||r.quarter(a,{width:"abbreviated",context:"formatting"})||r.quarter(a,{width:"narrow",context:"formatting"})}}validate(a,t){return t>=1&&t<=4}set(a,t,r){return a.setMonth((r-1)*3,1),a.setHours(0,0,0,0),a}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]}class eU extends Zs{priority=120;parse(a,t,r){switch(t){case"q":case"qq":return Hi(t.length,a);case"qo":return r.ordinalNumber(a,{unit:"quarter"});case"qqq":return r.quarter(a,{width:"abbreviated",context:"standalone"})||r.quarter(a,{width:"narrow",context:"standalone"});case"qqqqq":return r.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(a,{width:"wide",context:"standalone"})||r.quarter(a,{width:"abbreviated",context:"standalone"})||r.quarter(a,{width:"narrow",context:"standalone"})}}validate(a,t){return t>=1&&t<=4}set(a,t,r){return a.setMonth((r-1)*3,1),a.setHours(0,0,0,0),a}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]}class tU extends Zs{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(a,t,r){const s=e=>e-1;switch(t){case"M":return lo(ji(oo.month,a),s);case"MM":return lo(Hi(2,a),s);case"Mo":return lo(r.ordinalNumber(a,{unit:"month"}),s);case"MMM":return r.month(a,{width:"abbreviated",context:"formatting"})||r.month(a,{width:"narrow",context:"formatting"});case"MMMMM":return r.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(a,{width:"wide",context:"formatting"})||r.month(a,{width:"abbreviated",context:"formatting"})||r.month(a,{width:"narrow",context:"formatting"})}}validate(a,t){return t>=0&&t<=11}set(a,t,r){return a.setMonth(r,1),a.setHours(0,0,0,0),a}}class rU extends Zs{priority=110;parse(a,t,r){const s=e=>e-1;switch(t){case"L":return lo(ji(oo.month,a),s);case"LL":return lo(Hi(2,a),s);case"Lo":return lo(r.ordinalNumber(a,{unit:"month"}),s);case"LLL":return r.month(a,{width:"abbreviated",context:"standalone"})||r.month(a,{width:"narrow",context:"standalone"});case"LLLLL":return r.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(a,{width:"wide",context:"standalone"})||r.month(a,{width:"abbreviated",context:"standalone"})||r.month(a,{width:"narrow",context:"standalone"})}}validate(a,t){return t>=0&&t<=11}set(a,t,r){return a.setMonth(r,1),a.setHours(0,0,0,0),a}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]}function aU(n,a,t){const r=Aa(n,t?.in),s=A8(r,t)-a;return r.setDate(r.getDate()-s*7),Aa(r,t?.in)}class sU extends Zs{priority=100;parse(a,t,r){switch(t){case"w":return ji(oo.week,a);case"wo":return r.ordinalNumber(a,{unit:"week"});default:return Hi(t.length,a)}}validate(a,t){return t>=1&&t<=53}set(a,t,r,s){return of(aU(a,r,s),s)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]}function nU(n,a,t){const r=Aa(n,t?.in),s=N5(r,t)-a;return r.setDate(r.getDate()-s*7),r}class iU extends Zs{priority=100;parse(a,t,r){switch(t){case"I":return ji(oo.week,a);case"Io":return r.ordinalNumber(a,{unit:"week"});default:return Hi(t.length,a)}}validate(a,t){return t>=1&&t<=53}set(a,t,r){return rp(nU(a,r))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]}const oU=[31,28,31,30,31,30,31,31,30,31,30,31],lU=[31,29,31,30,31,30,31,31,30,31,30,31];class cU extends Zs{priority=90;subPriority=1;parse(a,t,r){switch(t){case"d":return ji(oo.date,a);case"do":return r.ordinalNumber(a,{unit:"date"});default:return Hi(t.length,a)}}validate(a,t){const r=a.getFullYear(),s=m8(r),e=a.getMonth();return s?t>=1&&t<=lU[e]:t>=1&&t<=oU[e]}set(a,t,r){return a.setDate(r),a.setHours(0,0,0,0),a}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]}class AU extends Zs{priority=90;subpriority=1;parse(a,t,r){switch(t){case"D":case"DD":return ji(oo.dayOfYear,a);case"Do":return r.ordinalNumber(a,{unit:"date"});default:return Hi(t.length,a)}}validate(a,t){const r=a.getFullYear();return m8(r)?t>=1&&t<=366:t>=1&&t<=365}set(a,t,r){return a.setMonth(0,r),a.setHours(0,0,0,0),a}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]}function B5(n,a,t){const r=Th(),s=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,e=Aa(n,t?.in),u=e.getDay(),m=(a%7+7)%7,g=7-s,b=a<0||a>6?a-(u+g)%7:(m+g)%7-(u+g)%7;return yd(e,b,t)}class dU extends Zs{priority=90;parse(a,t,r){switch(t){case"E":case"EE":case"EEE":return r.day(a,{width:"abbreviated",context:"formatting"})||r.day(a,{width:"short",context:"formatting"})||r.day(a,{width:"narrow",context:"formatting"});case"EEEEE":return r.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(a,{width:"short",context:"formatting"})||r.day(a,{width:"narrow",context:"formatting"});case"EEEE":default:return r.day(a,{width:"wide",context:"formatting"})||r.day(a,{width:"abbreviated",context:"formatting"})||r.day(a,{width:"short",context:"formatting"})||r.day(a,{width:"narrow",context:"formatting"})}}validate(a,t){return t>=0&&t<=6}set(a,t,r,s){return a=B5(a,r,s),a.setHours(0,0,0,0),a}incompatibleTokens=["D","i","e","c","t","T"]}class uU extends Zs{priority=90;parse(a,t,r,s){const e=u=>{const f=Math.floor((u-1)/7)*7;return(u+s.weekStartsOn+6)%7+f};switch(t){case"e":case"ee":return lo(Hi(t.length,a),e);case"eo":return lo(r.ordinalNumber(a,{unit:"day"}),e);case"eee":return r.day(a,{width:"abbreviated",context:"formatting"})||r.day(a,{width:"short",context:"formatting"})||r.day(a,{width:"narrow",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"})||r.day(a,{width:"narrow",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})||r.day(a,{width:"abbreviated",context:"formatting"})||r.day(a,{width:"short",context:"formatting"})||r.day(a,{width:"narrow",context:"formatting"})}}validate(a,t){return t>=0&&t<=6}set(a,t,r,s){return a=B5(a,r,s),a.setHours(0,0,0,0),a}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]}class fU extends Zs{priority=90;parse(a,t,r,s){const e=u=>{const f=Math.floor((u-1)/7)*7;return(u+s.weekStartsOn+6)%7+f};switch(t){case"c":case"cc":return lo(Hi(t.length,a),e);case"co":return lo(r.ordinalNumber(a,{unit:"day"}),e);case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"})||r.day(a,{width:"short",context:"standalone"})||r.day(a,{width:"narrow",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"})||r.day(a,{width:"narrow",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})||r.day(a,{width:"abbreviated",context:"standalone"})||r.day(a,{width:"short",context:"standalone"})||r.day(a,{width:"narrow",context:"standalone"})}}validate(a,t){return t>=0&&t<=6}set(a,t,r,s){return a=B5(a,r,s),a.setHours(0,0,0,0),a}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]}function hU(n,a,t){const r=Aa(n,t?.in),s=PL(r,t),e=a-s;return yd(r,e,t)}class mU extends Zs{priority=90;parse(a,t,r){const s=e=>e===0?7:e;switch(t){case"i":case"ii":return Hi(t.length,a);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return lo(r.day(a,{width:"abbreviated",context:"formatting"})||r.day(a,{width:"short",context:"formatting"})||r.day(a,{width:"narrow",context:"formatting"}),s);case"iiiii":return lo(r.day(a,{width:"narrow",context:"formatting"}),s);case"iiiiii":return lo(r.day(a,{width:"short",context:"formatting"})||r.day(a,{width:"narrow",context:"formatting"}),s);case"iiii":default:return lo(r.day(a,{width:"wide",context:"formatting"})||r.day(a,{width:"abbreviated",context:"formatting"})||r.day(a,{width:"short",context:"formatting"})||r.day(a,{width:"narrow",context:"formatting"}),s)}}validate(a,t){return t>=1&&t<=7}set(a,t,r){return a=hU(a,r),a.setHours(0,0,0,0),a}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]}class pU extends Zs{priority=80;parse(a,t,r){switch(t){case"a":case"aa":case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"})||r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})||r.dayPeriod(a,{width:"abbreviated",context:"formatting"})||r.dayPeriod(a,{width:"narrow",context:"formatting"})}}set(a,t,r){return a.setHours(j5(r),0,0,0),a}incompatibleTokens=["b","B","H","k","t","T"]}class gU extends Zs{priority=80;parse(a,t,r){switch(t){case"b":case"bb":case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"})||r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})||r.dayPeriod(a,{width:"abbreviated",context:"formatting"})||r.dayPeriod(a,{width:"narrow",context:"formatting"})}}set(a,t,r){return a.setHours(j5(r),0,0,0),a}incompatibleTokens=["a","B","H","k","t","T"]}class xU extends Zs{priority=80;parse(a,t,r){switch(t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"})||r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})||r.dayPeriod(a,{width:"abbreviated",context:"formatting"})||r.dayPeriod(a,{width:"narrow",context:"formatting"})}}set(a,t,r){return a.setHours(j5(r),0,0,0),a}incompatibleTokens=["a","b","t","T"]}class bU extends Zs{priority=70;parse(a,t,r){switch(t){case"h":return ji(oo.hour12h,a);case"ho":return r.ordinalNumber(a,{unit:"hour"});default:return Hi(t.length,a)}}validate(a,t){return t>=1&&t<=12}set(a,t,r){const s=a.getHours()>=12;return s&&r<12?a.setHours(r+12,0,0,0):!s&&r===12?a.setHours(0,0,0,0):a.setHours(r,0,0,0),a}incompatibleTokens=["H","K","k","t","T"]}class yU extends Zs{priority=70;parse(a,t,r){switch(t){case"H":return ji(oo.hour23h,a);case"Ho":return r.ordinalNumber(a,{unit:"hour"});default:return Hi(t.length,a)}}validate(a,t){return t>=0&&t<=23}set(a,t,r){return a.setHours(r,0,0,0),a}incompatibleTokens=["a","b","h","K","k","t","T"]}class vU extends Zs{priority=70;parse(a,t,r){switch(t){case"K":return ji(oo.hour11h,a);case"Ko":return r.ordinalNumber(a,{unit:"hour"});default:return Hi(t.length,a)}}validate(a,t){return t>=0&&t<=11}set(a,t,r){return a.getHours()>=12&&r<12?a.setHours(r+12,0,0,0):a.setHours(r,0,0,0),a}incompatibleTokens=["h","H","k","t","T"]}class wU extends Zs{priority=70;parse(a,t,r){switch(t){case"k":return ji(oo.hour24h,a);case"ko":return r.ordinalNumber(a,{unit:"hour"});default:return Hi(t.length,a)}}validate(a,t){return t>=1&&t<=24}set(a,t,r){const s=r<=24?r%24:r;return a.setHours(s,0,0,0),a}incompatibleTokens=["a","b","h","H","K","t","T"]}class NU extends Zs{priority=60;parse(a,t,r){switch(t){case"m":return ji(oo.minute,a);case"mo":return r.ordinalNumber(a,{unit:"minute"});default:return Hi(t.length,a)}}validate(a,t){return t>=0&&t<=59}set(a,t,r){return a.setMinutes(r,0,0),a}incompatibleTokens=["t","T"]}class CU extends Zs{priority=50;parse(a,t,r){switch(t){case"s":return ji(oo.second,a);case"so":return r.ordinalNumber(a,{unit:"second"});default:return Hi(t.length,a)}}validate(a,t){return t>=0&&t<=59}set(a,t,r){return a.setSeconds(r,0),a}incompatibleTokens=["t","T"]}class jU extends Zs{priority=30;parse(a,t){const r=s=>Math.trunc(s*Math.pow(10,-t.length+3));return lo(Hi(t.length,a),r)}set(a,t,r){return a.setMilliseconds(r),a}incompatibleTokens=["t","T"]}class BU extends Zs{priority=10;parse(a,t){switch(t){case"X":return au(ru.basicOptionalMinutes,a);case"XX":return au(ru.basic,a);case"XXXX":return au(ru.basicOptionalSeconds,a);case"XXXXX":return au(ru.extendedOptionalSeconds,a);case"XXX":default:return au(ru.extended,a)}}set(a,t,r){return t.timestampIsSet?a:Nn(a,a.getTime()-eb(a)-r)}incompatibleTokens=["t","T","x"]}class SU extends Zs{priority=10;parse(a,t){switch(t){case"x":return au(ru.basicOptionalMinutes,a);case"xx":return au(ru.basic,a);case"xxxx":return au(ru.basicOptionalSeconds,a);case"xxxxx":return au(ru.extendedOptionalSeconds,a);case"xxx":default:return au(ru.extended,a)}}set(a,t,r){return t.timestampIsSet?a:Nn(a,a.getTime()-eb(a)-r)}incompatibleTokens=["t","T","X"]}class FU extends Zs{priority=40;parse(a){return f8(a)}set(a,t,r){return[Nn(a,r*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"}class EU extends Zs{priority=20;parse(a){return f8(a)}set(a,t,r){return[Nn(a,r),{timestampIsSet:!0}]}incompatibleTokens="*"}const kU={G:new WL,y:new $L,Y:new qL,R:new XL,u:new JL,Q:new ZL,q:new eU,M:new tU,L:new rU,w:new sU,I:new iU,d:new cU,D:new AU,E:new dU,e:new uU,c:new fU,i:new mU,a:new pU,b:new gU,B:new xU,h:new bU,H:new yU,K:new vU,k:new wU,m:new NU,s:new CU,S:new jU,X:new BU,x:new SU,t:new FU,T:new EU},DU=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,TU=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,_U=/^'([^]*?)'?$/,LU=/''/g,UU=/\S/,MU=/[a-zA-Z]/;function IU(n,a,t,r){const s=()=>Nn(r?.in||t,NaN),e=RL(),u=r?.locale??e.locale??c8,f=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??e.firstWeekContainsDate??e.locale?.options?.firstWeekContainsDate??1,m=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??e.weekStartsOn??e.locale?.options?.weekStartsOn??0;if(!a)return n?s():Aa(t,r?.in);const g={firstWeekContainsDate:f,weekStartsOn:m,locale:u},b=[new YL(r?.in,t)],j=a.match(TU).map(L=>{const T=L[0];if(T in bw){const H=bw[T];return H(L,u.formatLong)}return L}).join("").match(DU),F=[];for(let L of j){const T=L[0],H=kU[T];if(H){const{incompatibleTokens:O}=H;if(Array.isArray(O)){const Z=F.find(ee=>O.includes(ee.token)||ee.token===T);if(Z)throw new RangeError(`The format string mustn't contain \`${Z.fullToken}\` and \`${L}\` at the same time`)}else if(H.incompatibleTokens==="*"&&F.length>0)throw new RangeError(`The format string mustn't contain \`${L}\` and any other token at the same time`);F.push({token:T,fullToken:L});const Q=H.run(n,L,u.match,g);if(!Q)return s();b.push(Q.setter),n=Q.rest}else{if(T.match(MU))throw new RangeError("Format string contains an unescaped latin alphabet character `"+T+"`");if(L==="''"?L="'":T==="'"&&(L=OU(L)),n.indexOf(L)===0)n=n.slice(L.length);else return s()}}if(n.length>0&&UU.test(n))return s();const C=b.map(L=>L.priority).sort((L,T)=>T-L).filter((L,T,H)=>H.indexOf(L)===T).map(L=>b.filter(T=>T.priority===L).sort((T,H)=>H.subPriority-T.subPriority)).map(L=>L[0]);let M=Aa(t,r?.in);if(isNaN(+M))return s();const _={};for(const L of C){if(!L.validate(M,g))return s();const T=L.set(M,_,g);Array.isArray(T)?(M=T[0],Object.assign(_,T[1])):M=T}return M}function OU(n){return n.match(_U)[1].replace(LU,"'")}function QU(n,a,t){const[r,s]=Af(t?.in,n,a);return r.getFullYear()===s.getFullYear()&&r.getMonth()===s.getMonth()}function RU(n,a,t){const[r,s]=Af(t?.in,n,a);return+xw(r)==+xw(s)}function PU(n,a,t){const[r,s]=Af(t?.in,n,a);return r.getFullYear()===s.getFullYear()}function ig(n,a,t){const r=+Aa(n,t?.in),[s,e]=[+Aa(a.start,t?.in),+Aa(a.end,t?.in)].sort((u,f)=>u-f);return r>=s&&r<=e}function HU(n,a,t){return yd(n,-1,t)}function zU(n,a){const t=()=>Nn(a?.in,NaN),s=YU(n);let e;if(s.date){const g=WU(s.date,2);e=$U(g.restDateString,g.year)}if(!e||isNaN(+e))return t();const u=+e;let f=0,m;if(s.time&&(f=qU(s.time),isNaN(f)))return t();if(s.timezone){if(m=XU(s.timezone),isNaN(m))return t()}else{const g=new Date(u+f),b=Aa(0,a?.in);return b.setFullYear(g.getUTCFullYear(),g.getUTCMonth(),g.getUTCDate()),b.setHours(g.getUTCHours(),g.getUTCMinutes(),g.getUTCSeconds(),g.getUTCMilliseconds()),b}return Aa(u+f+m,a?.in)}const Mx={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},KU=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,GU=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,VU=/^([+-])(\d{2})(?::?(\d{2}))?$/;function YU(n){const a={},t=n.split(Mx.dateTimeDelimiter);let r;if(t.length>2)return a;if(/:/.test(t[0])?r=t[0]:(a.date=t[0],r=t[1],Mx.timeZoneDelimiter.test(a.date)&&(a.date=n.split(Mx.timeZoneDelimiter)[0],r=n.substr(a.date.length,n.length))),r){const s=Mx.timezone.exec(r);s?(a.time=r.replace(s[1],""),a.timezone=s[1]):a.time=r}return a}function WU(n,a){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+a)+"})|(\\d{2}|[+-]\\d{"+(2+a)+"})$)"),r=n.match(t);if(!r)return{year:NaN,restDateString:""};const s=r[1]?parseInt(r[1]):null,e=r[2]?parseInt(r[2]):null;return{year:e===null?s:e*100,restDateString:n.slice((r[1]||r[2]).length)}}function $U(n,a){if(a===null)return new Date(NaN);const t=n.match(KU);if(!t)return new Date(NaN);const r=!!t[4],s=v1(t[1]),e=v1(t[2])-1,u=v1(t[3]),f=v1(t[4]),m=v1(t[5])-1;if(r)return rM(a,f,m)?JU(a,f,m):new Date(NaN);{const g=new Date(0);return!eM(a,e,u)||!tM(a,s)?new Date(NaN):(g.setUTCFullYear(a,e,Math.max(s,u)),g)}}function v1(n){return n?parseInt(n):1}function qU(n){const a=n.match(GU);if(!a)return NaN;const t=nv(a[1]),r=nv(a[2]),s=nv(a[3]);return aM(t,r,s)?t*Qb+r*Ob+s*1e3:NaN}function nv(n){return n&&parseFloat(n.replace(",","."))||0}function XU(n){if(n==="Z")return 0;const a=n.match(VU);if(!a)return 0;const t=a[1]==="+"?-1:1,r=parseInt(a[2]),s=a[3]&&parseInt(a[3])||0;return sM(r,s)?t*(r*Qb+s*Ob):NaN}function JU(n,a,t){const r=new Date(0);r.setUTCFullYear(n,0,4);const s=r.getUTCDay()||7,e=(a-1)*7+t+1-s;return r.setUTCDate(r.getUTCDate()+e),r}const ZU=[31,null,31,30,31,30,31,31,30,31,30,31];function p8(n){return n%400===0||n%4===0&&n%100!==0}function eM(n,a,t){return a>=0&&a<=11&&t>=1&&t<=(ZU[a]||(p8(n)?29:28))}function tM(n,a){return a>=1&&a<=(p8(n)?366:365)}function rM(n,a,t){return a>=1&&a<=53&&t>=0&&t<=6}function aM(n,a,t){return n===24?a===0&&t===0:t>=0&&t<60&&a>=0&&a<60&&n>=0&&n<25}function sM(n,a){return a>=0&&a<=59}function TA(n,a,t){const r=Aa(n,t?.in),s=r.getFullYear(),e=r.getDate(),u=Nn(n,0);u.setFullYear(s,a,15),u.setHours(0,0,0,0);const f=QL(u);return r.setMonth(a,Math.min(e,f)),r}function E2(n,a,t){const r=Aa(n,t?.in);return r.setHours(a),r}function k2(n,a,t){const r=Aa(n,t?.in);return r.setMinutes(a),r}function Om(n,a,t){const r=Aa(n,t?.in),s=Math.trunc(r.getMonth()/3)+1,e=a-s;return TA(r,r.getMonth()+e*3)}function D2(n,a,t){const r=Aa(n,t?.in);return r.setSeconds(a),r}function Zd(n,a,t){const r=Aa(n,t?.in);return isNaN(+r)?Nn(n,NaN):(r.setFullYear(a),r)}function mh(n,a,t){return Nd(n,-a,t)}function g8(n,a,t){return w5(n,-1,t)}function i6(n,a,t){return tb(n,-1,t)}function sp(n,a,t){return Xu(n,-a,t)}function Pb(){return typeof window<"u"}function hp(n){return x8(n)?(n.nodeName||"").toLowerCase():"#document"}function dA(n){var a;return(n==null||(a=n.ownerDocument)==null?void 0:a.defaultView)||window}function uu(n){var a;return(a=(x8(n)?n.ownerDocument:n.document)||window.document)==null?void 0:a.documentElement}function x8(n){return Pb()?n instanceof Node||n instanceof dA(n).Node:!1}function ic(n){return Pb()?n instanceof Element||n instanceof dA(n).Element:!1}function Au(n){return Pb()?n instanceof HTMLElement||n instanceof dA(n).HTMLElement:!1}function o6(n){return!Pb()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof dA(n).ShadowRoot}const nM=new Set(["inline","contents"]);function pg(n){const{overflow:a,overflowX:t,overflowY:r,display:s}=RA(n);return/auto|scroll|overlay|hidden|clip/.test(a+r+t)&&!nM.has(s)}const iM=new Set(["table","td","th"]);function oM(n){return iM.has(hp(n))}const lM=[":popover-open",":modal"];function Hb(n){return lM.some(a=>{try{return n.matches(a)}catch{return!1}})}const cM=["transform","translate","scale","rotate","perspective"],AM=["transform","translate","scale","rotate","perspective","filter"],dM=["paint","layout","strict","content"];function S5(n){const a=F5(),t=ic(n)?RA(n):n;return cM.some(r=>t[r]?t[r]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!a&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!a&&(t.filter?t.filter!=="none":!1)||AM.some(r=>(t.willChange||"").includes(r))||dM.some(r=>(t.contain||"").includes(r))}function uM(n){let a=h0(n);for(;Au(a)&&!np(a);){if(S5(a))return a;if(Hb(a))return null;a=h0(a)}return null}function F5(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const fM=new Set(["html","body","#document"]);function np(n){return fM.has(hp(n))}function RA(n){return dA(n).getComputedStyle(n)}function zb(n){return ic(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function h0(n){if(hp(n)==="html")return n;const a=n.assignedSlot||n.parentNode||o6(n)&&n.host||uu(n);return o6(a)?a.host:a}function b8(n){const a=h0(n);return np(a)?n.ownerDocument?n.ownerDocument.body:n.body:Au(a)&&pg(a)?a:b8(a)}function og(n,a,t){var r;a===void 0&&(a=[]),t===void 0&&(t=!0);const s=b8(n),e=s===((r=n.ownerDocument)==null?void 0:r.body),u=dA(s);if(e){const f=vw(u);return a.concat(u,u.visualViewport||[],pg(s)?s:[],f&&t?og(f):[])}return a.concat(s,og(s,[],t))}function vw(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}const ip=Math.min,ph=Math.max,ob=Math.round,Ix=Math.floor,ou=n=>({x:n,y:n}),hM={left:"right",right:"left",bottom:"top",top:"bottom"},mM={start:"end",end:"start"};function pM(n,a,t){return ph(n,ip(a,t))}function Kb(n,a){return typeof n=="function"?n(a):n}function op(n){return n.split("-")[0]}function gg(n){return n.split("-")[1]}function gM(n){return n==="x"?"y":"x"}function E5(n){return n==="y"?"height":"width"}const xM=new Set(["top","bottom"]);function lh(n){return xM.has(op(n))?"y":"x"}function k5(n){return gM(lh(n))}function bM(n,a,t){t===void 0&&(t=!1);const r=gg(n),s=k5(n),e=E5(s);let u=s==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return a.reference[e]>a.floating[e]&&(u=lb(u)),[u,lb(u)]}function yM(n){const a=lb(n);return[ww(n),a,ww(a)]}function ww(n){return n.replace(/start|end/g,a=>mM[a])}const l6=["left","right"],c6=["right","left"],vM=["top","bottom"],wM=["bottom","top"];function NM(n,a,t){switch(n){case"top":case"bottom":return t?a?c6:l6:a?l6:c6;case"left":case"right":return a?vM:wM;default:return[]}}function CM(n,a,t,r){const s=gg(n);let e=NM(op(n),t==="start",r);return s&&(e=e.map(u=>u+"-"+s),a&&(e=e.concat(e.map(ww)))),e}function lb(n){return n.replace(/left|right|bottom|top/g,a=>hM[a])}function jM(n){return{top:0,right:0,bottom:0,left:0,...n}}function y8(n){return typeof n!="number"?jM(n):{top:n,right:n,bottom:n,left:n}}function cb(n){const{x:a,y:t,width:r,height:s}=n;return{width:r,height:s,top:t,left:a,right:a+r,bottom:t+s,x:a,y:t}}var BM=typeof document<"u",SM=function(){},Ab=BM?ne.useLayoutEffect:SM;const FM={...HN},EM=FM.useInsertionEffect,kM=EM||(n=>n());function DM(n){const a=ne.useRef(()=>{});return kM(()=>{a.current=n}),ne.useCallback(function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return a.current==null?void 0:a.current(...r)},[])}var v8=zN();const TM=PN(v8);function A6(n,a,t){let{reference:r,floating:s}=n;const e=lh(a),u=k5(a),f=E5(u),m=op(a),g=e==="y",b=r.x+r.width/2-s.width/2,j=r.y+r.height/2-s.height/2,F=r[f]/2-s[f]/2;let C;switch(m){case"top":C={x:b,y:r.y-s.height};break;case"bottom":C={x:b,y:r.y+r.height};break;case"right":C={x:r.x+r.width,y:j};break;case"left":C={x:r.x-s.width,y:j};break;default:C={x:r.x,y:r.y}}switch(gg(a)){case"start":C[u]-=F*(t&&g?-1:1);break;case"end":C[u]+=F*(t&&g?-1:1);break}return C}const _M=async(n,a,t)=>{const{placement:r="bottom",strategy:s="absolute",middleware:e=[],platform:u}=t,f=e.filter(Boolean),m=await(u.isRTL==null?void 0:u.isRTL(a));let g=await u.getElementRects({reference:n,floating:a,strategy:s}),{x:b,y:j}=A6(g,r,m),F=r,C={},M=0;for(let _=0;_<f.length;_++){const{name:L,fn:T}=f[_],{x:H,y:O,data:Q,reset:Z}=await T({x:b,y:j,initialPlacement:r,placement:F,strategy:s,middlewareData:C,rects:g,platform:u,elements:{reference:n,floating:a}});b=H??b,j=O??j,C={...C,[L]:{...C[L],...Q}},Z&&M<=50&&(M++,typeof Z=="object"&&(Z.placement&&(F=Z.placement),Z.rects&&(g=Z.rects===!0?await u.getElementRects({reference:n,floating:a,strategy:s}):Z.rects),{x:b,y:j}=A6(g,F,m)),_=-1)}return{x:b,y:j,placement:F,strategy:s,middlewareData:C}};async function LM(n,a){var t;a===void 0&&(a={});const{x:r,y:s,platform:e,rects:u,elements:f,strategy:m}=n,{boundary:g="clippingAncestors",rootBoundary:b="viewport",elementContext:j="floating",altBoundary:F=!1,padding:C=0}=Kb(a,n),M=y8(C),L=f[F?j==="floating"?"reference":"floating":j],T=cb(await e.getClippingRect({element:(t=await(e.isElement==null?void 0:e.isElement(L)))==null||t?L:L.contextElement||await(e.getDocumentElement==null?void 0:e.getDocumentElement(f.floating)),boundary:g,rootBoundary:b,strategy:m})),H=j==="floating"?{x:r,y:s,width:u.floating.width,height:u.floating.height}:u.reference,O=await(e.getOffsetParent==null?void 0:e.getOffsetParent(f.floating)),Q=await(e.isElement==null?void 0:e.isElement(O))?await(e.getScale==null?void 0:e.getScale(O))||{x:1,y:1}:{x:1,y:1},Z=cb(e.convertOffsetParentRelativeRectToViewportRelativeRect?await e.convertOffsetParentRelativeRectToViewportRelativeRect({elements:f,rect:H,offsetParent:O,strategy:m}):H);return{top:(T.top-Z.top+M.top)/Q.y,bottom:(Z.bottom-T.bottom+M.bottom)/Q.y,left:(T.left-Z.left+M.left)/Q.x,right:(Z.right-T.right+M.right)/Q.x}}const UM=n=>({name:"arrow",options:n,async fn(a){const{x:t,y:r,placement:s,rects:e,platform:u,elements:f,middlewareData:m}=a,{element:g,padding:b=0}=Kb(n,a)||{};if(g==null)return{};const j=y8(b),F={x:t,y:r},C=k5(s),M=E5(C),_=await u.getDimensions(g),L=C==="y",T=L?"top":"left",H=L?"bottom":"right",O=L?"clientHeight":"clientWidth",Q=e.reference[M]+e.reference[C]-F[C]-e.floating[M],Z=F[C]-e.reference[C],ee=await(u.getOffsetParent==null?void 0:u.getOffsetParent(g));let se=ee?ee[O]:0;(!se||!await(u.isElement==null?void 0:u.isElement(ee)))&&(se=f.floating[O]||e.floating[M]);const ue=Q/2-Z/2,ae=se/2-_[M]/2-1,pe=ip(j[T],ae),z=ip(j[H],ae),J=pe,ge=se-_[M]-z,fe=se/2-_[M]/2+ue,ke=pM(J,fe,ge),he=!m.arrow&&gg(s)!=null&&fe!==ke&&e.reference[M]/2-(fe<J?pe:z)-_[M]/2<0,Ne=he?fe<J?fe-J:fe-ge:0;return{[C]:F[C]+Ne,data:{[C]:ke,centerOffset:fe-ke-Ne,...he&&{alignmentOffset:Ne}},reset:he}}}),MM=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(a){var t,r;const{placement:s,middlewareData:e,rects:u,initialPlacement:f,platform:m,elements:g}=a,{mainAxis:b=!0,crossAxis:j=!0,fallbackPlacements:F,fallbackStrategy:C="bestFit",fallbackAxisSideDirection:M="none",flipAlignment:_=!0,...L}=Kb(n,a);if((t=e.arrow)!=null&&t.alignmentOffset)return{};const T=op(s),H=lh(f),O=op(f)===f,Q=await(m.isRTL==null?void 0:m.isRTL(g.floating)),Z=F||(O||!_?[lb(f)]:yM(f)),ee=M!=="none";!F&&ee&&Z.push(...CM(f,_,M,Q));const se=[f,...Z],ue=await LM(a,L),ae=[];let pe=((r=e.flip)==null?void 0:r.overflows)||[];if(b&&ae.push(ue[T]),j){const fe=bM(s,u,Q);ae.push(ue[fe[0]],ue[fe[1]])}if(pe=[...pe,{placement:s,overflows:ae}],!ae.every(fe=>fe<=0)){var z,J;const fe=(((z=e.flip)==null?void 0:z.index)||0)+1,ke=se[fe];if(ke&&(!(j==="alignment"?H!==lh(ke):!1)||pe.every(xe=>lh(xe.placement)===H?xe.overflows[0]>0:!0)))return{data:{index:fe,overflows:pe},reset:{placement:ke}};let he=(J=pe.filter(Ne=>Ne.overflows[0]<=0).sort((Ne,xe)=>Ne.overflows[1]-xe.overflows[1])[0])==null?void 0:J.placement;if(!he)switch(C){case"bestFit":{var ge;const Ne=(ge=pe.filter(xe=>{if(ee){const we=lh(xe.placement);return we===H||we==="y"}return!0}).map(xe=>[xe.placement,xe.overflows.filter(we=>we>0).reduce((we,ye)=>we+ye,0)]).sort((xe,we)=>xe[1]-we[1])[0])==null?void 0:ge[0];Ne&&(he=Ne);break}case"initialPlacement":he=f;break}if(s!==he)return{reset:{placement:he}}}return{}}}},IM=new Set(["left","top"]);async function OM(n,a){const{placement:t,platform:r,elements:s}=n,e=await(r.isRTL==null?void 0:r.isRTL(s.floating)),u=op(t),f=gg(t),m=lh(t)==="y",g=IM.has(u)?-1:1,b=e&&m?-1:1,j=Kb(a,n);let{mainAxis:F,crossAxis:C,alignmentAxis:M}=typeof j=="number"?{mainAxis:j,crossAxis:0,alignmentAxis:null}:{mainAxis:j.mainAxis||0,crossAxis:j.crossAxis||0,alignmentAxis:j.alignmentAxis};return f&&typeof M=="number"&&(C=f==="end"?M*-1:M),m?{x:C*b,y:F*g}:{x:F*g,y:C*b}}const QM=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(a){var t,r;const{x:s,y:e,placement:u,middlewareData:f}=a,m=await OM(a,n);return u===((t=f.offset)==null?void 0:t.placement)&&(r=f.arrow)!=null&&r.alignmentOffset?{}:{x:s+m.x,y:e+m.y,data:{...m,placement:u}}}}};function w8(n){const a=RA(n);let t=parseFloat(a.width)||0,r=parseFloat(a.height)||0;const s=Au(n),e=s?n.offsetWidth:t,u=s?n.offsetHeight:r,f=ob(t)!==e||ob(r)!==u;return f&&(t=e,r=u),{width:t,height:r,$:f}}function D5(n){return ic(n)?n:n.contextElement}function $m(n){const a=D5(n);if(!Au(a))return ou(1);const t=a.getBoundingClientRect(),{width:r,height:s,$:e}=w8(a);let u=(e?ob(t.width):t.width)/r,f=(e?ob(t.height):t.height)/s;return(!u||!Number.isFinite(u))&&(u=1),(!f||!Number.isFinite(f))&&(f=1),{x:u,y:f}}const RM=ou(0);function N8(n){const a=dA(n);return!F5()||!a.visualViewport?RM:{x:a.visualViewport.offsetLeft,y:a.visualViewport.offsetTop}}function PM(n,a,t){return a===void 0&&(a=!1),!t||a&&t!==dA(n)?!1:a}function Bh(n,a,t,r){a===void 0&&(a=!1),t===void 0&&(t=!1);const s=n.getBoundingClientRect(),e=D5(n);let u=ou(1);a&&(r?ic(r)&&(u=$m(r)):u=$m(n));const f=PM(e,t,r)?N8(e):ou(0);let m=(s.left+f.x)/u.x,g=(s.top+f.y)/u.y,b=s.width/u.x,j=s.height/u.y;if(e){const F=dA(e),C=r&&ic(r)?dA(r):r;let M=F,_=vw(M);for(;_&&r&&C!==M;){const L=$m(_),T=_.getBoundingClientRect(),H=RA(_),O=T.left+(_.clientLeft+parseFloat(H.paddingLeft))*L.x,Q=T.top+(_.clientTop+parseFloat(H.paddingTop))*L.y;m*=L.x,g*=L.y,b*=L.x,j*=L.y,m+=O,g+=Q,M=dA(_),_=vw(M)}}return cb({width:b,height:j,x:m,y:g})}function Gb(n,a){const t=zb(n).scrollLeft;return a?a.left+t:Bh(uu(n)).left+t}function C8(n,a){const t=n.getBoundingClientRect(),r=t.left+a.scrollLeft-Gb(n,t),s=t.top+a.scrollTop;return{x:r,y:s}}function HM(n){let{elements:a,rect:t,offsetParent:r,strategy:s}=n;const e=s==="fixed",u=uu(r),f=a?Hb(a.floating):!1;if(r===u||f&&e)return t;let m={scrollLeft:0,scrollTop:0},g=ou(1);const b=ou(0),j=Au(r);if((j||!j&&!e)&&((hp(r)!=="body"||pg(u))&&(m=zb(r)),Au(r))){const C=Bh(r);g=$m(r),b.x=C.x+r.clientLeft,b.y=C.y+r.clientTop}const F=u&&!j&&!e?C8(u,m):ou(0);return{width:t.width*g.x,height:t.height*g.y,x:t.x*g.x-m.scrollLeft*g.x+b.x+F.x,y:t.y*g.y-m.scrollTop*g.y+b.y+F.y}}function zM(n){return Array.from(n.getClientRects())}function KM(n){const a=uu(n),t=zb(n),r=n.ownerDocument.body,s=ph(a.scrollWidth,a.clientWidth,r.scrollWidth,r.clientWidth),e=ph(a.scrollHeight,a.clientHeight,r.scrollHeight,r.clientHeight);let u=-t.scrollLeft+Gb(n);const f=-t.scrollTop;return RA(r).direction==="rtl"&&(u+=ph(a.clientWidth,r.clientWidth)-s),{width:s,height:e,x:u,y:f}}const d6=25;function GM(n,a){const t=dA(n),r=uu(n),s=t.visualViewport;let e=r.clientWidth,u=r.clientHeight,f=0,m=0;if(s){e=s.width,u=s.height;const b=F5();(!b||b&&a==="fixed")&&(f=s.offsetLeft,m=s.offsetTop)}const g=Gb(r);if(g<=0){const b=r.ownerDocument,j=b.body,F=getComputedStyle(j),C=b.compatMode==="CSS1Compat"&&parseFloat(F.marginLeft)+parseFloat(F.marginRight)||0,M=Math.abs(r.clientWidth-j.clientWidth-C);M<=d6&&(e-=M)}else g<=d6&&(e+=g);return{width:e,height:u,x:f,y:m}}const VM=new Set(["absolute","fixed"]);function YM(n,a){const t=Bh(n,!0,a==="fixed"),r=t.top+n.clientTop,s=t.left+n.clientLeft,e=Au(n)?$m(n):ou(1),u=n.clientWidth*e.x,f=n.clientHeight*e.y,m=s*e.x,g=r*e.y;return{width:u,height:f,x:m,y:g}}function u6(n,a,t){let r;if(a==="viewport")r=GM(n,t);else if(a==="document")r=KM(uu(n));else if(ic(a))r=YM(a,t);else{const s=N8(n);r={x:a.x-s.x,y:a.y-s.y,width:a.width,height:a.height}}return cb(r)}function j8(n,a){const t=h0(n);return t===a||!ic(t)||np(t)?!1:RA(t).position==="fixed"||j8(t,a)}function WM(n,a){const t=a.get(n);if(t)return t;let r=og(n,[],!1).filter(f=>ic(f)&&hp(f)!=="body"),s=null;const e=RA(n).position==="fixed";let u=e?h0(n):n;for(;ic(u)&&!np(u);){const f=RA(u),m=S5(u);!m&&f.position==="fixed"&&(s=null),(e?!m&&!s:!m&&f.position==="static"&&!!s&&VM.has(s.position)||pg(u)&&!m&&j8(n,u))?r=r.filter(b=>b!==u):s=f,u=h0(u)}return a.set(n,r),r}function $M(n){let{element:a,boundary:t,rootBoundary:r,strategy:s}=n;const u=[...t==="clippingAncestors"?Hb(a)?[]:WM(a,this._c):[].concat(t),r],f=u[0],m=u.reduce((g,b)=>{const j=u6(a,b,s);return g.top=ph(j.top,g.top),g.right=ip(j.right,g.right),g.bottom=ip(j.bottom,g.bottom),g.left=ph(j.left,g.left),g},u6(a,f,s));return{width:m.right-m.left,height:m.bottom-m.top,x:m.left,y:m.top}}function qM(n){const{width:a,height:t}=w8(n);return{width:a,height:t}}function XM(n,a,t){const r=Au(a),s=uu(a),e=t==="fixed",u=Bh(n,!0,e,a);let f={scrollLeft:0,scrollTop:0};const m=ou(0);function g(){m.x=Gb(s)}if(r||!r&&!e)if((hp(a)!=="body"||pg(s))&&(f=zb(a)),r){const C=Bh(a,!0,e,a);m.x=C.x+a.clientLeft,m.y=C.y+a.clientTop}else s&&g();e&&!r&&s&&g();const b=s&&!r&&!e?C8(s,f):ou(0),j=u.left+f.scrollLeft-m.x-b.x,F=u.top+f.scrollTop-m.y-b.y;return{x:j,y:F,width:u.width,height:u.height}}function iv(n){return RA(n).position==="static"}function f6(n,a){if(!Au(n)||RA(n).position==="fixed")return null;if(a)return a(n);let t=n.offsetParent;return uu(n)===t&&(t=t.ownerDocument.body),t}function B8(n,a){const t=dA(n);if(Hb(n))return t;if(!Au(n)){let s=h0(n);for(;s&&!np(s);){if(ic(s)&&!iv(s))return s;s=h0(s)}return t}let r=f6(n,a);for(;r&&oM(r)&&iv(r);)r=f6(r,a);return r&&np(r)&&iv(r)&&!S5(r)?t:r||uM(n)||t}const JM=async function(n){const a=this.getOffsetParent||B8,t=this.getDimensions,r=await t(n.floating);return{reference:XM(n.reference,await a(n.floating),n.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function ZM(n){return RA(n).direction==="rtl"}const eI={convertOffsetParentRelativeRectToViewportRelativeRect:HM,getDocumentElement:uu,getClippingRect:$M,getOffsetParent:B8,getElementRects:JM,getClientRects:zM,getDimensions:qM,getScale:$m,isElement:ic,isRTL:ZM};function S8(n,a){return n.x===a.x&&n.y===a.y&&n.width===a.width&&n.height===a.height}function tI(n,a){let t=null,r;const s=uu(n);function e(){var f;clearTimeout(r),(f=t)==null||f.disconnect(),t=null}function u(f,m){f===void 0&&(f=!1),m===void 0&&(m=1),e();const g=n.getBoundingClientRect(),{left:b,top:j,width:F,height:C}=g;if(f||a(),!F||!C)return;const M=Ix(j),_=Ix(s.clientWidth-(b+F)),L=Ix(s.clientHeight-(j+C)),T=Ix(b),O={rootMargin:-M+"px "+-_+"px "+-L+"px "+-T+"px",threshold:ph(0,ip(1,m))||1};let Q=!0;function Z(ee){const se=ee[0].intersectionRatio;if(se!==m){if(!Q)return u();se?u(!1,se):r=setTimeout(()=>{u(!1,1e-7)},1e3)}se===1&&!S8(g,n.getBoundingClientRect())&&u(),Q=!1}try{t=new IntersectionObserver(Z,{...O,root:s.ownerDocument})}catch{t=new IntersectionObserver(Z,O)}t.observe(n)}return u(!0),e}function rI(n,a,t,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:e=!0,elementResize:u=typeof ResizeObserver=="function",layoutShift:f=typeof IntersectionObserver=="function",animationFrame:m=!1}=r,g=D5(n),b=s||e?[...g?og(g):[],...og(a)]:[];b.forEach(T=>{s&&T.addEventListener("scroll",t,{passive:!0}),e&&T.addEventListener("resize",t)});const j=g&&f?tI(g,t):null;let F=-1,C=null;u&&(C=new ResizeObserver(T=>{let[H]=T;H&&H.target===g&&C&&(C.unobserve(a),cancelAnimationFrame(F),F=requestAnimationFrame(()=>{var O;(O=C)==null||O.observe(a)})),t()}),g&&!m&&C.observe(g),C.observe(a));let M,_=m?Bh(n):null;m&&L();function L(){const T=Bh(n);_&&!S8(_,T)&&t(),_=T,M=requestAnimationFrame(L)}return t(),()=>{var T;b.forEach(H=>{s&&H.removeEventListener("scroll",t),e&&H.removeEventListener("resize",t)}),j?.(),(T=C)==null||T.disconnect(),C=null,m&&cancelAnimationFrame(M)}}const aI=QM,sI=MM,h6=UM,nI=(n,a,t)=>{const r=new Map,s={platform:eI,...t},e={...s.platform,_c:r};return _M(n,a,{...s,platform:e})};var iI=typeof document<"u",oI=function(){},T2=iI?ne.useLayoutEffect:oI;function db(n,a){if(n===a)return!0;if(typeof n!=typeof a)return!1;if(typeof n=="function"&&n.toString()===a.toString())return!0;let t,r,s;if(n&&a&&typeof n=="object"){if(Array.isArray(n)){if(t=n.length,t!==a.length)return!1;for(r=t;r--!==0;)if(!db(n[r],a[r]))return!1;return!0}if(s=Object.keys(n),t=s.length,t!==Object.keys(a).length)return!1;for(r=t;r--!==0;)if(!{}.hasOwnProperty.call(a,s[r]))return!1;for(r=t;r--!==0;){const e=s[r];if(!(e==="_owner"&&n.$$typeof)&&!db(n[e],a[e]))return!1}return!0}return n!==n&&a!==a}function F8(n){return typeof window>"u"?1:(n.ownerDocument.defaultView||window).devicePixelRatio||1}function m6(n,a){const t=F8(n);return Math.round(a*t)/t}function ov(n){const a=ne.useRef(n);return T2(()=>{a.current=n}),a}function lI(n){n===void 0&&(n={});const{placement:a="bottom",strategy:t="absolute",middleware:r=[],platform:s,elements:{reference:e,floating:u}={},transform:f=!0,whileElementsMounted:m,open:g}=n,[b,j]=ne.useState({x:0,y:0,strategy:t,placement:a,middlewareData:{},isPositioned:!1}),[F,C]=ne.useState(r);db(F,r)||C(r);const[M,_]=ne.useState(null),[L,T]=ne.useState(null),H=ne.useCallback(xe=>{xe!==ee.current&&(ee.current=xe,_(xe))},[]),O=ne.useCallback(xe=>{xe!==se.current&&(se.current=xe,T(xe))},[]),Q=e||M,Z=u||L,ee=ne.useRef(null),se=ne.useRef(null),ue=ne.useRef(b),ae=m!=null,pe=ov(m),z=ov(s),J=ov(g),ge=ne.useCallback(()=>{if(!ee.current||!se.current)return;const xe={placement:a,strategy:t,middleware:F};z.current&&(xe.platform=z.current),nI(ee.current,se.current,xe).then(we=>{const ye={...we,isPositioned:J.current!==!1};fe.current&&!db(ue.current,ye)&&(ue.current=ye,v8.flushSync(()=>{j(ye)}))})},[F,a,t,z,J]);T2(()=>{g===!1&&ue.current.isPositioned&&(ue.current.isPositioned=!1,j(xe=>({...xe,isPositioned:!1})))},[g]);const fe=ne.useRef(!1);T2(()=>(fe.current=!0,()=>{fe.current=!1}),[]),T2(()=>{if(Q&&(ee.current=Q),Z&&(se.current=Z),Q&&Z){if(pe.current)return pe.current(Q,Z,ge);ge()}},[Q,Z,ge,pe,ae]);const ke=ne.useMemo(()=>({reference:ee,floating:se,setReference:H,setFloating:O}),[H,O]),he=ne.useMemo(()=>({reference:Q,floating:Z}),[Q,Z]),Ne=ne.useMemo(()=>{const xe={position:t,left:0,top:0};if(!he.floating)return xe;const we=m6(he.floating,b.x),ye=m6(he.floating,b.y);return f?{...xe,transform:"translate("+we+"px, "+ye+"px)",...F8(he.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:we,top:ye}},[t,f,he.floating,b.x,b.y]);return ne.useMemo(()=>({...b,update:ge,refs:ke,elements:he,floatingStyles:Ne}),[b,ge,ke,he,Ne])}const cI=n=>{function a(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:n,fn(t){const{element:r,padding:s}=typeof n=="function"?n(t):n;return r&&a(r)?r.current!=null?h6({element:r.current,padding:s}).fn(t):{}:r?h6({element:r,padding:s}).fn(t):{}}}},AI=(n,a)=>({...aI(n),options:[n,a]}),dI=(n,a)=>({...sI(n),options:[n,a]}),uI=(n,a)=>({...cI(n),options:[n,a]}),fI={...HN};let p6=!1,hI=0;const g6=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+hI++;function mI(){const[n,a]=ne.useState(()=>p6?g6():void 0);return Ab(()=>{n==null&&a(g6())},[]),ne.useEffect(()=>{p6=!0},[]),n}const pI=fI.useId,E8=pI||mI,gI=ne.forwardRef(function(a,t){const{context:{placement:r,elements:{floating:s},middlewareData:{arrow:e,shift:u}},width:f=14,height:m=7,tipRadius:g=0,strokeWidth:b=0,staticOffset:j,stroke:F,d:C,style:{transform:M,..._}={},...L}=a,T=E8(),[H,O]=ne.useState(!1);if(Ab(()=>{if(!s)return;RA(s).direction==="rtl"&&O(!0)},[s]),!s)return null;const[Q,Z]=r.split("-"),ee=Q==="top"||Q==="bottom";let se=j;(ee&&u!=null&&u.x||!ee&&u!=null&&u.y)&&(se=null);const ue=b*2,ae=ue/2,pe=f/2*(g/-8+1),z=m/2*g/4,J=!!C,ge=se&&Z==="end"?"bottom":"top";let fe=se&&Z==="end"?"right":"left";se&&H&&(fe=Z==="end"?"left":"right");const ke=e?.x!=null?se||e.x:"",he=e?.y!=null?se||e.y:"",Ne=C||"M0,0"+(" H"+f)+(" L"+(f-pe)+","+(m-z))+(" Q"+f/2+","+m+" "+pe+","+(m-z))+" Z",xe={top:J?"rotate(180deg)":"",left:J?"rotate(90deg)":"rotate(-90deg)",bottom:J?"":"rotate(180deg)",right:J?"rotate(-90deg)":"rotate(90deg)"}[Q];return i.jsxs("svg",{...L,"aria-hidden":!0,ref:t,width:J?f:f+ue,height:f,viewBox:"0 0 "+f+" "+(m>f?m:f),style:{position:"absolute",pointerEvents:"none",[fe]:ke,[ge]:he,[Q]:ee||J?"100%":"calc(100% - "+ue/2+"px)",transform:[xe,M].filter(we=>!!we).join(" "),..._},children:[ue>0&&i.jsx("path",{clipPath:"url(#"+T+")",fill:"none",stroke:F,strokeWidth:ue+(C?0:1),d:Ne}),i.jsx("path",{stroke:ue&&!C?L.fill:"none",d:Ne}),i.jsx("clipPath",{id:T,children:i.jsx("rect",{x:-ae,y:ae*(J?-1:1),width:f+ue,height:f})})]})});function xI(){const n=new Map;return{emit(a,t){var r;(r=n.get(a))==null||r.forEach(s=>s(t))},on(a,t){n.has(a)||n.set(a,new Set),n.get(a).add(t)},off(a,t){var r;(r=n.get(a))==null||r.delete(t)}}}const bI=ne.createContext(null),yI=ne.createContext(null),vI=()=>{var n;return((n=ne.useContext(bI))==null?void 0:n.id)||null},wI=()=>ne.useContext(yI);function NI(n){const{open:a=!1,onOpenChange:t,elements:r}=n,s=E8(),e=ne.useRef({}),[u]=ne.useState(()=>xI()),f=vI()!=null,[m,g]=ne.useState(r.reference),b=DM((C,M,_)=>{e.current.openEvent=C?M:void 0,u.emit("openchange",{open:C,event:M,reason:_,nested:f}),t?.(C,M,_)}),j=ne.useMemo(()=>({setPositionReference:g}),[]),F=ne.useMemo(()=>({reference:m||r.reference||null,floating:r.floating||null,domReference:r.reference}),[m,r.reference,r.floating]);return ne.useMemo(()=>({dataRef:e,open:a,onOpenChange:b,elements:F,events:u,floatingId:s,refs:j}),[a,b,F,u,s,j])}function CI(n){n===void 0&&(n={});const{nodeId:a}=n,t=NI({...n,elements:{reference:null,floating:null,...n.elements}}),r=n.rootContext||t,s=r.elements,[e,u]=ne.useState(null),[f,m]=ne.useState(null),b=s?.domReference||e,j=ne.useRef(null),F=wI();Ab(()=>{b&&(j.current=b)},[b]);const C=lI({...n,elements:{...s,...f&&{reference:f}}}),M=ne.useCallback(O=>{const Q=ic(O)?{getBoundingClientRect:()=>O.getBoundingClientRect(),getClientRects:()=>O.getClientRects(),contextElement:O}:O;m(Q),C.refs.setReference(Q)},[C.refs]),_=ne.useCallback(O=>{(ic(O)||O===null)&&(j.current=O,u(O)),(ic(C.refs.reference.current)||C.refs.reference.current===null||O!==null&&!ic(O))&&C.refs.setReference(O)},[C.refs]),L=ne.useMemo(()=>({...C.refs,setReference:_,setPositionReference:M,domReference:j}),[C.refs,_,M]),T=ne.useMemo(()=>({...C.elements,domReference:b}),[C.elements,b]),H=ne.useMemo(()=>({...C,...r,refs:L,elements:T,nodeId:a}),[C,L,T,a,r]);return Ab(()=>{r.dataRef.current.floatingContext=H;const O=F?.nodesRef.current.find(Q=>Q.id===a);O&&(O.context=H)}),ne.useMemo(()=>({...C,context:H,refs:L,elements:T}),[C,L,T,H])}/*!
  react-datepicker v8.7.0
  https://github.com/Hacker0x01/react-datepicker
  Released under the MIT License.
*/var Nw=function(a,t){return Nw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var e in s)Object.prototype.hasOwnProperty.call(s,e)&&(r[e]=s[e])},Nw(a,t)};function bl(n,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");Nw(n,a);function t(){this.constructor=n}n.prototype=a===null?Object.create(a):(t.prototype=a.prototype,new t)}var Bs=function(){return Bs=Object.assign||function(t){for(var r,s=1,e=arguments.length;s<e;s++){r=arguments[s];for(var u in r)Object.prototype.hasOwnProperty.call(r,u)&&(t[u]=r[u])}return t},Bs.apply(this,arguments)};function iu(n,a,t){if(t||arguments.length===2)for(var r=0,s=a.length,e;r<s;r++)(e||!(r in a))&&(e||(e=Array.prototype.slice.call(a,0,r)),e[r]=a[r]);return n.concat(e||Array.prototype.slice.call(a))}var jI=function(n){var a=n.showTimeSelectOnly,t=a===void 0?!1:a,r=n.showTime,s=r===void 0?!1:r,e=n.className,u=n.children,f=t?"Choose Time":"Choose Date".concat(s?" and Time":"");return At.createElement("div",{className:e,role:"dialog","aria-label":f,"aria-modal":"true"},u)},BI=function(n,a){var t=ne.useRef(null),r=ne.useRef(n);r.current=n;var s=ne.useCallback(function(e){var u,f=e.composed&&e.composedPath&&e.composedPath().find(function(m){return m instanceof Node})||e.target;t.current&&!t.current.contains(f)&&(a&&f instanceof HTMLElement&&f.classList.contains(a)||(u=r.current)===null||u===void 0||u.call(r,e))},[a]);return ne.useEffect(function(){return document.addEventListener("mousedown",s),function(){document.removeEventListener("mousedown",s)}},[s]),t},Vb=function(n){var a=n.children,t=n.onClickOutside,r=n.className,s=n.containerRef,e=n.style,u=n.ignoreClass,f=BI(t,u);return At.createElement("div",{className:r,style:e,ref:function(m){f.current=m,s&&(s.current=m)}},a)},Ur;(function(n){n.ArrowUp="ArrowUp",n.ArrowDown="ArrowDown",n.ArrowLeft="ArrowLeft",n.ArrowRight="ArrowRight",n.PageUp="PageUp",n.PageDown="PageDown",n.Home="Home",n.End="End",n.Enter="Enter",n.Space=" ",n.Tab="Tab",n.Escape="Escape",n.Backspace="Backspace",n.X="x"})(Ur||(Ur={}));function k8(){var n=typeof window<"u"?window:globalThis;return n}var xg=12;function fn(n){if(n==null)return new Date;var a=typeof n=="string"?zU(n):Aa(n);return Yb(a)?a:new Date}function lv(n,a,t,r,s){s===void 0&&(s=fn());for(var e=lp(t)||lp(T5()),u=Array.isArray(a)?a:[a],f=0,m=u;f<m.length;f++){var g=m[f],b=IU(n,g,s,{locale:e});if(Yb(b)&&(!r||n===oi(b,g,t)))return b}return null}function Yb(n,a){return rb(n)&&!nu(n,new Date("1/1/1800"))}function oi(n,a,t){if(t==="en")return s6(n,a,{useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});var r=t?lp(t):void 0;return t&&!r&&console.warn('A locale object was not found for the provided string ["'.concat(t,'"].')),r=r||lp(T5()),s6(n,a,{locale:r,useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0})}function DA(n,a){var t=a.dateFormat,r=a.locale,s=Array.isArray(t)&&t.length>0?t[0]:t;return n&&oi(n,s,r)||""}var D8=" - ";function SI(n,a,t){if(!n&&!a)return"";var r=n?DA(n,t):"",s=a?DA(a,t):"",e=t.rangeSeparator||D8;return"".concat(r).concat(e).concat(s)}function FI(n,a){if(!n?.length)return"";var t=n[0]?DA(n[0],a):"";if(n.length===1)return t;if(n.length===2&&n[1]){var r=DA(n[1],a);return"".concat(t,", ").concat(r)}var s=n.length-1;return"".concat(t," (+").concat(s,")")}function cv(n,a){var t=a.hour,r=t===void 0?0:t,s=a.minute,e=s===void 0?0:s,u=a.second,f=u===void 0?0:u;return E2(k2(D2(n,f),e),r)}function EI(n){return N5(n)}function kI(n,a){return oi(n,"ddd",a)}function _2(n){return jh(n)}function l0(n,a,t){var r=lp(a||T5());return of(n,{locale:r,weekStartsOn:t})}function tf(n){return o8(n)}function E1(n){return Rb(n)}function x6(n){return xw(n)}function b6(){return jh(fn())}function y6(n){return n8(n)}function DI(n){return z_(n)}function TI(n){return i8(n)}function tu(n,a){return n&&a?PU(n,a):!n&&!a}function ac(n,a){return n&&a?QU(n,a):!n&&!a}function ub(n,a){return n&&a?RU(n,a):!n&&!a}function js(n,a){return n&&a?P_(n,a):!n&&!a}function ch(n,a){return n&&a?HL(n,a):!n&&!a}function nh(n,a,t){var r,s=jh(a),e=n8(t);try{r=ig(n,{start:s,end:e})}catch{r=!1}return r}function T5(){var n=k8();return n.__localeId__}function lp(n){if(typeof n=="string"){var a=k8();return a.__localeData__?a.__localeData__[n]:void 0}else return n}function _I(n,a,t){return a(oi(n,"EEEE",t))}function LI(n,a){return oi(n,"EEEEEE",a)}function UI(n,a){return oi(n,"EEE",a)}function _5(n,a){return oi(TA(fn(),n),"LLLL",a)}function T8(n,a){return oi(TA(fn(),n),"LLL",a)}function MI(n,a){return oi(Om(fn(),n),"QQQ",a)}function _A(n,a){var t=a===void 0?{}:a,r=t.minDate,s=t.maxDate,e=t.excludeDates,u=t.excludeDateIntervals,f=t.includeDates,m=t.includeDateIntervals,g=t.filterDate;return bg(n,{minDate:r,maxDate:s})||e&&e.some(function(b){return b instanceof Date?js(n,b):js(n,b.date)})||u&&u.some(function(b){var j=b.start,F=b.end;return ig(n,{start:j,end:F})})||f&&!f.some(function(b){return js(n,b)})||m&&!m.some(function(b){var j=b.start,F=b.end;return ig(n,{start:j,end:F})})||g&&!g(fn(n))||!1}function L5(n,a){var t=a===void 0?{}:a,r=t.excludeDates,s=t.excludeDateIntervals;return s&&s.length>0?s.some(function(e){var u=e.start,f=e.end;return ig(n,{start:u,end:f})}):r&&r.some(function(e){var u;return e instanceof Date?js(n,e):js(n,(u=e.date)!==null&&u!==void 0?u:new Date)})||!1}function _8(n,a){var t=a===void 0?{}:a,r=t.minDate,s=t.maxDate,e=t.excludeDates,u=t.includeDates,f=t.filterDate;return bg(n,{minDate:r?o8(r):void 0,maxDate:s?i8(s):void 0})||e?.some(function(m){return ac(n,m instanceof Date?m:m.date)})||u&&!u.some(function(m){return ac(n,m)})||f&&!f(fn(n))||!1}function Ox(n,a,t,r){var s=os(n),e=Ql(n),u=os(a),f=Ql(a),m=os(r);return s===u&&s===m?e<=t&&t<=f:s<u?m===s&&e<=t||m===u&&f>=t||m<u&&m>s:!1}function II(n,a){var t=a===void 0?{}:a,r=t.minDate,s=t.maxDate,e=t.excludeDates,u=t.includeDates;return bg(n,{minDate:r,maxDate:s})||e&&e.some(function(f){return ac(f instanceof Date?f:f.date,n)})||u&&!u.some(function(f){return ac(f,n)})||!1}function Qx(n,a){var t=a===void 0?{}:a,r=t.minDate,s=t.maxDate,e=t.excludeDates,u=t.includeDates,f=t.filterDate;return bg(n,{minDate:r,maxDate:s})||e?.some(function(m){return ub(n,m instanceof Date?m:m.date)})||u&&!u.some(function(m){return ub(n,m)})||f&&!f(fn(n))||!1}function Rx(n,a,t){if(!a||!t||!rb(a)||!rb(t))return!1;var r=os(a),s=os(t);return r<=n&&s>=n}function L2(n,a){var t=a===void 0?{}:a,r=t.minDate,s=t.maxDate,e=t.excludeDates,u=t.includeDates,f=t.filterDate,m=new Date(n,0,1);return bg(m,{minDate:r?Rb(r):void 0,maxDate:s?l8(s):void 0})||e?.some(function(g){return tu(m,g instanceof Date?g:g.date)})||u&&!u.some(function(g){return tu(m,g)})||f&&!f(fn(m))||!1}function Px(n,a,t,r){var s=os(n),e=hh(n),u=os(a),f=hh(a),m=os(r);return s===u&&s===m?e<=t&&t<=f:s<u?m===s&&e<=t||m===u&&f>=t||m<u&&m>s:!1}function bg(n,a){var t,r=a===void 0?{}:a,s=r.minDate,e=r.maxDate;return(t=s&&ap(n,s)<0||e&&ap(n,e)>0)!==null&&t!==void 0?t:!1}function v6(n,a){return a.some(function(t){return Zu(t)===Zu(n)&&ef(t)===ef(n)&&o0(t)===o0(n)})}function w6(n,a){var t=a===void 0?{}:a,r=t.excludeTimes,s=t.includeTimes,e=t.filterTime;return r&&v6(n,r)||s&&!v6(n,s)||e&&!e(n)||!1}function N6(n,a){var t=a.minTime,r=a.maxTime;if(!t||!r)throw new Error("Both minTime and maxTime props required");var s=fn();s=E2(s,Zu(n)),s=k2(s,ef(n)),s=D2(s,o0(n));var e=fn();e=E2(e,Zu(t)),e=k2(e,ef(t)),e=D2(e,o0(t));var u=fn();u=E2(u,Zu(r)),u=k2(u,ef(r)),u=D2(u,o0(r));var f;try{f=!ig(s,{start:e,end:u})}catch{f=!1}return f}function C6(n,a){var t=a===void 0?{}:a,r=t.minDate,s=t.includeDates,e=mh(n,1);return r&&ab(r,e)>0||s&&s.every(function(u){return ab(u,e)>0})||!1}function j6(n,a){var t=a===void 0?{}:a,r=t.maxDate,s=t.includeDates,e=Nd(n,1);return r&&ab(e,r)>0||s&&s.every(function(u){return ab(e,u)>0})||!1}function OI(n,a){var t=a===void 0?{}:a,r=t.minDate,s=t.includeDates,e=Rb(n),u=g8(e);return r&&sb(r,u)>0||s&&s.every(function(f){return sb(f,u)>0})||!1}function QI(n,a){var t=a===void 0?{}:a,r=t.maxDate,s=t.includeDates,e=l8(n),u=w5(e,1);return r&&sb(u,r)>0||s&&s.every(function(f){return sb(u,f)>0})||!1}function B6(n,a){var t=a===void 0?{}:a,r=t.minDate,s=t.includeDates,e=sp(n,1);return r&&nb(r,e)>0||s&&s.every(function(u){return nb(u,e)>0})||!1}function RI(n,a){var t=a===void 0?{}:a,r=t.minDate,s=t.yearItemNumber,e=s===void 0?xg:s,u=E1(sp(n,e)),f=Yu(u,e).endPeriod,m=r&&os(r);return m&&m>f||!1}function S6(n,a){var t=a===void 0?{}:a,r=t.maxDate,s=t.includeDates,e=Xu(n,1);return r&&nb(e,r)>0||s&&s.every(function(u){return nb(e,u)>0})||!1}function PI(n,a){var t=a===void 0?{}:a,r=t.maxDate,s=t.yearItemNumber,e=s===void 0?xg:s,u=Xu(n,e),f=Yu(u,e).startPeriod,m=r&&os(r);return m&&m<f||!1}function L8(n){var a=n.minDate,t=n.includeDates;if(t&&a){var r=t.filter(function(s){return ap(s,a)>=0});return J3(r)}else return t?J3(t):a}function U8(n){var a=n.maxDate,t=n.includeDates;if(t&&a){var r=t.filter(function(s){return ap(s,a)<=0});return X3(r)}else return t?X3(t):a}function F6(n,a){var t;n===void 0&&(n=[]),a===void 0&&(a="react-datepicker__day--highlighted");for(var r=new Map,s=0,e=n.length;s<e;s++){var u=n[s];if(Ju(u)){var f=oi(u,"MM.dd.yyyy"),m=r.get(f)||[];m.includes(a)||(m.push(a),r.set(f,m))}else if(typeof u=="object"){var g=Object.keys(u),b=(t=g[0])!==null&&t!==void 0?t:"",j=u[b];if(typeof b=="string"&&Array.isArray(j))for(var F=0,C=j.length;F<C;F++){var M=j[F];if(M){var f=oi(M,"MM.dd.yyyy"),m=r.get(f)||[];m.includes(b)||(m.push(b),r.set(f,m))}}}}return r}function HI(n,a){return n.length!==a.length?!1:n.every(function(t,r){return t===a[r]})}function zI(n,a){n===void 0&&(n=[]),a===void 0&&(a="react-datepicker__day--holidays");var t=new Map;return n.forEach(function(r){var s=r.date,e=r.holidayName;if(Ju(s)){var u=oi(s,"MM.dd.yyyy"),f=t.get(u)||{className:"",holidayNames:[]};if(!("className"in f&&f.className===a&&HI(f.holidayNames,[e]))){f.className=a;var m=f.holidayNames;f.holidayNames=m?iu(iu([],m,!0),[e],!1):[e],t.set(u,f)}}}),t}function KI(n,a,t,r,s){for(var e=s.length,u=[],f=0;f<e;f++){var m=n,g=s[f];g&&(m=I_(m,Zu(g)),m=gw(m,ef(g)),m=R_(m,o0(g)));var b=gw(n,(t+1)*r);f0(m,a)&&nu(m,b)&&g!=null&&u.push(g)}return u}function E6(n){return n<10?"0".concat(n):"".concat(n)}function Yu(n,a){a===void 0&&(a=xg);var t=Math.ceil(os(n)/a)*a,r=t-(a-1);return{startPeriod:r,endPeriod:t}}function GI(n){var a=new Date(n.getFullYear(),n.getMonth(),n.getDate()),t=new Date(n.getFullYear(),n.getMonth(),n.getDate(),24);return Math.round((+t-+a)/36e5)}function k6(n){var a=n.getSeconds(),t=n.getMilliseconds();return Aa(n.getTime()-a*1e3-t)}function VI(n,a){return k6(n).getTime()===k6(a).getTime()}function D6(n){if(!Ju(n))throw new Error("Invalid date");var a=new Date(n);return a.setHours(0,0,0,0),a}function Av(n,a){if(!Ju(n)||!Ju(a))throw new Error("Invalid date received");var t=D6(n),r=D6(a);return nu(t,r)}function M8(n){return n.key===Ur.Space}var YI=(function(n){bl(a,n);function a(t){var r=n.call(this,t)||this;return r.inputRef=At.createRef(),r.onTimeChange=function(s){var e,u;r.setState({time:s});var f=r.props.date,m=f instanceof Date&&!isNaN(+f),g=m?f:new Date;if(s?.includes(":")){var b=s.split(":"),j=b[0],F=b[1];g.setHours(Number(j)),g.setMinutes(Number(F))}(u=(e=r.props).onChange)===null||u===void 0||u.call(e,g)},r.renderTimeInput=function(){var s=r.state.time,e=r.props,u=e.date,f=e.timeString,m=e.customTimeInput;return m?ne.cloneElement(m,{date:u,value:s,onChange:r.onTimeChange}):At.createElement("input",{type:"time",className:"react-datepicker-time__input",placeholder:"Time",name:"time-input",ref:r.inputRef,onClick:function(){var g;(g=r.inputRef.current)===null||g===void 0||g.focus()},required:!0,value:s,onChange:function(g){r.onTimeChange(g.target.value||f)}})},r.state={time:r.props.timeString},r}return a.getDerivedStateFromProps=function(t,r){return t.timeString!==r.time?{time:t.timeString}:null},a.prototype.render=function(){return At.createElement("div",{className:"react-datepicker__input-time-container"},At.createElement("div",{className:"react-datepicker-time__caption"},this.props.timeInputLabel),At.createElement("div",{className:"react-datepicker-time__input-container"},At.createElement("div",{className:"react-datepicker-time__input"},this.renderTimeInput())))},a})(ne.Component),WI=(function(n){bl(a,n);function a(){var t=n!==null&&n.apply(this,arguments)||this;return t.dayEl=ne.createRef(),t.handleClick=function(r){!t.isDisabled()&&t.props.onClick&&t.props.onClick(r)},t.handleMouseEnter=function(r){!t.isDisabled()&&t.props.onMouseEnter&&t.props.onMouseEnter(r)},t.handleOnKeyDown=function(r){var s,e,u=r.key;u===Ur.Space&&(r.preventDefault(),r.key=Ur.Enter),(e=(s=t.props).handleOnKeyDown)===null||e===void 0||e.call(s,r)},t.isSameDay=function(r){return js(t.props.day,r)},t.isKeyboardSelected=function(){var r;if(t.props.disabledKeyboardNavigation)return!1;var s=t.props.selectsMultiple?(r=t.props.selectedDates)===null||r===void 0?void 0:r.some(function(u){return t.isSameDayOrWeek(u)}):t.isSameDayOrWeek(t.props.selected),e=t.props.preSelection&&t.isDisabled(t.props.preSelection);return!s&&t.isSameDayOrWeek(t.props.preSelection)&&!e},t.isDisabled=function(r){return r===void 0&&(r=t.props.day),_A(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(){return L5(t.props.day,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.isStartOfWeek=function(){return js(t.props.day,l0(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameWeek=function(r){return t.props.showWeekPicker&&js(r,l0(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameDayOrWeek=function(r){return t.isSameDay(r)||t.isSameWeek(r)},t.getHighLightedClass=function(){var r=t.props,s=r.day,e=r.highlightDates;if(!e)return!1;var u=oi(s,"MM.dd.yyyy");return e.get(u)},t.getHolidaysClass=function(){var r,s=t.props,e=s.day,u=s.holidays;if(!u)return[void 0];var f=oi(e,"MM.dd.yyyy");return u.has(f)?[(r=u.get(f))===null||r===void 0?void 0:r.className]:[void 0]},t.isInRange=function(){var r=t.props,s=r.day,e=r.startDate,u=r.endDate;return!e||!u?!1:nh(s,e,u)},t.isInSelectingRange=function(){var r,s=t.props,e=s.day,u=s.selectsStart,f=s.selectsEnd,m=s.selectsRange,g=s.selectsDisabledDaysInRange,b=s.startDate,j=s.swapRange,F=s.endDate,C=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;if(!(u||f||m)||!C||!g&&t.isDisabled())return!1;if(u&&F&&(nu(C,F)||ch(C,F)))return nh(e,C,F);if(f&&b&&(f0(C,b)||ch(C,b)))return nh(e,b,C);if(m&&b&&!F){if(ch(C,b)||f0(C,b))return nh(e,b,C);if(j&&nu(C,b))return nh(e,C,b)}return!1},t.isSelectingRangeStart=function(){var r;if(!t.isInSelectingRange())return!1;var s=t.props,e=s.day,u=s.startDate,f=s.selectsStart,m=s.swapRange,g=s.selectsRange,b=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return f?js(e,b):g&&m&&u&&b?js(e,nu(b,u)?b:u):js(e,u)},t.isSelectingRangeEnd=function(){var r;if(!t.isInSelectingRange())return!1;var s=t.props,e=s.day,u=s.endDate,f=s.selectsEnd,m=s.selectsRange,g=s.swapRange,b=s.startDate,j=(r=t.props.selectingDate)!==null&&r!==void 0?r:t.props.preSelection;return f?js(e,j):m&&g&&b&&j?js(e,nu(j,b)?b:j):m?js(e,j):js(e,u)},t.isRangeStart=function(){var r=t.props,s=r.day,e=r.startDate,u=r.endDate;return!e||!u?!1:js(e,s)},t.isRangeEnd=function(){var r=t.props,s=r.day,e=r.startDate,u=r.endDate;return!e||!u?!1:js(u,s)},t.isWeekend=function(){var r=OL(t.props.day);return r===0||r===6},t.isAfterMonth=function(){return t.props.month!==void 0&&(t.props.month+1)%12===Ql(t.props.day)},t.isBeforeMonth=function(){return t.props.month!==void 0&&(Ql(t.props.day)+1)%12===t.props.month},t.isCurrentDay=function(){return t.isSameDay(fn())},t.isSelected=function(){var r;return t.props.selectsMultiple?(r=t.props.selectedDates)===null||r===void 0?void 0:r.some(function(s){return t.isSameDayOrWeek(s)}):t.isSameDayOrWeek(t.props.selected)},t.getClassNames=function(r){var s=t.props.dayClassName?t.props.dayClassName(r):void 0;return hi("react-datepicker__day",s,"react-datepicker__day--"+kI(t.props.day),{"react-datepicker__day--disabled":t.isDisabled(),"react-datepicker__day--excluded":t.isExcluded(),"react-datepicker__day--selected":t.isSelected(),"react-datepicker__day--keyboard-selected":t.isKeyboardSelected(),"react-datepicker__day--range-start":t.isRangeStart(),"react-datepicker__day--range-end":t.isRangeEnd(),"react-datepicker__day--in-range":t.isInRange(),"react-datepicker__day--in-selecting-range":t.isInSelectingRange(),"react-datepicker__day--selecting-range-start":t.isSelectingRangeStart(),"react-datepicker__day--selecting-range-end":t.isSelectingRangeEnd(),"react-datepicker__day--today":t.isCurrentDay(),"react-datepicker__day--weekend":t.isWeekend(),"react-datepicker__day--outside-month":t.isAfterMonth()||t.isBeforeMonth()},t.getHighLightedClass(),t.getHolidaysClass())},t.getAriaLabel=function(){var r=t.props,s=r.day,e=r.ariaLabelPrefixWhenEnabled,u=e===void 0?"Choose":e,f=r.ariaLabelPrefixWhenDisabled,m=f===void 0?"Not available":f,g=t.isDisabled()||t.isExcluded()?m:u;return"".concat(g," ").concat(oi(s,"PPPP",t.props.locale))},t.getTitle=function(){var r=t.props,s=r.day,e=r.holidays,u=e===void 0?new Map:e,f=r.excludeDates,m=oi(s,"MM.dd.yyyy"),g=[];return u.has(m)&&g.push.apply(g,u.get(m).holidayNames),t.isExcluded()&&g.push(f?.filter(function(b){return b instanceof Date?js(b,s):js(b?.date,s)}).map(function(b){if(!(b instanceof Date))return b?.message})),g.join(", ")},t.getTabIndex=function(){var r=t.props.selected,s=t.props.preSelection,e=!(t.props.showWeekPicker&&(t.props.showWeekNumber||!t.isStartOfWeek()))&&(t.isKeyboardSelected()||t.isSameDay(r)&&js(s,r))?0:-1;return e},t.handleFocusDay=function(){var r;t.shouldFocusDay()&&((r=t.dayEl.current)===null||r===void 0||r.focus({preventScroll:!0}))},t.renderDayContents=function(){return t.props.monthShowsDuplicateDaysEnd&&t.isAfterMonth()||t.props.monthShowsDuplicateDaysStart&&t.isBeforeMonth()?null:t.props.renderDayContents?t.props.renderDayContents(n6(t.props.day),t.props.day):n6(t.props.day)},t.render=function(){return At.createElement("div",{ref:t.dayEl,className:t.getClassNames(t.props.day),onKeyDown:t.handleOnKeyDown,onClick:t.handleClick,onMouseEnter:t.props.usePointerEvent?void 0:t.handleMouseEnter,onPointerEnter:t.props.usePointerEvent?t.handleMouseEnter:void 0,tabIndex:t.getTabIndex(),"aria-label":t.getAriaLabel(),role:"gridcell",title:t.getTitle(),"aria-disabled":t.isDisabled(),"aria-current":t.isCurrentDay()?"date":void 0,"aria-selected":t.isSelected()||t.isInRange()},t.renderDayContents(),t.getTitle()!==""&&At.createElement("span",{className:"overlay"},t.getTitle()))},t}return a.prototype.componentDidMount=function(){this.handleFocusDay()},a.prototype.componentDidUpdate=function(){this.handleFocusDay()},a.prototype.shouldFocusDay=function(){var t=!1;return this.getTabIndex()===0&&this.isSameDay(this.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(t=!0),this.props.inline&&!this.props.shouldFocusDayInline&&(t=!1),this.isDayActiveElement()&&(t=!0),this.isDuplicateDay()&&(t=!1)),t},a.prototype.isDayActiveElement=function(){var t,r,s;return((r=(t=this.props.containerRef)===null||t===void 0?void 0:t.current)===null||r===void 0?void 0:r.contains(document.activeElement))&&((s=document.activeElement)===null||s===void 0?void 0:s.classList.contains("react-datepicker__day"))},a.prototype.isDuplicateDay=function(){return this.props.monthShowsDuplicateDaysEnd&&this.isAfterMonth()||this.props.monthShowsDuplicateDaysStart&&this.isBeforeMonth()},a})(ne.Component),$I=(function(n){bl(a,n);function a(){var t=n!==null&&n.apply(this,arguments)||this;return t.weekNumberEl=ne.createRef(),t.handleClick=function(r){t.props.onClick&&t.props.onClick(r)},t.handleOnKeyDown=function(r){var s,e,u=r.key;u===Ur.Space&&(r.preventDefault(),r.key=Ur.Enter),(e=(s=t.props).handleOnKeyDown)===null||e===void 0||e.call(s,r)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!js(t.props.date,t.props.selected)&&js(t.props.date,t.props.preSelection)},t.getTabIndex=function(){return t.props.showWeekPicker&&t.props.showWeekNumber&&(t.isKeyboardSelected()||js(t.props.date,t.props.selected)&&js(t.props.preSelection,t.props.selected))?0:-1},t.handleFocusWeekNumber=function(r){var s=!1;t.getTabIndex()===0&&!r?.isInputFocused&&js(t.props.date,t.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(s=!0),t.props.inline&&!t.props.shouldFocusDayInline&&(s=!1),t.props.containerRef&&t.props.containerRef.current&&t.props.containerRef.current.contains(document.activeElement)&&document.activeElement&&document.activeElement.classList.contains("react-datepicker__week-number")&&(s=!0)),s&&t.weekNumberEl.current&&t.weekNumberEl.current.focus({preventScroll:!0})},t}return Object.defineProperty(a,"defaultProps",{get:function(){return{ariaLabelPrefix:"week "}},enumerable:!1,configurable:!0}),a.prototype.componentDidMount=function(){this.handleFocusWeekNumber()},a.prototype.componentDidUpdate=function(t){this.handleFocusWeekNumber(t)},a.prototype.render=function(){var t=this.props,r=t.weekNumber,s=t.isWeekDisabled,e=t.ariaLabelPrefix,u=e===void 0?a.defaultProps.ariaLabelPrefix:e,f=t.onClick,m={"react-datepicker__week-number":!0,"react-datepicker__week-number--clickable":!!f&&!s,"react-datepicker__week-number--selected":!!f&&js(this.props.date,this.props.selected)};return At.createElement("div",{ref:this.weekNumberEl,className:hi(m),"aria-label":"".concat(u," ").concat(this.props.weekNumber),onClick:this.handleClick,onKeyDown:this.handleOnKeyDown,tabIndex:this.getTabIndex(),role:"gridcell"},r)},a})(ne.Component),qI=(function(n){bl(a,n);function a(){var t=n!==null&&n.apply(this,arguments)||this;return t.isDisabled=function(r){return _A(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.handleDayClick=function(r,s){t.props.onDayClick&&t.props.onDayClick(r,s)},t.handleDayMouseEnter=function(r){t.props.onDayMouseEnter&&t.props.onDayMouseEnter(r)},t.handleWeekClick=function(r,s,e){for(var u,f,m,g=new Date(r),b=0;b<7;b++){var j=new Date(r);j.setDate(j.getDate()+b);var F=!t.isDisabled(j);if(F){g=j;break}}typeof t.props.onWeekSelect=="function"&&t.props.onWeekSelect(g,s,e),t.props.showWeekPicker&&t.handleDayClick(g,e),((u=t.props.shouldCloseOnSelect)!==null&&u!==void 0?u:a.defaultProps.shouldCloseOnSelect)&&((m=(f=t.props).setOpen)===null||m===void 0||m.call(f,!1))},t.formatWeekNumber=function(r){return t.props.formatWeekNumber?t.props.formatWeekNumber(r):EI(r)},t.isWeekDisabled=function(){for(var r=t.startOfWeek(),s=yd(r,6),e=new Date(r);e<=s;){if(!t.isDisabled(e))return!1;e=yd(e,1)}return!0},t.renderDays=function(){var r=t.startOfWeek(),s=[],e=t.formatWeekNumber(r);if(t.props.showWeekNumber){var u=t.props.onWeekSelect||t.props.showWeekPicker?t.handleWeekClick.bind(t,r,e):void 0;s.push(At.createElement($I,Bs({key:"W"},a.defaultProps,t.props,{weekNumber:e,isWeekDisabled:t.isWeekDisabled(),date:r,onClick:u})))}return s.concat([0,1,2,3,4,5,6].map(function(f){var m=yd(r,f);return At.createElement(WI,Bs({},a.defaultProps,t.props,{ariaLabelPrefixWhenEnabled:t.props.chooseDayAriaLabelPrefix,ariaLabelPrefixWhenDisabled:t.props.disabledDayAriaLabelPrefix,key:m.valueOf(),day:m,onClick:t.handleDayClick.bind(t,m),onMouseEnter:t.handleDayMouseEnter.bind(t,m)}))}))},t.startOfWeek=function(){return l0(t.props.day,t.props.locale,t.props.calendarStartDay)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!js(t.startOfWeek(),t.props.selected)&&js(t.startOfWeek(),t.props.preSelection)},t}return Object.defineProperty(a,"defaultProps",{get:function(){return{shouldCloseOnSelect:!0}},enumerable:!1,configurable:!0}),a.prototype.render=function(){var t={"react-datepicker__week":!0,"react-datepicker__week--selected":js(this.startOfWeek(),this.props.selected),"react-datepicker__week--keyboard-selected":this.isKeyboardSelected()},r=this.props.weekClassName?this.props.weekClassName(this.startOfWeek()):void 0;return At.createElement("div",{className:hi(t,r),role:"row"},this.renderDays())},a})(ne.Component),w1,XI=6,qm={TWO_COLUMNS:"two_columns",THREE_COLUMNS:"three_columns",FOUR_COLUMNS:"four_columns"},dv=(w1={},w1[qm.TWO_COLUMNS]={grid:[[0,1],[2,3],[4,5],[6,7],[8,9],[10,11]],verticalNavigationOffset:2},w1[qm.THREE_COLUMNS]={grid:[[0,1,2],[3,4,5],[6,7,8],[9,10,11]],verticalNavigationOffset:3},w1[qm.FOUR_COLUMNS]={grid:[[0,1,2,3],[4,5,6,7],[8,9,10,11]],verticalNavigationOffset:4},w1),Hx=1;function T6(n,a){return n?qm.FOUR_COLUMNS:a?qm.TWO_COLUMNS:qm.THREE_COLUMNS}var JI=(function(n){bl(a,n);function a(){var t=n!==null&&n.apply(this,arguments)||this;return t.MONTH_REFS=iu([],Array(12),!0).map(function(){return ne.createRef()}),t.QUARTER_REFS=iu([],Array(4),!0).map(function(){return ne.createRef()}),t.isDisabled=function(r){return _A(r,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(r){return L5(r,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.handleDayClick=function(r,s){var e,u;(u=(e=t.props).onDayClick)===null||u===void 0||u.call(e,r,s,t.props.orderInDisplay)},t.handleDayMouseEnter=function(r){var s,e;(e=(s=t.props).onDayMouseEnter)===null||e===void 0||e.call(s,r)},t.handleMouseLeave=function(){var r,s;(s=(r=t.props).onMouseLeave)===null||s===void 0||s.call(r)},t.isRangeStartMonth=function(r){var s=t.props,e=s.day,u=s.startDate,f=s.endDate;return!u||!f?!1:ac(TA(e,r),u)},t.isRangeStartQuarter=function(r){var s=t.props,e=s.day,u=s.startDate,f=s.endDate;return!u||!f?!1:ub(Om(e,r),u)},t.isRangeEndMonth=function(r){var s=t.props,e=s.day,u=s.startDate,f=s.endDate;return!u||!f?!1:ac(TA(e,r),f)},t.isRangeEndQuarter=function(r){var s=t.props,e=s.day,u=s.startDate,f=s.endDate;return!u||!f?!1:ub(Om(e,r),f)},t.isInSelectingRangeMonth=function(r){var s,e=t.props,u=e.day,f=e.selectsStart,m=e.selectsEnd,g=e.selectsRange,b=e.startDate,j=e.endDate,F=(s=t.props.selectingDate)!==null&&s!==void 0?s:t.props.preSelection;return!(f||m||g)||!F?!1:f&&j?Ox(F,j,r,u):m&&b||g&&b&&!j?Ox(b,F,r,u):!1},t.isSelectingMonthRangeStart=function(r){var s;if(!t.isInSelectingRangeMonth(r))return!1;var e=t.props,u=e.day,f=e.startDate,m=e.selectsStart,g=TA(u,r),b=(s=t.props.selectingDate)!==null&&s!==void 0?s:t.props.preSelection;return m?ac(g,b):ac(g,f)},t.isSelectingMonthRangeEnd=function(r){var s;if(!t.isInSelectingRangeMonth(r))return!1;var e=t.props,u=e.day,f=e.endDate,m=e.selectsEnd,g=e.selectsRange,b=TA(u,r),j=(s=t.props.selectingDate)!==null&&s!==void 0?s:t.props.preSelection;return m||g?ac(b,j):ac(b,f)},t.isInSelectingRangeQuarter=function(r){var s,e=t.props,u=e.day,f=e.selectsStart,m=e.selectsEnd,g=e.selectsRange,b=e.startDate,j=e.endDate,F=(s=t.props.selectingDate)!==null&&s!==void 0?s:t.props.preSelection;return!(f||m||g)||!F?!1:f&&j?Px(F,j,r,u):m&&b||g&&b&&!j?Px(b,F,r,u):!1},t.isWeekInMonth=function(r){var s=t.props.day,e=yd(r,6);return ac(r,s)||ac(e,s)},t.isCurrentMonth=function(r,s){return os(r)===os(fn())&&s===Ql(fn())},t.isCurrentQuarter=function(r,s){return os(r)===os(fn())&&s===hh(fn())},t.isSelectedMonth=function(r,s,e){return Ql(e)===s&&os(r)===os(e)},t.isSelectMonthInList=function(r,s,e){return e.some(function(u){return t.isSelectedMonth(r,s,u)})},t.isSelectedQuarter=function(r,s,e){return hh(r)===s&&os(r)===os(e)},t.isMonthSelected=function(){var r=t.props,s=r.day,e=r.selected,u=r.selectedDates,f=r.selectsMultiple,m=Ql(s);return f?u?.some(function(g){return t.isSelectedMonth(s,m,g)}):!!e&&t.isSelectedMonth(s,m,e)},t.renderWeeks=function(){for(var r=[],s=t.props.fixedHeight,e=0,u=!1,f=l0(tf(t.props.day),t.props.locale,t.props.calendarStartDay),m=function(M){return t.props.showWeekPicker?l0(M,t.props.locale,t.props.calendarStartDay):t.props.preSelection},g=function(M){return t.props.showWeekPicker?l0(M,t.props.locale,t.props.calendarStartDay):t.props.selected},b=t.props.selected?g(t.props.selected):void 0,j=t.props.preSelection?m(t.props.preSelection):void 0;r.push(At.createElement(qI,Bs({},t.props,{ariaLabelPrefix:t.props.weekAriaLabelPrefix,key:e,day:f,month:Ql(t.props.day),onDayClick:t.handleDayClick,onDayMouseEnter:t.handleDayMouseEnter,selected:b,preSelection:j,showWeekNumber:t.props.showWeekNumbers}))),!u;){e++,f=tb(f,1);var F=s&&e>=XI,C=!s&&!t.isWeekInMonth(f);if(F||C)if(t.props.peekNextMonth)u=!0;else break}return r},t.onMonthClick=function(r,s){var e=t.isMonthDisabledForLabelDate(s),u=e.isDisabled,f=e.labelDate;u||t.handleDayClick(tf(f),r)},t.onMonthMouseEnter=function(r){var s=t.isMonthDisabledForLabelDate(r),e=s.isDisabled,u=s.labelDate;e||t.handleDayMouseEnter(tf(u))},t.handleMonthNavigation=function(r,s){var e,u,f,m;(u=(e=t.props).setPreSelection)===null||u===void 0||u.call(e,s),(m=(f=t.MONTH_REFS[r])===null||f===void 0?void 0:f.current)===null||m===void 0||m.focus()},t.handleKeyboardNavigation=function(r,s,e){var u,f=t.props,m=f.selected,g=f.preSelection,b=f.setPreSelection,j=f.minDate,F=f.maxDate,C=f.showFourColumnMonthYearPicker,M=f.showTwoColumnMonthYearPicker;if(g){var _=T6(C,M),L=t.getVerticalOffset(_),T=(u=dv[_])===null||u===void 0?void 0:u.grid,H=function(se,ue,ae){var pe,z,J=ue,ge=ae;switch(se){case Ur.ArrowRight:J=Nd(ue,Hx),ge=ae===11?0:ae+Hx;break;case Ur.ArrowLeft:J=mh(ue,Hx),ge=ae===0?11:ae-Hx;break;case Ur.ArrowUp:J=mh(ue,L),ge=!((pe=T?.[0])===null||pe===void 0)&&pe.includes(ae)?ae+12-L:ae-L;break;case Ur.ArrowDown:J=Nd(ue,L),ge=!((z=T?.[T.length-1])===null||z===void 0)&&z.includes(ae)?ae-12+L:ae+L;break}return{newCalculatedDate:J,newCalculatedMonth:ge}},O=function(se,ue,ae){for(var pe=40,z=se,J=!1,ge=0,fe=H(z,ue,ae),ke=fe.newCalculatedDate,he=fe.newCalculatedMonth;!J;){if(ge>=pe){ke=ue,he=ae;break}if(j&&ke<j){z=Ur.ArrowRight;var Ne=H(z,ke,he);ke=Ne.newCalculatedDate,he=Ne.newCalculatedMonth}if(F&&ke>F){z=Ur.ArrowLeft;var Ne=H(z,ke,he);ke=Ne.newCalculatedDate,he=Ne.newCalculatedMonth}if(II(ke,t.props)){var Ne=H(z,ke,he);ke=Ne.newCalculatedDate,he=Ne.newCalculatedMonth}else J=!0;ge++}return{newCalculatedDate:ke,newCalculatedMonth:he}};if(s===Ur.Enter){t.isMonthDisabled(e)||(t.onMonthClick(r,e),b?.(m));return}var Q=O(s,g,e),Z=Q.newCalculatedDate,ee=Q.newCalculatedMonth;switch(s){case Ur.ArrowRight:case Ur.ArrowLeft:case Ur.ArrowUp:case Ur.ArrowDown:t.handleMonthNavigation(ee,Z);break}}},t.getVerticalOffset=function(r){var s,e;return(e=(s=dv[r])===null||s===void 0?void 0:s.verticalNavigationOffset)!==null&&e!==void 0?e:0},t.onMonthKeyDown=function(r,s){var e=t.props,u=e.disabledKeyboardNavigation,f=e.handleOnMonthKeyDown,m=r.key;m!==Ur.Tab&&r.preventDefault(),u||t.handleKeyboardNavigation(r,m,s),f&&f(r)},t.onQuarterClick=function(r,s){var e=Om(t.props.day,s);Qx(e,t.props)||t.handleDayClick(x6(e),r)},t.onQuarterMouseEnter=function(r){var s=Om(t.props.day,r);Qx(s,t.props)||t.handleDayMouseEnter(x6(s))},t.handleQuarterNavigation=function(r,s){var e,u,f,m;t.isDisabled(s)||t.isExcluded(s)||((u=(e=t.props).setPreSelection)===null||u===void 0||u.call(e,s),(m=(f=t.QUARTER_REFS[r-1])===null||f===void 0?void 0:f.current)===null||m===void 0||m.focus())},t.onQuarterKeyDown=function(r,s){var e,u,f=r.key;if(!t.props.disabledKeyboardNavigation)switch(f){case Ur.Enter:t.onQuarterClick(r,s),(u=(e=t.props).setPreSelection)===null||u===void 0||u.call(e,t.props.selected);break;case Ur.ArrowRight:if(!t.props.preSelection)break;t.handleQuarterNavigation(s===4?1:s+1,w5(t.props.preSelection,1));break;case Ur.ArrowLeft:if(!t.props.preSelection)break;t.handleQuarterNavigation(s===1?4:s-1,g8(t.props.preSelection));break}},t.isMonthDisabledForLabelDate=function(r){var s,e=t.props,u=e.day,f=e.minDate,m=e.maxDate,g=e.excludeDates,b=e.includeDates,j=TA(u,r);return{isDisabled:(s=(f||m||g||b)&&_8(j,t.props))!==null&&s!==void 0?s:!1,labelDate:j}},t.isMonthDisabled=function(r){var s=t.isMonthDisabledForLabelDate(r).isDisabled;return s},t.getMonthClassNames=function(r){var s=t.props,e=s.day,u=s.startDate,f=s.endDate,m=s.preSelection,g=s.monthClassName,b=g?g(TA(e,r)):void 0,j=t.getSelection();return hi("react-datepicker__month-text","react-datepicker__month-".concat(r),b,{"react-datepicker__month-text--disabled":t.isMonthDisabled(r),"react-datepicker__month-text--selected":j?t.isSelectMonthInList(e,r,j):void 0,"react-datepicker__month-text--keyboard-selected":!t.props.disabledKeyboardNavigation&&m&&t.isSelectedMonth(e,r,m)&&!t.isMonthSelected()&&!t.isMonthDisabled(r),"react-datepicker__month-text--in-selecting-range":t.isInSelectingRangeMonth(r),"react-datepicker__month-text--in-range":u&&f?Ox(u,f,r,e):void 0,"react-datepicker__month-text--range-start":t.isRangeStartMonth(r),"react-datepicker__month-text--range-end":t.isRangeEndMonth(r),"react-datepicker__month-text--selecting-range-start":t.isSelectingMonthRangeStart(r),"react-datepicker__month-text--selecting-range-end":t.isSelectingMonthRangeEnd(r),"react-datepicker__month-text--today":t.isCurrentMonth(e,r)})},t.getTabIndex=function(r){if(t.props.preSelection==null)return"-1";var s=Ql(t.props.preSelection),e=t.isMonthDisabledForLabelDate(s).isDisabled,u=r===s&&!(e||t.props.disabledKeyboardNavigation)?"0":"-1";return u},t.getQuarterTabIndex=function(r){if(t.props.preSelection==null)return"-1";var s=hh(t.props.preSelection),e=Qx(t.props.day,t.props),u=r===s&&!(e||t.props.disabledKeyboardNavigation)?"0":"-1";return u},t.getAriaLabel=function(r){var s=t.props,e=s.chooseDayAriaLabelPrefix,u=e===void 0?"Choose":e,f=s.disabledDayAriaLabelPrefix,m=f===void 0?"Not available":f,g=s.day,b=s.locale,j=TA(g,r),F=t.isDisabled(j)||t.isExcluded(j)?m:u;return"".concat(F," ").concat(oi(j,"MMMM yyyy",b))},t.getQuarterClassNames=function(r){var s=t.props,e=s.day,u=s.startDate,f=s.endDate,m=s.selected,g=s.minDate,b=s.maxDate,j=s.excludeDates,F=s.includeDates,C=s.filterDate,M=s.preSelection,_=s.disabledKeyboardNavigation,L=(g||b||j||F||C)&&Qx(Om(e,r),t.props);return hi("react-datepicker__quarter-text","react-datepicker__quarter-".concat(r),{"react-datepicker__quarter-text--disabled":L,"react-datepicker__quarter-text--selected":m?t.isSelectedQuarter(e,r,m):void 0,"react-datepicker__quarter-text--keyboard-selected":!_&&M&&t.isSelectedQuarter(e,r,M)&&!L,"react-datepicker__quarter-text--in-selecting-range":t.isInSelectingRangeQuarter(r),"react-datepicker__quarter-text--in-range":u&&f?Px(u,f,r,e):void 0,"react-datepicker__quarter-text--range-start":t.isRangeStartQuarter(r),"react-datepicker__quarter-text--range-end":t.isRangeEndQuarter(r),"react-datepicker__quarter-text--today":t.isCurrentQuarter(e,r)})},t.getMonthContent=function(r){var s=t.props,e=s.showFullMonthYearPicker,u=s.renderMonthContent,f=s.locale,m=s.day,g=T8(r,f),b=_5(r,f);return u?u(r,g,b,m):e?b:g},t.getQuarterContent=function(r){var s,e=t.props,u=e.renderQuarterContent,f=e.locale,m=MI(r,f);return(s=u?.(r,m))!==null&&s!==void 0?s:m},t.renderMonths=function(){var r,s=t.props,e=s.showTwoColumnMonthYearPicker,u=s.showFourColumnMonthYearPicker,f=s.day,m=s.selected,g=(r=dv[T6(u,e)])===null||r===void 0?void 0:r.grid;return g?.map(function(b,j){return At.createElement("div",{className:"react-datepicker__month-wrapper",key:j},b.map(function(F,C){return At.createElement("div",{ref:t.MONTH_REFS[F],key:C,onClick:function(M){t.onMonthClick(M,F)},onKeyDown:function(M){M8(M)&&(M.preventDefault(),M.key=Ur.Enter),t.onMonthKeyDown(M,F)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onMonthMouseEnter(F)},onPointerEnter:t.props.usePointerEvent?function(){return t.onMonthMouseEnter(F)}:void 0,tabIndex:Number(t.getTabIndex(F)),className:t.getMonthClassNames(F),"aria-disabled":t.isMonthDisabled(F),role:"option","aria-label":t.getAriaLabel(F),"aria-current":t.isCurrentMonth(f,F)?"date":void 0,"aria-selected":m?t.isSelectedMonth(f,F,m):void 0},t.getMonthContent(F))}))})},t.renderQuarters=function(){var r=t.props,s=r.day,e=r.selected,u=[1,2,3,4];return At.createElement("div",{className:"react-datepicker__quarter-wrapper"},u.map(function(f,m){return At.createElement("div",{key:m,ref:t.QUARTER_REFS[m],role:"option",onClick:function(g){t.onQuarterClick(g,f)},onKeyDown:function(g){t.onQuarterKeyDown(g,f)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onQuarterMouseEnter(f)},onPointerEnter:t.props.usePointerEvent?function(){return t.onQuarterMouseEnter(f)}:void 0,className:t.getQuarterClassNames(f),"aria-selected":e?t.isSelectedQuarter(s,f,e):void 0,tabIndex:Number(t.getQuarterTabIndex(f)),"aria-current":t.isCurrentQuarter(s,f)?"date":void 0},t.getQuarterContent(f))}))},t.getClassNames=function(){var r=t.props,s=r.selectingDate,e=r.selectsStart,u=r.selectsEnd,f=r.showMonthYearPicker,m=r.showQuarterYearPicker,g=r.showWeekPicker;return hi("react-datepicker__month",{"react-datepicker__month--selecting-range":s&&(e||u)},{"react-datepicker__monthPicker":f},{"react-datepicker__quarterPicker":m},{"react-datepicker__weekPicker":g})},t}return a.prototype.getSelection=function(){var t=this.props,r=t.selected,s=t.selectedDates,e=t.selectsMultiple;if(e)return s;if(r)return[r]},a.prototype.render=function(){var t=this.props,r=t.showMonthYearPicker,s=t.showQuarterYearPicker,e=t.day,u=t.ariaLabelPrefix,f=u===void 0?"Month ":u,m=f?f.trim()+" ":"",g=r||s;return g?At.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":"".concat(m).concat(oi(e,"MMMM, yyyy",this.props.locale)),role:"listbox"},r?this.renderMonths():this.renderQuarters()):At.createElement("div",{role:"table"},this.props.dayNamesHeader&&At.createElement("div",{role:"rowgroup"},this.props.dayNamesHeader),At.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":"".concat(m).concat(oi(e,"MMMM, yyyy",this.props.locale)),role:"rowgroup"},this.renderWeeks()))},a})(ne.Component),ZI=(function(n){bl(a,n);function a(){var t=n!==null&&n.apply(this,arguments)||this;return t.monthOptionButtonsRef={},t.isSelectedMonth=function(r){return t.props.month===r},t.handleOptionKeyDown=function(r,s){var e;switch(s.key){case"Enter":s.preventDefault(),t.onChange(r);break;case"Escape":s.preventDefault(),t.props.onCancel();break;case"ArrowUp":case"ArrowDown":{s.preventDefault();var u=(r+(s.key==="ArrowUp"?-1:1)+t.props.monthNames.length)%t.props.monthNames.length;(e=t.monthOptionButtonsRef[u])===null||e===void 0||e.focus();break}}},t.renderOptions=function(){return t.monthOptionButtonsRef={},t.props.monthNames.map(function(r,s){return At.createElement("div",{ref:function(e){t.monthOptionButtonsRef[s]=e,t.isSelectedMonth(s)&&e?.focus()},role:"button",tabIndex:0,className:t.isSelectedMonth(s)?"react-datepicker__month-option react-datepicker__month-option--selected_month":"react-datepicker__month-option",key:r,onClick:t.onChange.bind(t,s),onKeyDown:t.handleOptionKeyDown.bind(t,s),"aria-selected":t.isSelectedMonth(s)?"true":void 0},t.isSelectedMonth(s)?At.createElement("span",{className:"react-datepicker__month-option--selected"},""):"",r)})},t.onChange=function(r){return t.props.onChange(r)},t.handleClickOutside=function(){return t.props.onCancel()},t}return a.prototype.render=function(){return At.createElement(Vb,{className:"react-datepicker__month-dropdown",onClickOutside:this.handleClickOutside},this.renderOptions())},a})(ne.Component),eO=(function(n){bl(a,n);function a(){var t=n!==null&&n.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(r){return r.map(function(s,e){return At.createElement("option",{key:s,value:e},s)})},t.renderSelectMode=function(r){return At.createElement("select",{value:t.props.month,className:"react-datepicker__month-select",onChange:function(s){return t.onChange(parseInt(s.target.value))}},t.renderSelectOptions(r))},t.renderReadView=function(r,s){return At.createElement("button",{key:"read",type:"button",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__month-read-view",onClick:t.toggleDropdown},At.createElement("span",{className:"react-datepicker__month-read-view--down-arrow"}),At.createElement("span",{className:"react-datepicker__month-read-view--selected-month"},s[t.props.month]))},t.renderDropdown=function(r){return At.createElement(ZI,Bs({key:"dropdown"},t.props,{monthNames:r,onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(r){var s=t.state.dropdownVisible,e=[t.renderReadView(!s,r)];return s&&e.unshift(t.renderDropdown(r)),e},t.onChange=function(r){t.toggleDropdown(),r!==t.props.month&&t.props.onChange(r)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return a.prototype.render=function(){var t=this,r=[0,1,2,3,4,5,6,7,8,9,10,11].map(this.props.useShortMonthInDropdown?function(e){return T8(e,t.props.locale)}:function(e){return _5(e,t.props.locale)}),s;switch(this.props.dropdownMode){case"scroll":s=this.renderScrollMode(r);break;case"select":s=this.renderSelectMode(r);break}return At.createElement("div",{className:"react-datepicker__month-dropdown-container react-datepicker__month-dropdown-container--".concat(this.props.dropdownMode)},s)},a})(ne.Component);function tO(n,a){for(var t=[],r=tf(n),s=tf(a);!f0(r,s);)t.push(fn(r)),r=Nd(r,1);return t}var rO=(function(n){bl(a,n);function a(t){var r=n.call(this,t)||this;return r.renderOptions=function(){return r.state.monthYearsList.map(function(s){var e=yw(s),u=tu(r.props.date,s)&&ac(r.props.date,s);return At.createElement("div",{className:u?"react-datepicker__month-year-option--selected_month-year":"react-datepicker__month-year-option",key:e,onClick:r.onChange.bind(r,e),"aria-selected":u?"true":void 0},u?At.createElement("span",{className:"react-datepicker__month-year-option--selected"},""):"",oi(s,r.props.dateFormat,r.props.locale))})},r.onChange=function(s){return r.props.onChange(s)},r.handleClickOutside=function(){r.props.onCancel()},r.state={monthYearsList:tO(r.props.minDate,r.props.maxDate)},r}return a.prototype.render=function(){var t=hi({"react-datepicker__month-year-dropdown":!0,"react-datepicker__month-year-dropdown--scrollable":this.props.scrollableMonthYearDropdown});return At.createElement(Vb,{className:t,onClickOutside:this.handleClickOutside},this.renderOptions())},a})(ne.Component),aO=(function(n){bl(a,n);function a(){var t=n!==null&&n.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var r=tf(t.props.minDate),s=tf(t.props.maxDate),e=[];!f0(r,s);){var u=yw(r);e.push(At.createElement("option",{key:u,value:u},oi(r,t.props.dateFormat,t.props.locale))),r=Nd(r,1)}return e},t.onSelectChange=function(r){t.onChange(parseInt(r.target.value))},t.renderSelectMode=function(){return At.createElement("select",{value:yw(tf(t.props.date)),className:"react-datepicker__month-year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(r){var s=oi(t.props.date,t.props.dateFormat,t.props.locale);return At.createElement("div",{key:"read",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__month-year-read-view",onClick:t.toggleDropdown},At.createElement("span",{className:"react-datepicker__month-year-read-view--down-arrow"}),At.createElement("span",{className:"react-datepicker__month-year-read-view--selected-month-year"},s))},t.renderDropdown=function(){return At.createElement(rO,Bs({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var r=t.state.dropdownVisible,s=[t.renderReadView(!r)];return r&&s.unshift(t.renderDropdown()),s},t.onChange=function(r){t.toggleDropdown();var s=fn(r);tu(t.props.date,s)&&ac(t.props.date,s)||t.props.onChange(s)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return a.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode();break}return At.createElement("div",{className:"react-datepicker__month-year-dropdown-container react-datepicker__month-year-dropdown-container--".concat(this.props.dropdownMode)},t)},a})(ne.Component),sO=(function(n){bl(a,n);function a(){var t=n!==null&&n.apply(this,arguments)||this;return t.state={height:null},t.scrollToTheSelectedTime=function(){requestAnimationFrame(function(){var r,s,e;t.list&&(t.list.scrollTop=(e=t.centerLi&&a.calcCenterPosition(t.props.monthRef?t.props.monthRef.clientHeight-((s=(r=t.header)===null||r===void 0?void 0:r.clientHeight)!==null&&s!==void 0?s:0):t.list.clientHeight,t.centerLi))!==null&&e!==void 0?e:0)})},t.handleClick=function(r){var s,e;(t.props.minTime||t.props.maxTime)&&N6(r,t.props)||(t.props.excludeTimes||t.props.includeTimes||t.props.filterTime)&&w6(r,t.props)||(e=(s=t.props).onChange)===null||e===void 0||e.call(s,r)},t.isSelectedTime=function(r){return t.props.selected&&VI(t.props.selected,r)},t.isDisabledTime=function(r){return(t.props.minTime||t.props.maxTime)&&N6(r,t.props)||(t.props.excludeTimes||t.props.includeTimes||t.props.filterTime)&&w6(r,t.props)},t.liClasses=function(r){var s,e=["react-datepicker__time-list-item",t.props.timeClassName?t.props.timeClassName(r):void 0];return t.isSelectedTime(r)&&e.push("react-datepicker__time-list-item--selected"),t.isDisabledTime(r)&&e.push("react-datepicker__time-list-item--disabled"),t.props.injectTimes&&(Zu(r)*3600+ef(r)*60+o0(r))%(((s=t.props.intervals)!==null&&s!==void 0?s:a.defaultProps.intervals)*60)!==0&&e.push("react-datepicker__time-list-item--injected"),e.join(" ")},t.handleOnKeyDown=function(r,s){var e,u;r.key===Ur.Space&&(r.preventDefault(),r.key=Ur.Enter),(r.key===Ur.ArrowUp||r.key===Ur.ArrowLeft)&&r.target instanceof HTMLElement&&r.target.previousSibling&&(r.preventDefault(),r.target.previousSibling instanceof HTMLElement&&r.target.previousSibling.focus()),(r.key===Ur.ArrowDown||r.key===Ur.ArrowRight)&&r.target instanceof HTMLElement&&r.target.nextSibling&&(r.preventDefault(),r.target.nextSibling instanceof HTMLElement&&r.target.nextSibling.focus()),r.key===Ur.Enter&&t.handleClick(s),(u=(e=t.props).handleOnKeyDown)===null||u===void 0||u.call(e,r)},t.renderTimes=function(){for(var r,s=[],e=typeof t.props.format=="string"?t.props.format:"p",u=(r=t.props.intervals)!==null&&r!==void 0?r:a.defaultProps.intervals,f=t.props.selected||t.props.openToDate||fn(),m=_2(f),g=t.props.injectTimes&&t.props.injectTimes.sort(function(L,T){return L.getTime()-T.getTime()}),b=60*GI(f),j=b/u,F=0;F<j;F++){var C=gw(m,F*u);if(s.push(C),g){var M=KI(m,C,F,u,g);s=s.concat(M)}}var _=s.reduce(function(L,T){return T.getTime()<=f.getTime()?T:L},s[0]);return s.map(function(L){return At.createElement("li",{key:L.valueOf(),onClick:t.handleClick.bind(t,L),className:t.liClasses(L),ref:function(T){L===_&&(t.centerLi=T)},onKeyDown:function(T){t.handleOnKeyDown(T,L)},tabIndex:L===_?0:-1,role:"option","aria-selected":t.isSelectedTime(L)?"true":void 0,"aria-disabled":t.isDisabledTime(L)?"true":void 0},oi(L,e,t.props.locale))})},t.renderTimeCaption=function(){return t.props.showTimeCaption===!1?At.createElement(At.Fragment,null):At.createElement("div",{className:"react-datepicker__header react-datepicker__header--time ".concat(t.props.showTimeSelectOnly?"react-datepicker__header--time--only":""),ref:function(r){t.header=r}},At.createElement("div",{className:"react-datepicker-time__header"},t.props.timeCaption))},t}return Object.defineProperty(a,"defaultProps",{get:function(){return{intervals:30,todayButton:null,timeCaption:"Time",showTimeCaption:!0}},enumerable:!1,configurable:!0}),a.prototype.componentDidMount=function(){this.scrollToTheSelectedTime(),this.observeDatePickerHeightChanges()},a.prototype.componentWillUnmount=function(){var t;(t=this.resizeObserver)===null||t===void 0||t.disconnect()},a.prototype.observeDatePickerHeightChanges=function(){var t=this,r=this.props.monthRef;this.updateContainerHeight(),r&&(this.resizeObserver=new ResizeObserver(function(){t.updateContainerHeight()}),this.resizeObserver.observe(r))},a.prototype.updateContainerHeight=function(){this.props.monthRef&&this.header&&this.setState({height:this.props.monthRef.clientHeight-this.header.clientHeight})},a.prototype.render=function(){var t=this,r,s=this.state.height;return At.createElement("div",{className:"react-datepicker__time-container ".concat(((r=this.props.todayButton)!==null&&r!==void 0?r:a.defaultProps.todayButton)?"react-datepicker__time-container--with-today-button":"")},this.renderTimeCaption(),At.createElement("div",{className:"react-datepicker__time"},At.createElement("div",{className:"react-datepicker__time-box"},At.createElement("ul",{className:"react-datepicker__time-list",ref:function(e){t.list=e},style:s?{height:s}:{},role:"listbox","aria-label":this.props.timeCaption},this.renderTimes()))))},a.calcCenterPosition=function(t,r){return r.offsetTop-(t/2-r.clientHeight/2)},a})(ne.Component),_6=3,nO=(function(n){bl(a,n);function a(t){var r=n.call(this,t)||this;return r.YEAR_REFS=iu([],Array(r.props.yearItemNumber),!0).map(function(){return ne.createRef()}),r.isDisabled=function(s){return _A(s,{minDate:r.props.minDate,maxDate:r.props.maxDate,excludeDates:r.props.excludeDates,includeDates:r.props.includeDates,filterDate:r.props.filterDate})},r.isExcluded=function(s){return L5(s,{excludeDates:r.props.excludeDates})},r.selectingDate=function(){var s;return(s=r.props.selectingDate)!==null&&s!==void 0?s:r.props.preSelection},r.updateFocusOnPaginate=function(s){var e=function(){var u,f;(f=(u=r.YEAR_REFS[s])===null||u===void 0?void 0:u.current)===null||f===void 0||f.focus()};window.requestAnimationFrame(e)},r.handleYearClick=function(s,e){r.props.onDayClick&&r.props.onDayClick(s,e)},r.handleYearNavigation=function(s,e){var u,f,m,g,b=r.props,j=b.date,F=b.yearItemNumber;if(!(j===void 0||F===void 0)){var C=Yu(j,F).startPeriod;r.isDisabled(e)||r.isExcluded(e)||((f=(u=r.props).setPreSelection)===null||f===void 0||f.call(u,e),s-C<0?r.updateFocusOnPaginate(F-(C-s)):s-C>=F?r.updateFocusOnPaginate(Math.abs(F-(s-C))):(g=(m=r.YEAR_REFS[s-C])===null||m===void 0?void 0:m.current)===null||g===void 0||g.focus())}},r.isSameDay=function(s,e){return js(s,e)},r.isCurrentYear=function(s){return s===os(fn())},r.isRangeStart=function(s){return r.props.startDate&&r.props.endDate&&tu(Zd(fn(),s),r.props.startDate)},r.isRangeEnd=function(s){return r.props.startDate&&r.props.endDate&&tu(Zd(fn(),s),r.props.endDate)},r.isInRange=function(s){return Rx(s,r.props.startDate,r.props.endDate)},r.isInSelectingRange=function(s){var e=r.props,u=e.selectsStart,f=e.selectsEnd,m=e.selectsRange,g=e.startDate,b=e.endDate;return!(u||f||m)||!r.selectingDate()?!1:u&&b?Rx(s,r.selectingDate(),b):f&&g||m&&g&&!b?Rx(s,g,r.selectingDate()):!1},r.isSelectingRangeStart=function(s){var e;if(!r.isInSelectingRange(s))return!1;var u=r.props,f=u.startDate,m=u.selectsStart,g=Zd(fn(),s);return m?tu(g,(e=r.selectingDate())!==null&&e!==void 0?e:null):tu(g,f??null)},r.isSelectingRangeEnd=function(s){var e;if(!r.isInSelectingRange(s))return!1;var u=r.props,f=u.endDate,m=u.selectsEnd,g=u.selectsRange,b=Zd(fn(),s);return m||g?tu(b,(e=r.selectingDate())!==null&&e!==void 0?e:null):tu(b,f??null)},r.isKeyboardSelected=function(s){if(!(r.props.disabledKeyboardNavigation||r.props.date===void 0||r.props.preSelection==null)){var e=r.props,u=e.minDate,f=e.maxDate,m=e.excludeDates,g=e.includeDates,b=e.filterDate,j=e.selected,F=E1(Zd(r.props.date,s)),C=(u||f||m||g||b)&&L2(s,r.props),M=!!j&&js(F,E1(j)),_=js(F,E1(r.props.preSelection));return!r.props.inline&&!M&&_&&!C}},r.isSelectedYear=function(s){var e=r.props,u=e.selectsMultiple,f=e.selected,m=e.selectedDates;return u?m?.some(function(g){return s===os(g)}):!!f&&s===os(f)},r.onYearClick=function(s,e){var u=r.props.date;u!==void 0&&r.handleYearClick(E1(Zd(u,e)),s)},r.onYearKeyDown=function(s,e){var u,f,m=s.key,g=r.props,b=g.date,j=g.yearItemNumber,F=g.handleOnKeyDown;if(m!==Ur.Tab&&s.preventDefault(),!r.props.disabledKeyboardNavigation)switch(m){case Ur.Enter:if(r.props.selected==null)break;r.onYearClick(s,e),(f=(u=r.props).setPreSelection)===null||f===void 0||f.call(u,r.props.selected);break;case Ur.ArrowRight:if(r.props.preSelection==null)break;r.handleYearNavigation(e+1,Xu(r.props.preSelection,1));break;case Ur.ArrowLeft:if(r.props.preSelection==null)break;r.handleYearNavigation(e-1,sp(r.props.preSelection,1));break;case Ur.ArrowUp:{if(b===void 0||j===void 0||r.props.preSelection==null)break;var C=Yu(b,j).startPeriod,M=_6,_=e-M;if(_<C){var L=j%M;e>=C&&e<C+L?M=L:M+=L,_=e-M}r.handleYearNavigation(_,sp(r.props.preSelection,M));break}case Ur.ArrowDown:{if(b===void 0||j===void 0||r.props.preSelection==null)break;var T=Yu(b,j).endPeriod,M=_6,_=e+M;if(_>T){var L=j%M;e<=T&&e>T-L?M=L:M+=L,_=e+M}r.handleYearNavigation(_,Xu(r.props.preSelection,M));break}}F&&F(s)},r.getYearClassNames=function(s){var e=r.props,u=e.date,f=e.minDate,m=e.maxDate,g=e.excludeDates,b=e.includeDates,j=e.filterDate,F=e.yearClassName;return hi("react-datepicker__year-text","react-datepicker__year-".concat(s),u?F?.(Zd(u,s)):void 0,{"react-datepicker__year-text--selected":r.isSelectedYear(s),"react-datepicker__year-text--disabled":(f||m||g||b||j)&&L2(s,r.props),"react-datepicker__year-text--keyboard-selected":r.isKeyboardSelected(s),"react-datepicker__year-text--range-start":r.isRangeStart(s),"react-datepicker__year-text--range-end":r.isRangeEnd(s),"react-datepicker__year-text--in-range":r.isInRange(s),"react-datepicker__year-text--in-selecting-range":r.isInSelectingRange(s),"react-datepicker__year-text--selecting-range-start":r.isSelectingRangeStart(s),"react-datepicker__year-text--selecting-range-end":r.isSelectingRangeEnd(s),"react-datepicker__year-text--today":r.isCurrentYear(s)})},r.getYearTabIndex=function(s){if(r.props.disabledKeyboardNavigation||r.props.preSelection==null)return"-1";var e=os(r.props.preSelection),u=L2(s,r.props);return s===e&&!u?"0":"-1"},r.getYearContent=function(s){return r.props.renderYearContent?r.props.renderYearContent(s):s},r}return a.prototype.render=function(){var t=this,r=[],s=this.props,e=s.date,u=s.yearItemNumber,f=s.onYearMouseEnter,m=s.onYearMouseLeave;if(e===void 0)return null;for(var g=Yu(e,u),b=g.startPeriod,j=g.endPeriod,F=function(_){r.push(At.createElement("div",{ref:C.YEAR_REFS[_-b],onClick:function(L){t.onYearClick(L,_)},onKeyDown:function(L){M8(L)&&(L.preventDefault(),L.key=Ur.Enter),t.onYearKeyDown(L,_)},tabIndex:Number(C.getYearTabIndex(_)),className:C.getYearClassNames(_),onMouseEnter:C.props.usePointerEvent?void 0:function(L){return f(L,_)},onPointerEnter:C.props.usePointerEvent?function(L){return f(L,_)}:void 0,onMouseLeave:C.props.usePointerEvent?void 0:function(L){return m(L,_)},onPointerLeave:C.props.usePointerEvent?function(L){return m(L,_)}:void 0,key:_,"aria-current":C.isCurrentYear(_)?"date":void 0},C.getYearContent(_)))},C=this,M=b;M<=j;M++)F(M);return At.createElement("div",{className:"react-datepicker__year"},At.createElement("div",{className:"react-datepicker__year-wrapper",onMouseLeave:this.props.usePointerEvent?void 0:this.props.clearSelectingDate,onPointerLeave:this.props.usePointerEvent?this.props.clearSelectingDate:void 0},r))},a})(ne.Component);function iO(n,a,t,r){for(var s=[],e=0;e<2*a+1;e++){var u=n+a-e,f=!0;t&&(f=os(t)<=u),r&&f&&(f=os(r)>=u),f&&s.push(u)}return s}var oO=(function(n){bl(a,n);function a(t){var r=n.call(this,t)||this;r.yearOptionButtonsRef={},r.handleOptionKeyDown=function(f,m){var g;switch(m.key){case"Enter":m.preventDefault(),r.onChange(f);break;case"Escape":m.preventDefault(),r.props.onCancel();break;case"ArrowUp":case"ArrowDown":{m.preventDefault();var b=f+(m.key==="ArrowUp"?1:-1);r.yearOptionButtonsRef[b]&&((g=r.yearOptionButtonsRef[b])===null||g===void 0||g.focus());break}}},r.renderOptions=function(){r.yearOptionButtonsRef={};var f=r.props.year,m=r.state.yearsList.map(function(j){return At.createElement("div",{ref:function(F){r.yearOptionButtonsRef[j]=F,j===f&&F?.focus()},role:"button",tabIndex:0,className:f===j?"react-datepicker__year-option react-datepicker__year-option--selected_year":"react-datepicker__year-option",key:j,onClick:r.onChange.bind(r,j),onKeyDown:r.handleOptionKeyDown.bind(r,j),"aria-selected":f===j?"true":void 0},f===j?At.createElement("span",{className:"react-datepicker__year-option--selected"},""):"",j)}),g=r.props.minDate?os(r.props.minDate):null,b=r.props.maxDate?os(r.props.maxDate):null;return(!b||!r.state.yearsList.find(function(j){return j===b}))&&m.unshift(At.createElement("div",{className:"react-datepicker__year-option",key:"upcoming",onClick:r.incrementYears},At.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-upcoming"}))),(!g||!r.state.yearsList.find(function(j){return j===g}))&&m.push(At.createElement("div",{className:"react-datepicker__year-option",key:"previous",onClick:r.decrementYears},At.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-previous"}))),m},r.onChange=function(f){r.props.onChange(f)},r.handleClickOutside=function(){r.props.onCancel()},r.shiftYears=function(f){var m=r.state.yearsList.map(function(g){return g+f});r.setState({yearsList:m})},r.incrementYears=function(){return r.shiftYears(1)},r.decrementYears=function(){return r.shiftYears(-1)};var s=t.yearDropdownItemNumber,e=t.scrollableYearDropdown,u=s||(e?10:5);return r.state={yearsList:iO(r.props.year,u,r.props.minDate,r.props.maxDate)},r.dropdownRef=ne.createRef(),r}return a.prototype.componentDidMount=function(){var t=this.dropdownRef.current;if(t){var r=t.children?Array.from(t.children):null,s=r?r.find(function(e){return e.ariaSelected}):null;t.scrollTop=s&&s instanceof HTMLElement?s.offsetTop+(s.clientHeight-t.clientHeight)/2:(t.scrollHeight-t.clientHeight)/2}},a.prototype.render=function(){var t=hi({"react-datepicker__year-dropdown":!0,"react-datepicker__year-dropdown--scrollable":this.props.scrollableYearDropdown});return At.createElement(Vb,{className:t,containerRef:this.dropdownRef,onClickOutside:this.handleClickOutside},this.renderOptions())},a})(ne.Component),lO=(function(n){bl(a,n);function a(){var t=n!==null&&n.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var r=t.props.minDate?os(t.props.minDate):1900,s=t.props.maxDate?os(t.props.maxDate):2100,e=[],u=r;u<=s;u++)e.push(At.createElement("option",{key:u,value:u},u));return e},t.onSelectChange=function(r){t.onChange(parseInt(r.target.value))},t.renderSelectMode=function(){return At.createElement("select",{value:t.props.year,className:"react-datepicker__year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(r){return At.createElement("button",{key:"read",type:"button",style:{visibility:r?"visible":"hidden"},className:"react-datepicker__year-read-view",onClick:t.toggleDropdown},At.createElement("span",{className:"react-datepicker__year-read-view--down-arrow"}),At.createElement("span",{className:"react-datepicker__year-read-view--selected-year"},t.props.year))},t.renderDropdown=function(){return At.createElement(oO,Bs({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var r=t.state.dropdownVisible,s=[t.renderReadView(!r)];return r&&s.unshift(t.renderDropdown()),s},t.onChange=function(r){t.toggleDropdown(),r!==t.props.year&&t.props.onChange(r)},t.toggleDropdown=function(r){t.setState({dropdownVisible:!t.state.dropdownVisible},function(){t.props.adjustDateOnChange&&t.handleYearChange(t.props.date,r)})},t.handleYearChange=function(r,s){var e;(e=t.onSelect)===null||e===void 0||e.call(t,r,s),t.setOpen()},t.onSelect=function(r,s){var e,u;(u=(e=t.props).onSelect)===null||u===void 0||u.call(e,r,s)},t.setOpen=function(){var r,s;(s=(r=t.props).setOpen)===null||s===void 0||s.call(r,!0)},t}return a.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode();break}return At.createElement("div",{className:"react-datepicker__year-dropdown-container react-datepicker__year-dropdown-container--".concat(this.props.dropdownMode)},t)},a})(ne.Component),cO=["react-datepicker__year-select","react-datepicker__month-select","react-datepicker__month-year-select"],I8="react-datepicker-ignore-onclickoutside",AO=function(n){var a=(n.className||"").split(/\s+/);return cO.some(function(t){return a.indexOf(t)>=0})},dO=(function(n){bl(a,n);function a(t){var r=n.call(this,t)||this;return r.monthContainer=void 0,r.handleClickOutside=function(s){r.props.onClickOutside(s)},r.setClickOutsideRef=function(){return r.containerRef.current},r.handleDropdownFocus=function(s){var e,u;AO(s.target)&&((u=(e=r.props).onDropdownFocus)===null||u===void 0||u.call(e,s))},r.getDateInView=function(){var s=r.props,e=s.preSelection,u=s.selected,f=s.openToDate,m=L8(r.props),g=U8(r.props),b=fn(),j=f||u||e;return j||(m&&nu(b,m)?m:g&&f0(b,g)?g:b)},r.increaseMonth=function(){r.setState(function(s){var e=s.date;return{date:Nd(e,1)}},function(){return r.handleMonthChange(r.state.date)})},r.decreaseMonth=function(){r.setState(function(s){var e=s.date;return{date:mh(e,1)}},function(){return r.handleMonthChange(r.state.date)})},r.handleDayClick=function(s,e,u){r.props.onSelect(s,e,u),r.props.setPreSelection&&r.props.setPreSelection(s)},r.handleDayMouseEnter=function(s){r.setState({selectingDate:s}),r.props.onDayMouseEnter&&r.props.onDayMouseEnter(s)},r.handleMonthMouseLeave=function(){r.setState({selectingDate:void 0}),r.props.onMonthMouseLeave&&r.props.onMonthMouseLeave()},r.handleYearMouseEnter=function(s,e){r.setState({selectingDate:Zd(fn(),e)}),r.props.onYearMouseEnter&&r.props.onYearMouseEnter(s,e)},r.handleYearMouseLeave=function(s,e){r.props.onYearMouseLeave&&r.props.onYearMouseLeave(s,e)},r.handleYearChange=function(s){var e,u,f,m;(u=(e=r.props).onYearChange)===null||u===void 0||u.call(e,s),r.setState({isRenderAriaLiveMessage:!0}),r.props.adjustDateOnChange&&(r.props.onSelect(s),(m=(f=r.props).setOpen)===null||m===void 0||m.call(f,!0)),r.props.setPreSelection&&r.props.setPreSelection(s)},r.getEnabledPreSelectionDateForMonth=function(s){if(!_A(s,r.props))return s;for(var e=tf(s),u=TI(s),f=H_(u,e),m=null,g=0;g<=f;g++){var b=yd(e,g);if(!_A(b,r.props)){m=b;break}}return m},r.handleMonthChange=function(s){var e,u,f,m=(e=r.getEnabledPreSelectionDateForMonth(s))!==null&&e!==void 0?e:s;r.handleCustomMonthChange(m),r.props.adjustDateOnChange&&(r.props.onSelect(m),(f=(u=r.props).setOpen)===null||f===void 0||f.call(u,!0)),r.props.setPreSelection&&r.props.setPreSelection(m)},r.handleCustomMonthChange=function(s){var e,u;(u=(e=r.props).onMonthChange)===null||u===void 0||u.call(e,s),r.setState({isRenderAriaLiveMessage:!0})},r.handleMonthYearChange=function(s){r.handleYearChange(s),r.handleMonthChange(s)},r.changeYear=function(s){r.setState(function(e){var u=e.date;return{date:Zd(u,Number(s))}},function(){return r.handleYearChange(r.state.date)})},r.changeMonth=function(s){r.setState(function(e){var u=e.date;return{date:TA(u,Number(s))}},function(){return r.handleMonthChange(r.state.date)})},r.changeMonthYear=function(s){r.setState(function(e){var u=e.date;return{date:Zd(TA(u,Ql(s)),os(s))}},function(){return r.handleMonthYearChange(r.state.date)})},r.header=function(s){s===void 0&&(s=r.state.date);var e=l0(s,r.props.locale,r.props.calendarStartDay),u=[];return r.props.showWeekNumbers&&u.push(At.createElement("div",{key:"W",className:"react-datepicker__day-name",role:"columnheader"},At.createElement("span",{className:"react-datepicker__sr-only"},"Week number"),At.createElement("span",{"aria-hidden":"true"},r.props.weekLabel||"#"))),u.concat([0,1,2,3,4,5,6].map(function(f){var m=yd(e,f),g=r.formatWeekday(m,r.props.locale),b=r.props.weekDayClassName?r.props.weekDayClassName(m):void 0;return At.createElement("div",{key:f,role:"columnheader",className:hi("react-datepicker__day-name",b)},At.createElement("span",{className:"react-datepicker__sr-only"},oi(m,"EEEE",r.props.locale)),At.createElement("span",{"aria-hidden":"true"},g))}))},r.formatWeekday=function(s,e){return r.props.formatWeekDay?_I(s,r.props.formatWeekDay,e):r.props.useWeekdaysShort?UI(s,e):LI(s,e)},r.decreaseYear=function(){r.setState(function(s){var e,u=s.date;return{date:sp(u,r.props.showYearPicker?(e=r.props.yearItemNumber)!==null&&e!==void 0?e:a.defaultProps.yearItemNumber:1)}},function(){return r.handleYearChange(r.state.date)})},r.clearSelectingDate=function(){r.setState({selectingDate:void 0})},r.renderPreviousButton=function(){var s,e,u;if(!r.props.renderCustomHeader){var f=(s=r.props.monthsShown)!==null&&s!==void 0?s:a.defaultProps.monthsShown,m=r.props.showPreviousMonths?f-1:0,g=(e=r.props.monthSelectedIn)!==null&&e!==void 0?e:m,b=mh(r.state.date,g),j;switch(!0){case r.props.showMonthYearPicker:j=B6(r.state.date,r.props);break;case r.props.showYearPicker:j=RI(r.state.date,r.props);break;case r.props.showQuarterYearPicker:j=OI(r.state.date,r.props);break;default:j=C6(b,r.props);break}if(!(!((u=r.props.forceShowMonthNavigation)!==null&&u!==void 0?u:a.defaultProps.forceShowMonthNavigation)&&!r.props.showDisabledMonthNavigation&&j||r.props.showTimeSelectOnly)){var F=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--previous"],C=["react-datepicker__navigation","react-datepicker__navigation--previous"],M=r.decreaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(M=r.decreaseYear),j&&r.props.showDisabledMonthNavigation&&(C.push("react-datepicker__navigation--previous--disabled"),M=void 0);var _=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,L=r.props,T=L.previousMonthButtonLabel,H=T===void 0?a.defaultProps.previousMonthButtonLabel:T,O=L.previousYearButtonLabel,Q=O===void 0?a.defaultProps.previousYearButtonLabel:O,Z=r.props,ee=Z.previousMonthAriaLabel,se=ee===void 0?typeof H=="string"?H:"Previous Month":ee,ue=Z.previousYearAriaLabel,ae=ue===void 0?typeof Q=="string"?Q:"Previous Year":ue;return At.createElement("button",{type:"button",className:C.join(" "),onClick:M,onKeyDown:r.props.handleOnKeyDown,"aria-label":_?ae:se},At.createElement("span",{className:F.join(" ")},_?Q:H))}}},r.increaseYear=function(){r.setState(function(s){var e,u=s.date;return{date:Xu(u,r.props.showYearPicker?(e=r.props.yearItemNumber)!==null&&e!==void 0?e:a.defaultProps.yearItemNumber:1)}},function(){return r.handleYearChange(r.state.date)})},r.renderNextButton=function(){var s;if(!r.props.renderCustomHeader){var e;switch(!0){case r.props.showMonthYearPicker:e=S6(r.state.date,r.props);break;case r.props.showYearPicker:e=PI(r.state.date,r.props);break;case r.props.showQuarterYearPicker:e=QI(r.state.date,r.props);break;default:e=j6(r.state.date,r.props);break}if(!(!((s=r.props.forceShowMonthNavigation)!==null&&s!==void 0?s:a.defaultProps.forceShowMonthNavigation)&&!r.props.showDisabledMonthNavigation&&e||r.props.showTimeSelectOnly)){var u=["react-datepicker__navigation","react-datepicker__navigation--next"],f=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--next"];r.props.showTimeSelect&&u.push("react-datepicker__navigation--next--with-time"),r.props.todayButton&&u.push("react-datepicker__navigation--next--with-today-button");var m=r.increaseMonth;(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker)&&(m=r.increaseYear),e&&r.props.showDisabledMonthNavigation&&(u.push("react-datepicker__navigation--next--disabled"),m=void 0);var g=r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker,b=r.props,j=b.nextMonthButtonLabel,F=j===void 0?a.defaultProps.nextMonthButtonLabel:j,C=b.nextYearButtonLabel,M=C===void 0?a.defaultProps.nextYearButtonLabel:C,_=r.props,L=_.nextMonthAriaLabel,T=L===void 0?typeof F=="string"?F:"Next Month":L,H=_.nextYearAriaLabel,O=H===void 0?typeof M=="string"?M:"Next Year":H;return At.createElement("button",{type:"button",className:u.join(" "),onClick:m,onKeyDown:r.props.handleOnKeyDown,"aria-label":g?O:T},At.createElement("span",{className:f.join(" ")},g?M:F))}}},r.renderCurrentMonth=function(s){s===void 0&&(s=r.state.date);var e=["react-datepicker__current-month"];return r.props.showYearDropdown&&e.push("react-datepicker__current-month--hasYearDropdown"),r.props.showMonthDropdown&&e.push("react-datepicker__current-month--hasMonthDropdown"),r.props.showMonthYearDropdown&&e.push("react-datepicker__current-month--hasMonthYearDropdown"),At.createElement("h2",{className:e.join(" ")},oi(s,r.props.dateFormat,r.props.locale))},r.renderYearDropdown=function(s){if(s===void 0&&(s=!1),!(!r.props.showYearDropdown||s))return At.createElement(lO,Bs({},a.defaultProps,r.props,{date:r.state.date,onChange:r.changeYear,year:os(r.state.date)}))},r.renderMonthDropdown=function(s){if(s===void 0&&(s=!1),!(!r.props.showMonthDropdown||s))return At.createElement(eO,Bs({},a.defaultProps,r.props,{month:Ql(r.state.date),onChange:r.changeMonth}))},r.renderMonthYearDropdown=function(s){if(s===void 0&&(s=!1),!(!r.props.showMonthYearDropdown||s))return At.createElement(aO,Bs({},a.defaultProps,r.props,{date:r.state.date,onChange:r.changeMonthYear}))},r.handleTodayButtonClick=function(s){r.props.onSelect(b6(),s),r.props.setPreSelection&&r.props.setPreSelection(b6())},r.renderTodayButton=function(){if(!(!r.props.todayButton||r.props.showTimeSelectOnly))return At.createElement("div",{className:"react-datepicker__today-button",onClick:r.handleTodayButtonClick},r.props.todayButton)},r.renderDayNamesHeader=function(s){return At.createElement("div",{className:"react-datepicker__day-names",role:"row"},r.header(s))},r.renderDefaultHeader=function(s){var e=s.monthDate,u=s.i;return At.createElement("div",{className:"react-datepicker__header ".concat(r.props.showTimeSelect?"react-datepicker__header--has-time-select":"")},r.renderCurrentMonth(e),At.createElement("div",{className:"react-datepicker__header__dropdown react-datepicker__header__dropdown--".concat(r.props.dropdownMode),onFocus:r.handleDropdownFocus},r.renderMonthDropdown(u!==0),r.renderMonthYearDropdown(u!==0),r.renderYearDropdown(u!==0)))},r.renderCustomHeader=function(s){var e,u,f=s.monthDate,m=s.i;if(r.props.showTimeSelect&&!r.state.monthContainer||r.props.showTimeSelectOnly)return null;var g=r.props,b=g.showYearPicker,j=g.yearItemNumber,F;if(b){var C=Yu(f,j),M=C.startPeriod,_=C.endPeriod;F={startYear:M,endYear:_}}var L=C6(r.state.date,r.props),T=j6(r.state.date,r.props),H=B6(r.state.date,r.props),O=S6(r.state.date,r.props);return At.createElement("div",{className:"react-datepicker__header react-datepicker__header--custom",onFocus:r.props.onDropdownFocus},(u=(e=r.props).renderCustomHeader)===null||u===void 0?void 0:u.call(e,Bs(Bs(Bs({},r.state),b&&{visibleYearsRange:F}),{customHeaderCount:m,monthDate:f,changeMonth:r.changeMonth,changeYear:r.changeYear,decreaseMonth:r.decreaseMonth,increaseMonth:r.increaseMonth,decreaseYear:r.decreaseYear,increaseYear:r.increaseYear,prevMonthButtonDisabled:L,nextMonthButtonDisabled:T,prevYearButtonDisabled:H,nextYearButtonDisabled:O})))},r.renderYearHeader=function(s){var e=s.monthDate,u=r.props,f=u.showYearPicker,m=u.yearItemNumber,g=m===void 0?a.defaultProps.yearItemNumber:m,b=Yu(e,g),j=b.startPeriod,F=b.endPeriod;return At.createElement("div",{className:"react-datepicker__header react-datepicker-year-header"},f?"".concat(j," - ").concat(F):os(e))},r.renderHeader=function(s){var e=s.monthDate,u=s.i,f=u===void 0?0:u,m={monthDate:e,i:f};switch(!0){case r.props.renderCustomHeader!==void 0:return r.renderCustomHeader(m);case(r.props.showMonthYearPicker||r.props.showQuarterYearPicker||r.props.showYearPicker):return r.renderYearHeader(m);default:return r.renderDefaultHeader(m)}},r.renderMonths=function(){var s,e;if(!(r.props.showTimeSelectOnly||r.props.showYearPicker)){for(var u=[],f=(s=r.props.monthsShown)!==null&&s!==void 0?s:a.defaultProps.monthsShown,m=r.props.showPreviousMonths?f-1:0,g=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?Xu(r.state.date,m):mh(r.state.date,m),b=(e=r.props.monthSelectedIn)!==null&&e!==void 0?e:m,j=0;j<f;++j){var F=j-b+m,C=r.props.showMonthYearPicker||r.props.showQuarterYearPicker?Xu(g,F):Nd(g,F),M="month-".concat(j),_=j<f-1,L=j>0;u.push(At.createElement("div",{key:M,ref:function(T){r.monthContainer=T??void 0},className:"react-datepicker__month-container"},r.renderHeader({monthDate:C,i:j}),At.createElement(JI,Bs({},a.defaultProps,r.props,{containerRef:r.containerRef,ariaLabelPrefix:r.props.monthAriaLabelPrefix,day:C,onDayClick:r.handleDayClick,handleOnKeyDown:r.props.handleOnDayKeyDown,handleOnMonthKeyDown:r.props.handleOnKeyDown,onDayMouseEnter:r.handleDayMouseEnter,onMouseLeave:r.handleMonthMouseLeave,orderInDisplay:j,selectingDate:r.state.selectingDate,monthShowsDuplicateDaysEnd:_,monthShowsDuplicateDaysStart:L,dayNamesHeader:r.renderDayNamesHeader(C)}))))}return u}},r.renderYears=function(){if(!r.props.showTimeSelectOnly&&r.props.showYearPicker)return At.createElement("div",{className:"react-datepicker__year--container"},r.renderHeader({monthDate:r.state.date}),At.createElement(nO,Bs({},a.defaultProps,r.props,{selectingDate:r.state.selectingDate,date:r.state.date,onDayClick:r.handleDayClick,clearSelectingDate:r.clearSelectingDate,onYearMouseEnter:r.handleYearMouseEnter,onYearMouseLeave:r.handleYearMouseLeave})))},r.renderTimeSection=function(){if(r.props.showTimeSelect&&(r.state.monthContainer||r.props.showTimeSelectOnly))return At.createElement(sO,Bs({},a.defaultProps,r.props,{onChange:r.props.onTimeChange,format:r.props.timeFormat,intervals:r.props.timeIntervals,monthRef:r.state.monthContainer}))},r.renderInputTimeSection=function(){var s=r.props.selected?new Date(r.props.selected):void 0,e=s&&Yb(s)&&!!r.props.selected,u=e?"".concat(E6(s.getHours()),":").concat(E6(s.getMinutes())):"";if(r.props.showTimeInput)return At.createElement(YI,Bs({},a.defaultProps,r.props,{date:s,timeString:u,onChange:r.props.onTimeChange}))},r.renderAriaLiveRegion=function(){var s,e=Yu(r.state.date,(s=r.props.yearItemNumber)!==null&&s!==void 0?s:a.defaultProps.yearItemNumber),u=e.startPeriod,f=e.endPeriod,m;return r.props.showYearPicker?m="".concat(u," - ").concat(f):r.props.showMonthYearPicker||r.props.showQuarterYearPicker?m=os(r.state.date):m="".concat(_5(Ql(r.state.date),r.props.locale)," ").concat(os(r.state.date)),At.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},r.state.isRenderAriaLiveMessage&&m)},r.renderChildren=function(){if(r.props.children)return At.createElement("div",{className:"react-datepicker__children-container"},r.props.children)},r.containerRef=ne.createRef(),r.state={date:r.getDateInView(),selectingDate:void 0,monthContainer:void 0,isRenderAriaLiveMessage:!1},r}return Object.defineProperty(a,"defaultProps",{get:function(){return{monthsShown:1,forceShowMonthNavigation:!1,outsideClickIgnoreClass:I8,timeCaption:"Time",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",yearItemNumber:xg}},enumerable:!1,configurable:!0}),a.prototype.componentDidMount=function(){var t=this;this.props.showTimeSelect&&(this.assignMonthContainer=(function(){t.setState({monthContainer:t.monthContainer})})())},a.prototype.componentDidUpdate=function(t){var r=this;if(this.props.preSelection&&(!js(this.props.preSelection,t.preSelection)||this.props.monthSelectedIn!==t.monthSelectedIn)){var s=!ac(this.state.date,this.props.preSelection);this.setState({date:this.props.preSelection},function(){return s&&r.handleCustomMonthChange(r.state.date)})}else this.props.openToDate&&!js(this.props.openToDate,t.openToDate)&&this.setState({date:this.props.openToDate})},a.prototype.render=function(){var t=this.props.container||jI;return At.createElement(Vb,{onClickOutside:this.handleClickOutside,style:{display:"contents"},ignoreClass:this.props.outsideClickIgnoreClass},At.createElement("div",{style:{display:"contents"},ref:this.containerRef},At.createElement(t,{className:hi("react-datepicker",this.props.className,{"react-datepicker--time-only":this.props.showTimeSelectOnly}),showTime:this.props.showTimeSelect||this.props.showTimeInput,showTimeSelectOnly:this.props.showTimeSelectOnly},this.renderAriaLiveRegion(),this.renderPreviousButton(),this.renderNextButton(),this.renderMonths(),this.renderYears(),this.renderTodayButton(),this.renderTimeSection(),this.renderInputTimeSection(),this.renderChildren())))},a})(ne.Component),uO=function(n){var a=n.icon,t=n.className,r=t===void 0?"":t,s=n.onClick,e="react-datepicker__calendar-icon";if(typeof a=="string")return At.createElement("i",{className:"".concat(e," ").concat(a," ").concat(r),"aria-hidden":"true",onClick:s});if(At.isValidElement(a)){var u=a;return At.cloneElement(u,{className:"".concat(u.props.className||""," ").concat(e," ").concat(r),onClick:function(f){typeof u.props.onClick=="function"&&u.props.onClick(f),typeof s=="function"&&s(f)}})}return At.createElement("svg",{className:"".concat(e," ").concat(r),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",onClick:s},At.createElement("path",{d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"}))},O8=(function(n){bl(a,n);function a(t){var r=n.call(this,t)||this;return r.portalRoot=null,r.el=document.createElement("div"),r}return a.prototype.componentDidMount=function(){this.portalRoot=(this.props.portalHost||document).getElementById(this.props.portalId),this.portalRoot||(this.portalRoot=document.createElement("div"),this.portalRoot.setAttribute("id",this.props.portalId),(this.props.portalHost||document.body).appendChild(this.portalRoot)),this.portalRoot.appendChild(this.el)},a.prototype.componentWillUnmount=function(){this.portalRoot&&this.portalRoot.removeChild(this.el)},a.prototype.render=function(){return TM.createPortal(this.props.children,this.el)},a})(ne.Component),fO="[tabindex], a, button, input, select, textarea",hO=function(n){return(n instanceof HTMLAnchorElement||!n.disabled)&&n.tabIndex!==-1},Q8=(function(n){bl(a,n);function a(t){var r=n.call(this,t)||this;return r.getTabChildren=function(){var s;return Array.prototype.slice.call((s=r.tabLoopRef.current)===null||s===void 0?void 0:s.querySelectorAll(fO),1,-1).filter(hO)},r.handleFocusStart=function(){var s=r.getTabChildren();s&&s.length>1&&s[s.length-1].focus()},r.handleFocusEnd=function(){var s=r.getTabChildren();s&&s.length>1&&s[0].focus()},r.tabLoopRef=ne.createRef(),r}return a.prototype.render=function(){var t;return((t=this.props.enableTabLoop)!==null&&t!==void 0?t:a.defaultProps.enableTabLoop)?At.createElement("div",{className:"react-datepicker__tab-loop",ref:this.tabLoopRef},At.createElement("div",{className:"react-datepicker__tab-loop__start",tabIndex:0,onFocus:this.handleFocusStart}),this.props.children,At.createElement("div",{className:"react-datepicker__tab-loop__end",tabIndex:0,onFocus:this.handleFocusEnd})):this.props.children},a.defaultProps={enableTabLoop:!0},a})(ne.Component);function mO(n){function a(t){var r,s=typeof t.hidePopper=="boolean"?t.hidePopper:!0,e=ne.useRef(null),u=CI(Bs({open:!s,whileElementsMounted:rI,placement:t.popperPlacement,middleware:iu([dI({padding:15}),AI(10),uI({element:e})],(r=t.popperModifiers)!==null&&r!==void 0?r:[],!0)},t.popperProps)),f=Bs(Bs({},t),{hidePopper:s,popperProps:Bs(Bs({},u),{arrowRef:e})});return At.createElement(n,Bs({},f))}return a.displayName="withFloating(".concat(n.displayName||n.name||"Component",")"),a}var pO=function(n){var a=n.className,t=n.wrapperClassName,r=n.hidePopper,s=r===void 0?!0:r,e=n.popperComponent,u=n.targetComponent,f=n.enableTabLoop,m=n.popperOnKeyDown,g=n.portalId,b=n.portalHost,j=n.popperProps,F=n.showArrow,C=void 0;if(!s){var M=hi("react-datepicker-popper",a);C=At.createElement(Q8,{enableTabLoop:f},At.createElement("div",{ref:j.refs.setFloating,style:j.floatingStyles,className:M,"data-placement":j.placement,onKeyDown:m},e,F&&At.createElement(gI,{ref:j.arrowRef,context:j.context,fill:"currentColor",strokeWidth:1,height:8,width:16,style:{transform:"translateY(-1px)"},className:"react-datepicker__triangle"})))}n.popperContainer&&(C=ne.createElement(n.popperContainer,{},C)),g&&!s&&(C=At.createElement(O8,{portalId:g,portalHost:b},C));var _=hi("react-datepicker-wrapper",t);return At.createElement(At.Fragment,null,At.createElement("div",{ref:j.refs.setReference,className:_},u),C)},gO=mO(pO);function xO(n,a){return n&&a?Ql(n)!==Ql(a)||os(n)!==os(a):n!==a}var uv="Date input not valid.",z1=(function(n){bl(a,n);function a(t){var r=n.call(this,t)||this;return r.calendar=null,r.input=null,r.getPreSelection=function(){return r.props.openToDate?r.props.openToDate:r.props.selectsEnd&&r.props.startDate?r.props.startDate:r.props.selectsStart&&r.props.endDate?r.props.endDate:fn()},r.modifyHolidays=function(){var s;return(s=r.props.holidays)===null||s===void 0?void 0:s.reduce(function(e,u){var f=new Date(u.date);return Yb(f)?iu(iu([],e,!0),[Bs(Bs({},u),{date:f})],!1):e},[])},r.calcInitialState=function(){var s,e=r.getPreSelection(),u=L8(r.props),f=U8(r.props),m=u&&nu(e,_2(u))?u:f&&f0(e,y6(f))?f:e;return{open:r.props.startOpen||!1,preventFocus:!1,inputValue:null,preSelection:(s=r.props.selectsRange?r.props.startDate:r.props.selected)!==null&&s!==void 0?s:m,highlightDates:F6(r.props.highlightDates),focused:!1,shouldFocusDayInline:!1,isRenderAriaLiveMessage:!1,wasHidden:!1}},r.getInputValue=function(){var s,e=r.props,u=e.locale,f=e.startDate,m=e.endDate,g=e.rangeSeparator,b=e.selected,j=e.selectedDates,F=e.selectsMultiple,C=e.selectsRange,M=e.value,_=(s=r.props.dateFormat)!==null&&s!==void 0?s:a.defaultProps.dateFormat,L=r.state.inputValue;return typeof M=="string"?M:typeof L=="string"?L:C?SI(f,m,{dateFormat:_,locale:u,rangeSeparator:g}):F?FI(j??[],{dateFormat:_,locale:u}):DA(b,{dateFormat:_,locale:u})},r.resetHiddenStatus=function(){r.setState(Bs(Bs({},r.state),{wasHidden:!1}))},r.setHiddenStatus=function(){r.setState(Bs(Bs({},r.state),{wasHidden:!0}))},r.setHiddenStateOnVisibilityHidden=function(){document.visibilityState==="hidden"&&r.setHiddenStatus()},r.clearPreventFocusTimeout=function(){r.preventFocusTimeout&&clearTimeout(r.preventFocusTimeout)},r.setFocus=function(){var s,e;(e=(s=r.input)===null||s===void 0?void 0:s.focus)===null||e===void 0||e.call(s,{preventScroll:!0})},r.setBlur=function(){var s,e;(e=(s=r.input)===null||s===void 0?void 0:s.blur)===null||e===void 0||e.call(s),r.cancelFocusInput()},r.deferBlur=function(){requestAnimationFrame(function(){r.setBlur()})},r.setOpen=function(s,e){e===void 0&&(e=!1),r.setState({open:s,preSelection:s&&r.state.open?r.state.preSelection:r.calcInitialState().preSelection,lastPreSelectChange:fv},function(){s||r.setState(function(u){return{focused:e?u.focused:!1}},function(){!e&&r.deferBlur(),r.setState({inputValue:null})})})},r.inputOk=function(){return Ju(r.state.preSelection)},r.isCalendarOpen=function(){return r.props.open===void 0?r.state.open&&!r.props.disabled&&!r.props.readOnly:r.props.open},r.handleFocus=function(s){var e,u,f=r.state.wasHidden,m=f?r.state.open:!0;f&&r.resetHiddenStatus(),r.state.preventFocus||((u=(e=r.props).onFocus)===null||u===void 0||u.call(e,s),m&&!r.props.preventOpenOnFocus&&!r.props.readOnly&&r.setOpen(!0)),r.setState({focused:!0})},r.sendFocusBackToInput=function(){r.preventFocusTimeout&&r.clearPreventFocusTimeout(),r.setState({preventFocus:!0},function(){r.preventFocusTimeout=setTimeout(function(){r.setFocus(),r.setState({preventFocus:!1})})})},r.cancelFocusInput=function(){clearTimeout(r.inputFocusTimeout),r.inputFocusTimeout=void 0},r.deferFocusInput=function(){r.cancelFocusInput(),r.inputFocusTimeout=setTimeout(function(){return r.setFocus()},1)},r.handleDropdownFocus=function(){r.cancelFocusInput()},r.resetInputValue=function(){r.setState(Bs(Bs({},r.state),{inputValue:null}))},r.handleBlur=function(s){var e,u;(!r.state.open||r.props.withPortal||r.props.showTimeInput)&&((u=(e=r.props).onBlur)===null||u===void 0||u.call(e,s)),r.resetInputValue(),r.state.open&&r.props.open===!1&&r.setOpen(!1),r.setState({focused:!1})},r.handleCalendarClickOutside=function(s){var e,u;r.props.inline||r.setOpen(!1),(u=(e=r.props).onClickOutside)===null||u===void 0||u.call(e,s),r.props.withPortal&&s.preventDefault()},r.handleChange=function(){for(var s,e,u,f,m,g=[],b=0;b<arguments.length;b++)g[b]=arguments[b];var j=g[0];if(!(r.props.onChangeRaw&&(r.props.onChangeRaw.apply(r,g),!j||typeof j.isDefaultPrevented!="function"||j.isDefaultPrevented()))){r.setState({inputValue:j?.target instanceof HTMLInputElement?j.target.value:null,lastPreSelectChange:bO});var F=r.props,C=F.selectsRange,M=F.startDate,_=F.endDate,L=(s=r.props.dateFormat)!==null&&s!==void 0?s:a.defaultProps.dateFormat,T=(e=r.props.strictParsing)!==null&&e!==void 0?e:a.defaultProps.strictParsing,H=j?.target instanceof HTMLInputElement?j.target.value:"";if(C){var O=r.props.rangeSeparator,Q=O.trim(),Z=H.split(L.includes(Q)?O:Q,2).map(function(ge){return ge.trim()}),ee=Z[0],se=Z[1],ue=lv(ee??"",L,r.props.locale,T),ae=ue?lv(se??"",L,r.props.locale,T):null,pe=M?.getTime()!==ue?.getTime(),z=_?.getTime()!==ae?.getTime();if(!pe&&!z||ue&&_A(ue,r.props)||ae&&_A(ae,r.props))return;(f=(u=r.props).onChange)===null||f===void 0||f.call(u,[ue,ae],j)}else{var J=lv(H,L,r.props.locale,T,(m=r.props.selected)!==null&&m!==void 0?m:void 0);(J||!H)&&r.setSelected(J,j,!0)}}},r.handleSelect=function(s,e,u){if(!r.props.readOnly){var f=r.props,m=f.selectsRange,g=f.startDate,b=f.endDate,j=f.swapRange,F=!m||g&&!b&&(j||!Av(s,g));r.props.shouldCloseOnSelect&&!r.props.showTimeSelect&&F&&r.sendFocusBackToInput(),r.props.onChangeRaw&&r.props.onChangeRaw(e),r.setSelected(s,e,!1,u),r.props.showDateSelect&&r.setState({isRenderAriaLiveMessage:!0}),!r.props.shouldCloseOnSelect||r.props.showTimeSelect?r.setPreSelection(s):F&&r.setOpen(!1)}},r.setSelected=function(s,e,u,f){var m,g,b=s;if(r.props.showYearPicker){if(b!==null&&L2(os(b),r.props))return}else if(r.props.showMonthYearPicker){if(b!==null&&_8(b,r.props))return}else if(b!==null&&_A(b,r.props))return;var j=r.props,F=j.onChange,C=j.selectsRange,M=j.startDate,_=j.endDate,L=j.selectsMultiple,T=j.selectedDates,H=j.minTime,O=j.swapRange;if(!ch(r.props.selected,b)||r.props.allowSameDay||C||L)if(b!==null&&(r.props.selected&&(!u||!r.props.showTimeSelect&&!r.props.showTimeSelectOnly&&!r.props.showTimeInput)&&(b=cv(b,{hour:Zu(r.props.selected),minute:ef(r.props.selected),second:o0(r.props.selected)})),!u&&(r.props.showTimeSelect||r.props.showTimeSelectOnly)&&H&&(b=cv(b,{hour:H.getHours(),minute:H.getMinutes(),second:H.getSeconds()})),r.props.inline||r.setState({preSelection:b}),r.props.focusSelectedMonth||r.setState({monthSelectedIn:f})),C){var Q=!M&&!_,Z=M&&!_,ee=!M&&!!_,se=M&&_;Q?F?.([b,null],e):Z?b===null?F?.([null,null],e):Av(b,M)?F?.(O?[b,M]:[b,null],e):F?.([M,b],e):ee&&(b&&Av(b,_)?F?.([b,_],e):F?.([b,null],e)),se&&F?.([b,null],e)}else if(L){if(b!==null)if(!T?.length)F?.([b],e);else{var ue=T.some(function(pe){return js(pe,b)});if(ue){var ae=T.filter(function(pe){return!js(pe,b)});F?.(ae,e)}else F?.(iu(iu([],T,!0),[b],!1),e)}}else F?.(b,e);u||((g=(m=r.props).onSelect)===null||g===void 0||g.call(m,b,e),r.setState({inputValue:null}))},r.setPreSelection=function(s){if(!r.props.readOnly){var e=Ju(r.props.minDate),u=Ju(r.props.maxDate),f=!0;if(s){var m=_2(s);if(e&&u)f=nh(s,r.props.minDate,r.props.maxDate);else if(e){var g=_2(r.props.minDate);f=f0(s,g)||ch(m,g)}else if(u){var b=y6(r.props.maxDate);f=nu(s,b)||ch(m,b)}}f&&r.setState({preSelection:s})}},r.toggleCalendar=function(){r.setOpen(!r.state.open)},r.handleTimeChange=function(s){var e,u;if(!(r.props.selectsRange||r.props.selectsMultiple)){var f=r.props.selected?r.props.selected:r.getPreSelection(),m=r.props.selected?s:cv(f,{hour:Zu(s),minute:ef(s)});r.setState({preSelection:m}),(u=(e=r.props).onChange)===null||u===void 0||u.call(e,m),r.props.shouldCloseOnSelect&&!r.props.showTimeInput&&(r.sendFocusBackToInput(),r.setOpen(!1)),r.props.showTimeInput&&r.setOpen(!0),(r.props.showTimeSelectOnly||r.props.showTimeSelect)&&r.setState({isRenderAriaLiveMessage:!0}),r.setState({inputValue:null})}},r.onInputClick=function(){var s,e;!r.props.disabled&&!r.props.readOnly&&r.setOpen(!0),(e=(s=r.props).onInputClick)===null||e===void 0||e.call(s)},r.onInputKeyDown=function(s){var e,u,f,m,g,b;(u=(e=r.props).onKeyDown)===null||u===void 0||u.call(e,s);var j=s.key;if(!r.state.open&&!r.props.inline&&!r.props.preventOpenOnFocus){(j===Ur.ArrowDown||j===Ur.ArrowUp||j===Ur.Enter)&&((f=r.onInputClick)===null||f===void 0||f.call(r));return}if(r.state.open){if(j===Ur.ArrowDown||j===Ur.ArrowUp){s.preventDefault();var F=r.props.showTimeSelectOnly?".react-datepicker__time-list-item[tabindex='0']":r.props.showWeekPicker&&r.props.showWeekNumbers?'.react-datepicker__week-number[tabindex="0"]':r.props.showFullMonthYearPicker||r.props.showMonthYearPicker?'.react-datepicker__month-text[tabindex="0"]':'.react-datepicker__day[tabindex="0"]',C=((m=r.calendar)===null||m===void 0?void 0:m.containerRef.current)instanceof Element&&r.calendar.containerRef.current.querySelector(F);C instanceof HTMLElement&&C.focus({preventScroll:!0});return}var M=fn(r.state.preSelection);j===Ur.Enter?(s.preventDefault(),s.target.blur(),r.inputOk()&&r.state.lastPreSelectChange===fv?(r.handleSelect(M,s),!r.props.shouldCloseOnSelect&&r.setPreSelection(M)):r.setOpen(!1)):j===Ur.Escape?(s.preventDefault(),s.target.blur(),r.sendFocusBackToInput(),r.setOpen(!1)):j===Ur.Tab&&r.setOpen(!1),r.inputOk()||(b=(g=r.props).onInputError)===null||b===void 0||b.call(g,{code:1,msg:uv})}},r.onPortalKeyDown=function(s){var e=s.key;e===Ur.Escape&&(s.preventDefault(),r.setState({preventFocus:!0},function(){r.setOpen(!1),setTimeout(function(){r.setFocus(),r.setState({preventFocus:!1})})}))},r.onDayKeyDown=function(s){var e,u,f,m,g,b,j=r.props,F=j.minDate,C=j.maxDate,M=j.disabledKeyboardNavigation,_=j.showWeekPicker,L=j.shouldCloseOnSelect,T=j.locale,H=j.calendarStartDay,O=j.adjustDateOnChange,Q=j.inline;if((u=(e=r.props).onKeyDown)===null||u===void 0||u.call(e,s),!M){var Z=s.key,ee=s.shiftKey,se=fn(r.state.preSelection),ue=function(ke,he){var Ne=he;switch(ke){case Ur.ArrowRight:Ne=_?tb(he,1):yd(he,1);break;case Ur.ArrowLeft:Ne=_?i6(he):HU(he);break;case Ur.ArrowUp:Ne=i6(he);break;case Ur.ArrowDown:Ne=tb(he,1);break;case Ur.PageUp:Ne=ee?sp(he,1):mh(he,1);break;case Ur.PageDown:Ne=ee?Xu(he,1):Nd(he,1);break;case Ur.Home:Ne=l0(he,T,H);break;case Ur.End:Ne=DI(he);break}return Ne},ae=function(ke,he){for(var Ne=40,xe=ke,we=!1,ye=0,te=ue(ke,he);!we;){if(ye>=Ne){te=he;break}F&&te<F&&(xe=Ur.ArrowRight,te=_A(F,r.props)?ue(xe,te):F),C&&te>C&&(xe=Ur.ArrowLeft,te=_A(C,r.props)?ue(xe,te):C),_A(te,r.props)?((xe===Ur.PageUp||xe===Ur.Home)&&(xe=Ur.ArrowRight),(xe===Ur.PageDown||xe===Ur.End)&&(xe=Ur.ArrowLeft),te=ue(xe,te)):we=!0,ye++}return te};if(Z===Ur.Enter){s.preventDefault(),r.handleSelect(se,s),!L&&r.setPreSelection(se);return}else if(Z===Ur.Escape){s.preventDefault(),r.setOpen(!1),r.inputOk()||(m=(f=r.props).onInputError)===null||m===void 0||m.call(f,{code:1,msg:uv});return}var pe=null;switch(Z){case Ur.ArrowLeft:case Ur.ArrowRight:case Ur.ArrowUp:case Ur.ArrowDown:case Ur.PageUp:case Ur.PageDown:case Ur.Home:case Ur.End:pe=ae(Z,se);break}if(!pe){(b=(g=r.props).onInputError)===null||b===void 0||b.call(g,{code:1,msg:uv});return}if(s.preventDefault(),r.setState({lastPreSelectChange:fv}),O&&r.setSelected(pe),r.setPreSelection(pe),Q){var z=Ql(se),J=Ql(pe),ge=os(se),fe=os(pe);z!==J||ge!==fe?r.setState({shouldFocusDayInline:!0}):r.setState({shouldFocusDayInline:!1})}}},r.onPopperKeyDown=function(s){var e=s.key;e===Ur.Escape&&(s.preventDefault(),r.sendFocusBackToInput(),r.setOpen(!1))},r.onClearClick=function(s){s&&s.preventDefault&&s.preventDefault(),r.sendFocusBackToInput();var e=r.props,u=e.selectsRange,f=e.onChange;f?.(u?[null,null]:null,s),r.setState({inputValue:null})},r.clear=function(){r.onClearClick()},r.onScroll=function(s){typeof r.props.closeOnScroll=="boolean"&&r.props.closeOnScroll?(s.target===document||s.target===document.documentElement||s.target===document.body)&&r.setOpen(!1):typeof r.props.closeOnScroll=="function"&&r.props.closeOnScroll(s)&&r.setOpen(!1)},r.renderCalendar=function(){var s,e;return!r.props.inline&&!r.isCalendarOpen()?null:At.createElement(dO,Bs({showMonthYearDropdown:void 0,ref:function(u){r.calendar=u}},r.props,r.state,{setOpen:r.setOpen,dateFormat:(s=r.props.dateFormatCalendar)!==null&&s!==void 0?s:a.defaultProps.dateFormatCalendar,onSelect:r.handleSelect,onClickOutside:r.handleCalendarClickOutside,holidays:zI(r.modifyHolidays()),outsideClickIgnoreClass:r.props.outsideClickIgnoreClass,onDropdownFocus:r.handleDropdownFocus,onTimeChange:r.handleTimeChange,className:r.props.calendarClassName,container:r.props.calendarContainer,handleOnKeyDown:r.props.onKeyDown,handleOnDayKeyDown:r.onDayKeyDown,setPreSelection:r.setPreSelection,dropdownMode:(e=r.props.dropdownMode)!==null&&e!==void 0?e:a.defaultProps.dropdownMode}),r.props.children)},r.renderAriaLiveRegion=function(){var s,e=r.props.locale,u=(s=r.props.dateFormat)!==null&&s!==void 0?s:a.defaultProps.dateFormat,f=r.props.showTimeInput||r.props.showTimeSelect,m=f?"PPPPp":"PPPP",g;return r.props.selectsRange?g="Selected start date: ".concat(DA(r.props.startDate,{dateFormat:m,locale:e}),". ").concat(r.props.endDate?"End date: "+DA(r.props.endDate,{dateFormat:m,locale:e}):""):r.props.showTimeSelectOnly?g="Selected time: ".concat(DA(r.props.selected,{dateFormat:u,locale:e})):r.props.showYearPicker?g="Selected year: ".concat(DA(r.props.selected,{dateFormat:"yyyy",locale:e})):r.props.showMonthYearPicker?g="Selected month: ".concat(DA(r.props.selected,{dateFormat:"MMMM yyyy",locale:e})):r.props.showQuarterYearPicker?g="Selected quarter: ".concat(DA(r.props.selected,{dateFormat:"yyyy, QQQ",locale:e})):g="Selected date: ".concat(DA(r.props.selected,{dateFormat:m,locale:e})),At.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},g)},r.renderDateInput=function(){var s,e,u=hi(r.props.className,(s={},s[r.props.outsideClickIgnoreClass||a.defaultProps.outsideClickIgnoreClass]=r.state.open,s)),f=r.props.customInput||At.createElement("input",{type:"text"}),m=r.props.customInputRef||"ref";return ne.cloneElement(f,(e={},e[m]=function(g){r.input=g},e.value=r.getInputValue(),e.onBlur=r.handleBlur,e.onChange=r.handleChange,e.onClick=r.onInputClick,e.onFocus=r.handleFocus,e.onKeyDown=r.onInputKeyDown,e.id=r.props.id,e.name=r.props.name,e.form=r.props.form,e.autoFocus=r.props.autoFocus,e.placeholder=r.props.placeholderText,e.disabled=r.props.disabled,e.autoComplete=r.props.autoComplete,e.className=hi(f.props.className,u),e.title=r.props.title,e.readOnly=r.props.readOnly,e.required=r.props.required,e.tabIndex=r.props.tabIndex,e["aria-describedby"]=r.props.ariaDescribedBy,e["aria-invalid"]=r.props.ariaInvalid,e["aria-labelledby"]=r.props.ariaLabelledBy,e["aria-required"]=r.props.ariaRequired,e))},r.renderClearButton=function(){var s=r.props,e=s.isClearable,u=s.disabled,f=s.selected,m=s.startDate,g=s.endDate,b=s.clearButtonTitle,j=s.clearButtonClassName,F=j===void 0?"":j,C=s.ariaLabelClose,M=C===void 0?"Close":C,_=s.selectedDates,L=s.readOnly;return e&&!L&&(f!=null||m!=null||g!=null||_?.length)?At.createElement("button",{type:"button",className:hi("react-datepicker__close-icon",F,{"react-datepicker__close-icon--disabled":u}),disabled:u,"aria-label":M,onClick:r.onClearClick,title:b,tabIndex:-1}):null},r.state=r.calcInitialState(),r.preventFocusTimeout=void 0,r}return Object.defineProperty(a,"defaultProps",{get:function(){return{allowSameDay:!1,dateFormat:"MM/dd/yyyy",dateFormatCalendar:"LLLL yyyy",disabled:!1,disabledKeyboardNavigation:!1,dropdownMode:"scroll",preventOpenOnFocus:!1,monthsShown:1,outsideClickIgnoreClass:I8,readOnly:!1,rangeSeparator:D8,withPortal:!1,selectsDisabledDaysInRange:!1,shouldCloseOnSelect:!0,showTimeSelect:!1,showTimeInput:!1,showPreviousMonths:!1,showMonthYearPicker:!1,showFullMonthYearPicker:!1,showTwoColumnMonthYearPicker:!1,showFourColumnMonthYearPicker:!1,showYearPicker:!1,showQuarterYearPicker:!1,showWeekPicker:!1,strictParsing:!1,swapRange:!1,timeIntervals:30,timeCaption:"Time",previousMonthAriaLabel:"Previous Month",previousMonthButtonLabel:"Previous Month",nextMonthAriaLabel:"Next Month",nextMonthButtonLabel:"Next Month",previousYearAriaLabel:"Previous Year",previousYearButtonLabel:"Previous Year",nextYearAriaLabel:"Next Year",nextYearButtonLabel:"Next Year",timeInputLabel:"Time",enableTabLoop:!0,yearItemNumber:xg,focusSelectedMonth:!1,showPopperArrow:!0,excludeScrollbar:!0,customTimeInput:null,calendarStartDay:void 0,toggleCalendarOnIconClick:!1,usePointerEvent:!1}},enumerable:!1,configurable:!0}),a.prototype.componentDidMount=function(){window.addEventListener("scroll",this.onScroll,!0),document.addEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},a.prototype.componentDidUpdate=function(t,r){var s,e,u,f;t.inline&&xO(t.selected,this.props.selected)&&this.setPreSelection(this.props.selected),this.state.monthSelectedIn!==void 0&&t.monthsShown!==this.props.monthsShown&&this.setState({monthSelectedIn:0}),t.highlightDates!==this.props.highlightDates&&this.setState({highlightDates:F6(this.props.highlightDates)}),!r.focused&&!ch(t.selected,this.props.selected)&&this.setState({inputValue:null}),r.open!==this.state.open&&(r.open===!1&&this.state.open===!0&&((e=(s=this.props).onCalendarOpen)===null||e===void 0||e.call(s)),r.open===!0&&this.state.open===!1&&((f=(u=this.props).onCalendarClose)===null||f===void 0||f.call(u)))},a.prototype.componentWillUnmount=function(){this.clearPreventFocusTimeout(),window.removeEventListener("scroll",this.onScroll,!0),document.removeEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},a.prototype.renderInputContainer=function(){var t=this.props,r=t.showIcon,s=t.icon,e=t.calendarIconClassname,u=t.calendarIconClassName,f=t.toggleCalendarOnIconClick,m=this.state.open;return e&&console.warn("calendarIconClassname props is deprecated. should use calendarIconClassName props."),At.createElement("div",{className:"react-datepicker__input-container".concat(r?" react-datepicker__view-calendar-icon":"")},r&&At.createElement(uO,Bs({icon:s,className:hi(u,!u&&e,m&&"react-datepicker-ignore-onclickoutside")},f?{onClick:this.toggleCalendar}:null)),this.state.isRenderAriaLiveMessage&&this.renderAriaLiveRegion(),this.renderDateInput(),this.renderClearButton())},a.prototype.render=function(){var t=this.renderCalendar();if(this.props.inline)return t;if(this.props.withPortal){var r=this.state.open?At.createElement(Q8,{enableTabLoop:this.props.enableTabLoop},At.createElement("div",{className:"react-datepicker__portal",tabIndex:-1,onKeyDown:this.onPortalKeyDown},t)):null;return this.state.open&&this.props.portalId&&(r=At.createElement(O8,Bs({portalId:this.props.portalId},this.props),r)),At.createElement("div",null,this.renderInputContainer(),r)}return At.createElement(gO,Bs({},this.props,{className:this.props.popperClassName,hidePopper:!this.isCalendarOpen(),targetComponent:this.renderInputContainer(),popperComponent:t,popperOnKeyDown:this.onPopperKeyDown,showArrow:this.props.showPopperArrow}))},a})(ne.Component),bO="input",fv="navigate";const yO=(n,a)=>!n||n.toString().trim()===""?`${a} is required`:null,vO=n=>n?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n)?null:"Please enter a valid email address":null,wO=n=>n?/^\+?[\d\s\-\(\)]{10,}$/.test(n)?null:"Please enter a valid phone number":null,NO=(n,a)=>{if(!n)return null;const t=new Date(n);return isNaN(t.getTime())?`Please enter a valid ${a}`:null},CO=(n,a)=>{if(!n)return null;const t=new Date(n),r=new Date;return r.setHours(0,0,0,0),isNaN(t.getTime())?`Please enter a valid ${a}`:t>r?`${a} cannot be in the future`:null},jO=(n,a)=>{if(!n||!a)return null;const t=new Date(n),r=new Date(a);return isNaN(t.getTime())||isNaN(r.getTime())?"Please enter valid dates":r<t?"Admission date cannot be before date of birth":null},BO=(n,a,t=0,r=null)=>{if(n===""||n===void 0||n===null)return null;const s=parseFloat(n);return isNaN(s)?`${a} must be a valid number`:s<t?`${a} must be at least ${t}`:r!==null&&s>r?`${a} must be no more than ${r}`:null},SO=(n,a,t,r)=>{if(!n)return null;const s=n.toString().length;return s<t?`${a} must be at least ${t} characters`:r&&s>r?`${a} must be no more than ${r} characters`:null},FO=(n,a)=>{if(!n)return null;const t=n.replace(/[\s\-]/g,"");return/^\d{13}$/.test(t)?null:`${a} must be a valid 13-digit CNIC number`},EO=n=>{if(!n)return null;try{return new URL(n),null}catch{return"Please enter a valid URL"}return null},kO=(n,a,t,r)=>n?a.test(n)?null:r||`${t} format is invalid`:null,DO=(n,a,t,...r)=>a?t(n,...r):null,TO=(n,a,t,r)=>n!==a?`${t} and ${r} must match`:null,_O=(n,a,t)=>!n||!Array.isArray(n)?`${t} must be an array`:n.length<a?`${t} must have at least ${a} items`:null,LO=(n,a,t)=>{for(const r of a){let s=null;switch(r.type){case"required":s=yO(n,t);break;case"email":s=vO(n);break;case"phone":s=wO(n);break;case"date":s=NO(n,t);break;case"dateNotInFuture":s=CO(n,t);break;case"number":s=BO(n,t,r.min,r.max);break;case"length":s=SO(n,t,r.minLength,r.maxLength);break;case"cnic":s=FO(n,t);break;case"url":s=EO(n);break;case"pattern":s=kO(n,r.pattern,t,r.errorMessage);break;case"conditional":s=DO(n,r.condition,r.validator,...r.validatorArgs);break;case"match":s=TO(n,r.value2,t,r.fieldName2);break;case"minArrayLength":s=_O(n,r.minLength,t);break}if(s)return s}return null},UO=(n,a)=>{const t={};for(const[r,s]of Object.entries(a)){const e=n[r],u=r.charAt(0).toUpperCase()+r.slice(1).replace(/([A-Z])/g," $1"),f=LO(e,s,u);f&&(t[r]=f)}if(n.dateOfBirth&&n.dateOfAdmission){const r=jO(n.dateOfBirth,n.dateOfAdmission);r&&(t.dateOfAdmission=r)}return t},MO="/dawn-school/assets/student2-BpZQHQMK.jpg",L6=({formData:n,photoPreview:a})=>{const s=(rr(f=>f.settings.schoolInfo)?.fundingType||"traditional")==="traditional",e=new Date().toLocaleDateString(),u=f=>f?f instanceof Date?f.toLocaleDateString():f:"";return i.jsxs("div",{className:"p-4 max-w-4xl mx-auto",children:[i.jsx("style",{children:`
        @media print {
          @page {
            margin: 0.15in;
            size: A4;
          }
          body {
            margin: 0;
            padding: 0;
            font-size: 8pt;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.1;
          }
          .no-print {
            display: none !important;
          }
          /* Hide all non-essential elements when printing */
          .print-header, .print-button, .print-actions {
            display: none !important;
          }
          /* Ensure clean print view */
          .form-container {
            box-shadow: none !important;
            margin: 0 !important;
            padding: 0 !important;
            max-width: 100%;
          }
          /* Fix for print overflow issues */
          html, body {
            height: auto;
            overflow: visible;
          }
          /* Ensure content fits on page */
          .form-container {
            page-break-inside: avoid;
          }
          .section {
            page-break-inside: avoid;
            margin-bottom: 10px;
          }
          .form-row {
            page-break-inside: avoid;
            display: flex;
            flex-wrap: wrap;
            margin: 0 -4px 6px -4px;
          }
          .form-group {
            flex: 1 0 22%;
            min-width: 120px;
            padding: 0 4px;
            margin-bottom: 6px;
          }
          .form-label {
            font-weight: 600;
            margin-bottom: 2px;
            font-size: 7pt;
            color: #444;
          }
          .form-value {
            border-bottom: 1px solid #333;
            min-height: 16px;
            padding: 2px 0;
            font-size: 8pt;
          }
          .full-width {
            flex: 1 0 100%;
          }
          .half-width {
            flex: 1 0 48%;
          }
          .third-width {
            flex: 1 0 31%;
          }
          .header {
            text-align: center;
            margin-bottom: 10px;
            padding-bottom: 6px;
          }
          .header h1 {
            font-size: 14pt;
            font-weight: bold;
            color: #333;
            margin: 0 0 2px 0;
          }
          .header p {
            font-size: 10pt;
            color: #666;
            margin: 0;
          }
          .logo {
            max-height: 50px;
            width: auto;
            margin-bottom: 8px;
          }
          .section-title {
            font-weight: bold;
            font-size: 10pt;
            margin-bottom: 6px;
            color: #333;
            padding-bottom: 7px;
          }
          .declaration {
            border: 1px solid #333;
            padding: 8px;
            margin-top: 12px;
          }
          .declaration-text {
            font-size: 7pt;
            line-height: 1.2;
            margin-bottom: 8px;
            color: #555;
          }
          .signature-row {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
          }
          .signature-group {
            flex: 1;
            padding: 0 4px;
          }
          .signature-line {
            border-top: 1px solid #333;
            height: 1px;
            margin-top: 20px;
          }
          .signature-label {
            font-size: 7pt;
            color: #555;
            margin-top: 3px;
          }
          .footer {
            text-align: center;
            margin-top: 15px;
            font-size: 6pt;
            color: #777;
            border-top: 1px solid #ccc;
            padding-top: 4px;
          }
          .photo-container {
            width: 70px;
            height: 70px;
            border: 1px solid #333;
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
          }
          .photo-container img {
            max-width: 100%;
            max-height: 100%;
            object-fit: cover;
          }
          .photo-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f0f0f0;
            font-size: 6pt;
          }
          /* Better space utilization */
          .student-info-row {
            display: flex;
            flex-wrap: wrap;
          }
          .photo-section {
            flex: 0 0 70px;
            margin-right: 10px;
          }
          .student-details {
            flex: 1;
          }
          .compact-row {
            display: flex;
            flex-wrap: wrap;
          }
          .compact-group {
            flex: 1 0 22%;
            min-width: 120px;
            padding: 0 3px;
            margin-bottom: 5px;
          }
          /* Reduce font sizes further for better fit */
          .small-text {
            font-size: 7pt;
          }
          .x-small-text {
            font-size: 6pt;
          }
          /* Adjust specific sections for better space usage */
          .fee-section .form-group {
            flex: 1 0 23%;
          }
        }
        .form-container {
          max-width: 800px;
          margin: 0 auto;
          padding: 15px;
          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          font-size: 13px;
        }
        .header {
          text-align: center;
          margin-bottom: 20px;
          padding-bottom: 10px;
        }
        .header h1 {
          font-size: 20px;
          font-weight: bold;
          color: #333;
          margin: 0 0 3px 0;
        }
        .header p {
          font-size: 14px;
          color: #666;
          margin: 0;
        }
        .logo {
          max-height: 80px;
          width: auto;
          margin-bottom: 10px;
        }
        .section {
          margin-bottom: 18px;
        }
        .section-title {
          font-weight: bold;
          font-size: 15px;
          margin-bottom: 10px;
          color: #333;
          padding-bottom: 7px;
        }
        .form-row {
          display: flex;
          flex-wrap: wrap;
          margin: 0 -8px 12px -8px;
        }
        .form-group {
          flex: 1 0 23%;
          min-width: 160px;
          padding: 0 8px;
          margin-bottom: 12px;
        }
        .form-label {
          font-weight: 600;
          margin-bottom: 4px;
          font-size: 11px;
          color: #555;
        }
        .form-value {
          border-bottom: 1px solid #333;
          min-height: 24px;
          padding: 4px 0;
          font-size: 13px;
        }
        .full-width {
          flex: 1 0 100%;
        }
        .declaration {
          border: 1px solid #333;
          padding: 15px;
          margin-top: 20px;
        }
        .declaration-text {
          font-size: 11px;
          line-height: 1.4;
          margin-bottom: 15px;
          color: #555;
        }
        .signature-row {
          display: flex;
          justify-content: space-between;
          margin-top: 25px;
        }
        .signature-group {
          flex: 1;
          padding: 0 8px;
        }
        .signature-line {
          border-top: 1px solid #333;
          height: 1px;
          margin-top: 30px;
        }
        .signature-label {
          font-size: 11px;
          color: #555;
          margin-top: 4px;
        }
        .footer {
          text-align: center;
          margin-top: 30px;
          font-size: 9px;
          color: #777;
          border-top: 1px solid #ccc;
          padding-top: 8px;
        }
        .photo-container {
          width: 100px;
          height: 100px;
          border: 1px solid #333;
          margin-bottom: 10px;
          display: flex;
          align-items: center;
          justify-content: center;
          overflow: hidden;
        }
        .photo-container img {
          max-width: 100%;
          max-height: 100%;
          object-fit: cover;
        }
        .photo-placeholder {
          width: 100%;
          height: 100%;
          display: flex;
          align-items: center;
          justify-content: center;
          background-color: #f0f0f0;
          font-size: 10px;
        }
        @media screen {
          .form-container {
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            background: white;
            margin: 15px;
          }
        }
      `}),i.jsxs("div",{className:"form-container",children:[i.jsxs("div",{className:"header",children:[i.jsx("h1",{children:"SCHOOL MANAGEMENT SYSTEM"}),i.jsx("p",{children:"Student Admission Form"})]}),i.jsxs("div",{className:"section",children:[i.jsx("div",{className:"section-title",children:"Student Information"}),i.jsx("div",{className:"student-info-row mb-4",children:i.jsx("div",{className:"photo-section",children:i.jsx("div",{className:"photo-container",children:i.jsx("img",{src:MO,alt:"Student"})})})}),i.jsxs("div",{className:"compact-row",children:[i.jsxs("div",{className:"compact-group",children:[i.jsx("div",{className:"form-label small-text",children:"GR Number"}),i.jsx("div",{className:"form-value",children:n.grNo||""})]}),i.jsxs("div",{className:"compact-group",children:[i.jsx("div",{className:"form-label small-text",children:"Student Name"}),i.jsxs("div",{className:"form-value",children:[n.firstName||""," ",n.lastName||""]})]}),i.jsxs("div",{className:"compact-group",children:[i.jsx("div",{className:"form-label small-text",children:"Father's Name"}),i.jsx("div",{className:"form-value",children:n.fatherName||""})]}),i.jsxs("div",{className:"compact-group",children:[i.jsx("div",{className:"form-label small-text",children:"Religion"}),i.jsx("div",{className:"form-value",children:n.religion||""})]})]}),i.jsxs("div",{className:"compact-row",children:[i.jsxs("div",{className:"compact-group",children:[i.jsx("div",{className:"form-label small-text",children:"Date of Birth"}),i.jsx("div",{className:"form-value",children:u(n.dateOfBirth)||""})]}),i.jsxs("div",{className:"compact-group",children:[i.jsx("div",{className:"form-label small-text",children:"Place of Birth"}),i.jsx("div",{className:"form-value",children:n.birthPlace||""})]}),i.jsxs("div",{className:"compact-group",children:[i.jsx("div",{className:"form-label small-text",children:"Date of Admission"}),i.jsx("div",{className:"form-value",children:u(n.dateOfAdmission)||""})]}),i.jsxs("div",{className:"compact-group",children:[i.jsx("div",{className:"form-label small-text",children:"Class/Section"}),i.jsxs("div",{className:"form-value",children:[n.class||""," - ",n.section||""]})]})]}),i.jsx("div",{className:"form-row",children:i.jsxs("div",{className:"form-group full-width",children:[i.jsx("div",{className:"form-label small-text",children:"Address"}),i.jsx("div",{className:"form-value",children:n.address||""})]})}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group half-width",children:[i.jsx("div",{className:"form-label small-text",children:"Last Attended School"}),i.jsx("div",{className:"form-value",children:n.lastSchoolAttended||""})]}),n.isTransferStudent&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"form-group third-width",children:[i.jsx("div",{className:"form-label small-text",children:"Date of Removal"}),i.jsx("div",{className:"form-value",children:u(n.dateOfLeaving)||""})]}),i.jsxs("div",{className:"form-group third-width",children:[i.jsx("div",{className:"form-label small-text",children:"Class at Removal"}),i.jsx("div",{className:"form-value",children:n.classInWhichLeft||""})]})]}),i.jsxs("div",{className:"form-group half-width",children:[i.jsx("div",{className:"form-label small-text",children:"Remarks"}),i.jsx("div",{className:"form-value",children:n.remarks||""})]})]}),n.isTransferStudent&&i.jsx("div",{className:"form-row",children:i.jsxs("div",{className:"form-group full-width",children:[i.jsx("div",{className:"form-label small-text",children:"Reason for Leaving"}),i.jsx("div",{className:"form-value",children:n.reasonOfLeaving||""})]})})]}),s?i.jsxs("div",{className:"section fee-section",children:[i.jsx("div",{className:"section-title",children:"Fee Information"}),i.jsxs("div",{className:"form-row",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("div",{className:"form-label small-text",children:"Admission Fees"}),i.jsxs("div",{className:"form-value",children:["Rs. ",n.admissionFees||"0"]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("div",{className:"form-label small-text",children:"Monthly Fees"}),i.jsxs("div",{className:"form-value",children:["Rs. ",n.monthlyFees||"0"]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("div",{className:"form-label small-text",children:"Fees Paid"}),i.jsxs("div",{className:"form-value",children:["Rs. ",n.feesPaid||"0"]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("div",{className:"form-label small-text",children:"Total Fees"}),i.jsxs("div",{className:"form-value",children:["Rs. ",n.totalFees||"0"]})]})]})]}):i.jsxs("div",{className:"section",children:[i.jsx("div",{className:"section-title",children:"Funding Information"}),i.jsx("div",{className:"form-row",children:i.jsxs("div",{className:"form-group full-width",children:[i.jsx("div",{className:"form-label small-text",children:"Funding Status"}),i.jsx("div",{className:"form-value",children:"This school is funded by quarterly NGO subsidies. No fees are charged to students."})]})})]}),i.jsxs("div",{className:"declaration",children:[i.jsx("div",{className:"section-title x-small-text",children:"Declaration"}),i.jsx("div",{className:"declaration-text x-small-text",children:"I hereby declare that the information provided above is true and correct to the best of my knowledge. I understand that providing false information may lead to cancellation of admission."}),i.jsxs("div",{className:"signature-row",children:[i.jsxs("div",{className:"signature-group",children:[i.jsx("div",{className:"signature-line"}),i.jsx("div",{className:"signature-label x-small-text",children:"Parent/Guardian Signature"})]}),i.jsxs("div",{className:"signature-group",children:[i.jsx("div",{className:"signature-line"}),i.jsxs("div",{className:"signature-label x-small-text",children:["Date: ",e]})]})]})]}),i.jsx("div",{className:"footer x-small-text",children:i.jsxs("p",{children:["Form Generated on: ",e," | This is an official document of School Management System"]})})]})]})},IO={grNo:[{type:"length",minLength:0,maxLength:20}],firstName:[{type:"required",errorMessage:"First name is required"},{type:"length",minLength:2,maxLength:50,errorMessage:"First name must be between 2 and 50 characters"}],lastName:[{type:"required",errorMessage:"Last name is required"},{type:"length",minLength:2,maxLength:50,errorMessage:"Last name must be between 2 and 50 characters"}],fatherName:[{type:"required",errorMessage:"Father name is required"},{type:"length",minLength:2,maxLength:50,errorMessage:"Father name must be between 2 and 50 characters"}],dateOfBirth:[{type:"required",errorMessage:"Date of birth is required"},{type:"date",errorMessage:"Please enter a valid date"}],dateOfAdmission:[{type:"required",errorMessage:"Date of admission is required"},{type:"date",errorMessage:"Please enter a valid date"}],admissionFees:[{type:"number",min:0}],monthlyFees:[{type:"number",min:0}],feesPaid:[{type:"number",min:0}],totalFees:[{type:"number",min:0}],class:[{type:"required",errorMessage:"Class is required"}],section:[{type:"required",errorMessage:"Section is required"}],religion:[{type:"required",errorMessage:"Religion is required"}],address:[{type:"required",errorMessage:"Address is required"},{type:"length",minLength:5,maxLength:200,errorMessage:"Address must be between 5 and 200 characters"}],birthPlace:[{type:"length",minLength:1,maxLength:50,errorMessage:"Birth place must be between 1 and 50 characters"}],lastSchoolAttended:[{type:"length",minLength:0,maxLength:100,errorMessage:"Last school attended must be less than 100 characters"}],classInWhichLeft:[{type:"length",minLength:0,maxLength:50,errorMessage:"Class in which left must be less than 50 characters"}],reasonOfLeaving:[{type:"length",minLength:0,maxLength:100,errorMessage:"Reason of leaving must be less than 100 characters"}],remarks:[{type:"length",minLength:0,maxLength:200,errorMessage:"Remarks must be less than 200 characters"}],parentContact:[{type:"pattern",pattern:/^(0[0-9]{10}|[0-9]{10})$/,errorMessage:"Please enter a valid Pakistani phone number (0xxxxxxxxxx or xxxxxxxxxx)"}]},OO=()=>{const n=Pn(),a=Cd(),t=Fh(),{classes:r}=rr(ge=>ge.classes),{students:s}=rr(ge=>ge.students);Eh();const e=ne.useRef(null),u=t.state?.studentData,f=!!u,[m,g]=ne.useState({grNo:"",firstName:"",fatherName:"",lastName:"",photo:"",address:"",dateOfBirth:null,birthPlace:"",dateOfAdmission:new Date,class:"",section:"",admissionFees:"",monthlyFees:"",feesPaid:"",totalFees:"",lastSchoolAttended:"",isTransferStudent:!1,dateOfLeaving:null,classInWhichLeft:"",reasonOfLeaving:"",remarks:"",religion:"Islam",parentContact:""}),[b,j]=ne.useState(null),[F,C]=ne.useState(null),[M,_]=ne.useState(!1),[L,T]=ne.useState({});ne.useEffect(()=>{n(gd()),n(Lc())},[n]),ne.useEffect(()=>{!f&&s&&!m.grNo&&g(ge=>({...ge,grNo:""}))},[s,f]),ne.useEffect(()=>{if(u){let ge=!1;u.dateOfLeaving&&u.dateOfLeaving.toString().trim()!==""&&(ge=!0),u.classInWhichLeft&&u.classInWhichLeft.toString().trim()!==""&&(ge=!0),u.reasonOfLeaving&&u.reasonOfLeaving.toString().trim()!==""&&(ge=!0);const fe=ke=>{if(!ke)return null;try{if(ke instanceof Date)return isNaN(ke.getTime())?null:ke;if(typeof ke=="string"){if(ke.trim()==="")return null;const Ne=new Date(ke);return isNaN(Ne.getTime())?null:Ne}const he=new Date(ke);return isNaN(he.getTime())?null:he}catch{return null}};g({...u,dateOfBirth:fe(u.dateOfBirth),dateOfAdmission:fe(u.dateOfAdmission)||new Date,dateOfLeaving:fe(u.dateOfLeaving),isTransferStudent:ge,religion:u.religion||"Islam",parentContact:u.parentContact||""}),u.photo&&j(u.photo)}},[u]);const H=ge=>{const{name:fe,value:ke,type:he,checked:Ne}=ge.target,xe=he==="checkbox"?Ne:ke;if(fe==="admissionFees"||fe==="monthlyFees"){const we=fe==="admissionFees"?xe:m.admissionFees,ye=fe==="monthlyFees"?xe:m.monthlyFees,te=(parseFloat(we)||0)+(parseFloat(ye)||0);g({...m,[fe]:xe,totalFees:te.toString()})}else if(fe==="class"){const we=r.find(X=>X.name===xe),ye=we?.admissionFees||"",te=we?.monthlyFees||"",V=(parseFloat(ye)||0)+(parseFloat(te)||0),de=(we?.sections||[]).find(X=>X.name==="A");g({...m,class:xe,section:de?"A":"",admissionFees:ye.toString(),monthlyFees:te.toString(),totalFees:V.toString()})}else g({...m,[fe]:xe});L[fe]&&T(we=>{const ye={...we};return delete ye[fe],ye})},O=(ge,fe)=>{g({...m,[fe]:ge}),L[fe]&&T(ke=>{const he={...ke};return delete he[fe],he})},Q=async ge=>{const fe=ge.target.files[0];if(fe){if(!fe.type.startsWith("image/")){alert("Please select an image file (JPEG, PNG, etc.)");return}if(fe.size>5*1024*1024){alert("File size exceeds 5MB limit");return}C(fe);const ke=new FileReader;ke.onloadend=()=>{j(ke.result)},ke.readAsDataURL(fe)}},Z=()=>{j(null),C(null),e.current&&(e.current.value="")},ee=()=>{const ge={...IO};f||(ge.grNo=[{type:"length",minLength:1,maxLength:20}]),ge.dateOfLeaving=[{type:"date"}],ge.classInWhichLeft=[{type:"length",minLength:0,maxLength:50}],ge.reasonOfLeaving=[{type:"length",minLength:0,maxLength:100}];const fe=UO(m,ge);return T(fe),Object.keys(fe).length===0},se=async ge=>{if(ge.preventDefault(),!!ee())try{let fe=b||"";if(F){const xe=new FormData;xe.append("photo",F);try{const we=await fetch(b7,{method:"POST",body:xe});if(!we.ok)throw new Error(`HTTP error! status: ${we.status}`);const ye=await we.json();if(ye.success)fe=ye.url,console.log("Photo uploaded successfully:",ye.url);else{console.error("Photo upload failed:",ye.error),alert("Failed to upload photo: "+ye.error);return}}catch(we){console.error("Photo upload error:",we),alert("Failed to upload photo. Please try again. Error: "+we.message);return}}else b?b.startsWith("http")?(fe=b,console.log("Using existing photo URL:",b)):b.startsWith("data:")&&(fe="",console.log("Clearing data URL photo")):(fe="",console.log("No photo provided, clearing photo field"));const ke=xe=>{if(!xe)return"";try{if(xe instanceof Date)return isNaN(xe.getTime())?"":xe.toISOString().split("T")[0];if(typeof xe=="string"){if(xe.trim()==="")return"";const ye=new Date(xe);return isNaN(ye.getTime())?"":ye.toISOString().split("T")[0]}const we=new Date(xe);return isNaN(we.getTime())?"":we.toISOString().split("T")[0]}catch{return""}},he=xe=>{if(!xe)return"";let we=xe.replace(/\D/g,"");return we.startsWith("0")&&we.length===11?"+92"+we.substring(1):we.length===10&&!we.startsWith("0")?"+92"+we:we.startsWith("92")&&we.length===12?"+"+we:xe},Ne={...m,dateOfBirth:ke(m.dateOfBirth),dateOfAdmission:ke(m.dateOfAdmission),dateOfLeaving:ke(m.dateOfLeaving),parentContact:he(m.parentContact),photo:fe};m.isTransferStudent||(Ne.dateOfLeaving="",Ne.classInWhichLeft="",Ne.reasonOfLeaving=""),console.log("Submitting student data:",Ne),n(f?a0({...u,...Ne,id:u.id}):uC(Ne)),a("/batches")}catch(fe){console.error("Form submission error:",fe),alert("Failed to submit form. Please try again.")}},ue=()=>{ee()&&_(!0)},ae=()=>{_(!1)},pe=()=>{window.print()},z=[...new Set(r.map(ge=>ge.name))],J=m.class?r.find(ge=>ge.name===m.class)?.sections||[]:[];return M?i.jsxs("div",{className:"inset-0 bg-white z-50 p-0 m-0",children:[i.jsxs("div",{className:"print-header sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center no-print",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Print Admission Form"}),i.jsxs("div",{className:"print-actions flex space-x-2 no-print",children:[i.jsx("button",{onClick:pe,className:"print-button inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 no-print",children:"Print"}),i.jsx("button",{onClick:ae,className:"print-button text-gray-500 hover:text-gray-700 no-print",children:i.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),i.jsx("div",{className:"py-6 px-6",children:i.jsx(L6,{formData:m,photoPreview:b})}),i.jsx("style",{children:`
          @media print {
            @page {
              margin: 0.5in;
              size: A4;
            }
            body {
              margin: 0;
              padding: 0;
              font-size: 12pt;
              font-family: Arial, Helvetica, sans-serif;
            }
            .no-print {
              display: none !important;
            }
            /* Hide all non-essential elements when printing */
            .print-header, .print-button, .print-actions {
              display: none !important;
            }
            /* Ensure clean print view */
            .form-container {
              box-shadow: none !important;
              margin: 0 !important;
              padding: 0 !important;
            }
          }
        `})]}):i.jsx("div",{className:`min-h-screen ${M?"bg-white":"bg-gray-50"}`,children:i.jsx("main",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:M?i.jsx(L6,{formData:m,photoPreview:b}):i.jsxs("div",{className:"space-y-6",children:[i.jsx(jd,{title:f?"Edit Student":"New Student Admission",subtitle:f?"Update student information":"Add a new student to the system",backButton:i.jsxs("button",{onClick:()=>a("/students"),className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(o5,{className:"mr-2"})," Back to Students"]}),actionButton:i.jsxs("button",{onClick:ue,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(mi,{className:"mr-2"})," Print Form"]})}),i.jsxs("form",{onSubmit:se,className:"space-y-6",children:[i.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsx("div",{className:"md:col-span-3",children:i.jsxs("div",{className:"flex flex-col items-start space-y-4 mb-6",children:[i.jsx("div",{className:"flex-shrink-0",children:b?i.jsx("img",{src:b,alt:"Student Preview",className:"h-24 w-24 rounded-xl object-cover border-2 border-gray-300 shadow-sm"}):i.jsx("div",{className:"bg-gray-100 border-2 border-dashed border-gray-300 rounded-xl w-24 h-24 flex items-center justify-center",children:i.jsx(ep,{className:"h-6 w-6 text-gray-400"})})}),i.jsxs("div",{className:"flex flex-col space-y-3",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("input",{type:"file",ref:e,onChange:Q,accept:"image/*",className:"hidden"}),i.jsxs("button",{type:"button",onClick:()=>e.current?.click(),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200",children:[i.jsx(ep,{className:"mr-2 h-4 w-4"}),b?"Change Photo":"Upload Photo"]}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"JPEG, PNG up to 5MB"})]}),b&&i.jsx("button",{type:"button",onClick:Z,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition",children:"Remove Photo"})]})]})}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"GR Number"}),i.jsx("input",{type:"text",name:"grNo",value:m.grNo,onChange:H,className:`block w-full px-4 py-2.5 border ${L.grNo?"border-red-300":"border-gray-300"} rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 transition`,placeholder:"Enter GR Number (optional)"}),L.grNo&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:L.grNo})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),i.jsx("input",{type:"text",name:"firstName",value:m.firstName,onChange:H,className:`block w-full px-4 py-2.5 border ${L.firstName?"border-red-300":"border-gray-300"} rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 transition`,placeholder:"Enter Student Name"}),L.firstName&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:L.firstName})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name"}),i.jsx("input",{type:"text",name:"lastName",value:m.lastName,onChange:H,className:`block w-full px-4 py-2.5 border ${L.lastName?"border-red-300":"border-gray-300"} rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 transition`,placeholder:"Enter Student Name"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Father's Name"}),i.jsx("input",{type:"text",name:"fatherName",value:m.fatherName,onChange:H,className:`block w-full px-4 py-2.5 border ${L.fatherName?"border-red-300":"border-gray-300"} rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 transition`,placeholder:"Enter Father's Name"}),L.fatherName&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:L.fatherName})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Parent Contact Number"}),i.jsx("input",{type:"tel",name:"parentContact",value:m.parentContact,onChange:H,className:`block w-full px-4 py-2.5 border ${L.parentContact?"border-red-300":"border-gray-300"} rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 transition`,placeholder:"Enter Parent Contact Number"}),L.parentContact&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:L.parentContact})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Religion"}),i.jsxs("select",{name:"religion",value:m.religion,onChange:H,className:`block w-full px-4 py-2.5 border ${L.religion?"border-red-300":"border-gray-300"} rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 transition`,children:[i.jsx("option",{value:"",children:"Select Religion"}),i.jsx("option",{value:"Islam",children:"Islam"}),i.jsx("option",{value:"Hindu",children:"Hindu"}),i.jsx("option",{value:"Christian",children:"Christian"}),i.jsx("option",{value:"Others",children:"Others"})]}),L.religion&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:L.religion})]}),i.jsx("div",{className:"md:col-span-1",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(fA,{className:"h-5 w-5 text-gray-400"})}),i.jsxs("select",{name:"class",value:m.class,onChange:H,className:`block w-full pl-10 pr-3 py-2 border ${L.class?"border-red-300":"border-gray-300"} rounded-md focus:ring-blue-500 focus:border-blue-500`,children:[i.jsx("option",{value:"",children:"Select Class"}),z.map(ge=>i.jsx("option",{value:ge,children:ge},ge))]})]}),L.class&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:L.class})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Section"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(fA,{className:"h-5 w-5 text-gray-400"})}),i.jsxs("select",{name:"section",value:m.section,onChange:H,disabled:!m.class,className:`block w-full pl-10 pr-3 py-2 border ${L.section?"border-red-300":"border-gray-300"} rounded-md focus:ring-blue-500 focus:border-blue-500 ${m.class?"":"bg-gray-100"}`,children:[i.jsx("option",{value:"",children:"Select Section"}),J.map(ge=>i.jsx("option",{value:ge.name,children:ge.name},ge.id))]})]}),L.section&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:L.section})]})]})}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),i.jsx("input",{type:"text",name:"address",value:m.address,onChange:H,className:`block w-full px-4 py-2 border ${L.address?"border-red-300":"border-gray-300"} rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 transition`,placeholder:"Enter Full Address"}),L.address&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:L.address})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date of Birth"}),i.jsxs("div",{className:`relative rounded-lg shadow-sm ${L.dateOfBirth?"border border-red-300 rounded-lg":""}`,children:[i.jsx(z1,{selected:m.dateOfBirth,onChange:ge=>O(ge,"dateOfBirth"),className:`block w-full px-4 py-2.5 border ${L.dateOfBirth?"border-red-300":"border-gray-300"} rounded-lg focus:ring-blue-500 focus:border-blue-500 transition`,placeholderText:"Select Date of Birth",showYearDropdown:!0,scrollableYearDropdown:!0,yearDropdownItemNumber:100}),i.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:i.jsx(xd,{className:"h-5 w-5 text-gray-400"})})]}),L.dateOfBirth&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:L.dateOfBirth})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Place of Birth"}),i.jsx("input",{type:"text",name:"birthPlace",value:m.birthPlace,onChange:H,className:`block w-full px-4 py-2.5 border ${L.birthPlace?"border-red-300":"border-gray-300"} rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 transition`,placeholder:"Enter Place of Birth"}),L.birthPlace&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:L.birthPlace})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date of Admission"}),i.jsxs("div",{className:`relative rounded-lg shadow-sm ${L.dateOfAdmission?"border border-red-300 rounded-lg":""}`,children:[i.jsx(z1,{selected:m.dateOfAdmission,onChange:ge=>O(ge,"dateOfAdmission"),className:`block w-full px-4 py-2.5 border ${L.dateOfAdmission?"border-red-300":"border-gray-300"} rounded-lg focus:ring-blue-500 focus:border-blue-500 transition`,placeholderText:"Select Date of Admission",showYearDropdown:!0,scrollableYearDropdown:!0,yearDropdownItemNumber:100}),i.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:i.jsx(xd,{className:"h-5 w-5 text-gray-400"})})]}),L.dateOfAdmission&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:L.dateOfAdmission})]}),i.jsx("div",{className:"md:col-span-3 bg-gray-50 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",id:"isTransferStudent",name:"isTransferStudent",checked:m.isTransferStudent,onChange:H,className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),i.jsx("label",{htmlFor:"isTransferStudent",className:"ml-2 block text-sm font-medium text-gray-700",children:"Student is transferring from another school"}),i.jsx(sw,{className:"ml-2 h-4 w-4 text-blue-500",title:"Check this box if the student is coming from another school"})]})}),m.isTransferStudent&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Attended School"}),i.jsx("input",{type:"text",name:"lastSchoolAttended",value:m.lastSchoolAttended,onChange:H,className:`block w-full px-4 py-2.5 border ${L.lastSchoolAttended?"border-red-300":"border-gray-300"} rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 transition`,placeholder:"Enter Last School Attended"}),L.lastSchoolAttended&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:L.lastSchoolAttended})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Date of Removal Last School ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsxs("div",{className:`relative rounded-lg shadow-sm ${L.dateOfLeaving?"border border-red-300 rounded-lg":""}`,children:[i.jsx(z1,{selected:m.dateOfLeaving,onChange:ge=>O(ge,"dateOfLeaving"),className:`block w-full px-4 py-2.5 border ${L.dateOfLeaving?"border-red-300":"border-gray-300"} rounded-lg focus:ring-blue-500 focus:border-blue-500 transition`,placeholderText:"Select Date of Removal",showYearDropdown:!0,scrollableYearDropdown:!0,yearDropdownItemNumber:100}),i.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:i.jsx(xd,{className:"h-5 w-5 text-gray-400"})})]}),L.dateOfLeaving&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:L.dateOfLeaving})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Last Class in Previous School ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",name:"classInWhichLeft",value:m.classInWhichLeft,onChange:H,className:`block w-full px-4 py-2.5 border ${L.classInWhichLeft?"border-red-300":"border-gray-300"} rounded-lg focus:ring-blue-500 focus:border-blue-500 transition`,placeholder:"Enter Class at time of removal"}),L.classInWhichLeft&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:L.classInWhichLeft})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Reason for leaving Last School ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",name:"reasonOfLeaving",value:m.reasonOfLeaving,onChange:H,className:`block w-full px-4 py-2.5 border ${L.reasonOfLeaving?"border-red-300":"border-gray-300"} rounded-lg focus:ring-blue-500 focus:border-blue-500 transition`,placeholder:"Enter Reason for leaving"}),L.reasonOfLeaving&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:L.reasonOfLeaving})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last School Remarks"}),i.jsx("input",{type:"text",name:"remarks",value:m.remarks,onChange:H,className:`block w-full px-4 py-2.5 border ${L.remarks?"border-red-300":"border-gray-300"} rounded-lg focus:ring-blue-500 focus:border-blue-500 transition`,placeholder:"Enter Remarks"}),L.remarks&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:L.remarks})]})]})]})}),i.jsx(md,{showFor:"traditional",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4 border-b border-gray-200 pb-2",children:"Fee Information"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Admission Fees"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(bd,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"number",name:"admissionFees",value:m.admissionFees,onChange:H,className:`block w-full pl-10 pr-3 py-2.5 border ${L.admissionFees?"border-red-300":"border-gray-300"} rounded-lg focus:ring-blue-500 focus:border-blue-500 transition`,placeholder:"Enter Admission Fees"})]}),L.admissionFees&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:L.admissionFees})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Monthly Fees"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(bd,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"number",name:"monthlyFees",value:m.monthlyFees,onChange:H,className:`block w-full pl-10 pr-3 py-2.5 border ${L.monthlyFees?"border-red-300":"border-gray-300"} rounded-lg focus:ring-blue-500 focus:border-blue-500 transition`,placeholder:"Enter Monthly Fees"})]}),L.monthlyFees&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:L.monthlyFees})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Total Fees"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(bd,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"number",name:"totalFees",value:m.totalFees,onChange:H,readOnly:!0,className:`block w-full pl-10 pr-3 py-2.5 border ${L.totalFees?"border-red-300":"border-gray-300"} rounded-lg focus:ring-blue-500 focus:border-blue-500 transition bg-gray-100`,placeholder:"Total Fees (Auto-calculated)"})]}),L.totalFees&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:L.totalFees})]})]})]})}),i.jsx(md,{showFor:"ngo",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4 border-b border-gray-200 pb-2",children:"NGO Funding"}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:i.jsx("div",{className:"md:col-span-4",children:i.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-500 p-4 rounded",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx(sw,{className:"h-5 w-5 text-blue-500"})}),i.jsx("div",{className:"ml-3",children:i.jsx("p",{className:"text-sm text-blue-700",children:"This school is funded by quarterly NGO subsidies. No fees are charged to students."})})]})})})})]})}),i.jsxs("div",{className:"flex justify-end space-x-4 pt-6",children:[i.jsx("button",{type:"button",onClick:()=>a("/batches"),className:"inline-flex items-center px-5 py-2.5 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition",children:"Cancel"}),i.jsxs("button",{type:"button",onClick:ue,className:"inline-flex items-center px-5 py-2.5 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition",children:[i.jsx(mi,{className:"mr-2"}),"Print Form"]}),i.jsx("button",{type:"submit",className:"inline-flex items-center px-5 py-2.5 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200",children:f?"Update Student":"Save Student"})]})]})]})})})},QO=()=>{const n=Pn(),a=Cd(),{loading:t,error:r}=rr(L=>L.users),s=rr(L=>L.settings.schoolInfo),e=s?.schoolName||s?.name||"School Management System",[u,f]=ne.useState({username:"",password:""}),[m,g]=ne.useState({}),[b,j]=ne.useState(!0),F=L=>{const{name:T,value:H}=L.target;f({...u,[T]:H}),m[T]&&g(O=>{const Q={...O};return delete Q[T],Q})},C=()=>{const L={};return u.username.trim()||(L.username="Username is required"),u.password?u.password.length<6&&(L.password="Password must be at least 6 characters"):L.password="Password is required",g(L),Object.keys(L).length===0},M=async L=>{if(L.preventDefault(),!!C())try{(await n(f2({username:u.username,password:u.password}))).type==="users/loginUser/fulfilled"?a("/"):g({general:"Invalid username or password"})}catch{g({general:"Login failed. Please try again."})}},_=(L,T)=>{f({username:L,password:T}),g({})};return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:i.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl overflow-hidden",children:[i.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-700 p-8 text-center",children:[i.jsx("div",{className:"flex justify-center mb-4",children:i.jsx("div",{className:"bg-white p-3 rounded-full",children:i.jsx(fA,{className:"text-blue-600 text-3xl"})})}),i.jsx("h1",{className:"text-2xl font-bold text-white",children:e}),i.jsx("p",{className:"text-blue-100 mt-2",children:"Sign in to your account"})]}),i.jsxs("div",{className:"p-8",children:[m.general&&i.jsx("div",{className:"mb-6 bg-red-50 border-l-4 border-red-500 p-4 rounded",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),i.jsx("div",{className:"ml-3",children:i.jsx("p",{className:"text-sm text-red-700",children:m.general})})]})}),r&&i.jsx("div",{className:"mb-6 bg-red-50 border-l-4 border-red-500 p-4 rounded",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),i.jsx("div",{className:"ml-3",children:i.jsx("p",{className:"text-sm text-red-700",children:r})})]})}),i.jsxs("form",{onSubmit:M,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Pi,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{id:"username",name:"username",type:"text",value:u.username,onChange:F,className:`block w-full pl-10 pr-3 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition ${m.username?"border-red-500":"border-gray-300"}`,placeholder:"Enter your username"})]}),m.username&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.username})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Wk,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{id:"password",name:"password",type:"password",value:u.password,onChange:F,className:`block w-full pl-10 pr-3 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition ${m.password?"border-red-500":"border-gray-300"}`,placeholder:"Enter your password"})]}),m.password&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.password})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{id:"remember-me",name:"remember-me",type:"checkbox",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),i.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-700",children:"Remember me"})]}),i.jsx("div",{className:"text-sm",children:i.jsx("a",{href:"#",className:"font-medium text-blue-600 hover:text-blue-500",children:"Forgot password?"})})]}),i.jsx("div",{children:i.jsx("button",{type:"submit",disabled:t,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-600 to-indigo-700 hover:from-blue-700 hover:to-indigo-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition",children:t?i.jsxs(i.Fragment,{children:[i.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing in..."]}):"Sign in"})})]}),i.jsxs("div",{className:"mt-8",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Demo Credentials"}),i.jsx("button",{onClick:()=>j(!b),className:"text-sm text-blue-600 hover:text-blue-800",children:b?"Hide":"Show"})]}),b&&i.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[i.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:"Owner"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Full access to all system features including financial information"})]}),i.jsx("button",{onClick:()=>_("owner","owner123"),className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded hover:bg-blue-200 transition",children:"Use"})]}),i.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[i.jsxs("p",{children:["Username: ",i.jsx("span",{className:"font-mono",children:"owner"})]}),i.jsxs("p",{children:["Password: ",i.jsx("span",{className:"font-mono",children:"owner123"})]})]})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:"Admin"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Access to all features except financial information"})]}),i.jsx("button",{onClick:()=>_("admin","admin123"),className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded hover:bg-blue-200 transition",children:"Use"})]}),i.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[i.jsxs("p",{children:["Username: ",i.jsx("span",{className:"font-mono",children:"admin"})]}),i.jsxs("p",{children:["Password: ",i.jsx("span",{className:"font-mono",children:"admin123"})]})]})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:"Teacher"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Access only to marksheets and reports"})]}),i.jsx("button",{onClick:()=>_("teacher","teacher123"),className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded hover:bg-blue-200 transition",children:"Use"})]}),i.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[i.jsxs("p",{children:["Username: ",i.jsx("span",{className:"font-mono",children:"teacher"})]}),i.jsxs("p",{children:["Password: ",i.jsx("span",{className:"font-mono",children:"teacher123"})]})]})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:"Staff"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Access to fees, marksheets, certificates, reports, attendance, and student management"})]}),i.jsx("button",{onClick:()=>_("staff","staff123"),className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded hover:bg-blue-200 transition",children:"Use"})]}),i.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[i.jsxs("p",{children:["Username: ",i.jsx("span",{className:"font-mono",children:"staff"})]}),i.jsxs("p",{children:["Password: ",i.jsx("span",{className:"font-mono",children:"staff123"})]})]})]})]})]})]})]})})},RO=({isOpen:n,onClose:a})=>n?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[i.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-700 px-6 py-4 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx(nc,{className:"text-white text-xl mr-3"}),i.jsx("h2",{className:"text-xl font-bold text-white",children:"School Management System - Complete Guide"})]}),i.jsx("button",{onClick:a,className:"text-white hover:text-gray-200 focus:outline-none",children:i.jsx(vd,{className:"text-xl"})})]}),i.jsx("div",{className:"overflow-y-auto flex-grow p-6",children:i.jsxs("div",{className:"prose max-w-none",children:[i.jsx("p",{className:"text-gray-600 mb-6",children:"This comprehensive guide explains all features and functionalities of the School Management System."}),i.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 mb-6",children:[i.jsxs("h3",{className:"font-bold text-blue-800 mb-2 flex items-center",children:[i.jsx(f5,{className:"mr-2"})," Table of Contents"]}),i.jsxs("ul",{className:"list-disc pl-5 space-y-1 text-blue-700",children:[i.jsx("li",{children:i.jsx("a",{href:"#overview",className:"hover:underline",children:"System Overview"})}),i.jsx("li",{children:i.jsx("a",{href:"#navigation",className:"hover:underline",children:"Navigation & Menu Structure"})}),i.jsx("li",{children:i.jsx("a",{href:"#students",className:"hover:underline",children:"Students Management"})}),i.jsx("li",{children:i.jsx("a",{href:"#classes",className:"hover:underline",children:"Classes Management"})}),i.jsx("li",{children:i.jsx("a",{href:"#staff",className:"hover:underline",children:"Staff Management"})}),i.jsx("li",{children:i.jsx("a",{href:"#fees",className:"hover:underline",children:"Fees Management"})}),i.jsx("li",{children:i.jsx("a",{href:"#expenses",className:"hover:underline",children:"Expenses Tracking"})}),i.jsx("li",{children:i.jsx("a",{href:"#ngo",className:"hover:underline",children:"NGO Subsidies"})}),i.jsx("li",{children:i.jsx("a",{href:"#financial",className:"hover:underline",children:"Financial Reporting"})}),i.jsx("li",{children:i.jsx("a",{href:"#settings",className:"hover:underline",children:"Settings & Configuration"})}),i.jsx("li",{children:i.jsx("a",{href:"#printing",className:"hover:underline",children:"Printing & Export Features"})}),i.jsx("li",{children:i.jsx("a",{href:"#workflow",className:"hover:underline",children:"Step-by-Step Workflow Guide"})})]})]}),i.jsxs("section",{id:"overview",className:"mb-8",children:[i.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-3 flex items-center",children:[i.jsx(ij,{className:"mr-2 text-blue-600"})," System Overview"]}),i.jsx("p",{className:"mb-3",children:"The School Management System is a comprehensive digital solution designed to streamline all administrative tasks for educational institutions. The system supports two distinct school models:"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[i.jsx("h4",{className:"font-bold text-green-800 mb-2",children:"Traditional Schools"}),i.jsx("p",{className:"text-green-700 text-sm",children:"Collect monthly fees from students. Features include challan generation, payment processing, and detailed fee tracking."})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[i.jsx("h4",{className:"font-bold text-blue-800 mb-2",children:"NGO-Funded Schools"}),i.jsx("p",{className:"text-blue-700 text-sm",children:"Operate with quarterly subsidies from NGOs. No student fees are collected. Track NGO subsidies and expenses exclusively."})]})]}),i.jsx("p",{children:"The system automatically adjusts its interface and available features based on the school's funding model, ensuring only relevant functionality is displayed."})]}),i.jsxs("section",{id:"navigation",className:"mb-8",children:[i.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-3 flex items-center",children:[i.jsx(nc,{className:"mr-2 text-blue-600"})," Navigation & Menu Structure"]}),i.jsx("p",{className:"mb-3",children:"The application features a clean, intuitive navigation system with a sidebar menu containing all main sections:"}),i.jsxs("ul",{className:"list-disc pl-5 space-y-2 mb-4",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Dashboard"})," - Overview of key metrics and recent activities"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Students"})," - Comprehensive student management with dropdown submenu:",i.jsxs("ul",{className:"list-circle pl-5 mt-1",children:[i.jsx("li",{children:"All Students - Main student listing and management"}),i.jsx("li",{children:"Attendance - Track student attendance records"}),i.jsx("li",{children:"Reports - Generate student performance reports"}),i.jsx("li",{children:"Marksheets - Manage student academic records"}),i.jsx("li",{children:"Certificates - Generate student certificates"}),i.jsx("li",{children:"Examinations - Manage exam schedules and results"})]})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Classes"})," - Manage class information, sections, and student distribution"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Staff"})," - Staff records, salaries, and position tracking"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Fees"})," - (Traditional schools only) Fee challan generation and payment tracking"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Expenses"})," - Track all school expenditures with category management"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"NGO Subsidies"})," - (NGO schools only) Track quarterly NGO subsidies"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Financial Report"})," - Comprehensive financial overview and analytics"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Settings"})," - (Admin only) Configure school information and preferences"]})]})]}),i.jsxs("section",{id:"students",className:"mb-8",children:[i.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-3 flex items-center",children:[i.jsx(_c,{className:"mr-2 text-blue-600"})," Students Management"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm",children:[i.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Student Admission"}),i.jsx("p",{className:"text-gray-600 text-sm mb-2",children:"Add new students through a comprehensive admission form that includes:"}),i.jsxs("ul",{className:"list-disc pl-5 text-gray-600 text-sm space-y-1",children:[i.jsx("li",{children:"Personal information (name, date of birth, address)"}),i.jsx("li",{children:"Family details and relationships"}),i.jsx("li",{children:"Academic history and current class assignment"}),i.jsx("li",{children:"Photo upload capability"}),i.jsx("li",{children:"Fee information (traditional schools) or funding notice (NGO schools)"})]})]}),i.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm",children:[i.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Student Records"}),i.jsx("p",{className:"text-gray-600 text-sm mb-2",children:"Maintain detailed student records with:"}),i.jsxs("ul",{className:"list-disc pl-5 text-gray-600 text-sm space-y-1",children:[i.jsx("li",{children:"Search and filter capabilities"}),i.jsx("li",{children:"Family relationship tracking"}),i.jsx("li",{children:"Fee history and payment status"}),i.jsx("li",{children:"Academic performance records"}),i.jsx("li",{children:"Attendance tracking"})]})]})]}),i.jsx("p",{className:"text-gray-600",children:"Students can be organized into families, allowing for bulk fee management for siblings or family members."})]}),i.jsxs("section",{id:"classes",className:"mb-8",children:[i.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-3 flex items-center",children:[i.jsx(nc,{className:"mr-2 text-blue-600"})," Classes Management"]}),i.jsx("p",{className:"mb-3",children:"Efficiently manage academic structure with:"}),i.jsxs("ul",{className:"list-disc pl-5 space-y-2 mb-4",children:[i.jsx("li",{children:"Create and manage classes (e.g., Class 1, Class 2, etc.)"}),i.jsx("li",{children:"Define sections within each class (e.g., Section A, Section B)"}),i.jsx("li",{children:"Set monthly fee amounts for each class (traditional schools)"}),i.jsx("li",{children:"Assign subjects and teachers to classes"}),i.jsx("li",{children:"Visualize student distribution across classes and sections"}),i.jsx("li",{children:"Track total student count per class and section"})]}),i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:i.jsxs("p",{className:"text-yellow-800 text-sm",children:[i.jsx("strong",{children:"Note:"})," Classes are automatically populated with students based on their enrollment records. The system maintains real-time student counts for each class and section."]})})]}),i.jsxs("section",{id:"staff",className:"mb-8",children:[i.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-3 flex items-center",children:[i.jsx(up,{className:"mr-2 text-blue-600"})," Staff Management"]}),i.jsx("p",{className:"mb-3",children:"Comprehensive staff administration with:"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[i.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm",children:[i.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Staff Records"}),i.jsxs("ul",{className:"list-disc pl-5 text-gray-600 text-sm space-y-1",children:[i.jsx("li",{children:"Personal and contact information"}),i.jsx("li",{children:"Position and subject assignments"}),i.jsx("li",{children:"Date of joining and employment history"}),i.jsx("li",{children:"Salary and allowance details"})]})]}),i.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm",children:[i.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Financial Management"}),i.jsxs("ul",{className:"list-disc pl-5 text-gray-600 text-sm space-y-1",children:[i.jsx("li",{children:"Salary processing and payment tracking"}),i.jsx("li",{children:"Advance management"}),i.jsx("li",{children:"Historical salary records"}),i.jsx("li",{children:"Total salary expenditure calculation"})]})]}),i.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm",children:[i.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Analytics"}),i.jsxs("ul",{className:"list-disc pl-5 text-gray-600 text-sm space-y-1",children:[i.jsx("li",{children:"Staff distribution by position"}),i.jsx("li",{children:"Salary expenditure analytics"}),i.jsx("li",{children:"Pending salary calculations"}),i.jsx("li",{children:"Prorated salary computations"})]})]})]})]}),i.jsxs("section",{id:"fees",className:"mb-8",children:[i.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-3 flex items-center",children:[i.jsx(bd,{className:"mr-2 text-blue-600"})," Fees Management (Traditional Schools)"]}),i.jsx("p",{className:"mb-3",children:"Robust fee management system designed for traditional fee-collecting schools:"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm",children:[i.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Challan Generation"}),i.jsxs("ul",{className:"list-disc pl-5 text-gray-600 text-sm space-y-1",children:[i.jsx("li",{children:"Individual challan creation for students"}),i.jsx("li",{children:"Bulk challan generation for entire classes"}),i.jsx("li",{children:"Auto-population of fees based on class settings"}),i.jsx("li",{children:"Customizable due dates and descriptions"}),i.jsx("li",{children:"Admission fee and monthly fee tracking"})]})]}),i.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm",children:[i.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Payment Processing"}),i.jsxs("ul",{className:"list-disc pl-5 text-gray-600 text-sm space-y-1",children:[i.jsx("li",{children:"Multiple payment methods (Cash, Bank Transfer, EasyPaisa, JazzCash)"}),i.jsx("li",{children:"Bulk payment status updates"}),i.jsx("li",{children:"Payment history tracking"}),i.jsx("li",{children:"Real-time fee collection analytics"}),i.jsx("li",{children:"Pending vs. paid fee visualization"})]})]})]}),i.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm mb-4",children:[i.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Printing & Export"}),i.jsxs("ul",{className:"list-disc pl-5 text-gray-600 text-sm space-y-1",children:[i.jsx("li",{children:"Thermal printer optimized challan printing"}),i.jsx("li",{children:"Standard printer compatible layouts"}),i.jsx("li",{children:"PDF export functionality"}),i.jsx("li",{children:"CSV export for financial reporting"}),i.jsx("li",{children:"Print preview for verification"})]})]})]}),i.jsxs("section",{id:"expenses",className:"mb-8",children:[i.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-3 flex items-center",children:[i.jsx(Co,{className:"mr-2 text-blue-600"})," Expenses Tracking"]}),i.jsx("p",{className:"mb-3",children:"Complete expense management for all school expenditures:"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm",children:[i.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Expense Recording"}),i.jsxs("ul",{className:"list-disc pl-5 text-gray-600 text-sm space-y-1",children:[i.jsx("li",{children:"Detailed expense descriptions"}),i.jsx("li",{children:"Category-based organization"}),i.jsx("li",{children:"Custom category creation"}),i.jsx("li",{children:"Date tracking and filtering"}),i.jsx("li",{children:"Amount and payment method recording"})]})]}),i.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm",children:[i.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Analytics & Reporting"}),i.jsxs("ul",{className:"list-disc pl-5 text-gray-600 text-sm space-y-1",children:[i.jsx("li",{children:"Category-wise expense breakdown"}),i.jsx("li",{children:"Total expenditure calculations"}),i.jsx("li",{children:"Date range filtering"}),i.jsx("li",{children:"Export to CSV for accounting"}),i.jsx("li",{children:"Visual expense distribution charts"})]})]})]}),i.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:i.jsxs("p",{className:"text-purple-800 text-sm",children:[i.jsx("strong",{children:"Note:"})," Salary expenses are automatically calculated from staff records and excluded from manual expense tracking to avoid duplication."]})})]}),i.jsxs("section",{id:"ngo",className:"mb-8",children:[i.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-3 flex items-center",children:[i.jsx(u5,{className:"mr-2 text-blue-600"})," NGO Subsidies (NGO Schools)"]}),i.jsx("p",{className:"mb-3",children:"Specialized subsidy tracking for NGO-funded schools:"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm",children:[i.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Subsidy Management"}),i.jsxs("ul",{className:"list-disc pl-5 text-gray-600 text-sm space-y-1",children:[i.jsx("li",{children:"Quarterly subsidy tracking (Q1-Q4)"}),i.jsx("li",{children:"NGO name and contact information"}),i.jsx("li",{children:"Expected vs. received subsidy status"}),i.jsx("li",{children:"Subsidy amount and date tracking"}),i.jsx("li",{children:"Historical subsidy records"})]})]}),i.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm",children:[i.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Financial Overview"}),i.jsxs("ul",{className:"list-disc pl-5 text-gray-600 text-sm space-y-1",children:[i.jsx("li",{children:"Total subsidies received"}),i.jsx("li",{children:"Expected future subsidies"}),i.jsx("li",{children:"Active NGO partnerships count"}),i.jsx("li",{children:"Subsidy utilization analytics"}),i.jsx("li",{children:"Balance tracking against expenses"})]})]})]}),i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:i.jsxs("p",{className:"text-blue-800 text-sm",children:[i.jsx("strong",{children:"Key Feature:"})," NGO schools automatically hide all fee-related functionality and display funding information instead, ensuring a clean interface focused solely on subsidy management."]})})]}),i.jsxs("section",{id:"financial",className:"mb-8",children:[i.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-3 flex items-center",children:[i.jsx(i0,{className:"mr-2 text-blue-600"})," Financial Reporting"]}),i.jsx("p",{className:"mb-3",children:"Comprehensive financial dashboard with real-time analytics:"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm",children:[i.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Income Tracking"}),i.jsxs("ul",{className:"list-disc pl-5 text-gray-600 text-sm space-y-1",children:[i.jsx("li",{children:"Total fees collected (traditional schools)"}),i.jsx("li",{children:"Total subsidies received (NGO schools)"}),i.jsx("li",{children:"Combined income visualization"}),i.jsx("li",{children:"Historical income trends"})]})]}),i.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm",children:[i.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Expense Analysis"}),i.jsxs("ul",{className:"list-disc pl-5 text-gray-600 text-sm space-y-1",children:[i.jsx("li",{children:"Total expenses (excluding salaries)"}),i.jsx("li",{children:"Category-wise expense breakdown"}),i.jsx("li",{children:"Net balance calculation"}),i.jsx("li",{children:"Profit/loss visualization"})]})]})]}),i.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm mb-4",children:[i.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Export & Print"}),i.jsxs("ul",{className:"list-disc pl-5 text-gray-600 text-sm space-y-1",children:[i.jsx("li",{children:"Transaction history export to CSV"}),i.jsx("li",{children:"Financial summary reports"}),i.jsx("li",{children:"Print-friendly layouts"}),i.jsx("li",{children:"Date range filtering for reports"})]})]})]}),i.jsxs("section",{id:"settings",className:"mb-8",children:[i.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-3 flex items-center",children:[i.jsx(nj,{className:"mr-2 text-blue-600"})," Settings & Configuration"]}),i.jsx("p",{className:"mb-3",children:"Administrator-only section for system configuration:"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm",children:[i.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"School Information"}),i.jsxs("ul",{className:"list-disc pl-5 text-gray-600 text-sm space-y-1",children:[i.jsx("li",{children:"School name and logo management"}),i.jsx("li",{children:"Educational level settings (Primary/Middle/High)"}),i.jsx("li",{children:"Funding model selection (Traditional/NGO)"}),i.jsx("li",{children:"Contact information"})]})]}),i.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm",children:[i.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Display Preferences"}),i.jsxs("ul",{className:"list-disc pl-5 text-gray-600 text-sm space-y-1",children:[i.jsx("li",{children:"Theme selection (Light/Dark/System)"}),i.jsx("li",{children:"Date format customization"}),i.jsx("li",{children:"Currency settings"}),i.jsx("li",{children:"Sidebar behavior preferences"})]})]})]}),i.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:i.jsxs("p",{className:"text-orange-800 text-sm",children:[i.jsx("strong",{children:"Important:"})," Changing the funding model (Traditional/NGO) will immediately update the interface to show/hide relevant sections like Fees or NGO Subsidies."]})})]}),i.jsxs("section",{id:"printing",className:"mb-8",children:[i.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:"Printing & Export Features"}),i.jsx("p",{className:"mb-3",children:"The system supports multiple output formats for all reports and documents:"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[i.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm",children:[i.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Print Options"}),i.jsxs("ul",{className:"list-disc pl-5 text-gray-600 text-sm space-y-1",children:[i.jsx("li",{children:"Browser print functionality"}),i.jsx("li",{children:"Thermal printer optimized layouts"}),i.jsx("li",{children:"Standard office printer compatibility"}),i.jsx("li",{children:"Print preview for verification"})]})]}),i.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm",children:[i.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Export Formats"}),i.jsxs("ul",{className:"list-disc pl-5 text-gray-600 text-sm space-y-1",children:[i.jsx("li",{children:"CSV export for spreadsheet analysis"}),i.jsx("li",{children:"PDF generation for document sharing"}),i.jsx("li",{children:"Image export for presentations"}),i.jsx("li",{children:"Customizable export fields"})]})]}),i.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm",children:[i.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Document Types"}),i.jsxs("ul",{className:"list-disc pl-5 text-gray-600 text-sm space-y-1",children:[i.jsx("li",{children:"Fee challans and receipts"}),i.jsx("li",{children:"Student admission forms"}),i.jsx("li",{children:"Financial reports and summaries"}),i.jsx("li",{children:"Staff records and payslips"})]})]})]})]}),i.jsxs("section",{id:"workflow",className:"mb-6",children:[i.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:"Getting Started - Complete Workflow Guide"}),i.jsx("p",{className:"mb-4 text-gray-700",children:"Follow this step-by-step guide to set up and use the School Management System effectively. This workflow ensures all components are properly configured for optimal system performance."}),i.jsxs("div",{className:"mb-6",children:[i.jsxs("h4",{className:"font-bold text-lg text-blue-700 mb-3 flex items-center",children:[i.jsx("span",{className:"bg-blue-600 text-white rounded-full w-6 h-6 flex items-center justify-center mr-2 text-sm",children:"1"}),"Initial Setup & Configuration"]}),i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 ml-8",children:i.jsxs("ul",{className:"space-y-2",children:[i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-blue-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Access Settings:"})," Navigate to Settings section (Administrator access required)"]})]}),i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-blue-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Configure School Information:"})," Enter school name, address, contact details, and upload logo"]})]}),i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-blue-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Select Funding Model:"})," Choose between Traditional (fee-collecting) or NGO-funded model"]})]}),i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-blue-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Set Academic Preferences:"})," Configure weekends, vacation periods, and academic year"]})]})]})})]}),i.jsxs("div",{className:"mb-6",children:[i.jsxs("h4",{className:"font-bold text-lg text-green-700 mb-3 flex items-center",children:[i.jsx("span",{className:"bg-green-600 text-white rounded-full w-6 h-6 flex items-center justify-center mr-2 text-sm",children:"2"}),"Create Academic Structure"]}),i.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 ml-8",children:i.jsxs("ul",{className:"space-y-2",children:[i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-green-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Create Batches:"})," Set up academic batches/years with start and end dates"]})]}),i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-green-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Define Classes:"})," Add classes (e.g., Class 1, Class 2) with fee structures (Traditional schools)"]})]}),i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-green-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Set Up Sections:"})," Create sections within classes (e.g., Section A, Section B)"]})]}),i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-green-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Add Subjects:"})," Define subjects taught in each class"]})]})]})})]}),i.jsxs("div",{className:"mb-6",children:[i.jsxs("h4",{className:"font-bold text-lg text-purple-700 mb-3 flex items-center",children:[i.jsx("span",{className:"bg-purple-600 text-white rounded-full w-6 h-6 flex items-center justify-center mr-2 text-sm",children:"3"}),"Register Staff Members"]}),i.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4 ml-8",children:i.jsxs("ul",{className:"space-y-2",children:[i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-purple-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Add Teachers:"})," Register teaching staff with personal details and qualifications"]})]}),i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-purple-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Assign Roles:"})," Link teachers to specific subjects and classes"]})]}),i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-purple-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Configure Salaries:"})," Set base salaries and allowances for staff members"]})]}),i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-purple-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Non-Teaching Staff:"})," Add administrative and support staff"]})]})]})})]}),i.jsxs("div",{className:"mb-6",children:[i.jsxs("h4",{className:"font-bold text-lg text-yellow-700 mb-3 flex items-center",children:[i.jsx("span",{className:"bg-yellow-600 text-white rounded-full w-6 h-6 flex items-center justify-center mr-2 text-sm",children:"4"}),"Enroll Students"]}),i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 ml-8",children:i.jsxs("ul",{className:"space-y-2",children:[i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-yellow-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Student Admission:"})," Add new students with complete personal and family information"]})]}),i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-yellow-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Family Linking:"})," Connect siblings or family members for consolidated billing"]})]}),i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-yellow-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Class Assignment:"})," Assign students to appropriate classes and sections"]})]}),i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-yellow-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Photo Upload:"})," Add student photographs for identification purposes"]})]})]})})]}),i.jsxs("div",{className:"mb-6",children:[i.jsxs("h4",{className:"font-bold text-lg text-red-700 mb-3 flex items-center",children:[i.jsx("span",{className:"bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center mr-2 text-sm",children:"5"}),"Daily Operations Management"]}),i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 ml-8",children:i.jsxs("ul",{className:"space-y-2",children:[i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-red-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Attendance Tracking:"})," Record daily attendance for students and staff"]})]}),i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-red-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Fee Management:"})," Generate challans and process payments (Traditional schools)"]})]}),i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-red-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Subsidy Tracking:"})," Monitor NGO subsidies and funding (NGO schools)"]})]}),i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-red-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Expense Recording:"})," Log all school expenditures with categories"]})]})]})})]}),i.jsxs("div",{className:"mb-6",children:[i.jsxs("h4",{className:"font-bold text-lg text-indigo-700 mb-3 flex items-center",children:[i.jsx("span",{className:"bg-indigo-600 text-white rounded-full w-6 h-6 flex items-center justify-center mr-2 text-sm",children:"6"}),"Academic Activities & Assessments"]}),i.jsx("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4 ml-8",children:i.jsxs("ul",{className:"space-y-2",children:[i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-indigo-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Exam Scheduling:"})," Plan examinations with dates, subjects, and classes"]})]}),i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-indigo-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Marks Entry:"})," Record student performance and grades"]})]}),i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-indigo-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Report Generation:"})," Create progress reports and mark sheets"]})]}),i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-indigo-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Certificate Issuance:"})," Generate completion and achievement certificates"]})]})]})})]}),i.jsxs("div",{className:"mb-6",children:[i.jsxs("h4",{className:"font-bold text-lg text-teal-700 mb-3 flex items-center",children:[i.jsx("span",{className:"bg-teal-600 text-white rounded-full w-6 h-6 flex items-center justify-center mr-2 text-sm",children:"7"}),"Financial Monitoring & Reporting"]}),i.jsx("div",{className:"bg-teal-50 border border-teal-200 rounded-lg p-4 ml-8",children:i.jsxs("ul",{className:"space-y-2",children:[i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-teal-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Financial Dashboard:"})," Monitor income vs. expenses in real-time"]})]}),i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-teal-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Transaction History:"})," Review all financial transactions with filters"]})]}),i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-teal-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Export Reports:"})," Generate CSV/PDF reports for auditing and analysis"]})]}),i.jsxs("li",{className:"flex items-start",children:[i.jsx("span",{className:"text-teal-600 font-bold mr-2",children:""}),i.jsxs("span",{children:[i.jsx("strong",{children:"Staff Payroll:"})," Process monthly salaries and advances"]})]})]})})]}),i.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mt-4",children:i.jsxs("p",{className:"text-green-800",children:[i.jsx("strong",{children:"Pro Tip:"})," Complete steps 1-4 in order before moving to daily operations. This ensures all data dependencies are properly established for seamless system functionality."]})})]}),i.jsxs("section",{className:"mb-6",children:[i.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:"Quick Start Guide"}),i.jsx("p",{className:"mb-3",children:"For a quick overview of getting started with the School Management System, follow these essential steps:"}),i.jsxs("ol",{className:"list-decimal pl-5 space-y-2 mb-4",children:[i.jsx("li",{children:"Configure school settings in the Settings section (Administrator access required)"}),i.jsx("li",{children:"Select your funding model (Traditional or NGO) to customize the interface"}),i.jsx("li",{children:"Add classes and sections in the Classes Management section"}),i.jsx("li",{children:"Register staff members in the Staff section"}),i.jsx("li",{children:"Begin adding students through the Students Admission process"}),i.jsx("li",{children:"For traditional schools, start generating fee challans in the Fees section"}),i.jsx("li",{children:"For NGO schools, track subsidies in the NGO Subsidies section"}),i.jsx("li",{children:"Record expenses in the Expenses section"}),i.jsx("li",{children:"Monitor financial health through the Financial Reporting dashboard"})]}),i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:i.jsxs("p",{className:"text-blue-800",children:[i.jsx("strong",{children:"For Detailed Instructions:"})," Refer to the complete Step-by-Step Workflow Guide above for comprehensive instructions on setting up and using all system features."]})}),i.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mt-3",children:i.jsxs("p",{className:"text-green-800",children:[i.jsx("strong",{children:"Tip:"})," Use the search functionality in the header to quickly find students, staff, or any record across the entire system."]})})]})]})}),i.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200 flex justify-between items-center",children:[i.jsx("p",{className:"text-sm text-gray-500",children:"School Management System v1.0"}),i.jsx("button",{onClick:a,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Close Guide"})]})]})}):null,PO=()=>{const n=Pn(),{schoolInfo:a,loading:t,error:r}=rr(ae=>ae.settings),[s,e]=ne.useState({schoolName:"",schoolAddress:"",schoolPhone:"",schoolEmail:"",schoolWebsite:"",level:EA.level,hasPG:EA.hasPG,hasNursery:EA.hasNursery,hasKG:EA.hasKG}),[u,f]=ne.useState([]),[m,g]=ne.useState({summer:{start:"",end:""},winter:{start:"",end:""}}),[b,j]=ne.useState([0]),[F,C]=ne.useState(!1);ne.useEffect(()=>{n(s0())},[n]),ne.useEffect(()=>{if(a){if(e({schoolName:a.schoolName||"",schoolAddress:a.schoolAddress||"",schoolPhone:a.schoolPhone||"",schoolEmail:a.schoolEmail||"",schoolWebsite:a.schoolWebsite||"",level:a.level||EA.level,hasPG:a.hasPG!==void 0?a.hasPG:EA.hasPG,hasNursery:a.hasNursery!==void 0?a.hasNursery:EA.hasNursery,hasKG:a.hasKG!==void 0?a.hasKG:EA.hasKG}),a.holidays){let ae=a.holidays;if(typeof ae=="string")try{ae=JSON.parse(ae)}catch{ae=[]}if(Array.isArray(ae)){const pe=ae.map(z=>typeof z=="string"?{title:"",date:z}:z);f(pe)}else f([])}else f([]);a.vacations?g(a.vacations):g({summer:{start:"2025-06-01",end:"2025-07-31"},winter:{start:"2025-12-20",end:"2026-01-05"}}),a.weekendDays&&Array.isArray(a.weekendDays)?j(a.weekendDays):j([0])}},[a]);const M=ae=>{const{name:pe,value:z}=ae.target;e(J=>({...J,[pe]:z}))},_=ae=>{e(pe=>({...pe,[ae]:!pe[ae]}))},L=()=>{f(ae=>[...ae,{title:"",date:""}])},T=(ae,pe,z)=>{const J=[...u];J[ae]={...J[ae],[pe]:z},f(J)},H=ae=>{const pe=u.filter((z,J)=>J!==ae);f(pe)},O=(ae,pe,z)=>{g(J=>({...J,[ae]:{...J[ae],[pe]:z}}))},Q=ae=>{j(pe=>pe.includes(ae)?pe.filter(z=>z!==ae):[...pe,ae])},Z=async ae=>{ae.preventDefault();try{const pe=Array.isArray(u)?u.map(J=>typeof J=="string"?{title:"",date:J}:J).filter(J=>J.date):[],z=await n(h2({...s,holidays:pe,vacations:m,weekendDays:b})).unwrap();console.log("Settings updated successfully:",z)}catch(pe){console.error("Failed to update school info:",pe),alert("Failed to update school settings: "+(pe.message||"Unknown error"))}},ee=()=>{e({schoolName:"",schoolAddress:"",schoolPhone:"",schoolEmail:"",schoolWebsite:"",level:EA.level,hasPG:EA.hasPG,hasNursery:EA.hasNursery,hasKG:EA.hasKG}),f([{title:"New Year's Day",date:"2025-01-01"},{title:"Kashmir Day",date:"2025-02-05"},{title:"Pakistan Day",date:"2025-03-23"},{title:"Labour Day",date:"2025-05-01"},{title:"Independence Day",date:"2025-08-14"},{title:"Iqbal Day",date:"2025-11-09"},{title:"Quaid-e-Azam Day",date:"2025-12-25"}]),g({summer:{start:"2025-06-01",end:"2025-07-31"},winter:{start:"2025-12-20",end:"2026-01-05"}}),j([0])},se=ae=>{switch(ae){case"primary":return"Primary School (Grades 1-5)";case"middle":return"Middle School (Grades 6-8)";case"high":return"High School (Grades 9-10)";default:return"Primary School (Grades 1-5)"}},ue=[{value:0,label:"Sunday"},{value:1,label:"Monday"},{value:2,label:"Tuesday"},{value:3,label:"Wednesday"},{value:4,label:"Thursday"},{value:5,label:"Friday"},{value:6,label:"Saturday"}];return i.jsxs("div",{className:"mx-auto",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"School Settings"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Configure your school's basic information"})]}),i.jsx("div",{className:"mb-4",children:i.jsxs("button",{onClick:()=>C(!0),className:"inline-flex items-center px-4 py-2 border border-blue-300 shadow-sm text-sm font-medium rounded-md text-blue-700 bg-blue-50 hover:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(ij,{className:"mr-2"}),"How to Use This Page - Complete Guide"]})}),r&&i.jsx("div",{className:"mb-6 bg-red-50 border-l-4 border-red-500 p-4 rounded",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),i.jsx("div",{className:"ml-3",children:i.jsx("p",{className:"text-sm text-red-700",children:r})})]})}),i.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[i.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(fA,{className:"text-gray-500 mr-2"}),i.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"School Configuration"})]})}),i.jsxs("form",{onSubmit:Z,children:[i.jsx("div",{className:"px-6 py-4",children:i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-md font-medium text-gray-900 mb-4 flex items-center",children:[i.jsx(OA,{className:"mr-2 text-blue-500"}),"School Level"]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:["primary","middle","high"].map(ae=>i.jsx("div",{className:`border rounded-lg p-4 cursor-pointer transition-colors ${s.level===ae?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onClick:()=>e(pe=>({...pe,level:ae})),children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{type:"radio",id:ae,name:"level",value:ae,checked:s.level===ae,onChange:M,className:"h-4 w-4 text-blue-600 focus:ring-blue-500"}),i.jsx("label",{htmlFor:ae,className:"ml-3 block text-sm font-medium text-gray-700",children:se(ae)})]})},ae))})]}),i.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[i.jsx("h3",{className:"text-md font-medium text-gray-900 mb-4",children:"Early Childhood Education"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:`border rounded-lg p-4 cursor-pointer transition-colors ${s.hasPG?"border-green-500 bg-green-50":"border-gray-300 hover:border-gray-400"}`,onClick:()=>_("hasPG"),children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Play Group (PG)"}),s.hasPG?i.jsx(jx,{className:"text-green-500 text-xl"}):i.jsx(Cx,{className:"text-gray-400 text-xl"})]}),i.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Enable Play Group class"})]}),i.jsxs("div",{className:`border rounded-lg p-4 cursor-pointer transition-colors ${s.hasNursery?"border-green-500 bg-green-50":"border-gray-300 hover:border-gray-400"}`,onClick:()=>_("hasNursery"),children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Nursery"}),s.hasNursery?i.jsx(jx,{className:"text-green-500 text-xl"}):i.jsx(Cx,{className:"text-gray-400 text-xl"})]}),i.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Enable Nursery class"})]}),i.jsxs("div",{className:`border rounded-lg p-4 cursor-pointer transition-colors ${s.hasKG?"border-green-500 bg-green-50":"border-gray-300 hover:border-gray-400"}`,onClick:()=>_("hasKG"),children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Kindergarten (KG)"}),s.hasKG?i.jsx(jx,{className:"text-green-500 text-xl"}):i.jsx(Cx,{className:"text-gray-400 text-xl"})]}),i.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Enable Kindergarten class"})]})]})]}),i.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[i.jsxs("h3",{className:"text-md font-medium text-gray-900 mb-4 flex items-center",children:[i.jsx(Rl,{className:"mr-2 text-purple-500"}),"Weekend Days"]}),i.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Select which days of the week the school is closed. Students will not be marked as absent on these days."}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:ue.map(ae=>i.jsx("div",{className:`border rounded-lg p-3 cursor-pointer transition-colors ${b.includes(ae.value)?"border-purple-500 bg-purple-50":"border-gray-300 hover:border-gray-400"}`,onClick:()=>Q(ae.value),children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:ae.label}),b.includes(ae.value)?i.jsx(jx,{className:"text-purple-500 text-xl"}):i.jsx(Cx,{className:"text-gray-400 text-xl"})]})},ae.value))}),i.jsx("div",{className:"mt-4 text-sm text-gray-500",children:i.jsxs("p",{children:["Selected weekend days: ",b.map(ae=>ue.find(pe=>pe.value===ae)?.label).join(", ")||"None"]})})]}),i.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[i.jsxs("h3",{className:"text-md font-medium text-gray-900 mb-4 flex items-center",children:[i.jsx(k4,{className:"mr-2 text-orange-500"}),"School Vacations"]}),i.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Configure summer and winter vacations. Students will not be marked as absent during these periods."}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center mb-3",children:[i.jsx(k4,{className:"text-orange-500 mr-2"}),i.jsx("h4",{className:"font-medium text-gray-900",children:"Summer Vacation"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),i.jsx("input",{type:"date",value:m.summer.start,onChange:ae=>O("summer","start",ae.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),i.jsx("input",{type:"date",value:m.summer.end,onChange:ae=>O("summer","end",ae.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]})]})]}),i.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center mb-3",children:[i.jsx(Xk,{className:"text-blue-500 mr-2"}),i.jsx("h4",{className:"font-medium text-gray-900",children:"Winter Vacation"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),i.jsx("input",{type:"date",value:m.winter.start,onChange:ae=>O("winter","start",ae.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),i.jsx("input",{type:"date",value:m.winter.end,onChange:ae=>O("winter","end",ae.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]})]})]})]})]}),i.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[i.jsxs("h3",{className:"text-md font-medium text-gray-900 mb-4 flex items-center",children:[i.jsx(Rl,{className:"mr-2 text-purple-500"}),"School Holidays"]}),i.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Configure holidays for the current year. Students will not be marked as absent on these days."}),i.jsxs("div",{className:"space-y-3",children:[u.map((ae,pe)=>i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[i.jsx("input",{type:"text",placeholder:"Holiday Title (e.g., Iqbal Day)",value:ae.title,onChange:z=>T(pe,"title",z.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"date",value:ae.date,onChange:z=>T(pe,"date",z.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"}),i.jsx("button",{type:"button",onClick:()=>H(pe),className:"inline-flex items-center p-2 border border-transparent rounded-md text-red-700 bg-red-100 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:i.jsx(cu,{className:"h-4 w-4"})})]})]},pe)),i.jsxs("button",{type:"button",onClick:L,className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(xl,{className:"mr-1 h-4 w-4"}),"Add Holiday"]})]})]})]})}),i.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-end space-x-3",children:[i.jsxs("button",{type:"button",onClick:ee,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(Jk,{className:"mr-2 -ml-1 h-4 w-4"}),"Reset"]}),i.jsx("button",{type:"submit",disabled:t,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:t?i.jsxs(i.Fragment,{children:[i.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(m5,{className:"mr-2 -ml-1 h-4 w-4"}),"Save Changes"]})})]})]})]}),i.jsx(RO,{isOpen:F,onClose:()=>C(!1)})]})},HO=({onGenerateChallan:n,onExportCSV:a,isGenerateDisabled:t=!1})=>i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Fees Managements"}),i.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Manage student fees, challans, and payments"})]}),i.jsxs("div",{className:"mt-4 md:mt-0 flex space-x-2",children:[i.jsxs("button",{onClick:n,disabled:t,className:`inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${t?"bg-gray-400 cursor-not-allowed":"bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700"}`,children:[i.jsx(xl,{className:"mr-2"})," Generate Challan"]}),i.jsxs("button",{onClick:a,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[i.jsx(lu,{className:"mr-2"})," Export CSV"]})]})]}),zO=({filteredStudents:n})=>{const a=n.length,t=n.filter(g=>g.completionRate===100).length,r=a-t,s=n.reduce((g,b)=>g+(b.totalAmount||0),0),e=n.reduce((g,b)=>g+(b.paidAmount||0),0),u=n.reduce((g,b)=>b.feesHistory?g+b.feesHistory.reduce((j,F)=>j+(parseFloat(F.discountAmount)||0),0):g,0),f=s-u,m=Math.max(0,f-e);return i.jsx("div",{className:"my-4",children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[i.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl shadow p-4 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-blue-100 text-xs font-medium",children:"Total Students"}),i.jsx("p",{className:"text-2xl font-bold mt-1",children:a})]}),i.jsx("div",{className:"p-2 bg-blue-400 bg-opacity-30 rounded-full",children:i.jsx(Pi,{size:20})})]})}),i.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-xl shadow p-4 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-green-100 text-xs font-medium",children:"Fully Paid"}),i.jsx("p",{className:"text-2xl font-bold mt-1",children:t})]}),i.jsx("div",{className:"p-2 bg-green-400 bg-opacity-30 rounded-full",children:i.jsx(nf,{size:20})})]})}),i.jsx("div",{className:"bg-gradient-to-r from-red-500 to-red-600 rounded-xl shadow p-4 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-red-100 text-xs font-medium",children:"Pending"}),i.jsx("p",{className:"text-2xl font-bold mt-1",children:r})]}),i.jsx("div",{className:"p-2 bg-red-400 bg-opacity-30 rounded-full",children:i.jsx(vd,{size:20})})]})}),i.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-indigo-600 rounded-xl shadow p-4 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-indigo-100 text-xs font-medium",children:"Fees Collected"}),i.jsxs("p",{className:"text-2xl font-bold mt-1",children:["Rs ",isNaN(e)?"0":Math.round(e)]})]}),i.jsx("div",{className:"p-2 bg-indigo-400 bg-opacity-30 rounded-full",children:i.jsx(Co,{size:20})})]})}),i.jsx("div",{className:"bg-gradient-to-r from-amber-500 to-amber-600 rounded-xl shadow p-4 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-amber-100 text-xs font-medium",children:"Pending Fees"}),i.jsxs("p",{className:"text-2xl font-bold mt-1",children:["Rs ",isNaN(m)?"0":Math.round(m)]})]}),i.jsx("div",{className:"p-2 bg-amber-400 bg-opacity-30 rounded-full",children:i.jsx(wh,{size:20})})]})}),i.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl shadow p-4 text-white",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-purple-100 text-xs font-medium",children:"Discounts Given"}),i.jsxs("p",{className:"text-2xl font-bold mt-1",children:["Rs ",isNaN(u)?"0":Math.round(u)]})]}),i.jsx("div",{className:"p-2 bg-purple-400 bg-opacity-30 rounded-full",children:i.jsx(tp,{size:20})})]})})]})})},KO=({viewMode:n,searchTerm:a,setSearchTerm:t,filterStatus:r,setFilterStatus:s,selectedClass:e,setSelectedClass:u,selectedSection:f,setSelectedSection:m,selectedBatch:g,setSelectedBatch:b,uniqueClasses:j,classSections:F,uniqueBatches:C,onBulkGenerate:M,onBulkPayment:_,onClearFilters:L})=>i.jsx("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[i.jsxs("div",{className:"relative flex-grow max-w-md",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Bi,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"text",placeholder:n==="student"?"Search by student name, class, or section...":"Search by family name...",value:a,onChange:T=>t(T.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(io,{className:"text-gray-400"}),i.jsxs("select",{value:r,onChange:T=>s(T.target.value),className:"block w-full pl-3 pr-10 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"all",children:"All Status"}),i.jsx("option",{value:"paid",children:"Fully Paid"}),i.jsx("option",{value:"pending",children:"Pending"})]})]}),n==="student"&&i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(io,{className:"text-gray-400"}),i.jsxs("select",{value:e,onChange:T=>u(T.target.value),className:"block w-full pl-3 pr-10 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"All Classes"}),j.map(T=>i.jsx("option",{value:T,children:T},T))]})]}),n==="student"&&i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(io,{className:"text-gray-400"}),i.jsxs("select",{value:g,onChange:T=>b(T.target.value),className:"block w-full pl-3 pr-10 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"All Batches"}),C.map(T=>i.jsx("option",{value:T,children:T},T))]})]}),n==="student"&&i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(io,{className:"text-gray-400"}),i.jsxs("select",{value:f,onChange:T=>m(T.target.value),disabled:!e,className:"block w-full pl-3 pr-10 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"All Sections"}),F.map(T=>i.jsx("option",{value:T,children:T},T))]})]}),i.jsx("div",{className:"flex items-center space-x-2",children:i.jsxs("button",{onClick:M,className:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[i.jsx(ag,{className:"mr-1"})," Bulk Generate"]})}),i.jsx("div",{className:"flex items-center space-x-2",children:i.jsxs("button",{onClick:_,className:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-lg text-sm font-medium text-white bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700",children:[i.jsx(ag,{className:"mr-1"})," Bulk Payment"]})}),i.jsx("div",{className:"flex items-center space-x-2",children:i.jsx("button",{onClick:L,className:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Clear Filters"})})]})]})}),R8=({student:n,onSendReminder:a})=>{const t=()=>{if(!n.parentContact){alert("Parent contact number not found for this student");return}console.log("Original phone number:",n.parentContact);let r=n.parentContact;r.startsWith("0")?r="92"+r.substring(1):r.startsWith("+92")&&(r=r.substring(1)),r=r.replace(/\D/g,""),console.log("Final phone number:",r);const s=`Dear Parent,

This is a friendly reminder regarding the pending fees for your child ${n.firstName} ${n.lastName}.

Student ID: ${n.id}
Class: ${n.class} - Section ${n.section}
Pending Amount: Rs ${Math.round(n.pendingAmount||0)}
Total Challans: ${n.pendingChallans||0}

Please pay the pending amount at your earliest convenience.

Thank you,
School Management`,e=encodeURIComponent(s),u=`https://api.whatsapp.com/send?phone=${r}&text=${e}`;window.open(u,"_blank")};return i.jsxs("button",{onClick:t,className:"inline-flex items-center px-3 py-1 border border-gray-300 text-xs font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50",children:[i.jsx("svg",{className:"w-4 h-4 mr-1 text-green-500",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})}),"Send Reminder"]})},GO=({filteredStudents:n,onViewDetails:a})=>i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(t=>i.jsxs("tr",{className:`hover:bg-gray-50 border-l-4 ${t.completionRate<100?"border-l-red-500":"border-l-green-500"}`,children:[i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsx("div",{className:"flex items-center",children:i.jsx("div",{className:"bg-gray-200 border-2 border-dashed rounded-xl w-8 h-8 flex items-center justify-center",children:i.jsx("img",{src:t.photo,alt:t.firstName,className:"w-8 h-8 rounded-xl"})})})}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsx("div",{className:"text-sm text-gray-900",children:t.grNo?t.grNo.replace("GR",""):"N/A"})}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[t.firstName," ",t.lastName]})}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsxs("div",{className:"text-sm text-gray-900",children:[t.class," ",t.section]})}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsxs("div",{className:"text-sm text-gray-900",children:[t.paidChallans,"/",t.totalChallans]})}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsxs("div",{className:"text-sm text-gray-900",children:["Rs ",Math.round(t.paidAmount),"/",Math.round(t.totalAmount)]})}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mr-2",children:i.jsx("div",{className:`h-2 rounded-full ${t.completionRate>=75?"bg-green-500":t.completionRate>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${t.completionRate}%`}})}),i.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[t.completionRate,"%"]})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:i.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[t.completionRate<100?i.jsx(zk,{className:"text-red-500"}):i.jsx(Rk,{className:"text-green-500"}),t.completionRate<100?i.jsx(R8,{student:t}):null,i.jsxs("button",{onClick:()=>a(t),className:"inline-flex items-center px-3 py-1 border border-gray-300 text-xs font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50",children:[i.jsx(rg,{className:"mr-1"})," View Details"]})]})})]},t.id))}),VO=({familyGroups:n,students:a,onPayFees:t,onPrintChallan:r})=>i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(s=>i.jsxs(At.Fragment,{children:[i.jsx("tr",{className:"bg-gray-50",children:i.jsx("td",{className:"px-6 py-3",colSpan:"6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx(Zk,{className:"text-gray-500 mr-2"}),i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-bold text-gray-900",children:s.familyName}),i.jsxs("div",{className:"text-xs text-gray-500",children:["Family ID: ",s.familyId]})]})]}),i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"text-gray-500",children:"Students: "}),i.jsx("span",{className:"font-medium",children:s.students.length})]}),i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"text-gray-500",children:"Challans: "}),i.jsxs("span",{className:"font-medium",children:[s.paidChallans,"/",s.totalChallans]})]}),i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"text-gray-500",children:"Amount: "}),i.jsxs("span",{className:"font-medium",children:["Rs ",Math.round(s.paidAmount),"/",Math.round(s.totalAmount)]})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-20 bg-gray-200 rounded-full h-2 mr-2",children:i.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${s.completionRate}%`}})}),i.jsxs("span",{className:"text-xs font-medium text-gray-700",children:[s.completionRate,"%"]})]})]})]})})}),s.challans.map(e=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.studentName}),i.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",e.studentId]})]}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[i.jsx("div",{className:"text-sm text-gray-900",children:e.studentClass}),i.jsxs("div",{className:"text-sm text-gray-500",children:["Section ",e.studentSection]})]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("div",{className:"text-sm text-gray-900",children:e.month})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"text-sm text-gray-900",children:["Rs ",Math.round(e.amount)]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${e.status==="paid"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:e.status})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:i.jsxs("div",{className:"flex justify-end space-x-2",children:[e.status!=="paid"?i.jsxs("button",{onClick:()=>{a.find(f=>f.id===e.studentId)&&t(e.id)},className:"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700",children:[i.jsx(Co,{className:"mr-1"})," Pay"]}):null,i.jsx(R8,{student:a.find(u=>u.id===e.studentId)}),i.jsxs("button",{onClick:()=>{const u=a.find(f=>f.id===e.studentId);u&&r(e,u)},className:"inline-flex items-center px-2 py-1 border border-gray-300 text-xs font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50",children:[i.jsx(mi,{className:"mr-1"})," Print"]})]})})]},e.id))]},s.familyId))}),YO=({showGenerateModal:n,setShowGenerateModal:a,challanData:t,setChallanData:r,students:s,classes:e,handleStudentChange:u,submitChallan:f,showBulkGenerateModal:m,setShowBulkGenerateModal:g,submitBulkGenerate:b,showBulkUpdateModal:j,setShowBulkUpdateModal:F,submitBulkUpdate:C,bulkSelectedChallans:M,showPaymentModal:_,setShowPaymentModal:L,paymentData:T,setPaymentData:H,submitPayment:O,detailViewStudent:Q,batches:Z})=>{const ee=ke=>{if(!ke)return 0;const he=s.find(xe=>xe.id===ke);if(!he)return 0;if(he.monthlyFees){const xe=parseFloat(he.monthlyFees)||0;if(xe>0)return xe}const Ne=e.find(xe=>xe.name===he.class);return Ne&&Ne.monthlyFees?parseFloat(Ne.monthlyFees)||0:he.monthlyFees&&parseFloat(he.monthlyFees)||0},se=ke=>{const he=ee(ke);r({...t,studentId:ke,amount:he})},[ue,ae]=ne.useState({month:new Date().toISOString().slice(0,7),dueDate:new Date(Date.now()+864e6).toISOString().split("T")[0],description:""}),pe=(ke,he)=>{ae({...ue,[ke]:he})};ne.useEffect(()=>{if(n){const ke=new Date,he=ke.getFullYear(),Ne=ke.getMonth();let xe=he,we=Ne-1;we<0&&(we=11,xe=he-1);const ye=xe+"-"+(we+1).toString().padStart(2,"0"),te=new Date(Date.now()+14400*60*1e3).toISOString().split("T")[0];r(V=>({...V,month:V.month||ye,dueDate:V.dueDate||te}))}},[n,r]);const z=ke=>{ke.preventDefault(),b(ue)},J=(ke,he)=>{if(!ke||!he||!he.startDate||!he.endDate)return!0;try{const[Ne,xe]=ke.split("-").map(Number),we=new Date(Ne,xe-1,1),ye=new Date(Ne,xe,0),te=new Date(he.startDate),V=new Date(he.endDate);return we<=V&&ye>=te}catch(Ne){return console.error("Error checking month in batch range:",Ne),!0}},ge=ke=>{if(!ke)return null;const he=s.find(Ne=>Ne.id===ke);return!he||!he.academicYear?null:Z.find(Ne=>Ne.name===he.academicYear)},fe=(ke,he)=>{if(!ke||!he)return!0;const Ne=ge(he);return Ne?J(ke,Ne):!0};return i.jsxs(i.Fragment,{children:[_&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 w-full max-w-md",style:{minWidth:"500px"},children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Process Payment"}),i.jsxs("form",{onSubmit:ke=>{ke.preventDefault();const he=new FormData(ke.target),Ne=parseFloat(he.get("discountAmount"))||0,xe=he.get("discountReason")||"",we=Q?.feesHistory?.find(le=>le.id===T.challanId),te=(parseFloat(we?.amount)||0)-Ne,V={challanId:T.challanId,paymentMethod:he.get("paymentMethod"),paymentDate:he.get("paymentDate"),discountAmount:Ne,discountReason:xe,actualAmountPaid:te};O(V)},className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method"}),i.jsxs("select",{name:"paymentMethod",defaultValue:T.paymentMethod,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"bank",children:"Bank Transfer"}),i.jsx("option",{value:"easypaisa",children:"EasyPaisa"}),i.jsx("option",{value:"jazzcash",children:"JazzCash"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Date"}),i.jsx("input",{type:"date",name:"paymentDate",defaultValue:T.paymentDate,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0})]}),i.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Discount Amount"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Co,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"number",name:"discountAmount",min:"0",step:"0.01",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter discount amount",onChange:ke=>{const he=document.getElementById("discountDisplay"),Ne=document.getElementById("amountToPayDisplay");if(he&&Ne){const xe=parseFloat(ke.target.value)||0,ye=(parseFloat(Q?.feesHistory?.find(te=>te.id===T.challanId)?.amount)||0)-xe;he.textContent=`Rs ${xe.toFixed(2)}`,Ne.textContent=`Rs ${ye.toFixed(2)}`}}})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason for Discount"}),i.jsx("input",{type:"text",name:"discountReason",className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter reason (optional)"})]})]}),i.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg border border-blue-100",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-700 text-sm mb-1",children:"Original Amount:"}),i.jsxs("p",{className:"text-gray-900",children:["Rs ",(parseFloat(Q?.feesHistory?.find(ke=>ke.id===T.challanId)?.amount)||0).toFixed(2)]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-700 text-sm mb-1",children:"Discount:"}),i.jsx("p",{className:"text-red-600",id:"discountDisplay",children:"Rs 0.00"})]}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-700 text-sm mb-1",children:"Amount to Pay:"}),i.jsxs("p",{className:"font-bold text-green-600",id:"amountToPayDisplay",children:["Rs ",(parseFloat(Q?.feesHistory?.find(ke=>ke.id===T.challanId)?.amount)||0).toFixed(2)]})]})]})})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>L(!1),className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),i.jsxs("button",{type:"submit",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700",children:[i.jsx(Co,{className:"mr-2"})," Process Payment"]})]})]})]})}),n&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 w-full max-w-md",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Generate New Challan"}),i.jsxs("form",{onSubmit:ke=>{if(t.studentId&&t.month&&!fe(t.month,t.studentId)){ke.preventDefault(),alert("Selected month is outside the student's batch period. Please select a month within the batch dates.");return}f(ke)},className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Pi,{className:"h-5 w-5 text-gray-400"})}),i.jsx(cj,{students:s,value:t.studentId,onChange:se,placeholder:"Select a student...",required:!0})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Month"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(xd,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"month",value:t.month,onChange:ke=>r({...t,month:ke.target.value}),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0})]}),t.studentId&&t.month&&!fe(t.month,t.studentId)&&i.jsx("p",{className:"mt-1 text-xs text-red-600 bg-red-50 p-2 rounded border border-red-100",children:"Warning: Selected month is outside the student's batch period. Please select a month within the batch dates."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (Monthly Fees)"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Co,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"number",value:t.amount,onChange:ke=>r({...t,amount:ke.target.value}),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter amount",required:!0,readOnly:!0})]}),i.jsxs("p",{className:"mt-1 text-xs text-blue-600 bg-blue-50 p-2 rounded border border-blue-100",children:["Auto-filled from student's class monthly fees: Rs ",ee(t.studentId),". This amount is fixed based on the student's class fees."]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(xd,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"date",value:t.dueDate,onChange:ke=>r({...t,dueDate:ke.target.value}),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),i.jsx("textarea",{value:t.description,onChange:ke=>r({...t,description:ke.target.value}),className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter description (optional)",rows:"2"})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>a(!1),className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),i.jsxs("button",{type:"submit",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700",disabled:t.studentId&&t.month&&!fe(t.month,t.studentId),children:[i.jsx(ag,{className:"mr-2"})," Generate Challan"]})]})]})]})}),m&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 w-full max-w-md",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Bulk Generate Challanss"}),i.jsxs("form",{onSubmit:z,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Month"}),i.jsx("input",{type:"month",value:ue.month,onChange:ke=>pe("month",ke.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),i.jsx("input",{type:"date",value:ue.dueDate,onChange:ke=>pe("dueDate",ke.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),i.jsx("input",{type:"text",value:ue.description,onChange:ke=>pe("description",ke.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter description (optional)"})]}),i.jsx("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-100",children:i.jsxs("p",{className:"text-sm text-blue-700",children:[i.jsx("strong",{children:"Note:"})," Amounts will be automatically calculated based on each student's class fees structure."]})}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>g(!1),className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),i.jsxs("button",{type:"submit",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700",children:[i.jsx(ag,{className:"mr-2"})," Generate Challans"]})]})]})]})}),j&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 w-full max-w-md",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Bulk Update Challans"}),i.jsxs("form",{onSubmit:ke=>{ke.preventDefault();const he=new FormData(ke.target),Ne={paymentMethod:he.get("paymentMethod"),paymentDate:he.get("paymentDate")};C(Ne)},className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method"}),i.jsxs("select",{name:"paymentMethod",className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"bank",children:"Bank Transfer"}),i.jsx("option",{value:"easypaisa",children:"EasyPaisa"}),i.jsx("option",{value:"jazzcash",children:"JazzCash"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Date"}),i.jsx("input",{type:"date",name:"paymentDate",defaultValue:new Date().toISOString().split("T")[0],className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>F(!1),className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),i.jsxs("button",{type:"submit",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700",children:[i.jsx(nf,{className:"mr-2"})," Update ",M.length," Challans"]})]})]})]})})]})},WO=({detailViewStudent:n,students:a,classes:t,setShowStudentDetails:r,handleSelectAllChallans:s,areAllChallansSelected:e,bulkSelectedChallans:u,handleBulkUpdate:f,isChallanSelected:m,handleSelectChallan:g,handlePrintChallan:b,setPaymentData:j,setShowPaymentModal:F,setChallanData:C,setShowGenerateModal:M})=>{const L=n?(O=>{if(!O||!t)return 0;if(O.monthlyFees){const Z=parseFloat(O.monthlyFees)||0;if(Z>0)return Z}const Q=t.find(Z=>Z.name===O.class);return Q&&Q.monthlyFees?parseFloat(Q.monthlyFees)||0:O.monthlyFees&&parseFloat(O.monthlyFees)||0})(n):0,H=n?(O=>{if(!O)return{};const Q=O.feesHistory?O.feesHistory.filter(le=>le.type!=="admission"):[],Z=O.feesHistory?O.feesHistory.filter(le=>le.type==="admission"):[],ee=Q.length,se=Q.filter(le=>le.status==="paid").length,ue=Z.length,ae=Z.filter(le=>le.status==="paid").length,pe=ee+ue,z=se+ae,J=Q.reduce((le,de)=>le+(de.amount||0),0),ge=Z.reduce((le,de)=>le+(de.amount||0),0),fe=J+ge,ke=Q.reduce((le,de)=>le+(parseFloat(de.discountAmount)||0),0)+Z.reduce((le,de)=>le+(parseFloat(de.discountAmount)||0),0),he=fe-ke,Ne=Q.filter(le=>le.status==="paid").reduce((le,de)=>de.discountAmount>0?le+(de.amount-de.discountAmount||de.discountedAmount||0):le+(de.amount||0),0),xe=Z.filter(le=>le.status==="paid").reduce((le,de)=>de.discountAmount>0?le+(de.amount-de.discountAmount||de.discountedAmount||0):le+(de.amount||0),0),we=Ne+xe,ye=Math.max(0,he-we),te=Z.length>0&&Z.every(le=>le.status==="paid"),V=pe>0?Math.round(z/pe*100):te?100:0;return{...O,totalChallans:pe,paidChallans:z,totalAmount:fe,adjustedTotalAmount:he,paidAmount:we,pendingAmount:ye,admissionPaid:te,completionRate:V,totalDiscounts:ke}})(n):{};return i.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:n&&i.jsxs("div",{children:[i.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"bg-gray-200 border-2 border-dashed rounded-xl w-16 h-16 flex items-center justify-center mr-4",children:i.jsx(Pi,{className:"text-gray-500 text-2xl"})}),i.jsxs("div",{children:[i.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:[n.firstName," ",n.lastName]}),i.jsxs("p",{className:"text-gray-600",children:[n.class," - ",n.section," (GR No: ",n.grNo||"N/A",")"]})]})]}),i.jsxs("button",{onClick:()=>r(!1),className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(rg,{className:"mr-2"})," Back to All Students"]})]}),i.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl shadow-md p-6 mb-6 border border-blue-100",children:[i.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[i.jsx(wh,{className:"mr-2 text-blue-500"})," Financial Overview"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[i.jsx("div",{className:"bg-white rounded-xl shadow p-4 border border-gray-200",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-3 bg-blue-100 rounded-full mr-3",children:i.jsx(Co,{className:"text-blue-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-gray-500 text-xs font-medium",children:"Total Amount"}),i.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["Rs ",isNaN(H.adjustedTotalAmount)?"0":Math.round(H.adjustedTotalAmount||0).toLocaleString()]})]})]})}),i.jsx("div",{className:"bg-white rounded-xl shadow p-4 border border-gray-200",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-3 bg-green-100 rounded-full mr-3",children:i.jsx(nf,{className:"text-green-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-gray-500 text-xs font-medium",children:"Paid"}),i.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["Rs ",Math.round(H.paidAmount||0).toLocaleString()]})]})]})}),i.jsx("div",{className:"bg-white rounded-xl shadow p-4 border border-gray-200",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-3 bg-amber-100 rounded-full mr-3",children:i.jsx(Kk,{className:"text-amber-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-gray-500 text-xs font-medium",children:"Pending"}),i.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["Rs ",isNaN(H.pendingAmount)?"0":Math.round(H.pendingAmount||0).toLocaleString()]})]})]})}),i.jsx("div",{className:"bg-white rounded-xl shadow p-4 border border-gray-200",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-3 bg-purple-100 rounded-full mr-3",children:i.jsx(wh,{className:"text-purple-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-gray-500 text-xs font-medium",children:"Completion"}),i.jsxs("p",{className:"text-xl font-bold text-gray-900",children:[H.completionRate||0,"%"]})]})]})}),i.jsx("div",{className:"bg-white rounded-xl shadow p-4 border border-gray-200",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"p-3 bg-pink-100 rounded-full mr-3",children:i.jsx(tp,{className:"text-pink-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-gray-500 text-xs font-medium",children:"Discounts"}),i.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["Rs ",isNaN(H.totalDiscounts)?"0":Math.round(H.totalDiscounts||0).toLocaleString()]})]})]})})]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[i.jsx("div",{className:"lg:col-span-2",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[i.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Fee Challans"}),i.jsx("p",{className:"text-sm text-gray-500",children:"Manage and track student fee payments"})]}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("button",{onClick:s,className:"inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:e?"Deselect All":"Select All"}),i.jsxs("button",{onClick:()=>{C({studentId:n.id,month:"",amount:L||0,dueDate:"",description:""}),M(!0)},disabled:n.status==="passed_out"||n.status==="left",className:`inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${n.status==="passed_out"||n.status==="left"?"bg-gray-400 cursor-not-allowed":"bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700"}`,children:[i.jsx(xl,{className:"mr-1"})," Generate Challan"]}),i.jsxs("button",{onClick:f,disabled:u.length===0,className:`inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 ${u.length===0?"bg-gray-400 cursor-not-allowed":"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700"}`,children:[i.jsx(nf,{className:"mr-1"})," Mark as Paid (",u.length,")"]})]})]})}),i.jsxs("div",{className:"p-6",children:[i.jsxs("h4",{className:"text-md font-medium text-gray-900 mb-4",children:["Challan History (",n.feesHistory?n.feesHistory.length:0,")"]}),n.feesHistory&&n.feesHistory.length>0?i.jsx("div",{className:"overflow-hidden rounded-lg border border-gray-200",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:i.jsx("input",{type:"checkbox",checked:e,onChange:s,className:"h-4 w-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"})}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Month"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Due Date"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.feesHistory.slice().sort((O,Q)=>new Date(Q.date||Q.dueDate)-new Date(O.date||O.dueDate)).map(O=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:O.status!=="paid"?i.jsx("input",{type:"checkbox",checked:m(O.id),onChange:()=>g(O.id),className:"h-4 w-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}):i.jsx("span",{className:"text-green-500",children:""})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:O.month}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:i.jsxs("div",{children:[i.jsxs("div",{children:["Rs ",isNaN(O.amount)?"0":Math.round(O.amount).toLocaleString()]}),O.discountAmount>0&&i.jsxs("div",{className:"text-xs text-red-600",children:["Discount: Rs ",isNaN(O.discountAmount)?"0":Math.round(O.discountAmount).toLocaleString()]}),O.discountAmount>0&&i.jsxs("div",{className:"text-xs font-medium text-green-600",children:["Paid: Rs ",isNaN(O.amount-O.discountAmount)?isNaN(O.discountedAmount)?"0":Math.round(O.discountedAmount).toLocaleString():Math.round(O.amount-O.discountAmount||O.discountedAmount).toLocaleString()]})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(O.dueDate).toLocaleDateString()}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${O.status==="paid"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:O.status==="paid"?"Paid":"Pending"})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:i.jsxs("div",{className:"flex flex-wrap justify-end gap-1",children:[i.jsxs("button",{onClick:()=>{const Q=a.find(Z=>Z.id===n.id);Q&&b(O,Q)},className:"inline-flex items-center px-2 py-1 border border-gray-300 text-xs font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(mi,{className:"mr-1"})," Print"]}),O.status!=="paid"&&i.jsxs("button",{onClick:()=>{j({challanId:O.id,paymentMethod:"cash",paymentDate:new Date().toISOString().split("T")[0]}),F(!0)},className:"inline-flex items-center px-2 py-1 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[i.jsx(Co,{className:"mr-1"})," Pay"]})]})})]},O.id))})]})}):i.jsxs("div",{className:"text-center py-12",children:[i.jsx(ag,{className:"mx-auto h-12 w-12 text-gray-400"}),i.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No challans found"}),i.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"This student doesn't have any fee challans yet."}),i.jsx("div",{className:"mt-4",children:i.jsxs("button",{onClick:()=>{C({studentId:n.id,month:"",amount:L||0,dueDate:"",description:""}),M(!0)},disabled:n.status==="passed_out"||n.status==="left",className:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${n.status==="passed_out"||n.status==="left"?"bg-gray-400 cursor-not-allowed":"bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700"}`,children:[i.jsx(xl,{className:"mr-2"})," Generate First Challan"]})})]})]})]})}),i.jsx("div",{children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 mb-6",children:[i.jsxs("h4",{className:"text-md font-medium text-gray-900 mb-4 flex items-center",children:[i.jsx(Pi,{className:"mr-2 text-blue-500"})," Student Information"]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:n.grNo||"N/A"}),i.jsx("p",{className:"text-xs text-gray-500",children:"GR No"})]}),i.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[i.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[n.class," - ",n.section]}),i.jsx("p",{className:"text-xs text-gray-500",children:"Class/Section"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:n.fatherName||"N/A"}),i.jsx("p",{className:"text-xs text-gray-500",children:"Father's Name"})]}),i.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:n.dateOfBirth?new Date(n.dateOfBirth).toLocaleDateString():"N/A"}),i.jsx("p",{className:"text-xs text-gray-500",children:"Date of Birth"})]})]}),i.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[i.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["Rs ",Math.round(L).toLocaleString()]}),i.jsx("p",{className:"text-xs text-gray-500",children:"Monthly Fees"})]}),n.feesHistory&&n.feesHistory.filter(O=>O.type==="monthly").length>0&&i.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Existing Challan Months"}),i.jsx("div",{className:"flex flex-wrap gap-1",children:n.feesHistory.filter(O=>O.type==="monthly").map(O=>i.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:O.month},O.id))})]}),i.jsx("div",{className:"pt-3 border-t border-gray-200",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Admission Paid"}),i.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${H.admissionPaid?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:H.admissionPaid?"Yes":"No"})]})})]})]})})]})]},`${n.id}-${n.feesHistory?n.feesHistory.map(O=>`${O.id}-${O.status}`).join("-"):"no-history"}`)})},$O=({challans:n,students:a,schoolInfo:t})=>{if(!n||n.length===0)return null;const r=new Date().toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),s={name:t?.schoolName||t?.name||"School Management System",address:t?.schoolAddress||t?.address||"123 Education Street, Learning City",phone:t?.schoolPhone||t?.phone||"+1 (555) 123-4567"},e=f=>{if(!f)return"N/A";try{return new Date(f).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(m){return console.error("Error formatting date:",m),"Invalid Date"}},u=f=>f==="paid"?i.jsx("div",{className:"bg-green-100 text-green-800 px-2 py-1 rounded text-xs font-medium",children:"PAID"}):i.jsx("div",{className:"bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-xs font-medium",children:"PENDING"});return i.jsxs("div",{className:"w-full mx-auto bg-white font-sans",children:[i.jsx("div",{className:"print-container",children:n.map((f,m)=>{const g=a?.find(C=>C.id===f.studentId)||{},b=g?`${g.firstName} ${g.lastName}`:f.studentName||"N/A",j=g.class||"N/A",F=g.section||"N/A";return i.jsxs("div",{className:`challan ${m>0?"mt-8":""} ${m<n.length-1?"challan-page-break":""}`,children:[i.jsxs("div",{className:"text-center border-b border-gray-300 pb-2 mb-3 print:hidden",children:[i.jsxs("div",{className:"flex items-center justify-center mb-1",children:[i.jsx(fA,{className:"text-blue-600 text-lg mr-2"}),i.jsx("h1",{className:"text-lg font-bold text-gray-800",children:s.name})]}),i.jsx("p",{className:"text-gray-600 text-xs mb-1",children:s.address}),i.jsxs("p",{className:"text-gray-600 text-xs",children:["Phone: ",s.phone]})]}),i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-base font-bold text-gray-800",children:"Fee Challan"}),i.jsxs("p",{className:"text-gray-600 text-xs",children:["ID: ",f.id||"N/A"]})]}),u(f.status)]}),i.jsxs("div",{className:"mb-3",children:[i.jsxs("h3",{className:"font-bold text-gray-800 mb-2 text-xs flex items-center",children:[i.jsx(Pi,{className:"mr-2 text-blue-600 text-xs"})," Student Information"]}),i.jsx("div",{className:"bg-gray-50 p-2 rounded",children:i.jsxs("div",{className:"grid grid-cols-3 gap-1 text-xs",children:[i.jsx("span",{className:"font-medium col-span-1",children:"Name:"}),i.jsx("span",{className:"col-span-2",children:b}),i.jsx("span",{className:"font-medium col-span-1",children:"Class:"}),i.jsxs("span",{className:"col-span-2",children:[j," - Section ",F]}),i.jsx("span",{className:"font-medium col-span-1",children:"Month:"}),i.jsx("span",{className:"col-span-2",children:f.month||"N/A"})]})})]}),i.jsxs("div",{className:"mb-3",children:[i.jsx("h3",{className:"font-bold text-gray-800 mb-2 text-xs",children:"Fee Details"}),i.jsxs("div",{className:"border rounded",children:[i.jsxs("div",{className:"grid grid-cols-4 gap-1 p-2 bg-gray-50 border-b text-xs font-medium",children:[i.jsx("span",{className:"col-span-3",children:"Description"}),i.jsx("span",{className:"text-center",children:"Amount"})]}),i.jsxs("div",{className:"divide-y divide-gray-200",children:[i.jsxs("div",{className:"grid grid-cols-4 gap-1 p-2 text-xs",children:[i.jsx("span",{className:"col-span-3",children:"Monthly Tuition Fee"}),i.jsxs("span",{className:"text-center",children:["Rs ",Math.round(f.amount)||"0"]})]}),f.description&&i.jsxs("div",{className:"grid grid-cols-4 gap-1 p-2 text-xs",children:[i.jsx("span",{className:"col-span-3",children:f.description}),i.jsx("span",{className:"text-center",children:"Rs 0"})]}),i.jsxs("div",{className:"grid grid-cols-4 gap-1 p-2 text-xs font-bold",children:[i.jsx("span",{className:"col-span-3",children:"Total Amount"}),i.jsxs("span",{className:"text-center",children:["Rs ",Math.round(f.amount)||"0"]})]})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-xs font-medium text-gray-700 mb-1",children:"Issue Date"}),i.jsx("div",{className:"bg-gray-50 p-2 rounded border text-xs",children:e(f.date||new Date)})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-xs font-medium text-gray-700 mb-1",children:"Due Date"}),i.jsx("div",{className:"bg-gray-50 p-2 rounded border text-xs",children:e(f.dueDate)})]})]}),f.status==="paid"&&f.paymentMethod&&i.jsxs("div",{className:"mb-3",children:[i.jsx("h3",{className:"font-bold text-gray-800 mb-2 text-xs",children:"Payment Information"}),i.jsxs("div",{className:"bg-green-50 p-2 rounded border border-green-200 text-xs",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-1 mb-1",children:[i.jsx("div",{className:"font-medium",children:"Payment Method:"}),i.jsx("div",{className:"capitalize",children:f.paymentMethod})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[i.jsx("div",{className:"font-medium",children:"Payment Date:"}),i.jsx("div",{children:e(f.date)})]})]})]}),i.jsx("div",{className:"border-t border-gray-300 pt-3 mt-4 text-center text-xs text-gray-500 print:hidden",children:i.jsxs("p",{children:["Generated on ",r," - Official School Documents"]})})]},f.id)})}),i.jsx("style",{children:`
        @media print {
          body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          }
          
          .print-container {
            padding: 15px;
            max-width: 100%;
          }
          
          .print-hidden {
            display: none !important;
          }
          
          .challan-page-break {
            page-break-after: always;
          }
          
          @page {
            size: A4;
            margin: 0.5in;
          }
          
          .bulk-challan-print-view {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: visible;
          }
          
          /* Enhanced print styling */
          .text-center { text-align: center; }
          .flex { display: flex; }
          .items-center { align-items: center; }
          .justify-center { justify-content: center; }
          .justify-between { justify-content: space-between; }
          .border-b { border-bottom: 1px solid #d1d5db; }
          .border-gray-300 { border-color: #d1d5db; }
          .pb-2 { padding-bottom: 0.5rem; }
          .mb-3 { margin-bottom: 0.75rem; }
          .text-lg { font-size: 1.125rem; }
          .text-base { font-size: 1rem; }
          .font-bold { font-weight: 700; }
          .text-gray-800 { color: #1f2937; }
          .text-gray-600 { color: #4b5563; }
          .text-xs { font-size: 0.75rem; }
          .bg-blue-100 { background-color: #dbeafe; }
          .text-blue-600 { color: #2563eb; }
          .text-blue-800 { color: #1e40af; }
          .px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
          .py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
          .rounded { border-radius: 0.25rem; }
          .font-medium { font-weight: 500; }
          .mb-2 { margin-bottom: 0.5rem; }
          .bg-gray-50 { background-color: #f9fafb; }
          .p-2 { padding: 0.5rem; }
          .grid { display: grid; }
          .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
          .grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
          .grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
          .gap-1 { gap: 0.25rem; }
          .gap-2 { gap: 0.5rem; }
          .col-span-1 { grid-column: span 1 / span 1; }
          .col-span-2 { grid-column: span 2 / span 2; }
          .col-span-3 { grid-column: span 3 / span 3; }
          .border { border: 1px solid #d1d5db; }
          .divide-y > :not([hidden]) ~ :not([hidden]) { border-top: 1px solid #e5e7eb; }
          .divide-gray-200 > :not([hidden]) ~ :not([hidden]) { border-color: #e5e7eb; }
          .text-right { text-align: right; }
          .bg-green-50 { background-color: #f0fdf4; }
          .bg-green-100 { background-color: #dcfce7; }
          .bg-yellow-100 { background-color: #fef9c3; }
          .text-green-800 { color: #166534; }
          .text-yellow-800 { color: #854d0e; }
          .border-green-200 { border-color: #bbf7d0; }
          .capitalize { text-transform: capitalize; }
          .mt-8 { margin-top: 2rem; }
          .border-t { border-top: 1px solid #d1d5db; }
          .pt-3 { padding-top: 0.75rem; }
        }
      `})]})},qO=({challans:n,students:a,schoolInfo:t,onPrint:r,onBack:s})=>{if(!n||n.length===0)return null;const e={name:t?.schoolName||t?.name||"School Management System",address:t?.schoolAddress||t?.address||"123 Education Street, Learning City",phone:t?.schoolPhone||t?.phone||"+1 (555) 123-4567",bankAccount:t?.bankAccount||"0123456789",logo:t?.logo||null},u=b=>{if(!b)return"N/A";try{return new Date(b).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(j){return console.error("Error formatting date:",j),"Invalid Date"}},f=b=>{if(!b)return"N/A";try{const j=new Date(b);return j.setDate(j.getDate()+10),j.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"Invalid Date"}},m=()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),g=({challan:b,student:j,copyType:F})=>{const C=j?`${j.firstName} ${j.lastName}`:b.studentName||"N/A",M=j?.fatherName||"N/A",_=j?.class||"N/A",L=j?.section||"N/A",T=j?.grNo||"N/A",H=Math.round(b.amount)||0,O=500,Q=H+O;return i.jsxs("div",{className:"challan-copy border border-gray-400 p-3 mb-4",style:{width:"32%",display:"inline-block",verticalAlign:"top",margin:"0 0.5%"},children:[i.jsxs("div",{className:"text-center mb-3",children:[e.logo?i.jsx("img",{src:e.logo,alt:"School Logo",className:"mx-auto h-12 mb-2"}):i.jsx("div",{className:"text-center mb-2",children:i.jsx("div",{className:"font-bold text-lg",children:e.name})}),i.jsx("div",{className:"text-xs font-bold",children:e.name})]}),i.jsxs("div",{className:"text-center font-bold text-xs mb-2 border-b border-gray-400 pb-1",children:[F," COPY"]}),i.jsxs("div",{className:"text-xs mb-2",children:[i.jsxs("div",{className:"flex justify-between mb-1",children:[i.jsx("span",{children:"Issue Date:"}),i.jsx("span",{children:m()})]}),i.jsxs("div",{className:"flex justify-between mb-1",children:[i.jsx("span",{children:"Due Date:"}),i.jsx("span",{children:u(b.dueDate)})]}),i.jsxs("div",{className:"flex justify-between mb-1",children:[i.jsx("span",{children:"Expiry Date:"}),i.jsx("span",{children:f(b.dueDate)})]}),i.jsxs("div",{className:"flex justify-between mb-1",children:[i.jsx("span",{children:"GR #:"}),i.jsx("span",{children:T})]})]}),i.jsxs("div",{className:"text-xs mb-2 border-b border-gray-400 pb-2",children:[i.jsxs("div",{className:"mb-1",children:[i.jsx("span",{className:"font-bold",children:"Student Name:"})," ",C]}),i.jsxs("div",{className:"mb-1",children:[i.jsx("span",{className:"font-bold",children:"Father Name:"})," ",M]}),i.jsxs("div",{className:"mb-1",children:[i.jsx("span",{className:"font-bold",children:"Class:"})," ",_," - Section ",L]}),i.jsxs("div",{className:"mb-1",children:[i.jsx("span",{className:"font-bold",children:"Fee for the month of:"})," ",b.month]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-bold",children:"Challan ID:"})," ",b.id]})]}),i.jsxs("div",{className:"text-xs mb-2 border-b border-gray-400 pb-2",children:[i.jsx("div",{className:"font-bold mb-1",children:"Bank Account Number:"}),i.jsx("div",{children:e.bankAccount})]}),i.jsx("div",{className:"text-xs mb-2",children:i.jsxs("table",{className:"w-full border border-gray-400",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-200",children:[i.jsx("th",{className:"border border-gray-400 p-1 text-left",children:"Particular"}),i.jsx("th",{className:"border border-gray-400 p-1 text-right",children:"Amount (Rs)"})]})}),i.jsxs("tbody",{children:[i.jsxs("tr",{children:[i.jsx("td",{className:"border border-gray-400 p-1",children:"Tuition Fees"}),i.jsx("td",{className:"border border-gray-400 p-1 text-right",children:H})]}),i.jsxs("tr",{children:[i.jsx("td",{className:"border border-gray-400 p-1",children:"Fine (Late Payment)"}),i.jsx("td",{className:"border border-gray-400 p-1 text-right",children:O})]}),i.jsxs("tr",{className:"font-bold",children:[i.jsx("td",{className:"border border-gray-400 p-1",children:"Total"}),i.jsx("td",{className:"border border-gray-400 p-1 text-right",children:Q})]})]})]})}),i.jsxs("div",{className:"text-xs mb-2",children:[i.jsxs("div",{className:"flex justify-between font-bold mb-1",children:[i.jsx("span",{children:"Grant Total:"}),i.jsxs("span",{children:["Rs. ",Q]})]}),i.jsxs("div",{className:"border border-gray-400 p-2 mb-2",children:[i.jsx("div",{className:"font-bold mb-1",children:"Payment Received:"}),i.jsx("div",{children:"Signature: ________________________"})]})]}),i.jsxs("div",{className:"text-xs text-center border-t border-gray-400 pt-2",children:[i.jsx("div",{className:"mb-1",children:"Late fee will be charged if not paid on time"}),i.jsxs("div",{children:["For queries contact: ",e.phone]})]})]})};return i.jsx("div",{className:"fixed inset-0 bg-white z-50 p-0 m-0 overflow-hidden",children:i.jsxs("div",{className:"print-container",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4 p-4 bg-white border-b print:hidden",children:[i.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Generated Challans Preview"}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsxs("button",{onClick:()=>window.print(),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700",children:[i.jsx(mi,{className:"mr-2"})," Print All Challans"]}),i.jsx("button",{onClick:s,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Back to Fees"})]})]}),i.jsx("div",{className:"print-container",children:n.map((b,j)=>{const F=a?.find(C=>C.id===b.studentId)||{};return i.jsxs("div",{className:`challan-page ${j<n.length-1?"mb-8":""}`,children:[i.jsx(g,{challan:b,student:F,copyType:"STUDENT"}),i.jsx(g,{challan:b,student:F,copyType:"BANK"}),i.jsx(g,{challan:b,student:F,copyType:"SCHOOL"}),j<n.length-1&&i.jsx("div",{className:"page-break"})]},`${b.id}-${j}`)})}),i.jsx("style",{children:`
          @media print {
            body {
              margin: 0;
              padding: 0;
              font-family: Arial, Helvetica, sans-serif;
              font-size: 12px;
            }
            
            .print-container {
              padding: 10px;
              max-width: 100%;
            }
            
            .print-hidden {
              display: none !important;
            }
            
            .challan-page {
              page-break-after: always;
            }
            
            .challan-copy {
              width: 32% !important;
              display: inline-block !important;
              vertical-align: top !important;
              margin: 0 0.5% !important;
              border: 1px solid #000 !important;
              padding: 10px !important;
              box-sizing: border-box !important;
            }
            
            .page-break {
              page-break-after: always;
            }
            
            @page {
              size: A4;
              margin: 0.2in;
            }
            
            table {
              width: 100%;
              border-collapse: collapse;
              font-size: 11px;
            }
            
            th, td {
              border: 1px solid #000;
              padding: 3px;
              text-align: left;
            }
            
            th {
              background-color: #f0f0f0;
              font-weight: bold;
            }
            
            .text-right {
              text-align: right;
            }
            
            .text-center {
              text-align: center;
            }
            
            .font-bold {
              font-weight: bold;
            }
            
            .border {
              border: 1px solid #000;
            }
            
            .border-b {
              border-bottom: 1px solid #000;
            }
            
            .border-t {
              border-top: 1px solid #000;
            }
            
            .p-1 {
              padding: 3px;
            }
            
            .p-2 {
              padding: 5px;
            }
            
            .mb-1 {
              margin-bottom: 3px;
            }
            
            .mb-2 {
              margin-bottom: 5px;
            }
            
            .text-xs {
              font-size: 11px;
            }
          }
        `})]})})},XO=({challan:n,student:a,schoolInfo:t,onPrint:r,onBack:s})=>{const e={name:t?.schoolName||t?.name||"School Management System",address:t?.schoolAddress||t?.address||"123 Education Street, Learning City",phone:t?.schoolPhone||t?.phone||"+1 (555) 123-4567",bankAccount:t?.bankAccount||"0123456789",logo:t?.logo||null},u=O=>{if(!O)return"N/A";try{return new Date(O).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(Q){return console.error("Error formatting date:",Q),"Invalid Date"}},f=()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),m=a?`${a.firstName} ${a.lastName}`:"N/A",g=a?.fatherName||"N/A",b=a?.class||"N/A",j=a?.section||"N/A",F=a?.grNo||"N/A",C=Math.round(parseFloat(n.amount)||0),M=n.fineAmount!==void 0?Math.round(parseFloat(n.fineAmount)||0):0,_=C+M,L=parseFloat(n.discountAmount)||0,T=n.discountReason||"",H=parseFloat(n.discountedAmount)||_;return i.jsx("div",{className:"fixed inset-0 bg-white z-50 p-0 m-0 overflow-auto",children:i.jsxs("div",{className:"print-container",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4 p-4 bg-white border-b print:hidden",children:[i.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Parent Payment Receipt"}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsxs("button",{onClick:r,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700",children:[i.jsx(mi,{className:"mr-2"})," Print Receipt"]}),i.jsx("button",{onClick:s,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Back to Student Details"})]})]}),i.jsx("div",{className:"print-container flex justify-center",children:i.jsxs("div",{className:"receipt-content",style:{width:"210mm",minHeight:"297mm",padding:"10mm"},children:[i.jsxs("div",{className:"text-center mb-6",children:[e.logo?i.jsx("img",{src:e.logo,alt:"School Logo",className:"mx-auto h-16 mb-3"}):i.jsx("img",{src:Ub,alt:"School Logo",className:"mx-auto mb-3",style:{maxWidth:"120px",maxHeight:"60px",objectFit:"contain"}}),i.jsxs("div",{className:"text-center",children:[i.jsx("h1",{className:"font-bold text-xl",children:e.name}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.address}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Phone: ",e.phone]})]})]}),i.jsx("div",{className:"text-center mb-6",children:i.jsx("div",{className:"inline-block bg-green-100 text-green-800 px-6 py-3 rounded-lg font-bold text-xl border-2 border-green-500",children:"PAYMENT RECEIPT"})}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6 text-sm",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-200",children:[i.jsx("span",{className:"font-medium",children:"Receipt Date:"}),i.jsx("span",{children:f()})]}),i.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-200",children:[i.jsx("span",{className:"font-medium",children:"Payment Date:"}),i.jsx("span",{children:u(n.date)})]}),i.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-200",children:[i.jsx("span",{className:"font-medium",children:"Due Date:"}),i.jsx("span",{children:u(n.dueDate)})]})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-200",children:[i.jsx("span",{className:"font-medium",children:"Challan ID:"}),i.jsx("span",{children:n.id})]}),i.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-200",children:[i.jsx("span",{className:"font-medium",children:"GR Number:"}),i.jsx("span",{children:F})]}),i.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-200",children:[i.jsx("span",{className:"font-medium",children:"Payment Method:"}),i.jsx("span",{className:"capitalize",children:n.paymentMethod||"Cash"})]})]})]}),i.jsxs("div",{className:"mb-6 text-sm",children:[i.jsx("h2",{className:"font-bold text-lg mb-3 border-b border-gray-300 pb-1",children:"Student Information"}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"mb-2",children:[i.jsx("span",{className:"font-medium",children:"Student Name:"}),i.jsx("span",{className:"ml-2",children:m})]}),i.jsxs("div",{className:"mb-2",children:[i.jsx("span",{className:"font-medium",children:"Father's Name:"}),i.jsx("span",{className:"ml-2",children:g})]})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"mb-2",children:[i.jsx("span",{className:"font-medium",children:"Class:"}),i.jsxs("span",{className:"ml-2",children:[b," - Section ",j]})]}),i.jsxs("div",{className:"mb-2",children:[i.jsx("span",{className:"font-medium",children:"Month:"}),i.jsx("span",{className:"ml-2",children:n.month})]})]})]})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"font-bold text-lg mb-3 border-b border-gray-300 pb-1",children:"Fee Details"}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[i.jsxs("div",{className:"flex justify-between py-2",children:[i.jsx("span",{children:"Tuition Fees:"}),i.jsxs("span",{children:["Rs. ",C.toFixed(2)]})]}),M>0&&i.jsxs("div",{className:"flex justify-between py-2",children:[i.jsx("span",{children:"Fine (Late Payment):"}),i.jsxs("span",{children:["Rs. ",M.toFixed(2)]})]}),L>0&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex justify-between py-2 border-t border-dashed border-gray-300 mt-2 pt-2",children:[i.jsx("span",{children:"Subtotal:"}),i.jsxs("span",{children:["Rs. ",_.toFixed(2)]})]}),i.jsxs("div",{className:"flex justify-between py-2",children:[i.jsxs("span",{children:["Discount (",T,"):"]}),i.jsxs("span",{className:"text-red-600",children:["- Rs. ",L.toFixed(2)]})]})]}),i.jsxs("div",{className:"flex justify-between py-3 border-t border-gray-300 mt-2 font-bold text-lg",children:[i.jsx("span",{children:"Total Amount Paid:"}),i.jsxs("span",{children:["Rs. ",H.toFixed(2)]})]})]})]}),i.jsx("div",{className:"mb-8",children:i.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[i.jsx("div",{className:"text-center",children:i.jsx("div",{className:"border-t border-gray-400 pt-2 mt-8",children:i.jsx("p",{className:"font-medium",children:"Received By (School)"})})}),i.jsx("div",{className:"text-center",children:i.jsx("div",{className:"border-t border-gray-400 pt-2 mt-8",children:i.jsx("p",{className:"font-medium",children:"Parent/Guardian Signature"})})})]})}),i.jsxs("div",{className:"text-center text-xs text-gray-500 border-t border-gray-300 pt-4",children:[i.jsx("p",{children:"Thank you for your payment. This is a computer-generated receipt and does not require a signature."}),i.jsx("p",{className:"mt-1",children:"For any queries, please contact the school office."})]})]})}),i.jsx("style",{children:`
          @media print {
            @page {
              size: A4 portrait;
              margin: 0;
            }
            
            html, body {
              height: 100%;
              margin: 0 !important;
              padding: 0 !important;
              overflow: hidden !important;
            }
            
            body {
              margin: 0;
              padding: 0;
              font-family: Arial, Helvetica, sans-serif;
              font-size: 14px;
              -webkit-print-color-adjust: exact;
              color-adjust: exact;
            }
            
            .fixed {
              position: static !important;
            }
            
            .print-container {
              padding: 0 !important;
              margin: 0 !important;
              max-width: 100% !important;
              page-break-after: avoid !important;
              page-break-inside: avoid !important;
              width: 100% !important;
              height: auto !important;
              display: flex !important;
              justify-content: center !important;
            }
            
            .receipt-content {
              width: 210mm !important;
              min-height: 297mm !important;
              padding: 10mm !important;
              box-sizing: border-box !important;
              page-break-inside: avoid !important;
              page-break-after: avoid !important;
            }
            
            .print-hidden {
              display: none !important;
            }
            
            /* Hide all other elements except the receipt */
            * {
              visibility: hidden;
            }
            
            .receipt-content, .receipt-content * {
              visibility: visible;
            }
            
            .receipt-content {
              position: absolute;
              left: 0;
              top: 0;
              width: 100%;
            }
          }
        `})]})})},JO=({challan:n,student:a,schoolInfo:t,onPrint:r,onBack:s})=>{if(n.status==="paid")return i.jsx(XO,{challan:n,student:a,schoolInfo:t,onPrint:r,onBack:s});const e={name:t?.schoolName||t?.name||"School Management System",address:t?.schoolAddress||t?.address||"123 Education Street, Learning City",phone:t?.schoolPhone||t?.phone||"+1 (555) 123-4567",bankAccount:t?.bankAccount||"0123456789",logo:t?.logo||null},u=j=>{if(!j)return"N/A";try{return new Date(j).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(F){return console.error("Error formatting date:",F),"Invalid Date"}},f=j=>{if(!j)return"N/A";try{const F=new Date(j);return F.setDate(F.getDate()+10),F.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"Invalid Date"}},m=()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),g=j=>{if(!j)return 0;const F=new Date,C=new Date(j);return F.setHours(0,0,0,0),C.setHours(0,0,0,0),F>C?500:0},b=({copyType:j})=>{const F=a?`${a.firstName} ${a.lastName}`:"N/A",C=a?.fatherName||"N/A",M=a?.class||"N/A",_=a?.section||"N/A",L=a?.grNo||"N/A",T=Math.round(n.amount)||0,H=g(n.dueDate),O=T+H;return i.jsxs("div",{className:"challan-copy border border-gray-400 p-3",style:{width:"32%",display:"inline-block",verticalAlign:"top",margin:"0 0.5%",pageBreakInside:"avoid"},children:[i.jsxs("div",{className:"text-center mb-3",children:[i.jsx("img",{src:Ub,alt:"School Logo",className:"mx-auto mb-2",style:{maxWidth:"100px",maxHeight:"50px",objectFit:"contain"}}),i.jsx("div",{className:"text-center",children:i.jsx("div",{className:"font-bold text-md",children:e.name})})]}),i.jsxs("div",{className:"text-center font-bold text-xs mb-2 border-b border-gray-400 pb-1",children:[j," COPY"]}),i.jsxs("div",{className:"text-xs mb-2",children:[i.jsxs("div",{className:"flex justify-between mb-1",children:[i.jsx("span",{children:"Issue Date:"}),i.jsx("span",{children:m()})]}),i.jsxs("div",{className:"flex justify-between mb-1",children:[i.jsx("span",{children:"Due Date:"}),i.jsx("span",{children:u(n.dueDate)})]}),i.jsxs("div",{className:"flex justify-between mb-1",children:[i.jsx("span",{children:"Expiry Date:"}),i.jsx("span",{children:f(n.dueDate)})]}),i.jsxs("div",{className:"flex justify-between mb-1",children:[i.jsx("span",{children:"GR #:"}),i.jsx("span",{children:L})]})]}),i.jsxs("div",{className:"text-xs mb-2 border-b border-gray-400 pb-2",children:[i.jsxs("div",{className:"mb-1",children:[i.jsx("span",{className:"font-bold",children:"Student Name:"})," ",F]}),i.jsxs("div",{className:"mb-1",children:[i.jsx("span",{className:"font-bold",children:"Father Name:"})," ",C]}),i.jsxs("div",{className:"mb-1",children:[i.jsx("span",{className:"font-bold",children:"Class:"})," ",M," - Section ",_]}),i.jsxs("div",{className:"mb-1",children:[i.jsx("span",{className:"font-bold",children:"Fee for the month of:"})," ",n.month]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-bold",children:"Challan ID:"})," ",n.id]})]}),i.jsxs("div",{className:"text-xs mb-2 border-b border-gray-400 pb-2",children:[i.jsx("div",{className:"font-bold mb-1",children:"Bank Account Number:"}),i.jsx("div",{children:"0123456789"})]}),i.jsx("div",{className:"text-xs mb-2",children:i.jsxs("table",{className:"w-full border border-gray-400",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-200",children:[i.jsx("th",{className:"border border-gray-400 p-1 text-left",children:"Particular"}),i.jsx("th",{className:"border border-gray-400 p-1 text-right",children:"Amount (Rs)"})]})}),i.jsxs("tbody",{children:[i.jsxs("tr",{children:[i.jsx("td",{className:"border border-gray-400 p-1",children:"Tuition Fees"}),i.jsx("td",{className:"border border-gray-400 p-1 text-right",children:T})]}),H>0&&i.jsxs("tr",{children:[i.jsx("td",{className:"border border-gray-400 p-1",children:"Fine (Late Payment)"}),i.jsx("td",{className:"border border-gray-400 p-1 text-right",children:H})]}),i.jsxs("tr",{className:"font-bold",children:[i.jsx("td",{className:"border border-gray-400 p-1",children:"Total"}),i.jsx("td",{className:"border border-gray-400 p-1 text-right",children:O})]})]})]})}),i.jsxs("div",{className:"text-xs mb-2",children:[i.jsxs("div",{className:"flex justify-between font-bold mb-1",children:[i.jsx("span",{children:"Grant Total:"}),i.jsxs("span",{children:["Rs. ",O]})]}),i.jsxs("div",{className:"border border-gray-400 p-2 mb-2",children:[i.jsx("div",{className:"font-bold mb-1",children:"Payment Received:"}),i.jsx("div",{children:"Signature: ________________________"})]})]}),i.jsxs("div",{className:"text-xs text-center border-t border-gray-400 pt-2",children:[i.jsx("div",{className:"mb-1",children:"Late fee will be charged if not paid on time"}),i.jsx("div",{children:"For queries contact: +1 (555) 123-4567"})]})]})};return i.jsx("div",{className:"fixed inset-0 bg-white z-50 p-0 m-0 overflow-auto",children:i.jsxs("div",{className:"print-container",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4 p-4 bg-white border-b print:hidden",children:[i.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Challan Print Preview"}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsxs("button",{onClick:r,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700",children:[i.jsx(mi,{className:"mr-2"})," Print Challan"]}),i.jsx("button",{onClick:s,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Back to Student Details"})]})]}),i.jsx("div",{className:"print-container",children:i.jsxs("div",{className:"challan-page",style:{pageBreakAfter:"avoid",pageBreakInside:"avoid",display:"block",width:"100%"},children:[i.jsx(b,{copyType:"STUDENT"}),i.jsx(b,{copyType:"BANK"}),i.jsx(b,{copyType:"SCHOOL"})]})}),i.jsx("style",{children:`
          @media print {
            @page {
              size: A4;
              margin: 0;
            }
            
            html, body {
              height: 100%;
              margin: 0 !important;
              padding: 0 !important;
              overflow: hidden !important;
            }
            
            body {
              margin: 0;
              padding: 0;
              font-family: Arial, Helvetica, sans-serif;
              font-size: 12px;
              -webkit-print-color-adjust: exact;
              color-adjust: exact;
            }
            
            .fixed {
              position: static !important;
            }
            
            .print-container {
              padding: 0 !important;
              margin: 0 !important;
              max-width: 100% !important;
              page-break-after: avoid !important;
              page-break-inside: avoid !important;
              width: 100% !important;
              height: auto !important;
            }
            
            .print-hidden {
              display: none !important;
            }
            
            .challan-page {
              page-break-after: avoid !important;
              page-break-inside: avoid !important;
              display: block !important;
              width: 100% !important;
              height: auto !important;
              margin: 0 !important;
              padding: 0 !important;
            }
            
            .challan-copy {
              width: 32% !important;
              display: inline-block !important;
              vertical-align: top !important;
              margin: 0 0.5% !important;
              border: 1px solid #000 !important;
              padding: 5px !important;
              box-sizing: border-box !important;
              page-break-inside: avoid !important;
              page-break-after: avoid !important;
            }
            
            table {
              width: 100%;
              border-collapse: collapse;
              font-size: 10px;
            }
            
            th, td {
              border: 1px solid #000;
              padding: 2px;
              text-align: left;
            }
            
            th {
              background-color: #f0f0f0;
              font-weight: bold;
            }
            
            .text-right {
              text-align: right;
            }
            
            .text-center {
              text-align: center;
            }
            
            .font-bold {
              font-weight: bold;
            }
            
            .border {
              border: 1px solid #000;
            }
            
            .border-b {
              border-bottom: 1px solid #000;
            }
            
            .border-t {
              border-top: 1px solid #000;
            }
            
            .p-1 {
              padding: 2px;
            }
            
            .p-2 {
              padding: 3px;
            }
            
            .p-3 {
              padding: 5px;
            }
            
            .mb-1 {
              margin-bottom: 2px;
            }
            
            .mb-2 {
              margin-bottom: 3px;
            }
            
            .mb-3 {
              margin-bottom: 5px;
            }
            
            .text-xs {
              font-size: 10px;
            }
            
            .text-sm {
              font-size: 11px;
            }
            
            /* Hide all other elements except the challan */
            * {
              visibility: hidden;
            }
            
            .challan-page, .challan-page * {
              visibility: visible;
            }
            
            .challan-page {
              position: absolute;
              left: 0;
              top: 0;
              width: 100%;
            }
          }
        `})]})})};/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Cw=function(n,a){return Cw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])},Cw(n,a)};function Ed(n,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");Cw(n,a);function t(){this.constructor=n}n.prototype=a===null?Object.create(a):(t.prototype=a.prototype,new t)}var jw=function(){return jw=Object.assign||function(a){for(var t,r=1,s=arguments.length;r<s;r++){t=arguments[r];for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(a[e]=t[e])}return a},jw.apply(this,arguments)};function rc(n,a,t,r){function s(e){return e instanceof t?e:new t(function(u){u(e)})}return new(t||(t=Promise))(function(e,u){function f(b){try{g(r.next(b))}catch(j){u(j)}}function m(b){try{g(r.throw(b))}catch(j){u(j)}}function g(b){b.done?e(b.value):s(b.value).then(f,m)}g((r=r.apply(n,[])).next())})}function Il(n,a){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},r,s,e,u;return u={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function f(g){return function(b){return m([g,b])}}function m(g){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,s&&(e=g[0]&2?s.return:g[0]?s.throw||((e=s.return)&&e.call(s),0):s.next)&&!(e=e.call(s,g[1])).done)return e;switch(s=0,e&&(g=[g[0]&2,e.value]),g[0]){case 0:case 1:e=g;break;case 4:return t.label++,{value:g[1],done:!1};case 5:t.label++,s=g[1],g=[0];continue;case 7:g=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(g[0]===6||g[0]===2)){t=0;continue}if(g[0]===3&&(!e||g[1]>e[0]&&g[1]<e[3])){t.label=g[1];break}if(g[0]===6&&t.label<e[1]){t.label=e[1],e=g;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(g);break}e[2]&&t.ops.pop(),t.trys.pop();continue}g=a.call(n,t)}catch(b){g=[6,b],s=0}finally{r=e=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}}function zx(n,a,t){if(arguments.length===2)for(var r=0,s=a.length,e;r<s;r++)(e||!(r in a))&&(e||(e=Array.prototype.slice.call(a,0,r)),e[r]=a[r]);return n.concat(e||a)}var lf=(function(){function n(a,t,r,s){this.left=a,this.top=t,this.width=r,this.height=s}return n.prototype.add=function(a,t,r,s){return new n(this.left+a,this.top+t,this.width+r,this.height+s)},n.fromClientRect=function(a,t){return new n(t.left+a.windowBounds.left,t.top+a.windowBounds.top,t.width,t.height)},n.fromDOMRectList=function(a,t){var r=Array.from(t).find(function(s){return s.width!==0});return r?new n(r.left+a.windowBounds.left,r.top+a.windowBounds.top,r.width,r.height):n.EMPTY},n.EMPTY=new n(0,0,0,0),n})(),Wb=function(n,a){return lf.fromClientRect(n,a.getBoundingClientRect())},ZO=function(n){var a=n.body,t=n.documentElement;if(!a||!t)throw new Error("Unable to get document size");var r=Math.max(Math.max(a.scrollWidth,t.scrollWidth),Math.max(a.offsetWidth,t.offsetWidth),Math.max(a.clientWidth,t.clientWidth)),s=Math.max(Math.max(a.scrollHeight,t.scrollHeight),Math.max(a.offsetHeight,t.offsetHeight),Math.max(a.clientHeight,t.clientHeight));return new lf(0,0,r,s)},$b=function(n){for(var a=[],t=0,r=n.length;t<r;){var s=n.charCodeAt(t++);if(s>=55296&&s<=56319&&t<r){var e=n.charCodeAt(t++);(e&64512)===56320?a.push(((s&1023)<<10)+(e&1023)+65536):(a.push(s),t--)}else a.push(s)}return a},ro=function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];if(String.fromCodePoint)return String.fromCodePoint.apply(String,n);var t=n.length;if(!t)return"";for(var r=[],s=-1,e="";++s<t;){var u=n[s];u<=65535?r.push(u):(u-=65536,r.push((u>>10)+55296,u%1024+56320)),(s+1===t||r.length>16384)&&(e+=String.fromCharCode.apply(String,r),r.length=0)}return e},U6="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",eQ=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Kx=0;Kx<U6.length;Kx++)eQ[U6.charCodeAt(Kx)]=Kx;var M6="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",k1=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Gx=0;Gx<M6.length;Gx++)k1[M6.charCodeAt(Gx)]=Gx;var tQ=function(n){var a=n.length*.75,t=n.length,r,s=0,e,u,f,m;n[n.length-1]==="="&&(a--,n[n.length-2]==="="&&a--);var g=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(a):new Array(a),b=Array.isArray(g)?g:new Uint8Array(g);for(r=0;r<t;r+=4)e=k1[n.charCodeAt(r)],u=k1[n.charCodeAt(r+1)],f=k1[n.charCodeAt(r+2)],m=k1[n.charCodeAt(r+3)],b[s++]=e<<2|u>>4,b[s++]=(u&15)<<4|f>>2,b[s++]=(f&3)<<6|m&63;return g},rQ=function(n){for(var a=n.length,t=[],r=0;r<a;r+=2)t.push(n[r+1]<<8|n[r]);return t},aQ=function(n){for(var a=n.length,t=[],r=0;r<a;r+=4)t.push(n[r+3]<<24|n[r+2]<<16|n[r+1]<<8|n[r]);return t},gh=5,U5=11,hv=2,sQ=U5-gh,P8=65536>>gh,nQ=1<<gh,mv=nQ-1,iQ=1024>>gh,oQ=P8+iQ,lQ=oQ,cQ=32,AQ=lQ+cQ,dQ=65536>>U5,uQ=1<<sQ,fQ=uQ-1,I6=function(n,a,t){return n.slice?n.slice(a,t):new Uint16Array(Array.prototype.slice.call(n,a,t))},hQ=function(n,a,t){return n.slice?n.slice(a,t):new Uint32Array(Array.prototype.slice.call(n,a,t))},mQ=function(n,a){var t=tQ(n),r=Array.isArray(t)?aQ(t):new Uint32Array(t),s=Array.isArray(t)?rQ(t):new Uint16Array(t),e=24,u=I6(s,e/2,r[4]/2),f=r[5]===2?I6(s,(e+r[4])/2):hQ(r,Math.ceil((e+r[4])/4));return new pQ(r[0],r[1],r[2],r[3],u,f)},pQ=(function(){function n(a,t,r,s,e,u){this.initialValue=a,this.errorValue=t,this.highStart=r,this.highValueIndex=s,this.index=e,this.data=u}return n.prototype.get=function(a){var t;if(a>=0){if(a<55296||a>56319&&a<=65535)return t=this.index[a>>gh],t=(t<<hv)+(a&mv),this.data[t];if(a<=65535)return t=this.index[P8+(a-55296>>gh)],t=(t<<hv)+(a&mv),this.data[t];if(a<this.highStart)return t=AQ-dQ+(a>>U5),t=this.index[t],t+=a>>gh&fQ,t=this.index[t],t=(t<<hv)+(a&mv),this.data[t];if(a<=1114111)return this.data[this.highValueIndex]}return this.errorValue},n})(),O6="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",gQ=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Vx=0;Vx<O6.length;Vx++)gQ[O6.charCodeAt(Vx)]=Vx;var xQ="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",Q6=50,bQ=1,H8=2,z8=3,yQ=4,vQ=5,R6=7,K8=8,P6=9,e0=10,Bw=11,H6=12,Sw=13,wQ=14,D1=15,Fw=16,Yx=17,N1=18,NQ=19,z6=20,Ew=21,C1=22,pv=23,km=24,lA=25,T1=26,_1=27,Dm=28,CQ=29,oh=30,jQ=31,Wx=32,$x=33,kw=34,Dw=35,Tw=36,lg=37,_w=38,U2=39,M2=40,gv=41,G8=42,BQ=43,SQ=[9001,65288],V8="!",Cs="",qx="",Lw=mQ(xQ),Ku=[oh,Tw],Uw=[bQ,H8,z8,vQ],Y8=[e0,K8],K6=[_1,T1],FQ=Uw.concat(Y8),G6=[_w,U2,M2,kw,Dw],EQ=[D1,Sw],kQ=function(n,a){a===void 0&&(a="strict");var t=[],r=[],s=[];return n.forEach(function(e,u){var f=Lw.get(e);if(f>Q6?(s.push(!0),f-=Q6):s.push(!1),["normal","auto","loose"].indexOf(a)!==-1&&[8208,8211,12316,12448].indexOf(e)!==-1)return r.push(u),t.push(Fw);if(f===yQ||f===Bw){if(u===0)return r.push(u),t.push(oh);var m=t[u-1];return FQ.indexOf(m)===-1?(r.push(r[u-1]),t.push(m)):(r.push(u),t.push(oh))}if(r.push(u),f===jQ)return t.push(a==="strict"?Ew:lg);if(f===G8||f===CQ)return t.push(oh);if(f===BQ)return e>=131072&&e<=196605||e>=196608&&e<=262141?t.push(lg):t.push(oh);t.push(f)}),[r,t,s]},xv=function(n,a,t,r){var s=r[t];if(Array.isArray(n)?n.indexOf(s)!==-1:n===s)for(var e=t;e<=r.length;){e++;var u=r[e];if(u===a)return!0;if(u!==e0)break}if(s===e0)for(var e=t;e>0;){e--;var f=r[e];if(Array.isArray(n)?n.indexOf(f)!==-1:n===f)for(var m=t;m<=r.length;){m++;var u=r[m];if(u===a)return!0;if(u!==e0)break}if(f!==e0)break}return!1},V6=function(n,a){for(var t=n;t>=0;){var r=a[t];if(r===e0)t--;else return r}return 0},DQ=function(n,a,t,r,s){if(t[r]===0)return Cs;var e=r-1;if(Array.isArray(s)&&s[e]===!0)return Cs;var u=e-1,f=e+1,m=a[e],g=u>=0?a[u]:0,b=a[f];if(m===H8&&b===z8)return Cs;if(Uw.indexOf(m)!==-1)return V8;if(Uw.indexOf(b)!==-1||Y8.indexOf(b)!==-1)return Cs;if(V6(e,a)===K8)return qx;if(Lw.get(n[e])===Bw||(m===Wx||m===$x)&&Lw.get(n[f])===Bw||m===R6||b===R6||m===P6||[e0,Sw,D1].indexOf(m)===-1&&b===P6||[Yx,N1,NQ,km,Dm].indexOf(b)!==-1||V6(e,a)===C1||xv(pv,C1,e,a)||xv([Yx,N1],Ew,e,a)||xv(H6,H6,e,a))return Cs;if(m===e0)return qx;if(m===pv||b===pv)return Cs;if(b===Fw||m===Fw)return qx;if([Sw,D1,Ew].indexOf(b)!==-1||m===wQ||g===Tw&&EQ.indexOf(m)!==-1||m===Dm&&b===Tw||b===z6||Ku.indexOf(b)!==-1&&m===lA||Ku.indexOf(m)!==-1&&b===lA||m===_1&&[lg,Wx,$x].indexOf(b)!==-1||[lg,Wx,$x].indexOf(m)!==-1&&b===T1||Ku.indexOf(m)!==-1&&K6.indexOf(b)!==-1||K6.indexOf(m)!==-1&&Ku.indexOf(b)!==-1||[_1,T1].indexOf(m)!==-1&&(b===lA||[C1,D1].indexOf(b)!==-1&&a[f+1]===lA)||[C1,D1].indexOf(m)!==-1&&b===lA||m===lA&&[lA,Dm,km].indexOf(b)!==-1)return Cs;if([lA,Dm,km,Yx,N1].indexOf(b)!==-1)for(var j=e;j>=0;){var F=a[j];if(F===lA)return Cs;if([Dm,km].indexOf(F)!==-1)j--;else break}if([_1,T1].indexOf(b)!==-1)for(var j=[Yx,N1].indexOf(m)!==-1?u:e;j>=0;){var F=a[j];if(F===lA)return Cs;if([Dm,km].indexOf(F)!==-1)j--;else break}if(_w===m&&[_w,U2,kw,Dw].indexOf(b)!==-1||[U2,kw].indexOf(m)!==-1&&[U2,M2].indexOf(b)!==-1||[M2,Dw].indexOf(m)!==-1&&b===M2||G6.indexOf(m)!==-1&&[z6,T1].indexOf(b)!==-1||G6.indexOf(b)!==-1&&m===_1||Ku.indexOf(m)!==-1&&Ku.indexOf(b)!==-1||m===km&&Ku.indexOf(b)!==-1||Ku.concat(lA).indexOf(m)!==-1&&b===C1&&SQ.indexOf(n[f])===-1||Ku.concat(lA).indexOf(b)!==-1&&m===N1)return Cs;if(m===gv&&b===gv){for(var C=t[e],M=1;C>0&&(C--,a[C]===gv);)M++;if(M%2!==0)return Cs}return m===Wx&&b===$x?Cs:qx},TQ=function(n,a){a||(a={lineBreak:"normal",wordBreak:"normal"});var t=kQ(n,a.lineBreak),r=t[0],s=t[1],e=t[2];(a.wordBreak==="break-all"||a.wordBreak==="break-word")&&(s=s.map(function(f){return[lA,oh,G8].indexOf(f)!==-1?lg:f}));var u=a.wordBreak==="keep-all"?e.map(function(f,m){return f&&n[m]>=19968&&n[m]<=40959}):void 0;return[r,s,u]},_Q=(function(){function n(a,t,r,s){this.codePoints=a,this.required=t===V8,this.start=r,this.end=s}return n.prototype.slice=function(){return ro.apply(void 0,this.codePoints.slice(this.start,this.end))},n})(),LQ=function(n,a){var t=$b(n),r=TQ(t,a),s=r[0],e=r[1],u=r[2],f=t.length,m=0,g=0;return{next:function(){if(g>=f)return{done:!0,value:null};for(var b=Cs;g<f&&(b=DQ(t,e,s,++g,u))===Cs;);if(b!==Cs||g===f){var j=new _Q(t,b,m,g);return m=g,{value:j,done:!1}}return{done:!0,value:null}}}},UQ=1,MQ=2,yg=4,Y6=8,fb=10,W6=47,K1=92,IQ=9,OQ=32,Xx=34,j1=61,QQ=35,RQ=36,PQ=37,Jx=39,Zx=40,B1=41,HQ=95,Dc=45,zQ=33,KQ=60,GQ=62,VQ=64,YQ=91,WQ=93,$Q=61,qQ=123,e2=63,XQ=125,$6=124,JQ=126,ZQ=128,q6=65533,bv=42,Ah=43,eR=44,tR=58,rR=59,cg=46,aR=0,sR=8,nR=11,iR=14,oR=31,lR=127,Xd=-1,W8=48,$8=97,q8=101,cR=102,AR=117,dR=122,X8=65,J8=69,Z8=70,uR=85,fR=90,Ol=function(n){return n>=W8&&n<=57},hR=function(n){return n>=55296&&n<=57343},Tm=function(n){return Ol(n)||n>=X8&&n<=Z8||n>=$8&&n<=cR},mR=function(n){return n>=$8&&n<=dR},pR=function(n){return n>=X8&&n<=fR},gR=function(n){return mR(n)||pR(n)},xR=function(n){return n>=ZQ},t2=function(n){return n===fb||n===IQ||n===OQ},hb=function(n){return gR(n)||xR(n)||n===HQ},X6=function(n){return hb(n)||Ol(n)||n===Dc},bR=function(n){return n>=aR&&n<=sR||n===nR||n>=iR&&n<=oR||n===lR},Xf=function(n,a){return n!==K1?!1:a!==fb},r2=function(n,a,t){return n===Dc?hb(a)||Xf(a,t):hb(n)?!0:!!(n===K1&&Xf(n,a))},yv=function(n,a,t){return n===Ah||n===Dc?Ol(a)?!0:a===cg&&Ol(t):Ol(n===cg?a:n)},yR=function(n){var a=0,t=1;(n[a]===Ah||n[a]===Dc)&&(n[a]===Dc&&(t=-1),a++);for(var r=[];Ol(n[a]);)r.push(n[a++]);var s=r.length?parseInt(ro.apply(void 0,r),10):0;n[a]===cg&&a++;for(var e=[];Ol(n[a]);)e.push(n[a++]);var u=e.length,f=u?parseInt(ro.apply(void 0,e),10):0;(n[a]===J8||n[a]===q8)&&a++;var m=1;(n[a]===Ah||n[a]===Dc)&&(n[a]===Dc&&(m=-1),a++);for(var g=[];Ol(n[a]);)g.push(n[a++]);var b=g.length?parseInt(ro.apply(void 0,g),10):0;return t*(s+f*Math.pow(10,-u))*Math.pow(10,m*b)},vR={type:2},wR={type:3},NR={type:4},CR={type:13},jR={type:8},BR={type:21},SR={type:9},FR={type:10},ER={type:11},kR={type:12},DR={type:14},a2={type:23},TR={type:1},_R={type:25},LR={type:24},UR={type:26},MR={type:27},IR={type:28},OR={type:29},QR={type:31},Mw={type:32},eB=(function(){function n(){this._value=[]}return n.prototype.write=function(a){this._value=this._value.concat($b(a))},n.prototype.read=function(){for(var a=[],t=this.consumeToken();t!==Mw;)a.push(t),t=this.consumeToken();return a},n.prototype.consumeToken=function(){var a=this.consumeCodePoint();switch(a){case Xx:return this.consumeStringToken(Xx);case QQ:var t=this.peekCodePoint(0),r=this.peekCodePoint(1),s=this.peekCodePoint(2);if(X6(t)||Xf(r,s)){var e=r2(t,r,s)?MQ:UQ,u=this.consumeName();return{type:5,value:u,flags:e}}break;case RQ:if(this.peekCodePoint(0)===j1)return this.consumeCodePoint(),CR;break;case Jx:return this.consumeStringToken(Jx);case Zx:return vR;case B1:return wR;case bv:if(this.peekCodePoint(0)===j1)return this.consumeCodePoint(),DR;break;case Ah:if(yv(a,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(a),this.consumeNumericToken();break;case eR:return NR;case Dc:var f=a,m=this.peekCodePoint(0),g=this.peekCodePoint(1);if(yv(f,m,g))return this.reconsumeCodePoint(a),this.consumeNumericToken();if(r2(f,m,g))return this.reconsumeCodePoint(a),this.consumeIdentLikeToken();if(m===Dc&&g===GQ)return this.consumeCodePoint(),this.consumeCodePoint(),LR;break;case cg:if(yv(a,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(a),this.consumeNumericToken();break;case W6:if(this.peekCodePoint(0)===bv)for(this.consumeCodePoint();;){var b=this.consumeCodePoint();if(b===bv&&(b=this.consumeCodePoint(),b===W6))return this.consumeToken();if(b===Xd)return this.consumeToken()}break;case tR:return UR;case rR:return MR;case KQ:if(this.peekCodePoint(0)===zQ&&this.peekCodePoint(1)===Dc&&this.peekCodePoint(2)===Dc)return this.consumeCodePoint(),this.consumeCodePoint(),_R;break;case VQ:var j=this.peekCodePoint(0),F=this.peekCodePoint(1),C=this.peekCodePoint(2);if(r2(j,F,C)){var u=this.consumeName();return{type:7,value:u}}break;case YQ:return IR;case K1:if(Xf(a,this.peekCodePoint(0)))return this.reconsumeCodePoint(a),this.consumeIdentLikeToken();break;case WQ:return OR;case $Q:if(this.peekCodePoint(0)===j1)return this.consumeCodePoint(),jR;break;case qQ:return ER;case XQ:return kR;case AR:case uR:var M=this.peekCodePoint(0),_=this.peekCodePoint(1);return M===Ah&&(Tm(_)||_===e2)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(a),this.consumeIdentLikeToken();case $6:if(this.peekCodePoint(0)===j1)return this.consumeCodePoint(),SR;if(this.peekCodePoint(0)===$6)return this.consumeCodePoint(),BR;break;case JQ:if(this.peekCodePoint(0)===j1)return this.consumeCodePoint(),FR;break;case Xd:return Mw}return t2(a)?(this.consumeWhiteSpace(),QR):Ol(a)?(this.reconsumeCodePoint(a),this.consumeNumericToken()):hb(a)?(this.reconsumeCodePoint(a),this.consumeIdentLikeToken()):{type:6,value:ro(a)}},n.prototype.consumeCodePoint=function(){var a=this._value.shift();return typeof a>"u"?-1:a},n.prototype.reconsumeCodePoint=function(a){this._value.unshift(a)},n.prototype.peekCodePoint=function(a){return a>=this._value.length?-1:this._value[a]},n.prototype.consumeUnicodeRangeToken=function(){for(var a=[],t=this.consumeCodePoint();Tm(t)&&a.length<6;)a.push(t),t=this.consumeCodePoint();for(var r=!1;t===e2&&a.length<6;)a.push(t),t=this.consumeCodePoint(),r=!0;if(r){var s=parseInt(ro.apply(void 0,a.map(function(m){return m===e2?W8:m})),16),e=parseInt(ro.apply(void 0,a.map(function(m){return m===e2?Z8:m})),16);return{type:30,start:s,end:e}}var u=parseInt(ro.apply(void 0,a),16);if(this.peekCodePoint(0)===Dc&&Tm(this.peekCodePoint(1))){this.consumeCodePoint(),t=this.consumeCodePoint();for(var f=[];Tm(t)&&f.length<6;)f.push(t),t=this.consumeCodePoint();var e=parseInt(ro.apply(void 0,f),16);return{type:30,start:u,end:e}}else return{type:30,start:u,end:u}},n.prototype.consumeIdentLikeToken=function(){var a=this.consumeName();return a.toLowerCase()==="url"&&this.peekCodePoint(0)===Zx?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===Zx?(this.consumeCodePoint(),{type:19,value:a}):{type:20,value:a}},n.prototype.consumeUrlToken=function(){var a=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===Xd)return{type:22,value:""};var t=this.peekCodePoint(0);if(t===Jx||t===Xx){var r=this.consumeStringToken(this.consumeCodePoint());return r.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===Xd||this.peekCodePoint(0)===B1)?(this.consumeCodePoint(),{type:22,value:r.value}):(this.consumeBadUrlRemnants(),a2)}for(;;){var s=this.consumeCodePoint();if(s===Xd||s===B1)return{type:22,value:ro.apply(void 0,a)};if(t2(s))return this.consumeWhiteSpace(),this.peekCodePoint(0)===Xd||this.peekCodePoint(0)===B1?(this.consumeCodePoint(),{type:22,value:ro.apply(void 0,a)}):(this.consumeBadUrlRemnants(),a2);if(s===Xx||s===Jx||s===Zx||bR(s))return this.consumeBadUrlRemnants(),a2;if(s===K1)if(Xf(s,this.peekCodePoint(0)))a.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),a2;else a.push(s)}},n.prototype.consumeWhiteSpace=function(){for(;t2(this.peekCodePoint(0));)this.consumeCodePoint()},n.prototype.consumeBadUrlRemnants=function(){for(;;){var a=this.consumeCodePoint();if(a===B1||a===Xd)return;Xf(a,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},n.prototype.consumeStringSlice=function(a){for(var t=5e4,r="";a>0;){var s=Math.min(t,a);r+=ro.apply(void 0,this._value.splice(0,s)),a-=s}return this._value.shift(),r},n.prototype.consumeStringToken=function(a){var t="",r=0;do{var s=this._value[r];if(s===Xd||s===void 0||s===a)return t+=this.consumeStringSlice(r),{type:0,value:t};if(s===fb)return this._value.splice(0,r),TR;if(s===K1){var e=this._value[r+1];e!==Xd&&e!==void 0&&(e===fb?(t+=this.consumeStringSlice(r),r=-1,this._value.shift()):Xf(s,e)&&(t+=this.consumeStringSlice(r),t+=ro(this.consumeEscapedCodePoint()),r=-1))}r++}while(!0)},n.prototype.consumeNumber=function(){var a=[],t=yg,r=this.peekCodePoint(0);for((r===Ah||r===Dc)&&a.push(this.consumeCodePoint());Ol(this.peekCodePoint(0));)a.push(this.consumeCodePoint());r=this.peekCodePoint(0);var s=this.peekCodePoint(1);if(r===cg&&Ol(s))for(a.push(this.consumeCodePoint(),this.consumeCodePoint()),t=Y6;Ol(this.peekCodePoint(0));)a.push(this.consumeCodePoint());r=this.peekCodePoint(0),s=this.peekCodePoint(1);var e=this.peekCodePoint(2);if((r===J8||r===q8)&&((s===Ah||s===Dc)&&Ol(e)||Ol(s)))for(a.push(this.consumeCodePoint(),this.consumeCodePoint()),t=Y6;Ol(this.peekCodePoint(0));)a.push(this.consumeCodePoint());return[yR(a),t]},n.prototype.consumeNumericToken=function(){var a=this.consumeNumber(),t=a[0],r=a[1],s=this.peekCodePoint(0),e=this.peekCodePoint(1),u=this.peekCodePoint(2);if(r2(s,e,u)){var f=this.consumeName();return{type:15,number:t,flags:r,unit:f}}return s===PQ?(this.consumeCodePoint(),{type:16,number:t,flags:r}):{type:17,number:t,flags:r}},n.prototype.consumeEscapedCodePoint=function(){var a=this.consumeCodePoint();if(Tm(a)){for(var t=ro(a);Tm(this.peekCodePoint(0))&&t.length<6;)t+=ro(this.consumeCodePoint());t2(this.peekCodePoint(0))&&this.consumeCodePoint();var r=parseInt(t,16);return r===0||hR(r)||r>1114111?q6:r}return a===Xd?q6:a},n.prototype.consumeName=function(){for(var a="";;){var t=this.consumeCodePoint();if(X6(t))a+=ro(t);else if(Xf(t,this.peekCodePoint(0)))a+=ro(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(t),a}},n})(),tB=(function(){function n(a){this._tokens=a}return n.create=function(a){var t=new eB;return t.write(a),new n(t.read())},n.parseValue=function(a){return n.create(a).parseComponentValue()},n.parseValues=function(a){return n.create(a).parseComponentValues()},n.prototype.parseComponentValue=function(){for(var a=this.consumeToken();a.type===31;)a=this.consumeToken();if(a.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(a);var t=this.consumeComponentValue();do a=this.consumeToken();while(a.type===31);if(a.type===32)return t;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},n.prototype.parseComponentValues=function(){for(var a=[];;){var t=this.consumeComponentValue();if(t.type===32)return a;a.push(t),a.push()}},n.prototype.consumeComponentValue=function(){var a=this.consumeToken();switch(a.type){case 11:case 28:case 2:return this.consumeSimpleBlock(a.type);case 19:return this.consumeFunction(a)}return a},n.prototype.consumeSimpleBlock=function(a){for(var t={type:a,values:[]},r=this.consumeToken();;){if(r.type===32||PR(r,a))return t;this.reconsumeToken(r),t.values.push(this.consumeComponentValue()),r=this.consumeToken()}},n.prototype.consumeFunction=function(a){for(var t={name:a.value,values:[],type:18};;){var r=this.consumeToken();if(r.type===32||r.type===3)return t;this.reconsumeToken(r),t.values.push(this.consumeComponentValue())}},n.prototype.consumeToken=function(){var a=this._tokens.shift();return typeof a>"u"?Mw:a},n.prototype.reconsumeToken=function(a){this._tokens.unshift(a)},n})(),vg=function(n){return n.type===15},mp=function(n){return n.type===17},Dn=function(n){return n.type===20},RR=function(n){return n.type===0},Iw=function(n,a){return Dn(n)&&n.value===a},rB=function(n){return n.type!==31},cp=function(n){return n.type!==31&&n.type!==4},fu=function(n){var a=[],t=[];return n.forEach(function(r){if(r.type===4){if(t.length===0)throw new Error("Error parsing function args, zero tokens for arg");a.push(t),t=[];return}r.type!==31&&t.push(r)}),t.length&&a.push(t),a},PR=function(n,a){return a===11&&n.type===12||a===28&&n.type===29?!0:a===2&&n.type===3},m0=function(n){return n.type===17||n.type===15},wo=function(n){return n.type===16||m0(n)},aB=function(n){return n.length>1?[n[0],n[1]]:[n[0]]},pl={type:17,number:0,flags:yg},M5={type:16,number:50,flags:yg},t0={type:16,number:100,flags:yg},L1=function(n,a,t){var r=n[0],s=n[1];return[ei(r,a),ei(typeof s<"u"?s:r,t)]},ei=function(n,a){if(n.type===16)return n.number/100*a;if(vg(n))switch(n.unit){case"rem":case"em":return 16*n.number;case"px":default:return n.number}return n.number},sB="deg",nB="grad",iB="rad",oB="turn",qb={name:"angle",parse:function(n,a){if(a.type===15)switch(a.unit){case sB:return Math.PI*a.number/180;case nB:return Math.PI/200*a.number;case iB:return a.number;case oB:return Math.PI*2*a.number}throw new Error("Unsupported angle type")}},lB=function(n){return n.type===15&&(n.unit===sB||n.unit===nB||n.unit===iB||n.unit===oB)},cB=function(n){var a=n.filter(Dn).map(function(t){return t.value}).join(" ");switch(a){case"to bottom right":case"to right bottom":case"left top":case"top left":return[pl,pl];case"to top":case"bottom":return UA(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[pl,t0];case"to right":case"left":return UA(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[t0,t0];case"to bottom":case"top":return UA(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[t0,pl];case"to left":case"right":return UA(270)}return 0},UA=function(n){return Math.PI*n/180},c0={name:"color",parse:function(n,a){if(a.type===18){var t=HR[a.name];if(typeof t>"u")throw new Error('Attempting to parse an unsupported color function "'+a.name+'"');return t(n,a.values)}if(a.type===5){if(a.value.length===3){var r=a.value.substring(0,1),s=a.value.substring(1,2),e=a.value.substring(2,3);return r0(parseInt(r+r,16),parseInt(s+s,16),parseInt(e+e,16),1)}if(a.value.length===4){var r=a.value.substring(0,1),s=a.value.substring(1,2),e=a.value.substring(2,3),u=a.value.substring(3,4);return r0(parseInt(r+r,16),parseInt(s+s,16),parseInt(e+e,16),parseInt(u+u,16)/255)}if(a.value.length===6){var r=a.value.substring(0,2),s=a.value.substring(2,4),e=a.value.substring(4,6);return r0(parseInt(r,16),parseInt(s,16),parseInt(e,16),1)}if(a.value.length===8){var r=a.value.substring(0,2),s=a.value.substring(2,4),e=a.value.substring(4,6),u=a.value.substring(6,8);return r0(parseInt(r,16),parseInt(s,16),parseInt(e,16),parseInt(u,16)/255)}}if(a.type===20){var f=rf[a.value.toUpperCase()];if(typeof f<"u")return f}return rf.TRANSPARENT}},A0=function(n){return(255&n)===0},Ko=function(n){var a=255&n,t=255&n>>8,r=255&n>>16,s=255&n>>24;return a<255?"rgba("+s+","+r+","+t+","+a/255+")":"rgb("+s+","+r+","+t+")"},r0=function(n,a,t,r){return(n<<24|a<<16|t<<8|Math.round(r*255)<<0)>>>0},J6=function(n,a){if(n.type===17)return n.number;if(n.type===16){var t=a===3?1:255;return a===3?n.number/100*t:Math.round(n.number/100*t)}return 0},Z6=function(n,a){var t=a.filter(cp);if(t.length===3){var r=t.map(J6),s=r[0],e=r[1],u=r[2];return r0(s,e,u,1)}if(t.length===4){var f=t.map(J6),s=f[0],e=f[1],u=f[2],m=f[3];return r0(s,e,u,m)}return 0};function vv(n,a,t){return t<0&&(t+=1),t>=1&&(t-=1),t<1/6?(a-n)*t*6+n:t<1/2?a:t<2/3?(a-n)*6*(2/3-t)+n:n}var eN=function(n,a){var t=a.filter(cp),r=t[0],s=t[1],e=t[2],u=t[3],f=(r.type===17?UA(r.number):qb.parse(n,r))/(Math.PI*2),m=wo(s)?s.number/100:0,g=wo(e)?e.number/100:0,b=typeof u<"u"&&wo(u)?ei(u,1):1;if(m===0)return r0(g*255,g*255,g*255,1);var j=g<=.5?g*(m+1):g+m-g*m,F=g*2-j,C=vv(F,j,f+1/3),M=vv(F,j,f),_=vv(F,j,f-1/3);return r0(C*255,M*255,_*255,b)},HR={hsl:eN,hsla:eN,rgb:Z6,rgba:Z6},G1=function(n,a){return c0.parse(n,tB.create(a).parseComponentValue())},rf={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},zR={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(n,a){return a.map(function(t){if(Dn(t))switch(t.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},KR={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Xb=function(n,a){var t=c0.parse(n,a[0]),r=a[1];return r&&wo(r)?{color:t,stop:r}:{color:t,stop:null}},tN=function(n,a){var t=n[0],r=n[n.length-1];t.stop===null&&(t.stop=pl),r.stop===null&&(r.stop=t0);for(var s=[],e=0,u=0;u<n.length;u++){var f=n[u].stop;if(f!==null){var m=ei(f,a);m>e?s.push(m):s.push(e),e=m}else s.push(null)}for(var g=null,u=0;u<s.length;u++){var b=s[u];if(b===null)g===null&&(g=u);else if(g!==null){for(var j=u-g,F=s[g-1],C=(b-F)/(j+1),M=1;M<=j;M++)s[g+M-1]=C*M;g=null}}return n.map(function(_,L){var T=_.color;return{color:T,stop:Math.max(Math.min(1,s[L]/a),0)}})},GR=function(n,a,t){var r=a/2,s=t/2,e=ei(n[0],a)-r,u=s-ei(n[1],t);return(Math.atan2(u,e)+Math.PI*2)%(Math.PI*2)},VR=function(n,a,t){var r=typeof n=="number"?n:GR(n,a,t),s=Math.abs(a*Math.sin(r))+Math.abs(t*Math.cos(r)),e=a/2,u=t/2,f=s/2,m=Math.sin(r-Math.PI/2)*f,g=Math.cos(r-Math.PI/2)*f;return[s,e-g,e+g,u-m,u+m]},hd=function(n,a){return Math.sqrt(n*n+a*a)},rN=function(n,a,t,r,s){var e=[[0,0],[0,a],[n,0],[n,a]];return e.reduce(function(u,f){var m=f[0],g=f[1],b=hd(t-m,r-g);return(s?b<u.optimumDistance:b>u.optimumDistance)?{optimumCorner:f,optimumDistance:b}:u},{optimumDistance:s?1/0:-1/0,optimumCorner:null}).optimumCorner},YR=function(n,a,t,r,s){var e=0,u=0;switch(n.size){case 0:n.shape===0?e=u=Math.min(Math.abs(a),Math.abs(a-r),Math.abs(t),Math.abs(t-s)):n.shape===1&&(e=Math.min(Math.abs(a),Math.abs(a-r)),u=Math.min(Math.abs(t),Math.abs(t-s)));break;case 2:if(n.shape===0)e=u=Math.min(hd(a,t),hd(a,t-s),hd(a-r,t),hd(a-r,t-s));else if(n.shape===1){var f=Math.min(Math.abs(t),Math.abs(t-s))/Math.min(Math.abs(a),Math.abs(a-r)),m=rN(r,s,a,t,!0),g=m[0],b=m[1];e=hd(g-a,(b-t)/f),u=f*e}break;case 1:n.shape===0?e=u=Math.max(Math.abs(a),Math.abs(a-r),Math.abs(t),Math.abs(t-s)):n.shape===1&&(e=Math.max(Math.abs(a),Math.abs(a-r)),u=Math.max(Math.abs(t),Math.abs(t-s)));break;case 3:if(n.shape===0)e=u=Math.max(hd(a,t),hd(a,t-s),hd(a-r,t),hd(a-r,t-s));else if(n.shape===1){var f=Math.max(Math.abs(t),Math.abs(t-s))/Math.max(Math.abs(a),Math.abs(a-r)),j=rN(r,s,a,t,!1),g=j[0],b=j[1];e=hd(g-a,(b-t)/f),u=f*e}break}return Array.isArray(n.size)&&(e=ei(n.size[0],r),u=n.size.length===2?ei(n.size[1],s):e),[e,u]},WR=function(n,a){var t=UA(180),r=[];return fu(a).forEach(function(s,e){if(e===0){var u=s[0];if(u.type===20&&u.value==="to"){t=cB(s);return}else if(lB(u)){t=qb.parse(n,u);return}}var f=Xb(n,s);r.push(f)}),{angle:t,stops:r,type:1}},s2=function(n,a){var t=UA(180),r=[];return fu(a).forEach(function(s,e){if(e===0){var u=s[0];if(u.type===20&&["top","left","right","bottom"].indexOf(u.value)!==-1){t=cB(s);return}else if(lB(u)){t=(qb.parse(n,u)+UA(270))%UA(360);return}}var f=Xb(n,s);r.push(f)}),{angle:t,stops:r,type:1}},$R=function(n,a){var t=UA(180),r=[],s=1,e=0,u=3,f=[];return fu(a).forEach(function(m,g){var b=m[0];if(g===0){if(Dn(b)&&b.value==="linear"){s=1;return}else if(Dn(b)&&b.value==="radial"){s=2;return}}if(b.type===18){if(b.name==="from"){var j=c0.parse(n,b.values[0]);r.push({stop:pl,color:j})}else if(b.name==="to"){var j=c0.parse(n,b.values[0]);r.push({stop:t0,color:j})}else if(b.name==="color-stop"){var F=b.values.filter(cp);if(F.length===2){var j=c0.parse(n,F[1]),C=F[0];mp(C)&&r.push({stop:{type:16,number:C.number*100,flags:C.flags},color:j})}}}}),s===1?{angle:(t+UA(180))%UA(360),stops:r,type:s}:{size:u,shape:e,stops:r,position:f,type:s}},AB="closest-side",dB="farthest-side",uB="closest-corner",fB="farthest-corner",hB="circle",mB="ellipse",pB="cover",gB="contain",qR=function(n,a){var t=0,r=3,s=[],e=[];return fu(a).forEach(function(u,f){var m=!0;if(f===0){var g=!1;m=u.reduce(function(j,F){if(g)if(Dn(F))switch(F.value){case"center":return e.push(M5),j;case"top":case"left":return e.push(pl),j;case"right":case"bottom":return e.push(t0),j}else(wo(F)||m0(F))&&e.push(F);else if(Dn(F))switch(F.value){case hB:return t=0,!1;case mB:return t=1,!1;case"at":return g=!0,!1;case AB:return r=0,!1;case pB:case dB:return r=1,!1;case gB:case uB:return r=2,!1;case fB:return r=3,!1}else if(m0(F)||wo(F))return Array.isArray(r)||(r=[]),r.push(F),!1;return j},m)}if(m){var b=Xb(n,u);s.push(b)}}),{size:r,shape:t,stops:s,position:e,type:2}},n2=function(n,a){var t=0,r=3,s=[],e=[];return fu(a).forEach(function(u,f){var m=!0;if(f===0?m=u.reduce(function(b,j){if(Dn(j))switch(j.value){case"center":return e.push(M5),!1;case"top":case"left":return e.push(pl),!1;case"right":case"bottom":return e.push(t0),!1}else if(wo(j)||m0(j))return e.push(j),!1;return b},m):f===1&&(m=u.reduce(function(b,j){if(Dn(j))switch(j.value){case hB:return t=0,!1;case mB:return t=1,!1;case gB:case AB:return r=0,!1;case dB:return r=1,!1;case uB:return r=2,!1;case pB:case fB:return r=3,!1}else if(m0(j)||wo(j))return Array.isArray(r)||(r=[]),r.push(j),!1;return b},m)),m){var g=Xb(n,u);s.push(g)}}),{size:r,shape:t,stops:s,position:e,type:2}},XR=function(n){return n.type===1},JR=function(n){return n.type===2},I5={name:"image",parse:function(n,a){if(a.type===22){var t={url:a.value,type:0};return n.cache.addImage(a.value),t}if(a.type===18){var r=xB[a.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported image function "'+a.name+'"');return r(n,a.values)}throw new Error("Unsupported image type "+a.type)}};function ZR(n){return!(n.type===20&&n.value==="none")&&(n.type!==18||!!xB[n.name])}var xB={"linear-gradient":WR,"-moz-linear-gradient":s2,"-ms-linear-gradient":s2,"-o-linear-gradient":s2,"-webkit-linear-gradient":s2,"radial-gradient":qR,"-moz-radial-gradient":n2,"-ms-radial-gradient":n2,"-o-radial-gradient":n2,"-webkit-radial-gradient":n2,"-webkit-gradient":$R},eP={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(n,a){if(a.length===0)return[];var t=a[0];return t.type===20&&t.value==="none"?[]:a.filter(function(r){return cp(r)&&ZR(r)}).map(function(r){return I5.parse(n,r)})}},tP={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(n,a){return a.map(function(t){if(Dn(t))switch(t.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},rP={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(n,a){return fu(a).map(function(t){return t.filter(wo)}).map(aB)}},aP={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(n,a){return fu(a).map(function(t){return t.filter(Dn).map(function(r){return r.value}).join(" ")}).map(sP)}},sP=function(n){switch(n){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},Xm;(function(n){n.AUTO="auto",n.CONTAIN="contain",n.COVER="cover"})(Xm||(Xm={}));var nP={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(n,a){return fu(a).map(function(t){return t.filter(iP)})}},iP=function(n){return Dn(n)||wo(n)},Jb=function(n){return{name:"border-"+n+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},oP=Jb("top"),lP=Jb("right"),cP=Jb("bottom"),AP=Jb("left"),Zb=function(n){return{name:"border-radius-"+n,initialValue:"0 0",prefix:!1,type:1,parse:function(a,t){return aB(t.filter(wo))}}},dP=Zb("top-left"),uP=Zb("top-right"),fP=Zb("bottom-right"),hP=Zb("bottom-left"),ey=function(n){return{name:"border-"+n+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(a,t){switch(t){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},mP=ey("top"),pP=ey("right"),gP=ey("bottom"),xP=ey("left"),ty=function(n){return{name:"border-"+n+"-width",initialValue:"0",type:0,prefix:!1,parse:function(a,t){return vg(t)?t.number:0}}},bP=ty("top"),yP=ty("right"),vP=ty("bottom"),wP=ty("left"),NP={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},CP={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(n,a){switch(a){case"rtl":return 1;case"ltr":default:return 0}}},jP={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(n,a){return a.filter(Dn).reduce(function(t,r){return t|BP(r.value)},0)}},BP=function(n){switch(n){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},SP={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(n,a){switch(a){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},FP={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(n,a){return a.type===20&&a.value==="normal"?0:a.type===17||a.type===15?a.number:0}},mb;(function(n){n.NORMAL="normal",n.STRICT="strict"})(mb||(mb={}));var EP={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(n,a){switch(a){case"strict":return mb.STRICT;case"normal":default:return mb.NORMAL}}},kP={name:"line-height",initialValue:"normal",prefix:!1,type:4},aN=function(n,a){return Dn(n)&&n.value==="normal"?1.2*a:n.type===17?a*n.number:wo(n)?ei(n,a):a},DP={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(n,a){return a.type===20&&a.value==="none"?null:I5.parse(n,a)}},TP={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(n,a){switch(a){case"inside":return 0;case"outside":default:return 1}}},Ow={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(n,a){switch(a){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},ry=function(n){return{name:"margin-"+n,initialValue:"0",prefix:!1,type:4}},_P=ry("top"),LP=ry("right"),UP=ry("bottom"),MP=ry("left"),IP={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(n,a){return a.filter(Dn).map(function(t){switch(t.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},OP={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(n,a){switch(a){case"break-word":return"break-word";case"normal":default:return"normal"}}},ay=function(n){return{name:"padding-"+n,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},QP=ay("top"),RP=ay("right"),PP=ay("bottom"),HP=ay("left"),zP={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(n,a){switch(a){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},KP={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(n,a){switch(a){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},GP={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(n,a){return a.length===1&&Iw(a[0],"none")?[]:fu(a).map(function(t){for(var r={color:rf.TRANSPARENT,offsetX:pl,offsetY:pl,blur:pl},s=0,e=0;e<t.length;e++){var u=t[e];m0(u)?(s===0?r.offsetX=u:s===1?r.offsetY=u:r.blur=u,s++):r.color=c0.parse(n,u)}return r})}},VP={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(n,a){switch(a){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},YP={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(n,a){if(a.type===20&&a.value==="none")return null;if(a.type===18){var t=qP[a.name];if(typeof t>"u")throw new Error('Attempting to parse an unsupported transform function "'+a.name+'"');return t(a.values)}return null}},WP=function(n){var a=n.filter(function(t){return t.type===17}).map(function(t){return t.number});return a.length===6?a:null},$P=function(n){var a=n.filter(function(m){return m.type===17}).map(function(m){return m.number}),t=a[0],r=a[1];a[2],a[3];var s=a[4],e=a[5];a[6],a[7],a[8],a[9],a[10],a[11];var u=a[12],f=a[13];return a[14],a[15],a.length===16?[t,r,s,e,u,f]:null},qP={matrix:WP,matrix3d:$P},sN={type:16,number:50,flags:yg},XP=[sN,sN],JP={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(n,a){var t=a.filter(wo);return t.length!==2?XP:[t[0],t[1]]}},ZP={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(n,a){switch(a){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},V1;(function(n){n.NORMAL="normal",n.BREAK_ALL="break-all",n.KEEP_ALL="keep-all"})(V1||(V1={}));var eH={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(n,a){switch(a){case"break-all":return V1.BREAK_ALL;case"keep-all":return V1.KEEP_ALL;case"normal":default:return V1.NORMAL}}},tH={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(n,a){if(a.type===20)return{auto:!0,order:0};if(mp(a))return{auto:!1,order:a.number};throw new Error("Invalid z-index number parsed")}},bB={name:"time",parse:function(n,a){if(a.type===15)switch(a.unit.toLowerCase()){case"s":return 1e3*a.number;case"ms":return a.number}throw new Error("Unsupported time type")}},rH={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(n,a){return mp(a)?a.number:1}},aH={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},sH={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(n,a){return a.filter(Dn).map(function(t){switch(t.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(t){return t!==0})}},nH={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(n,a){var t=[],r=[];return a.forEach(function(s){switch(s.type){case 20:case 0:t.push(s.value);break;case 17:t.push(s.number.toString());break;case 4:r.push(t.join(" ")),t.length=0;break}}),t.length&&r.push(t.join(" ")),r.map(function(s){return s.indexOf(" ")===-1?s:"'"+s+"'"})}},iH={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},oH={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(n,a){if(mp(a))return a.number;if(Dn(a))switch(a.value){case"bold":return 700;case"normal":default:return 400}return 400}},lH={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(n,a){return a.filter(Dn).map(function(t){return t.value})}},cH={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(n,a){switch(a){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},Eo=function(n,a){return(n&a)!==0},AH={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(n,a){if(a.length===0)return[];var t=a[0];return t.type===20&&t.value==="none"?[]:a}},dH={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(n,a){if(a.length===0)return null;var t=a[0];if(t.type===20&&t.value==="none")return null;for(var r=[],s=a.filter(rB),e=0;e<s.length;e++){var u=s[e],f=s[e+1];if(u.type===20){var m=f&&mp(f)?f.number:1;r.push({counter:u.value,increment:m})}}return r}},uH={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(n,a){if(a.length===0)return[];for(var t=[],r=a.filter(rB),s=0;s<r.length;s++){var e=r[s],u=r[s+1];if(Dn(e)&&e.value!=="none"){var f=u&&mp(u)?u.number:0;t.push({counter:e.value,reset:f})}}return t}},fH={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(n,a){return a.filter(vg).map(function(t){return bB.parse(n,t)})}},hH={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(n,a){if(a.length===0)return null;var t=a[0];if(t.type===20&&t.value==="none")return null;var r=[],s=a.filter(RR);if(s.length%2!==0)return null;for(var e=0;e<s.length;e+=2){var u=s[e].value,f=s[e+1].value;r.push({open:u,close:f})}return r}},nN=function(n,a,t){if(!n)return"";var r=n[Math.min(a,n.length-1)];return r?t?r.open:r.close:""},mH={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(n,a){return a.length===1&&Iw(a[0],"none")?[]:fu(a).map(function(t){for(var r={color:255,offsetX:pl,offsetY:pl,blur:pl,spread:pl,inset:!1},s=0,e=0;e<t.length;e++){var u=t[e];Iw(u,"inset")?r.inset=!0:m0(u)?(s===0?r.offsetX=u:s===1?r.offsetY=u:s===2?r.blur=u:r.spread=u,s++):r.color=c0.parse(n,u)}return r})}},pH={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(n,a){var t=[0,1,2],r=[];return a.filter(Dn).forEach(function(s){switch(s.value){case"stroke":r.push(1);break;case"fill":r.push(0);break;case"markers":r.push(2);break}}),t.forEach(function(s){r.indexOf(s)===-1&&r.push(s)}),r}},gH={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},xH={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(n,a){return vg(a)?a.number:0}},bH=(function(){function n(a,t){var r,s;this.animationDuration=Kr(a,fH,t.animationDuration),this.backgroundClip=Kr(a,zR,t.backgroundClip),this.backgroundColor=Kr(a,KR,t.backgroundColor),this.backgroundImage=Kr(a,eP,t.backgroundImage),this.backgroundOrigin=Kr(a,tP,t.backgroundOrigin),this.backgroundPosition=Kr(a,rP,t.backgroundPosition),this.backgroundRepeat=Kr(a,aP,t.backgroundRepeat),this.backgroundSize=Kr(a,nP,t.backgroundSize),this.borderTopColor=Kr(a,oP,t.borderTopColor),this.borderRightColor=Kr(a,lP,t.borderRightColor),this.borderBottomColor=Kr(a,cP,t.borderBottomColor),this.borderLeftColor=Kr(a,AP,t.borderLeftColor),this.borderTopLeftRadius=Kr(a,dP,t.borderTopLeftRadius),this.borderTopRightRadius=Kr(a,uP,t.borderTopRightRadius),this.borderBottomRightRadius=Kr(a,fP,t.borderBottomRightRadius),this.borderBottomLeftRadius=Kr(a,hP,t.borderBottomLeftRadius),this.borderTopStyle=Kr(a,mP,t.borderTopStyle),this.borderRightStyle=Kr(a,pP,t.borderRightStyle),this.borderBottomStyle=Kr(a,gP,t.borderBottomStyle),this.borderLeftStyle=Kr(a,xP,t.borderLeftStyle),this.borderTopWidth=Kr(a,bP,t.borderTopWidth),this.borderRightWidth=Kr(a,yP,t.borderRightWidth),this.borderBottomWidth=Kr(a,vP,t.borderBottomWidth),this.borderLeftWidth=Kr(a,wP,t.borderLeftWidth),this.boxShadow=Kr(a,mH,t.boxShadow),this.color=Kr(a,NP,t.color),this.direction=Kr(a,CP,t.direction),this.display=Kr(a,jP,t.display),this.float=Kr(a,SP,t.cssFloat),this.fontFamily=Kr(a,nH,t.fontFamily),this.fontSize=Kr(a,iH,t.fontSize),this.fontStyle=Kr(a,cH,t.fontStyle),this.fontVariant=Kr(a,lH,t.fontVariant),this.fontWeight=Kr(a,oH,t.fontWeight),this.letterSpacing=Kr(a,FP,t.letterSpacing),this.lineBreak=Kr(a,EP,t.lineBreak),this.lineHeight=Kr(a,kP,t.lineHeight),this.listStyleImage=Kr(a,DP,t.listStyleImage),this.listStylePosition=Kr(a,TP,t.listStylePosition),this.listStyleType=Kr(a,Ow,t.listStyleType),this.marginTop=Kr(a,_P,t.marginTop),this.marginRight=Kr(a,LP,t.marginRight),this.marginBottom=Kr(a,UP,t.marginBottom),this.marginLeft=Kr(a,MP,t.marginLeft),this.opacity=Kr(a,rH,t.opacity);var e=Kr(a,IP,t.overflow);this.overflowX=e[0],this.overflowY=e[e.length>1?1:0],this.overflowWrap=Kr(a,OP,t.overflowWrap),this.paddingTop=Kr(a,QP,t.paddingTop),this.paddingRight=Kr(a,RP,t.paddingRight),this.paddingBottom=Kr(a,PP,t.paddingBottom),this.paddingLeft=Kr(a,HP,t.paddingLeft),this.paintOrder=Kr(a,pH,t.paintOrder),this.position=Kr(a,KP,t.position),this.textAlign=Kr(a,zP,t.textAlign),this.textDecorationColor=Kr(a,aH,(r=t.textDecorationColor)!==null&&r!==void 0?r:t.color),this.textDecorationLine=Kr(a,sH,(s=t.textDecorationLine)!==null&&s!==void 0?s:t.textDecoration),this.textShadow=Kr(a,GP,t.textShadow),this.textTransform=Kr(a,VP,t.textTransform),this.transform=Kr(a,YP,t.transform),this.transformOrigin=Kr(a,JP,t.transformOrigin),this.visibility=Kr(a,ZP,t.visibility),this.webkitTextStrokeColor=Kr(a,gH,t.webkitTextStrokeColor),this.webkitTextStrokeWidth=Kr(a,xH,t.webkitTextStrokeWidth),this.wordBreak=Kr(a,eH,t.wordBreak),this.zIndex=Kr(a,tH,t.zIndex)}return n.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},n.prototype.isTransparent=function(){return A0(this.backgroundColor)},n.prototype.isTransformed=function(){return this.transform!==null},n.prototype.isPositioned=function(){return this.position!==0},n.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},n.prototype.isFloating=function(){return this.float!==0},n.prototype.isInlineLevel=function(){return Eo(this.display,4)||Eo(this.display,33554432)||Eo(this.display,268435456)||Eo(this.display,536870912)||Eo(this.display,67108864)||Eo(this.display,134217728)},n})(),yH=(function(){function n(a,t){this.content=Kr(a,AH,t.content),this.quotes=Kr(a,hH,t.quotes)}return n})(),iN=(function(){function n(a,t){this.counterIncrement=Kr(a,dH,t.counterIncrement),this.counterReset=Kr(a,uH,t.counterReset)}return n})(),Kr=function(n,a,t){var r=new eB,s=t!==null&&typeof t<"u"?t.toString():a.initialValue;r.write(s);var e=new tB(r.read());switch(a.type){case 2:var u=e.parseComponentValue();return a.parse(n,Dn(u)?u.value:a.initialValue);case 0:return a.parse(n,e.parseComponentValue());case 1:return a.parse(n,e.parseComponentValues());case 4:return e.parseComponentValue();case 3:switch(a.format){case"angle":return qb.parse(n,e.parseComponentValue());case"color":return c0.parse(n,e.parseComponentValue());case"image":return I5.parse(n,e.parseComponentValue());case"length":var f=e.parseComponentValue();return m0(f)?f:pl;case"length-percentage":var m=e.parseComponentValue();return wo(m)?m:pl;case"time":return bB.parse(n,e.parseComponentValue())}break}},vH="data-html2canvas-debug",wH=function(n){var a=n.getAttribute(vH);switch(a){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},Qw=function(n,a){var t=wH(n);return t===1||a===t},hu=(function(){function n(a,t){if(this.context=a,this.textNodes=[],this.elements=[],this.flags=0,Qw(t,3))debugger;this.styles=new bH(a,window.getComputedStyle(t,null)),Hw(t)&&(this.styles.animationDuration.some(function(r){return r>0})&&(t.style.animationDuration="0s"),this.styles.transform!==null&&(t.style.transform="none")),this.bounds=Wb(this.context,t),Qw(t,4)&&(this.flags|=16)}return n})(),NH="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",oN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",U1=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var i2=0;i2<oN.length;i2++)U1[oN.charCodeAt(i2)]=i2;var CH=function(n){var a=n.length*.75,t=n.length,r,s=0,e,u,f,m;n[n.length-1]==="="&&(a--,n[n.length-2]==="="&&a--);var g=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(a):new Array(a),b=Array.isArray(g)?g:new Uint8Array(g);for(r=0;r<t;r+=4)e=U1[n.charCodeAt(r)],u=U1[n.charCodeAt(r+1)],f=U1[n.charCodeAt(r+2)],m=U1[n.charCodeAt(r+3)],b[s++]=e<<2|u>>4,b[s++]=(u&15)<<4|f>>2,b[s++]=(f&3)<<6|m&63;return g},jH=function(n){for(var a=n.length,t=[],r=0;r<a;r+=2)t.push(n[r+1]<<8|n[r]);return t},BH=function(n){for(var a=n.length,t=[],r=0;r<a;r+=4)t.push(n[r+3]<<24|n[r+2]<<16|n[r+1]<<8|n[r]);return t},xh=5,O5=11,wv=2,SH=O5-xh,yB=65536>>xh,FH=1<<xh,Nv=FH-1,EH=1024>>xh,kH=yB+EH,DH=kH,TH=32,_H=DH+TH,LH=65536>>O5,UH=1<<SH,MH=UH-1,lN=function(n,a,t){return n.slice?n.slice(a,t):new Uint16Array(Array.prototype.slice.call(n,a,t))},IH=function(n,a,t){return n.slice?n.slice(a,t):new Uint32Array(Array.prototype.slice.call(n,a,t))},OH=function(n,a){var t=CH(n),r=Array.isArray(t)?BH(t):new Uint32Array(t),s=Array.isArray(t)?jH(t):new Uint16Array(t),e=24,u=lN(s,e/2,r[4]/2),f=r[5]===2?lN(s,(e+r[4])/2):IH(r,Math.ceil((e+r[4])/4));return new QH(r[0],r[1],r[2],r[3],u,f)},QH=(function(){function n(a,t,r,s,e,u){this.initialValue=a,this.errorValue=t,this.highStart=r,this.highValueIndex=s,this.index=e,this.data=u}return n.prototype.get=function(a){var t;if(a>=0){if(a<55296||a>56319&&a<=65535)return t=this.index[a>>xh],t=(t<<wv)+(a&Nv),this.data[t];if(a<=65535)return t=this.index[yB+(a-55296>>xh)],t=(t<<wv)+(a&Nv),this.data[t];if(a<this.highStart)return t=_H-LH+(a>>O5),t=this.index[t],t+=a>>xh&MH,t=this.index[t],t=(t<<wv)+(a&Nv),this.data[t];if(a<=1114111)return this.data[this.highValueIndex]}return this.errorValue},n})(),cN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",RH=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var o2=0;o2<cN.length;o2++)RH[cN.charCodeAt(o2)]=o2;var PH=1,Cv=2,jv=3,AN=4,dN=5,HH=7,uN=8,Bv=9,Sv=10,fN=11,hN=12,mN=13,pN=14,Fv=15,zH=function(n){for(var a=[],t=0,r=n.length;t<r;){var s=n.charCodeAt(t++);if(s>=55296&&s<=56319&&t<r){var e=n.charCodeAt(t++);(e&64512)===56320?a.push(((s&1023)<<10)+(e&1023)+65536):(a.push(s),t--)}else a.push(s)}return a},KH=function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];if(String.fromCodePoint)return String.fromCodePoint.apply(String,n);var t=n.length;if(!t)return"";for(var r=[],s=-1,e="";++s<t;){var u=n[s];u<=65535?r.push(u):(u-=65536,r.push((u>>10)+55296,u%1024+56320)),(s+1===t||r.length>16384)&&(e+=String.fromCharCode.apply(String,r),r.length=0)}return e},GH=OH(NH),kA="",Ev="",VH=function(n){return GH.get(n)},YH=function(n,a,t){var r=t-2,s=a[r],e=a[t-1],u=a[t];if(e===Cv&&u===jv)return kA;if(e===Cv||e===jv||e===AN||u===Cv||u===jv||u===AN)return Ev;if(e===uN&&[uN,Bv,fN,hN].indexOf(u)!==-1||(e===fN||e===Bv)&&(u===Bv||u===Sv)||(e===hN||e===Sv)&&u===Sv||u===mN||u===dN||u===HH||e===PH)return kA;if(e===mN&&u===pN){for(;s===dN;)s=a[--r];if(s===pN)return kA}if(e===Fv&&u===Fv){for(var f=0;s===Fv;)f++,s=a[--r];if(f%2===0)return kA}return Ev},WH=function(n){var a=zH(n),t=a.length,r=0,s=0,e=a.map(VH);return{next:function(){if(r>=t)return{done:!0,value:null};for(var u=kA;r<t&&(u=YH(a,e,++r))===kA;);if(u!==kA||r===t){var f=KH.apply(null,a.slice(s,r));return s=r,{value:f,done:!1}}return{done:!0,value:null}}}},$H=function(n){for(var a=WH(n),t=[],r;!(r=a.next()).done;)r.value&&t.push(r.value.slice());return t},qH=function(n){var a=123;if(n.createRange){var t=n.createRange();if(t.getBoundingClientRect){var r=n.createElement("boundtest");r.style.height=a+"px",r.style.display="block",n.body.appendChild(r),t.selectNode(r);var s=t.getBoundingClientRect(),e=Math.round(s.height);if(n.body.removeChild(r),e===a)return!0}}return!1},XH=function(n){var a=n.createElement("boundtest");a.style.width="50px",a.style.display="block",a.style.fontSize="12px",a.style.letterSpacing="0px",a.style.wordSpacing="0px",n.body.appendChild(a);var t=n.createRange();a.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var r=a.firstChild,s=$b(r.data).map(function(m){return ro(m)}),e=0,u={},f=s.every(function(m,g){t.setStart(r,e),t.setEnd(r,e+m.length);var b=t.getBoundingClientRect();e+=m.length;var j=b.x>u.x||b.y>u.y;return u=b,g===0?!0:j});return n.body.removeChild(a),f},JH=function(){return typeof new Image().crossOrigin<"u"},ZH=function(){return typeof new XMLHttpRequest().responseType=="string"},ez=function(n){var a=new Image,t=n.createElement("canvas"),r=t.getContext("2d");if(!r)return!1;a.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{r.drawImage(a,0,0),t.toDataURL()}catch{return!1}return!0},gN=function(n){return n[0]===0&&n[1]===255&&n[2]===0&&n[3]===255},tz=function(n){var a=n.createElement("canvas"),t=100;a.width=t,a.height=t;var r=a.getContext("2d");if(!r)return Promise.reject(!1);r.fillStyle="rgb(0, 255, 0)",r.fillRect(0,0,t,t);var s=new Image,e=a.toDataURL();s.src=e;var u=Rw(t,t,0,0,s);return r.fillStyle="red",r.fillRect(0,0,t,t),xN(u).then(function(f){r.drawImage(f,0,0);var m=r.getImageData(0,0,t,t).data;r.fillStyle="red",r.fillRect(0,0,t,t);var g=n.createElement("div");return g.style.backgroundImage="url("+e+")",g.style.height=t+"px",gN(m)?xN(Rw(t,t,0,0,g)):Promise.reject(!1)}).then(function(f){return r.drawImage(f,0,0),gN(r.getImageData(0,0,t,t).data)}).catch(function(){return!1})},Rw=function(n,a,t,r,s){var e="http://www.w3.org/2000/svg",u=document.createElementNS(e,"svg"),f=document.createElementNS(e,"foreignObject");return u.setAttributeNS(null,"width",n.toString()),u.setAttributeNS(null,"height",a.toString()),f.setAttributeNS(null,"width","100%"),f.setAttributeNS(null,"height","100%"),f.setAttributeNS(null,"x",t.toString()),f.setAttributeNS(null,"y",r.toString()),f.setAttributeNS(null,"externalResourcesRequired","true"),u.appendChild(f),f.appendChild(s),u},xN=function(n){return new Promise(function(a,t){var r=new Image;r.onload=function(){return a(r)},r.onerror=t,r.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(n))})},ml={get SUPPORT_RANGE_BOUNDS(){var n=qH(document);return Object.defineProperty(ml,"SUPPORT_RANGE_BOUNDS",{value:n}),n},get SUPPORT_WORD_BREAKING(){var n=ml.SUPPORT_RANGE_BOUNDS&&XH(document);return Object.defineProperty(ml,"SUPPORT_WORD_BREAKING",{value:n}),n},get SUPPORT_SVG_DRAWING(){var n=ez(document);return Object.defineProperty(ml,"SUPPORT_SVG_DRAWING",{value:n}),n},get SUPPORT_FOREIGNOBJECT_DRAWING(){var n=typeof Array.from=="function"&&typeof window.fetch=="function"?tz(document):Promise.resolve(!1);return Object.defineProperty(ml,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:n}),n},get SUPPORT_CORS_IMAGES(){var n=JH();return Object.defineProperty(ml,"SUPPORT_CORS_IMAGES",{value:n}),n},get SUPPORT_RESPONSE_TYPE(){var n=ZH();return Object.defineProperty(ml,"SUPPORT_RESPONSE_TYPE",{value:n}),n},get SUPPORT_CORS_XHR(){var n="withCredentials"in new XMLHttpRequest;return Object.defineProperty(ml,"SUPPORT_CORS_XHR",{value:n}),n},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var n=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(ml,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:n}),n}},Y1=(function(){function n(a,t){this.text=a,this.bounds=t}return n})(),rz=function(n,a,t,r){var s=nz(a,t),e=[],u=0;return s.forEach(function(f){if(t.textDecorationLine.length||f.trim().length>0)if(ml.SUPPORT_RANGE_BOUNDS){var m=bN(r,u,f.length).getClientRects();if(m.length>1){var g=Q5(f),b=0;g.forEach(function(F){e.push(new Y1(F,lf.fromDOMRectList(n,bN(r,b+u,F.length).getClientRects()))),b+=F.length})}else e.push(new Y1(f,lf.fromDOMRectList(n,m)))}else{var j=r.splitText(f.length);e.push(new Y1(f,az(n,r))),r=j}else ml.SUPPORT_RANGE_BOUNDS||(r=r.splitText(f.length));u+=f.length}),e},az=function(n,a){var t=a.ownerDocument;if(t){var r=t.createElement("html2canvaswrapper");r.appendChild(a.cloneNode(!0));var s=a.parentNode;if(s){s.replaceChild(r,a);var e=Wb(n,r);return r.firstChild&&s.replaceChild(r.firstChild,r),e}}return lf.EMPTY},bN=function(n,a,t){var r=n.ownerDocument;if(!r)throw new Error("Node has no owner document");var s=r.createRange();return s.setStart(n,a),s.setEnd(n,a+t),s},Q5=function(n){if(ml.SUPPORT_NATIVE_TEXT_SEGMENTATION){var a=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(a.segment(n)).map(function(t){return t.segment})}return $H(n)},sz=function(n,a){if(ml.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(t.segment(n)).map(function(r){return r.segment})}return oz(n,a)},nz=function(n,a){return a.letterSpacing!==0?Q5(n):sz(n,a)},iz=[32,160,4961,65792,65793,4153,4241],oz=function(n,a){for(var t=LQ(n,{lineBreak:a.lineBreak,wordBreak:a.overflowWrap==="break-word"?"break-word":a.wordBreak}),r=[],s,e=function(){if(s.value){var u=s.value.slice(),f=$b(u),m="";f.forEach(function(g){iz.indexOf(g)===-1?m+=ro(g):(m.length&&r.push(m),r.push(ro(g)),m="")}),m.length&&r.push(m)}};!(s=t.next()).done;)e();return r},lz=(function(){function n(a,t,r){this.text=cz(t.data,r.textTransform),this.textBounds=rz(a,this.text,r,t)}return n})(),cz=function(n,a){switch(a){case 1:return n.toLowerCase();case 3:return n.replace(Az,dz);case 2:return n.toUpperCase();default:return n}},Az=/(^|\s|:|-|\(|\))([a-z])/g,dz=function(n,a,t){return n.length>0?a+t.toUpperCase():n},vB=(function(n){Ed(a,n);function a(t,r){var s=n.call(this,t,r)||this;return s.src=r.currentSrc||r.src,s.intrinsicWidth=r.naturalWidth,s.intrinsicHeight=r.naturalHeight,s.context.cache.addImage(s.src),s}return a})(hu),wB=(function(n){Ed(a,n);function a(t,r){var s=n.call(this,t,r)||this;return s.canvas=r,s.intrinsicWidth=r.width,s.intrinsicHeight=r.height,s}return a})(hu),NB=(function(n){Ed(a,n);function a(t,r){var s=n.call(this,t,r)||this,e=new XMLSerializer,u=Wb(t,r);return r.setAttribute("width",u.width+"px"),r.setAttribute("height",u.height+"px"),s.svg="data:image/svg+xml,"+encodeURIComponent(e.serializeToString(r)),s.intrinsicWidth=r.width.baseVal.value,s.intrinsicHeight=r.height.baseVal.value,s.context.cache.addImage(s.svg),s}return a})(hu),CB=(function(n){Ed(a,n);function a(t,r){var s=n.call(this,t,r)||this;return s.value=r.value,s}return a})(hu),Pw=(function(n){Ed(a,n);function a(t,r){var s=n.call(this,t,r)||this;return s.start=r.start,s.reversed=typeof r.reversed=="boolean"&&r.reversed===!0,s}return a})(hu),uz=[{type:15,flags:0,unit:"px",number:3}],fz=[{type:16,flags:0,number:50}],hz=function(n){return n.width>n.height?new lf(n.left+(n.width-n.height)/2,n.top,n.height,n.height):n.width<n.height?new lf(n.left,n.top+(n.height-n.width)/2,n.width,n.width):n},mz=function(n){var a=n.type===pz?new Array(n.value.length+1).join(""):n.value;return a.length===0?n.placeholder||"":a},pb="checkbox",gb="radio",pz="password",yN=707406591,R5=(function(n){Ed(a,n);function a(t,r){var s=n.call(this,t,r)||this;switch(s.type=r.type.toLowerCase(),s.checked=r.checked,s.value=mz(r),(s.type===pb||s.type===gb)&&(s.styles.backgroundColor=3739148031,s.styles.borderTopColor=s.styles.borderRightColor=s.styles.borderBottomColor=s.styles.borderLeftColor=2779096575,s.styles.borderTopWidth=s.styles.borderRightWidth=s.styles.borderBottomWidth=s.styles.borderLeftWidth=1,s.styles.borderTopStyle=s.styles.borderRightStyle=s.styles.borderBottomStyle=s.styles.borderLeftStyle=1,s.styles.backgroundClip=[0],s.styles.backgroundOrigin=[0],s.bounds=hz(s.bounds)),s.type){case pb:s.styles.borderTopRightRadius=s.styles.borderTopLeftRadius=s.styles.borderBottomRightRadius=s.styles.borderBottomLeftRadius=uz;break;case gb:s.styles.borderTopRightRadius=s.styles.borderTopLeftRadius=s.styles.borderBottomRightRadius=s.styles.borderBottomLeftRadius=fz;break}return s}return a})(hu),jB=(function(n){Ed(a,n);function a(t,r){var s=n.call(this,t,r)||this,e=r.options[r.selectedIndex||0];return s.value=e&&e.text||"",s}return a})(hu),BB=(function(n){Ed(a,n);function a(t,r){var s=n.call(this,t,r)||this;return s.value=r.value,s}return a})(hu),SB=(function(n){Ed(a,n);function a(t,r){var s=n.call(this,t,r)||this;s.src=r.src,s.width=parseInt(r.width,10)||0,s.height=parseInt(r.height,10)||0,s.backgroundColor=s.styles.backgroundColor;try{if(r.contentWindow&&r.contentWindow.document&&r.contentWindow.document.documentElement){s.tree=EB(t,r.contentWindow.document.documentElement);var e=r.contentWindow.document.documentElement?G1(t,getComputedStyle(r.contentWindow.document.documentElement).backgroundColor):rf.TRANSPARENT,u=r.contentWindow.document.body?G1(t,getComputedStyle(r.contentWindow.document.body).backgroundColor):rf.TRANSPARENT;s.backgroundColor=A0(e)?A0(u)?s.styles.backgroundColor:u:e}}catch{}return s}return a})(hu),gz=["OL","UL","MENU"],I2=function(n,a,t,r){for(var s=a.firstChild,e=void 0;s;s=e)if(e=s.nextSibling,kB(s)&&s.data.trim().length>0)t.textNodes.push(new lz(n,s,t.styles));else if(zm(s))if(LB(s)&&s.assignedNodes)s.assignedNodes().forEach(function(f){return I2(n,f,t,r)});else{var u=FB(n,s);u.styles.isVisible()&&(xz(s,u,r)?u.flags|=4:bz(u.styles)&&(u.flags|=2),gz.indexOf(s.tagName)!==-1&&(u.flags|=8),t.elements.push(u),s.slot,s.shadowRoot?I2(n,s.shadowRoot,u,r):!xb(s)&&!DB(s)&&!bb(s)&&I2(n,s,u,r))}},FB=function(n,a){return zw(a)?new vB(n,a):TB(a)?new wB(n,a):DB(a)?new NB(n,a):yz(a)?new CB(n,a):vz(a)?new Pw(n,a):wz(a)?new R5(n,a):bb(a)?new jB(n,a):xb(a)?new BB(n,a):_B(a)?new SB(n,a):new hu(n,a)},EB=function(n,a){var t=FB(n,a);return t.flags|=4,I2(n,a,t,t),t},xz=function(n,a,t){return a.styles.isPositionedWithZIndex()||a.styles.opacity<1||a.styles.isTransformed()||P5(n)&&t.styles.isTransparent()},bz=function(n){return n.isPositioned()||n.isFloating()},kB=function(n){return n.nodeType===Node.TEXT_NODE},zm=function(n){return n.nodeType===Node.ELEMENT_NODE},Hw=function(n){return zm(n)&&typeof n.style<"u"&&!O2(n)},O2=function(n){return typeof n.className=="object"},yz=function(n){return n.tagName==="LI"},vz=function(n){return n.tagName==="OL"},wz=function(n){return n.tagName==="INPUT"},Nz=function(n){return n.tagName==="HTML"},DB=function(n){return n.tagName==="svg"},P5=function(n){return n.tagName==="BODY"},TB=function(n){return n.tagName==="CANVAS"},vN=function(n){return n.tagName==="VIDEO"},zw=function(n){return n.tagName==="IMG"},_B=function(n){return n.tagName==="IFRAME"},wN=function(n){return n.tagName==="STYLE"},Cz=function(n){return n.tagName==="SCRIPT"},xb=function(n){return n.tagName==="TEXTAREA"},bb=function(n){return n.tagName==="SELECT"},LB=function(n){return n.tagName==="SLOT"},NN=function(n){return n.tagName.indexOf("-")>0},jz=(function(){function n(){this.counters={}}return n.prototype.getCounterValue=function(a){var t=this.counters[a];return t&&t.length?t[t.length-1]:1},n.prototype.getCounterValues=function(a){var t=this.counters[a];return t||[]},n.prototype.pop=function(a){var t=this;a.forEach(function(r){return t.counters[r].pop()})},n.prototype.parse=function(a){var t=this,r=a.counterIncrement,s=a.counterReset,e=!0;r!==null&&r.forEach(function(f){var m=t.counters[f.counter];m&&f.increment!==0&&(e=!1,m.length||m.push(1),m[Math.max(0,m.length-1)]+=f.increment)});var u=[];return e&&s.forEach(function(f){var m=t.counters[f.counter];u.push(f.counter),m||(m=t.counters[f.counter]=[]),m.push(f.reset)}),u},n})(),CN={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},jN={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Bz={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Sz={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},_m=function(n,a,t,r,s,e){return n<a||n>t?Ag(n,s,e.length>0):r.integers.reduce(function(u,f,m){for(;n>=f;)n-=f,u+=r.values[m];return u},"")+e},UB=function(n,a,t,r){var s="";do t||n--,s=r(n)+s,n/=a;while(n*a>=a);return s},to=function(n,a,t,r,s){var e=t-a+1;return(n<0?"-":"")+(UB(Math.abs(n),e,r,function(u){return ro(Math.floor(u%e)+a)})+s)},eh=function(n,a,t){t===void 0&&(t=". ");var r=a.length;return UB(Math.abs(n),r,!1,function(s){return a[Math.floor(s%r)]})+t},Qm=1,$f=2,qf=4,M1=8,Gu=function(n,a,t,r,s,e){if(n<-9999||n>9999)return Ag(n,4,s.length>0);var u=Math.abs(n),f=s;if(u===0)return a[0]+f;for(var m=0;u>0&&m<=4;m++){var g=u%10;g===0&&Eo(e,Qm)&&f!==""?f=a[g]+f:g>1||g===1&&m===0||g===1&&m===1&&Eo(e,$f)||g===1&&m===1&&Eo(e,qf)&&n>100||g===1&&m>1&&Eo(e,M1)?f=a[g]+(m>0?t[m-1]:"")+f:g===1&&m>0&&(f=t[m-1]+f),u=Math.floor(u/10)}return(n<0?r:"")+f},BN="",SN="",FN="",kv="",Ag=function(n,a,t){var r=t?". ":"",s=t?"":"",e=t?", ":"",u=t?" ":"";switch(a){case 0:return""+u;case 1:return""+u;case 2:return""+u;case 5:var f=to(n,48,57,!0,r);return f.length<4?"0"+f:f;case 4:return eh(n,"",s);case 6:return _m(n,1,3999,CN,3,r).toLowerCase();case 7:return _m(n,1,3999,CN,3,r);case 8:return to(n,945,969,!1,r);case 9:return to(n,97,122,!1,r);case 10:return to(n,65,90,!1,r);case 11:return to(n,1632,1641,!0,r);case 12:case 49:return _m(n,1,9999,jN,3,r);case 35:return _m(n,1,9999,jN,3,r).toLowerCase();case 13:return to(n,2534,2543,!0,r);case 14:case 30:return to(n,6112,6121,!0,r);case 15:return eh(n,"",s);case 16:return eh(n,"",s);case 17:case 48:return Gu(n,"",BN,"",s,$f|qf|M1);case 47:return Gu(n,"",SN,"",s,Qm|$f|qf|M1);case 42:return Gu(n,"",BN,"",s,$f|qf|M1);case 41:return Gu(n,"",SN,"",s,Qm|$f|qf|M1);case 26:return Gu(n,"","",FN,s,0);case 25:return Gu(n,"","",FN,s,Qm|$f|qf);case 31:return Gu(n,"","",kv,e,Qm|$f|qf);case 33:return Gu(n,"","",kv,e,0);case 32:return Gu(n,"","",kv,e,Qm|$f|qf);case 18:return to(n,2406,2415,!0,r);case 20:return _m(n,1,19999,Sz,3,r);case 21:return to(n,2790,2799,!0,r);case 22:return to(n,2662,2671,!0,r);case 22:return _m(n,1,10999,Bz,3,r);case 23:return eh(n,"");case 24:return eh(n,"");case 27:return to(n,3302,3311,!0,r);case 28:return eh(n,"",s);case 29:return eh(n,"",s);case 34:return to(n,3792,3801,!0,r);case 37:return to(n,6160,6169,!0,r);case 38:return to(n,4160,4169,!0,r);case 39:return to(n,2918,2927,!0,r);case 40:return to(n,1776,1785,!0,r);case 43:return to(n,3046,3055,!0,r);case 44:return to(n,3174,3183,!0,r);case 45:return to(n,3664,3673,!0,r);case 46:return to(n,3872,3881,!0,r);case 3:default:return to(n,48,57,!0,r)}},MB="data-html2canvas-ignore",EN=(function(){function n(a,t,r){if(this.context=a,this.options=r,this.scrolledElements=[],this.referenceElement=t,this.counters=new jz,this.quoteDepth=0,!t.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(t.ownerDocument.documentElement,!1)}return n.prototype.toIFrame=function(a,t){var r=this,s=Fz(a,t);if(!s.contentWindow)return Promise.reject("Unable to find iframe window");var e=a.defaultView.pageXOffset,u=a.defaultView.pageYOffset,f=s.contentWindow,m=f.document,g=Dz(s).then(function(){return rc(r,void 0,void 0,function(){var b,j;return Il(this,function(F){switch(F.label){case 0:return this.scrolledElements.forEach(Uz),f&&(f.scrollTo(t.left,t.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(f.scrollY!==t.top||f.scrollX!==t.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(f.scrollX-t.left,f.scrollY-t.top,0,0))),b=this.options.onclone,j=this.clonedReferenceElement,typeof j>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:m.fonts&&m.fonts.ready?[4,m.fonts.ready]:[3,2];case 1:F.sent(),F.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,kz(m)]:[3,4];case 3:F.sent(),F.label=4;case 4:return typeof b=="function"?[2,Promise.resolve().then(function(){return b(m,j)}).then(function(){return s})]:[2,s]}})})});return m.open(),m.write(_z(document.doctype)+"<html></html>"),Lz(this.referenceElement.ownerDocument,e,u),m.replaceChild(m.adoptNode(this.documentElement),m.documentElement),m.close(),g},n.prototype.createElementClone=function(a){if(Qw(a,2))debugger;if(TB(a))return this.createCanvasClone(a);if(vN(a))return this.createVideoClone(a);if(wN(a))return this.createStyleClone(a);var t=a.cloneNode(!1);return zw(t)&&(zw(a)&&a.currentSrc&&a.currentSrc!==a.src&&(t.src=a.currentSrc,t.srcset=""),t.loading==="lazy"&&(t.loading="eager")),NN(t)?this.createCustomElementClone(t):t},n.prototype.createCustomElementClone=function(a){var t=document.createElement("html2canvascustomelement");return Dv(a.style,t),t},n.prototype.createStyleClone=function(a){try{var t=a.sheet;if(t&&t.cssRules){var r=[].slice.call(t.cssRules,0).reduce(function(e,u){return u&&typeof u.cssText=="string"?e+u.cssText:e},""),s=a.cloneNode(!1);return s.textContent=r,s}}catch(e){if(this.context.logger.error("Unable to access cssRules property",e),e.name!=="SecurityError")throw e}return a.cloneNode(!1)},n.prototype.createCanvasClone=function(a){var t;if(this.options.inlineImages&&a.ownerDocument){var r=a.ownerDocument.createElement("img");try{return r.src=a.toDataURL(),r}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",a)}}var s=a.cloneNode(!1);try{s.width=a.width,s.height=a.height;var e=a.getContext("2d"),u=s.getContext("2d");if(u)if(!this.options.allowTaint&&e)u.putImageData(e.getImageData(0,0,a.width,a.height),0,0);else{var f=(t=a.getContext("webgl2"))!==null&&t!==void 0?t:a.getContext("webgl");if(f){var m=f.getContextAttributes();m?.preserveDrawingBuffer===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",a)}u.drawImage(a,0,0)}return s}catch{this.context.logger.info("Unable to clone canvas as it is tainted",a)}return s},n.prototype.createVideoClone=function(a){var t=a.ownerDocument.createElement("canvas");t.width=a.offsetWidth,t.height=a.offsetHeight;var r=t.getContext("2d");try{return r&&(r.drawImage(a,0,0,t.width,t.height),this.options.allowTaint||r.getImageData(0,0,t.width,t.height)),t}catch{this.context.logger.info("Unable to clone video as it is tainted",a)}var s=a.ownerDocument.createElement("canvas");return s.width=a.offsetWidth,s.height=a.offsetHeight,s},n.prototype.appendChildNode=function(a,t,r){(!zm(t)||!Cz(t)&&!t.hasAttribute(MB)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(t)))&&(!this.options.copyStyles||!zm(t)||!wN(t))&&a.appendChild(this.cloneNode(t,r))},n.prototype.cloneChildNodes=function(a,t,r){for(var s=this,e=a.shadowRoot?a.shadowRoot.firstChild:a.firstChild;e;e=e.nextSibling)if(zm(e)&&LB(e)&&typeof e.assignedNodes=="function"){var u=e.assignedNodes();u.length&&u.forEach(function(f){return s.appendChildNode(t,f,r)})}else this.appendChildNode(t,e,r)},n.prototype.cloneNode=function(a,t){if(kB(a))return document.createTextNode(a.data);if(!a.ownerDocument)return a.cloneNode(!1);var r=a.ownerDocument.defaultView;if(r&&zm(a)&&(Hw(a)||O2(a))){var s=this.createElementClone(a);s.style.transitionProperty="none";var e=r.getComputedStyle(a),u=r.getComputedStyle(a,":before"),f=r.getComputedStyle(a,":after");this.referenceElement===a&&Hw(s)&&(this.clonedReferenceElement=s),P5(s)&&Oz(s);var m=this.counters.parse(new iN(this.context,e)),g=this.resolvePseudoContent(a,s,u,W1.BEFORE);NN(a)&&(t=!0),vN(a)||this.cloneChildNodes(a,s,t),g&&s.insertBefore(g,s.firstChild);var b=this.resolvePseudoContent(a,s,f,W1.AFTER);return b&&s.appendChild(b),this.counters.pop(m),(e&&(this.options.copyStyles||O2(a))&&!_B(a)||t)&&Dv(e,s),(a.scrollTop!==0||a.scrollLeft!==0)&&this.scrolledElements.push([s,a.scrollLeft,a.scrollTop]),(xb(a)||bb(a))&&(xb(s)||bb(s))&&(s.value=a.value),s}return a.cloneNode(!1)},n.prototype.resolvePseudoContent=function(a,t,r,s){var e=this;if(r){var u=r.content,f=t.ownerDocument;if(!(!f||!u||u==="none"||u==="-moz-alt-content"||r.display==="none")){this.counters.parse(new iN(this.context,r));var m=new yH(this.context,r),g=f.createElement("html2canvaspseudoelement");Dv(r,g),m.content.forEach(function(j){if(j.type===0)g.appendChild(f.createTextNode(j.value));else if(j.type===22){var F=f.createElement("img");F.src=j.value,F.style.opacity="1",g.appendChild(F)}else if(j.type===18){if(j.name==="attr"){var C=j.values.filter(Dn);C.length&&g.appendChild(f.createTextNode(a.getAttribute(C[0].value)||""))}else if(j.name==="counter"){var M=j.values.filter(cp),_=M[0],L=M[1];if(_&&Dn(_)){var T=e.counters.getCounterValue(_.value),H=L&&Dn(L)?Ow.parse(e.context,L.value):3;g.appendChild(f.createTextNode(Ag(T,H,!1)))}}else if(j.name==="counters"){var O=j.values.filter(cp),_=O[0],Q=O[1],L=O[2];if(_&&Dn(_)){var Z=e.counters.getCounterValues(_.value),ee=L&&Dn(L)?Ow.parse(e.context,L.value):3,se=Q&&Q.type===0?Q.value:"",ue=Z.map(function(z){return Ag(z,ee,!1)}).join(se);g.appendChild(f.createTextNode(ue))}}}else if(j.type===20)switch(j.value){case"open-quote":g.appendChild(f.createTextNode(nN(m.quotes,e.quoteDepth++,!0)));break;case"close-quote":g.appendChild(f.createTextNode(nN(m.quotes,--e.quoteDepth,!1)));break;default:g.appendChild(f.createTextNode(j.value))}}),g.className=Kw+" "+Gw;var b=s===W1.BEFORE?" "+Kw:" "+Gw;return O2(t)?t.className.baseValue+=b:t.className+=b,g}}},n.destroy=function(a){return a.parentNode?(a.parentNode.removeChild(a),!0):!1},n})(),W1;(function(n){n[n.BEFORE=0]="BEFORE",n[n.AFTER=1]="AFTER"})(W1||(W1={}));var Fz=function(n,a){var t=n.createElement("iframe");return t.className="html2canvas-container",t.style.visibility="hidden",t.style.position="fixed",t.style.left="-10000px",t.style.top="0px",t.style.border="0",t.width=a.width.toString(),t.height=a.height.toString(),t.scrolling="no",t.setAttribute(MB,"true"),n.body.appendChild(t),t},Ez=function(n){return new Promise(function(a){if(n.complete){a();return}if(!n.src){a();return}n.onload=a,n.onerror=a})},kz=function(n){return Promise.all([].slice.call(n.images,0).map(Ez))},Dz=function(n){return new Promise(function(a,t){var r=n.contentWindow;if(!r)return t("No window assigned for iframe");var s=r.document;r.onload=n.onload=function(){r.onload=n.onload=null;var e=setInterval(function(){s.body.childNodes.length>0&&s.readyState==="complete"&&(clearInterval(e),a(n))},50)}})},Tz=["all","d","content"],Dv=function(n,a){for(var t=n.length-1;t>=0;t--){var r=n.item(t);Tz.indexOf(r)===-1&&a.style.setProperty(r,n.getPropertyValue(r))}return a},_z=function(n){var a="";return n&&(a+="<!DOCTYPE ",n.name&&(a+=n.name),n.internalSubset&&(a+=n.internalSubset),n.publicId&&(a+='"'+n.publicId+'"'),n.systemId&&(a+='"'+n.systemId+'"'),a+=">"),a},Lz=function(n,a,t){n&&n.defaultView&&(a!==n.defaultView.pageXOffset||t!==n.defaultView.pageYOffset)&&n.defaultView.scrollTo(a,t)},Uz=function(n){var a=n[0],t=n[1],r=n[2];a.scrollLeft=t,a.scrollTop=r},Mz=":before",Iz=":after",Kw="___html2canvas___pseudoelement_before",Gw="___html2canvas___pseudoelement_after",kN=`{
    content: "" !important;
    display: none !important;
}`,Oz=function(n){Qz(n,"."+Kw+Mz+kN+`
         .`+Gw+Iz+kN)},Qz=function(n,a){var t=n.ownerDocument;if(t){var r=t.createElement("style");r.textContent=a,n.appendChild(r)}},IB=(function(){function n(){}return n.getOrigin=function(a){var t=n._link;return t?(t.href=a,t.href=t.href,t.protocol+t.hostname+t.port):"about:blank"},n.isSameOrigin=function(a){return n.getOrigin(a)===n._origin},n.setContext=function(a){n._link=a.document.createElement("a"),n._origin=n.getOrigin(a.location.href)},n._origin="about:blank",n})(),Rz=(function(){function n(a,t){this.context=a,this._options=t,this._cache={}}return n.prototype.addImage=function(a){var t=Promise.resolve();return this.has(a)||(_v(a)||Kz(a))&&(this._cache[a]=this.loadImage(a)).catch(function(){}),t},n.prototype.match=function(a){return this._cache[a]},n.prototype.loadImage=function(a){return rc(this,void 0,void 0,function(){var t,r,s,e,u=this;return Il(this,function(f){switch(f.label){case 0:return t=IB.isSameOrigin(a),r=!Tv(a)&&this._options.useCORS===!0&&ml.SUPPORT_CORS_IMAGES&&!t,s=!Tv(a)&&!t&&!_v(a)&&typeof this._options.proxy=="string"&&ml.SUPPORT_CORS_XHR&&!r,!t&&this._options.allowTaint===!1&&!Tv(a)&&!_v(a)&&!s&&!r?[2]:(e=a,s?[4,this.proxy(e)]:[3,2]);case 1:e=f.sent(),f.label=2;case 2:return this.context.logger.debug("Added image "+a.substring(0,256)),[4,new Promise(function(m,g){var b=new Image;b.onload=function(){return m(b)},b.onerror=g,(Gz(e)||r)&&(b.crossOrigin="anonymous"),b.src=e,b.complete===!0&&setTimeout(function(){return m(b)},500),u._options.imageTimeout>0&&setTimeout(function(){return g("Timed out ("+u._options.imageTimeout+"ms) loading image")},u._options.imageTimeout)})];case 3:return[2,f.sent()]}})})},n.prototype.has=function(a){return typeof this._cache[a]<"u"},n.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},n.prototype.proxy=function(a){var t=this,r=this._options.proxy;if(!r)throw new Error("No proxy defined");var s=a.substring(0,256);return new Promise(function(e,u){var f=ml.SUPPORT_RESPONSE_TYPE?"blob":"text",m=new XMLHttpRequest;m.onload=function(){if(m.status===200)if(f==="text")e(m.response);else{var j=new FileReader;j.addEventListener("load",function(){return e(j.result)},!1),j.addEventListener("error",function(F){return u(F)},!1),j.readAsDataURL(m.response)}else u("Failed to proxy resource "+s+" with status code "+m.status)},m.onerror=u;var g=r.indexOf("?")>-1?"&":"?";if(m.open("GET",""+r+g+"url="+encodeURIComponent(a)+"&responseType="+f),f!=="text"&&m instanceof XMLHttpRequest&&(m.responseType=f),t._options.imageTimeout){var b=t._options.imageTimeout;m.timeout=b,m.ontimeout=function(){return u("Timed out ("+b+"ms) proxying "+s)}}m.send()})},n})(),Pz=/^data:image\/svg\+xml/i,Hz=/^data:image\/.*;base64,/i,zz=/^data:image\/.*/i,Kz=function(n){return ml.SUPPORT_SVG_DRAWING||!Vz(n)},Tv=function(n){return zz.test(n)},Gz=function(n){return Hz.test(n)},_v=function(n){return n.substr(0,4)==="blob"},Vz=function(n){return n.substr(-3).toLowerCase()==="svg"||Pz.test(n)},Or=(function(){function n(a,t){this.type=0,this.x=a,this.y=t}return n.prototype.add=function(a,t){return new n(this.x+a,this.y+t)},n})(),Lm=function(n,a,t){return new Or(n.x+(a.x-n.x)*t,n.y+(a.y-n.y)*t)},l2=(function(){function n(a,t,r,s){this.type=1,this.start=a,this.startControl=t,this.endControl=r,this.end=s}return n.prototype.subdivide=function(a,t){var r=Lm(this.start,this.startControl,a),s=Lm(this.startControl,this.endControl,a),e=Lm(this.endControl,this.end,a),u=Lm(r,s,a),f=Lm(s,e,a),m=Lm(u,f,a);return t?new n(this.start,r,u,m):new n(m,f,e,this.end)},n.prototype.add=function(a,t){return new n(this.start.add(a,t),this.startControl.add(a,t),this.endControl.add(a,t),this.end.add(a,t))},n.prototype.reverse=function(){return new n(this.end,this.endControl,this.startControl,this.start)},n})(),LA=function(n){return n.type===1},Yz=(function(){function n(a){var t=a.styles,r=a.bounds,s=L1(t.borderTopLeftRadius,r.width,r.height),e=s[0],u=s[1],f=L1(t.borderTopRightRadius,r.width,r.height),m=f[0],g=f[1],b=L1(t.borderBottomRightRadius,r.width,r.height),j=b[0],F=b[1],C=L1(t.borderBottomLeftRadius,r.width,r.height),M=C[0],_=C[1],L=[];L.push((e+m)/r.width),L.push((M+j)/r.width),L.push((u+_)/r.height),L.push((g+F)/r.height);var T=Math.max.apply(Math,L);T>1&&(e/=T,u/=T,m/=T,g/=T,j/=T,F/=T,M/=T,_/=T);var H=r.width-m,O=r.height-F,Q=r.width-j,Z=r.height-_,ee=t.borderTopWidth,se=t.borderRightWidth,ue=t.borderBottomWidth,ae=t.borderLeftWidth,pe=ei(t.paddingTop,a.bounds.width),z=ei(t.paddingRight,a.bounds.width),J=ei(t.paddingBottom,a.bounds.width),ge=ei(t.paddingLeft,a.bounds.width);this.topLeftBorderDoubleOuterBox=e>0||u>0?fi(r.left+ae/3,r.top+ee/3,e-ae/3,u-ee/3,un.TOP_LEFT):new Or(r.left+ae/3,r.top+ee/3),this.topRightBorderDoubleOuterBox=e>0||u>0?fi(r.left+H,r.top+ee/3,m-se/3,g-ee/3,un.TOP_RIGHT):new Or(r.left+r.width-se/3,r.top+ee/3),this.bottomRightBorderDoubleOuterBox=j>0||F>0?fi(r.left+Q,r.top+O,j-se/3,F-ue/3,un.BOTTOM_RIGHT):new Or(r.left+r.width-se/3,r.top+r.height-ue/3),this.bottomLeftBorderDoubleOuterBox=M>0||_>0?fi(r.left+ae/3,r.top+Z,M-ae/3,_-ue/3,un.BOTTOM_LEFT):new Or(r.left+ae/3,r.top+r.height-ue/3),this.topLeftBorderDoubleInnerBox=e>0||u>0?fi(r.left+ae*2/3,r.top+ee*2/3,e-ae*2/3,u-ee*2/3,un.TOP_LEFT):new Or(r.left+ae*2/3,r.top+ee*2/3),this.topRightBorderDoubleInnerBox=e>0||u>0?fi(r.left+H,r.top+ee*2/3,m-se*2/3,g-ee*2/3,un.TOP_RIGHT):new Or(r.left+r.width-se*2/3,r.top+ee*2/3),this.bottomRightBorderDoubleInnerBox=j>0||F>0?fi(r.left+Q,r.top+O,j-se*2/3,F-ue*2/3,un.BOTTOM_RIGHT):new Or(r.left+r.width-se*2/3,r.top+r.height-ue*2/3),this.bottomLeftBorderDoubleInnerBox=M>0||_>0?fi(r.left+ae*2/3,r.top+Z,M-ae*2/3,_-ue*2/3,un.BOTTOM_LEFT):new Or(r.left+ae*2/3,r.top+r.height-ue*2/3),this.topLeftBorderStroke=e>0||u>0?fi(r.left+ae/2,r.top+ee/2,e-ae/2,u-ee/2,un.TOP_LEFT):new Or(r.left+ae/2,r.top+ee/2),this.topRightBorderStroke=e>0||u>0?fi(r.left+H,r.top+ee/2,m-se/2,g-ee/2,un.TOP_RIGHT):new Or(r.left+r.width-se/2,r.top+ee/2),this.bottomRightBorderStroke=j>0||F>0?fi(r.left+Q,r.top+O,j-se/2,F-ue/2,un.BOTTOM_RIGHT):new Or(r.left+r.width-se/2,r.top+r.height-ue/2),this.bottomLeftBorderStroke=M>0||_>0?fi(r.left+ae/2,r.top+Z,M-ae/2,_-ue/2,un.BOTTOM_LEFT):new Or(r.left+ae/2,r.top+r.height-ue/2),this.topLeftBorderBox=e>0||u>0?fi(r.left,r.top,e,u,un.TOP_LEFT):new Or(r.left,r.top),this.topRightBorderBox=m>0||g>0?fi(r.left+H,r.top,m,g,un.TOP_RIGHT):new Or(r.left+r.width,r.top),this.bottomRightBorderBox=j>0||F>0?fi(r.left+Q,r.top+O,j,F,un.BOTTOM_RIGHT):new Or(r.left+r.width,r.top+r.height),this.bottomLeftBorderBox=M>0||_>0?fi(r.left,r.top+Z,M,_,un.BOTTOM_LEFT):new Or(r.left,r.top+r.height),this.topLeftPaddingBox=e>0||u>0?fi(r.left+ae,r.top+ee,Math.max(0,e-ae),Math.max(0,u-ee),un.TOP_LEFT):new Or(r.left+ae,r.top+ee),this.topRightPaddingBox=m>0||g>0?fi(r.left+Math.min(H,r.width-se),r.top+ee,H>r.width+se?0:Math.max(0,m-se),Math.max(0,g-ee),un.TOP_RIGHT):new Or(r.left+r.width-se,r.top+ee),this.bottomRightPaddingBox=j>0||F>0?fi(r.left+Math.min(Q,r.width-ae),r.top+Math.min(O,r.height-ue),Math.max(0,j-se),Math.max(0,F-ue),un.BOTTOM_RIGHT):new Or(r.left+r.width-se,r.top+r.height-ue),this.bottomLeftPaddingBox=M>0||_>0?fi(r.left+ae,r.top+Math.min(Z,r.height-ue),Math.max(0,M-ae),Math.max(0,_-ue),un.BOTTOM_LEFT):new Or(r.left+ae,r.top+r.height-ue),this.topLeftContentBox=e>0||u>0?fi(r.left+ae+ge,r.top+ee+pe,Math.max(0,e-(ae+ge)),Math.max(0,u-(ee+pe)),un.TOP_LEFT):new Or(r.left+ae+ge,r.top+ee+pe),this.topRightContentBox=m>0||g>0?fi(r.left+Math.min(H,r.width+ae+ge),r.top+ee+pe,H>r.width+ae+ge?0:m-ae+ge,g-(ee+pe),un.TOP_RIGHT):new Or(r.left+r.width-(se+z),r.top+ee+pe),this.bottomRightContentBox=j>0||F>0?fi(r.left+Math.min(Q,r.width-(ae+ge)),r.top+Math.min(O,r.height+ee+pe),Math.max(0,j-(se+z)),F-(ue+J),un.BOTTOM_RIGHT):new Or(r.left+r.width-(se+z),r.top+r.height-(ue+J)),this.bottomLeftContentBox=M>0||_>0?fi(r.left+ae+ge,r.top+Z,Math.max(0,M-(ae+ge)),_-(ue+J),un.BOTTOM_LEFT):new Or(r.left+ae+ge,r.top+r.height-(ue+J))}return n})(),un;(function(n){n[n.TOP_LEFT=0]="TOP_LEFT",n[n.TOP_RIGHT=1]="TOP_RIGHT",n[n.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",n[n.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(un||(un={}));var fi=function(n,a,t,r,s){var e=4*((Math.sqrt(2)-1)/3),u=t*e,f=r*e,m=n+t,g=a+r;switch(s){case un.TOP_LEFT:return new l2(new Or(n,g),new Or(n,g-f),new Or(m-u,a),new Or(m,a));case un.TOP_RIGHT:return new l2(new Or(n,a),new Or(n+u,a),new Or(m,g-f),new Or(m,g));case un.BOTTOM_RIGHT:return new l2(new Or(m,a),new Or(m,a+f),new Or(n+u,g),new Or(n,g));case un.BOTTOM_LEFT:default:return new l2(new Or(m,g),new Or(m-u,g),new Or(n,a+f),new Or(n,a))}},yb=function(n){return[n.topLeftBorderBox,n.topRightBorderBox,n.bottomRightBorderBox,n.bottomLeftBorderBox]},Wz=function(n){return[n.topLeftContentBox,n.topRightContentBox,n.bottomRightContentBox,n.bottomLeftContentBox]},vb=function(n){return[n.topLeftPaddingBox,n.topRightPaddingBox,n.bottomRightPaddingBox,n.bottomLeftPaddingBox]},$z=(function(){function n(a,t,r){this.offsetX=a,this.offsetY=t,this.matrix=r,this.type=0,this.target=6}return n})(),c2=(function(){function n(a,t){this.path=a,this.target=t,this.type=1}return n})(),qz=(function(){function n(a){this.opacity=a,this.type=2,this.target=6}return n})(),Xz=function(n){return n.type===0},OB=function(n){return n.type===1},Jz=function(n){return n.type===2},DN=function(n,a){return n.length===a.length?n.some(function(t,r){return t===a[r]}):!1},Zz=function(n,a,t,r,s){return n.map(function(e,u){switch(u){case 0:return e.add(a,t);case 1:return e.add(a+r,t);case 2:return e.add(a+r,t+s);case 3:return e.add(a,t+s)}return e})},QB=(function(){function n(a){this.element=a,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return n})(),RB=(function(){function n(a,t){if(this.container=a,this.parent=t,this.effects=[],this.curves=new Yz(this.container),this.container.styles.opacity<1&&this.effects.push(new qz(this.container.styles.opacity)),this.container.styles.transform!==null){var r=this.container.bounds.left+this.container.styles.transformOrigin[0].number,s=this.container.bounds.top+this.container.styles.transformOrigin[1].number,e=this.container.styles.transform;this.effects.push(new $z(r,s,e))}if(this.container.styles.overflowX!==0){var u=yb(this.curves),f=vb(this.curves);DN(u,f)?this.effects.push(new c2(u,6)):(this.effects.push(new c2(u,2)),this.effects.push(new c2(f,4)))}}return n.prototype.getEffects=function(a){for(var t=[2,3].indexOf(this.container.styles.position)===-1,r=this.parent,s=this.effects.slice(0);r;){var e=r.effects.filter(function(m){return!OB(m)});if(t||r.container.styles.position!==0||!r.parent){if(s.unshift.apply(s,e),t=[2,3].indexOf(r.container.styles.position)===-1,r.container.styles.overflowX!==0){var u=yb(r.curves),f=vb(r.curves);DN(u,f)||s.unshift(new c2(f,6))}}else s.unshift.apply(s,e);r=r.parent}return s.filter(function(m){return Eo(m.target,a)})},n})(),Vw=function(n,a,t,r){n.container.elements.forEach(function(s){var e=Eo(s.flags,4),u=Eo(s.flags,2),f=new RB(s,n);Eo(s.styles.display,2048)&&r.push(f);var m=Eo(s.flags,8)?[]:r;if(e||u){var g=e||s.styles.isPositioned()?t:a,b=new QB(f);if(s.styles.isPositioned()||s.styles.opacity<1||s.styles.isTransformed()){var j=s.styles.zIndex.order;if(j<0){var F=0;g.negativeZIndex.some(function(M,_){return j>M.element.container.styles.zIndex.order?(F=_,!1):F>0}),g.negativeZIndex.splice(F,0,b)}else if(j>0){var C=0;g.positiveZIndex.some(function(M,_){return j>=M.element.container.styles.zIndex.order?(C=_+1,!1):C>0}),g.positiveZIndex.splice(C,0,b)}else g.zeroOrAutoZIndexOrTransformedOrOpacity.push(b)}else s.styles.isFloating()?g.nonPositionedFloats.push(b):g.nonPositionedInlineLevel.push(b);Vw(f,b,e?b:t,m)}else s.styles.isInlineLevel()?a.inlineLevel.push(f):a.nonInlineLevel.push(f),Vw(f,a,t,m);Eo(s.flags,8)&&PB(s,m)})},PB=function(n,a){for(var t=n instanceof Pw?n.start:1,r=n instanceof Pw?n.reversed:!1,s=0;s<a.length;s++){var e=a[s];e.container instanceof CB&&typeof e.container.value=="number"&&e.container.value!==0&&(t=e.container.value),e.listValue=Ag(t,e.container.styles.listStyleType,!0),t+=r?-1:1}},eK=function(n){var a=new RB(n,null),t=new QB(a),r=[];return Vw(a,t,t,r),PB(a.container,r),t},TN=function(n,a){switch(a){case 0:return MA(n.topLeftBorderBox,n.topLeftPaddingBox,n.topRightBorderBox,n.topRightPaddingBox);case 1:return MA(n.topRightBorderBox,n.topRightPaddingBox,n.bottomRightBorderBox,n.bottomRightPaddingBox);case 2:return MA(n.bottomRightBorderBox,n.bottomRightPaddingBox,n.bottomLeftBorderBox,n.bottomLeftPaddingBox);case 3:default:return MA(n.bottomLeftBorderBox,n.bottomLeftPaddingBox,n.topLeftBorderBox,n.topLeftPaddingBox)}},tK=function(n,a){switch(a){case 0:return MA(n.topLeftBorderBox,n.topLeftBorderDoubleOuterBox,n.topRightBorderBox,n.topRightBorderDoubleOuterBox);case 1:return MA(n.topRightBorderBox,n.topRightBorderDoubleOuterBox,n.bottomRightBorderBox,n.bottomRightBorderDoubleOuterBox);case 2:return MA(n.bottomRightBorderBox,n.bottomRightBorderDoubleOuterBox,n.bottomLeftBorderBox,n.bottomLeftBorderDoubleOuterBox);case 3:default:return MA(n.bottomLeftBorderBox,n.bottomLeftBorderDoubleOuterBox,n.topLeftBorderBox,n.topLeftBorderDoubleOuterBox)}},rK=function(n,a){switch(a){case 0:return MA(n.topLeftBorderDoubleInnerBox,n.topLeftPaddingBox,n.topRightBorderDoubleInnerBox,n.topRightPaddingBox);case 1:return MA(n.topRightBorderDoubleInnerBox,n.topRightPaddingBox,n.bottomRightBorderDoubleInnerBox,n.bottomRightPaddingBox);case 2:return MA(n.bottomRightBorderDoubleInnerBox,n.bottomRightPaddingBox,n.bottomLeftBorderDoubleInnerBox,n.bottomLeftPaddingBox);case 3:default:return MA(n.bottomLeftBorderDoubleInnerBox,n.bottomLeftPaddingBox,n.topLeftBorderDoubleInnerBox,n.topLeftPaddingBox)}},aK=function(n,a){switch(a){case 0:return A2(n.topLeftBorderStroke,n.topRightBorderStroke);case 1:return A2(n.topRightBorderStroke,n.bottomRightBorderStroke);case 2:return A2(n.bottomRightBorderStroke,n.bottomLeftBorderStroke);case 3:default:return A2(n.bottomLeftBorderStroke,n.topLeftBorderStroke)}},A2=function(n,a){var t=[];return LA(n)?t.push(n.subdivide(.5,!1)):t.push(n),LA(a)?t.push(a.subdivide(.5,!0)):t.push(a),t},MA=function(n,a,t,r){var s=[];return LA(n)?s.push(n.subdivide(.5,!1)):s.push(n),LA(t)?s.push(t.subdivide(.5,!0)):s.push(t),LA(r)?s.push(r.subdivide(.5,!0).reverse()):s.push(r),LA(a)?s.push(a.subdivide(.5,!1).reverse()):s.push(a),s},HB=function(n){var a=n.bounds,t=n.styles;return a.add(t.borderLeftWidth,t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth),-(t.borderTopWidth+t.borderBottomWidth))},wb=function(n){var a=n.styles,t=n.bounds,r=ei(a.paddingLeft,t.width),s=ei(a.paddingRight,t.width),e=ei(a.paddingTop,t.width),u=ei(a.paddingBottom,t.width);return t.add(r+a.borderLeftWidth,e+a.borderTopWidth,-(a.borderRightWidth+a.borderLeftWidth+r+s),-(a.borderTopWidth+a.borderBottomWidth+e+u))},sK=function(n,a){return n===0?a.bounds:n===2?wb(a):HB(a)},nK=function(n,a){return n===0?a.bounds:n===2?wb(a):HB(a)},Lv=function(n,a,t){var r=sK(Rm(n.styles.backgroundOrigin,a),n),s=nK(Rm(n.styles.backgroundClip,a),n),e=iK(Rm(n.styles.backgroundSize,a),t,r),u=e[0],f=e[1],m=L1(Rm(n.styles.backgroundPosition,a),r.width-u,r.height-f),g=oK(Rm(n.styles.backgroundRepeat,a),m,e,r,s),b=Math.round(r.left+m[0]),j=Math.round(r.top+m[1]);return[g,b,j,u,f]},Um=function(n){return Dn(n)&&n.value===Xm.AUTO},d2=function(n){return typeof n=="number"},iK=function(n,a,t){var r=a[0],s=a[1],e=a[2],u=n[0],f=n[1];if(!u)return[0,0];if(wo(u)&&f&&wo(f))return[ei(u,t.width),ei(f,t.height)];var m=d2(e);if(Dn(u)&&(u.value===Xm.CONTAIN||u.value===Xm.COVER)){if(d2(e)){var g=t.width/t.height;return g<e!=(u.value===Xm.COVER)?[t.width,t.width/e]:[t.height*e,t.height]}return[t.width,t.height]}var b=d2(r),j=d2(s),F=b||j;if(Um(u)&&(!f||Um(f))){if(b&&j)return[r,s];if(!m&&!F)return[t.width,t.height];if(F&&m){var C=b?r:s*e,M=j?s:r/e;return[C,M]}var _=b?r:t.width,L=j?s:t.height;return[_,L]}if(m){var T=0,H=0;return wo(u)?T=ei(u,t.width):wo(f)&&(H=ei(f,t.height)),Um(u)?T=H*e:(!f||Um(f))&&(H=T/e),[T,H]}var O=null,Q=null;if(wo(u)?O=ei(u,t.width):f&&wo(f)&&(Q=ei(f,t.height)),O!==null&&(!f||Um(f))&&(Q=b&&j?O/r*s:t.height),Q!==null&&Um(u)&&(O=b&&j?Q/s*r:t.width),O!==null&&Q!==null)return[O,Q];throw new Error("Unable to calculate background-size for element")},Rm=function(n,a){var t=n[a];return typeof t>"u"?n[0]:t},oK=function(n,a,t,r,s){var e=a[0],u=a[1],f=t[0],m=t[1];switch(n){case 2:return[new Or(Math.round(r.left),Math.round(r.top+u)),new Or(Math.round(r.left+r.width),Math.round(r.top+u)),new Or(Math.round(r.left+r.width),Math.round(m+r.top+u)),new Or(Math.round(r.left),Math.round(m+r.top+u))];case 3:return[new Or(Math.round(r.left+e),Math.round(r.top)),new Or(Math.round(r.left+e+f),Math.round(r.top)),new Or(Math.round(r.left+e+f),Math.round(r.height+r.top)),new Or(Math.round(r.left+e),Math.round(r.height+r.top))];case 1:return[new Or(Math.round(r.left+e),Math.round(r.top+u)),new Or(Math.round(r.left+e+f),Math.round(r.top+u)),new Or(Math.round(r.left+e+f),Math.round(r.top+u+m)),new Or(Math.round(r.left+e),Math.round(r.top+u+m))];default:return[new Or(Math.round(s.left),Math.round(s.top)),new Or(Math.round(s.left+s.width),Math.round(s.top)),new Or(Math.round(s.left+s.width),Math.round(s.height+s.top)),new Or(Math.round(s.left),Math.round(s.height+s.top))]}},lK="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",_N="Hidden Text",cK=(function(){function n(a){this._data={},this._document=a}return n.prototype.parseMetrics=function(a,t){var r=this._document.createElement("div"),s=this._document.createElement("img"),e=this._document.createElement("span"),u=this._document.body;r.style.visibility="hidden",r.style.fontFamily=a,r.style.fontSize=t,r.style.margin="0",r.style.padding="0",r.style.whiteSpace="nowrap",u.appendChild(r),s.src=lK,s.width=1,s.height=1,s.style.margin="0",s.style.padding="0",s.style.verticalAlign="baseline",e.style.fontFamily=a,e.style.fontSize=t,e.style.margin="0",e.style.padding="0",e.appendChild(this._document.createTextNode(_N)),r.appendChild(e),r.appendChild(s);var f=s.offsetTop-e.offsetTop+2;r.removeChild(e),r.appendChild(this._document.createTextNode(_N)),r.style.lineHeight="normal",s.style.verticalAlign="super";var m=s.offsetTop-r.offsetTop+2;return u.removeChild(r),{baseline:f,middle:m}},n.prototype.getMetrics=function(a,t){var r=a+" "+t;return typeof this._data[r]>"u"&&(this._data[r]=this.parseMetrics(a,t)),this._data[r]},n})(),zB=(function(){function n(a,t){this.context=a,this.options=t}return n})(),AK=1e4,dK=(function(n){Ed(a,n);function a(t,r){var s=n.call(this,t,r)||this;return s._activeEffects=[],s.canvas=r.canvas?r.canvas:document.createElement("canvas"),s.ctx=s.canvas.getContext("2d"),r.canvas||(s.canvas.width=Math.floor(r.width*r.scale),s.canvas.height=Math.floor(r.height*r.scale),s.canvas.style.width=r.width+"px",s.canvas.style.height=r.height+"px"),s.fontMetrics=new cK(document),s.ctx.scale(s.options.scale,s.options.scale),s.ctx.translate(-r.x,-r.y),s.ctx.textBaseline="bottom",s._activeEffects=[],s.context.logger.debug("Canvas renderer initialized ("+r.width+"x"+r.height+") with scale "+r.scale),s}return a.prototype.applyEffects=function(t){for(var r=this;this._activeEffects.length;)this.popEffect();t.forEach(function(s){return r.applyEffect(s)})},a.prototype.applyEffect=function(t){this.ctx.save(),Jz(t)&&(this.ctx.globalAlpha=t.opacity),Xz(t)&&(this.ctx.translate(t.offsetX,t.offsetY),this.ctx.transform(t.matrix[0],t.matrix[1],t.matrix[2],t.matrix[3],t.matrix[4],t.matrix[5]),this.ctx.translate(-t.offsetX,-t.offsetY)),OB(t)&&(this.path(t.path),this.ctx.clip()),this._activeEffects.push(t)},a.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},a.prototype.renderStack=function(t){return rc(this,void 0,void 0,function(){var r;return Il(this,function(s){switch(s.label){case 0:return r=t.element.container.styles,r.isVisible()?[4,this.renderStackContent(t)]:[3,2];case 1:s.sent(),s.label=2;case 2:return[2]}})})},a.prototype.renderNode=function(t){return rc(this,void 0,void 0,function(){return Il(this,function(r){switch(r.label){case 0:if(Eo(t.container.flags,16))debugger;return t.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(t)]:[3,3];case 1:return r.sent(),[4,this.renderNodeContent(t)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},a.prototype.renderTextWithLetterSpacing=function(t,r,s){var e=this;if(r===0)this.ctx.fillText(t.text,t.bounds.left,t.bounds.top+s);else{var u=Q5(t.text);u.reduce(function(f,m){return e.ctx.fillText(m,f,t.bounds.top+s),f+e.ctx.measureText(m).width},t.bounds.left)}},a.prototype.createFontStyle=function(t){var r=t.fontVariant.filter(function(u){return u==="normal"||u==="small-caps"}).join(""),s=pK(t.fontFamily).join(", "),e=vg(t.fontSize)?""+t.fontSize.number+t.fontSize.unit:t.fontSize.number+"px";return[[t.fontStyle,r,t.fontWeight,e,s].join(" "),s,e]},a.prototype.renderTextNode=function(t,r){return rc(this,void 0,void 0,function(){var s,e,u,f,m,g,b,j,F=this;return Il(this,function(C){return s=this.createFontStyle(r),e=s[0],u=s[1],f=s[2],this.ctx.font=e,this.ctx.direction=r.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",m=this.fontMetrics.getMetrics(u,f),g=m.baseline,b=m.middle,j=r.paintOrder,t.textBounds.forEach(function(M){j.forEach(function(_){switch(_){case 0:F.ctx.fillStyle=Ko(r.color),F.renderTextWithLetterSpacing(M,r.letterSpacing,g);var L=r.textShadow;L.length&&M.text.trim().length&&(L.slice(0).reverse().forEach(function(T){F.ctx.shadowColor=Ko(T.color),F.ctx.shadowOffsetX=T.offsetX.number*F.options.scale,F.ctx.shadowOffsetY=T.offsetY.number*F.options.scale,F.ctx.shadowBlur=T.blur.number,F.renderTextWithLetterSpacing(M,r.letterSpacing,g)}),F.ctx.shadowColor="",F.ctx.shadowOffsetX=0,F.ctx.shadowOffsetY=0,F.ctx.shadowBlur=0),r.textDecorationLine.length&&(F.ctx.fillStyle=Ko(r.textDecorationColor||r.color),r.textDecorationLine.forEach(function(T){switch(T){case 1:F.ctx.fillRect(M.bounds.left,Math.round(M.bounds.top+g),M.bounds.width,1);break;case 2:F.ctx.fillRect(M.bounds.left,Math.round(M.bounds.top),M.bounds.width,1);break;case 3:F.ctx.fillRect(M.bounds.left,Math.ceil(M.bounds.top+b),M.bounds.width,1);break}}));break;case 1:r.webkitTextStrokeWidth&&M.text.trim().length&&(F.ctx.strokeStyle=Ko(r.webkitTextStrokeColor),F.ctx.lineWidth=r.webkitTextStrokeWidth,F.ctx.lineJoin=window.chrome?"miter":"round",F.ctx.strokeText(M.text,M.bounds.left,M.bounds.top+g)),F.ctx.strokeStyle="",F.ctx.lineWidth=0,F.ctx.lineJoin="miter";break}})}),[2]})})},a.prototype.renderReplacedElement=function(t,r,s){if(s&&t.intrinsicWidth>0&&t.intrinsicHeight>0){var e=wb(t),u=vb(r);this.path(u),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(s,0,0,t.intrinsicWidth,t.intrinsicHeight,e.left,e.top,e.width,e.height),this.ctx.restore()}},a.prototype.renderNodeContent=function(t){return rc(this,void 0,void 0,function(){var r,s,e,u,f,m,H,H,g,b,j,F,Q,C,M,Z,_,L,T,H,O,Q,Z;return Il(this,function(ee){switch(ee.label){case 0:this.applyEffects(t.getEffects(4)),r=t.container,s=t.curves,e=r.styles,u=0,f=r.textNodes,ee.label=1;case 1:return u<f.length?(m=f[u],[4,this.renderTextNode(m,e)]):[3,4];case 2:ee.sent(),ee.label=3;case 3:return u++,[3,1];case 4:if(!(r instanceof vB))return[3,8];ee.label=5;case 5:return ee.trys.push([5,7,,8]),[4,this.context.cache.match(r.src)];case 6:return H=ee.sent(),this.renderReplacedElement(r,s,H),[3,8];case 7:return ee.sent(),this.context.logger.error("Error loading image "+r.src),[3,8];case 8:if(r instanceof wB&&this.renderReplacedElement(r,s,r.canvas),!(r instanceof NB))return[3,12];ee.label=9;case 9:return ee.trys.push([9,11,,12]),[4,this.context.cache.match(r.svg)];case 10:return H=ee.sent(),this.renderReplacedElement(r,s,H),[3,12];case 11:return ee.sent(),this.context.logger.error("Error loading svg "+r.svg.substring(0,255)),[3,12];case 12:return r instanceof SB&&r.tree?(g=new a(this.context,{scale:this.options.scale,backgroundColor:r.backgroundColor,x:0,y:0,width:r.width,height:r.height}),[4,g.render(r.tree)]):[3,14];case 13:b=ee.sent(),r.width&&r.height&&this.ctx.drawImage(b,0,0,r.width,r.height,r.bounds.left,r.bounds.top,r.bounds.width,r.bounds.height),ee.label=14;case 14:if(r instanceof R5&&(j=Math.min(r.bounds.width,r.bounds.height),r.type===pb?r.checked&&(this.ctx.save(),this.path([new Or(r.bounds.left+j*.39363,r.bounds.top+j*.79),new Or(r.bounds.left+j*.16,r.bounds.top+j*.5549),new Or(r.bounds.left+j*.27347,r.bounds.top+j*.44071),new Or(r.bounds.left+j*.39694,r.bounds.top+j*.5649),new Or(r.bounds.left+j*.72983,r.bounds.top+j*.23),new Or(r.bounds.left+j*.84,r.bounds.top+j*.34085),new Or(r.bounds.left+j*.39363,r.bounds.top+j*.79)]),this.ctx.fillStyle=Ko(yN),this.ctx.fill(),this.ctx.restore()):r.type===gb&&r.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(r.bounds.left+j/2,r.bounds.top+j/2,j/4,0,Math.PI*2,!0),this.ctx.fillStyle=Ko(yN),this.ctx.fill(),this.ctx.restore())),uK(r)&&r.value.length){switch(F=this.createFontStyle(e),Q=F[0],C=F[1],M=this.fontMetrics.getMetrics(Q,C).baseline,this.ctx.font=Q,this.ctx.fillStyle=Ko(e.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=hK(r.styles.textAlign),Z=wb(r),_=0,r.styles.textAlign){case 1:_+=Z.width/2;break;case 2:_+=Z.width;break}L=Z.add(_,0,0,-Z.height/2+1),this.ctx.save(),this.path([new Or(Z.left,Z.top),new Or(Z.left+Z.width,Z.top),new Or(Z.left+Z.width,Z.top+Z.height),new Or(Z.left,Z.top+Z.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Y1(r.value,L),e.letterSpacing,M),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!Eo(r.styles.display,2048))return[3,20];if(r.styles.listStyleImage===null)return[3,19];if(T=r.styles.listStyleImage,T.type!==0)return[3,18];H=void 0,O=T.url,ee.label=15;case 15:return ee.trys.push([15,17,,18]),[4,this.context.cache.match(O)];case 16:return H=ee.sent(),this.ctx.drawImage(H,r.bounds.left-(H.width+10),r.bounds.top),[3,18];case 17:return ee.sent(),this.context.logger.error("Error loading list-style-image "+O),[3,18];case 18:return[3,20];case 19:t.listValue&&r.styles.listStyleType!==-1&&(Q=this.createFontStyle(e)[0],this.ctx.font=Q,this.ctx.fillStyle=Ko(e.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",Z=new lf(r.bounds.left,r.bounds.top+ei(r.styles.paddingTop,r.bounds.width),r.bounds.width,aN(e.lineHeight,e.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Y1(t.listValue,Z),e.letterSpacing,aN(e.lineHeight,e.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),ee.label=20;case 20:return[2]}})})},a.prototype.renderStackContent=function(t){return rc(this,void 0,void 0,function(){var r,s,T,e,u,T,f,m,T,g,b,T,j,F,T,C,M,T,_,L,T;return Il(this,function(H){switch(H.label){case 0:if(Eo(t.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(t.element)];case 1:H.sent(),r=0,s=t.negativeZIndex,H.label=2;case 2:return r<s.length?(T=s[r],[4,this.renderStack(T)]):[3,5];case 3:H.sent(),H.label=4;case 4:return r++,[3,2];case 5:return[4,this.renderNodeContent(t.element)];case 6:H.sent(),e=0,u=t.nonInlineLevel,H.label=7;case 7:return e<u.length?(T=u[e],[4,this.renderNode(T)]):[3,10];case 8:H.sent(),H.label=9;case 9:return e++,[3,7];case 10:f=0,m=t.nonPositionedFloats,H.label=11;case 11:return f<m.length?(T=m[f],[4,this.renderStack(T)]):[3,14];case 12:H.sent(),H.label=13;case 13:return f++,[3,11];case 14:g=0,b=t.nonPositionedInlineLevel,H.label=15;case 15:return g<b.length?(T=b[g],[4,this.renderStack(T)]):[3,18];case 16:H.sent(),H.label=17;case 17:return g++,[3,15];case 18:j=0,F=t.inlineLevel,H.label=19;case 19:return j<F.length?(T=F[j],[4,this.renderNode(T)]):[3,22];case 20:H.sent(),H.label=21;case 21:return j++,[3,19];case 22:C=0,M=t.zeroOrAutoZIndexOrTransformedOrOpacity,H.label=23;case 23:return C<M.length?(T=M[C],[4,this.renderStack(T)]):[3,26];case 24:H.sent(),H.label=25;case 25:return C++,[3,23];case 26:_=0,L=t.positiveZIndex,H.label=27;case 27:return _<L.length?(T=L[_],[4,this.renderStack(T)]):[3,30];case 28:H.sent(),H.label=29;case 29:return _++,[3,27];case 30:return[2]}})})},a.prototype.mask=function(t){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(t.slice(0).reverse()),this.ctx.closePath()},a.prototype.path=function(t){this.ctx.beginPath(),this.formatPath(t),this.ctx.closePath()},a.prototype.formatPath=function(t){var r=this;t.forEach(function(s,e){var u=LA(s)?s.start:s;e===0?r.ctx.moveTo(u.x,u.y):r.ctx.lineTo(u.x,u.y),LA(s)&&r.ctx.bezierCurveTo(s.startControl.x,s.startControl.y,s.endControl.x,s.endControl.y,s.end.x,s.end.y)})},a.prototype.renderRepeat=function(t,r,s,e){this.path(t),this.ctx.fillStyle=r,this.ctx.translate(s,e),this.ctx.fill(),this.ctx.translate(-s,-e)},a.prototype.resizeImage=function(t,r,s){var e;if(t.width===r&&t.height===s)return t;var u=(e=this.canvas.ownerDocument)!==null&&e!==void 0?e:document,f=u.createElement("canvas");f.width=Math.max(1,r),f.height=Math.max(1,s);var m=f.getContext("2d");return m.drawImage(t,0,0,t.width,t.height,0,0,r,s),f},a.prototype.renderBackgroundImage=function(t){return rc(this,void 0,void 0,function(){var r,s,e,u,f,m;return Il(this,function(g){switch(g.label){case 0:r=t.styles.backgroundImage.length-1,s=function(b){var j,F,C,pe,he,Ne,ge,fe,ue,M,pe,he,Ne,ge,fe,_,L,T,H,O,Q,Z,ee,se,ue,ae,pe,z,J,ge,fe,ke,he,Ne,xe,we,ye,te,V,le,de,X;return Il(this,function(ie){switch(ie.label){case 0:if(b.type!==0)return[3,5];j=void 0,F=b.url,ie.label=1;case 1:return ie.trys.push([1,3,,4]),[4,e.context.cache.match(F)];case 2:return j=ie.sent(),[3,4];case 3:return ie.sent(),e.context.logger.error("Error loading background-image "+F),[3,4];case 4:return j&&(C=Lv(t,r,[j.width,j.height,j.width/j.height]),pe=C[0],he=C[1],Ne=C[2],ge=C[3],fe=C[4],ue=e.ctx.createPattern(e.resizeImage(j,ge,fe),"repeat"),e.renderRepeat(pe,ue,he,Ne)),[3,6];case 5:XR(b)?(M=Lv(t,r,[null,null,null]),pe=M[0],he=M[1],Ne=M[2],ge=M[3],fe=M[4],_=VR(b.angle,ge,fe),L=_[0],T=_[1],H=_[2],O=_[3],Q=_[4],Z=document.createElement("canvas"),Z.width=ge,Z.height=fe,ee=Z.getContext("2d"),se=ee.createLinearGradient(T,O,H,Q),tN(b.stops,L).forEach(function(G){return se.addColorStop(G.stop,Ko(G.color))}),ee.fillStyle=se,ee.fillRect(0,0,ge,fe),ge>0&&fe>0&&(ue=e.ctx.createPattern(Z,"repeat"),e.renderRepeat(pe,ue,he,Ne))):JR(b)&&(ae=Lv(t,r,[null,null,null]),pe=ae[0],z=ae[1],J=ae[2],ge=ae[3],fe=ae[4],ke=b.position.length===0?[M5]:b.position,he=ei(ke[0],ge),Ne=ei(ke[ke.length-1],fe),xe=YR(b,he,Ne,ge,fe),we=xe[0],ye=xe[1],we>0&&ye>0&&(te=e.ctx.createRadialGradient(z+he,J+Ne,0,z+he,J+Ne,we),tN(b.stops,we*2).forEach(function(G){return te.addColorStop(G.stop,Ko(G.color))}),e.path(pe),e.ctx.fillStyle=te,we!==ye?(V=t.bounds.left+.5*t.bounds.width,le=t.bounds.top+.5*t.bounds.height,de=ye/we,X=1/de,e.ctx.save(),e.ctx.translate(V,le),e.ctx.transform(1,0,0,de,0,0),e.ctx.translate(-V,-le),e.ctx.fillRect(z,X*(J-le)+le,ge,fe*X),e.ctx.restore()):e.ctx.fill())),ie.label=6;case 6:return r--,[2]}})},e=this,u=0,f=t.styles.backgroundImage.slice(0).reverse(),g.label=1;case 1:return u<f.length?(m=f[u],[5,s(m)]):[3,4];case 2:g.sent(),g.label=3;case 3:return u++,[3,1];case 4:return[2]}})})},a.prototype.renderSolidBorder=function(t,r,s){return rc(this,void 0,void 0,function(){return Il(this,function(e){return this.path(TN(s,r)),this.ctx.fillStyle=Ko(t),this.ctx.fill(),[2]})})},a.prototype.renderDoubleBorder=function(t,r,s,e){return rc(this,void 0,void 0,function(){var u,f;return Il(this,function(m){switch(m.label){case 0:return r<3?[4,this.renderSolidBorder(t,s,e)]:[3,2];case 1:return m.sent(),[2];case 2:return u=tK(e,s),this.path(u),this.ctx.fillStyle=Ko(t),this.ctx.fill(),f=rK(e,s),this.path(f),this.ctx.fill(),[2]}})})},a.prototype.renderNodeBackgroundAndBorders=function(t){return rc(this,void 0,void 0,function(){var r,s,e,u,f,m,g,b,j=this;return Il(this,function(F){switch(F.label){case 0:return this.applyEffects(t.getEffects(2)),r=t.container.styles,s=!A0(r.backgroundColor)||r.backgroundImage.length,e=[{style:r.borderTopStyle,color:r.borderTopColor,width:r.borderTopWidth},{style:r.borderRightStyle,color:r.borderRightColor,width:r.borderRightWidth},{style:r.borderBottomStyle,color:r.borderBottomColor,width:r.borderBottomWidth},{style:r.borderLeftStyle,color:r.borderLeftColor,width:r.borderLeftWidth}],u=fK(Rm(r.backgroundClip,0),t.curves),s||r.boxShadow.length?(this.ctx.save(),this.path(u),this.ctx.clip(),A0(r.backgroundColor)||(this.ctx.fillStyle=Ko(r.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(t.container)]):[3,2];case 1:F.sent(),this.ctx.restore(),r.boxShadow.slice(0).reverse().forEach(function(C){j.ctx.save();var M=yb(t.curves),_=C.inset?0:AK,L=Zz(M,-_+(C.inset?1:-1)*C.spread.number,(C.inset?1:-1)*C.spread.number,C.spread.number*(C.inset?-2:2),C.spread.number*(C.inset?-2:2));C.inset?(j.path(M),j.ctx.clip(),j.mask(L)):(j.mask(M),j.ctx.clip(),j.path(L)),j.ctx.shadowOffsetX=C.offsetX.number+_,j.ctx.shadowOffsetY=C.offsetY.number,j.ctx.shadowColor=Ko(C.color),j.ctx.shadowBlur=C.blur.number,j.ctx.fillStyle=C.inset?Ko(C.color):"rgba(0,0,0,1)",j.ctx.fill(),j.ctx.restore()}),F.label=2;case 2:f=0,m=0,g=e,F.label=3;case 3:return m<g.length?(b=g[m],b.style!==0&&!A0(b.color)&&b.width>0?b.style!==2?[3,5]:[4,this.renderDashedDottedBorder(b.color,b.width,f,t.curves,2)]:[3,11]):[3,13];case 4:return F.sent(),[3,11];case 5:return b.style!==3?[3,7]:[4,this.renderDashedDottedBorder(b.color,b.width,f,t.curves,3)];case 6:return F.sent(),[3,11];case 7:return b.style!==4?[3,9]:[4,this.renderDoubleBorder(b.color,b.width,f,t.curves)];case 8:return F.sent(),[3,11];case 9:return[4,this.renderSolidBorder(b.color,f,t.curves)];case 10:F.sent(),F.label=11;case 11:f++,F.label=12;case 12:return m++,[3,3];case 13:return[2]}})})},a.prototype.renderDashedDottedBorder=function(t,r,s,e,u){return rc(this,void 0,void 0,function(){var f,m,g,b,j,F,C,M,_,L,T,H,O,Q,Z,ee,Z,ee;return Il(this,function(se){return this.ctx.save(),f=aK(e,s),m=TN(e,s),u===2&&(this.path(m),this.ctx.clip()),LA(m[0])?(g=m[0].start.x,b=m[0].start.y):(g=m[0].x,b=m[0].y),LA(m[1])?(j=m[1].end.x,F=m[1].end.y):(j=m[1].x,F=m[1].y),s===0||s===2?C=Math.abs(g-j):C=Math.abs(b-F),this.ctx.beginPath(),u===3?this.formatPath(f):this.formatPath(m.slice(0,2)),M=r<3?r*3:r*2,_=r<3?r*2:r,u===3&&(M=r,_=r),L=!0,C<=M*2?L=!1:C<=M*2+_?(T=C/(2*M+_),M*=T,_*=T):(H=Math.floor((C+_)/(M+_)),O=(C-H*M)/(H-1),Q=(C-(H+1)*M)/H,_=Q<=0||Math.abs(_-O)<Math.abs(_-Q)?O:Q),L&&(u===3?this.ctx.setLineDash([0,M+_]):this.ctx.setLineDash([M,_])),u===3?(this.ctx.lineCap="round",this.ctx.lineWidth=r):this.ctx.lineWidth=r*2+1.1,this.ctx.strokeStyle=Ko(t),this.ctx.stroke(),this.ctx.setLineDash([]),u===2&&(LA(m[0])&&(Z=m[3],ee=m[0],this.ctx.beginPath(),this.formatPath([new Or(Z.end.x,Z.end.y),new Or(ee.start.x,ee.start.y)]),this.ctx.stroke()),LA(m[1])&&(Z=m[1],ee=m[2],this.ctx.beginPath(),this.formatPath([new Or(Z.end.x,Z.end.y),new Or(ee.start.x,ee.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},a.prototype.render=function(t){return rc(this,void 0,void 0,function(){var r;return Il(this,function(s){switch(s.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Ko(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),r=eK(t),[4,this.renderStack(r)];case 1:return s.sent(),this.applyEffects([]),[2,this.canvas]}})})},a})(zB),uK=function(n){return n instanceof BB||n instanceof jB?!0:n instanceof R5&&n.type!==gb&&n.type!==pb},fK=function(n,a){switch(n){case 0:return yb(a);case 2:return Wz(a);case 1:default:return vb(a)}},hK=function(n){switch(n){case 1:return"center";case 2:return"right";case 0:default:return"left"}},mK=["-apple-system","system-ui"],pK=function(n){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?n.filter(function(a){return mK.indexOf(a)===-1}):n},gK=(function(n){Ed(a,n);function a(t,r){var s=n.call(this,t,r)||this;return s.canvas=r.canvas?r.canvas:document.createElement("canvas"),s.ctx=s.canvas.getContext("2d"),s.options=r,s.canvas.width=Math.floor(r.width*r.scale),s.canvas.height=Math.floor(r.height*r.scale),s.canvas.style.width=r.width+"px",s.canvas.style.height=r.height+"px",s.ctx.scale(s.options.scale,s.options.scale),s.ctx.translate(-r.x,-r.y),s.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+r.width+"x"+r.height+" at "+r.x+","+r.y+") with scale "+r.scale),s}return a.prototype.render=function(t){return rc(this,void 0,void 0,function(){var r,s;return Il(this,function(e){switch(e.label){case 0:return r=Rw(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,t),[4,xK(r)];case 1:return s=e.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Ko(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(s,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},a})(zB),xK=function(n){return new Promise(function(a,t){var r=new Image;r.onload=function(){a(r)},r.onerror=t,r.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(n))})},bK=(function(){function n(a){var t=a.id,r=a.enabled;this.id=t,this.enabled=r,this.start=Date.now()}return n.prototype.debug=function(){for(var a=[],t=0;t<arguments.length;t++)a[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,zx([this.id,this.getTime()+"ms"],a)):this.info.apply(this,a))},n.prototype.getTime=function(){return Date.now()-this.start},n.prototype.info=function(){for(var a=[],t=0;t<arguments.length;t++)a[t]=arguments[t];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,zx([this.id,this.getTime()+"ms"],a))},n.prototype.warn=function(){for(var a=[],t=0;t<arguments.length;t++)a[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,zx([this.id,this.getTime()+"ms"],a)):this.info.apply(this,a))},n.prototype.error=function(){for(var a=[],t=0;t<arguments.length;t++)a[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,zx([this.id,this.getTime()+"ms"],a)):this.info.apply(this,a))},n.instances={},n})(),yK=(function(){function n(a,t){var r;this.windowBounds=t,this.instanceName="#"+n.instanceCount++,this.logger=new bK({id:this.instanceName,enabled:a.logging}),this.cache=(r=a.cache)!==null&&r!==void 0?r:new Rz(this,a)}return n.instanceCount=1,n})(),vK=function(n,a){return a===void 0&&(a={}),wK(n,a)};typeof window<"u"&&IB.setContext(window);var wK=function(n,a){return rc(void 0,void 0,void 0,function(){var t,r,s,e,u,f,m,g,b,j,F,C,M,_,L,T,H,O,Q,Z,se,ee,se,ue,ae,pe,z,J,ge,fe,ke,he,Ne,xe,we,ye,te,V,le,de;return Il(this,function(X){switch(X.label){case 0:if(!n||typeof n!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(t=n.ownerDocument,!t)throw new Error("Element is not attached to a Document");if(r=t.defaultView,!r)throw new Error("Document is not attached to a Window");return s={allowTaint:(ue=a.allowTaint)!==null&&ue!==void 0?ue:!1,imageTimeout:(ae=a.imageTimeout)!==null&&ae!==void 0?ae:15e3,proxy:a.proxy,useCORS:(pe=a.useCORS)!==null&&pe!==void 0?pe:!1},e=jw({logging:(z=a.logging)!==null&&z!==void 0?z:!0,cache:a.cache},s),u={windowWidth:(J=a.windowWidth)!==null&&J!==void 0?J:r.innerWidth,windowHeight:(ge=a.windowHeight)!==null&&ge!==void 0?ge:r.innerHeight,scrollX:(fe=a.scrollX)!==null&&fe!==void 0?fe:r.pageXOffset,scrollY:(ke=a.scrollY)!==null&&ke!==void 0?ke:r.pageYOffset},f=new lf(u.scrollX,u.scrollY,u.windowWidth,u.windowHeight),m=new yK(e,f),g=(he=a.foreignObjectRendering)!==null&&he!==void 0?he:!1,b={allowTaint:(Ne=a.allowTaint)!==null&&Ne!==void 0?Ne:!1,onclone:a.onclone,ignoreElements:a.ignoreElements,inlineImages:g,copyStyles:g},m.logger.debug("Starting document clone with size "+f.width+"x"+f.height+" scrolled to "+-f.left+","+-f.top),j=new EN(m,n,b),F=j.clonedReferenceElement,F?[4,j.toIFrame(t,f)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return C=X.sent(),M=P5(F)||Nz(F)?ZO(F.ownerDocument):Wb(m,F),_=M.width,L=M.height,T=M.left,H=M.top,O=NK(m,F,a.backgroundColor),Q={canvas:a.canvas,backgroundColor:O,scale:(we=(xe=a.scale)!==null&&xe!==void 0?xe:r.devicePixelRatio)!==null&&we!==void 0?we:1,x:((ye=a.x)!==null&&ye!==void 0?ye:0)+T,y:((te=a.y)!==null&&te!==void 0?te:0)+H,width:(V=a.width)!==null&&V!==void 0?V:Math.ceil(_),height:(le=a.height)!==null&&le!==void 0?le:Math.ceil(L)},g?(m.logger.debug("Document cloned, using foreign object rendering"),se=new gK(m,Q),[4,se.render(F)]):[3,3];case 2:return Z=X.sent(),[3,5];case 3:return m.logger.debug("Document cloned, element located at "+T+","+H+" with size "+_+"x"+L+" using computed rendering"),m.logger.debug("Starting DOM parsing"),ee=EB(m,F),O===ee.styles.backgroundColor&&(ee.styles.backgroundColor=rf.TRANSPARENT),m.logger.debug("Starting renderer for element at "+Q.x+","+Q.y+" with size "+Q.width+"x"+Q.height),se=new dK(m,Q),[4,se.render(ee)];case 4:Z=X.sent(),X.label=5;case 5:return(!((de=a.removeContainer)!==null&&de!==void 0)||de)&&(EN.destroy(C)||m.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),m.logger.debug("Finished rendering"),[2,Z]}})})},NK=function(n,a,t){var r=a.ownerDocument,s=r.documentElement?G1(n,getComputedStyle(r.documentElement).backgroundColor):rf.TRANSPARENT,e=r.body?G1(n,getComputedStyle(r.body).backgroundColor):rf.TRANSPARENT,u=typeof t=="string"?G1(n,t):t===null?rf.TRANSPARENT:4294967295;return a===r.documentElement?A0(s)?A0(e)?u:e:s:u};const CK=Object.freeze(Object.defineProperty({__proto__:null,default:vK},Symbol.toStringTag,{value:"Module"})),jK=()=>{const n=Pn(),{students:a,loading:t,error:r}=rr(tt=>tt.students),{batches:s}=rr(tt=>tt.alumni),{classes:e}=rr(tt=>tt.classes),{parents:u}=rr(tt=>tt.parents),{isNGOSchool:f}=Eh(),m=rr(tt=>tt.settings.schoolInfo),[g,b]=ne.useState(""),[j,F]=ne.useState(!1),[C,M]=ne.useState(!1),[_,L]=ne.useState(null),[T,H]=ne.useState({studentId:"",month:"",amount:"",dueDate:"",description:""}),[O,Q]=ne.useState("all"),[Z,ee]=ne.useState(!1),[se,ue]=ne.useState(null),[ae,pe]=ne.useState(null),[z,J]=ne.useState(!1),[ge,fe]=ne.useState([]),[ke,he]=ne.useState(!1),[Ne,xe]=ne.useState([]),[we,ye]=ne.useState(!1),[te,V]=ne.useState(!1),[le,de]=ne.useState([]),[X,ie]=ne.useState({challanId:"",paymentMethod:"cash",paymentDate:""}),[G,q]=ne.useState(!1),[ve,Fe]=ne.useState({generateFor:"all",selectedClass:"",selectedSection:""}),[Qe,Ge]=ne.useState(""),[je,Me]=ne.useState(""),[Se,ft]=ne.useState("student"),[jt,It]=ne.useState(""),[ut,Rt]=ne.useState([]),[Ye,St]=ne.useState([]),[Jt,mr]=ne.useState(!1),[ar,bt]=ne.useState({paymentMethod:"cash",paymentDate:new Date().toISOString().split("T")[0],discountAmount:0,discountReason:""}),[Yt,vr]=ne.useState({}),[gr,Mr]=ne.useState(1),[Ot]=ne.useState(30);ne.useEffect(()=>{n(Lc()),n(Km()),n(gd())},[n]),ne.useEffect(()=>{if(!jt&&a.length>0&&s.length>0){const tt=s.find(zt=>zt.status==="active");if(tt)It(tt.name);else{const zt=[...s].sort((qt,Ct)=>{const Ar=qt.name.match(/(\d{4})/),$r=Ct.name.match(/(\d{4})/);return Ar&&$r?parseInt($r[1])-parseInt(Ar[1]):Ct.name.localeCompare(qt.name)});zt.length>0&&It(zt[0].name)}}},[a,jt,s]);const ja=ne.useRef(null),oa=ne.useRef(0);ne.useEffect(()=>{if(_&&C){const tt=a.find(zt=>zt.id===_.id);if(tt){const zt=`${tt.id}-${tt.feesHistory?tt.feesHistory.length:0}-${tt.feesHistory?tt.feesHistory.map(Ct=>Ct.status).join(","):""}-${oa.current}`;if(ja.current!==zt){const Ct=tt.feesHistory?tt.feesHistory.filter(Fs=>Fs.type!=="admission"):[],Ar=tt.feesHistory?tt.feesHistory.filter(Fs=>Fs.type==="admission"):[],$r=Ct.length,Ra=Ct.filter(Fs=>Fs.status==="paid").length,Ba=$r-Ra,tn=Ar.length,ns=Ar.filter(Fs=>Fs.status==="paid").length,Pa=tn-ns,ya=$r+tn,Cr=Ra+ns,rn=Ba+Pa,jo=Ct.reduce((Fs,Gi)=>Fs+(Gi.amount||0),0),xi=Ar.reduce((Fs,Gi)=>Fs+(Gi.amount||0),0),Ki=jo+xi,Gs=Ct.filter(Fs=>Fs.status==="paid").reduce((Fs,Gi)=>Fs+(Gi.amount||0),0),ma=Ar.filter(Fs=>Fs.status==="paid").reduce((Fs,Gi)=>Fs+(Gi.amount||0),0),qo=Gs+ma,oc=Ki-qo,Va=Ar.length>0&&Ar.every(Fs=>Fs.status==="paid"),li={...tt,totalChallans:ya,paidChallans:Cr,pendingChallans:rn,totalAmount:Ki,paidAmount:qo,pendingAmount:oc,admissionPaid:Va,completionRate:ya>0?Math.round(Cr/ya*100):Va?100:0};ja.current=zt,L(li)}}}else ja.current=null,oa.current=0},[a,_,C]);const hr=ne.useMemo(()=>s.map(tt=>tt.name),[s]),pr=ne.useMemo(()=>[...new Set(a.map(tt=>tt.class))],[a]),Gr=ne.useMemo(()=>Qe?[...new Set(a.filter(tt=>tt.class===Qe).map(tt=>tt.section))]:[],[a,Qe]),Pr=()=>{const tt=s.map(qt=>qt.name);return a.filter(qt=>tt.includes(qt.academicYear)).map(qt=>{const Ct=qt.feesHistory?qt.feesHistory.filter(ls=>ls.type!=="admission"):[],Ar=qt.feesHistory?qt.feesHistory.filter(ls=>ls.type==="admission"):[],$r=Ct.length,Ra=Ct.filter(ls=>ls.status==="paid").length,Ba=$r-Ra,tn=Ar.length,ns=Ar.filter(ls=>ls.status==="paid").length,Pa=tn-ns,ya=$r+tn,Cr=Ra+ns,rn=Ba+Pa,jo=Ct.reduce((ls,jn)=>ls+(jn.amount||0),0),xi=Ar.reduce((ls,jn)=>ls+(jn.amount||0),0),Ki=jo+xi,Gs=Ct.reduce((ls,jn)=>ls+(parseFloat(jn.discountAmount)||0),0),ma=Ar.reduce((ls,jn)=>ls+(parseFloat(jn.discountAmount)||0),0),qo=Gs+ma,oc=Ki-qo,Va=Ct.filter(ls=>ls.status==="paid").reduce((ls,jn)=>jn.discountAmount>0?ls+(jn.amount-jn.discountAmount||jn.discountedAmount||0):ls+(jn.amount||0),0),li=Ar.filter(ls=>ls.status==="paid").reduce((ls,jn)=>jn.discountAmount>0?ls+(jn.amount-jn.discountAmount||jn.discountedAmount||0):ls+(jn.amount||0),0),Fs=Va+li,Gi=Math.max(0,oc-Fs),Vi=Ar.length>0&&Ar.every(ls=>ls.status==="paid");return{...qt,totalChallans:ya,paidChallans:Cr,pendingChallans:rn,totalAmount:oc,originalTotalAmount:Ki,totalDiscounts:qo,paidAmount:Fs,pendingAmount:Gi,admissionPaid:Vi,completionRate:ya>0?Math.round(Cr/ya*100):Vi||oc===0?100:0}})},wa=ne.useMemo(()=>Pr(),[a]),jr=ne.useMemo(()=>wa.filter(tt=>{const zt=`${tt.firstName} ${tt.lastName}`.toLowerCase().includes(g.toLowerCase())||tt.class.toLowerCase().includes(g.toLowerCase())||tt.section.toLowerCase().includes(g.toLowerCase()),qt=O==="all"||O==="paid"&&tt.completionRate===100||O==="pending"&&tt.completionRate<100,Ct=!Qe||tt.class===Qe,Ar=!je||tt.section===je,$r=!jt||tt.academicYear===jt,Ba=s.map(tn=>tn.name).includes(tt.academicYear);return zt&&qt&&Ct&&Ar&&$r&&Ba}),[wa,g,O,Qe,je,jt,s]),Ms=tt=>Mr(tt),Rs=()=>Mr(tt=>Math.min(tt+1,Math.ceil(jr.length/Ot))),or=()=>Mr(tt=>Math.max(tt-1,1)),Nr=gr*Ot,$t=Nr-Ot,Vo=jr.slice($t,Nr),Hn=Math.ceil(jr.length/Ot);At.useEffect(()=>{Mr(1)},[jr]);const hs=()=>{const tt={},zt=s.map(Ct=>Ct.name);return jr.filter(Ct=>zt.includes(Ct.academicYear)).forEach(Ct=>{const Ar=u.find(Ra=>Ra.studentIds.includes(Ct.id)),$r=Ar?Ar.id:Ct.familyId||`unknown-${Ct.id}`;if(!tt[$r]){const Ra=Ar?`${Ar.firstName} ${Ar.lastName}'s Family`:Ct.familyId?`${Ct.firstName} ${Ct.lastName}'s Family`:"Unknown Family";tt[$r]={familyId:$r,students:[],totalChallans:0,paidChallans:0,pendingChallans:0,totalAmount:0,paidAmount:0,pendingAmount:0,completionRate:0,familyName:Ra,challans:[]}}tt[$r].students.push(Ct),Ct.feesHistory&&Ct.feesHistory.forEach(Ra=>{let Ba=Ra.amount||0;Ra.discountAmount>0&&(Ba=Ra.amount-Ra.discountAmount||Ra.discountedAmount||0),tt[$r].challans.push({...Ra,studentName:`${Ct.firstName} ${Ct.lastName}`,studentClass:Ct.class,studentSection:Ct.section,studentId:Ct.id,actualAmount:Ba})}),tt[$r].totalChallans+=Ct.totalChallans,tt[$r].paidChallans+=Ct.paidChallans,tt[$r].pendingChallans+=Ct.pendingChallans,tt[$r].totalAmount+=Ct.totalAmount||0,tt[$r].paidAmount+=Ct.paidAmount||0,tt[$r].pendingAmount+=Ct.pendingAmount||0,tt[$r].completionRate=tt[$r].totalChallans>0?Math.round(tt[$r].paidChallans/tt[$r].totalChallans*100):0}),Object.values(tt)},co=ne.useMemo(()=>Se==="family"?hs():[],[Se,jr]),ra=()=>{ye(!0)},ko=()=>{V(!0)},zi=tt=>le.includes(tt),ms=tt=>{if(_&&_.feesHistory){const zt=_.feesHistory.find(qt=>qt.id===tt);if(zt&&zt.status==="paid")return}zi(tt)?de(le.filter(zt=>zt!==tt)):de([...le,tt])},pi=_&&_.feesHistory&&_.feesHistory.length>0&&_.feesHistory.filter(tt=>tt.status!=="paid").every(tt=>zi(tt.id)),en=()=>{if(pi)de([]);else if(_&&_.feesHistory){const tt=_.feesHistory.filter(zt=>zt.status!=="paid").map(zt=>zt.id);de(tt)}},Tn=async tt=>{if(tt.preventDefault(),!T.studentId||!T.month||!T.amount){alert("Please fill in all required fields.");return}const zt=a.find(qt=>qt.id===T.studentId);if(!zt){alert("Selected student not found.");return}if(zt.status==="passed_out"||zt.status==="left"){alert("Cannot generate challan for passed out or left students.");return}if(jt&&zt.academicYear!==jt){alert("Cannot generate challan for students from a different batch.");return}if(zt.academicYear&&T.month){const qt=s.find(Ct=>Ct.name===zt.academicYear);if(qt&&qt.startDate&&qt.endDate){const[Ct,Ar]=T.month.split("-").map(Number),$r=new Date(Ct,Ar-1,1),Ra=new Date(Ct,Ar,0),Ba=new Date(qt.startDate),tn=new Date(qt.endDate);if(!($r<=tn&&Ra>=Ba)){alert(`Selected month is outside the student's batch period (${qt.startDate} to ${qt.endDate}). Please select a month within the batch dates.`);return}}}try{const qt=await n(hC({studentId:T.studentId,month:T.month,amount:parseFloat(T.amount),dueDate:T.dueDate,description:T.description||""})).unwrap(),Ct=a.find(Cr=>Cr.id===T.studentId)||qt,Ar=["January","February","March","April","May","June","July","August","September","October","November","December"],[$r,Ra]=T.month.split("-"),tn=`${Ar[parseInt(Ra)-1]||"Unknown"} ${$r}`,Pa=((Ct.feesHistory||[]).length+1).toString().padStart(2,"0"),ya={id:`challan-${Ct.grNo}-${Pa}`,month:tn,amount:parseFloat(T.amount)||0,dueDate:T.dueDate||new Date(Date.now()+14400*60*1e3).toISOString().split("T")[0],description:T.description||"",paid:!1,date:null,status:"pending",type:"monthly"};ue(ya),pe(Ct),ee(!0),F(!1),H({studentId:"",month:"",amount:"",dueDate:"",description:""})}catch(qt){console.error("Error generating challan:",qt),qt.message&&qt.message.includes("already exists")?alert(qt.message):alert("Failed to generate challan. Please try again.")}},_n=tt=>{if(tt.monthlyFees){const qt=parseFloat(tt.monthlyFees)||0;if(qt>0)return qt}const zt=e.find(qt=>qt.name===tt.class);return zt&&zt.monthlyFees&&parseFloat(zt.monthlyFees)||0},Yo=tt=>{let zt=[];Se==="student"?Qe?je?zt=jr.filter(Ar=>Ar.class===Qe&&Ar.section===je).map(Ar=>Ar.id):zt=jr.filter(Ar=>Ar.class===Qe).map(Ar=>Ar.id):zt=jr.map(Ar=>Ar.id):zt=jr.map(Ar=>Ar.id);const qt=zt.map(Ar=>a.find($r=>$r.id===Ar)).filter(Ar=>Ar&&Ar.status!=="passed_out"&&Ar.status!=="left"&&(!jt||Ar.academicYear===jt));if(qt.length===0){jr.length>0?alert("No eligible students found. Only current batch students who have not passed out or left can have challans generated."):alert("No students found for the selected criteria.");return}if(jt&&tt.month){const Ar=s.find($r=>$r.name===jt);if(Ar&&Ar.startDate&&Ar.endDate){const[$r,Ra]=tt.month.split("-").map(Number),Ba=new Date($r,Ra-1,1),tn=new Date($r,Ra,0),ns=new Date(Ar.startDate),Pa=new Date(Ar.endDate);if(!(Ba<=Pa&&tn>=ns)){alert(`Selected month is outside the batch period (${Ar.startDate} to ${Ar.endDate}). Please select a month within the batch dates.`);return}}}const Ct=qt.map(Ar=>Ar.id);if(Ct.length>0){const Ar=["January","February","March","April","May","June","July","August","September","October","November","December"],$r=tt.month||new Date().toISOString().slice(0,7),[Ra,Ba]=$r.split("-"),ns=`${Ar[parseInt(Ba)-1]||"Unknown"} ${Ra}`,Pa=Ct.map(ya=>{const Cr=a.find(rn=>rn.id===ya);if(Cr){const rn=_n(Cr)||0,xi=((Cr.feesHistory||[]).length+1).toString().padStart(2,"0");return{id:`challan-${Cr.grNo}-${xi}`,month:ns,amount:rn,dueDate:tt.dueDate||new Date(Date.now()+14400*60*1e3).toISOString().split("T")[0],description:tt.description||"",paid:!1,date:null,status:"pending",type:"monthly",studentId:Cr.id}}return null}).filter(ya=>ya!==null);n(mC({studentIds:Ct,challanTemplate:{month:tt.month,dueDate:tt.dueDate,description:tt.description}})).unwrap().then(()=>{xe(Pa),he(!0),ye(!1),Fe({generateFor:"all",selectedClass:"",selectedSection:""})}).catch(ya=>{console.error("Error generating challans:",ya),ya.message&&ya.message.includes("already exists")?alert(ya.message):alert("Failed to generate challans. Please try again.")})}else alert("No students found for the selected criteria.")},Si=async tt=>{const zt=le.filter(Ct=>{if(_&&_.feesHistory){const Ar=_.feesHistory.find($r=>$r.id===Ct);return Ar&&Ar.status!=="paid"}return!1});if(zt.length===0){alert("No pending challans selected for update.");return}const qt=zt.map(Ct=>_.feesHistory.find($r=>$r.id===Ct)?{studentId:_.id,challanId:Ct,paymentMethod:tt.paymentMethod,paymentDate:tt.paymentDate||new Date().toISOString().split("T")[0]}:null).filter(Ct=>Ct!==null);if(qt.length>0)try{if(await n(qv({challanUpdates:qt})).unwrap(),oa.current=Date.now(),_){const Ct=_.feesHistory?.map(ya=>zt.includes(ya.id)?{...ya,paid:!0,status:"paid",date:tt.paymentDate||new Date().toISOString().split("T")[0],paymentMethod:tt.paymentMethod||"cash"}:ya)||[],$r=Ct.filter(ya=>ya.status==="paid").reduce((ya,Cr)=>Cr.discountAmount>0?ya+(parseFloat(Cr.amount)-parseFloat(Cr.discountAmount)||parseFloat(Cr.discountedAmount)||0):ya+(parseFloat(Cr.amount)||0),0),Ra=Ct.reduce((ya,Cr)=>ya+(parseFloat(Cr.amount)||0),0),Ba=Ct.reduce((ya,Cr)=>ya+(parseFloat(Cr.discountAmount)||0),0),tn=Ra-Ba,ns=Math.max(0,tn-$r),Pa={..._,feesHistory:Ct,feesPaid:$r,pendingAmount:ns};L(Pa)}alert(`Successfully updated ${qt.length} challan(s)!`)}catch(Ct){console.error("Error updating challans:",Ct),alert("Failed to update challans. Please try again.")}de([]),V(!1)},Is=async tt=>{if(!tt.challanId||!tt.paymentMethod){alert("Please provide all required payment information.");return}try{const zt=await n(fC({challanId:tt.challanId,paymentMethod:tt.paymentMethod,paymentDate:tt.paymentDate||new Date().toISOString().split("T")[0],discountAmount:tt.discountAmount||0,discountReason:tt.discountReason||""})).unwrap();if(oa.current=Date.now(),_&&_.id===zt.id){const qt=zt.feesHistory?.find(Ct=>Ct.id===tt.challanId);if(qt){const Ct={..._,feesHistory:_.feesHistory?.map(Ar=>Ar.id===tt.challanId?{...Ar,...qt}:Ar)||[],feesPaid:zt.feesPaid,pendingAmount:Math.max(0,(_.totalAmount||0)-(parseFloat(zt.feesPaid)||0))};L(Ct)}}alert("Payment processed successfully!"),q(!1)}catch(zt){console.error("Error processing payment:",zt),alert("Failed to process payment. Please try again."),q(!1)}},ba=()=>{const tt=[];jr.forEach(qt=>{qt.feesHistory&&Array.isArray(qt.feesHistory)&&qt.feesHistory.forEach(Ct=>{Ct.status!=="paid"&&tt.push({...Ct,studentId:qt.id,studentName:`${qt.firstName} ${qt.lastName}`,studentClass:qt.class,studentSection:qt.section,selected:!0})})}),Rt(tt),St(tt.map(qt=>qt.id));const zt={};tt.forEach(qt=>{zt[qt.id]=0}),vr(zt),mr(!0)},Cn=async()=>{if(Ye.length===0){alert("No pending challans selected to pay.");return}try{const tt=ut.filter(qt=>Ye.includes(qt.id)),zt=tt.map(qt=>{const Ct=Yt[qt.id]||0;return{studentId:qt.studentId,challanId:qt.id,paymentMethod:ar.paymentMethod,paymentDate:ar.paymentDate||new Date().toISOString().split("T")[0],discountAmount:Ct,discountReason:Ct>0?ar.discountReason||"Bulk payment discount":""}});await n(qv({challanUpdates:zt})).unwrap(),oa.current=Date.now(),alert(`Successfully processed ${tt.length} payment(s)!`),mr(!1),Rt([]),St([]),vr({})}catch(tt){console.error("Error processing bulk payments:",tt),alert("Failed to process bulk payments. Please try again.")}},Oa=tt=>{ie({challanId:tt,paymentMethod:"cash",paymentDate:new Date().toISOString().split("T")[0]}),q(!0)},ss=()=>{const tt=new Date,zt=tt.toISOString().slice(0,7),qt=new Date(tt);qt.setDate(tt.getDate()+7),H({studentId:"",month:zt,amount:"",dueDate:qt.toISOString().split("T")[0],description:""}),F(!0)},gi=tt=>{const zt=tt.target.value;if(H(qt=>({...qt,studentId:zt})),zt){const qt=a.find(Ct=>Ct.id===zt);if(qt){let Ct=0;if(qt.monthlyFees&&(Ct=parseFloat(qt.monthlyFees)||0),Ct===0){const Ar=e.find($r=>$r.name===qt.class);Ar&&Ar.monthlyFees&&(Ct=parseFloat(Ar.monthlyFees)||0)}H(Ar=>({...Ar,studentId:zt,amount:Ct}))}}},Wo=(tt,zt)=>{const qt=[Object.keys(tt[0]).join(","),...tt.map(Ra=>Object.values(Ra).map(Ba=>typeof Ba=="string"?`"${Ba.replace(/"/g,'""')}"`:Ba).join(","))].join(`
`),Ct=new Blob([qt],{type:"text/csv;charset=utf-8;"}),Ar=URL.createObjectURL(Ct),$r=document.createElement("a");$r.setAttribute("href",Ar),$r.setAttribute("download",zt),$r.style.visibility="hidden",document.body.appendChild($r),$r.click(),document.body.removeChild($r)},Fi=()=>{const tt=jr.map(zt=>({name:`${zt.firstName} ${zt.lastName}`,class:zt.class,section:zt.section,email:zt.email,phone:zt.phone,totalChallans:zt.totalChallans,paidChallans:zt.paidChallans,pendingChallans:zt.pendingChallans,totalAmount:zt.totalAmount||0,paidAmount:zt.paidAmount,pendingAmount:zt.pendingAmount,completionRate:`${zt.completionRate}%`}));Wo(tt,"students_fees_summary.csv")},Hl=tt=>{L(tt),M(!0)},$o=()=>{ee(!1),ue(null),pe(null)},Do=()=>{J(!1),fe([])},zl=async(tt,zt)=>{ue(tt),pe(zt),ee(!0)},Ln=()=>{const tt=[];jr.forEach(zt=>{zt.feesHistory&&zt.feesHistory.filter(qt=>qt.status!=="paid").forEach(qt=>{tt.push({...qt,studentId:zt.id})})}),tt.length>0?(fe(tt),J(!0)):alert("No pending challans found to print.")},hn=async()=>{window.print()};return t?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):r?i.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),i.jsx("div",{className:"ml-3",children:i.jsxs("p",{className:"text-sm text-red-700",children:["Error: ",r]})})]})}):f?i.jsx("div",{className:"p-6",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Fees Managementsss"}),i.jsx("p",{className:"text-gray-600 mb-6",children:"Manage student fees and financial records"}),i.jsx(oj,{}),i.jsx("div",{className:"mt-6 bg-blue-50 rounded-lg p-4 border border-blue-100",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx(sw,{className:"h-5 w-5 text-blue-500 mt-0.5 flex-shrink-0"}),i.jsxs("div",{className:"ml-3",children:[i.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"NGO Funded School"}),i.jsxs("div",{className:"mt-2 text-sm text-blue-700",children:[i.jsx("p",{children:"As an NGO funded school, this section is not applicable as no fees are collected from students."}),i.jsx("p",{className:"mt-1",children:"All financial management is handled through the NGO Subsidies section."})]})]})]})})]})}):i.jsxs(i.Fragment,{children:[Z&&se&&ae&&i.jsx(JO,{challan:se,student:ae,schoolInfo:m,onPrint:hn,onBack:$o}),z&&ge.length>0&&i.jsx("div",{className:"fixed inset-0 bg-white z-50 p-0 m-0 overflow-hidden",children:i.jsxs("div",{className:"print-container",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4 p-4 bg-white border-b print:hidden",children:[i.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Bulk Challan Print Preview"}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsxs("button",{onClick:()=>window.print(),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700",children:[i.jsx(mi,{className:"mr-2"})," Print All Challans"]}),i.jsx("button",{onClick:Do,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Back to Fees"})]})]}),i.jsx($O,{challans:ge,students:a,schoolInfo:m})]})}),ke&&Ne.length>0&&i.jsx(qO,{challans:Ne,students:a,schoolInfo:m,onPrint:()=>window.print(),onBack:()=>{he(!1),xe([])}}),i.jsx(YO,{showGenerateModal:j,setShowGenerateModal:F,challanData:T,setChallanData:H,students:a,classes:e,handleStudentChange:gi,submitChallan:Tn,showBulkGenerateModal:we,setShowBulkGenerateModal:ye,submitBulkGenerate:Yo,showBulkUpdateModal:te,setShowBulkUpdateModal:V,submitBulkUpdate:Si,bulkSelectedChallans:le,showPaymentModal:G,setShowPaymentModal:q,paymentData:X,setPaymentData:ie,submitPayment:Is,detailViewStudent:_,batches:s}),Jt&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 w-full max-w-4xl max-h-[90vh] overflow-auto",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Bulk Payment for Pending Challans"}),i.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["You have ",ut.length," pending challan(s). Select the ones you want to pay."]}),i.jsx("div",{className:"mb-6 overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-12",children:i.jsx("input",{type:"checkbox",className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500",checked:ut.length>0&&Ye.length===ut.length,onChange:tt=>{tt.target.checked?St(ut.map(zt=>zt.id)):St([])}})}),i.jsx("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),i.jsx("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class"}),i.jsx("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Month"}),i.jsx("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Original Amount"}),i.jsx("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Discount"}),i.jsx("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Final Amount"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ut.map((tt,zt)=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:i.jsx("input",{type:"checkbox",className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500",checked:Ye.includes(tt.id),onChange:qt=>{qt.target.checked?St([...Ye,tt.id]):St(Ye.filter(Ct=>Ct!==tt.id))}})}),i.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:tt.studentName}),i.jsxs("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:[tt.studentClass," ",tt.studentSection]}),i.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:tt.month}),i.jsxs("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:["Rs ",Math.round(tt.amount)]}),i.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:i.jsx("input",{type:"number",min:"0",max:tt.amount,value:Yt[tt.id]>0?Yt[tt.id]:"",onChange:qt=>{const Ct=qt.target.value,Ar=Ct===""?0:Math.min(parseFloat(Ct)||0,tt.amount);vr({...Yt,[tt.id]:Ar})},className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm",placeholder:"0",disabled:!Ye.includes(tt.id)})}),i.jsxs("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:["Rs ",Math.round((tt.amount||0)-(Yt[tt.id]||0))]})]},tt.id))})]})}),i.jsxs("form",{onSubmit:tt=>{tt.preventDefault(),Cn()},className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method"}),i.jsxs("select",{value:ar.paymentMethod,onChange:tt=>bt({...ar,paymentMethod:tt.target.value}),className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"bank",children:"Bank Transfer"}),i.jsx("option",{value:"easypaisa",children:"EasyPaisa"}),i.jsx("option",{value:"jazzcash",children:"JazzCash"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Date"}),i.jsx("input",{type:"date",value:ar.paymentDate,onChange:tt=>bt({...ar,paymentDate:tt.target.value}),className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0})]})]}),i.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>{mr(!1),Rt([]),St([])},className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),i.jsxs("button",{type:"submit",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700",disabled:Ye.length===0,children:[i.jsx(Co,{className:"mr-2"})," Process ",Ye.length," Payment(s)"]})]})]})]})}),i.jsxs("div",{className:"",children:[!C&&i.jsx(HO,{onGenerateChallan:ss,onExportCSV:Fi,onBulkPrint:Ln,isGenerateDisabled:jr.length>0&&jr.every(tt=>tt.status==="passed_out"||tt.status==="left")}),!C&&i.jsx(zO,{filteredStudents:jr}),C?i.jsx(WO,{detailViewStudent:_,students:a,classes:e,setShowStudentDetails:M,handleSelectAllChallans:en,areAllChallansSelected:pi,bulkSelectedChallans:le,handleBulkUpdate:ko,isChallanSelected:zi,handleSelectChallan:ms,handlePrintChallan:zl,setPaymentData:ie,setShowPaymentModal:q,setChallanData:H,setShowGenerateModal:F}):i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:Se==="student"?"Student Fees Summary":"Family Fees Summary"}),i.jsx(KO,{viewMode:Se,searchTerm:g,setSearchTerm:b,filterStatus:O,setFilterStatus:Q,selectedClass:Qe,setSelectedClass:Ge,selectedSection:je,setSelectedSection:Me,selectedBatch:jt,setSelectedBatch:It,uniqueClasses:pr,classSections:Gr,uniqueBatches:hr,onBulkGenerate:ra,onBulkPayment:ba,onClearFilters:()=>{b(""),Q("all"),Ge(""),Me(""),It("")}}),i.jsxs("div",{className:"overflow-hidden rounded-lg border border-gray-200",children:[i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsx("tr",{children:Se==="student"?i.jsxs(i.Fragment,{children:[i.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Photo"}),i.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"GR No"}),i.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),i.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class/Section"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Challans"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Completion"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]}):i.jsxs(i.Fragment,{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class/Section"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Month"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})})}),Se==="student"?i.jsx(GO,{filteredStudents:Vo,onViewDetails:Hl,currentPage:gr,itemsPerPage:Ot}):i.jsx(VO,{familyGroups:co,students:a,onPayFees:Oa,onPrintChallan:zl})]}),(Se==="student"?jr.length===0:co.every(tt=>tt.challans.length===0))&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Pi,{className:"mx-auto h-12 w-12 text-gray-400"}),i.jsxs("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:["No ",Se==="student"?"students":"challans"," found"]}),i.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Try adjusting your search or filter criteria"})]}),Se==="student"&&i.jsx(Bd,{currentPage:gr,totalPages:Hn,itemsPerPage:Ot,totalItems:jr.length,paginate:Ms,nextPage:Rs,prevPage:or})]})]})]})]})},BK=`
  .react-datepicker__day--disabled {
    color: #cccccc !important;
    background-color: #f5f5f5 !important;
    cursor: not-allowed !important;
    text-decoration: line-through;
  }
  
  .react-datepicker__day--disabled:hover {
    background-color: #f5f5f5 !important;
    color: #cccccc !important;
  }
`,SK=()=>{const n=Pn(),{students:a}=rr(je=>je.students),{attendanceRecords:t,loading:r,error:s}=rr(je=>je.attendance),{schoolInfo:e}=rr(je=>je.settings),[u,f]=ne.useState(""),[m,g]=ne.useState(""),[b,j]=ne.useState(""),[F,C]=ne.useState(new Date().toISOString().split("T")[0]),[M,_]=ne.useState({}),[L,T]=ne.useState([]),H=ne.useMemo(()=>[...new Set(a.map(je=>je.class))],[a]),O=ne.useMemo(()=>m?[...new Set(a.filter(je=>je.class===m).map(je=>je.section))]:[],[a,m]),Q=ne.useMemo(()=>a.filter(je=>{const Me=`${je.firstName} ${je.lastName}`.toLowerCase().includes(u.toLowerCase())||je.email.toLowerCase().includes(u.toLowerCase())||je.class.toLowerCase().includes(u.toLowerCase())||je.grNo&&je.grNo.toLowerCase().includes(u.toLowerCase()),Se=!m||je.class===m,ft=!b||je.section===b;return Me&&Se&&ft}),[a,u,m,b]);ne.useEffect(()=>{F&&n(b2({date:F,classId:m||null}))},[m,F,n]),ne.useEffect(()=>{n(s0())},[n]),ne.useEffect(()=>{const je={};t&&t.length>0&&t.forEach(Me=>{const Se=Me.date===F,ft=m?Me.classId===m:!0;Se&&ft&&(Array.isArray(Me.records)?Me.records:[]).forEach(It=>{je[It.studentId]=It.status})}),Q.forEach(Me=>{je.hasOwnProperty(Me.id)||(je[Me.id]="absent")}),_(je)},[t,F,m,Q]);const Z=(je,Me)=>{_(Se=>({...Se,[je]:Me}))},ee=()=>{if(!m){alert("Please select a class first");return}const je={date:F,classId:m,records:Object.entries(M).map(([Me,Se])=>({studentId:Me,status:Se}))};n(x2(je)).then(()=>{alert(`Attendance for ${Q.length} students saved successfully for ${F}`)}).catch(Me=>{alert(`Failed to save attendance: ${Me.message||"Unknown error"}`)})},se=()=>{const je={};Q.forEach(Me=>{je[Me.id]="present"}),_(je)},ue=()=>{const je={};Q.forEach(Me=>{je[Me.id]="absent"}),_(je)},ae=je=>{T(Me=>Me.includes(je)?Me.filter(Se=>Se!==je):[...Me,je])},pe=()=>{T(Q.map(je=>je.id))},z=()=>{T([])},J=je=>{if(L.length===0){alert("Please select at least one student");return}const Me={...M};L.forEach(Se=>{Me[Se]=je}),_(Me),T([])},ge=()=>{const je=Object.values(M).filter(jt=>jt==="present").length,Me=Object.values(M).filter(jt=>jt==="absent").length,Se=Object.values(M).filter(jt=>jt==="late").length,ft=Object.values(M).filter(jt=>jt==="leave").length;return{presentCount:je,absentCount:Me,lateCount:Se,leaveCount:ft}},{presentCount:fe,absentCount:ke,lateCount:he,leaveCount:Ne}=ne.useMemo(ge,[M]),xe=(je,Me)=>{if((M.hasOwnProperty(je)?M[je]:"absent")===Me)switch(Me){case"present":return"inline-flex items-center px-3 py-1 border border-green-300 bg-green-100 text-green-800 text-xs font-medium rounded-lg";case"absent":return"inline-flex items-center px-3 py-1 border border-red-300 bg-red-100 text-red-800 text-xs font-medium rounded-lg";case"late":return"inline-flex items-center px-3 py-1 border border-yellow-300 bg-yellow-100 text-yellow-800 text-xs font-medium rounded-lg";case"leave":return"inline-flex items-center px-3 py-1 border border-blue-300 bg-blue-100 text-blue-800 text-xs font-medium rounded-lg";default:return"inline-flex items-center px-3 py-1 border border-gray-300 text-gray-700 bg-white text-xs font-medium rounded-lg hover:bg-gray-50"}return"inline-flex items-center px-3 py-1 border border-gray-300 text-gray-700 bg-white text-xs font-medium rounded-lg hover:bg-gray-50"},[we,ye]=ne.useState(1),[te]=ne.useState(40),V=Math.ceil(Q.length/te),le=we*te,de=le-te,X=Q.slice(de,le);ne.useEffect(()=>{ye(1)},[Q.length,m,b,u]);const ie=je=>ye(je),G=()=>ye(je=>Math.min(je+1,V)),q=()=>ye(je=>Math.max(je-1,1)),ve=At.useMemo(()=>e&&e.holidays&&Array.isArray(e.holidays)&&e.holidays.length>0?e.holidays.map(je=>typeof je=="string"?je:je.date||"").filter(je=>je&&typeof je=="string"):["2025-01-01","2025-02-05","2025-03-23","2025-05-01","2025-08-14","2025-11-09","2025-12-25"],[e]),Fe=At.useMemo(()=>e&&e.weekendDays&&Array.isArray(e.weekendDays)?e.weekendDays:[0],[e]),Qe=e?.vacations||{summer:{start:"2025-06-01",end:"2025-07-31"},winter:{start:"2025-12-20",end:"2026-01-05"}},Ge=je=>{const Me=je.toISOString().split("T")[0];return!!(Qe.summer.start&&Qe.summer.end&&Me>=Qe.summer.start&&Me<=Qe.summer.end||Qe.winter.start&&Qe.winter.end&&Me>=Qe.winter.start&&Me<=Qe.winter.end)};return ne.useEffect(()=>{if(e&&e.holidays&&e.holidays.length>0){const je=setTimeout(()=>{const Me=document.querySelector(".react-datepicker");Me&&Me.querySelectorAll(".react-datepicker__day").forEach(ft=>{if(ft.classList.contains("react-datepicker__day--disabled"))return;const jt=ft.textContent;if(jt&&F)try{const[It,ut]=F.split("-"),Rt=parseInt(jt,10),Ye=ut.padStart(2,"0"),St=Rt.toString().padStart(2,"0"),Jt=`${It}-${Ye}-${St}`;e.holidays.some(ar=>(typeof ar=="string"?ar:ar.date)===Jt)&&(ft.classList.add("react-datepicker__day--disabled"),ft.style.color="#cccccc",ft.style.backgroundColor="#f5f5f5",ft.style.cursor="not-allowed",ft.style.textDecoration="line-through")}catch{}})},150);return()=>clearTimeout(je)}},[e,F]),i.jsxs(i.Fragment,{children:[i.jsx("style",{children:BK}),i.jsx(jd,{title:"Attendance Management",subtitle:"Track student attendance manually",actionButton:i.jsx("button",{onClick:ee,disabled:r,className:`inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white transition-all duration-200 ${r?"bg-gray-400 cursor-not-allowed":"bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}`,children:r?i.jsxs(i.Fragment,{children:[i.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(m5,{className:"mr-2"})," Save Attendance"]})})}),s&&i.jsx("div",{className:"mb-6 bg-red-50 border-l-4 border-red-500 p-4 rounded",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),i.jsx("div",{className:"ml-3",children:i.jsxs("p",{className:"text-sm text-red-700",children:["Error: ",s]})})]})}),i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 mb-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute z-10 inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Rl,{className:"h-5 w-5 text-gray-400"})}),i.jsx(z1,{selected:F?(()=>{try{const je=new Date(F);return isNaN(je.getTime())?new Date:je}catch{return new Date}})():new Date,onChange:je=>{if(Fe.includes(je.getDay()))return;const Me=je.toISOString().split("T")[0];ve&&ve.includes(Me)||Ge(je)||C(je.toISOString().split("T")[0])},filterDate:je=>{if(Fe.includes(je.getDay()))return!1;const Me=je.toISOString().split("T")[0];return!(ve&&ve.includes(Me)||Ge(je))},dayClassName:je=>{const Me=je.toISOString().split("T")[0];let Se="";return Fe.includes(je.getDay())&&(Se+="react-datepicker__day--disabled "),ve&&Array.isArray(ve)&&ve.includes(Me)&&(Se+="react-datepicker__day--disabled "),Ge(je)&&(Se+="react-datepicker__day--disabled "),Fe.includes(je.getDay())&&(Se+="react-datepicker__day--weekend "),Se.trim()},className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholderText:"Select Date"},e?`loaded-${JSON.stringify(e.holidays||[])}`:"loading")]}),i.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Note: Weekend days, holidays, and vacation periods are disabled as school is closed"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),i.jsxs("select",{value:m,onChange:je=>{g(je.target.value),j("")},className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"All Classes"}),H.map(je=>i.jsx("option",{value:je,children:je},je))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Section"}),i.jsxs("select",{value:b,onChange:je=>j(je.target.value),disabled:!m,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"All Sections"}),O.map(je=>i.jsx("option",{value:je,children:je},je))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Bi,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"text",placeholder:"Search by name, GR No, class...",value:u,onChange:je=>f(je.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]})]})]}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsxs("button",{onClick:se,className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[i.jsx(cA,{className:"mr-1"})," Mark All Present"]}),i.jsxs("button",{onClick:ue,className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:[i.jsx(Tc,{className:"mr-1"})," Mark All Absent"]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[i.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-xl shadow-lg p-4 text-white",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(cA,{className:"h-8 w-8 mr-3"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-green-100",children:"Present"}),i.jsx("p",{className:"text-2xl font-bold",children:fe})]})]})}),i.jsx("div",{className:"bg-gradient-to-r from-red-500 to-red-600 rounded-xl shadow-lg p-4 text-white",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(Tc,{className:"h-8 w-8 mr-3"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-red-100",children:"Absent"}),i.jsx("p",{className:"text-2xl font-bold",children:ke})]})]})}),i.jsx("div",{className:"bg-gradient-to-r from-yellow-500 to-yellow-600 rounded-xl shadow-lg p-4 text-white",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(eu,{className:"h-8 w-8 mr-3"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-yellow-100",children:"Late"}),i.jsx("p",{className:"text-2xl font-bold",children:he})]})]})}),i.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl shadow-lg p-4 text-white",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(eu,{className:"h-8 w-8 mr-3"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-blue-100",children:"Leave"}),i.jsx("p",{className:"text-2xl font-bold",children:Ne})]})]})})]}),L.length>0&&i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:i.jsxs("div",{className:"flex flex-wrap items-center justify-between",children:[i.jsxs("div",{className:"text-blue-800 font-medium",children:[L.length," student",L.length!==1?"s":""," selected"]}),i.jsxs("div",{className:"flex flex-wrap gap-2 mt-2 sm:mt-0",children:[i.jsxs("button",{onClick:()=>J("present"),className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[i.jsx(cA,{className:"mr-1"})," Mark Present"]}),i.jsxs("button",{onClick:()=>J("absent"),className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:[i.jsx(Tc,{className:"mr-1"})," Mark Absent"]}),i.jsxs("button",{onClick:()=>J("late"),className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500",children:[i.jsx(eu,{className:"mr-1"})," Mark Late"]}),i.jsxs("button",{onClick:()=>J("leave"),className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(eu,{className:"mr-1"})," Mark Leave"]}),i.jsx("button",{onClick:z,className:"inline-flex items-center px-3 py-1 border border-gray-300 text-xs font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Clear Selection"})]})]})}),i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[i.jsxs("div",{className:"flex flex-wrap items-center justify-between mb-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Student Attendance (",Q.length," students)"]}),i.jsxs("div",{className:"flex gap-2 mt-2 sm:mt-0",children:[i.jsx("button",{onClick:pe,className:"inline-flex items-center px-3 py-1 border border-gray-300 text-xs font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50",children:"Select All"}),i.jsx("button",{onClick:z,className:"inline-flex items-center px-3 py-1 border border-gray-300 text-xs font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50",children:"Clear Selection"})]})]}),i.jsxs("div",{className:"overflow-hidden rounded-lg border border-gray-200",children:[i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:i.jsx("input",{type:"checkbox",checked:L.length>0&&L.length===Q.length,onChange:je=>{je.target.checked?pe():z()},className:"h-4 w-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"})}),i.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Photo"}),i.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"GR No"}),i.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),i.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class"}),i.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Section"}),i.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:X.map(je=>i.jsxs("tr",{className:`hover:bg-gray-50 ${L.includes(je.id)?"bg-blue-50":""}`,children:[i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:i.jsx("input",{type:"checkbox",checked:L.includes(je.id),onChange:()=>ae(je.id),className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"})}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsx("div",{className:"flex items-center",children:i.jsx("div",{className:"bg-gray-200 border-2 border-dashed rounded-xl w-10 h-10 flex items-center justify-center",children:i.jsx("img",{src:je.photo,alt:je.firstName,className:"w-10 h-10 rounded-xl"})})})}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsx("div",{className:"text-sm text-gray-900",children:je.grNo?je.grNo.replace("GR",""):"N/A"})}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[je.firstName," ",je.lastName]})}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsx("div",{className:"text-sm text-gray-900",children:je.class})}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsx("div",{className:"text-sm text-gray-900",children:je.section})}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsxs("div",{className:"flex space-x-2",children:[i.jsxs("button",{onClick:()=>Z(je.id,"present"),className:xe(je.id,"present"),children:[i.jsx(cA,{className:"mr-1"})," Present"]}),i.jsxs("button",{onClick:()=>Z(je.id,"absent"),className:xe(je.id,"absent"),children:[i.jsx(Tc,{className:"mr-1"})," Absent"]}),i.jsxs("button",{onClick:()=>Z(je.id,"late"),className:xe(je.id,"late"),children:[i.jsx(eu,{className:"mr-1"})," Late"]}),i.jsxs("button",{onClick:()=>Z(je.id,"leave"),className:xe(je.id,"leave"),children:[i.jsx(eu,{className:"mr-1"})," Leave"]})]})})]},je.id))})]}),Q.length===0&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Rl,{className:"mx-auto h-12 w-12 text-gray-400"}),i.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No students found"}),i.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Try adjusting your search or filter criteria"})]}),Q.length>te&&i.jsx("div",{className:"mt-4",children:i.jsx(Bd,{currentPage:we,totalPages:V,itemsPerPage:te,totalItems:Q.length,paginate:ie,nextPage:G,prevPage:q})})]})]})]})},FK=({academicHistory:n})=>!n||n.length===0?i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"text-center py-8",children:[i.jsx(nc,{className:"mx-auto h-12 w-12 text-gray-400"}),i.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No academic history"}),i.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"No academic records found for this student."})]})}):i.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[i.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:i.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[i.jsx(OA,{className:"mr-2 text-blue-500"}),"Academic History"]})}),i.jsx("div",{className:"p-6",children:i.jsx("div",{className:"space-y-6",children:n.map(a=>i.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[i.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-4",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:a.year}),i.jsxs("p",{className:"text-gray-600",children:[a.class," - Section ",a.section]})]}),i.jsx("div",{className:"mt-2 md:mt-0 flex items-center",children:i.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:[a.percentage,"% (",a.grade,")"]})})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("h5",{className:"text-md font-medium text-gray-700 mb-2",children:"Subject Performance"}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:a.subjects.map((t,r)=>i.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm font-medium text-gray-900",children:t.name}),i.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:t.grade})]}),i.jsxs("div",{className:"mt-1 flex items-center",children:[i.jsxs("span",{className:"text-lg font-semibold text-gray-900",children:[t.marks,"%"]}),i.jsx("div",{className:"ml-2 w-full bg-gray-200 rounded-full h-2",children:i.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${t.marks}%`}})})]})]},r))})]}),a.remarks&&i.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[i.jsx("h5",{className:"text-sm font-medium text-blue-800 mb-1",children:"Remarks"}),i.jsx("p",{className:"text-sm text-blue-700",children:a.remarks})]})]},a.id))})})]});function KB(n,a,t,r,s){r=r||{};var e=1.15,u=s.internal.scaleFactor,f=s.internal.getFontSize()/u,m=s.getLineHeightFactor?s.getLineHeightFactor():e,g=f*m,b=/\r\n|\r|\n/g,j="",F=1;if((r.valign==="middle"||r.valign==="bottom"||r.halign==="center"||r.halign==="right")&&(j=typeof n=="string"?n.split(b):n,F=j.length||1),t+=f*(2-e),r.valign==="middle"?t-=F/2*g:r.valign==="bottom"&&(t-=F*g),r.halign==="center"||r.halign==="right"){var C=f;if(r.halign==="center"&&(C*=.5),j&&F>=1){for(var M=0;M<j.length;M++)s.text(j[M],a-s.getStringUnitWidth(j[M])*C,t),t+=g;return s}a-=s.getStringUnitWidth(n)*C}return r.halign==="justify"?s.text(n,a,t,{maxWidth:r.maxWidth||100,align:"justify"}):s.text(n,a,t),s}var LN={},Jm=(function(){function n(a){this.jsPDFDocument=a,this.userStyles={textColor:a.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:a.internal.getFontSize(),fontStyle:a.internal.getFont().fontStyle,font:a.internal.getFont().fontName,lineWidth:a.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:a.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return n.setDefaults=function(a,t){t===void 0&&(t=null),t?t.__autoTableDocumentDefaults=a:LN=a},n.unifyColor=function(a){return Array.isArray(a)?a:typeof a=="number"?[a,a,a]:typeof a=="string"?[a]:null},n.prototype.applyStyles=function(a,t){var r,s,e;t===void 0&&(t=!1),a.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(a.fontStyle);var u=this.jsPDFDocument.internal.getFont(),f=u.fontStyle,m=u.fontName;if(a.font&&(m=a.font),a.fontStyle){f=a.fontStyle;var g=this.getFontList()[m];g&&g.indexOf(f)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(g[0]),f=g[0])}if(this.jsPDFDocument.setFont(m,f),a.fontSize&&this.jsPDFDocument.setFontSize(a.fontSize),!t){var b=n.unifyColor(a.fillColor);b&&(r=this.jsPDFDocument).setFillColor.apply(r,b),b=n.unifyColor(a.textColor),b&&(s=this.jsPDFDocument).setTextColor.apply(s,b),b=n.unifyColor(a.lineColor),b&&(e=this.jsPDFDocument).setDrawColor.apply(e,b),typeof a.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(a.lineWidth)}},n.prototype.splitTextToSize=function(a,t,r){return this.jsPDFDocument.splitTextToSize(a,t,r)},n.prototype.rect=function(a,t,r,s,e){return this.jsPDFDocument.rect(a,t,r,s,e)},n.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},n.prototype.getTextWidth=function(a){return this.jsPDFDocument.getTextWidth(a)},n.prototype.getDocument=function(){return this.jsPDFDocument},n.prototype.setPage=function(a){this.jsPDFDocument.setPage(a)},n.prototype.addPage=function(){return this.jsPDFDocument.addPage()},n.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},n.prototype.getGlobalOptions=function(){return LN||{}},n.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},n.prototype.pageSize=function(){var a=this.jsPDFDocument.internal.pageSize;return a.width==null&&(a={width:a.getWidth(),height:a.getHeight()}),a},n.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},n.prototype.getLineHeightFactor=function(){var a=this.jsPDFDocument;return a.getLineHeightFactor?a.getLineHeightFactor():1.15},n.prototype.getLineHeight=function(a){return a/this.scaleFactor()*this.getLineHeightFactor()},n.prototype.pageNumber=function(){var a=this.jsPDFDocument.internal.getCurrentPageInfo();return a?a.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},n})(),Yw=function(n,a){return Yw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])},Yw(n,a)};function GB(n,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");Yw(n,a);function t(){this.constructor=n}n.prototype=a===null?Object.create(a):(t.prototype=a.prototype,new t)}var VB=(function(n){GB(a,n);function a(t){var r=n.call(this)||this;return r._element=t,r}return a})(Array);function EK(n){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/n,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function kK(n){var a={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return a[n]}function Nb(n,a,t){t.applyStyles(a,!0);var r=Array.isArray(n)?n:[n],s=r.map(function(e){return t.getTextWidth(e)}).reduce(function(e,u){return Math.max(e,u)},0);return s}function YB(n,a,t,r){var s=a.settings.tableLineWidth,e=a.settings.tableLineColor;n.applyStyles({lineWidth:s,lineColor:e});var u=WB(s,!1);u&&n.rect(t.x,t.y,a.getWidth(n.pageSize().width),r.y-t.y,u)}function WB(n,a){var t=n>0,r=a||a===0;return t&&r?"DF":t?"S":r?"F":null}function sy(n,a){var t,r,s,e;if(n=n||a,Array.isArray(n)){if(n.length>=4)return{top:n[0],right:n[1],bottom:n[2],left:n[3]};if(n.length===3)return{top:n[0],right:n[1],bottom:n[2],left:n[1]};if(n.length===2)return{top:n[0],right:n[1],bottom:n[0],left:n[1]};n.length===1?n=n[0]:n=a}return typeof n=="object"?(typeof n.vertical=="number"&&(n.top=n.vertical,n.bottom=n.vertical),typeof n.horizontal=="number"&&(n.right=n.horizontal,n.left=n.horizontal),{left:(t=n.left)!==null&&t!==void 0?t:a,top:(r=n.top)!==null&&r!==void 0?r:a,right:(s=n.right)!==null&&s!==void 0?s:a,bottom:(e=n.bottom)!==null&&e!==void 0?e:a}):(typeof n!="number"&&(n=a),{top:n,right:n,bottom:n,left:n})}function $B(n,a){var t=sy(a.settings.margin,0);return n.pageSize().width-(t.left+t.right)}function DK(n,a,t,r,s){var e={},u=1.3333333333333333,f=Uv(a,function(O){return s.getComputedStyle(O).backgroundColor});f!=null&&(e.fillColor=f);var m=Uv(a,function(O){return s.getComputedStyle(O).color});m!=null&&(e.textColor=m);var g=_K(r,t);g&&(e.cellPadding=g);var b="borderTopColor",j=u*t,F=r.borderTopWidth;if(r.borderBottomWidth===F&&r.borderRightWidth===F&&r.borderLeftWidth===F){var C=(parseFloat(F)||0)/j;C&&(e.lineWidth=C)}else e.lineWidth={top:(parseFloat(r.borderTopWidth)||0)/j,right:(parseFloat(r.borderRightWidth)||0)/j,bottom:(parseFloat(r.borderBottomWidth)||0)/j,left:(parseFloat(r.borderLeftWidth)||0)/j},e.lineWidth.top||(e.lineWidth.right?b="borderRightColor":e.lineWidth.bottom?b="borderBottomColor":e.lineWidth.left&&(b="borderLeftColor"));var M=Uv(a,function(O){return s.getComputedStyle(O)[b]});M!=null&&(e.lineColor=M);var _=["left","right","center","justify"];_.indexOf(r.textAlign)!==-1&&(e.halign=r.textAlign),_=["middle","bottom","top"],_.indexOf(r.verticalAlign)!==-1&&(e.valign=r.verticalAlign);var L=parseInt(r.fontSize||"");isNaN(L)||(e.fontSize=L/u);var T=TK(r);T&&(e.fontStyle=T);var H=(r.fontFamily||"").toLowerCase();return n.indexOf(H)!==-1&&(e.font=H),e}function TK(n){var a="";return(n.fontWeight==="bold"||n.fontWeight==="bolder"||parseInt(n.fontWeight)>=700)&&(a="bold"),(n.fontStyle==="italic"||n.fontStyle==="oblique")&&(a+="italic"),a}function Uv(n,a){var t=qB(n,a);if(!t)return null;var r=t.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!r||!Array.isArray(r))return null;var s=[parseInt(r[1]),parseInt(r[2]),parseInt(r[3])],e=parseInt(r[4]);return e===0||isNaN(s[0])||isNaN(s[1])||isNaN(s[2])?null:s}function qB(n,a){var t=a(n);return t==="rgba(0, 0, 0, 0)"||t==="transparent"||t==="initial"||t==="inherit"?n.parentElement==null?null:qB(n.parentElement,a):t}function _K(n,a){var t=[n.paddingTop,n.paddingRight,n.paddingBottom,n.paddingLeft],r=96/(72/a),s=(parseInt(n.lineHeight)-parseInt(n.fontSize))/a/2,e=t.map(function(f){return parseInt(f||"0")/r}),u=sy(e,0);return s>u.top&&(u.top=s),s>u.bottom&&(u.bottom=s),u}function XB(n,a,t,r,s){var e,u;r===void 0&&(r=!1),s===void 0&&(s=!1);var f;typeof a=="string"?f=t.document.querySelector(a):f=a;var m=Object.keys(n.getFontList()),g=n.scaleFactor(),b=[],j=[],F=[];if(!f)return console.error("Html table could not be found with input: ",a),{head:b,body:j,foot:F};for(var C=0;C<f.rows.length;C++){var M=f.rows[C],_=(u=(e=M?.parentElement)===null||e===void 0?void 0:e.tagName)===null||u===void 0?void 0:u.toLowerCase(),L=LK(m,g,t,M,r,s);L&&(_==="thead"?b.push(L):_==="tfoot"?F.push(L):j.push(L))}return{head:b,body:j,foot:F}}function LK(n,a,t,r,s,e){for(var u=new VB(r),f=0;f<r.cells.length;f++){var m=r.cells[f],g=t.getComputedStyle(m);if(s||g.display!=="none"){var b=void 0;e&&(b=DK(n,m,a,g,t)),u.push({rowSpan:m.rowSpan,colSpan:m.colSpan,styles:b,_element:m,content:UK(m)})}}var j=t.getComputedStyle(r);if(u.length>0&&(s||j.display!=="none"))return u}function UK(n){var a=n.cloneNode(!0);return a.innerHTML=a.innerHTML.replace(/\n/g,"").replace(/ +/g," "),a.innerHTML=a.innerHTML.split(/<br.*?>/).map(function(t){return t.trim()}).join(`
`),a.innerText||a.textContent||""}function MK(n,a,t){for(var r=0,s=[n,a,t];r<s.length;r++){var e=s[r];e&&typeof e!="object"&&console.error("The options parameter should be of type object, is: "+typeof e),e.startY&&typeof e.startY!="number"&&(console.error("Invalid value for startY option",e.startY),delete e.startY)}}function Wu(n,a,t,r,s){if(n==null)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(n),u=1;u<arguments.length;u++){var f=arguments[u];if(f!=null)for(var m in f)Object.prototype.hasOwnProperty.call(f,m)&&(e[m]=f[m])}return e}function IK(n,a){var t=new Jm(n),r=t.getDocumentOptions(),s=t.getGlobalOptions();MK(s,r,a);var e=Wu({},s,r,a),u;typeof window<"u"&&(u=window);var f=OK(s,r,a),m=QK(s,r,a),g=RK(t,e),b=HK(t,e,u);return{id:a.tableId,content:b,hooks:m,styles:f,settings:g}}function OK(n,a,t){for(var r={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},s=function(m){if(m==="columnStyles"){var g=n[m],b=a[m],j=t[m];r.columnStyles=Wu({},g,b,j)}else{var F=[n,a,t],C=F.map(function(M){return M[m]||{}});r[m]=Wu({},C[0],C[1],C[2])}},e=0,u=Object.keys(r);e<u.length;e++){var f=u[e];s(f)}return r}function QK(n,a,t){for(var r=[n,a,t],s={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},e=0,u=r;e<u.length;e++){var f=u[e];f.didParseCell&&s.didParseCell.push(f.didParseCell),f.willDrawCell&&s.willDrawCell.push(f.willDrawCell),f.didDrawCell&&s.didDrawCell.push(f.didDrawCell),f.willDrawPage&&s.willDrawPage.push(f.willDrawPage),f.didDrawPage&&s.didDrawPage.push(f.didDrawPage)}return s}function RK(n,a){var t,r,s,e,u,f,m,g,b,j,F,C,M=sy(a.margin,40/n.scaleFactor()),_=(t=PK(n,a.startY))!==null&&t!==void 0?t:M.top,L;a.showFoot===!0?L="everyPage":a.showFoot===!1?L="never":L=(r=a.showFoot)!==null&&r!==void 0?r:"everyPage";var T;a.showHead===!0?T="everyPage":a.showHead===!1?T="never":T=(s=a.showHead)!==null&&s!==void 0?s:"everyPage";var H=(e=a.useCss)!==null&&e!==void 0?e:!1,O=a.theme||(H?"plain":"striped"),Q=!!a.horizontalPageBreak,Z=(u=a.horizontalPageBreakRepeat)!==null&&u!==void 0?u:null;return{includeHiddenHtml:(f=a.includeHiddenHtml)!==null&&f!==void 0?f:!1,useCss:H,theme:O,startY:_,margin:M,pageBreak:(m=a.pageBreak)!==null&&m!==void 0?m:"auto",rowPageBreak:(g=a.rowPageBreak)!==null&&g!==void 0?g:"auto",tableWidth:(b=a.tableWidth)!==null&&b!==void 0?b:"auto",showHead:T,showFoot:L,tableLineWidth:(j=a.tableLineWidth)!==null&&j!==void 0?j:0,tableLineColor:(F=a.tableLineColor)!==null&&F!==void 0?F:200,horizontalPageBreak:Q,horizontalPageBreakRepeat:Z,horizontalPageBreakBehaviour:(C=a.horizontalPageBreakBehaviour)!==null&&C!==void 0?C:"afterAllRows"}}function PK(n,a){var t=n.getLastAutoTable(),r=n.scaleFactor(),s=n.pageNumber(),e=!1;if(t&&t.startPageNumber){var u=t.startPageNumber+t.pageNumber-1;e=u===s}return typeof a=="number"?a:(a==null||a===!1)&&e&&t?.finalY!=null?t.finalY+20/r:null}function HK(n,a,t){var r=a.head||[],s=a.body||[],e=a.foot||[];if(a.html){var u=a.includeHiddenHtml;if(t){var f=XB(n,a.html,t,u,a.useCss)||{};r=f.head||r,s=f.body||r,e=f.foot||r}else console.error("Cannot parse html in non browser environment")}var m=a.columns||zK(r,s,e);return{columns:m,head:r,body:s,foot:e}}function zK(n,a,t){var r=n[0]||a[0]||t[0]||[],s=[];return Object.keys(r).filter(function(e){return e!=="_element"}).forEach(function(e){var u=1,f;Array.isArray(r)?f=r[parseInt(e)]:f=r[e],typeof f=="object"&&!Array.isArray(f)&&(u=f?.colSpan||1);for(var m=0;m<u;m++){var g=void 0;Array.isArray(r)?g=s.length:g=e+(m>0?"_".concat(m):"");var b={dataKey:g};s.push(b)}}),s}var Ww=(function(){function n(a,t,r){this.table=t,this.pageNumber=t.pageNumber,this.settings=t.settings,this.cursor=r,this.doc=a.getDocument()}return n})(),KK=(function(n){GB(a,n);function a(t,r,s,e,u,f){var m=n.call(this,t,r,f)||this;return m.cell=s,m.row=e,m.column=u,m.section=e.section,m}return a})(Ww),GK=(function(){function n(a,t){this.pageNumber=1,this.id=a.id,this.settings=a.settings,this.styles=a.styles,this.hooks=a.hooks,this.columns=t.columns,this.head=t.head,this.body=t.body,this.foot=t.foot}return n.prototype.getHeadHeight=function(a){return this.head.reduce(function(t,r){return t+r.getMaxCellHeight(a)},0)},n.prototype.getFootHeight=function(a){return this.foot.reduce(function(t,r){return t+r.getMaxCellHeight(a)},0)},n.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},n.prototype.callCellHooks=function(a,t,r,s,e,u){for(var f=0,m=t;f<m.length;f++){var g=m[f],b=new KK(a,this,r,s,e,u),j=g(b)===!1;if(r.text=Array.isArray(r.text)?r.text:[r.text],j)return!1}return!0},n.prototype.callEndPageHooks=function(a,t){a.applyStyles(a.userStyles);for(var r=0,s=this.hooks.didDrawPage;r<s.length;r++){var e=s[r];e(new Ww(a,this,t))}},n.prototype.callWillDrawPageHooks=function(a,t){for(var r=0,s=this.hooks.willDrawPage;r<s.length;r++){var e=s[r];e(new Ww(a,this,t))}},n.prototype.getWidth=function(a){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var t=this.columns.reduce(function(s,e){return s+e.wrappedWidth},0);return t}else{var r=this.settings.margin;return a-r.left-r.right}},n})(),JB=(function(){function n(a,t,r,s,e){e===void 0&&(e=!1),this.height=0,this.raw=a,a instanceof VB&&(this.raw=a._element,this.element=a._element),this.index=t,this.section=r,this.cells=s,this.spansMultiplePages=e}return n.prototype.getMaxCellHeight=function(a){var t=this;return a.reduce(function(r,s){var e;return Math.max(r,((e=t.cells[s.index])===null||e===void 0?void 0:e.height)||0)},0)},n.prototype.hasRowSpan=function(a){var t=this;return a.filter(function(r){var s=t.cells[r.index];return s?s.rowSpan>1:!1}).length>0},n.prototype.canEntireRowFit=function(a,t){return this.getMaxCellHeight(t)<=a},n.prototype.getMinimumRowHeight=function(a,t){var r=this;return a.reduce(function(s,e){var u=r.cells[e.index];if(!u)return 0;var f=t.getLineHeight(u.styles.fontSize),m=u.padding("vertical"),g=m+f;return g>s?g:s},0)},n})(),ZB=(function(){function n(a,t,r){var s;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=t,this.section=r,this.raw=a;var e=a;a!=null&&typeof a=="object"&&!Array.isArray(a)?(this.rowSpan=a.rowSpan||1,this.colSpan=a.colSpan||1,e=(s=a.content)!==null&&s!==void 0?s:a,a._element&&(this.raw=a._element)):(this.rowSpan=1,this.colSpan=1);var u=e!=null?""+e:"",f=/\r\n|\r|\n/g;this.text=u.split(f)}return n.prototype.getTextPos=function(){var a;if(this.styles.valign==="top")a=this.y+this.padding("top");else if(this.styles.valign==="bottom")a=this.y+this.height-this.padding("bottom");else{var t=this.height-this.padding("vertical");a=this.y+t/2+this.padding("top")}var r;if(this.styles.halign==="right")r=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var s=this.width-this.padding("horizontal");r=this.x+s/2+this.padding("left")}else r=this.x+this.padding("left");return{x:r,y:a}},n.prototype.getContentHeight=function(a,t){t===void 0&&(t=1.15);var r=Array.isArray(this.text)?this.text.length:1,s=this.styles.fontSize/a*t,e=r*s+this.padding("vertical");return Math.max(e,this.styles.minCellHeight)},n.prototype.padding=function(a){var t=sy(this.styles.cellPadding,0);return a==="vertical"?t.top+t.bottom:a==="horizontal"?t.left+t.right:t[a]},n})(),VK=(function(){function n(a,t,r){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=a,this.raw=t,this.index=r}return n.prototype.getMaxCustomCellWidth=function(a){for(var t=0,r=0,s=a.allRows();r<s.length;r++){var e=s[r],u=e.cells[this.index];u&&typeof u.styles.cellWidth=="number"&&(t=Math.max(t,u.styles.cellWidth))}return t},n})();function YK(n,a){WK(n,a);var t=[],r=0;a.columns.forEach(function(e){var u=e.getMaxCustomCellWidth(a);u?e.width=u:(e.width=e.wrappedWidth,t.push(e)),r+=e.width});var s=a.getWidth(n.pageSize().width)-r;s&&(s=$w(t,s,function(e){return Math.max(e.minReadableWidth,e.minWidth)})),s&&(s=$w(t,s,function(e){return e.minWidth})),s=Math.abs(s),!a.settings.horizontalPageBreak&&s>.1/n.scaleFactor()&&(s=s<1?s:Math.round(s),console.warn("Of the table content, ".concat(s," units width could not fit page"))),qK(a),XK(a,n),$K(a)}function WK(n,a){var t=n.scaleFactor(),r=a.settings.horizontalPageBreak,s=$B(n,a);a.allRows().forEach(function(e){for(var u=0,f=a.columns;u<f.length;u++){var m=f[u],g=e.cells[m.index];if(g){var b=a.hooks.didParseCell;a.callCellHooks(n,b,g,e,m,null);var j=g.padding("horizontal");g.contentWidth=Nb(g.text,g.styles,n)+j;var F=Nb(g.text.join(" ").split(/[^\S\u00A0]+/),g.styles,n);if(g.minReadableWidth=F+g.padding("horizontal"),typeof g.styles.cellWidth=="number")g.minWidth=g.styles.cellWidth,g.wrappedWidth=g.styles.cellWidth;else if(g.styles.cellWidth==="wrap"||r===!0)g.contentWidth>s?(g.minWidth=s,g.wrappedWidth=s):(g.minWidth=g.contentWidth,g.wrappedWidth=g.contentWidth);else{var C=10/t;g.minWidth=g.styles.minCellWidth||C,g.wrappedWidth=g.contentWidth,g.minWidth>g.wrappedWidth&&(g.wrappedWidth=g.minWidth)}}}}),a.allRows().forEach(function(e){for(var u=0,f=a.columns;u<f.length;u++){var m=f[u],g=e.cells[m.index];if(g&&g.colSpan===1)m.wrappedWidth=Math.max(m.wrappedWidth,g.wrappedWidth),m.minWidth=Math.max(m.minWidth,g.minWidth),m.minReadableWidth=Math.max(m.minReadableWidth,g.minReadableWidth);else{var b=a.styles.columnStyles[m.dataKey]||a.styles.columnStyles[m.index]||{},j=b.cellWidth||b.minCellWidth;j&&typeof j=="number"&&(m.minWidth=j,m.wrappedWidth=j)}g&&(g.colSpan>1&&!m.minWidth&&(m.minWidth=g.minWidth),g.colSpan>1&&!m.wrappedWidth&&(m.wrappedWidth=g.minWidth))}})}function $w(n,a,t){for(var r=a,s=n.reduce(function(C,M){return C+M.wrappedWidth},0),e=0;e<n.length;e++){var u=n[e],f=u.wrappedWidth/s,m=r*f,g=u.width+m,b=t(u),j=g<b?b:g;a-=j-u.width,u.width=j}if(a=Math.round(a*1e10)/1e10,a){var F=n.filter(function(C){return a<0?C.width>t(C):!0});F.length&&(a=$w(F,a,t))}return a}function $K(n){for(var a={},t=1,r=n.allRows(),s=0;s<r.length;s++)for(var e=r[s],u=0,f=n.columns;u<f.length;u++){var m=f[u],g=a[m.index];if(t>1)t--,delete e.cells[m.index];else if(g)g.cell.height+=e.height,t=g.cell.colSpan,delete e.cells[m.index],g.left--,g.left<=1&&delete a[m.index];else{var b=e.cells[m.index];if(!b)continue;if(b.height=e.height,b.rowSpan>1){var j=r.length-s,F=b.rowSpan>j?j:b.rowSpan;a[m.index]={cell:b,left:F,row:e}}}}}function qK(n){for(var a=n.allRows(),t=0;t<a.length;t++)for(var r=a[t],s=null,e=0,u=0,f=0;f<n.columns.length;f++){var m=n.columns[f];if(u-=1,u>1&&n.columns[f+1])e+=m.width,delete r.cells[m.index];else if(s){var g=s;delete r.cells[m.index],s=null,g.width=m.width+e}else{var g=r.cells[m.index];if(!g)continue;if(u=g.colSpan,e=0,g.colSpan>1){s=g,e+=m.width;continue}g.width=m.width+e}}}function XK(n,a){for(var t={count:0,height:0},r=0,s=n.allRows();r<s.length;r++){for(var e=s[r],u=0,f=n.columns;u<f.length;u++){var m=f[u],g=e.cells[m.index];if(g){a.applyStyles(g.styles,!0);var b=g.width-g.padding("horizontal");if(g.styles.overflow==="linebreak")g.text=a.splitTextToSize(g.text,b+1/a.scaleFactor(),{fontSize:g.styles.fontSize});else if(g.styles.overflow==="ellipsize")g.text=UN(g.text,b,g.styles,a,"...");else if(g.styles.overflow==="hidden")g.text=UN(g.text,b,g.styles,a,"");else if(typeof g.styles.overflow=="function"){var j=g.styles.overflow(g.text,b);typeof j=="string"?g.text=[j]:g.text=j}g.contentHeight=g.getContentHeight(a.scaleFactor(),a.getLineHeightFactor());var F=g.contentHeight/g.rowSpan;g.rowSpan>1&&t.count*t.height<F*g.rowSpan?t={height:F,count:g.rowSpan}:t&&t.count>0&&t.height>F&&(F=t.height),F>e.height&&(e.height=F)}}t.count--}}function UN(n,a,t,r,s){return n.map(function(e){return JK(e,a,t,r,s)})}function JK(n,a,t,r,s){var e=1e4*r.scaleFactor();if(a=Math.ceil(a*e)/e,a>=Nb(n,t,r))return n;for(;a<Nb(n+s,t,r)&&!(n.length<=1);)n=n.substring(0,n.length-1);return n.trim()+s}function ZK(n,a){var t=new Jm(n),r=eG(a,t.scaleFactor()),s=new GK(a,r);return YK(t,s),t.applyStyles(t.userStyles),s}function eG(n,a){var t=n.content,r=rG(t.columns);if(t.head.length===0){var s=MN(r,"head");s&&t.head.push(s)}if(t.foot.length===0){var s=MN(r,"foot");s&&t.foot.push(s)}var e=n.settings.theme,u=n.styles;return{columns:r,head:Mv("head",t.head,r,u,e,a),body:Mv("body",t.body,r,u,e,a),foot:Mv("foot",t.foot,r,u,e,a)}}function Mv(n,a,t,r,s,e){var u={},f=a.map(function(m,g){for(var b=0,j={},F=0,C=0,M=0,_=t;M<_.length;M++){var L=_[M];if(u[L.index]==null||u[L.index].left===0)if(C===0){var T=void 0;Array.isArray(m)?T=m[L.index-F-b]:T=m[L.dataKey];var H={};typeof T=="object"&&!Array.isArray(T)&&(H=T?.styles||{});var O=aG(n,L,g,s,r,e,H),Q=new ZB(T,O,n);j[L.dataKey]=Q,j[L.index]=Q,C=Q.colSpan-1,u[L.index]={left:Q.rowSpan-1,times:C}}else C--,F++;else u[L.index].left--,C=u[L.index].times,b++}return new JB(m,g,n,j)});return f}function MN(n,a){var t={};return n.forEach(function(r){if(r.raw!=null){var s=tG(a,r.raw);s!=null&&(t[r.dataKey]=s)}}),Object.keys(t).length>0?t:null}function tG(n,a){if(n==="head"){if(typeof a=="object")return a.header||null;if(typeof a=="string"||typeof a=="number")return a}else if(n==="foot"&&typeof a=="object")return a.footer;return null}function rG(n){return n.map(function(a,t){var r,s;return typeof a=="object"?s=(r=a.dataKey)!==null&&r!==void 0?r:t:s=t,new VK(s,a,t)})}function aG(n,a,t,r,s,e,u){var f=kK(r),m;n==="head"?m=s.headStyles:n==="body"?m=s.bodyStyles:n==="foot"&&(m=s.footStyles);var g=Wu({},f.table,f[n],s.styles,m),b=s.columnStyles[a.dataKey]||s.columnStyles[a.index]||{},j=n==="body"?b:{},F=n==="body"&&t%2===0?Wu({},f.alternateRow,s.alternateRowStyles):{},C=EK(e),M=Wu({},C,g,F,j);return Wu(M,u)}function sG(n,a,t){var r;t===void 0&&(t={});var s=$B(n,a),e=new Map,u=[],f=[],m=[];Array.isArray(a.settings.horizontalPageBreakRepeat)?m=a.settings.horizontalPageBreakRepeat:(typeof a.settings.horizontalPageBreakRepeat=="string"||typeof a.settings.horizontalPageBreakRepeat=="number")&&(m=[a.settings.horizontalPageBreakRepeat]),m.forEach(function(F){var C=a.columns.find(function(M){return M.dataKey===F||M.index===F});C&&!e.has(C.index)&&(e.set(C.index,!0),u.push(C.index),f.push(a.columns[C.index]),s-=C.wrappedWidth)});for(var g=!0,b=(r=t?.start)!==null&&r!==void 0?r:0;b<a.columns.length;){if(e.has(b)){b++;continue}var j=a.columns[b].wrappedWidth;if(g||s>=j)g=!1,u.push(b),f.push(a.columns[b]),s-=j;else break;b++}return{colIndexes:u,columns:f,lastIndex:b-1}}function nG(n,a){for(var t=[],r=0;r<a.columns.length;r++){var s=sG(n,a,{start:r});s.columns.length&&(t.push(s),r=s.lastIndex)}return t}function iG(n,a){var t=a.settings,r=t.startY,s=t.margin,e={x:s.left,y:r},u=a.getHeadHeight(a.columns)+a.getFootHeight(a.columns),f=r+s.bottom+u;if(t.pageBreak==="avoid"){var m=a.body,g=m.reduce(function(F,C){return F+C.height},0);f+=g}var b=new Jm(n);(t.pageBreak==="always"||t.startY!=null&&f>b.pageSize().height)&&(tS(b),e.y=s.top),a.callWillDrawPageHooks(b,e);var j=Wu({},e);a.startPageNumber=b.pageNumber(),t.horizontalPageBreak?oG(b,a,j,e):(b.applyStyles(b.userStyles),(t.showHead==="firstPage"||t.showHead==="everyPage")&&a.head.forEach(function(F){return cf(b,a,F,e,a.columns)}),b.applyStyles(b.userStyles),a.body.forEach(function(F,C){var M=C===a.body.length-1;Cb(b,a,F,M,j,e,a.columns)}),b.applyStyles(b.userStyles),(t.showFoot==="lastPage"||t.showFoot==="everyPage")&&a.foot.forEach(function(F){return cf(b,a,F,e,a.columns)})),YB(b,a,j,e),a.callEndPageHooks(b,e),a.finalY=e.y,n.lastAutoTable=a,b.applyStyles(b.userStyles)}function oG(n,a,t,r){var s=nG(n,a),e=a.settings;if(e.horizontalPageBreakBehaviour==="afterAllRows")s.forEach(function(g,b){n.applyStyles(n.userStyles),b>0?$1(n,a,t,r,g.columns,!0):IN(n,a,r,g.columns),lG(n,a,t,r,g.columns),Iv(n,a,r,g.columns)});else for(var u=-1,f=s[0],m=function(){var g=u;if(f){n.applyStyles(n.userStyles);var b=f.columns;u>=0?$1(n,a,t,r,b,!0):IN(n,a,r,b),g=ON(n,a,u+1,r,b),Iv(n,a,r,b)}var j=g-u;s.slice(1).forEach(function(F){n.applyStyles(n.userStyles),$1(n,a,t,r,F.columns,!0),ON(n,a,u+1,r,F.columns,j),Iv(n,a,r,F.columns)}),u=g};u<a.body.length-1;)m()}function IN(n,a,t,r){var s=a.settings;n.applyStyles(n.userStyles),(s.showHead==="firstPage"||s.showHead==="everyPage")&&a.head.forEach(function(e){return cf(n,a,e,t,r)})}function lG(n,a,t,r,s){n.applyStyles(n.userStyles),a.body.forEach(function(e,u){var f=u===a.body.length-1;Cb(n,a,e,f,t,r,s)})}function ON(n,a,t,r,s,e){n.applyStyles(n.userStyles),e=e??a.body.length;var u=Math.min(t+e,a.body.length),f=-1;return a.body.slice(t,u).forEach(function(m,g){var b=t+g===a.body.length-1,j=eS(n,a,b,r);m.canEntireRowFit(j,s)&&(cf(n,a,m,r,s),f=t+g)}),f}function Iv(n,a,t,r){var s=a.settings;n.applyStyles(n.userStyles),(s.showFoot==="lastPage"||s.showFoot==="everyPage")&&a.foot.forEach(function(e){return cf(n,a,e,t,r)})}function cG(n,a,t){var r=t.getLineHeight(n.styles.fontSize),s=n.padding("vertical"),e=Math.floor((a-s)/r);return Math.max(0,e)}function AG(n,a,t,r){var s={};n.spansMultiplePages=!0,n.height=0;for(var e=0,u=0,f=t.columns;u<f.length;u++){var m=f[u],g=n.cells[m.index];if(g){Array.isArray(g.text)||(g.text=[g.text]);var b=new ZB(g.raw,g.styles,g.section);b=Wu(b,g),b.text=[];var j=cG(g,a,r);g.text.length>j&&(b.text=g.text.splice(j,g.text.length));var F=r.scaleFactor(),C=r.getLineHeightFactor();g.contentHeight=g.getContentHeight(F,C),g.contentHeight>=a&&(g.contentHeight=a,b.styles.minCellHeight-=a),g.contentHeight>n.height&&(n.height=g.contentHeight),b.contentHeight=b.getContentHeight(F,C),b.contentHeight>e&&(e=b.contentHeight),s[m.index]=b}}var M=new JB(n.raw,-1,n.section,s,!0);M.height=e;for(var _=0,L=t.columns;_<L.length;_++){var m=L[_],b=M.cells[m.index];b&&(b.height=M.height);var g=n.cells[m.index];g&&(g.height=n.height)}return M}function dG(n,a,t,r){var s=n.pageSize().height,e=r.settings.margin,u=e.top+e.bottom,f=s-u;a.section==="body"&&(f-=r.getHeadHeight(r.columns)+r.getFootHeight(r.columns));var m=a.getMinimumRowHeight(r.columns,n),g=m<t;if(m>f)return console.error("Will not be able to print row ".concat(a.index," correctly since it's minimum height is larger than page height")),!0;if(!g)return!1;var b=a.hasRowSpan(r.columns),j=a.getMaxCellHeight(r.columns)>f;return j?(b&&console.error("The content of row ".concat(a.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(b||r.settings.rowPageBreak==="avoid")}function Cb(n,a,t,r,s,e,u){var f=eS(n,a,r,e);if(t.canEntireRowFit(f,u))cf(n,a,t,e,u);else if(dG(n,t,f,a)){var m=AG(t,f,a,n);cf(n,a,t,e,u),$1(n,a,s,e,u),Cb(n,a,m,r,s,e,u)}else $1(n,a,s,e,u),Cb(n,a,t,r,s,e,u)}function cf(n,a,t,r,s){r.x=a.settings.margin.left;for(var e=0,u=s;e<u.length;e++){var f=u[e],m=t.cells[f.index];if(!m){r.x+=f.width;continue}n.applyStyles(m.styles),m.x=r.x,m.y=r.y;var g=a.callCellHooks(n,a.hooks.willDrawCell,m,t,f,r);if(g===!1){r.x+=f.width;continue}uG(n,m,r);var b=m.getTextPos();KB(m.text,b.x,b.y,{halign:m.styles.halign,valign:m.styles.valign,maxWidth:Math.ceil(m.width-m.padding("left")-m.padding("right"))},n.getDocument()),a.callCellHooks(n,a.hooks.didDrawCell,m,t,f,r),r.x+=f.width}r.y+=t.height}function uG(n,a,t){var r=a.styles;if(n.getDocument().setFillColor(n.getDocument().getFillColor()),typeof r.lineWidth=="number"){var s=WB(r.lineWidth,r.fillColor);s&&n.rect(a.x,t.y,a.width,a.height,s)}else typeof r.lineWidth=="object"&&(r.fillColor&&n.rect(a.x,t.y,a.width,a.height,"F"),fG(n,a,t,r.lineWidth))}function fG(n,a,t,r){var s,e,u,f;r.top&&(s=t.x,e=t.y,u=t.x+a.width,f=t.y,r.right&&(u+=.5*r.right),r.left&&(s-=.5*r.left),m(r.top,s,e,u,f)),r.bottom&&(s=t.x,e=t.y+a.height,u=t.x+a.width,f=t.y+a.height,r.right&&(u+=.5*r.right),r.left&&(s-=.5*r.left),m(r.bottom,s,e,u,f)),r.left&&(s=t.x,e=t.y,u=t.x,f=t.y+a.height,r.top&&(e-=.5*r.top),r.bottom&&(f+=.5*r.bottom),m(r.left,s,e,u,f)),r.right&&(s=t.x+a.width,e=t.y,u=t.x+a.width,f=t.y+a.height,r.top&&(e-=.5*r.top),r.bottom&&(f+=.5*r.bottom),m(r.right,s,e,u,f));function m(g,b,j,F,C){n.getDocument().setLineWidth(g),n.getDocument().line(b,j,F,C,"S")}}function eS(n,a,t,r){var s=a.settings.margin.bottom,e=a.settings.showFoot;return(e==="everyPage"||e==="lastPage"&&t)&&(s+=a.getFootHeight(a.columns)),n.pageSize().height-r.y-s}function $1(n,a,t,r,s,e){s===void 0&&(s=[]),e===void 0&&(e=!1),n.applyStyles(n.userStyles),a.settings.showFoot==="everyPage"&&!e&&a.foot.forEach(function(f){return cf(n,a,f,r,s)}),a.callEndPageHooks(n,r);var u=a.settings.margin;YB(n,a,t,r),tS(n),a.pageNumber++,r.x=u.left,r.y=u.top,t.y=u.top,a.callWillDrawPageHooks(n,r),a.settings.showHead==="everyPage"&&(a.head.forEach(function(f){return cf(n,a,f,r,s)}),n.applyStyles(n.userStyles))}function tS(n){var a=n.pageNumber();n.setPage(a+1);var t=n.pageNumber();return t===a?(n.addPage(),!0):!1}function hG(n){n.API.autoTable=function(){for(var a=[],t=0;t<arguments.length;t++)a[t]=arguments[t];var r=a[0],s=IK(this,r),e=ZK(this,s);return iG(this,e),this},n.API.lastAutoTable=!1,n.API.autoTableText=function(a,t,r,s){KB(a,t,r,s,this)},n.API.autoTableSetDefaults=function(a){return Jm.setDefaults(a,this),this},n.autoTableSetDefaults=function(a,t){Jm.setDefaults(a,t)},n.API.autoTableHtmlToJson=function(a,t){var r;if(t===void 0&&(t=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var s=new Jm(this),e=XB(s,a,window,t,!1),u=e.head,f=e.body,m=((r=u[0])===null||r===void 0?void 0:r.map(function(g){return g.content}))||[];return{columns:m,rows:f,data:f}}}var Ov;try{if(typeof window<"u"&&window){var QN=window,RN=QN.jsPDF||((Ov=QN.jspdf)===null||Ov===void 0?void 0:Ov.jsPDF);RN&&hG(RN)}}catch(n){console.error("Could not apply autoTable plugin",n)}const mG=()=>{const n=Pn(),{students:a}=rr(ee=>ee.students),{classes:t}=rr(ee=>ee.classes),{currentReport:r,loading:s,error:e,filters:u}=rr(ee=>ee.reports),[f,m]=ne.useState({studentId:"",class:"",startDate:"",endDate:"",reportType:"monthly"}),[g,b]=ne.useState(""),[j,F]=ne.useState("");ne.useEffect(()=>{n(Lc()),n(gd()),n(g2())},[n]),ne.useEffect(()=>{r&&(b(r.comments||""),F(r.behavior||""))},[r]);const C=(ee,se)=>{m(ue=>({...ue,[ee]:se}))},M=()=>{if(!f.studentId&&!f.class){alert("Please select either a student or a class");return}if(!f.startDate||!f.endDate){alert("Please select both start and end dates");return}n(y2(f))},_=()=>{r&&(n(kE(g)),n(DE(j)),alert("Comments and behavioral assessment saved successfully!"))},L=ee=>{const se=new Date;let ue,ae;switch(ee){case"weekly":ue=new Date(se),ue.setDate(se.getDate()-se.getDay()),ae=new Date(ue),ae.setDate(ue.getDate()+6);break;case"monthly":ue=new Date(se.getFullYear(),se.getMonth(),1),ae=new Date(se.getFullYear(),se.getMonth()+1,0);break;case"quarterly":const pe=Math.floor(se.getMonth()/3);ue=new Date(se.getFullYear(),pe*3,1),ae=new Date(se.getFullYear(),(pe+1)*3,0);break;case"yearly":ue=new Date(se.getFullYear(),0,1),ae=new Date(se.getFullYear(),11,31);break;default:ue=new Date(se.getFullYear(),se.getMonth(),1),ae=new Date(se.getFullYear(),se.getMonth()+1,0)}return{startDate:ue.toISOString().split("T")[0],endDate:ae.toISOString().split("T")[0]}};ne.useEffect(()=>{const{startDate:ee,endDate:se}=L(f.reportType);m(ue=>({...ue,startDate:ee,endDate:se}))},[f.reportType]);const T=f.class?a.filter(ee=>ee.class===f.class):a,H=()=>{if(!r){alert("Please generate a report first");return}const ee=window.open("","_blank"),se=`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Student Report - ${r.studentName}</title>
          <meta charset="UTF-8">
          <style>
            body { 
              font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
              margin: 0;
              padding: 0.5in;
            }
            .header { 
              text-align: center; 
              border-bottom: 2px solid #333; 
              padding-bottom: 10px; 
              margin-bottom: 20px;
            }
            .section { 
              margin-bottom: 20px; 
            }
            .section-title { 
              font-size: 18px; 
              font-weight: bold; 
              margin-bottom: 10px; 
              color: #333;
            }
            table { 
              width: 100%; 
              border-collapse: collapse; 
              margin-bottom: 20px;
            }
            th, td { 
              border: 1px solid #ddd; 
              padding: 8px; 
              text-align: left;
            }
            th { 
              background-color: #f2f2f2; 
              font-weight: bold;
            }
            .stats-grid { 
              display: grid; 
              grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); 
              gap: 10px; 
              margin-bottom: 20px;
            }
            .stat-card { 
              border: 1px solid #ddd; 
              padding: 10px; 
              text-align: center;
            }
            .stat-value { 
              font-size: 24px; 
              font-weight: bold; 
              color: #333;
            }
            .stat-label { 
              font-size: 14px; 
              color: #666;
            }
          </style>
        </head>
        <body>
          <div class="header">
            <h1>Student Progress Report</h1>
            <p>Report for ${r.studentName} (${r.class} - ${r.section})</p>
            <p>Period: ${r.period.startDate} to ${r.period.endDate}</p>
            <p>Generated on: ${r.generatedDate}</p>
          </div>
          
          <div class="section">
            <div class="section-title">Attendance Summary</div>
            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-value">${r.attendance.totalDays}</div>
                <div class="stat-label">Total Days</div>
              </div>
              <div class="stat-card">
                <div class="stat-value">${r.attendance.present}</div>
                <div class="stat-label">Present</div>
              </div>
              <div class="stat-card">
                <div class="stat-value">${r.attendance.absent}</div>
                <div class="stat-label">Absent</div>
              </div>
              <div class="stat-card">
                <div class="stat-value">${r.attendance.late}</div>
                <div class="stat-label">Late</div>
              </div>
              <div class="stat-card">
                <div class="stat-value">${r.attendance.leave}</div>
                <div class="stat-label">Leave</div>
              </div>
              <div class="stat-card">
                <div class="stat-value">${r.attendance.percentage}%</div>
                <div class="stat-label">Attendance %</div>
              </div>
            </div>
          </div>
          
          <div class="section">
            <div class="section-title">Academic Performance</div>
            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-value">${r.academicPerformance.overallPercentage}%</div>
                <div class="stat-label">Overall Percentage</div>
              </div>
              <div class="stat-card">
                <div class="stat-value">${r.academicPerformance.overallGrade}</div>
                <div class="stat-label">Overall Grade</div>
              </div>
            </div>
            
            <table>
              <thead>
                <tr>
                  <th>Subject</th>
                  <th>Average</th>
                  <th>Percentage</th>
                  <th>Grade</th>
                </tr>
              </thead>
              <tbody>
                ${r.academicPerformance.subjects.map(ue=>`
                  <tr>
                    <td>${ue.subjectName}</td>
                    <td>${ue.averageObtained.toFixed(2)} / ${ue.averageTotal.toFixed(2)}</td>
                    <td>${ue.percentage.toFixed(2)}%</td>
                    <td>${ue.grade}</td>
                  </tr>
                `).join("")}
              </tbody>
            </table>
          </div>
          
          <div class="section">
            <div class="section-title">Teacher Comments</div>
            <p>${g||"No comments provided"}</p>
          </div>
          
          <div class="section">
            <div class="section-title">Behavioral Assessment</div>
            <p>${j||"No assessment provided"}</p>
          </div>
        </body>
      </html>
    `;ee.document.write(se),ee.document.close(),setTimeout(()=>{ee.print(),ee.close()},500)},O=()=>{if(!r){alert("Please generate a report first");return}try{const ee=new ua;ee.setFontSize(20),ee.text("Student Progress Report",105,20,null,null,"center"),ee.setFontSize(12),ee.text(`Student: ${r.studentName}`,20,35),ee.text(`Class: ${r.class} - ${r.section}`,20,45),ee.text(`Period: ${r.period.startDate} to ${r.period.endDate}`,20,55),ee.text(`Generated on: ${r.generatedDate}`,20,65),ee.setFontSize(16),ee.text("Attendance Summary",20,80),ee.setFontSize(12),ee.text(`Total Days: ${r.attendance.totalDays}`,20,90),ee.text(`Present: ${r.attendance.present}`,20,100),ee.text(`Absent: ${r.attendance.absent}`,20,110),ee.text(`Late: ${r.attendance.late}`,20,120),ee.text(`Leave: ${r.attendance.leave}`,20,130),ee.text(`Attendance %: ${r.attendance.percentage}%`,20,140),ee.setFontSize(16),ee.text("Academic Performance",20,150),ee.setFontSize(12),ee.text(`Overall Percentage: ${r.academicPerformance.overallPercentage}%`,20,160),ee.text(`Overall Grade: ${r.academicPerformance.overallGrade}`,20,170),r.academicPerformance.subjects.length>0&&ee.autoTable({startY:180,head:[["Subject","Average","Percentage","Grade"]],body:r.academicPerformance.subjects.map(J=>[J.subjectName,`${J.averageObtained.toFixed(2)} / ${J.averageTotal.toFixed(2)}`,`${J.percentage.toFixed(2)}%`,J.grade]),theme:"grid"});const se=ee.lastAutoTable?ee.lastAutoTable.finalY:200;ee.setFontSize(16),ee.text("Teacher Comments",20,se+20),ee.setFontSize(12);const ue=g||"No comments provided";ee.text(ue,20,se+30,{maxWidth:170});const ae=ue?ee.getTextDimensions(ue,{maxWidth:170}).h:10;ee.setFontSize(16),ee.text("Behavioral Assessment",20,se+40+ae),ee.setFontSize(12);const pe=j||"No assessment provided";ee.text(pe,20,se+50+ae,{maxWidth:170});const z=`student_report_${r.studentName.replace(/\s+/g,"_")}_${r.generatedDate}.pdf`;ee.save(z),alert("PDF downloaded successfully!")}catch(ee){console.error("Error generating PDF:",ee),alert("Failed to generate PDF. Please try again.")}},Q=async()=>{if(!r){alert("Please generate a report first");return}try{await n(Lc())}catch{console.log("Could not refresh student data, using cached data")}const ee=a.find(de=>de.id===r.studentId);if(!ee||!ee.parentContact){alert("Parent contact number not found for this student");return}let se=ee.parentContact.replace(/\D/g,"");se.startsWith("0")&&se.length===11&&(se="92"+se.substring(1));const ue=r.studentName||"Unknown Student",ae=r.class||"Unknown Class",pe=r.section||"Unknown Section",z=r.period?.startDate||"Unknown Date",J=r.period?.endDate||"Unknown Date",ge=r.generatedDate||new Date().toLocaleDateString(),fe=r.attendance||{},ke=fe.percentage!==void 0?fe.percentage:"N/A",he=fe.present!==void 0?fe.present:"N/A",Ne=fe.total!==void 0?fe.total:fe.totalDays!==void 0?fe.totalDays:"N/A",xe=r.academicPerformance||{},we=xe.overallPercentage!==void 0?xe.overallPercentage:"N/A",ye=xe.overallGrade||"N/A",te=`Student Progress Report for ${ue}

Class: ${ae} - ${pe}
Period: ${z} to ${J}
Attendance: ${ke}% (${he}/${Ne} days present)
Academic Performance: ${we}% (${ye})

Please find the detailed report attached.
Generated on: ${ge}`,V=encodeURIComponent(te),le=`https://api.whatsapp.com/send?phone=${se}&text=${V}`;window.open(le,"_blank")},Z=()=>{if(!r||!r.attendanceDetails)return[];const ee={};return r.attendanceDetails.forEach(se=>{const ue=new Date(se.date);if(ue.getDay()===0)return;const ae=new Date(ue);ae.setDate(ue.getDate()-ue.getDay());const pe=ae.toISOString().split("T")[0];switch(ee[pe]||(ee[pe]={weekStart:pe,present:0,absent:0,late:0,leave:0,total:0}),se.status){case"present":ee[pe].present++;break;case"absent":ee[pe].absent++;break;case"late":ee[pe].late++;break;case"leave":ee[pe].leave++;break}ee[pe].total++}),Object.values(ee)};return i.jsxs("div",{className:"mx-auto",children:[i.jsx(jd,{title:"Student Report Generator",subtitle:"Generate comprehensive reports for students and parents with weekly, monthly, and yearly tracking"}),e&&i.jsx("div",{className:"mb-6 bg-red-50 border-l-4 border-red-500 p-4 rounded",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),i.jsx("div",{className:"ml-3",children:i.jsx("p",{className:"text-sm text-red-700",children:e})})]})}),i.jsx("div",{className:"mb-6 bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[i.jsx(nc,{className:"inline mr-1"}),"Report Type"]}),i.jsxs("select",{value:f.reportType,onChange:ee=>C("reportType",ee.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"weekly",children:"Weekly"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"quarterly",children:"Quarterly"}),i.jsx("option",{value:"yearly",children:"Yearly"})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[i.jsx(Rl,{className:"inline mr-1"}),"Start Date"]}),i.jsx("input",{type:"date",value:f.startDate,onChange:ee=>C("startDate",ee.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[i.jsx(Rl,{className:"inline mr-1"}),"End Date"]}),i.jsx("input",{type:"date",value:f.endDate,onChange:ee=>C("endDate",ee.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[i.jsx(Pi,{className:"inline mr-1"}),"Class"]}),i.jsxs("select",{value:f.class,onChange:ee=>C("class",ee.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"All Classes"}),t.map(ee=>i.jsx("option",{value:ee.name,children:ee.name},ee.id))]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[i.jsx(Pi,{className:"inline mr-1"}),"Student"]}),i.jsx(cj,{students:T,value:f.studentId,onChange:ee=>C("studentId",ee),placeholder:"Select Student",disabled:!f.class})]}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{onClick:M,disabled:s,className:"w-full inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:s?i.jsxs(i.Fragment,{children:[i.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating..."]}):i.jsxs(i.Fragment,{children:[i.jsx(io,{className:"mr-2"}),"Generate Report"]})})})]})}),r&&i.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[i.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex flex-col md:flex-row md:justify-between md:items-center",children:[i.jsxs("div",{className:"mb-4 md:mb-0",children:[i.jsxs("h2",{className:"text-lg font-medium text-gray-900",children:["Report for ",r.studentName," (",r.class," - ",r.section,")"]}),i.jsxs("p",{className:"text-gray-600",children:["Period: ",r.period.startDate," to ",r.period.endDate,"(",f.reportType.charAt(0).toUpperCase()+f.reportType.slice(1)," Report)"]})]}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsxs("button",{onClick:H,className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(mi,{className:"mr-2"}),"Print"]}),i.jsxs("button",{onClick:O,className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(lu,{className:"mr-2"}),"Download PDF"]}),i.jsxs("button",{onClick:Q,className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[i.jsx("svg",{className:"mr-2 h-4 w-4 text-green-500",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})}),"Share via WhatsApp"]})]})]}),i.jsxs("div",{className:"p-6",children:[i.jsx("div",{className:"mb-6",children:i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Student Progress Report"}),i.jsxs("p",{className:"text-gray-600",children:["Period: ",r.period.startDate," to ",r.period.endDate]}),i.jsxs("p",{className:"text-gray-600",children:["Generated on: ",r.generatedDate]})]}),i.jsx("div",{className:"text-right",children:i.jsxs("p",{className:"text-gray-600",children:["GR No: ",r.grNo]})})]})}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Attendance Summary"}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:[i.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[i.jsx("div",{className:"text-sm font-medium text-blue-800",children:"Total Days"}),i.jsx("div",{className:"text-2xl font-semibold text-blue-900",children:r.attendance.totalDays})]}),i.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[i.jsx("div",{className:"text-sm font-medium text-green-800",children:"Present"}),i.jsx("div",{className:"text-2xl font-semibold text-green-900",children:r.attendance.present})]}),i.jsxs("div",{className:"bg-red-50 rounded-lg p-4",children:[i.jsx("div",{className:"text-sm font-medium text-red-800",children:"Absent"}),i.jsx("div",{className:"text-2xl font-semibold text-red-900",children:r.attendance.absent})]}),i.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4",children:[i.jsx("div",{className:"text-sm font-medium text-yellow-800",children:"Late"}),i.jsx("div",{className:"text-2xl font-semibold text-yellow-900",children:r.attendance.late})]}),i.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[i.jsx("div",{className:"text-sm font-medium text-blue-800",children:"Leave"}),i.jsx("div",{className:"text-2xl font-semibold text-blue-900",children:r.attendance.leave})]}),i.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[i.jsx("div",{className:"text-sm font-medium text-purple-800",children:"Attendance %"}),i.jsxs("div",{className:"text-2xl font-semibold text-purple-900",children:[r.attendance.percentage,"%"]})]})]})]}),f.reportType==="weekly"&&i.jsxs("div",{className:"mb-6",children:[i.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Weekly Attendance Tracking"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Week Starting"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Present"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Absent"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Late"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Leave"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Attendance %"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Z().map((ee,se)=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:new Date(ee.weekStart).toLocaleDateString()}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:ee.present}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:ee.absent}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:ee.late}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:ee.leave}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[ee.total>0?Math.round(ee.present/ee.total*100):0,"%"]})]},se))})]})})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Academic Performance"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"This section shows the student's academic performance across different subjects. The overall performance percentage is calculated based on the average of all subject scores, and the grade is determined according to the school's grading system."}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsx("span",{className:"text-gray-700 font-medium",children:"Overall Performance"}),i.jsxs("span",{className:"text-lg font-bold text-gray-900",children:[r.academicPerformance.overallPercentage,"% (",r.academicPerformance.overallGrade,")"]})]}),i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4",children:i.jsx("div",{className:"bg-blue-600 h-4 rounded-full",style:{width:`${r.academicPerformance.overallPercentage}%`}})})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Average"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Percentage"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Grade"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.academicPerformance.subjects.map((ee,se)=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:ee.subjectName}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[ee.averageObtained.toFixed(2)," / ",ee.averageTotal.toFixed(2)]}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[ee.percentage.toFixed(2),"%"]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:ee.grade})})]},se))})]})})]}),f.reportType!=="monthly"&&i.jsxs("div",{className:"mb-6",children:[i.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Academic History"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"This section shows the student's academic performance history across previous years and classes. It includes overall grades, subject-wise performance, and any remarks from teachers for each academic period."}),i.jsx(FK,{academicHistory:r.academicHistory})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Teacher Comments"}),i.jsx("textarea",{value:g,onChange:ee=>b(ee.target.value),rows:4,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your comments about the student's performance..."})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Behavioral Assessment"}),i.jsx("textarea",{value:j,onChange:ee=>F(ee.target.value),rows:4,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your assessment of the student's behavior..."})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{onClick:_,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Save Comments & Assessment"})})]})]})]})},Qv=Ss("income/fetchIncome",async()=>{const n=await fetch(`${dr}/income`);if(!n.ok)throw new Error("Failed to fetch income data");return await n.json()}),rS=Ss("income/addCanteenIncome",async n=>{const t=new Date(n.date||new Date).getFullYear(),r=t+1,s=`${t}-${r}`,e={...n,id:`c${Date.now()}`,academicYear:s},u=await fetch(`${dr}/income`);if(!u.ok)throw new Error("Failed to fetch income data");const f=await u.json(),m=[...f.canteenIncome||[],e];if(!(await fetch(`${dr}/income`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...f,canteenIncome:m})})).ok)throw new Error("Failed to add canteen income");return e}),aS=Ss("income/addSponsorshipIncome",async n=>{const t=new Date(n.date||new Date).getFullYear(),r=t+1,s=`${t}-${r}`,e={...n,id:`s${Date.now()}`,academicYear:s},u=await fetch(`${dr}/income`);if(!u.ok)throw new Error("Failed to fetch income data");const f=await u.json(),m=[...f.sponsorshipIncome||[],e];if(!(await fetch(`${dr}/income`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...f,sponsorshipIncome:m})})).ok)throw new Error("Failed to add sponsorship income");return e}),pG=Ss("income/updateCanteenIncome",async n=>{const a=await fetch(`${dr}/income`);if(!a.ok)throw new Error("Failed to fetch income data");const t=await a.json(),r=(t.canteenIncome||[]).map(e=>e.id===n.id?n:e);if(!(await fetch(`${dr}/income`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,canteenIncome:r})})).ok)throw new Error("Failed to update canteen income");return n}),gG=Ss("income/updateSponsorshipIncome",async n=>{const a=await fetch(`${dr}/income`);if(!a.ok)throw new Error("Failed to fetch income data");const t=await a.json(),r=(t.sponsorshipIncome||[]).map(e=>e.id===n.id?n:e);if(!(await fetch(`${dr}/income`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,sponsorshipIncome:r})})).ok)throw new Error("Failed to update sponsorship income");return n}),xG=Ss("income/deleteCanteenIncome",async n=>{const a=await fetch(`${dr}/income`);if(!a.ok)throw new Error("Failed to fetch income data");const t=await a.json(),r=(t.canteenIncome||[]).filter(e=>e.id!==n);if(!(await fetch(`${dr}/income`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,canteenIncome:r})})).ok)throw new Error("Failed to delete canteen income");return n}),bG=Ss("income/deleteSponsorshipIncome",async n=>{const a=await fetch(`${dr}/income`);if(!a.ok)throw new Error("Failed to fetch income data");const t=await a.json(),r=(t.sponsorshipIncome||[]).filter(e=>e.id!==n);if(!(await fetch(`${dr}/income`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,sponsorshipIncome:r})})).ok)throw new Error("Failed to delete sponsorship income");return n}),yG={canteenIncome:[],sponsorshipIncome:[],loading:!1,error:null};Pl({name:"income",initialState:yG,reducers:{},extraReducers:n=>{n.addCase(Qv.pending,a=>{a.loading=!0,a.error=null}).addCase(Qv.fulfilled,(a,t)=>{a.loading=!1,a.canteenIncome=t.payload.canteenIncome||[],a.sponsorshipIncome=t.payload.sponsorshipIncome||[]}).addCase(Qv.rejected,(a,t)=>{a.loading=!1,a.error=t.error.message}).addCase(rS.fulfilled,(a,t)=>{a.canteenIncome.push(t.payload)}).addCase(aS.fulfilled,(a,t)=>{a.sponsorshipIncome.push(t.payload)}).addCase(pG.fulfilled,(a,t)=>{const r=a.canteenIncome.findIndex(s=>s.id===t.payload.id);r!==-1&&(a.canteenIncome[r]=t.payload)}).addCase(gG.fulfilled,(a,t)=>{const r=a.sponsorshipIncome.findIndex(s=>s.id===t.payload.id);r!==-1&&(a.sponsorshipIncome[r]=t.payload)}).addCase(xG.fulfilled,(a,t)=>{a.canteenIncome=a.canteenIncome.filter(r=>r.id!==t.payload)}).addCase(bG.fulfilled,(a,t)=>{a.sponsorshipIncome=a.sponsorshipIncome.filter(r=>r.id!==t.payload)})}});const vG=({financialSummary:n,getPeriodDescription:a,dateRange:t,formatCurrency:r})=>{const{students:s}=rr(m=>m.students),{subsidies:e}=rr(m=>m.subsidies),{expenses:u}=rr(m=>m.expenses),{staff:f}=rr(m=>m.staff);return Eh(),i.jsxs("div",{className:"max-w-4xl mx-auto p-8",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Financial Report"}),i.jsx("p",{className:"text-lg text-gray-600",children:a()}),i.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Generated on ",new Date().toLocaleDateString()]})]}),i.jsxs("div",{className:"mb-8",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4 border-b border-gray-300 pb-2",children:"Income Summary"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs(md,{showFor:"traditional",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"font-medium",children:"Tuition Fees"}),i.jsx("span",{children:r(n.tuitionFees)})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"font-medium",children:"Admission Fees"}),i.jsx("span",{children:r(n.admissionFees)})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"font-medium",children:"Other Fees"}),i.jsx("span",{children:r(n.otherFees)})]})]}),i.jsx(md,{showFor:"ngo",children:i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"font-medium",children:"Subsidies Received"}),i.jsx("span",{children:r(n.totalSubsidiesReceived)})]})}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"font-medium",children:"Canteen Income"}),i.jsx("span",{children:r(n.totalCanteenIncome)})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"font-medium",children:"Sponsorship Income"}),i.jsx("span",{children:r(n.totalSponsorshipIncome)})]}),i.jsxs("div",{className:"flex justify-between pt-3 border-t border-gray-300 font-bold",children:[i.jsx("span",{children:"Total Income"}),i.jsx("span",{children:r(n.totalIncome)})]})]})]}),i.jsxs("div",{className:"mb-8",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4 border-b border-gray-300 pb-2",children:"Expense Summary"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"font-medium",children:"Staff Salaries"}),i.jsx("span",{children:r(n.totalStaffSalaries)})]}),Array.from(u.reduce((m,g)=>{m[g.category]||(m[g.category]=0);const b=g.date?new Date(g.date):null;return(!t.start||!b||b>=new Date(t.start))&&(!t.end||!b||b<=new Date(t.end))&&(m[g.category]+=typeof g.amount=="string"?parseFloat(g.amount):g.amount||0),m},{})).map(([m,g])=>i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"font-medium",children:m}),i.jsx("span",{children:r(g)})]},m)),i.jsxs("div",{className:"flex justify-between pt-3 border-t border-gray-300 font-bold",children:[i.jsx("span",{children:"Other Expenses Total"}),i.jsx("span",{children:r(n.otherExpenses)})]}),i.jsxs("div",{className:"flex justify-between pt-3 border-t border-gray-300 font-bold",children:[i.jsx("span",{children:"Total Expenses"}),i.jsx("span",{children:r(n.totalExpenses)})]})]})]}),i.jsxs("div",{className:"mb-8",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4 border-b border-gray-300 pb-2",children:"Net Financial Position"}),i.jsxs("div",{className:`p-4 rounded ${n.netBalance>=0?"bg-green-50":"bg-red-50"}`,children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-lg font-bold",children:"Net Balance"}),i.jsx("span",{className:`text-lg font-bold ${n.netBalance>=0?"text-green-600":"text-red-600"}`,children:r(n.netBalance)})]}),i.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[n.netBalance>=0?"Profit":"Loss"," for the selected period"]})]})]}),i.jsxs("div",{className:"text-center text-sm text-gray-500 mt-12 pt-4 border-t border-gray-300",children:[i.jsxs("p",{children:["Financial Report - ",new Date().toLocaleDateString()]}),i.jsx("p",{className:"mt-1",children:"Page 1 of 1"})]})]})},wG=()=>{const n=Pn(),{students:a}=rr(X=>X.students),{subsidies:t}=rr(X=>X.subsidies),{expenses:r}=rr(X=>X.expenses),{staff:s}=rr(X=>X.staff),{batches:e}=rr(X=>X.alumni),u=rr(X=>X.income)||{},f=u.canteenIncome||[],m=u.sponsorshipIncome||[],{isNGOSchool:g}=Eh(),[b,j]=ne.useState("overall"),[F,C]=ne.useState({start:"",end:""}),[M,_]=ne.useState(new Date().toISOString().slice(0,7)),[L,T]=ne.useState(new Date().getFullYear()),[H,O]=ne.useState(""),[Q,Z]=ne.useState(""),[ee,se]=ne.useState(""),[ue,ae]=ne.useState(!1),[pe,z]=ne.useState(""),[J,ge]=ne.useState(""),[fe,ke]=ne.useState("");ne.useEffect(()=>{n(Km())},[n]),ne.useEffect(()=>{const X=[...new Set(t.map(G=>G.quarter).filter(Boolean))].sort(),ie=[...new Set(t.map(G=>G.year).filter(Boolean))].sort().reverse();X.length>0&&!pe&&z(X[0]),ie.length>0&&!J&&ge(ie[0])},[t]),ne.useEffect(()=>{if(e.length>0&&!fe){const X=e.find(ie=>ie.status==="active");X&&ke(X.name)}},[e,fe]),ne.useEffect(()=>{const X=new Date,ie=new Date(X.getFullYear(),X.getMonth(),1),G=new Date(X.getFullYear(),X.getMonth()+1,0);switch(b){case"daily":const q=X.toISOString().split("T")[0];C({start:q,end:q});break;case"monthly":C({start:ie.toISOString().split("T")[0],end:G.toISOString().split("T")[0]});break;case"yearly":C({start:`${L}-01-01`,end:`${L}-12-31`});break;case"overall":C({start:"",end:""});break;case"custom":break;default:C({start:ie.toISOString().split("T")[0],end:G.toISOString().split("T")[0]})}},[b,M,L]);const he=()=>{j("monthly"),_(new Date().toISOString().slice(0,7)),T(new Date().getFullYear()),O(""),Z(""),se(""),ae(!1);const X=new Date,ie=new Date(X.getFullYear(),X.getMonth(),1),G=new Date(X.getFullYear(),X.getMonth()+1,0);C({start:ie.toISOString().split("T")[0],end:G.toISOString().split("T")[0]})},Ne=(X,ie=!1)=>{let G=X;if(ie&&fe&&(G=X.filter(Fe=>Fe.academicYear===fe)),g&&(pe||J))return G.filter(Fe=>{if(!pe&&!J)return!0;if(Fe.quarter!==void 0&&Fe.year!==void 0)return!(pe&&Fe.quarter!==pe||J&&Fe.year!==parseInt(J));if(Fe.date){const Qe=new Date(Fe.date);if(isNaN(Qe.getTime())||J&&Qe.getFullYear()!==parseInt(J))return!1;if(pe){const Ge=Qe.getMonth()+1;if(!{Q1:[1,2,3],Q2:[4,5,6],Q3:[7,8,9],Q4:[10,11,12]}[pe].includes(Ge))return!1}return!0}else if(Fe.salaryHistory){let Qe=!1;return J||pe?Qe=Fe.salaryHistory.some(Ge=>{if(Ge.status==="paid"&&Ge.paymentDate){const je=new Date(Ge.paymentDate);if(isNaN(je.getTime())||J&&je.getFullYear()!==parseInt(J))return!1;if(pe){const Me=je.getMonth()+1;if(!{Q1:[1,2,3],Q2:[4,5,6],Q3:[7,8,9],Q4:[10,11,12]}[pe].includes(Me))return!1}return!0}return!1}):Qe=!0,Qe}return!0});if(!F.start&&!F.end)return G;const q=F.start?new Date(F.start):null,ve=F.end?new Date(F.end):null;return G.filter(Fe=>{if(!Fe.date)return!0;const Qe=new Date(Fe.date);return(!q||Qe>=q)&&(!ve||Qe<=ve)})},xe=()=>{if(g&&(pe||J))return pe&&J?`${pe} ${J}`:pe?`${pe}`:J?`Year ${J}`:"";switch(b){case"daily":return F.start?`${new Date(F.start).toLocaleDateString()}`:"";case"monthly":return`${new Date(M+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"})}`;case"yearly":return`${L}`;case"overall":return"";case"custom":return F.start&&F.end?`${new Date(F.start).toLocaleDateString()} to ${new Date(F.end).toLocaleDateString()}`:"";default:return`${new Date(M+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"})}`}},ye=(()=>{const X=Ne(a,!0),ie=Ne(t),G=Ne(r),q=Ne(f),ve=Ne(m),Fe=Ne(s);let Qe=0,Ge=0,je=0,Me=0,Se=0;g||X.forEach(ar=>{(ar.feesHistory||[]).forEach(bt=>{if(bt.status==="paid"&&bt.amount){let Yt=!1;if(b==="overall")Yt=!0;else{const vr=bt.date?new Date(bt.date):null;Yt=(!F.start||!vr||vr>=new Date(F.start))&&(!F.end||!vr||vr<=new Date(F.end))}Yt&&(bt.type==="admission"?Ge+=bt.amount:bt.type==="monthly"?Qe+=bt.amount:(bt.type==="fine"&&(Me+=bt.amount),je+=bt.amount))}})}),g&&(Se=ie.filter(ar=>ar.status==="received").reduce((ar,bt)=>ar+(bt.amount||0),0));const ft=q.reduce((ar,bt)=>ar+(bt.amount||0),0),jt=ve.reduce((ar,bt)=>ar+(bt.amount||0),0),It=Q!==""?parseFloat(Q):ft,ut=ee!==""?parseFloat(ee):jt;let Rt=0;Fe.forEach(ar=>{(ar.salaryHistory||[]).forEach(bt=>{if(bt.status==="paid")if(g&&(pe||J)){if(bt.paymentDate){const Yt=new Date(bt.paymentDate);if(!isNaN(Yt.getTime())){let vr=!0;J&&(vr=Yt.getFullYear()===parseInt(J));let gr=!0;if(pe){const Mr=Yt.getMonth()+1;gr={Q1:[1,2,3],Q2:[4,5,6],Q3:[7,8,9],Q4:[10,11,12]}[pe].includes(Mr)}vr&&gr&&(Rt+=bt.netSalary||0)}}}else{const Yt=bt.paymentDate?new Date(bt.paymentDate):null;(!F.start||!Yt||Yt>=new Date(F.start))&&(!F.end||!Yt||Yt<=new Date(F.end))&&(Rt+=bt.netSalary||0)}})});let Ye=0;g&&(pe||J)?G.forEach(ar=>{if(ar.date){const bt=new Date(ar.date);if(!isNaN(bt.getTime())){let Yt=!0;J&&(Yt=bt.getFullYear()===parseInt(J));let vr=!0;if(pe){const gr=bt.getMonth()+1;vr={Q1:[1,2,3],Q2:[4,5,6],Q3:[7,8,9],Q4:[10,11,12]}[pe].includes(gr)}Yt&&vr&&(Ye+=typeof ar.amount=="string"?parseFloat(ar.amount):ar.amount||0)}}}):Ye=G.reduce((ar,bt)=>ar+(typeof bt.amount=="string"?parseFloat(bt.amount):bt.amount||0),0);const St=Rt+Ye,Jt=Qe+Ge+je+ut+It+Se,mr=Jt-St;return{tuitionFees:Qe,admissionFees:Ge,otherFees:je,fineAmount:Me,totalSponsorshipIncome:ut,totalCanteenIncome:It,totalSubsidiesReceived:Se,totalStaffSalaries:Rt,otherExpenses:Ye,totalIncome:Jt,totalExpenses:St,netBalance:mr}})(),te=()=>{const X=xe();Q!==""&&n(rS({date:F.start||new Date().toISOString().split("T")[0],amount:parseFloat(Q),description:`Canteen income for ${X}`})),ee!==""&&n(aS({date:F.start||new Date().toISOString().split("T")[0],amount:parseFloat(ee),description:`Sponsorship income for ${X}`,sponsor:"General Sponsor"})),ae(!0)},V=()=>{try{const X=Ne(a,!0),ie=Ne(t),G=Ne(r),q=Ne(f),ve=Ne(m),Fe=Ne(s),Qe=Da.utils.book_new();Qe.Props={Title:"Financial Report",Subject:"Financial Data Export",Author:"School Management System",CreatedDate:new Date,Description:`Financial report for ${xe()}`};const Ge=[["Financial Report",xe()],[],["Generated on",new Date().toLocaleString()],[],["INCOME SUMMARY"],["Category","Amount (PKR)"],["Tuition Fees",ye.tuitionFees],["Admission Fees",ye.admissionFees],["Fine Amount",ye.fineAmount],["Other Fees",ye.otherFees-ye.fineAmount],["Canteen Income",ye.totalCanteenIncome],["Sponsorship Income",ye.totalSponsorshipIncome],...g?[["Subsidies Received",ye.totalSubsidiesReceived]]:[],["",""],["Total Income",ye.totalIncome],[],["EXPENSE SUMMARY"],["Category","Amount (PKR)"],["Staff Salaries",ye.totalStaffSalaries],["Other Expenses",ye.otherExpenses],["",""],["Total Expenses",ye.totalExpenses],[],["NET BALANCE"],["Amount (PKR)",ye.netBalance],["Status",ye.netBalance>=0?"Profit":"Loss"]],je=Da.utils.aoa_to_sheet(Ge);je["!merges"]=[{s:{r:0,c:0},e:{r:0,c:1}}],je["!cols"]=[{wch:25},{wch:15}];const Me=Da.utils.decode_range(je["!ref"]),Se=Da.utils.encode_cell({r:0,c:0});je[Se]&&(je[Se].s={font:{bold:!0,sz:16,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"3b82f6"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}});const ft=Da.utils.encode_cell({r:4,c:0}),jt=Da.utils.encode_cell({r:15,c:0}),It=Da.utils.encode_cell({r:23,c:0});je[ft]&&(je[ft].s={font:{bold:!0,sz:12,color:{rgb:"000000"}},fill:{fgColor:{rgb:"dbeafe"}},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}}),je[jt]&&(je[jt].s={font:{bold:!0,sz:12,color:{rgb:"000000"}},fill:{fgColor:{rgb:"fee2e2"}},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}}),je[It]&&(je[It].s={font:{bold:!0,sz:12,color:{rgb:"000000"}},fill:{fgColor:{rgb:"ddd6fe"}},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}});const ut=Da.utils.encode_cell({r:13,c:1}),Rt=Da.utils.encode_cell({r:21,c:1}),Ye=Da.utils.encode_cell({r:25,c:1});je[ut]&&(je[ut].s={font:{bold:!0,sz:12,color:{rgb:"000000"}},fill:{fgColor:{rgb:"bbf7d0"}},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}}),je[Rt]&&(je[Rt].s={font:{bold:!0,sz:12,color:{rgb:"000000"}},fill:{fgColor:{rgb:"fecaca"}},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}}),je[Ye]&&(je[Ye].s={font:{bold:!0,sz:12,color:{rgb:"000000"}},fill:{fgColor:{rgb:ye.netBalance>=0?"bbf7d0":"fecaca"}},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}}),Da.utils.book_append_sheet(Qe,je,"Summary");const St=[["Financial Report - Expenses"],[xe()],[],["Date","Description","Category","Amount (PKR)"]];G.forEach(or=>{St.push([or.date?new Date(or.date).toLocaleDateString():"",or.description||"",or.category||"",typeof or.amount=="string"?parseFloat(or.amount):or.amount||0])});const Jt=G.reduce((or,Nr)=>or+(typeof Nr.amount=="string"?parseFloat(Nr.amount):Nr.amount||0),0);St.push([]),St.push(["","","TOTAL",Jt]);const mr=Da.utils.aoa_to_sheet(St);mr["!cols"]=[{wch:15},{wch:30},{wch:20},{wch:15}];const ar=Da.utils.decode_range(mr["!ref"]);for(let or=ar.s.c;or<=ar.e.c;or++){const Nr=Da.utils.encode_cell({r:0,c:or}),$t=Da.utils.encode_cell({r:3,c:or});mr[Nr]&&(mr[Nr].s={font:{bold:!0,sz:14,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"3b82f6"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}}),mr[$t]&&(mr[$t].s={font:{bold:!0,sz:12,color:{rgb:"000000"}},fill:{fgColor:{rgb:"e5e7eb"}},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}})}const bt=Da.utils.encode_cell({r:St.length-1,c:3});mr[bt]&&(mr[bt].s={font:{bold:!0,sz:12,color:{rgb:"000000"}},fill:{fgColor:{rgb:"bbf7d0"}},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}}),Da.utils.book_append_sheet(Qe,mr,"Expenses");const Yt=[["Financial Report - Canteen Income"],[xe()],[],["Date","Description","Amount (PKR)"]];q.forEach(or=>Yt.push([or.date?new Date(or.date).toLocaleDateString():"",or.description||"",or.amount||0]));const vr=q.reduce((or,Nr)=>or+(Nr.amount||0),0);Yt.push([]),Yt.push(["","TOTAL",vr]);const gr=Da.utils.aoa_to_sheet(Yt);gr["!cols"]=[{wch:15},{wch:35},{wch:15}];const Mr=Da.utils.decode_range(gr["!ref"]);for(let or=Mr.s.c;or<=Mr.e.c;or++){const Nr=Da.utils.encode_cell({r:0,c:or}),$t=Da.utils.encode_cell({r:3,c:or});gr[Nr]&&(gr[Nr].s={font:{bold:!0,sz:14,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"3b82f6"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}}),gr[$t]&&(gr[$t].s={font:{bold:!0,sz:12,color:{rgb:"000000"}},fill:{fgColor:{rgb:"e5e7eb"}},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}})}const Ot=Da.utils.encode_cell({r:Yt.length-1,c:2});gr[Ot]&&(gr[Ot].s={font:{bold:!0,sz:12,color:{rgb:"000000"}},fill:{fgColor:{rgb:"bbf7d0"}},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}}),Da.utils.book_append_sheet(Qe,gr,"Canteen Income");const ja=[["Financial Report - Sponsorship Income"],[xe()],[],["Date","Description","Sponsor","Amount (PKR)"]];ve.forEach(or=>ja.push([or.date?new Date(or.date).toLocaleDateString():"",or.description||"",or.sponsor||"",or.amount||0]));const oa=ve.reduce((or,Nr)=>or+(Nr.amount||0),0);ja.push([]),ja.push(["","","TOTAL",oa]);const hr=Da.utils.aoa_to_sheet(ja);hr["!cols"]=[{wch:15},{wch:30},{wch:25},{wch:15}];const pr=Da.utils.decode_range(hr["!ref"]);for(let or=pr.s.c;or<=pr.e.c;or++){const Nr=Da.utils.encode_cell({r:0,c:or}),$t=Da.utils.encode_cell({r:3,c:or});hr[Nr]&&(hr[Nr].s={font:{bold:!0,sz:14,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"3b82f6"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}}),hr[$t]&&(hr[$t].s={font:{bold:!0,sz:12,color:{rgb:"000000"}},fill:{fgColor:{rgb:"e5e7eb"}},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}})}const Gr=Da.utils.encode_cell({r:ja.length-1,c:3});hr[Gr]&&(hr[Gr].s={font:{bold:!0,sz:12,color:{rgb:"000000"}},fill:{fgColor:{rgb:"bbf7d0"}},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}}),Da.utils.book_append_sheet(Qe,hr,"Sponsorship Income");const Pr=[["Financial Report - Staff Salaries"],[xe()],[],["Staff Name","Position","Net Salary (PKR)"]];Fe.forEach(or=>{(or.salaryHistory||[]).forEach(Nr=>{Nr.status==="paid"&&Pr.push([`${or.firstName} ${or.lastName}`,or.position||"",Nr.netSalary||0])})});const wa=Pr.slice(4).reduce((or,Nr)=>or+(Nr[2]||0),0);Pr.push([]),Pr.push(["","TOTAL",wa]);const jr=Da.utils.aoa_to_sheet(Pr);jr["!cols"]=[{wch:25},{wch:20},{wch:15}];const Ms=Da.utils.decode_range(jr["!ref"]);for(let or=Ms.s.c;or<=Ms.e.c;or++){const Nr=Da.utils.encode_cell({r:0,c:or}),$t=Da.utils.encode_cell({r:3,c:or});jr[Nr]&&(jr[Nr].s={font:{bold:!0,sz:14,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"3b82f6"}},alignment:{horizontal:"center",vertical:"center"},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}}),jr[$t]&&(jr[$t].s={font:{bold:!0,sz:12,color:{rgb:"000000"}},fill:{fgColor:{rgb:"e5e7eb"}},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}})}const Rs=Da.utils.encode_cell({r:Pr.length-1,c:2});jr[Rs]&&(jr[Rs].s={font:{bold:!0,sz:12,color:{rgb:"000000"}},fill:{fgColor:{rgb:"bbf7d0"}},border:{top:{style:"thin",color:{rgb:"000000"}},bottom:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}}}),Da.utils.book_append_sheet(Qe,jr,"Staff Salaries"),Da.writeFile(Qe,`financial_report_${new Date().toISOString().slice(0,10)}.xlsx`)}catch(X){console.error("Error exporting to XLSX:",X),alert("Error exporting to Excel. Please try again.")}},le=()=>{window.print()},de=X=>new Intl.NumberFormat("en-PK",{style:"currency",currency:"PKR",minimumFractionDigits:0,maximumFractionDigits:0}).format(X);return i.jsxs("div",{className:"p-0",children:[i.jsxs("div",{className:"print:hidden",children:[i.jsx("div",{className:"mb-4",children:i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Financial Report"}),i.jsx("p",{className:"text-sm text-gray-600",children:xe()})]}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("div",{className:"flex gap-2 group",children:i.jsxs("button",{onClick:V,className:"inline-flex items-center px-2 py-1.5 border border-gray-300 rounded text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[i.jsx(lu,{className:"mr-1",size:"12"}),"Export Excel"]})}),i.jsxs("button",{onClick:le,className:"inline-flex items-center px-2 py-1.5 border border-gray-300 rounded text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[i.jsx(mi,{className:"mr-1",size:"12"}),"Print"]})]})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4",children:[i.jsx("div",{className:"md:col-span-2 bg-white rounded shadow-sm",children:i.jsx("div",{className:"p-3",children:i.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Batch"}),i.jsxs("select",{className:"block w-full border border-gray-300 rounded text-sm p-1.5 focus:ring-blue-500 focus:border-blue-500",value:fe,onChange:X=>ke(X.target.value),children:[i.jsx("option",{value:"",children:"All Batches"}),e.map(X=>i.jsx("option",{value:X.name,children:X.name},X.id))]})]}),i.jsx(md,{showFor:"ngo",children:i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quarter"}),i.jsxs("select",{className:"block w-full border border-gray-300 rounded text-sm p-1.5 focus:ring-blue-500 focus:border-blue-500",value:pe,onChange:X=>z(X.target.value),children:[i.jsx("option",{value:"",children:"All Quarters"}),[...new Set(t.map(X=>X.quarter).filter(Boolean))].sort().map(X=>i.jsx("option",{value:X,children:X},X))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year"}),i.jsxs("select",{className:"block w-full border border-gray-300 rounded text-sm p-1.5 focus:ring-blue-500 focus:border-blue-500",value:J,onChange:X=>ge(X.target.value),children:[i.jsx("option",{value:"",children:"All Years"}),[...new Set(t.map(X=>X.year).filter(Boolean))].sort((X,ie)=>ie-X).map(X=>i.jsx("option",{value:X,children:X},X))]})]})]})}),i.jsxs(md,{showFor:"traditional",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Period"}),i.jsxs("select",{className:"block w-full border border-gray-300 rounded text-sm p-1.5 focus:ring-blue-500 focus:border-blue-500",value:b,onChange:X=>j(X.target.value),children:[i.jsx("option",{value:"daily",children:"Daily"}),i.jsx("option",{value:"monthly",children:"Monthly"}),i.jsx("option",{value:"yearly",children:"Yearly"}),i.jsx("option",{value:"overall",children:"Overall"}),i.jsx("option",{value:"custom",children:"Custom"})]})]}),b==="monthly"&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Month"}),i.jsx("input",{type:"month",className:"block w-full border border-gray-300 rounded text-sm p-1.5 focus:ring-blue-500 focus:border-blue-500",value:M,onChange:X=>_(X.target.value)})]}),b==="yearly"&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year"}),i.jsx("input",{type:"number",className:"block w-full border border-gray-300 rounded text-sm p-1.5 focus:ring-blue-500 focus:border-blue-500",value:L,onChange:X=>T(X.target.value),min:"2000",max:"2030"})]}),b==="custom"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start"}),i.jsx("input",{type:"date",className:"block w-full border border-gray-300 rounded text-sm p-1.5 focus:ring-blue-500 focus:border-blue-500",value:F.start,onChange:X=>C({...F,start:X.target.value})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End"}),i.jsx("input",{type:"date",className:"block w-full border border-gray-300 rounded text-sm p-1.5 focus:ring-blue-500 focus:border-blue-500",value:F.end,onChange:X=>C({...F,end:X.target.value})})]})]})]}),i.jsxs("div",{className:"flex items-end space-x-1",children:[i.jsxs("button",{onClick:te,className:"flex-1 inline-flex items-center justify-center px-2 py-1.5 border border-transparent rounded text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[i.jsx(i0,{className:"mr-1",size:"12"}),"Update"]}),i.jsxs("button",{onClick:he,className:"inline-flex items-center justify-center px-2 py-1.5 border border-gray-300 rounded text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[i.jsx(io,{className:"mr-1",size:"12"}),"Clear"]})]})]})})}),i.jsx("div",{className:"bg-white rounded shadow-sm",children:i.jsx("div",{className:"p-3",children:i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Canteen (PKR)"}),i.jsx("input",{type:"number",className:"block w-full border border-gray-300 rounded text-sm p-1.5 focus:ring-blue-500 focus:border-blue-500",value:Q,onChange:X=>Z(X.target.value),placeholder:"0"}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1 truncate",children:["Curr: ",de(ye.totalCanteenIncome)]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sponsorship (PKR)"}),i.jsx("input",{type:"number",className:"block w-full border border-gray-300 rounded text-sm p-1.5 focus:ring-blue-500 focus:border-blue-500",value:ee,onChange:X=>se(X.target.value),placeholder:"0"}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1 truncate",children:["Curr: ",de(ye.totalSponsorshipIncome)]})]})]})})})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 mb-4",children:[i.jsxs("div",{className:"bg-white rounded shadow-sm p-3 border-l-2 border-l-green-500",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Income"}),i.jsx("div",{className:"p-1 rounded-full bg-green-100",children:i.jsx(i0,{className:"text-green-600 text-sm"})})]}),i.jsx("p",{className:"text-xl font-bold text-green-600 mt-1",children:de(ye.totalIncome)}),i.jsxs("div",{className:"mt-2 space-y-1",children:[i.jsxs(md,{showFor:"traditional",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Tuition"}),i.jsx("span",{className:"font-medium",children:de(ye.tuitionFees+ye.admissionFees)})]}),i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Fines"}),i.jsx("span",{className:"font-medium",children:de(ye.fineAmount)})]}),i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Other Fees"}),i.jsx("span",{className:"font-medium",children:de(ye.otherFees-ye.fineAmount)})]})]}),i.jsx(md,{showFor:"ngo",children:i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Subsidies"}),i.jsx("span",{className:"font-medium",children:de(ye.totalSubsidiesReceived)})]})}),i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Other"}),i.jsx("span",{className:"font-medium",children:de(ye.totalCanteenIncome+ye.totalSponsorshipIncome+ye.otherFees)})]})]})]}),i.jsxs("div",{className:"bg-white rounded shadow-sm p-3 border-l-2 border-l-red-500",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Expenses"}),i.jsx("div",{className:"p-1 rounded-full bg-red-100",children:i.jsx(bd,{className:"text-red-600 text-sm"})})]}),i.jsx("p",{className:"text-xl font-bold text-red-600 mt-1",children:de(ye.totalExpenses)}),i.jsxs("div",{className:"mt-2 space-y-1",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Salaries"}),i.jsx("span",{className:"font-medium",children:de(ye.totalStaffSalaries)})]}),i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"text-gray-600",children:"Other"}),i.jsx("span",{className:"font-medium",children:de(ye.otherExpenses)})]})]})]}),i.jsxs("div",{className:`bg-white rounded shadow-sm p-3 border-l-2 ${ye.netBalance>=0?"border-l-green-500":"border-l-red-500"}`,children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Net"}),i.jsx("div",{className:`p-1 rounded-full ${ye.netBalance>=0?"bg-green-100":"bg-red-100"}`,children:i.jsx(i0,{className:`text-sm ${ye.netBalance>=0?"text-green-600":"text-red-600"}`})})]}),i.jsx("p",{className:`text-xl font-bold mt-1 ${ye.netBalance>=0?"text-green-600":"text-red-600"}`,children:de(ye.netBalance)}),i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:ye.netBalance>=0?"Profit":"Loss"})]})]}),i.jsx("div",{className:"bg-white rounded shadow-sm mb-4",children:i.jsxs("div",{className:"p-3",children:[i.jsx("h3",{className:"text-base font-medium text-gray-900 mb-2",children:"Financial Breakdown"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[i.jsxs("div",{className:"border border-gray-200 rounded p-2",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-1 pb-1 border-b border-gray-200",children:"Income"}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs(md,{showFor:"traditional",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Tuition"}),i.jsx("p",{className:"text-sm font-medium text-green-600",children:de(ye.tuitionFees)})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Admission"}),i.jsx("p",{className:"text-sm font-medium text-green-600",children:de(ye.admissionFees)})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Fines"}),i.jsx("p",{className:"text-sm font-medium text-green-600",children:de(ye.fineAmount)})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Other Fees"}),i.jsx("p",{className:"text-sm font-medium text-green-600",children:de(ye.otherFees-ye.fineAmount)})]})]}),i.jsx(md,{showFor:"ngo",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Subsidies"}),i.jsx("p",{className:"text-sm font-medium text-green-600",children:de(ye.totalSubsidiesReceived)})]})}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Canteen"}),i.jsx("p",{className:"text-sm font-medium text-green-600",children:de(ye.totalCanteenIncome)})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Sponsorship"}),i.jsx("p",{className:"text-sm font-medium text-green-600",children:de(ye.totalSponsorshipIncome)})]}),i.jsxs("div",{className:"flex justify-between items-center pt-1 border-t border-gray-200",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Total"}),i.jsx("p",{className:"text-sm font-bold text-green-600",children:de(ye.totalIncome)})]})]})]}),i.jsxs("div",{className:"border border-gray-200 rounded p-2",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-1 pb-1 border-b border-gray-200",children:"Expenses"}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Salaries"}),i.jsx("p",{className:"text-sm font-medium text-red-600",children:de(ye.totalStaffSalaries)})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Other"}),i.jsx("p",{className:"text-sm font-medium text-red-600",children:de(ye.otherExpenses)})]}),i.jsxs("div",{className:"flex justify-between items-center pt-1 border-t border-gray-200",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Total"}),i.jsx("p",{className:"text-sm font-bold text-red-600",children:de(ye.totalExpenses)})]})]})]})]})]})})]}),i.jsx("div",{className:"hidden print:block",children:i.jsx(vG,{financialSummary:ye,getPeriodDescription:xe,dateRange:F,formatCurrency:de})})]})},NG=`
  .react-datepicker__day--disabled {
    color: #cccccc !important;
    background-color: #f5f5f5 !important;
    cursor: not-allowed !important;
    text-decoration: line-through;
  }
  
  .react-datepicker__day--disabled:hover {
    background-color: #f5f5f5 !important;
    color: #cccccc !important;
  }
`,CG=()=>{const n=Pn(),{staff:a,attendanceRecords:t,loading:r,error:s}=rr(ie=>ie.staff),{schoolInfo:e}=rr(ie=>ie.settings),[u,f]=ne.useState(""),[m,g]=ne.useState(""),[b,j]=ne.useState(new Date().toISOString().split("T")[0]),[F,C]=ne.useState({}),[M,_]=ne.useState([]);[...new Set(a.map(ie=>ie.id))];const L=a.filter(ie=>{const G=`${ie.firstName} ${ie.lastName}`.toLowerCase().includes(u.toLowerCase())||ie.email.toLowerCase().includes(u.toLowerCase())||ie.department.toLowerCase().includes(u.toLowerCase()),q=!m||ie.department===m;return G&&q});ne.useEffect(()=>{n(jC(b))},[b,n]),ne.useEffect(()=>{n(s0())},[n]),ne.useEffect(()=>{const ie={};t&&t.length>0&&t.forEach(G=>{G.date===b&&(Array.isArray(G.records)?G.records:[]).forEach(ve=>{ie[ve.staffId]=ve.status})}),L.forEach(G=>{ie[G.id]||(ie[G.id]="present")}),C(ie)},[t,b,L.length]);const T=ne.useMemo(()=>{const ie=Object.values(F).filter(Fe=>Fe==="present").length,G=Object.values(F).filter(Fe=>Fe==="absent").length,q=Object.values(F).filter(Fe=>Fe==="late").length,ve=Object.values(F).filter(Fe=>Fe==="leave").length;return{presentCount:ie,absentCount:G,lateCount:q,leaveCount:ve}},[F]),H=(ie,G)=>{C({...F,[ie]:G})},O=ie=>{_(G=>G.includes(ie)?G.filter(q=>q!==ie):[...G,ie])},Q=()=>{M.length===L.length&&L.length>0?_([]):_(L.map(ie=>ie.id))},Z=()=>{_([])},ee=()=>{const ie={date:b,records:Object.entries(F).map(([G,q])=>({staffId:G,status:q}))};n(DC(ie)).then(()=>{alert(`Attendance records saved for ${Object.keys(F).length} staff members`)}).catch(G=>{alert(`Failed to save attendance: ${G.message||"Unknown error"}`)})},se=ie=>{if(M.length===0){alert("Please select at least one staff member");return}const G={...F};M.forEach(q=>{G[q]=ie}),C(G),_([])},ue=()=>{const ie={};L.forEach(G=>{ie[G.id]="present"}),C(ie)},ae=()=>{const ie={};L.forEach(G=>{ie[G.id]="absent"}),C(ie)},pe=()=>{const ie={};L.forEach(G=>{ie[G.id]="late"}),C(ie)},z=()=>{const ie={};L.forEach(G=>{ie[G.id]="leave"}),C(ie)},J=(ie,G)=>{if((F[ie]||"present")===G)switch(G){case"present":return"inline-flex items-center px-3 py-1 border border-green-300 bg-green-100 text-green-800 text-xs font-medium rounded-lg";case"absent":return"inline-flex items-center px-3 py-1 border border-red-300 bg-red-100 text-red-800 text-xs font-medium rounded-lg";case"late":return"inline-flex items-center px-3 py-1 border border-yellow-300 bg-yellow-100 text-yellow-800 text-xs font-medium rounded-lg";case"leave":return"inline-flex items-center px-3 py-1 border border-blue-300 bg-blue-100 text-blue-800 text-xs font-medium rounded-lg";default:return"inline-flex items-center px-3 py-1 border border-gray-300 text-gray-700 bg-white text-xs font-medium rounded-lg hover:bg-gray-50"}return"inline-flex items-center px-3 py-1 border border-gray-300 text-gray-700 bg-white text-xs font-medium rounded-lg hover:bg-gray-50"},[ge,fe]=ne.useState(1),[ke]=ne.useState(10),he=Math.ceil(L.length/ke),Ne=ge*ke,xe=Ne-ke,we=L.slice(xe,Ne);ne.useEffect(()=>{fe(1)},[L.length,m,u]);const ye=ie=>fe(ie),te=()=>fe(ie=>Math.min(ie+1,he)),V=()=>fe(ie=>Math.max(ie-1,1)),le=At.useMemo(()=>e&&e.holidays&&Array.isArray(e.holidays)&&e.holidays.length>0?e.holidays.map(ie=>typeof ie=="string"?ie:ie.date||"").filter(ie=>ie&&typeof ie=="string"):["2025-01-01","2025-02-05","2025-03-23","2025-05-01","2025-08-14","2025-11-09","2025-12-25"],[e]),de=e?.vacations||{summer:{start:"2025-06-01",end:"2025-07-31"},winter:{start:"2025-12-20",end:"2026-01-05"}},X=ie=>{const G=ie.toISOString().split("T")[0];return!!(de.summer.start&&de.summer.end&&G>=de.summer.start&&G<=de.summer.end||de.winter.start&&de.winter.end&&G>=de.winter.start&&G<=de.winter.end)};return ne.useEffect(()=>{if(e&&e.holidays&&e.holidays.length>0){const ie=setTimeout(()=>{const G=document.querySelector(".react-datepicker");G&&G.querySelectorAll(".react-datepicker__day").forEach(ve=>{if(ve.classList.contains("react-datepicker__day--disabled"))return;const Fe=ve.textContent;if(Fe&&b)try{const[Qe,Ge]=b.split("-"),je=parseInt(Fe,10),Me=Ge.padStart(2,"0"),Se=je.toString().padStart(2,"0"),ft=`${Qe}-${Me}-${Se}`;e.holidays.some(It=>(typeof It=="string"?It:It.date)===ft)&&(ve.classList.add("react-datepicker__day--disabled"),ve.style.color="#cccccc",ve.style.backgroundColor="#f5f5f5",ve.style.cursor="not-allowed",ve.style.textDecoration="line-through")}catch{}})},150);return()=>clearTimeout(ie)}},[e,b]),i.jsxs(i.Fragment,{children:[i.jsx("style",{children:NG}),i.jsx(jd,{title:"Staff Attendance",subtitle:"Manage staff attendance manually",actionButton:i.jsx("button",{onClick:ee,disabled:r,className:`inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white transition-all duration-200 ${r?"bg-gray-400 cursor-not-allowed":"bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}`,children:r?i.jsxs(i.Fragment,{children:[i.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(m5,{className:"mr-2"})," Save Attendance"]})})}),s&&i.jsx("div",{className:"mb-6 bg-red-50 border-l-4 border-red-500 p-4 rounded",children:i.jsxs("div",{className:"flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),i.jsx("div",{className:"ml-3",children:i.jsxs("p",{className:"text-sm text-red-700",children:["Error: ",s]})})]})}),i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 mb-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[1fr_1fr_2fr] gap-4 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Attendance Date"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute z-10 inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Rl,{className:"h-5 w-5 text-gray-400"})}),i.jsx(z1,{selected:b?(()=>{try{const ie=new Date(b);return isNaN(ie.getTime())?new Date:ie}catch{return new Date}})():new Date,onChange:ie=>{if(ie.getDay()===0)return;const G=ie.toISOString().split("T")[0];le&&le.includes(G)||X(ie)||j(ie.toISOString().split("T")[0])},filterDate:ie=>{if(ie.getDay()===0)return!1;const G=ie.toISOString().split("T")[0];return!(le&&le.includes(G)||X(ie))},dayClassName:ie=>{const G=ie.toISOString().split("T")[0];let q="";return ie.getDay()===0&&(q+="react-datepicker__day--disabled "),le&&Array.isArray(le)&&le.includes(G)&&(q+="react-datepicker__day--disabled "),X(ie)&&(q+="react-datepicker__day--disabled "),(ie.getDay()===0||ie.getDay()===6)&&(q+="react-datepicker__day--weekend "),q.trim()},className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholderText:"Select Date"},e?`loaded-${JSON.stringify(e.holidays||[])}`:"loading")]}),i.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Note: Sundays, holidays, and vacation periods are disabled as school is closed"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Bi,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"text",placeholder:"Search staff...",value:u,onChange:ie=>f(ie.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Quick Actions"}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsxs("button",{onClick:ue,className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[i.jsx(cA,{className:"mr-1"})," Mark All Present"]}),i.jsxs("button",{onClick:ae,className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:[i.jsx(Tc,{className:"mr-1"})," Mark All Absent"]}),i.jsxs("button",{onClick:pe,className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500",children:[i.jsx(eu,{className:"mr-1"})," Mark All Late"]}),i.jsxs("button",{onClick:z,className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(Nx,{className:"mr-1"})," Mark All Leave"]})]})]})]}),i.jsx("div",{className:"flex flex-wrap gap-2"})]}),M.length>0&&i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:i.jsxs("div",{className:"flex flex-wrap items-center justify-between",children:[i.jsxs("div",{className:"text-blue-800 font-medium",children:[M.length," staff member",M.length!==1?"s":""," selected"]}),i.jsxs("div",{className:"flex flex-wrap gap-2 mt-2 sm:mt-0",children:[i.jsxs("button",{onClick:()=>se("present"),className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[i.jsx(cA,{className:"mr-1"})," Mark Present"]}),i.jsxs("button",{onClick:()=>se("absent"),className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:[i.jsx(Tc,{className:"mr-1"})," Mark Absent"]}),i.jsxs("button",{onClick:()=>se("late"),className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500",children:[i.jsx(eu,{className:"mr-1"})," Mark Late"]}),i.jsxs("button",{onClick:()=>se("leave"),className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(Nx,{className:"mr-1"})," Mark Leave"]}),i.jsx("button",{onClick:Z,className:"inline-flex items-center px-3 py-1 border border-gray-300 text-xs font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Clear Selection"})]})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[i.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-xl shadow-lg p-4 text-white",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(cA,{className:"h-8 w-8 mr-3"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-green-100",children:"Present"}),i.jsx("p",{className:"text-2xl font-bold",children:T.presentCount})]})]})}),i.jsx("div",{className:"bg-gradient-to-r from-red-500 to-red-600 rounded-xl shadow-lg p-4 text-white",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(Tc,{className:"h-8 w-8 mr-3"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-red-100",children:"Absent"}),i.jsx("p",{className:"text-2xl font-bold",children:T.absentCount})]})]})}),i.jsx("div",{className:"bg-gradient-to-r from-yellow-500 to-yellow-600 rounded-xl shadow-lg p-4 text-white",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(eu,{className:"h-8 w-8 mr-3"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-yellow-100",children:"Late"}),i.jsx("p",{className:"text-2xl font-bold",children:T.lateCount})]})]})}),i.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl shadow-lg p-4 text-white",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(Nx,{className:"h-8 w-8 mr-3"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-blue-100",children:"Leave"}),i.jsx("p",{className:"text-2xl font-bold",children:T.leaveCount})]})]})})]}),i.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[i.jsxs("div",{className:"flex flex-wrap items-center justify-between mb-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Staff Attendance (",L.length," staff members)"]}),i.jsxs("div",{className:"flex gap-2 mt-2 sm:mt-0",children:[i.jsx("button",{onClick:Q,className:"inline-flex items-center px-3 py-1 border border-gray-300 text-xs font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50",children:"Select All"}),i.jsx("button",{onClick:Z,className:"inline-flex items-center px-3 py-1 border border-gray-300 text-xs font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50",children:"Clear Selection"})]})]}),i.jsxs("div",{className:"overflow-hidden rounded-lg border border-gray-200",children:[i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:i.jsx("input",{type:"checkbox",checked:M.length>0&&M.length===L.length,onChange:Q,className:"h-4 w-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"})}),i.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Photo"}),i.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),i.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),i.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Position"}),i.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:we.map(ie=>i.jsxs("tr",{className:`hover:bg-gray-50 ${M.includes(ie.id)?"bg-blue-50":""}`,children:[i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:i.jsx("input",{type:"checkbox",checked:M.includes(ie.id),onChange:()=>O(ie.id),className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"})}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsx("div",{className:"flex items-center",children:i.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:i.jsxs("div",{className:"h-10 w-10 rounded-full bg-gradient-to-r from-blue-400 to-indigo-600 flex items-center justify-center text-white font-bold",children:[ie.firstName.charAt(0),ie.lastName.charAt(0)]})})})}),i.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[i.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[ie.firstName," ",ie.lastName]}),i.jsx("div",{className:"text-sm text-gray-500",children:ie.email})]}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:ie.department}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:ie.position}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.jsxs("div",{className:"flex space-x-2",children:[i.jsxs("button",{onClick:()=>H(ie.id,"present"),className:J(ie.id,"present"),children:[i.jsx(cA,{className:"mr-1"})," Present"]}),i.jsxs("button",{onClick:()=>H(ie.id,"absent"),className:J(ie.id,"absent"),children:[i.jsx(Tc,{className:"mr-1"})," Absent"]}),i.jsxs("button",{onClick:()=>H(ie.id,"late"),className:J(ie.id,"late"),children:[i.jsx(eu,{className:"mr-1"})," Late"]}),i.jsxs("button",{onClick:()=>H(ie.id,"leave"),className:J(ie.id,"leave"),children:[i.jsx(Nx,{className:"mr-1"})," Leave"]})]})})]},ie.id))})]}),L.length===0&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Rl,{className:"mx-auto h-12 w-12 text-gray-400"}),i.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No staff members found"}),i.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Try adjusting your search or filter criteria"})]}),L.length>ke&&i.jsx("div",{className:"mt-4",children:i.jsx(Bd,{currentPage:ge,totalPages:he,itemsPerPage:ke,totalItems:L.length,paginate:ye,nextPage:te,prevPage:V})})]})]})]})},jG=({batches:n})=>{const a=Pn(),{students:t}=rr(we=>we.students),[r,s]=ne.useState([]),[e,u]=ne.useState(""),[f,m]=ne.useState(""),[g,b]=ne.useState(""),[j,F]=ne.useState(""),[C,M]=ne.useState(!1),[_,L]=ne.useState([]),[T,H]=ne.useState(1),[O]=ne.useState(20),[Q,Z]=ne.useState(""),ee=[...new Set(t.map(we=>we.class))],se=f?[...new Set(t.filter(we=>we.class===f).map(we=>we.section))]:[],ue=n.filter(we=>we.status==="active"||we.status==="completed"),ae=t.filter(we=>{if(we.status!=="studying")return!1;const ye=`${we.firstName} ${we.lastName}`.toLowerCase().includes(e.toLowerCase())||we.grNo&&we.grNo.toLowerCase().includes(e.toLowerCase())||we.class&&we.class.toLowerCase().includes(e.toLowerCase()),te=!f||we.class===f,V=!g||we.section===g,le=!j||we.academicYear===j;return ye&&te&&V&&le}),pe=Math.ceil(ae.length/O),z=T*O,J=z-O,ge=ae.slice(J,z),fe=we=>{s(ye=>ye.includes(we)?ye.filter(te=>te!==we):[...ye,we])},ke=()=>{const we=ge.map(ye=>ye.id);we.every(ye=>r.includes(ye))?s(ye=>ye.filter(te=>!we.includes(te))):s(ye=>[...new Set([...ye,...we])])},he=we=>{const ye=we.match(/Class\s+(\d+)/i);if(!ye)return we==="PG"?"Nursery":we==="Nursery"?"KG":we==="KG"?"Class 1":null;const te=parseInt(ye[1]);return te>=10?null:`Class ${te+1}`},Ne=()=>{const we=r.map(ye=>{const te=t.find(le=>le.id===ye);if(!te)return null;const V=he(te.class);return{id:te.id,name:`${te.firstName} ${te.lastName}`,currentClass:te.class,nextClass:V||"Graduate to Alumni",willGraduate:!V}}).filter(Boolean);L(we),M(!0)},xe=()=>{const we=n.find(te=>te.id===Q),ye=we?we.name:"2025-2026";r.forEach(te=>{const V=t.find(de=>de.id===te);if(!V)return;const le=he(V.class);if(le)a(a0({...V,class:le,academicYear:ye}));else{let de="Graduated";V.academicYear&&(de=`${V.academicYear.split("-")[0]} Graduates`),a(a0({...V,status:"passed_out",classInWhichLeft:V.class,dateOfLeaving:new Date().toISOString().split("T")[0],reasonOfLeaving:"Graduated",academicYear:de}))}}),s([]),M(!1),Z("")};return ne.useEffect(()=>{H(1)},[e,f,g,j]),i.jsxs("div",{className:"bg-white rounded-lg shadow",children:[i.jsxs("div",{className:"p-6 border-b border-gray-200",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Student Promotion"}),i.jsxs("button",{onClick:Ne,disabled:r.length===0,className:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white ${r.length===0?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}`,children:[i.jsx(cA,{className:"mr-2"}),"Promote Selected (",r.length,")"]})]}),i.jsxs("div",{className:"mt-4 flex flex-col md:flex-row md:items-center gap-4",children:[i.jsxs("div",{className:"relative flex-grow max-w-md",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Bi,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"text",placeholder:"Search by student name, GR No, or class...",value:e,onChange:we=>u(we.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(io,{className:"text-gray-400"}),i.jsxs("select",{value:j,onChange:we=>F(we.target.value),className:"block w-full pl-3 pr-10 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"All Batches"}),ue.map(we=>i.jsx("option",{value:we.name,children:we.name},we.id))]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(io,{className:"text-gray-400"}),i.jsxs("select",{value:f,onChange:we=>{m(we.target.value),b("")},className:"block w-full pl-3 pr-10 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"All Classes"}),ee.map(we=>i.jsx("option",{value:we,children:we},we))]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(io,{className:"text-gray-400"}),i.jsxs("select",{value:g,onChange:we=>b(we.target.value),disabled:!f,className:"block w-full pl-3 pr-10 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"All Sections"}),se.map(we=>i.jsx("option",{value:we,children:we},we))]})]}),i.jsx("div",{className:"flex items-center space-x-2",children:i.jsx("button",{onClick:()=>{u(""),F(""),m(""),b("")},className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Clear Filters"})})]})]})]}),i.jsxs("div",{className:"overflow-x-auto",children:[i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:i.jsx("input",{type:"checkbox",checked:ge.length>0&&ge.every(we=>r.includes(we.id)),onChange:ke,className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"})}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"GR No"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class & Section"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Batch"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fees Status"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ge.map(we=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("input",{type:"checkbox",checked:r.includes(we.id),onChange:()=>fe(we.id),className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:i.jsx("img",{className:"h-10 w-10 rounded-full",src:we.photo||"https://i.pravatar.cc/300?img=1",alt:""})}),i.jsxs("div",{className:"ml-4",children:[i.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[we.firstName," ",we.lastName]}),i.jsx("div",{className:"text-sm text-gray-500",children:we.fatherName})]})]})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("div",{className:"text-sm text-gray-900",children:we.grNo||"N/A"})}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[i.jsx("div",{className:"text-sm text-gray-900",children:we.class||"N/A"}),i.jsxs("div",{className:"text-sm text-gray-500",children:["Section ",we.section||"N/A"]})]}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("div",{className:"text-sm text-gray-900",children:we.academicYear||"N/A"})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i.jsx("div",{className:"text-sm text-gray-900",children:we.feesHistory&&we.feesHistory.some(ye=>ye.type==="monthly")?parseFloat(we.feesPaid||0)>=parseFloat(we.totalFees||0)?i.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Fees Paid"}):i.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Fees Pending"}):i.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"No Challans"})})}),i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:i.jsxs("button",{onClick:()=>console.log("Edit student",we.id),className:"inline-flex items-center px-3 py-1 border border-gray-300 text-xs font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[i.jsx(IA,{className:"mr-1"})," Edit"]})})]},we.id))})]}),ae.length===0&&i.jsxs("div",{className:"text-center py-8",children:[i.jsx(Tc,{className:"mx-auto h-12 w-12 text-gray-400"}),i.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No students available for promotion"}),i.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Only studying students can be promoted"})]})]}),ae.length>O&&i.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:i.jsx(Bd,{currentPage:T,totalPages:pe,totalItems:ae.length,itemsPerPage:O,paginate:we=>H(we)})}),C&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl",children:[i.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Promotion Preview"})}),i.jsxs("div",{className:"px-6 py-4",children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Target Academic Year"}),i.jsxs("select",{value:Q,onChange:we=>Z(we.target.value),className:"block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"Select target batch"}),ue.map(we=>i.jsxs("option",{value:we.id,children:[we.name," (",we.status==="active"?"Active":"Completed",")"]},we.id))]})]}),Q&&i.jsxs(i.Fragment,{children:[i.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Review the following promotions before confirming:"}),i.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:_.map(we=>i.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-md",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:we.name}),i.jsxs("div",{className:"text-sm text-gray-500",children:[we.currentClass,"  ",we.nextClass]})]}),i.jsx("div",{children:we.willGraduate?i.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[i.jsx(OA,{className:"mr-1"})," Graduate"]}):i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Promote"})})]},we.id))})]})]}),i.jsxs("div",{className:"px-6 py-4 bg-gray-50 flex justify-end space-x-3",children:[i.jsx("button",{onClick:()=>M(!1),className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),i.jsx("button",{onClick:xe,disabled:!Q,className:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white ${Q?"bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500":"bg-gray-400 cursor-not-allowed"}`,children:"Confirm Promotions"})]})]})})]})},BG=()=>{const n=Pn(),a=Cd(),{students:t,loading:r}=rr(q=>q.students),{batches:s,loading:e}=rr(q=>q.alumni),[u,f]=ne.useState(""),[m,g]=ne.useState(""),[b,j]=ne.useState(""),[F,C]=ne.useState(""),[M,_]=ne.useState(!1),[L,T]=ne.useState(!1),[H,O]=ne.useState(!1),[Q,Z]=ne.useState("students"),[ee,se]=ne.useState(1),[ue]=ne.useState(30),[ae,pe]=ne.useState({name:"",startDate:"",endDate:"",status:"active"}),[z,J]=ne.useState(null),[ge,fe]=ne.useState("available");ne.useEffect(()=>{n(Lc()),n(Km())},[n]),ne.useEffect(()=>{const q=new Date;q.setHours(0,0,0,0),s.forEach(ve=>{if(ve.status==="active"){const Fe=new Date(ve.endDate);if(Fe.setHours(0,0,0,0),Fe<q){const Qe={...ve,status:"completed"};n(Xv(Qe))}}})},[s,n]),ne.useEffect(()=>{if(s.length>0&&!m){const q=s.find(ve=>ve.status==="active");q&&g(q.name)}},[s,m]);const he=s;m&&[...new Set(t.filter(q=>q.academicYear===m).map(q=>q.class))],b&&m&&[...new Set(t.filter(q=>q.class===b&&q.academicYear===m).map(q=>q.section))];const Ne=t.filter(q=>{const ve=`${q.firstName} ${q.lastName}`.toLowerCase().includes(u.toLowerCase())||q.grNo&&q.grNo.toLowerCase().includes(u.toLowerCase())||q.class&&q.class.toLowerCase().includes(u.toLowerCase()),Fe=!m||q.academicYear===m,Qe=!b||q.class===b,Ge=!F||q.section===F;return ve&&Fe&&Qe&&Ge}),xe=m?he.find(q=>q.name===m)?.status:null,we=xe==="completed"?Ne:Ne.filter(q=>q.status!=="passed_out"),te=(()=>{let q,ve;xe==="completed"?(q=we.filter(Ge=>Ge.status!=="left"),ve=we.filter(Ge=>Ge.status==="left")):(q=we.filter(Ge=>Ge.status!=="left"&&Ge.status!=="passed_out"),ve=we.filter(Ge=>Ge.status==="left"));const Fe={};we.forEach(Ge=>{const je=Ge.fatherName?Ge.fatherName.toLowerCase().replace(/\s+/g,"_"):`unknown-${Ge.id}`;Fe[je]||(Fe[je]=[]),Fe[je].push(Ge)});const Qe=Object.keys(Fe).length;return{available:q.length,left:ve.length,families:Qe}})();Math.ceil(we.length/ue);const V=ee*ue,le=V-ue;we.slice(le,V);const de=()=>{if(ae.name&&ae.startDate&&ae.endDate){const q={...ae,id:`batch-${ae.name.replace("/","-")}`,classes:["PG","Nursery","KG","Class 1","Class 2","Class 3","Class 4","Class 5","Class 6","Class 7","Class 8","Class 9","Class 10"],sections:["A","B"]};n(gC(q)),_(!1),pe({name:"",startDate:"",endDate:"",status:"active"})}},X=()=>{z&&z.name&&z.startDate&&z.endDate&&(n(Xv(z)),T(!1),J(null))},ie=q=>{window.confirm("Are you sure you want to delete this batch? This action cannot be undone.")&&n(xC(q))},G=q=>q?new Date(q).toLocaleDateString("en-GB"):"N/A";return r||e?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):i.jsxs(i.Fragment,{children:[i.jsx(jd,{title:"Batch Management",subtitle:"Manage academic years and student batches",actionButton:i.jsxs("div",{className:"flex space-x-2",children:[i.jsxs("button",{onClick:()=>a("/students/admission"),className:"inline-flex items-center px-3 py-1.5 border border-transparent rounded-md shadow-sm text-xs font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-green-500",children:[i.jsx(xl,{className:"mr-1 h-3 w-3"}),"Add Student"]}),i.jsxs("button",{onClick:()=>_(!0),className:"inline-flex items-center px-3 py-1.5 border border-transparent rounded-md shadow-sm text-xs font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-blue-500",children:[i.jsx(xl,{className:"mr-1 h-3 w-3"}),"Create Batch"]})]})}),i.jsx("div",{className:"bg-white shadow rounded-lg mb-4",children:i.jsxs("div",{className:"border-b border-gray-200 flex justify-between",children:[i.jsxs("nav",{className:"-mb-px flex",children:[i.jsx("button",{onClick:()=>Z("students"),className:`py-3 px-4 text-center border-b-2 font-medium text-sm ${Q==="students"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(_c,{className:"mr-2"}),"Students by Batch"]})}),i.jsx("button",{onClick:()=>Z("promotion"),className:`py-3 px-4 text-center border-b-2 font-medium text-sm ${Q==="promotion"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(eD,{className:"mr-2"}),"Promotion Management"]})})]}),i.jsxs("div",{className:"flex items-center space-x-2 px-4",children:[i.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Batch:"}),i.jsxs("div",{className:"flex items-center",children:[i.jsxs("select",{value:m,onChange:q=>{g(q.target.value),j(""),C("")},className:"block w-full pl-3 pr-10 py-1.5 border border-gray-300 rounded-md text-sm focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"All Batches"}),he.map(q=>i.jsx("option",{value:q.name,children:q.name},q.id))]}),i.jsx("button",{onClick:()=>O(!0),className:"ml-2 inline-flex items-center px-2 py-1.5 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-1 focus:ring-offset-1 focus:ring-blue-500",children:i.jsx(f5,{className:"h-4 w-4"})})]})]})]})}),Q==="students"?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"bg-white shadow",children:i.jsx("div",{className:"border-b border-gray-200",children:i.jsxs("nav",{className:"-mb-px flex flex-wrap space-x-4 px-3",children:[i.jsx("button",{onClick:()=>fe("available"),className:`whitespace-nowrap py-2 px-1 border-b-2 font-medium text-xs ${ge==="available"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(cA,{className:"mr-1"}),"Available",i.jsx("span",{className:"ml-1 inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:te.available})]})}),i.jsx("button",{onClick:()=>fe("left"),className:`whitespace-nowrap py-2 px-1 border-b-2 font-medium text-xs ${ge==="left"?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(Tc,{className:"mr-1"}),"Left in Middle",i.jsx("span",{className:"ml-1 inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:te.left})]})}),i.jsx("button",{onClick:()=>fe("family"),className:`whitespace-nowrap py-2 px-1 border-b-2 font-medium text-xs ${ge==="family"?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(_c,{className:"mr-1"}),"Families",i.jsx("span",{className:"ml-1 inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:te.families})]})})]})})}),i.jsx("div",{className:"mb-6",children:ge==="available"||ge==="left"?i.jsx(lj,{activeTab:ge,parentSearchTerm:u,parentSelectedClass:b,parentSelectedSection:F,students:we,isCompletedBatch:xe==="completed"}):i.jsx(uD,{students:we})})]}):i.jsx(jG,{batches:s}),M&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[i.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Create New Batch"})}),i.jsxs("div",{className:"px-6 py-4 space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Batch Name"}),i.jsx("input",{type:"text",value:ae.name,onChange:q=>pe({...ae,name:q.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., 2025-2026"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Start Date"}),i.jsx("input",{type:"date",value:ae.startDate,onChange:q=>pe({...ae,startDate:q.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"End Date"}),i.jsx("input",{type:"date",value:ae.endDate,onChange:q=>pe({...ae,endDate:q.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),i.jsxs("select",{value:ae.status,onChange:q=>pe({...ae,status:q.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"completed",children:"Completed"})]})]})]}),i.jsxs("div",{className:"px-6 py-4 bg-gray-50 flex justify-end space-x-3",children:[i.jsx("button",{onClick:()=>_(!1),className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),i.jsx("button",{onClick:de,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Create Batch"})]})]})}),L&&z&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[i.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Edit Batch"})}),i.jsxs("div",{className:"px-6 py-4 space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Batch Name"}),i.jsx("input",{type:"text",value:z.name,onChange:q=>J({...z,name:q.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., 2025-2026"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Start Date"}),i.jsx("input",{type:"date",value:z.startDate,onChange:q=>J({...z,startDate:q.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"End Date"}),i.jsx("input",{type:"date",value:z.endDate,onChange:q=>J({...z,endDate:q.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),i.jsxs("select",{value:z.status,onChange:q=>J({...z,status:q.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"active",children:"Active"}),i.jsx("option",{value:"completed",children:"Completed"})]})]})]}),i.jsxs("div",{className:"px-6 py-4 bg-gray-50 flex justify-end space-x-3",children:[i.jsx("button",{onClick:()=>T(!1),className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),i.jsx("button",{onClick:X,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Update Batch"})]})]})}),H&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[80vh] overflow-y-auto",children:[i.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Academic Batches"}),i.jsx("button",{onClick:()=>O(!1),className:"text-gray-400 hover:text-gray-500",children:i.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("div",{className:"px-6 py-4",children:i.jsxs("div",{className:"overflow-x-auto",children:[i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Batch Name"}),i.jsx("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Period"}),i.jsx("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),i.jsx("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Students"}),i.jsx("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Available"}),i.jsx("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Left"}),i.jsx("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Graduated"}),i.jsx("th",{scope:"col",className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200 text-sm",children:he.map(q=>{const ve=t.filter(Me=>Me.academicYear===q.name),Fe=ve.length,Qe=ve.filter(Me=>Me.status!=="left"&&Me.status!=="passed_out").length,Ge=ve.filter(Me=>Me.status==="left").length,je=ve.filter(Me=>Me.status==="passed_out").length;return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:i.jsx("div",{className:"text-sm font-medium text-gray-900",children:q.name})}),i.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:i.jsxs("div",{className:"text-xs text-gray-900",children:[G(q.startDate)," - ",G(q.endDate)]})}),i.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:i.jsxs("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${q.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:[q.status==="active"?i.jsx(nf,{className:"mr-1"}):i.jsx(vd,{className:"mr-1"}),q.status.charAt(0).toUpperCase()+q.status.slice(1)]})}),i.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:Fe}),i.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:Qe}),i.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:Ge}),i.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:je}),i.jsxs("td",{className:"px-4 py-2 whitespace-nowrap text-sm font-medium",children:[i.jsx("button",{onClick:()=>{J({...q}),T(!0),O(!1)},className:"text-blue-600 hover:text-blue-900 mr-2",children:i.jsx(IA,{})}),i.jsx("button",{onClick:()=>ie(q.id),className:"text-red-600 hover:text-red-900",children:i.jsx(cu,{})})]})]},q.id)})})]}),he.length===0&&i.jsxs("div",{className:"text-center py-6",children:[i.jsx(Rl,{className:"mx-auto h-8 w-8 text-gray-400"}),i.jsx("h3",{className:"mt-1 text-sm font-medium text-gray-900",children:"No batches found"}),i.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Create your first batch to get started"})]})]})}),i.jsx("div",{className:"px-6 py-4 bg-gray-50 flex justify-end",children:i.jsx("button",{onClick:()=>O(!1),className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Close"})})]})})]})},zo=({children:n,permission:a,redirectTo:t="/unauthorized"})=>{const r=rr(e=>e.users?.currentUser),s=rr(e=>dh(e,a));return r?a&&!s?i.jsx(w4,{to:t,replace:!0}):n:i.jsx(w4,{to:"/login",replace:!0})},SG=()=>{const n=Cd();return i.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"max-w-md w-full bg-white rounded-xl shadow-lg overflow-hidden",children:[i.jsxs("div",{className:"bg-red-500 p-6 text-center",children:[i.jsx(d5,{className:"text-white text-4xl mx-auto"}),i.jsx("h1",{className:"text-2xl font-bold text-white mt-3",children:"Access Denied"})]}),i.jsxs("div",{className:"p-8 text-center",children:[i.jsx("p",{className:"text-gray-600 mb-6",children:"You don't have permission to access this page. Please contact your administrator if you believe this is an error."}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[i.jsxs("button",{onClick:()=>n(-1),className:"inline-flex items-center justify-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[i.jsx(o5,{className:"mr-2"}),"Go Back"]}),i.jsx("button",{onClick:()=>n("/"),className:"inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Go to Dashboard"})]})]})]})})},S1=({permission:n,permissions:a,requireAll:t=!1,children:r,fallback:s=null,hide:e=!1})=>{if(!rr(m=>m.users.currentUser))return e?null:s;let f=!1;return n?f=rr(m=>dh(m,n)):a&&Array.isArray(a)?t?f=a.every(m=>rr(g=>dh(g,m))):f=a.some(m=>rr(g=>dh(g,m))):f=!0,f?r:e?null:s},FG=()=>{const n=rr(u=>u.users.currentUser),{hasPermission:a,isOwner:t,isAdmin:r,isTeacher:s,isStaff:e}=p5();return i.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"RBAC Test Page"}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Current User Information"}),n?i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsxs("p",{className:"text-gray-600",children:["Username: ",i.jsx("span",{className:"font-medium",children:n.username})]}),i.jsxs("p",{className:"text-gray-600",children:["Role: ",i.jsx("span",{className:"font-medium",children:n.role})]})]}),i.jsx("div",{children:i.jsxs("p",{className:"text-gray-600",children:["Permissions: ",i.jsx("span",{className:"font-medium",children:n.permissions.join(", ")})]})})]}):i.jsx("p",{className:"text-gray-600",children:"No user logged in"})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Permission Checks"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"border border-gray-200 rounded p-4",children:[i.jsx("h3",{className:"font-medium text-gray-700 mb-2",children:"Role Checks"}),i.jsxs("ul",{className:"space-y-2",children:[i.jsxs("li",{className:"flex justify-between",children:[i.jsx("span",{children:"Is Owner:"}),i.jsx("span",{className:`font-medium ${t()?"text-green-600":"text-red-600"}`,children:t()?"Yes":"No"})]}),i.jsxs("li",{className:"flex justify-between",children:[i.jsx("span",{children:"Is Admin:"}),i.jsx("span",{className:`font-medium ${r()?"text-green-600":"text-red-600"}`,children:r()?"Yes":"No"})]}),i.jsxs("li",{className:"flex justify-between",children:[i.jsx("span",{children:"Is Teacher:"}),i.jsx("span",{className:`font-medium ${s()?"text-green-600":"text-red-600"}`,children:s()?"Yes":"No"})]}),i.jsxs("li",{className:"flex justify-between",children:[i.jsx("span",{children:"Is Staff:"}),i.jsx("span",{className:`font-medium ${e()?"text-green-600":"text-red-600"}`,children:e()?"Yes":"No"})]})]})]}),i.jsxs("div",{className:"border border-gray-200 rounded p-4",children:[i.jsx("h3",{className:"font-medium text-gray-700 mb-2",children:"Permission Checks"}),i.jsxs("ul",{className:"space-y-2",children:[i.jsxs("li",{className:"flex justify-between",children:[i.jsx("span",{children:"Has 'students' permission:"}),i.jsx("span",{className:`font-medium ${a("students")?"text-green-600":"text-red-600"}`,children:a("students")?"Yes":"No"})]}),i.jsxs("li",{className:"flex justify-between",children:[i.jsx("span",{children:"Has 'fees' permission:"}),i.jsx("span",{className:`font-medium ${a("fees")?"text-green-600":"text-red-600"}`,children:a("fees")?"Yes":"No"})]}),i.jsxs("li",{className:"flex justify-between",children:[i.jsx("span",{children:"Has 'expenses' permission:"}),i.jsx("span",{className:`font-medium ${a("expenses")?"text-green-600":"text-red-600"}`,children:a("expenses")?"Yes":"No"})]}),i.jsxs("li",{className:"flex justify-between",children:[i.jsx("span",{children:"Has 'settings' permission:"}),i.jsx("span",{className:`font-medium ${a("settings")?"text-green-600":"text-red-600"}`,children:a("settings")?"Yes":"No"})]})]})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Conditional Content"}),i.jsxs("div",{className:"space-y-4",children:[i.jsx(S1,{permission:"students",children:i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded p-4",children:[i.jsx("h3",{className:"font-medium text-blue-800",children:"Student Management Section"}),i.jsx("p",{className:"text-blue-700 mt-1",children:"This content is only visible to users with 'students' permission."})]})}),i.jsx(S1,{permission:"fees",children:i.jsxs("div",{className:"bg-green-50 border border-green-200 rounded p-4",children:[i.jsx("h3",{className:"font-medium text-green-800",children:"Fees Management Section"}),i.jsx("p",{className:"text-green-700 mt-1",children:"This content is only visible to users with 'fees' permission."})]})}),i.jsx(S1,{permission:"expenses",children:i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-4",children:[i.jsx("h3",{className:"font-medium text-red-800",children:"Expenses Management Section"}),i.jsx("p",{className:"text-red-700 mt-1",children:"This content is only visible to users with 'expenses' permission."})]})}),i.jsx(S1,{permission:"settings",children:i.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded p-4",children:[i.jsx("h3",{className:"font-medium text-purple-800",children:"Settings Section"}),i.jsx("p",{className:"text-purple-700 mt-1",children:"This content is only visible to users with 'settings' permission."})]})}),i.jsx(S1,{permissions:["fees","expenses"],requireAll:!1,children:i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-4",children:[i.jsx("h3",{className:"font-medium text-yellow-800",children:"Financial Section"}),i.jsx("p",{className:"text-yellow-700 mt-1",children:"This content is visible to users with either 'fees' or 'expenses' permission."})]})})]})]})]})};function EG(){return i.jsx(TS,{store:OE,children:i.jsx(Sk,{basename:"/sms-sef/",children:i.jsxs("div",{className:"min-h-screen bg-gray-100",children:[i.jsxs(wk,{children:[i.jsx(Ci,{path:"/login",element:i.jsx(QO,{})}),i.jsx(Ci,{path:"/unauthorized",element:i.jsx(SG,{})}),i.jsx(Ci,{path:"/",element:i.jsx(vo,{children:i.jsx(iD,{})})}),i.jsx(Ci,{path:"/students",element:i.jsx(zo,{permission:"students",children:i.jsx(vo,{children:i.jsx(mD,{})})})}),i.jsx(Ci,{path:"/students/admission",element:i.jsx(zo,{permission:"students",children:i.jsx(vo,{children:i.jsx(OO,{})})})}),i.jsx(Ci,{path:"/students/attendance",element:i.jsx(zo,{permission:"attendance",children:i.jsx(vo,{children:i.jsx(SK,{})})})}),i.jsx(Ci,{path:"/students/reports",element:i.jsx(zo,{permission:"student-reports",children:i.jsx(vo,{children:i.jsx(mG,{})})})}),i.jsx(Ci,{path:"/batches",element:i.jsx(zo,{permission:"students",children:i.jsx(vo,{children:i.jsx(BG,{})})})}),i.jsx(Ci,{path:"/fees",element:i.jsx(zo,{permission:"fees",children:i.jsx(vo,{children:i.jsx(jK,{})})})}),i.jsx(Ci,{path:"/expenses",element:i.jsx(zo,{permission:"expenses",children:i.jsx(vo,{children:i.jsx(xD,{})})})}),i.jsx(Ci,{path:"/staff",element:i.jsx(zo,{permission:"staff",children:i.jsx(vo,{children:i.jsx(wD,{})})})}),i.jsx(Ci,{path:"/staff/attendance",element:i.jsx(zo,{permission:"staff-attendance",children:i.jsx(vo,{children:i.jsx(CG,{})})})}),i.jsx(Ci,{path:"/staff/attendance-reports",element:i.jsx(zo,{permission:"staff-attendance",children:i.jsx(vo,{children:i.jsx(jD,{})})})}),i.jsx(Ci,{path:"/staff/:id",element:i.jsx(zo,{permission:"staff",children:i.jsx(vo,{children:i.jsx(ND,{})})})}),i.jsx(Ci,{path:"/classes",element:i.jsx(zo,{permission:"classes",children:i.jsx(vo,{children:i.jsx(SD,{})})})}),i.jsx(Ci,{path:"/subsidies",element:i.jsx(zo,{permission:"subsidies",children:i.jsx(vo,{children:i.jsx(FD,{})})})}),i.jsx(Ci,{path:"/examinations",element:i.jsx(zo,{permission:"examinations",children:i.jsx(vo,{children:i.jsx(T_,{})})})}),i.jsx(Ci,{path:"/marksheets",element:i.jsx(zo,{permission:"marksheets",children:i.jsx(vo,{children:i.jsx(w_,{})})})}),i.jsx(Ci,{path:"/certificates",element:i.jsx(zo,{permission:"certificates",children:i.jsx(vo,{children:i.jsx(B_,{})})})}),i.jsx(Ci,{path:"/settings",element:i.jsx(zo,{permission:"settings",children:i.jsx(vo,{children:i.jsx(PO,{})})})}),i.jsx(Ci,{path:"/financial-reporting",element:i.jsx(zo,{permission:"financial-reports",children:i.jsx(vo,{children:i.jsx(wG,{})})})}),i.jsx(Ci,{path:"/rbac-test",element:i.jsx(vo,{children:i.jsx(FG,{})})})]}),i.jsx(x7,{position:"top-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0})]})})})}mS.createRoot(document.getElementById("root")).render(i.jsx(ne.StrictMode,{children:i.jsx(EG,{})}));export{wn as _,kG as c,PN as g};
